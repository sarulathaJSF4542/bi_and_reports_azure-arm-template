/*!
*  filename: ej2.pivotgrid.all.min.js
*  version : 4.1.36.36
*  Copyright Syncfusion Inc. 2001 - 2017. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
(function(n,t){typeof exports=="object"&&typeof module!="undefined"?t():typeof define=="function"&&define.amd?define(t):t()})(this,function(){"use strict";function f(n){var t=this.constructor;return this.then(function(i){return t.resolve(n()).then(function(){return i})},function(i){return t.resolve(n()).then(function(){return t.reject(i)})})}function h(){}function c(n,t){return function(){n.apply(t,arguments)}}function n(t){if(!(this instanceof n))throw new TypeError("Promises must be constructed via new");if(typeof t!="function")throw new TypeError("not a function");this._state=0;this._handled=!1;this._value=undefined;this._deferreds=[];o(t,this)}function e(i,u){while(i._state===3)i=i._value;if(i._state===0){i._deferreds.push(u);return}i._handled=!0;n._immediateFn(function(){var n=i._state===1?u.onFulfilled:u.onRejected,f;if(n===null){(i._state===1?r:t)(u.promise,i._value);return}try{f=n(i._value)}catch(e){t(u.promise,e);return}r(u.promise,f)})}function r(i,r){try{if(r===i)throw new TypeError("A promise cannot be resolved with itself.");if(r&&(typeof r=="object"||typeof r=="function")){var f=r.then;if(r instanceof n){i._state=3;i._value=r;u(i);return}if(typeof f=="function"){o(c(f,r),i);return}}i._state=1;i._value=r;u(i)}catch(e){t(i,e)}}function t(n,t){n._state=2;n._value=t;u(n)}function u(t){t._state===2&&t._deferreds.length===0&&n._immediateFn(function(){t._handled||n._unhandledRejectionFn(t._value)});for(var i=0,r=t._deferreds.length;i<r;i++)e(t,t._deferreds[i]);t._deferreds=null}function l(n,t,i){this.onFulfilled=typeof n=="function"?n:null;this.onRejected=typeof t=="function"?t:null;this.promise=i}function o(n,i){var u=!1;try{n(function(n){u||(u=!0,r(i,n))},function(n){u||(u=!0,t(i,n))})}catch(f){if(u)return;u=!0;t(i,f)}}var s=setTimeout,i;n.prototype["catch"]=function(n){return this.then(null,n)};n.prototype.then=function(n,t){var i=new this.constructor(h);return e(this,new l(n,t,i)),i};n.prototype["finally"]=f;n.all=function(t){return new n(function(n,i){function e(t,u){try{if(u&&(typeof u=="object"||typeof u=="function")){var o=u.then;if(typeof o=="function"){o.call(u,function(n){e(t,n)},i);return}}r[t]=u;--f==0&&n(r)}catch(s){i(s)}}var r,f,u;if(!t||typeof t.length=="undefined")throw new TypeError("Promise.all accepts an array");if(r=Array.prototype.slice.call(t),r.length===0)return n([]);for(f=r.length,u=0;u<r.length;u++)e(u,r[u])})};n.resolve=function(t){return t&&typeof t=="object"&&t.constructor===n?t:new n(function(n){n(t)})};n.reject=function(t){return new n(function(n,i){i(t)})};n.race=function(t){return new n(function(n,i){for(var r=0,u=t.length;r<u;r++)t[r].then(n,i)})};n._immediateFn=typeof setImmediate=="function"&&function(n){setImmediate(n)}||function(n){s(n,0)};n._unhandledRejectionFn=function(n){typeof console!="undefined"&&console&&console.warn("Possible Unhandled Promise Rejection:",n)};i=function(){if(typeof self!="undefined")return self;if(typeof window!="undefined")return window;if(typeof global!="undefined")return global;throw new Error("unable to locate global object");}();"Promise"in i?i.Promise.prototype["finally"]||(i.Promise.prototype["finally"]=f):i.Promise=n});!function(n){function t(r){if(i[r])return i[r].exports;var u=i[r]={i:r,l:!1,exports:{}};return n[r].call(u.exports,u,u.exports,t),u.l=!0,u.exports}var i={};t.m=n;t.c=i;t.d=function(n,i,r){t.o(n,i)||Object.defineProperty(n,i,{enumerable:!0,get:r})};t.r=function(n){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"});Object.defineProperty(n,"__esModule",{value:!0})};t.t=function(n,i){var r,u;if((1&i&&(n=t(n)),8&i)||4&i&&"object"==typeof n&&n&&n.__esModule)return n;if(r=Object.create(null),t.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:n}),2&i&&"string"!=typeof n)for(u in n)t.d(r,u,function(t){return n[t]}.bind(null,u));return r};t.n=function(n){var i=n&&n.__esModule?function(){return n.default}:function(){return n};return t.d(i,"a",i),i};t.o=function(n,t){return Object.prototype.hasOwnProperty.call(n,t)};t.p="";t(t.s=11)}([function(n){n.exports=ejs.base},function(n){n.exports=ejs.data},function(n){n.exports=ejs.pdfexport},function(n){n.exports=ejs.popups},function(n){n.exports=ejs.buttons},function(n){n.exports=ejs.dropdowns},function(n){n.exports=ejs.inputs},function(n){n.exports=ejs.calendars},function(n){n.exports=ejs.navigations},function(n,t){t.copy=function(n,t,i,r){var u=n||{},e=arguments.length;r&&(e-=1);for(var s=function(n){if(!o[n])return"continue";var t=o[n];Object.keys(t).forEach(function(n){var f,e=u[n],i=t[n];r&&(isObject(i)||Array.isArray(i))?isObject(i)?(f=e||{},u[n]=i({},f,i,r)):(f=e||[],u[n]=i([],f,i,r)):u[n]=i})},o=arguments,f=1;f<e;f++)s(f);return u}},function(n){n.exports=ejs.excelexport},function(n,t,i){"use strict";function ou(n,t,i,r){r&&n?n.removeAttribute(t):n&&n.setAttribute(t,i)}function gtt(){return["aggregates","allowGrouping","allowFiltering","allowMultiSorting","allowReordering","allowSorting","allowTextWrap","childGrid","columns","currentViewData","dataSource","detailTemplate","enableAltRow","enableColumnVirtualization","filterSettings","gridLines","groupSettings","height","locale","pageSettings","printMode","query","queryString","enableRtl","rowHeight","rowTemplate","sortSettings","textWrapSettings","allowPaging","hierarchyPrintMode","searchSettings","queryCellInfo","beforeDataBound"]}function nk(n,t){return n.prototype&&t in n.prototype}function la(n,t){return Object(r.isNullOrUndefined)(n)||""===n?"":e.DataUtil.getObject(n,t)}function nit(n,t){return Object(r.isNullOrUndefined)(n)||""===n?"":e.DataUtil.getObject(n,t)}function aa(n,t){requestAnimationFrame(function(){try{t(null,n())}catch(n){t(n)}})}function ke(n){return!Object(r.isNullOrUndefined)(n)&&!Object(r.isNullOrUndefined)(n.columns)&&n.columns.length>0}function va(n,t){for(var u,f=n.columns,r=t.columns,i=0;i<f.length;i++)if(r.length-1>=i)if(r[i].columns)for(u=0;u<r[i].columns.length;u++)f[i].columns[u].type=r[i].columns[u].type;else f[i].type=r[i].type}function tk(n){for(var r=[],i=n.vRows,t=0;t<i.length;t++)i[t].isDataRow?r.push(i[t]):i[t].isDataRow||(r.push(i[t]),!i[t].isExpand&&i[t].isCaptionRow&&(t+=ik(i[t],n)));n.vcRows=r}function ik(n,t){var o,c,f;ni=0;var e=t.groupSettings.columns.length,i="items",h=n.gSummary,s=0,u="aggregatesCount";if(h===n.data.count)return t.groupSettings.columns.length&&!Object(r.isNullOrUndefined)(n[u])&&n[u]?1!==t.groupSettings.columns.length?ni+=0!==n.indent&&h<2?n.gSummary*(e-n.indent+(e-n.indent)*n[u]):n.gSummary*(e-n.indent+(e-n.indent-1)*n[u])+n[u]:1===t.groupSettings.columns.length&&(ni+=n.gSummary*(e-n.indent)+n[u]):t.groupSettings.columns.length&&(ni+=1!==t.groupSettings.columns.length?n.gSummary*(t.groupSettings.columns.length-n.indent):n.gSummary),ni;for(o=0,c=n.data[i].length;o<c;o++)f=n.data[i][o],ni+=f[i].length+(e===t.columns.length||Object(r.isNullOrUndefined)(f[i].records)?0:f[i].records.length),s+=Object(r.isNullOrUndefined)(f[i].records)||Object(r.isNullOrUndefined)(n[u])?f[i].length:f[i].records.length,f[i].GroupGuid&&0!==f[i].childLevels&&ya(f);return ni+=n.data[i].length,Object(r.isNullOrUndefined)(n[u])||n[u]&&ni&&0!==s&&(ni+=(ni-s)*n[u]+n[u]),ni}function ya(n){for(var i,t=0,r=n.items.length;t<r;t++)i=n.items[t],ni+=i.count,0!==i.items.childLevels&&ya(i)}function yr(n,t){for(var u,f=[],i=0,e=n.length;i<e;i++)u=t(n[i],i),Object(r.isNullOrUndefined)(u)||f.push(u);return f}function ih(n){for(var i=[],t=0;t<n.length;t++)i.push(Object(r.extend)({},hf(n[t]),{},!0));return i}function et(n){if(n)try{if(document.querySelectorAll(n).length)return Object(r.compile)(document.querySelector(n).innerHTML.trim())}catch(t){return Object(r.compile)(n)}}function yi(n,t){var i={},u=["style","class"];Object(r.extend)(i,t,{});"style"in i&&(Object(r.setStyleAttribute)(n,i[u[0]]),delete i[u[0]]);"class"in i&&(Object(r.addClass)([n],i[u[1]]),delete i[u[1]]);Object(r.attributes)(n,i)}function cu(n,t,i,u){for(var e=Object(r.extend)(n,t,i),o=Object.keys(e),f=0;f<o.length;f++)u&&-1!==u.indexOf(o[f])&&delete e[o[f]];return e}function de(n,t){void 0===t&&(t=0);for(var i=0,u=n.length;i<u;i++)n[i].columns?(n[i].index=Object(r.isNullOrUndefined)(n[i].index)?t:n[i].index,t++,t=de(n[i].columns,t)):(n[i].index=Object(r.isNullOrUndefined)(n[i].index)?t:n[i].index,t++);return t}function lu(n,t,i){for(var u,f=0,e=n.length;f<e;f++)u=void 0,"string"==typeof n[f]?u=new wt({field:n[f]},i):n[f]instanceof wt?u=n[f]:n[f].columns?(n[f].columns=lu(n[f].columns,null,i),u=new wt(n[f],i)):u=new wt(n[f],i),u.type&&"checkbox"===u.type.toLowerCase()&&(u.allowReordering=!1),u.headerText=Object(r.isNullOrUndefined)(u.headerText)?u.foreignKeyValue||u.field||"":u.headerText,u.foreignKeyField=u.foreignKeyField||u.field,u.valueAccessor=("string"==typeof u.valueAccessor?Object(r.getValue)(u.valueAccessor,window):u.valueAccessor)||la,u.width=t&&Object(r.isNullOrUndefined)(u.width)?200:u.width,Object(r.isNullOrUndefined)(u.visible)&&(u.visible=!0),n[f]=u;return n}function pa(n,t,i){var u,o=n.querySelector("span"),f=n.parentElement.getBoundingClientRect(),e=t.target.getBoundingClientRect();o.className=i;n.style.display="";u=(Object(r.isNullOrUndefined)(t.clientY)?t.changedTouches[0].clientY:t.clientY)>n.offsetHeight+10;n.style.top=e.top-f.top+(u?-(n.offsetHeight+10):n.offsetHeight+10)+"px";n.style.left=function(n,t,i,r){var u=n.offsetWidth/2,f=gi(t).x;return f-i.left<u?i.left-r:i.right-f<u?i.right-r-2*u:f-r-u}(n,t,e,f.left)+"px";u?(n.querySelector(".e-downtail").style.display="",n.querySelector(".e-uptail").style.display="none"):(n.querySelector(".e-downtail").style.display="none",n.querySelector(".e-uptail").style.display="")}function hf(n){return n instanceof r.ChildProperty?Object(r.getValue)("properties",n):n}function o(n,t,i){for(var r=n;r&&!(i?r.id===t:r.classList.contains(t));)r=r.parentElement;return r}function rh(n,t){for(var r=-1,i=0,u=t.length;i<u;i++)if(t[i].isEqualNode(n)){r=i;break}return r}function cf(n,t){for(var i=0,r=t.length;i<r;i++)if(t[i]===n)return i;return-1}function uh(n){for(var i=[],t=0,r=n.length;t<r;t++)n[t].hasOwnProperty("properties")?i.push(n[t].properties):i.push(n[t]);return i}function fh(n,t){for(var u=[].slice.call(n.querySelectorAll(t)),i=0;i<u.length;i++)Object(r.remove)(u[i])}function gi(n){var t={};return t.x=Object(r.isNullOrUndefined)(n.clientX)?n.changedTouches[0].clientX:n.clientX,t.y=Object(r.isNullOrUndefined)(n.clientY)?n.changedTouches[0].clientY:n.clientY,t}function ei(n){return n+rk++}function rt(n,t){for(var i=0,r=t.length;i<r;i++)r===t.length?n.appendChild(t[i]):n.appendChild(t[0]);return n}function uk(n,t,i){for(var r=n,u=[];r;)(i?r.id===t:r.classList.contains(t))&&u.push(r),r=r.parentElement;return u}function wa(n,t,i,u){if("Custom"===n){var f=i.customAggregate;return"string"==typeof f&&(f=Object(r.getValue)(f,window)),f?f.call(u,t,i):""}return i.field in t||t instanceof Array?e.DataUtil.aggregates[n.toLowerCase()](t,i.field):null}function oi(){if(null!==eh)return eh;var t,n=document.createElement("div");return n.style.cssText="width:100px;height: 100px;overflow: scroll;position: absolute;top: -9999px;",document.body.appendChild(n),t=n.offsetWidth-n.clientWidth|0,document.body.removeChild(n),eh=t}function fk(n){var t,i;return void 0!==ba?ba:(t=Object(r.createElement)("table",{className:"e-table",styles:"visibility: hidden"}),t.innerHTML='<tr><td class="e-rowcell">A<td><\/tr>',n.appendChild(t),i=t.querySelector("td").getBoundingClientRect(),n.removeChild(t),ba=Math.ceil(i.height))}function nr(n){return n.split(".").length>1}function b(n){return void 0===n&&(n=""),n.replace(/\./g,"___")}function ka(n){return void 0===n&&(n=""),n.replace(/___/g,".")}function ci(n,t,i){var r=o(i,"e-row"),u=!r||r&&!r.classList.contains("e-insertedrow");return"beginEdit"===t&&u?!(n.isIdentity||n.isPrimaryKey||!n.allowEditing):("add"!==t||!n.isIdentity)&&!(u&&!n.allowEditing&&!n.isIdentity&&!n.isPrimaryKey)}function si(n){var t=Object(r.select)("#"+n.element.id+"EditConfirm",n.element);return"Batch"===n.editSettings.mode&&Object(r.selectAll)(".e-updatedtd",n.element).length&&n.editSettings.showConfirmDialog&&(!t||t.classList.contains("e-popup-close"))}function vt(n,t){n=n instanceof Array?n:[n];for(var i=0;i<n.length;i++)t?n[i].classList.add("e-wrap"):n[i].classList.remove("e-wrap")}function da(n,t,i){var u,f=n.getService("valueFormatter");("date"===t.type||"datetime"===t.type)&&((u={type:t.type,skeleton:t.format},Object(r.isBlazor)()&&i)&&(u.isServerRendered=i),"string"==typeof t.format&&"yMd"!==t.format&&(u.format=t.format));switch(t.type){case"date":case"datetime":t.setFormatter(f.getFormatFunction(u));t.setParser(f.getParserFunction(u));break;case"number":t.setFormatter(f.getFormatFunction({format:t.format}));t.setParser(f.getParserFunction({format:t.format}))}}function yt(n,t){for(var i,e,f=[],u=2;u<arguments.length;u++)f[u-2]=arguments[u];for(i=0,e=n.length;i<e;i++)t?(Object(r.classList)(n[i],f.slice(),[]),n[i].setAttribute("aria-selected","true")):(Object(r.classList)(n[i],[],f.slice()),n[i].removeAttribute("aria-selected"))}function ek(n){for(var i={},r=[],t=0;t<n.length;t++)n[t]in i||(r.push(n[t].toString()),i[n[t]]=1);return r}function ga(n,t,i){var e=t.element.style.display,u,f,r;t.element.style.display="block";f=t.width;i.enableRtl?(u=Object(ft.calculatePosition)(n,"left","bottom"),t.element.style.top=u.top+n.getBoundingClientRect().height-35+"px",t.element.style.display=e,r=u.left-f+n.clientWidth,t.element.style.left=r<1?f+r+-16+"px":r-16+"px"):(u=Object(ft.calculateRelativeBasedPosition)(n,t.element),t.element.style.display=e,t.element.style.top=u.top+n.getBoundingClientRect().height-5+"px",r=u.left-f+n.clientWidth,t.element.style.left=r<1?f+r-16+"px":r+-4+"px")}function nv(n,t){n.popup.element.style.zIndex=(t.zIndex+1).toString()}function tv(n){var t=n.querySelector(".e-frame"),i=t.previousSibling;t.classList.contains("e-check")?(i.checked=!1,Object(r.classList)(t,["e-uncheck"],["e-check"])):(i.checked=!0,Object(r.classList)(t,["e-check"],["e-uncheck"]))}function wr(n,t){n.checked=t}function oh(n,t,i){var u=Object(r.createElement)("div",{className:i});return u.appendChild(t),u.setAttribute("uid",n),u}function lf(n,t){Object(r.removeClass)([n],["e-check","e-stop","e-uncheck"]);t?n.classList.add("e-check"):n.classList.add("e-uncheck")}function ge(n,t,i){for(var f,u=0;u<t.length;u++)Object(r.setValue)(t[u].field,tr(t[u],i),n.foreignKeyData);for(f=n.cells,u=0;u<f.length;u++)f[u].isForeignKey&&Object(r.setValue)("foreignKeyData",Object(r.getValue)(f[u].column.field,n.foreignKeyData),f[u])}function tr(n,t,i,u){var s=n.foreignKeyField,f=Object(r.isNullOrUndefined)(i)?la(n.field,t):i,o,h;return f=Object(r.isNullOrUndefined)(f)?"":f,o=new e.Query,h=u||(n.dataSource instanceof e.DataManager&&n.dataSource.dataSource.json.length?n.dataSource.dataSource.json:n.columnData),f.getDay?o.where(ir({field:s,operator:"equal",value:f,matchCase:!1})):o.where(s,"==",f,!1),new e.DataManager(h).executeLocal(o)}function af(n,t){var i;return t.some(function(t){return i=t,t.foreignKeyValue===n})&&i}function ir(n,t){var o,h,s,i=Object(r.extend)({},hf(n)),f=Object(r.extend)({},hf(n)),u,c,l;return Object(r.isNullOrUndefined)(n.value)?new e.Predicate(i.field,i.operator,i.value,!1):(u=new Date(n.value),"equal"===n.operator||"notequal"===n.operator?("datetime"===t?(h=new Date(u.setSeconds(u.getSeconds()-1)),s=new Date(u.setSeconds(u.getSeconds()+2)),n.value=new Date(u.setSeconds(s.getSeconds()-1))):(h=new Date(u.setHours(0)-1),s=new Date(u.setHours(24))),i.value=h,f.value=s,"equal"===n.operator?(i.operator="greaterthan",f.operator="lessthan"):"notequal"===n.operator&&(i.operator="lessthanorequal",f.operator="greaterthanorequal"),c=new e.Predicate(i.field,i.operator,i.value,!1),l=new e.Predicate(f.field,f.operator,f.value,!1),o="equal"===n.operator?c.and(l):c.or(l)):("string"==typeof i.value&&(i.value=new Date(i.value)),o=new e.Predicate(i.field,i.operator,i.value,!1)),n.setProperties?n.setProperties({ejpredicate:o},!0):n.ejpredicate=o,o)}function no(n,t,i){var u,r,f;for(t=t&&i&&i.isRowDragable()?t+1:t,u=n.cloneNode(!0),r=0;r<t;r++)u.removeChild(u.children[0]);for(r=t,f=n.childElementCount;r<f;r++)n.removeChild(n.children[n.childElementCount-1]);return u}function nt(n){return n.enableVirtualization&&n.groupSettings.columns.length>0&&n.isVirtualAdaptive}function k(n,t){if(void 0===n&&(n=""),n){for(var i=t,f=n.split("."),u=0;u<f.length&&!Object(r.isNullOrUndefined)(i);u++)i=i[f[u]];return i}}function to(n,t){var i=new r.Internationalization;return"date"===t?"object"==typeof n?i.getDatePattern({type:n.type?n.type:"date",format:n.format},!1):Object(r.isBlazor)()?i.getDatePattern({type:"dateTime",format:n},!1):i.getDatePattern({type:"dateTime",skeleton:n},!1):"object"==typeof n?i.getDatePattern({type:n.type?n.type:"dateTime",format:n.format},!1):Object(r.isBlazor)()?i.getDatePattern({type:"dateTime",format:n},!1):i.getDatePattern({type:"dateTime",skeleton:n},!1)}function ok(n,t){for(var i,u,r={},f=0,e=n.getRowsObject();f<e.length;f++)i=e[f],i.isExpand&&!i.isDetailRow&&(u=n.allowPaging&&"AllPages"===n.printMode?i.index+n.pageSettings.currentPage*n.pageSettings.pageSize-n.pageSettings.pageSize:i.index,r[u]={},r[u].isExpand=!0,r[u].gridModel=io(i.childGrid,t),r[u].gridModel.query=n.childGrid.query);return r}function io(n,t){var r,u,f,i;if(void 0===t&&(t="Expanded"),r={},!n)return r;for(u=0,f=th.printGridProp;u<f.length;u++)i=f[u],r[i]="columns"===i?uh(n[i]):"allowPaging"===i?"CurrentPage"===n.printMode:hf(n[i]);return n.childGrid&&"None"!==t&&(r.expandedRows=ok(n,t)),r}function ro(n,t,i,u){var s=n||{},a=arguments.length,h;for(u&&(a-=1),h=1;h<a;h++)if(arguments[h])for(var c=arguments[h],e=Object.keys(Object.getPrototypeOf(c)).length?Object.keys(c).concat(tit(c)):Object.keys(c),f=0;f<e.length;f++){var v=s[e[f]],o=c[e[f]],l=void 0;u&&(Object(r.isObject)(o)||Array.isArray(o))?Object(r.isObject)(o)?(l=v||{},s[e[f]]=Object(r.extend)({},l,o,u)):(l=v||[],s[e[f]]=Object(r.extend)([],l,o,u)):s[e[f]]=o}return s}function tit(n){for(var t=[];Object.getPrototypeOf(n)&&Object.keys(Object.getPrototypeOf(n)).length;)t=t.concat(Object.keys(Object.getPrototypeOf(n))),n=Object.getPrototypeOf(n);return t}function sh(n){for(var r,t=0,i=0;i<n.length;i++)r=iv(n[i],0),t<r&&(t=r);return t+1}function iv(n,t){var f=t,u=[],i,r;if(n.columns){for(t++,i=0;i<n.columns.length;i++)u[i]=iv(n.columns[i],t);for(r=0;r<u.length;r++)f<u[r]&&(f=u[r]);t=f}return t}function sk(n,t){for(var i=0;i<t.length;i++)t[i].uid=t[i].isForeignKey?af(t[i].field,n.getForeignKeyColumns()).uid:n.getColumnByField(t[i].field).uid}function rv(n){var t=document.defaultView.getComputedStyle(n,null).getPropertyValue("transform").replace(/,/g,"");return{width:parseFloat(t.split(" ")[4]),height:parseFloat(t.split(" ")[5])}}function vf(n,t){n.classList.contains("e-bigger")&&t.classList.add("e-bigger")}function uv(n,t){if(n&&t){var i=Object(r.closest)(n,".e-row").getBoundingClientRect().height,u=Object(r.closest)(t,".e-row").getBoundingClientRect().height;i>u?t.style.height=i+"px":n.style.height=u+"px"}}function hh(n,t){var i=t.getContent().firstElementChild.offsetHeight;return n&&n.getBoundingClientRect().top>i}function ch(n,t){return n&&n.getBoundingClientRect().top<t}function hk(n,t){var i=t.getRowHeight(),r=t.getContent().firstElementChild.scrollTop/i;return n<r+t.getContent().firstElementChild.offsetHeight/i&&n>r}function lh(n,t){var i,r=n.getPrimaryKeyFieldNames()[0];return n.getCurrentViewRecords().filter(function(n,u){n[r]===t[r]&&(i=u)}),i}function ah(n,t){var i,r;return i=ck(t),r=new e.Deferred,i.dataSource=r.resolve,i.action=n,{state:i,deffered:r}}function ck(n){var t=new e.UrlAdaptor,i=new e.DataManager({url:"",adaptor:new e.UrlAdaptor}),r=t.processQuery(i,n);return JSON.parse(r.data)}function vh(n){for(var i=n.getVisibleColumns(),u=0,f=0,t=0;t<i.length;t++)Object(r.isUndefined)(i[t].width)?f++:-1!==i[t].width.toString().indexOf("%")&&u++;return("auto"===n.width||"string"==typeof n.width&&-1!==n.width.indexOf("%"))&&"chrome"!==r.Browser.info.name&&!n.groupSettings.showGroupedColumn&&n.groupSettings.columns.length&&u&&!f}function fv(n,t,i,r){for(var e,f=r||0,u=0;u<t.length;u++)if(t[u].isDataRow){for(t[u].index=f,t[u].isAltRow=!!n.enableAltRow&&f%2!=0,i[u].setAttribute("aria-rowindex",f.toString()),t[u].isAltRow?i[u].classList.add("e-altrow"):i[u].classList.remove("e-altrow"),e=0;e<i[u].cells.length;e++)i[u].cells[e].setAttribute("index",f.toString());f++}t.length||n.renderModule.emptyRow(!0)}function lk(n,t,i,r){var u=n.dataToBeUpdated[i].concat(t[i]).reduce(function(n,t){return n[t[r]]=void 0===n[t[r]]?t:Object.assign(n[t[r]],t),n},{});n.dataToBeUpdated[i]=Object.keys(u).map(function(n){return u[n]})}function uo(n){n.getFrozenColumns()?(n.contentModule.rowElements=[].slice.call(n.element.querySelectorAll(".e-movableheader .e-row, .e-movablecontent .e-row")),n.contentModule.freezeRowElements=[].slice.call(n.element.querySelectorAll(".e-frozenheader .e-row, .e-frozencontent .e-row"))):n.contentModule.rowElements=[].slice.call(n.element.querySelectorAll(".e-row:not(.e-addedrow)"))}function rd(n,t){for(var r,i=0;i<n.length;i++)for(r=0;r<n[i].columns.length;r++)t(n[i].columns[r],n[i])}function pd(n,t,i){var u="Dialog"!==t,f=to(n.column.format,n.column.type),r=k(n.column.field,n.rowData);return{floatLabelType:u?"Never":"Always",value:r=r?new Date(r):null,format:f,placeholder:u?"":n.column.headerText,enableRtl:i,enabled:ci(n.column,n.requestType,n.element)}}var u,th,ni,rk,ba,pr,eh,tg;i.r(t);u={};i.r(u);i.d(u,"CheckBoxFilterBase",function(){return au});i.d(u,"ExcelFilterBase",function(){return ak});i.d(u,"SortDescriptor",function(){return hb});i.d(u,"SortSettings",function(){return cb});i.d(u,"Predicate",function(){return lb});i.d(u,"InfiniteScrollSettings",function(){return ab});i.d(u,"FilterSettings",function(){return vb});i.d(u,"SelectionSettings",function(){return yb});i.d(u,"SearchSettings",function(){return pb});i.d(u,"RowDropSettings",function(){return wb});i.d(u,"TextWrapSettings",function(){return bb});i.d(u,"ResizeSettings",function(){return kb});i.d(u,"GroupSettings",function(){return db});i.d(u,"EditSettings",function(){return gb});i.d(u,"Grid",function(){return nh});i.d(u,"CellType",function(){return h});i.d(u,"RenderType",function(){return ut});i.d(u,"ToolbarItem",function(){return dh});i.d(u,"doesImplementInterface",function(){return nk});i.d(u,"valueAccessor",function(){return la});i.d(u,"headerValueAccessor",function(){return nit});i.d(u,"getUpdateUsingRaf",function(){return aa});i.d(u,"isExportColumns",function(){return ke});i.d(u,"updateColumnTypeForExportColumns",function(){return va});i.d(u,"updatecloneRow",function(){return tk});i.d(u,"getCollapsedRowsCount",function(){return ik});i.d(u,"recursive",function(){return ya});i.d(u,"iterateArrayOrObject",function(){return yr});i.d(u,"iterateExtend",function(){return ih});i.d(u,"templateCompiler",function(){return et});i.d(u,"setStyleAndAttributes",function(){return yi});i.d(u,"extend",function(){return cu});i.d(u,"setColumnIndex",function(){return de});i.d(u,"prepareColumns",function(){return lu});i.d(u,"setCssInGridPopUp",function(){return pa});i.d(u,"getActualProperties",function(){return hf});i.d(u,"parentsUntil",function(){return o});i.d(u,"getElementIndex",function(){return rh});i.d(u,"inArray",function(){return cf});i.d(u,"getActualPropFromColl",function(){return uh});i.d(u,"removeElement",function(){return fh});i.d(u,"getPosition",function(){return gi});i.d(u,"getUid",function(){return ei});i.d(u,"appendChildren",function(){return rt});i.d(u,"parents",function(){return uk});i.d(u,"calculateAggregate",function(){return wa});i.d(u,"getScrollBarWidth",function(){return oi});i.d(u,"getRowHeight",function(){return fk});i.d(u,"isComplexField",function(){return nr});i.d(u,"getComplexFieldID",function(){return b});i.d(u,"setComplexFieldID",function(){return ka});i.d(u,"isEditable",function(){return ci});i.d(u,"isActionPrevent",function(){return si});i.d(u,"wrap",function(){return vt});i.d(u,"setFormatter",function(){return da});i.d(u,"addRemoveActiveClasses",function(){return yt});i.d(u,"distinctStringValues",function(){return ek});i.d(u,"getFilterMenuPostion",function(){return ga});i.d(u,"getZIndexCalcualtion",function(){return nv});i.d(u,"toogleCheckbox",function(){return tv});i.d(u,"setChecked",function(){return wr});i.d(u,"createCboxWithWrap",function(){return oh});i.d(u,"removeAddCboxClasses",function(){return lf});i.d(u,"refreshForeignData",function(){return ge});i.d(u,"getForeignData",function(){return tr});i.d(u,"getColumnByForeignKeyValue",function(){return af});i.d(u,"getDatePredicate",function(){return ir});i.d(u,"renderMovable",function(){return no});i.d(u,"isGroupAdaptive",function(){return nt});i.d(u,"getObject",function(){return k});i.d(u,"getCustomDateFormat",function(){return to});i.d(u,"getExpandedState",function(){return ok});i.d(u,"getPrintGridModel",function(){return io});i.d(u,"extendObjWithFn",function(){return ro});i.d(u,"measureColumnDepth",function(){return sh});i.d(u,"checkDepth",function(){return iv});i.d(u,"refreshFilteredColsUid",function(){return sk});i.d(u,"Global",function(){return pr});i.d(u,"getTransformValues",function(){return rv});i.d(u,"applyBiggerTheme",function(){return vf});i.d(u,"alignFrozenEditForm",function(){return uv});i.d(u,"ensureLastRow",function(){return hh});i.d(u,"ensureFirstRow",function(){return ch});i.d(u,"isRowEnteredInGrid",function(){return hk});i.d(u,"getEditedDataIndex",function(){return lh});i.d(u,"eventPromise",function(){return ah});i.d(u,"getStateEventArgument",function(){return ck});i.d(u,"ispercentageWidth",function(){return vh});i.d(u,"resetRowIndex",function(){return fv});i.d(u,"compareChanges",function(){return lk});i.d(u,"setRowElements",function(){return uo});i.d(u,"created",function(){return rg});i.d(u,"destroyed",function(){return ug});i.d(u,"load",function(){return tc});i.d(u,"rowDataBound",function(){return ic});i.d(u,"queryCellInfo",function(){return eo});i.d(u,"headerCellInfo",function(){return rc});i.d(u,"actionBegin",function(){return l});i.d(u,"actionComplete",function(){return c});i.d(u,"actionFailure",function(){return hi});i.d(u,"dataBound",function(){return ct});i.d(u,"rowSelecting",function(){return oo});i.d(u,"rowSelected",function(){return wf});i.d(u,"rowDeselecting",function(){return uc});i.d(u,"rowDeselected",function(){return fc});i.d(u,"cellSelecting",function(){return wu});i.d(u,"cellSelected",function(){return bf});i.d(u,"cellDeselecting",function(){return ec});i.d(u,"cellDeselected",function(){return oc});i.d(u,"columnSelecting",function(){return so});i.d(u,"columnSelected",function(){return ho});i.d(u,"columnDeselecting",function(){return sc});i.d(u,"columnDeselected",function(){return hc});i.d(u,"columnDragStart",function(){return kr});i.d(u,"columnDrag",function(){return or});i.d(u,"columnDrop",function(){return dr});i.d(u,"rowDragStartHelper",function(){return iy});i.d(u,"rowDragStart",function(){return ry});i.d(u,"rowDrag",function(){return uy});i.d(u,"rowDrop",function(){return fy});i.d(u,"beforePrint",function(){return cc});i.d(u,"printComplete",function(){return lc});i.d(u,"detailDataBound",function(){return sr});i.d(u,"toolbarClick",function(){return ey});i.d(u,"batchAdd",function(){return kf});i.d(u,"batchCancel",function(){return gr});i.d(u,"batchDelete",function(){return df});i.d(u,"beforeBatchAdd",function(){return oy});i.d(u,"beforeBatchDelete",function(){return sy});i.d(u,"beforeBatchSave",function(){return hy});i.d(u,"beginEdit",function(){return cy});i.d(u,"cellEdit",function(){return ly});i.d(u,"cellSave",function(){return ay});i.d(u,"cellSaved",function(){return vy});i.d(u,"endAdd",function(){return fg});i.d(u,"endDelete",function(){return eg});i.d(u,"endEdit",function(){return og});i.d(u,"recordDoubleClick",function(){return yy});i.d(u,"recordClick",function(){return py});i.d(u,"beforeDataBound",function(){return ac});i.d(u,"beforeOpenColumnChooser",function(){return wy});i.d(u,"resizeStart",function(){return by});i.d(u,"onResize",function(){return ky});i.d(u,"resizeStop",function(){return vc});i.d(u,"checkBoxChange",function(){return dy});i.d(u,"beforeCopy",function(){return gy});i.d(u,"beforePaste",function(){return np});i.d(u,"beforeAutoFill",function(){return tp});i.d(u,"filterChoiceRequest",function(){return yc});i.d(u,"filterAfterOpen",function(){return pc});i.d(u,"filterBeforeOpen",function(){return wc});i.d(u,"filterSearchBegin",function(){return ip});i.d(u,"commandClick",function(){return rp});i.d(u,"exportGroupCaption",function(){return bc});i.d(u,"lazyLoadGroupExpand",function(){return up});i.d(u,"lazyLoadGroupCollapse",function(){return fp});i.d(u,"initialLoad",function(){return ii});i.d(u,"initialEnd",function(){return tt});i.d(u,"dataReady",function(){return at});i.d(u,"contentReady",function(){return y});i.d(u,"uiUpdate",function(){return v});i.d(u,"onEmpty",function(){return bt});i.d(u,"inBoundModelChanged",function(){return d});i.d(u,"modelChanged",function(){return p});i.d(u,"colGroupRefresh",function(){return gf});i.d(u,"headerRefreshed",function(){return g});i.d(u,"pageBegin",function(){return sg});i.d(u,"pageComplete",function(){return kc});i.d(u,"sortBegin",function(){return hg});i.d(u,"sortComplete",function(){return ne});i.d(u,"filterBegin",function(){return cg});i.d(u,"filterComplete",function(){return dc});i.d(u,"searchBegin",function(){return lg});i.d(u,"searchComplete",function(){return gc});i.d(u,"reorderBegin",function(){return ag});i.d(u,"reorderComplete",function(){return nl});i.d(u,"rowDragAndDropBegin",function(){return vg});i.d(u,"rowDragAndDropComplete",function(){return yg});i.d(u,"groupBegin",function(){return pg});i.d(u,"groupComplete",function(){return co});i.d(u,"ungroupBegin",function(){return wg});i.d(u,"ungroupComplete",function(){return tl});i.d(u,"groupAggregates",function(){return pi});i.d(u,"refreshFooterRenderer",function(){return ai});i.d(u,"refreshAggregateCell",function(){return il});i.d(u,"refreshAggregates",function(){return rl});i.d(u,"rowSelectionBegin",function(){return bg});i.d(u,"rowSelectionComplete",function(){return ul});i.d(u,"columnSelectionBegin",function(){return kg});i.d(u,"columnSelectionComplete",function(){return dg});i.d(u,"cellSelectionBegin",function(){return gg});i.d(u,"cellSelectionComplete",function(){return fl});i.d(u,"beforeCellFocused",function(){return hr});i.d(u,"cellFocused",function(){return cr});i.d(u,"keyPressed",function(){return w});i.d(u,"click",function(){return it});i.d(u,"destroy",function(){return ri});i.d(u,"columnVisibilityChanged",function(){return ui});i.d(u,"scroll",function(){return lo});i.d(u,"columnWidthChanged",function(){return nu});i.d(u,"columnPositionChanged",function(){return lr});i.d(u,"rowDragAndDrop",function(){return nn});i.d(u,"rowsAdded",function(){return ao});i.d(u,"rowsRemoved",function(){return bu});i.d(u,"columnDragStop",function(){return vo});i.d(u,"headerDrop",function(){return tu});i.d(u,"dataSourceModified",function(){return ar});i.d(u,"refreshComplete",function(){return ep});i.d(u,"refreshVirtualBlock",function(){return ku});i.d(u,"dblclick",function(){return vr});i.d(u,"toolbarRefresh",function(){return lt});i.d(u,"bulkSave",function(){return el});i.d(u,"autoCol",function(){return wi});i.d(u,"tooltipDestroy",function(){return bi});i.d(u,"updateData",function(){return du});i.d(u,"editBegin",function(){return tn});i.d(u,"editComplete",function(){return rn});i.d(u,"addBegin",function(){return un});i.d(u,"addComplete",function(){return fn});i.d(u,"saveComplete",function(){return yo});i.d(u,"deleteBegin",function(){return en});i.d(u,"deleteComplete",function(){return po});i.d(u,"preventBatch",function(){return ot});i.d(u,"dialogDestroy",function(){return te});i.d(u,"crudAction",function(){return wo});i.d(u,"addDeleteAction",function(){return bo});i.d(u,"destroyForm",function(){return ie});i.d(u,"doubleTap",function(){return gu});i.d(u,"beforeExcelExport",function(){return op});i.d(u,"excelExportComplete",function(){return sp});i.d(u,"excelQueryCellInfo",function(){return hp});i.d(u,"excelHeaderQueryCellInfo",function(){return cp});i.d(u,"exportDetailDataBound",function(){return ol});i.d(u,"beforePdfExport",function(){return lp});i.d(u,"pdfExportComplete",function(){return sl});i.d(u,"pdfQueryCellInfo",function(){return ap});i.d(u,"pdfHeaderQueryCellInfo",function(){return vp});i.d(u,"accessPredicate",function(){return on});i.d(u,"contextMenuClick",function(){return hl});i.d(u,"freezeRender",function(){return ki});i.d(u,"freezeRefresh",function(){return sn});i.d(u,"contextMenuOpen",function(){return yp});i.d(u,"columnMenuClick",function(){return pp});i.d(u,"columnMenuOpen",function(){return wp});i.d(u,"filterOpen",function(){return ko});i.d(u,"filterDialogCreated",function(){return re});i.d(u,"filterMenuClose",function(){return ue});i.d(u,"initForeignKeyColumn",function(){return go});i.d(u,"getForeignKeyData",function(){return fe});i.d(u,"generateQuery",function(){return iu});i.d(u,"showEmptyGrid",function(){return cl});i.d(u,"foreignKeyData",function(){return ll});i.d(u,"columnDataStateChange",function(){return bp});i.d(u,"dataStateChange",function(){return nf});i.d(u,"dataSourceChanged",function(){return al});i.d(u,"rtlUpdated",function(){return ns});i.d(u,"beforeFragAppend",function(){return ts});i.d(u,"frozenHeight",function(){return ru});i.d(u,"textWrapRefresh",function(){return is});i.d(u,"recordAdded",function(){return ee});i.d(u,"cancelBegin",function(){return tf});i.d(u,"editNextValCell",function(){return rf});i.d(u,"hierarchyPrint",function(){return rs});i.d(u,"expandChildGrid",function(){return us});i.d(u,"printGridInit",function(){return kp});i.d(u,"exportRowDataBound",function(){return vl});i.d(u,"exportDataBound",function(){return dp});i.d(u,"rowPositionChanged",function(){return yl});i.d(u,"columnChooserOpened",function(){return gp});i.d(u,"batchForm",function(){return nw});i.d(u,"beforeStartEdit",function(){return tw});i.d(u,"beforeBatchCancel",function(){return iw});i.d(u,"batchEditFormRendered",function(){return rw});i.d(u,"partialRefresh",function(){return uu});i.d(u,"beforeCustomFilterOpen",function(){return uw});i.d(u,"selectVirtualRow",function(){return pl});i.d(u,"columnsPrepared",function(){return fs});i.d(u,"cBoxFltrBegin",function(){return es});i.d(u,"cBoxFltrComplete",function(){return oe});i.d(u,"fltrPrevent",function(){return uf});i.d(u,"beforeFltrcMenuOpen",function(){return fw});i.d(u,"valCustomPlacement",function(){return ew});i.d(u,"filterCboxValue",function(){return ow});i.d(u,"componentRendered",function(){return sw});i.d(u,"restoreFocus",function(){return fu});i.d(u,"detailStateChange",function(){return wl});i.d(u,"detailIndentCellInfo",function(){return bl});i.d(u,"virtaulKeyHandler",function(){return hn});i.d(u,"virtaulCellFocus",function(){return kl});i.d(u,"virtualScrollEditActionBegin",function(){return se});i.d(u,"virtualScrollEditSuccess",function(){return ff});i.d(u,"virtualScrollEditCancel",function(){return dl});i.d(u,"virtualScrollEdit",function(){return gl});i.d(u,"refreshVirtualCache",function(){return he});i.d(u,"editReset",function(){return ce});i.d(u,"virtualScrollAddActionBegin",function(){return le});i.d(u,"getVirtualData",function(){return eu});i.d(u,"refreshInfiniteModeBlocks",function(){return na});i.d(u,"resetInfiniteBlocks",function(){return os});i.d(u,"infiniteScrollHandler",function(){return ss});i.d(u,"infinitePageQuery",function(){return hs});i.d(u,"infiniteShowHide",function(){return cs});i.d(u,"appendInfiniteContent",function(){return ls});i.d(u,"removeInfiniteRows",function(){return as});i.d(u,"setInfiniteCache",function(){return vs});i.d(u,"infiniteEditHandler",function(){return ae});i.d(u,"initialCollapse",function(){return ys});i.d(u,"getAggregateQuery",function(){return cn});i.d(u,"closeFilterDialog",function(){return ps});i.d(u,"columnChooserCancelBtnClick",function(){return hw});i.d(u,"getFilterBarOperator",function(){return cw});i.d(u,"resetColumns",function(){return ws});i.d(u,"pdfAggregateQueryCellInfo",function(){return ta});i.d(u,"excelAggregateQueryCellInfo",function(){return lw});i.d(u,"setGroupCache",function(){return ia});i.d(u,"lazyLoadScrollHandler",function(){return ra});i.d(u,"groupCollapse",function(){return bs});i.d(u,"beforeCheckboxRenderer",function(){return aw});i.d(u,"refreshHandlers",function(){return ve});i.d(u,"beforeRefreshOnDataChange",function(){return ks});i.d(u,"immutableBatchCancel",function(){return vw});i.d(u,"Data",function(){return ye});i.d(u,"Sort",function(){return pf});i.d(u,"Page",function(){return fo});i.d(u,"Selection",function(){return ub});i.d(u,"Filter",function(){return yh});i.d(u,"Search",function(){return fb});i.d(u,"Scroll",function(){return ca});i.d(u,"resizeClassList",function(){return ti});i.d(u,"Resize",function(){return ph});i.d(u,"Reorder",function(){return oit});i.d(u,"RowDD",function(){return sit});i.d(u,"Group",function(){return br});i.d(u,"getCloneProperties",function(){return gtt});i.d(u,"Print",function(){return th});i.d(u,"DetailRow",function(){return hit});i.d(u,"Toolbar",function(){return cit});i.d(u,"Aggregate",function(){return pit});i.d(u,"summaryIterator",function(){return rd});i.d(u,"VirtualScroll",function(){return wit});i.d(u,"Edit",function(){return git});i.d(u,"BatchEdit",function(){return vd});i.d(u,"InlineEdit",function(){return pv});i.d(u,"NormalEdit",function(){return yv});i.d(u,"DialogEdit",function(){return yd});i.d(u,"ColumnChooser",function(){return nrt});i.d(u,"ExcelExport",function(){return kv});i.d(u,"PdfExport",function(){return dv});i.d(u,"ExportHelper",function(){return yu});i.d(u,"ExportValueFormatter",function(){return bv});i.d(u,"Clipboard",function(){return ob});i.d(u,"CommandColumn",function(){return irt});i.d(u,"CheckBoxFilter",function(){return sv});i.d(u,"menuClass",function(){return a});i.d(u,"ContextMenu",function(){return rrt});i.d(u,"Freeze",function(){return ert});i.d(u,"ColumnMenu",function(){return ort});i.d(u,"ExcelFilter",function(){return id});i.d(u,"ForeignKey",function(){return hrt});i.d(u,"Logger",function(){return crt});i.d(u,"detailLists",function(){return gd});i.d(u,"gridObserver",function(){return sb});i.d(u,"BlazorAction",function(){return dtt});i.d(u,"InfiniteScroll",function(){return vrt});i.d(u,"LazyLoadGroup",function(){return prt});i.d(u,"Column",function(){return wt});i.d(u,"CommandColumnModel",function(){return ig});i.d(u,"Row",function(){return kt});i.d(u,"Cell",function(){return st});i.d(u,"HeaderRender",function(){return ds});i.d(u,"ContentRender",function(){return of});i.d(u,"RowRenderer",function(){return dt});i.d(u,"CellRenderer",function(){return ht});i.d(u,"HeaderCellRenderer",function(){return ww});i.d(u,"FilterCellRenderer",function(){return kk});i.d(u,"StackedHeaderCellRenderer",function(){return fa});i.d(u,"Render",function(){return gw});i.d(u,"IndentCellRenderer",function(){return gs});i.d(u,"GroupCaptionCellRenderer",function(){return kw});i.d(u,"GroupCaptionEmptyCellRenderer",function(){return dw});i.d(u,"BatchEditRender",function(){return ed});i.d(u,"DialogEditRender",function(){return od});i.d(u,"InlineEditRender",function(){return vv});i.d(u,"EditRender",function(){return sd});i.d(u,"BooleanEditCell",function(){return hd});i.d(u,"DefaultEditCell",function(){return ad});i.d(u,"DropDownEditCell",function(){return cd});i.d(u,"NumericEditCell",function(){return ld});i.d(u,"DatePickerEditCell",function(){return wv});i.d(u,"CommandColumnRenderer",function(){return bd});i.d(u,"FreezeContentRender",function(){return gv});i.d(u,"FreezeRender",function(){return ny});i.d(u,"StringFilterUI",function(){return gk});i.d(u,"NumberFilterUI",function(){return nd});i.d(u,"DateFilterUI",function(){return ov});i.d(u,"BooleanFilterUI",function(){return td});i.d(u,"FlMenuOptrUI",function(){return dk});i.d(u,"AutoCompleteEditCell",function(){return wrt});i.d(u,"ComboboxEditCell",function(){return brt});i.d(u,"MultiSelectEditCell",function(){return krt});i.d(u,"TimePickerEditCell",function(){return drt});i.d(u,"ToggleEditCell",function(){return grt});i.d(u,"MaskedTextBoxCellEdit",function(){return nut});i.d(u,"VirtualContentRenderer",function(){return cv});i.d(u,"VirtualHeaderRenderer",function(){return lv});i.d(u,"VirtualElementHandler",function(){return av});i.d(u,"GroupLazyLoadRenderer",function(){return ng});i.d(u,"CellRendererFactory",function(){return nb});i.d(u,"ServiceLocator",function(){return tb});i.d(u,"RowModelGenerator",function(){return vi});i.d(u,"GroupModelGenerator",function(){return be});i.d(u,"FreezeRowModelGenerator",function(){return wh});i.d(u,"ValueFormatter",function(){return er});i.d(u,"VirtualRowModelGenerator",function(){return hv});i.d(u,"InterSectionObserver",function(){return ud});i.d(u,"Pager",function(){return ev});i.d(u,"ExternalMessage",function(){return wk});i.d(u,"NumericContainer",function(){return vk});i.d(u,"PagerMessage",function(){return yk});i.d(u,"PagerDropDown",function(){return pk});var h,ut,dh,gh=i(9),r=i(0),e=i(1),er=function(){function n(n){this.intl=new r.Internationalization;Object(r.isNullOrUndefined)(n)||(this.intl.culture=n)}return n.prototype.getFormatFunction=function(n){return n.type?(Object(r.isBlazor)()&&(n.isServerRendered=!0),this.intl.getDateFormat(n)):this.intl.getNumberFormat(n)},n.prototype.getParserFunction=function(n){return n.type?(Object(r.isBlazor)()&&(n.isServerRendered=!0),this.intl.getDateParser(n)):this.intl.getNumberParser(n)},n.prototype.fromView=function(n,t,i){return"date"!==i&&"datetime"!==i&&"number"!==i||Object(r.isNullOrUndefined)(t)?n:t(n)},n.prototype.toView=function(n,t){var i=n;return Object(r.isNullOrUndefined)(t)||Object(r.isNullOrUndefined)(n)||(i=t(n)),i},n.prototype.setCulture=function(n){Object(r.isNullOrUndefined)(n)||Object(r.setCulture)(n)},n}(),nc=function(n,t,i,r){var f,e=arguments.length,u=e<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r,o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(n,t,i,r);else for(o=n.length-1;o>=0;o--)(f=n[o])&&(u=(e<3?f(u):e>3?f(t,i,u):f(t,i))||u);return e>3&&u&&Object.defineProperty(t,i,u),u},wt=function(){function n(n,t){var i=this,f,u;this.disableHtmlEncode=!0;this.allowSorting=!0;this.allowResizing=!0;this.allowFiltering=!0;this.allowGrouping=!0;this.allowReordering=!0;this.showColumnMenu=!0;this.enableGroupByFormat=!1;this.allowEditing=!0;this.filter={};this.showInColumnChooser=!0;this.edit={};this.allowSearching=!0;this.autoFit=!1;this.sortDirection="Descending";this.getEditTemplate=function(){return i.editTemplateFn};this.getFilterTemplate=function(){return i.filterTemplateFn};Object(r.merge)(this,n);this.parent=t;"none"===this.type?this.type=Object(r.isBlazor)()&&!Object(r.isNullOrUndefined)(this.template)&&Object(r.isNullOrUndefined)(this.field)?"none":null:this.type&&(this.type="string"==typeof this.type?this.type.toLowerCase():void 0);this.editType&&(this.editType=this.editType.toLowerCase());Object(r.isNullOrUndefined)(this.uid)&&(this.uid=ei("grid-column"));f=new er;(n.format&&(n.format.skeleton||n.format.format)&&(this.setFormatter(f.getFormatFunction(Object(r.extend)({},n.format))),this.setParser(f.getParserFunction(n.format))),this.toJSON=function(){for(var f,u={},e=["filter","dataSource",Object(r.isBlazor)()?" ":"headerText","template","headerTemplate","edit","editTemplate","filterTemplate","commandsTemplate","parent"],t=Object.keys(i),n=0;n<t.length;n++)if("columns"===t[n])for(u[t[n]]=[],f=0;f<i[t[n]].length;f++)u[t[n]].push(i[t[n]][f].toJSON());else e.indexOf(t[n])<0&&(u[t[n]]=i[t[n]]);return u},this.field||(this.allowFiltering=!1,this.allowGrouping=!1,this.allowSorting=!1,this.columns&&(this.allowResizing=this.columns.some(function(n){return n.allowResizing}))),this.commands&&!this.textAlign&&(this.textAlign="Right"),(this.template||this.commandsTemplate)&&(this.templateFn=et(this.template||this.commandsTemplate)),this.headerTemplate&&(this.headerTemplateFn=et(this.headerTemplate)),!Object(r.isNullOrUndefined)(this.filter)&&this.filter.itemTemplate&&(this.fltrTemplateFn=et(this.filter.itemTemplate)),this.editTemplate&&(this.editTemplateFn=et(this.editTemplate)),this.filterTemplate&&(this.filterTemplateFn=et(this.filterTemplate)),this.isForeignColumn()&&(Object(r.isNullOrUndefined)(this.editType)||"dropdownedit"===this.editType||"defaultedit"===this.editType)&&(this.editType="dropdownedit",this.edit.params=Object(r.extend)({dataSource:this.dataSource,query:new e.Query,fields:{value:this.foreignKeyField||this.field,text:this.foreignKeyValue}},this.edit.params)),this.sortComparer)&&(u=this.sortComparer,this.sortComparer=function(n,t,i,r){var f,e;return("string"==typeof u&&(u=k(u,window)),"Descending"===this.sortDirection)&&(f=n,n=t,t=f,e=i,i=r,r=e),u(n,t,i,r)});!this.sortComparer&&this.isForeignColumn()&&(this.sortComparer=function(n,t){return n=k(i.foreignKeyValue,tr(i,{},n)[0]),t=k(i.foreignKeyValue,tr(i,{},t)[0]),"Descending"===i.sortDirection?e.DataUtil.fnDescending(n,t):e.DataUtil.fnAscending(n,t)})}return n.prototype.getSortDirection=function(){return this.sortDirection},n.prototype.setSortDirection=function(n){this.sortDirection=n},n.prototype.setProperties=function(n){for(var t=this,r=Object.keys(n),i=0;i<r.length;i++)this[r[i]]=n[r[i]],this.parent&&this.parent.isReact&&"template"===r[i]&&this.parent.clearTemplate(["columnTemplate"],void 0,function(){for(var r,i=t.parent.getRowsObject(),u=t.parent.getPrimaryKeyFieldNames()[0],n=0;n<i.length;n++)r=i[n].data[u],t.parent.setCellValue(r,t.field,i[n][t.field])})},n.prototype.isForeignColumn=function(){return!(!this.dataSource||!this.foreignKeyValue)},n.prototype.getFormatter=function(){return this.formatFn},n.prototype.setFormatter=function(n){this.formatFn=n},n.prototype.getParser=function(){return this.parserFn},n.prototype.setParser=function(n){this.parserFn=n},n.prototype.getColumnTemplate=function(){return this.templateFn},n.prototype.getHeaderTemplate=function(){return this.headerTemplateFn},n.prototype.getFilterItemTemplate=function(){return this.fltrTemplateFn},n.prototype.getDomSetter=function(){return this.disableHtmlEncode?"textContent":"innerHTML"},n}(),ig=function(){function n(){}return nc([Object(r.Property)()],n.prototype,"title",void 0),nc([Object(r.Property)()],n.prototype,"type",void 0),nc([Object(r.Property)()],n.prototype,"buttonOption",void 0),n}(),ft=i(3),rg="create",ug="destroy",tc="load",ic="rowDataBound",eo="queryCellInfo",rc="headerCellInfo",l="actionBegin",c="actionComplete",hi="actionFailure",ct="dataBound",oo="rowSelecting",wf="rowSelected",uc="rowDeselecting",fc="rowDeselected",wu="cellSelecting",bf="cellSelected",ec="cellDeselecting",oc="cellDeselected",so="columnSelecting",ho="columnSelected",sc="columnDeselecting",hc="columnDeselected",kr="columnDragStart",or="columnDrag",dr="columnDrop",iy="rowDragStartHelper",ry="rowDragStart",uy="rowDrag",fy="rowDrop",cc="beforePrint",lc="printComplete",sr="detailDataBound",ey="toolbarClick",kf="batchAdd",gr="batchCancel",df="batchDelete",oy="beforeBatchAdd",sy="beforeBatchDelete",hy="beforeBatchSave",cy="beginEdit",ly="cellEdit",ay="cellSave",vy="cellSaved",fg="endAdd",eg="endDelete",og="endEdit",yy="recordDoubleClick",py="recordClick",ac="beforeDataBound",wy="beforeOpenColumnChooser",by="resizeStart",ky="resizing",vc="resizeStop",dy="checkBoxChange",gy="beforeCopy",np="beforePaste",tp="beforeAutoFill",yc="filterchoicerequest",pc="filterafteropen",wc="filterbeforeopen",ip="filtersearchbegin",rp="commandClick",bc="exportGroupCaption",up="lazyLoadGroupExpand",fp="lazyLoadGroupCollapse",ii="initial-load",tt="initial-end",at="data-ready",y="content-ready",v="ui-update",bt="on-empty",d="inbound-model-changed",p="model-changed",gf="colgroup-refresh",g="header-refreshed",sg="paging-begin",kc="paging-complete",hg="sorting-begin",ne="sorting-complete",cg="filtering-begin",dc="filtering-complete",lg="searching-begin",gc="searching-complete",ag="reorder-begin",nl="reorder-complete",vg="rowdraganddrop-begin",yg="rowdraganddrop-complete",pg="grouping-begin",co="grouping-complete",wg="ungrouping-begin",tl="ungrouping-complete",pi="group-aggregates",ai="refresh-footer-rendered",il="refresh-aggregate-cell",rl="refresh-aggregates",bg="rowselecting",ul="rowselected",kg="columnselecting",dg="columnselected",gg="cellselecting",fl="cellselected",hr="beforecellfocused",cr="cellfocused",w="key-pressed",it="click",ri="destroy",ui="column-visible-changed",lo="scroll",nu="column-width-changed",lr="column-position-changed",nn="row-drag-and-drop",ao="rows-added",bu="rows-removed",vo="column-drag-stop",tu="header-drop",ar="datasource-modified",ep="refresh-complete",ku="refresh-virtual-block",vr="dblclick",lt="toolbar-refresh",el="bulk-save",wi="auto-col",bi="tooltip-destroy",du="update-data",tn="edit-begin",rn="edit-complete",un="add-begin",fn="add-complete",yo="save-complete",en="delete-begin",po="delete-complete",ot="prevent-batch",te="dialog-destroy",wo="crud-Action",bo="add-delete-Action",ie="destroy-form",gu="double-tap",op="beforeExcelExport",sp="excelExportComplete",hp="excelQueryCellInfo",cp="excelHeaderQueryCellInfo",ol="exportdetaildatabound",lp="beforePdfExport",sl="pdfExportComplete",ap="pdfQueryCellInfo",vp="pdfHeaderQueryCellInfo",on="access-predicate",hl="contextMenuClick",ki="freezerender",sn="freezerefresh",yp="contextMenuOpen",pp="columnMenuClick",wp="columnMenuOpen",ko="filterOpen",re="filterDialogCreated",ue="filter-menu-close",go="initForeignKeyColumn",fe="getForeignKeyData",iu="generateQuery",cl="showEmptyGrid",ll="foreignKeyData",bp="columnDataStateChange",nf="dataStateChange",al="dataSourceChanged",ns="rtl-updated",ts="beforeFragAppend",ru="frozenHeight",is="textWrapRefresh",ee="recordAdded",tf="cancel-Begin",rf="editNextValCell",rs="hierarchyprint",us="expandchildgrid",kp="printGrid-Init",vl="export-RowDataBound",dp="export-DataBound",yl="row-position-changed",gp="columnChooserOpened",nw="batchedit-form",tw="edit-form",iw="before-batch-cancel",rw="batcheditform-rendered",uu="partial-refresh",uw="beforeCustomFilterOpen",pl="select-virtual-Row",fs="columns-prepared",es="cbox-filter-begin",oe="cbox-filter-complete",uf="filter-Prevent",fw="before-filter-cmenu-open",ew="validation-custom-placement",ow="filter-cbox-value",sw="component-rendered",fu="restore-Focus",wl="detail-state-change",bl="detail-indentcell-info",hn="virtaul-key-handler",kl="virtaul-cell-focus",se="virtual-scroll-edit-action-begin",ff="virtual-scroll-edit-success",dl="virtual-scroll-edit-cancel",gl="virtual-scroll-edit",he="refresh-virtual-cache",ce="edit-reset",le="virtual-scroll-add-action-begin",eu="get-virtual-data",na="refresh-infinite-mode-blocks",os="reset-infinite-blocks",ss="infinite-scroll-handler",hs="infinite-page-query",cs="infinite-show-hide",ls="append-infinite-content",as="remove-infinite-rows",vs="set-infinite-cache",ae="infinite-edit-handler",ys="initial-collapse",cn="get-aggregate-query",ps="close-filter-dialog",hw="columnChooserCancelBtnClick",cw="get-filterbar-operator",ws="reset-columns",ta="pdfAggregateQueryCellInfo",lw="excelAggregateQueryCellInfo",ia="group-cache",ra="lazy-load-scroll-handler",bs="group-collapse",aw="beforeCheckboxRenderer",ve="refreshResizeHandlers",ks="before-refresh-on-data-change",vw="immutable-batch-cancel";!function(n){n[n.Data=0]="Data";n[n.Header=1]="Header";n[n.Summary=2]="Summary";n[n.GroupSummary=3]="GroupSummary";n[n.CaptionSummary=4]="CaptionSummary";n[n.Filter=5]="Filter";n[n.Indent=6]="Indent";n[n.GroupCaption=7]="GroupCaption";n[n.GroupCaptionEmpty=8]="GroupCaptionEmpty";n[n.Expand=9]="Expand";n[n.HeaderIndent=10]="HeaderIndent";n[n.StackedHeader=11]="StackedHeader";n[n.DetailHeader=12]="DetailHeader";n[n.DetailExpand=13]="DetailExpand";n[n.CommandColumn=14]="CommandColumn";n[n.DetailFooterIntent=15]="DetailFooterIntent";n[n.RowDragIcon=16]="RowDragIcon";n[n.RowDragHIcon=17]="RowDragHIcon"}(h||(h={})),function(n){n[n.Header=0]="Header";n[n.Content=1]="Content";n[n.Summary=2]="Summary"}(ut||(ut={})),function(n){n[n.Add=0]="Add";n[n.Edit=1]="Edit";n[n.Update=2]="Update";n[n.Delete=3]="Delete";n[n.Cancel=4]="Cancel";n[n.Print=5]="Print";n[n.Search=6]="Search";n[n.ColumnChooser=7]="ColumnChooser";n[n.PdfExport=8]="PdfExport";n[n.ExcelExport=9]="ExcelExport";n[n.CsvExport=10]="CsvExport";n[n.WordExport=11]="WordExport"}(dh||(dh={}));var ua,ye=function(){function n(n,t){this.dataState={isPending:!1,resolver:null,group:[]};this.foreignKeyDataState={isPending:!1,resolver:null};this.parent=n;this.serviceLocator=t;this.initDataManager();this.parent.isDestroyed||"foreignKey"===this.getModuleName()||(this.parent.on(ao,this.addRows,this),this.parent.on(yl,this.reorderRows,this),this.parent.on(bu,this.removeRows,this),this.parent.on(ar,this.initDataManager,this),this.parent.on(ri,this.destroy,this),this.parent.on(du,this.crudActions,this),this.parent.on(bo,this.getData,this),this.parent.on(wi,this.refreshFilteredCols,this),this.parent.on(fs,this.refreshFilteredCols,this))}return n.prototype.reorderRows=function(n){this.dataManager.dataSource.json.splice(n.toIndex,0,this.dataManager.dataSource.json.splice(n.fromIndex,1)[0])},n.prototype.getModuleName=function(){return"data"},n.prototype.initDataManager=function(){var n=this.parent;this.dataManager=n.dataSource instanceof e.DataManager?n.dataSource:Object(r.isNullOrUndefined)(n.dataSource)?new e.DataManager:new e.DataManager(n.dataSource);this.isQueryInvokedFromData=!0;n.query=n.query instanceof e.Query?n.query:new e.Query},n.prototype.generateQuery=function(n){var t=this.parent.getQuery().clone();if("ExcludeHidden"===this.parent.columnQueryMode)t.select(this.parent.getColumns().filter(function(n){return!(!0!==n.isPrimaryKey&&!1===n.visible||void 0===n.field)}).map(function(n){return n.field}));else if("Schema"===this.parent.columnQueryMode){for(var r=[],u=this.parent.columns,i=0;i<u.length;i++)r.push(u[i].field);t.select(r)}return this.filterQuery(t),this.searchQuery(t),this.aggregateQuery(t),this.sortQuery(t),nt(this.parent)?this.virtualGroupPageQuery(t):this.pageQuery(t,n),this.groupQuery(t),t},n.prototype.aggregateQuery=function(n){for(var f,i,u=this.parent.aggregates,t=0;t<u.length;t++)for(f=u[t],i=0;i<f.columns.length;i++)for(var r=f.columns[i],o=r.type instanceof Array?r.type:[r.type],e=0;e<o.length;e++)n.aggregate(o[e].toLowerCase(),r.field);return n},n.prototype.virtualGroupPageQuery=function(n){if(this.parent,n.queries.length)for(var t=0;t<n.queries.length;t++)"onPage"===n.queries[t].fn&&n.queries.splice(t,1);return n},n.prototype.pageQuery=function(n,t){var i=this.parent,u;if((i.allowPaging||i.enableVirtualization||i.enableInfiniteScrolling)&&!0!==t){if(i.pageSettings.currentPage=Math.max(1,i.pageSettings.currentPage),i.pageSettings.pageCount<=0&&(i.pageSettings.pageCount=8),i.pageSettings.pageSize<=0&&(i.pageSettings.pageSize=12),n.queries.length)for(u=0;u<n.queries.length;u++)"onPage"===n.queries[u].fn&&n.queries.splice(u,1);!Object(r.isNullOrUndefined)(i.infiniteScrollModule)&&i.enableInfiniteScrolling?this.parent.notify(hs,n):n.page(i.pageSettings.currentPage,i.pageSettings.pageSize)}return n},n.prototype.groupQuery=function(n){var u=this.parent,r,f,e;if(u.allowGrouping&&u.groupSettings.columns.length){this.parent.groupSettings.enableLazyLoading&&n.lazyLoad.push({key:"isLazyLoad",value:this.parent.groupSettings.enableLazyLoading});for(var i=u.groupSettings.columns,t=0,o=i.length;t<o;t++)r=this.getColumnByField(i[t]),r||this.parent.log("initial_action",{moduleName:"group",columnName:i[t]}),f=r.enableGroupByFormat,e=r.format,f?n.group(i[t],this.formatGroupColumn.bind(this),e):n.group(i[t],null)}return n},n.prototype.sortQuery=function(n){var f=this.parent,e,o,i;if((f.allowSorting||f.allowGrouping)&&f.sortSettings.columns.length){for(var r=f.sortSettings.columns,u=[],t=r.length-1;t>-1;t--){if(!(i=this.getColumnByField(r[t].field)))return this.parent.log("initial_action",{moduleName:"sort",columnName:r[t].field}),n;i.setSortDirection(r[t].direction);e=r[t].direction;i.sortComparer&&(this.parent.log("grid_sort_comparer"),e=this.isRemote()?r[t].direction:i.sortComparer.bind(i));-1===f.groupSettings.columns.indexOf(r[t].field)?i.isForeignColumn()||i.sortComparer?n.sortByForeignKey(i.field,e,void 0,r[t].direction.toLowerCase()):n.sortBy(i.field,e):u.push({direction:e,field:i.field})}for(t=0,o=u.length;t<o;t++)"string"==typeof u[t].direction?n.sortBy(u[t].field,u[t].direction):(i=this.getColumnByField(u[t].field),n.sortByForeignKey(u[t].field,u[t].direction,void 0,i.getSortDirection().toLowerCase()))}return n},n.prototype.searchQuery=function(n,t,i){var r=this.parent.searchSettings,u=r.fields.length?r.fields:this.getSearchColumnFieldNames(),o=[],l=!1,s,f,h,c;if(this.parent.searchSettings.key.length)if(l=this.parent.getForeignKeyColumns().some(function(n){return u.indexOf(n.field)>-1}),s=i?t.dataSource.adaptor:this.dataManager.adaptor,l||s.getModuleName&&"ODataV4Adaptor"===s.getModuleName()){for(u=i?[t.foreignKeyValue]:u,f=0;f<u.length;f++)h=i?t:this.getColumnByField(u[f]),h.isForeignColumn()&&!i?o=this.fGeneratePredicate(h,o):o.push(new e.Predicate(u[f],r.operator,r.key,r.ignoreCase,r.ignoreAccent));c=e.Predicate.or(o);c.key=r.key;n.where(c)}else n.search(r.key,u,r.operator,r.ignoreCase,r.ignoreAccent);return n},n.prototype.filterQuery=function(n,t,i){var f=this.parent,s=[],et=[],ot=this.parent.getForeignKeyColumns(),u,l,h,ut,a,v,g,y,p,nt;if(f.allowFiltering&&f.filterSettings.columns.length){for(var tt=t||f.filterSettings.columns,st={},w=0,it=f.getColumns();w<it.length;w++)st[(u=it[w]).field]=u.filter.type?u.filter.type:f.filterSettings.type;for(var b=[],o=[],k=0,rt=tt;k<rt.length;k++)u=rt[k],l=f.getColumnByField(u.field),Object(r.isNullOrUndefined)(u.type)&&l&&("date"===l.type||"datetime"===l.type)&&(u.type=f.getColumnByField(u.field).type),u.isForeignKey?b.push(u):o.push(u);if(o.length){if("FilterBar"===f.filterSettings.type||"Menu"===f.filterSettings.type)for(h=0,ut=o.length;h<ut;h++)o[h].uid=o[h].uid||this.parent.grabColumnByFieldFromAllCols(o[h].field).uid;for(var c=au.getPredicate(o),d=0,ft=Object.keys(c);d<ft.length;d++)a=ft[d],s.push(c[a])}if(b.length)for(v=0,g=b;v<g.length;v++)if((u=g[v]).uid=u.uid||this.parent.grabColumnByFieldFromAllCols(u.field).uid,y=this.parent.grabColumnByUidFromAllCols(u.uid),y||this.parent.log("initial_action",{moduleName:"filter",columnName:u.field}),y.isForeignColumn()&&af(u.field,ot)&&!i)et.push(u),s=this.fGeneratePredicate(y,s);else for(c=au.getPredicate(tt),p=0,nt=Object.keys(c);p<nt.length;p++)a=nt[p],s.push(c[a]);s.length?n.where(e.Predicate.and(s)):this.parent.notify(cl,{})}return n},n.prototype.fGeneratePredicate=function(n,t){var i={};return n&&(this.parent.notify(iu,{predicate:i,column:n}),i.predicate.predicates.length&&t.push(i.predicate)),t},n.prototype.getData=function(n,t){var e=this,u,i,f;if(void 0===n&&(n={requestType:""}),u=this.getKey(n.foreignKeyData&&Object.keys(n.foreignKeyData).length?n.foreignKeyData:this.parent.getPrimaryKeyFieldNames()),this.parent.log("datasource_syntax_mismatch",{dataState:this.parent}),this.parent.dataSource&&"result"in this.parent.dataSource)return this.eventPromise(n,t,u).promise;i=void 0;switch(n.requestType){case"delete":(t=t||this.generateQuery(),1===Object.keys(n.data).length)?i=this.dataManager.remove(u,n.data[0],t.fromTable,t):(f={addedRecords:[],deletedRecords:[],changedRecords:[]},f.deletedRecords=n.data,i=this.dataManager.saveChanges(f,u,t.fromTable,t.requiresCount()));break;case"save":Object(r.isBlazor)()&&this.parent.isServerRendered&&this.parent.notify("offset",n);t=t||this.generateQuery();n.index=Object(r.isNullOrUndefined)(n.index)?0:n.index;i=this.dataManager.insert(n.data,t.fromTable,t,n.index)}return n.promise=i,!i||Array.isArray(i)||i.hasOwnProperty("deletedRecords")?this.insert(t,n):Object(r.isBlazor)()?i.then(function(){return e.insert(t,n)}).catch(function(){return null}):i.then(function(){return e.insert(t,n)})},n.prototype.insert=function(n,t){return"save"===t.requestType&&this.parent.notify(ee,t),this.executeQuery(n)},n.prototype.executeQuery=function(n){var i=this,t;return this.dataManager.ready?(t=new e.Deferred,this.dataManager.ready.then(function(){i.dataManager.executeQuery(n).then(function(n){t.resolve(n)})}).catch(function(n){t.reject(n)}),t.promise):this.dataManager.executeQuery(n)},n.prototype.formatGroupColumn=function(n,t){this.parent;var f=this.serviceLocator,i=this.getColumnByField(t),u=n;return i.type||(i.type=u.getDay?u.getHours()>0||u.getMinutes()>0||u.getSeconds()>0||u.getMilliseconds()>0?"datetime":"date":typeof n),Object(r.isNullOrUndefined)(i.getFormatter())&&da(f,i),er.prototype.toView(n,i.getFormatter())},n.prototype.crudActions=function(n){var t=this.generateQuery(),i=null,u="promise",f=this.getKey(n.foreignKeyData&&Object.keys(n.foreignKeyData).length?n.foreignKeyData:this.parent.getPrimaryKeyFieldNames());switch(this.parent.dataSource&&"result"in this.parent.dataSource&&this.eventPromise(n,t,f),n.requestType){case"save":Object(r.isBlazor)()&&this.parent.isServerRendered&&this.parent.notify("offset",n);i=this.dataManager.update(f,n.data,t.fromTable,t,n.previousData)}n[u]=i||n[u];this.parent.notify(wo,n)},n.prototype.saveChanges=function(n,t,i,u){var s,o,f;if(void 0===u&&(u=this.generateQuery()),u.requiresCount(),"result"in this.parent.dataSource)return this.getStateEventArgument(u),s=new e.Deferred,o={requestType:"batchsave",changes:n,key:t,query:u,endEdit:s.resolve},this.setState({isPending:!0,resolver:s.resolve}),this.parent.trigger(al,o),s.promise;if(Object(r.isBlazor)()&&this.parent.isServerRendered){for(f=0;f<n.changedRecords.length;f++)o={data:n.changedRecords[f]},this.parent.notify("offset",o),n.changedRecords[f]=o.data;for(f=0;f<n.addedRecords.length;f++)o={data:n.addedRecords[f]},this.parent.notify("offset",o),n.addedRecords[f]=o.data}return this.dataManager.saveChanges(n,t,u.fromTable,u,i)},n.prototype.getKey=function(n){if(n&&n.length)return n[0]},n.prototype.isRemote=function(){return!0!==this.dataManager.dataSource.offline&&void 0!==this.dataManager.dataSource.url&&""!==this.dataManager.dataSource.url},n.prototype.addRows=function(n){for(var t=n.records.length;t>0;t--)this.dataManager.dataSource.json.splice(n.toIndex,0,n.records[t-1])},n.prototype.removeRows=function(n){var t=this.dataManager.dataSource.json;this.dataManager.dataSource.json=t.filter(function(t){return-1===n.records.indexOf(t)})},n.prototype.getColumnByField=function(n){var t;return this.parent.columnModel.some(function(i){return t=i,i.field===n})&&t},n.prototype.destroy=function(){this.parent.isDestroyed||(this.parent.off(ao,this.addRows),this.parent.off(bu,this.removeRows),this.parent.off(ar,this.initDataManager),this.parent.off(ri,this.destroy),this.parent.off(du,this.crudActions),this.parent.off(bo,this.getData),this.parent.off(wi,this.refreshFilteredCols),this.parent.off(fs,this.refreshFilteredCols))},n.prototype.getState=function(){return this.dataState},n.prototype.setState=function(n){return this.dataState=n},n.prototype.getForeignKeyDataState=function(){return this.foreignKeyDataState},n.prototype.setForeignKeyDataState=function(n){this.foreignKeyDataState=n},n.prototype.getStateEventArgument=function(n){var i=new e.UrlAdaptor,u=new e.DataManager({url:"",adaptor:new e.UrlAdaptor}),t=i.processQuery(u,n),f=JSON.parse(t.data);return Object(r.extend)(f,t.pvtData)},n.prototype.eventPromise=function(n,t,i){var r,s=this,h=n,o,f,u;return r=this.getStateEventArgument(t),o=new e.Deferred,f=new e.Deferred,void 0!==n.requestType&&!1!==this.dataState.isDataChanged?(r.action=n,"save"===n.requestType||"delete"===n.requestType)?(u=n,u.key=i,u.promise=f.promise,u.state=r,this.setState({isPending:!0,resolver:f.resolve}),h.endEdit=f.resolve,h.cancelEdit=f.reject,this.parent.trigger(al,u),f.promise.then(function(){s.setState({isPending:!0,resolver:o.resolve,group:r.group,aggregates:r.aggregates});"save"===u.requestType&&s.parent.notify(ee,u);s.parent.trigger(nf,r)}).catch(function(){})):(this.setState({isPending:!0,resolver:o.resolve,group:r.group,aggregates:r.aggregates}),this.parent.trigger(nf,r)):(this.setState({}),o.resolve(this.parent.dataSource)),o},n.prototype.getSearchColumnFieldNames=function(){for(var n,i=[],t=0,u=this.parent.getColumns();t<u.length;t++)n=u[t],n.allowSearching&&!Object(r.isNullOrUndefined)(n.field)&&i.push(n.field);return i},n.prototype.refreshFilteredCols=function(){this.parent.allowFiltering&&this.parent.filterSettings.columns.length&&sk(this.parent,this.parent.filterSettings.columns)},n}(),kt=function(){function n(n,t){Object(r.merge)(this,n);this.parent=t}return n.prototype.clone=function(){var t=new n({});return Object(r.merge)(t,this),t.cells=this.cells.map(function(n){return n.clone()}),t},n.prototype.setRowValue=function(n){var t=this.data[this.parent.getPrimaryKeyFieldNames()[0]];this.parent.setRowData(t,n)},n.prototype.setCellValue=function(n,t){if(!(this.data[n].toString()===t.toString())){var i=this.parent.getPrimaryKeyFieldNames()[0],r=this.data[i];this.parent.setCellValue(r,n,t);this.makechanges(i,this.data)}},n.prototype.makechanges=function(n,t){this.parent.getDataModule().dataManager.update(n,t)},n}(),st=function(){function n(n){this.isSpanned=!1;this.isRowSpanned=!1;Object(r.merge)(this,n)}return n.prototype.clone=function(){var t=new n({});return Object(r.merge)(t,this),t},n}(),yw=function(){function n(n,t){this.serviceLocator=n;this.parent=t}return n.prototype.render=function(n,t,i,u){var o,y=this.serviceLocator.getService("cellRendererFactory").getCellRenderer(t.cells[i].cellType||h.Data),f=t.cells[i].cellSpan?t.cells[i].cellSpan:n.colSpan+i<=t.cells.length?n.colSpan:t.cells.length-i,c=n.rowSpan,s=0,l,a,v,e;for(t.index>0&&(l=this.parent.groupSettings.columns.length>0&&!this.parent.getRowsObject()[t.index-1].isDataRow?this.parent.getRowsObject()[t.index].cells:this.parent.getRowsObject()[t.index-1].cells,a=t.cells[i],o=l.filter(function(n){return n.column.uid===a.column.uid})[0]),v=o&&o.colSpanRange>1&&o.rowSpanRange>1?o.colSpanRange:f,e=i+1;e<i+v&&e<t.cells.length;e++)!1===t.cells[e].visible?s++:t.cells[e].isSpanned=!0;if(s>0){for(e=i+f;e<i+f+s&&e<t.cells.length;e++)t.cells[e].isSpanned=!0;i+f+s>=t.cells.length&&(f-=i+f+s-t.cells.length)}return t.cells[i].cellSpan&&(t.data[n.column.field]=t.cells[i].spanText,u=y.render(t.cells[i],t.data,{index:Object(r.isNullOrUndefined)(t.index)?"":t.index.toString()})),f>1&&Object(r.attributes)(u,{colSpan:f.toString(),"aria-colSpan":f.toString()}),c>1&&(Object(r.attributes)(u,{rowspan:c.toString(),"aria-rowspan":c.toString()}),t.cells[i].isRowSpanned=!0,t.cells[i].rowSpanRange=Number(c),f>1&&(t.cells[i].colSpanRange=Number(f))),t.index>0&&o.rowSpanRange>1&&(t.cells[i].isSpanned=!0,t.cells[i].rowSpanRange=Number(o.rowSpanRange-1),t.cells[i].colSpanRange=o.rowSpanRange>0?o.colSpanRange:1),!this.parent.enableColumnVirtualization||t.cells[i].cellSpan||this.containsKey(n.column.field,n.data[n.column.field])||this.backupMergeCells(n.column.field,n.data[n.column.field],n.colSpan),u},n.prototype.backupMergeCells=function(n,t,i){this.setMergeCells(this.generteKey(n,t),i)},n.prototype.generteKey=function(n,t){return n+"__"+t.toString()},n.prototype.splitKey=function(n){return n.split("__")},n.prototype.containsKey=function(n,t){return this.getMergeCells().hasOwnProperty(this.generteKey(n,t))},n.prototype.getMergeCells=function(){return this.parent.mergeCells},n.prototype.setMergeCells=function(n,t){this.parent.mergeCells[n]=t},n.prototype.updateVirtualCells=function(n){for(var i,f,r,e=this.getMergeCells(),u=0,o=Object.keys(e);u<o.length;u++){var s=o[u],a=e[s],t=this.splitKey(s),h=this.getIndexFromAllColumns(t[0]),c=this.parent.getColumnIndexesInView(),l=a-(c[0]-h);if(h<c[0]&&l>1)for(i=0,f=n;i<f.length;i++)if(r=f[i],r.data[t[0]].toString()===t[1].toString()){r.cells[0].cellSpan=l;r.cells[0].spanText=t[1];break}}return n},n.prototype.getIndexFromAllColumns=function(n){return yr(this.parent.getVisibleColumns(),function(t,i){if(t.field===n)return i})[0]},n}(),dt=function(){function n(n,t,i){this.isSpan=!1;this.cellType=t;this.serviceLocator=n;this.parent=i;this.element=this.parent.createElement("tr",{attrs:{role:"row"}})}return n.prototype.render=function(n,t,i,r,u){return this.refreshRow(n,t,i,r,u)},n.prototype.refresh=function(n,t,i,r,u){var f,e,s;i&&(n.data=ro({},n.changes),this.refreshMergeCells(n));var o=this.parent.element.querySelector("[data-uid="+n.uid+"]"),h=this.refreshRow(n,t,r,u,null,i),c=[].slice.call(h.cells);for(o.innerHTML="",f=0,e=c;f<e.length;f++)s=e[f],o.appendChild(s)},n.prototype.refreshRow=function(n,t,i,u,f,e){var o=Object(r.isNullOrUndefined)(f)?this.element.cloneNode():f,l={data:n.data},a={data:n.data},g=Object(r.extend)({},i,{}),p=this.parent.getColumns().filter(function(n){return"checkbox"===n.type&&n.field})[0],w=!1,b,y,v,d;p&&(w=k(p.field,l.data));n.isDataRow&&(n.isSelected=this.parent.getSelectedRowIndexes().indexOf(n.index)>-1||w);n.isDataRow&&this.parent.isCheckBoxSelection&&"Check"===this.parent.checkAllRows&&this.parent.enableVirtualization&&(n.isSelected=!0,-1===this.parent.getSelectedRowIndexes().indexOf(n.index)&&this.parent.getSelectedRowIndexes().push(n.index));this.buildAttributeFromRow(o,n);Object(r.attributes)(o,g);yi(o,n.attributes);for(var nt=this.serviceLocator.getService("cellRendererFactory"),tt=function(t){var u=n.cells[t],v,c,i,l,y,f;u.isSelected=n.isSelected;u.isColumnSelected=u.column.isSelected;v=nt.getCellRenderer(n.cells[t].cellType||h.Data);c={index:Object(r.isNullOrUndefined)(n.index)?"":n.index.toString()};n.isExpand&&n.cells[t].cellType===h.DetailExpand&&(c.class=s.parent.isPrinting?"e-detailrowcollapse":"e-detailrowexpand");i=v.render(n.cells[t],n.data,c,n.isExpand,e);n.cells[t].cellType!==h.Filter&&((n.cells[t].cellType===h.Data||n.cells[t].cellType===h.CommandColumn)&&(s.parent.trigger(eo,Object(r.extend)(a,{cell:i,column:u.column,colSpan:1,rowSpan:1,foreignKeyData:n.cells[t].foreignKeyData,requestType:s.parent.requestTypeAction})),l=!1,n.index>0&&s.isSpan&&(y=s.parent.groupSettings.columns.length>0&&!s.parent.getRowsObject()[n.index-1].isDataRow?s.parent.getRowsObject()[n.index].cells:s.parent.getRowsObject()[n.index-1].cells,f=y.filter(function(i){return i.column.uid===n.cells[t].column.uid})[0],l=f.isRowSpanned?f.isRowSpanned:f.rowSpanRange>1),(a.colSpan>1||n.cells[t].cellSpan>1||a.rowSpan>1||l)&&(s.isSpan=!0,i=new yw(s.serviceLocator,s.parent).render(a,n,t,i))),n.cells[t].isSpanned||o.appendChild(i))},s=this,c=0,it=n.cells.length;c<it;c++)tt(c);if(b={row:o,rowHeight:this.parent.rowHeight},n.isDataRow&&(this.parent.trigger(ic,Object(r.extend)(l,b)),this.parent.childGrid||this.parent.isRowDragable()||this.parent.detailTemplate)&&(y=o.querySelectorAll(".e-rowcell:not(.e-hide)")[0],y&&y.classList.add("e-detailrowvisible")),this.parent.enableVirtualization&&(l.rowHeight=this.parent.rowHeight),l.rowHeight?o.style.height=l.rowHeight+"px":this.parent.rowHeight&&(o.querySelector(".e-headercell")||o.querySelector(".e-groupcaption"))&&(o.style.height=this.parent.rowHeight+"px"),n.cssClass&&o.classList.add(n.cssClass),n.lazyLoadCssClass&&o.classList.add(n.lazyLoadCssClass),!(this.parent.enableColumnVirtualization&&0!==this.parent.frozenColumns)&&this.parent.element.scrollHeight>this.parent.height&&this.parent.aggregates.length)for(c=0;c<this.parent.aggregates.length;c++)this.parent.aggregates[c].properties.columns[0].footerTemplate&&(v=o.querySelectorAll(".e-summarycell"),v.length&&(d=v[v.length-1],Object(r.addClass)([d],["e-lastsummarycell"])));return o},n.prototype.refreshMergeCells=function(n){for(var t=0,i=n.cells;t<i.length;t++)i[t].isSpanned=!1;return n},n.prototype.buildAttributeFromRow=function(n,t){var i={},u=[];t.isDataRow&&u.push("e-row");t.isAltRow&&u.push("e-altrow");Object(r.isNullOrUndefined)(t.index)||(i["aria-rowindex"]=t.index);t.rowSpan&&(i.rowSpan=t.rowSpan);t.uid&&(i["data-uid"]=t.uid);t.isSelected&&(i["aria-selected"]=!0);!1===t.visible&&u.push("e-hide");i.class=u;yi(n,i)},n}(),vi=function(){function n(n){this.parent=n}return n.prototype.generateRows=function(n,t){var u=[],r=this.parent.enableVirtualization&&t?t.startIndex:0,i,f;for(r=this.parent.enableInfiniteScrolling&&t?this.getInfiniteIndex(t):r,i=0,f=Object.keys(n).length;i<f;i++,r++)u[i]=this.generateRow(n[i],r);return u},n.prototype.ensureColumns=function(){var n=[],t;return(this.parent.detailTemplate||this.parent.childGrid)&&(t={},this.parent.notify(bl,t),n.push(this.generateCell(t,null,h.DetailExpand))),this.parent.isRowDragable()&&n.push(this.generateCell({},null,h.RowDragIcon)),n},n.prototype.generateRow=function(n,t,i,u,f,e,o){var s={foreignKeyData:{}},c,h;return s.uid=Object(r.isBlazor)()&&this.parent.isServerRendered?this.parent.getRowUid("grid-row"):ei("grid-row"),s.data=n,s.index=t,s.indent=u,s.tIndex=e,s.isDataRow=!0,s.parentGid=f,s.parentUid=o,this.parent.isPrinting&&("All"===this.parent.hierarchyPrintMode?s.isExpand=!0:"Expanded"===this.parent.hierarchyPrintMode&&this.parent.expandedRows&&this.parent.expandedRows[t]&&(s.isExpand=this.parent.expandedRows[t].isExpand)),s.cssClass=i,s.isAltRow=!!this.parent.enableAltRow&&t%2!=0,s.isAltRow=!!this.parent.enableAltRow&&t%2!=0,Object(r.isBlazor)()&&this.parent.isServerRendered&&this.parent.enableVirtualization&&this.parent.selectionModule.checkBoxState?(s.isSelected=this.parent.selectionModule.checkBoxState,s.isSelected&&-1===this.parent.selectionModule.selectedRowIndexes.indexOf(t)&&this.parent.selectionModule.selectedRowIndexes.push(t)):s.isSelected=this.parent.getSelectedRowIndexes().indexOf(t)>-1,this.refreshForeignKeyRow(s),c=this.ensureColumns(),h=new kt(s,this.parent),h.cells=c.concat(this.generateCells(s)),h},n.prototype.refreshForeignKeyRow=function(n){for(var i=this.parent.getForeignKeyColumns(),t=0;t<i.length;t++)Object(r.setValue)(i[t].field,tr(i[t],n.data),n.foreignKeyData)},n.prototype.generateCells=function(n){for(var i=this.parent.getColumns(),u=[],t=0;t<i.length;t++)u.push(this.generateCell(i[t],n.uid,Object(r.isNullOrUndefined)(i[t].commands)?void 0:h.CommandColumn,null,t,n.foreignKeyData));return u},n.prototype.generateCell=function(n,t,i,u,f,e){var o={visible:n.visible,isDataCell:!Object(r.isNullOrUndefined)(n.field||n.template),isTemplate:!Object(r.isNullOrUndefined)(n.template),rowID:t,column:n,cellType:Object(r.isNullOrUndefined)(i)?h.Data:i,colSpan:u,commands:n.commands,isForeignKey:n.isForeignColumn&&n.isForeignColumn(),foreignKeyData:n.isForeignColumn&&n.isForeignColumn()&&Object(r.getValue)(n.field,e)};return(o.isDataCell||"checkbox"===o.column.type||o.commands)&&(o.index=f),new st(o)},n.prototype.refreshRows=function(n){for(var t=0;t<n.length;t++)this.refreshForeignKeyRow(n[t]),n[t].cells=this.generateCells(n[t]);return n},n.prototype.getInfiniteIndex=function(n){return"infiniteScroll"===n.requestType||"delete"===n.requestType||"add"===n.action?n.startIndex:0},n}(),pw=(ua=function(n,t){return(ua=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}ua(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),pe=function(){function n(n){this.parent=n}return n.prototype.getData=function(){for(var t,u=this,i=[],r=this.parent.aggregates.slice(),n=0;n<r.length;n++)t=r[n].columns.filter(function(n){return!(n.footerTemplate||n.groupFooterTemplate||n.groupCaptionTemplate)||u.columnSelector(n)}),t.length&&i.push({columns:t});return i},n.prototype.columnSelector=function(n){return void 0!==n.footerTemplate},n.prototype.getColumns=function(n,t){var i=[],u;if(this.parent.allowGrouping)for(u=0;u<this.parent.groupSettings.columns.length;u++)i.push(new wt({}));return(this.parent.detailTemplate||!Object(r.isNullOrUndefined)(this.parent.childGrid)||this.parent.isRowDragable()&&!n)&&i.push(new wt({})),i.push.apply(i,this.parent.getColumns()),t=t?t+this.parent.getIndentCount():t,Object(r.isNullOrUndefined)(n)?i:i.slice(n,t)},n.prototype.generateRows=function(n,t,i,r,u){if(0===n.length&&(void 0===t||!t.count))return[];for(var s=this.buildSummaryData(n,t),e=[],o=this.getData(),f=0;f<o.length;f++)e.push(this.getGeneratedRow(o[f],s[f],t?t.level:void 0,i,r,t?t.parentUid:void 0,u));return e},n.prototype.getGeneratedRow=function(n,t,i,u,f,e,o){var l=[],v=this.getIndentByLevel(i),y=!Object(r.isNullOrUndefined)(this.parent.childGrid),p=this.parent.getIndentCount(),a,s,c;for(this.parent.isRowDragable()&&(v=["e-indentcelltop"]),a=o||this.getColumns(u,f),s=0;s<a.length;s++)l.push(this.getGeneratedCell(a[s],n,s>=p?this.getCellType():s<this.parent.groupSettings.columns.length?h.Indent:h.DetailFooterIntent,v[s],y));return c=new kt({data:t,attributes:{"class":"e-summaryrow"}}),c.cells=l,c.uid=Object(r.isBlazor)()&&this.parent.isServerRendered&&!Object(r.isNullOrUndefined)(e)?this.parent.getRowUid("grid-row"):ei("grid-row"),c.parentUid=e,c.visible=l.some(function(n){return n.isDataCell&&n.visible}),c},n.prototype.getGeneratedCell=function(n,t,i,u,f){var e=t.columns.filter(function(t){return t.columnName===n.field})[0],o={style:{textAlign:n.textAlign},"e-mappinguid":n.uid,index:n.index},s;return u&&(o.class=u),Object(r.isNullOrUndefined)(u)&&f&&(o.class="e-detailindentcelltop"),s={visible:n.visible,isDataCell:!Object(r.isNullOrUndefined)(e),isTemplate:e&&!Object(r.isNullOrUndefined)(e.footerTemplate||e.groupFooterTemplate||e.groupCaptionTemplate),column:e||{},attributes:o,cellType:i},s.column.headerText=n.headerText,new st(s)},n.prototype.buildSummaryData=function(n,t){for(var f,r,e=[],o=this.getData(),i={},u=0;u<o.length;u++){for(i={},f=o[u].columns,r=0;r<f.length;r++)i=this.setTemplate(f[r],t&&t.aggregates?t:n,i);e.push(i)}return e},n.prototype.getIndentByLevel=function(){return this.parent.groupSettings.columns.map(function(){return"e-indentcelltop"})},n.prototype.setTemplate=function(n,t,i){var f=n.type,c={},l=n.getFormatter()||function(n){return n},u=t,e;for(f instanceof Array||(f=[n.type]),e=0;e<f.length;e++){var s=n.field+" - "+f[e].toLowerCase(),o=n.columnName,h="Custom"!==f[e]&&u.aggregates&&s in u.aggregates?u.aggregates[s]:wa(f[e],u.aggregates?u:t,n,this.parent);i[o]=i[o]||{};i[o][s]=h;i[o][f[e]]=Object(r.isNullOrUndefined)(h)?" ":l(h);u.field&&(i[o].field=u.field,i[o].key=u.key)}return c.format=n.getFormatter(),n.setTemplate(c),i},n.prototype.getCellType=function(){return h.Summary},n}(),ef=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return pw(t,n),t.prototype.columnSelector=function(n){return void 0!==n.groupFooterTemplate},t.prototype.getIndentByLevel=function(n){return void 0===n&&(n=this.parent.groupSettings.columns.length),this.parent.groupSettings.columns.map(function(t,i){return i<=n-1?"":"e-indentcelltop"})},t.prototype.getCellType=function(){return h.GroupSummary},t}(pe),we=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return pw(t,n),t.prototype.columnSelector=function(n){return void 0!==n.groupCaptionTemplate},t.prototype.getData=function(){return[n.prototype.getData.call(this).reduce(function(n,t){return n.columns=n.columns.concat(t.columns),n},{columns:[]})]},t.prototype.isEmpty=function(){return 0===(this.getData()[0].columns||[]).length},t.prototype.getCellType=function(){return h.CaptionSummary},t}(pe),ln=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),be=function(n){function t(t){var i=n.call(this,t)||this;return i.rows=[],i.index=0,i.parent=t,i.summaryModelGen=new ef(t),i.captionModelGen=new we(t),i}return ln(t,n),t.prototype.generateRows=function(t,i){if(0===this.parent.groupSettings.columns.length)return n.prototype.generateRows.call(this,t,i);this.isInfiniteScroll="infiniteScroll"===i.requestType;this.rows=[];this.index=this.parent.enableVirtualization||this.isInfiniteScroll?i.startIndex:0;for(var r=0,u=t.length;r<u;r++)this.getGroupedRecords(0,t[r],t.level,r,void 0,this.rows.length);return this.index=0,this.parent.isCollapseStateEnabled()&&this.ensureRowVisibility(),this.rows},t.prototype.getGroupedRecords=function(n,t,i,u,f,e,o){var a,y=this.isInfiniteScroll&&this.prevKey===t.key,p=i,h,v,c,l,s;if(Object(r.isNullOrUndefined)(t.items))if(Object(r.isNullOrUndefined)(t.GroupGuid))this.rows=this.rows.concat(this.generateDataRows(t,n,u,this.rows.length,o));else for(h=0,v=t.length;h<v;h++)this.getGroupedRecords(n,t[h],t.level,u,n,this.rows.length,o);else if(c=this.generateCaptionRow(t,n,u,f,e,o),y||(this.rows=this.rows.concat(c)),t.items&&t.items.length&&this.getGroupedRecords(n+1,t.items,t.items.level,u,n+1,this.rows.length,c.uid),this.parent.aggregates.length)for(l=this.rows.length,(a=this.rows).push.apply(a,this.summaryModelGen.generateRows(t,{level:p,parentUid:c.uid})),s=l-1;s>=0;s--)if(this.rows[s].isCaptionRow)this.rows[s].aggregatesCount=this.rows.length-l;else if(!this.rows[s].isCaptionRow&&!this.rows[s].isDataRow)break;this.prevKey=t.key},t.prototype.getCaptionRowCells=function(n,t,i){var f=[],u=[],s=this.parent.getColumnByField(n),p=this.parent.getColumnIndexesInView(),c,o,l,e,a,v,y;if(this.parent.enableColumnVirtualization&&(s=this.parent.columns.filter(function(t){return t.field===n})[0]),c=this.parent.groupSettings.columns.length,o=this.parent,!this.parent.enableColumnVirtualization||-1!==p.indexOf(t)){for(l=0;l<t;l++)f.push(this.generateIndentCell());f.push(this.generateCell({},null,h.Expand))}(t=this.parent.enableColumnVirtualization?1:this.parent.getVisibleColumns().length+c+(o.detailTemplate||o.childGrid?1:0)-t+(this.parent.getVisibleColumns().length?-1:0),this.parent.aggregates.length&&!this.captionModelGen.isEmpty())&&(e=this.captionModelGen.generateRows(i)[0],Object(r.extend)(i,e.data),a=0,e.cells.some(function(n,t){return a=t,n.visible&&n.isDataCell}),u=e.cells.slice(a).filter(function(n){return n.visible}),e.visible&&u[0].column.field===this.parent.getVisibleColumns()[0].field&&(u=u.slice(1)),1===this.parent.getVisibleColumns().length&&(u=[]),t-=u.length);for(var k=this.parent.enableColumnVirtualization?this.parent.getColumns():[s],w=!0,b=0;b<k.length;b++)v=w&&-1!==p.indexOf(t),v&&(w=!1),y=!this.parent.enableColumnVirtualization||v?h.GroupCaption:h.GroupCaptionEmpty,t=this.parent.enableColumnVirtualization&&y===h.GroupCaption?t+c:t,o.isRowDragable()&&t++,f.push(this.generateCell(s,null,y,t));return f.push.apply(f,u),f},t.prototype.generateCaptionRow=function(n,t,i,u,f,e){var o={},h=this.parent.getColumnByField(n.field),s;return o.data=Object(r.extend)({},n),h&&(o.data.field=n.field),o.isDataRow=!1,o.isExpand=!this.parent.groupSettings.enableLazyLoading&&!this.parent.isCollapseStateEnabled(),o.parentGid=i,o.childGid=u,o.tIndex=f,o.isCaptionRow=!0,o.parentUid=e,o.gSummary=Object(r.isNullOrUndefined)(n.items.records)?n.items.length:n.items.records.length,o.uid=Object(r.isBlazor)()&&this.parent.isServerRendered?this.parent.getRowUid("grid-row"):ei("grid-row"),s=new kt(o),s.indent=t,this.getForeignKeyData(s),s.cells=this.getCaptionRowCells(n.field,t,s.data),s},t.prototype.getForeignKeyData=function(n){var i=n.data,t=this.parent.getColumnByField(i.field),u;t&&t.isForeignColumn&&t.isForeignColumn()&&(u=Object(r.isNullOrUndefined)(i.key)?"":t.valueAccessor(t.foreignKeyValue,tr(t,{},i.key)[0],t),Object(r.setValue)("foreignKey",u,n.data))},t.prototype.generateDataRows=function(n,t,i,r,u){for(var o,e=[],s=this.parent.getColumnIndexesInView(),f=0,h=n.length;f<h;f++,r++){for(e[f]=this.generateRow(n[f],this.index,f?void 0:"e-firstchildrow",t,i,r,u),o=0;o<t;o++)this.parent.enableColumnVirtualization&&-1===s.indexOf(t)||e[f].cells.unshift(this.generateIndentCell());this.index++}return e},t.prototype.generateIndentCell=function(){return this.generateCell({},null,h.Indent)},t.prototype.refreshRows=function(n){for(var i,u,r=this.parent.getColumnIndexesInView(),t=0;t<n.length;t++)if(n[t].isDataRow)for(n[t].cells=this.generateCells(n[t]),i=0;i<n[t].indent;i++)this.parent.enableColumnVirtualization&&-1===r.indexOf(n[t].indent)||n[t].cells.unshift(this.generateIndentCell());else u=this.generateCaptionRow(n[t].data,n[t].indent),n[t].cells=u.cells;return n},t.prototype.ensureRowVisibility=function(){for(var i,t,r,n=0;n<this.rows.length;n++)if(i=this.rows[n],i.isCaptionRow)for(t=n+1;t<this.rows.length;t++)r=this.rows[t],i.uid===r.parentUid&&(this.rows[t].visible=i.isExpand)},t}(vi),of=function(){function n(n,t){var i=this;this.rows=[];this.freezeRows=[];this.movableRows=[];this.freezeRowElements=[];this.currentInfo={};this.prevCurrentView=[];this.isLoaded=!0;this.viewColIndexes=[];this.drop=function(n){(o(n.target,"e-row")||o(n.target,"e-emptyrow"))&&(i.parent.notify(dr,{target:n.target,droppedElement:n.droppedElement}),Object(r.remove)(n.droppedElement))};this.infiniteCache={};this.isRemove=!1;this.visibleRows=[];this.visibleFrozenRows=[];this.isAddRows=!1;this.isInfiniteFreeze=!1;this.useGroupCache=!1;this.mutableData=!1;this.rafCallback=function(n){var t=n;return function(){var r,f,e,o,u,s;i.parent.getFrozenColumns()&&i.parent.enableVirtualization&&(r=[].slice.call(i.parent.getMovableVirtualContent().querySelectorAll(".e-row")),f=[].slice.call(i.parent.getFrozenVirtualContent().querySelectorAll(".e-row")),(i.isLoaded=!!r&&r.length===f.length,i.parent.enableColumnVirtualization&&"virtualscroll"===n.requestType&&i.isLoaded)&&(e=[].slice.call(i.parent.getMovableVirtualHeader().querySelectorAll(".e-row")),o=[].slice.call(i.parent.getFrozenVirtualHeader().querySelectorAll(".e-row")),i.isLoaded=e.length===o.length));(i.ariaService.setBusy(i.getPanel().querySelector(".e-content"),!1),i.parent.isDestroyed)||(u=i.rows.slice(0),(0!==i.parent.getFrozenColumns()&&(u=n.isFrozen?i.freezeRows:i.movableRows),i.parent.notify(y,{rows:u,args:t}),i.isLoaded&&i.parent.trigger(ct,{},function(){i.parent.allowTextWrap&&i.parent.notify(ki,{"case":"textwrap"})}),t)&&(s=(t.requestType||"").toLowerCase()+"-complete",i.parent.notify(s,t),"batchsave"===n.requestType&&(n.cancel=!1,i.parent.trigger(c,n))),i.isLoaded&&i.parent.hideSpinner())}};this.parent=n;this.serviceLocator=t;this.ariaService=this.serviceLocator.getService("ariaService");this.mutableData=this.parent.getDataModule().isRemote();this.generator=this.getModelGenerator();this.parent.isDestroyed||(this.parent.enableColumnVirtualization||this.parent.enableVirtualization||this.parent.groupSettings.enableLazyLoading||this.parent.on(ui,this.setVisible,this),this.parent.on(gf,this.colGroupRefresh,this),this.parent.on(v,this.enableAfterRender,this),this.parent.on(na,this.refreshContentRows,this),this.parent.on(hr,this.beforeCellFocused,this),this.parent.on(ri,this.droppableDestroy,this))}return n.prototype.beforeCellFocused=function(n){this.pressedKey=!n.byKey||"upArrow"!==n.keyArgs.action&&"downArrow"!==n.keyArgs.action?void 0:n.keyArgs.action},n.prototype.renderPanel=function(){var i=this.parent,n=this.parent.element.querySelector(".e-gridcontent"),t;if(n)return this.ariaService.setOptions(this.parent.element.querySelector(".e-content"),{busy:!1}),void this.setPanel(n);n=this.parent.createElement("div",{className:"e-gridcontent"});t=this.parent.createElement("div",{className:"e-content"});this.ariaService.setOptions(t,{busy:!1});n.appendChild(t);this.setPanel(n);i.element.appendChild(n)},n.prototype.renderTable=function(){var n=this.getPanel(),t=n.querySelector(".e-virtualtable"),i=n.querySelector(".e-virtualtrack");!this.parent.enableVirtualization||Object(r.isNullOrUndefined)(t)||Object(r.isNullOrUndefined)(i)||Object(r.isBlazor)()&&(!Object(r.isBlazor)()||this.parent.isServerRendered)||(Object(r.remove)(t),Object(r.remove)(i));n.appendChild(this.createContentTable("_content_table"));this.setTable(n.querySelector(".e-table"));this.ariaService.setOptions(this.getTable(),{multiselectable:"Multiple"===this.parent.selectionSettings.type});this.initializeContentDrop();this.parent.frozenRows&&this.parent.getHeaderContent().classList.add("e-frozenhdrcont")},n.prototype.createContentTable=function(n){var t=this.getPanel().firstElementChild,i;return Object(r.isBlazor)()||this.getTable()&&Object(r.remove)(this.getTable()),i=t.querySelector(".e-table")?t.querySelector(".e-table"):this.parent.createElement("table",{className:"e-table",attrs:{cellspacing:"0.25px",role:"grid",id:this.parent.element.id+n}}),this.setColGroup(this.parent.element.querySelector(".e-gridheader").querySelector("colgroup").cloneNode(!0)),i.appendChild(this.getColGroup()),i.appendChild(this.parent.createElement("tbody")),t.appendChild(i),t},n.prototype.splitRows=function(n){this.parent.getFrozenColumns()&&(0===n?(this.freezeRows=this.rows,this.freezeRowElements=this.rowElements):this.movableRows=this.rows)},n.prototype.refreshContentRows=function(n){var u=this,i,tt,e,ot,l,vt,st,yt,ht,it,ii,ri,ui,ct,fi,pt,v,ei,si,wt,hi,ci;if(void 0===n&&(n={}),i=this.parent,0!==i.currentViewData.length){var p=this.currentMovableRows||i.currentViewData,ut=i.isReact&&!Object(r.isNullOrUndefined)(i.rowTemplate),c=ut?i.createElement("tbody"):document.createDocumentFragment();this.initialPageRecords||(this.initialPageRecords=Object(r.extend)([],p));var s,g,bt,w=ut?i.createElement("tbody"):document.createDocumentFragment(),lt=i.getColumns(),a=i.getFrozenColumns(),at=new dt(this.serviceLocator,null,this.parent),ft=this.parent.enableInfiniteScrolling&&"infiniteScroll"===n.requestType;this.rowElements=[];this.rows=[];var f,b=this.getPanel().querySelector(".e-frozencontent"),h=this.getPanel().querySelector(".e-movablecontent"),et=this.getPanel().querySelector(".e-content");if(nt(i)&&["sorting","filtering","searching","grouping","ungrouping","reorder"].some(function(t){return n.requestType===t})&&(i.vcRows=[],i.vRows=[]),Object(r.isBlazor)()&&this.parent.isServerRendered){if(f=this.generator.generateRows(p,n),this.parent.enableVirtualization&&(this.prevInfo=this.prevInfo?this.prevInfo:n.virtualInfo,this.prevInfo=n.virtualInfo.sentinelInfo&&"Y"===n.virtualInfo.sentinelInfo.axis&&this.currentInfo.page&&this.currentInfo.page!==n.virtualInfo.page?this.currentInfo:n.virtualInfo),this.rows=f,this.freezeRows=f,this.rowElements=[].slice.call(this.getTable().querySelectorAll("tr.e-row[data-uid]")),a&&(this.movableRows=f.map(function(n){var t=new kt(n);return t.cells=n.cells.slice(a,n.cells.length),n.cells=n.cells.slice(0,a),t}),this.freezeRowElements=this.rowElements),this.isLoaded=!0,this.parent.hideSpinner(),n.isFrozen=0!==this.parent.getFrozenColumns()&&!n.isFrozen,tt=Object(r.extend)({rows:this.rows},n),(this.getTable().querySelector(".e-emptyrow")&&(Object(r.remove)(this.getTable().querySelector(".e-emptyrow")),Object(r.isNullOrUndefined)(this.getTable().querySelectorAll(".e-table > tbody")[1])||Object(r.remove)(this.getTable().querySelectorAll(".e-table > tbody")[1])),this.parent.notify("contentcolgroup",{}),this.rafCallback(tt)(),a&&(et.style.overflowY="hidden",b.style.height=h.offsetHeight-oi()+"px",h.style.overflowY="auto"!==this.parent.height?"scroll":"auto",b.style.borderRightWidth="1px",this.parent.notify(y,{rows:this.movableRows,args:Object(r.extend)({},tt,{isFrozen:!1})})),(this.parent.isCheckBoxSelection||"Multiple"===this.parent.selectionSettings.type)&&(this.parent.isPersistSelection||this.parent.enableVirtualization))||"Normal"!==this.parent.editSettings.mode||Object(r.isNullOrUndefined)(n.editRowIndex)||this.parent.selectRow(n.editRowIndex),this.parent.enableVirtualization&&!this.parent.getHeaderContent().querySelectorAll(".e-check").length){for(var k=this.parent.getRows().filter(function(n){return n.getAttribute("aria-selected")}).map(function(n){return n.getAttribute("data-uid")}),d=this.parent.getRows().filter(function(n){return null===n.getAttribute("aria-selected")}).map(function(n){return n.getAttribute("data-uid")}),t=0;t<k.length;t++)if(!Object(r.isNullOrUndefined)(this.parent.getRowObjectFromUID(k[t]))&&!this.parent.getRowObjectFromUID(k[t]).isSelected)for(this.parent.getRowElementByUID(k[t]).removeAttribute("aria-selected"),Object(r.isNullOrUndefined)(this.parent.getRowElementByUID(k[t]).querySelector(".e-check"))||Object(r.removeClass)([this.parent.getRowElementByUID(k[t]).querySelector(".e-check")],["e-check"]),e=0;e<this.parent.getRowElementByUID(k[t]).children.length;e++)this.parent.getRowElementByUID(k[t]).children[e].classList.remove("e-selectionbackground","e-active");for(t=0;t<d.length;t++)if(!Object(r.isNullOrUndefined)(this.parent.getRowObjectFromUID(d[t]))&&this.parent.getRowObjectFromUID(d[t]).isSelected)for(this.parent.getRowElementByUID(d[t]).setAttribute("aria-selected","true"),Object(r.isNullOrUndefined)(this.parent.getRowElementByUID(d[t]).querySelector(".e-frame"))||Object(r.addClass)([this.parent.getRowElementByUID(d[t]).querySelector(".e-frame")],["e-check"]),e=0;e<this.parent.getRowElementByUID(d[t]).children.length;e++)this.parent.getRowElementByUID(d[t]).children[e].classList.add("e-selectionbackground","e-active")}}else{if(this.parent.enableVirtualization&&this.parent.getFrozenColumns()){if(this.parent.enableColumnVirtualization&&"virtualscroll"===n.requestType)if("X"===n.virtualInfo.sentinelInfo.axis)f=this.parent.contentModule.generateRows(p,n),n.renderMovableContent=!0;else if(h.scrollLeft>0&&!n.renderMovableContent){for(this.viewColIndexes=n.virtualInfo.columnIndexes,ot=[],t=0;t<this.parent.getFrozenColumns();t++)ot.push(t);this.parent.setColumnIndexesInView(ot);n.virtualInfo.columnIndexes=ot}f=this.parent.contentModule.generateRows(p,n)}else f=this.checkCache(f,n),this.isAddRows||this.useGroupCache||(f=this.generator.generateRows(p,n));if(this.setGroupCache(f,n),this.parent.notify(vs,{isInfiniteScroll:ft,modelData:f,args:n}),Object(r.isNullOrUndefined)(f[0].cells[0])&&(h.querySelector("tbody").innerHTML=""),l=f[0].cells[0].index,Object(r.isUndefined)(l)&&this.parent.getFrozenColumns()&&this.parent.isRowDragable()&&(l=f[0].cells[1].index),this.parent.enableColumnVirtualization&&this.parent.getFrozenColumns()&&n.renderMovableContent&&"virtualscroll"===n.requestType&&h.scrollLeft>0&&0!==n.virtualInfo.columnIndexes[0]&&(l=this.parent.getFrozenColumns()),"infiniteScroll"!==n.requestType&&this.parent.registeredTemplate&&this.parent.registeredTemplate.template&&!n.isFrozen){for(vt=[],t=0;t<this.parent.registeredTemplate.template.length;t++)for(e=0;e<this.parent.registeredTemplate.template[t].rootNodes.length;e++)Object(r.isNullOrUndefined)(this.parent.registeredTemplate.template[t].rootNodes[e].parentNode)&&vt.push(this.parent.registeredTemplate.template[t]);this.parent.destroyTemplate(["template"],vt)}if((this.parent.isReact&&"infiniteScroll"!==n.requestType&&!n.isFrozen&&(this.parent.destroyTemplate(["columnTemplate","rowTemplate","detailTemplate","captionTemplate","commandsTemplate"]),this.parent.renderTemplates()),this.parent.enableColumnVirtualization)&&new yw(this.serviceLocator,this.parent).updateVirtualCells(f),this.tbody=a&&l>=a?h.querySelector("tbody"):this.getTable().querySelector("tbody"),st=0,yt=!0,nt(i)&&i.vcRows.length&&(ht=Object(r.isNullOrUndefined)(n.virtualInfo.offsets)?Object(r.isNullOrUndefined)(n.scrollTop)?0:n.scrollTop.top:n.virtualInfo.offsets.top,0!==ht)){for(var gt=i.vGroupOffsets,ni=i.pageSettings.pageSize/2,ti=Object.keys(gt).map(function(n){return gt[n]}),o=0;o<ti.length;o++)if(ht<ti[o]){if(Object(r.isNullOrUndefined)(n.virtualInfo)||"up"!==n.virtualInfo.direction){n.virtualInfo.blockIndexes=0===o||1===o?[1,2]:[o,o+1];st=0===o||1===o?0:o*ni;break}n.virtualInfo.blockIndexes=0===o||1===o?[1,2]:[o,o+1];st=0===o||1===o?0:o*ni;break}ht+this.contentPanel.firstElementChild.offsetHeight!==this.contentPanel.firstElementChild.scrollHeight||n.rowObject||(yt=!1)}if(it=i.frozenRows&&!i.getFrozenColumns()&&this.parent.enableVirtualization&&"reorder"===n.requestType,i.frozenRows&&"virtualscroll"===n.requestType&&"X"===n.virtualInfo.sentinelInfo.axis||it){for(ii=n.virtualInfo.blockIndexes,ri=n.virtualInfo.page,n.virtualInfo.blockIndexes=[1,2],it&&(n.virtualInfo.page=1),ui=it?this.initialPageRecords:p,ct=this.vgenerator.generateRows(ui,n),ct.splice(this.parent.frozenRows),t=0;t<this.parent.frozenRows;t++)ct[t].cells.splice(0,this.parent.getFrozenColumns()),s=at.render(ct[t],lt),w.appendChild(s);n.virtualInfo.blockIndexes=ii;n.virtualInfo.page=ri;it&&1===n.virtualInfo.page&&f.splice(0,this.parent.frozenRows)}for(this.virtualFrozenHdrRefresh(w,f,at,n,p,lt),t=st,fi=f.length;t<fi;t++)if(this.rows.push(f[t]),!this.parent.groupSettings.enableLazyLoading||this.useGroupCache||!this.parent.groupSettings.columns.length||(this.setRowsInLazyGroup(f[t],t),!Object(r.isNullOrUndefined)(f[t].indent))){if(this.setInfiniteVisibleRows(n,f[t]),nt(i)&&this.rows.length>=i.pageSettings.pageSize&&yt)break;if(i.rowTemplate){if(pt=i.element.id+"rowTemplate",v=void 0,i.isReact?(ei=i.frozenRows&&t<i.frozenRows,si=Object(r.extend)({index:t},p[t]),i.getRowTemplate()(si,i,"rowTemplate",pt,null,null,ei?w:c),i.renderTemplates()):v=i.getRowTemplate()(Object(r.extend)({index:t},p[t]),i,"rowTemplate",pt),i.isReact||"TBODY"!==v[0].tagName)i.frozenRows&&t<i.frozenRows?s=i.isReact?w.lastElementChild:rt(w,v):(i.isReact||(s=rt(c,v)),bt=i.isReact?c.lastElementChild:s.lastElementChild);else{for(e=0;e<v.length;e++)wt="tr"===v[e].nodeName.toLowerCase(),(wt||v[e].querySelectorAll&&v[e].querySelectorAll("tr").length)&&(s=wt?v[e]:v[e].querySelector("tr"));i.frozenRows&&t<i.frozenRows?w.appendChild(s):c.appendChild(s)}tt={data:f[t].data,row:bt||s};this.parent.trigger(ic,tt)}else s=at.render(f[t],lt),hi=this.ensureFrozenHeaderRender(n),i.frozenRows&&t<i.frozenRows&&!ft&&"virtualscroll"!==n.requestType&&hi?w.appendChild(s):c.appendChild(s),f[t].isExpand&&i.notify(us,s.cells[i.groupSettings.columns.length]);f[t].isDataRow&&this.rowElements.push(s);this.ariaService.setOptions(this.getTable(),{colcount:i.getColumns().length.toString()})}(this.splitRows(l),i.frozenRows&&"virtualscroll"!==n.requestType&&!ft||"virtualscroll"===n.requestType&&n.virtualInfo.sentinelInfo&&"X"===n.virtualInfo.sentinelInfo.axis)&&((g=a?i.getHeaderContent().querySelector(0===l?".e-frozenheader":".e-movableheader").querySelector("tbody"):i.getHeaderTable().querySelector("tbody"),ut)?(ci=g.parentElement,Object(r.remove)(g),ci.appendChild(w)):(g.innerHTML="",g.appendChild(w)));!i.enableVirtualization&&i.frozenRows&&0===l&&et.offsetHeight===Number(i.height)&&(et.style.height=et.offsetHeight-g.offsetHeight+"px");a&&0===l&&(this.getPanel().firstChild.style.overflowY="hidden");Object(r.isBlazor)()&&!this.parent.isJsComponent||(n.rows=this.rows.slice(0));n.isFrozen=0!==this.parent.getFrozenColumns()&&!n.isFrozen;this.index=l;aa(function(){u.parent.notify(ts,n);var t=u.parent.enableVirtualization&&0!==u.parent.getFrozenColumns();u.parent.enableVirtualization||ft||(Object(r.remove)(u.tbody),u.tbody=u.parent.createElement("tbody"));!a||t||u.parent.enableInfiniteScrolling?(i.rowTemplate&&Object(r.updateBlazorTemplate)(i.element.id+"rowTemplate","RowTemplate",i),t?n.renderMovableContent?(u.appendContent(h.querySelector("tbody"),c,n),n.virtualInfo&&"right"!==n.virtualInfo.direction&&"left"!==n.virtualInfo.direction&&(b.style.height=h.offsetHeight-oi()+"px"),n.renderMovableContent=!1):(u.appendContent(b.querySelector("tbody"),c,n),u.parent.enableColumnVirtualization&&"virtualscroll"===n.requestType&&h.scrollLeft>0&&(u.parent.setColumnIndexesInView(u.viewColIndexes),n.virtualInfo.columnIndexes=u.viewColIndexes)):!Object(r.isNullOrUndefined)(u.parent.infiniteScrollModule)&&u.parent.enableInfiniteScrolling?(u.isAddRows=!1,u.parent.notify(as,{args:n}),u.parent.notify(ls,{tbody:u.tbody,frag:c,args:n,rows:u.rows,rowElements:u.rowElements,visibleRows:u.visibleRows}),a&&0!==l&&(b.style.height=h.offsetHeight-oi()+"px",h.style.overflowY="auto"!==u.parent.height?"scroll":"auto",b.style.borderRightWidth="1px")):(u.useGroupCache=!1,u.appendContent(u.tbody,c,n))):(ut?u.tbody=c:u.tbody.appendChild(c),0===u.index?(u.isLoaded=!1,b.querySelector("table").appendChild(u.tbody)):(u.tbody.childElementCount<1&&u.tbody.appendChild(u.parent.createElement("tr").appendChild(u.parent.createElement("td"))),u.isLoaded=!0,h.querySelector("table").appendChild(u.tbody),0===u.parent.getFrozenColumns()||u.parent.allowTextWrap||u.parent.notify(ki,{"case":"refreshHeight"}),b.style.height=h.offsetHeight-oi()+"px",h.style.overflowY="auto"!==u.parent.height?"scroll":"auto",b.style.borderRightWidth="1px"));a&&0===l&&(t&&(n.renderMovableContent=!0),u.refreshContentRows(Object(r.extend)({},n)));c=null},this.rafCallback(Object(r.extend)({},n)))}}},n.prototype.appendContent=function(n,t){this.parent.isReact&&!Object(r.isNullOrUndefined)(this.parent.rowTemplate)?this.getTable().appendChild(t):(n.appendChild(t),this.getTable().appendChild(n))},n.prototype.setRowsInLazyGroup=function(n,t){this.parent.groupSettings.enableLazyLoading&&!this.useGroupCache&&this.parent.groupSettings.columns.length&&this.parent.contentModule.maintainRows(n,t)},n.prototype.setGroupCache=function(n,t){!this.useGroupCache&&this.parent.groupSettings.enableLazyLoading&&this.parent.notify(ia,{args:t,data:n})},n.prototype.ensureFrozenHeaderRender=function(n){return!(this.parent.enableVirtualization&&("reorder"===n.requestType||"refresh"===n.requestType)||this.parent.infiniteScrollSettings.enableCache&&this.parent.frozenRows&&"delete"===this.parent.infiniteScrollModule.requestType&&1!==this.parent.pageSettings.currentPage)},n.prototype.checkCache=function(n,t){var i,u,f;return this.parent.infiniteScrollSettings.enableCache&&"infiniteScroll"===t.requestType?(i=t.isFrozen?1:0,u=this.parent.getFrozenColumns(),(this.isAddRows=!Object(r.isNullOrUndefined)(this.infiniteCache[this.parent.pageSettings.currentPage]),u&&!Object(r.isNullOrUndefined)(this.infiniteCache[this.parent.pageSettings.currentPage])&&(this.isAddRows=0!==this.infiniteCache[this.parent.pageSettings.currentPage][i].length),this.isAddRows)&&(f=u?this.infiniteCache[this.parent.pageSettings.currentPage][i]:this.infiniteCache[this.parent.pageSettings.currentPage],n=1===this.parent.pageSettings.currentPage?f.slice(this.parent.frozenRows):f),n):this.parent.groupSettings.enableLazyLoading&&this.parent.groupSettings.columns.length&&("paging"===t.requestType||"columnstate"===t.requestType||"reorder"===t.requestType)&&this.parent.contentModule.getGroupCache()[this.parent.pageSettings.currentPage]?(this.useGroupCache=!0,this.parent.contentModule.initialGroupRows("reorder"===t.requestType)):null},n.prototype.setInfiniteVisibleRows=function(n,t){var i=this.parent.getFrozenColumns();this.parent.enableInfiniteScrolling&&!this.parent.infiniteScrollSettings.enableCache&&(i?n.isFrozen?this.visibleRows.push(t):this.visibleFrozenRows.push(t):this.parent.infiniteScrollSettings.enableCache||this.visibleRows.push(t))},n.prototype.getCurrentBlockInfiniteRecords=function(n){var t=[],e,r,i;if(this.parent.infiniteScrollSettings.enableCache){if(!Object.keys(this.infiniteCache).length)return[];var s=this.parent.getFrozenColumns(),u=this.parent.getRows(),f=parseInt(u[this.parent.frozenRows].getAttribute("aria-rowindex"),10),o=Math.ceil((f+1)/this.parent.pageSettings.pageSize);if(f=parseInt(u[u.length-1].getAttribute("aria-rowindex"),10),e=Math.ceil(f/this.parent.pageSettings.pageSize),s){for(r=n?0:1,i=o;i<=e;i++)t=t.length?t.concat(this.infiniteCache[i][r]):this.infiniteCache[i][r];this.parent.frozenRows&&this.parent.pageSettings.currentPage>1&&(t=this.infiniteCache[1][r].slice(0,this.parent.frozenRows).concat(t))}else{for(i=o;i<=e;i++)t=t.length?t.concat(this.infiniteCache[i]):this.infiniteCache[i];this.parent.frozenRows&&this.parent.pageSettings.currentPage>1&&(t=this.infiniteCache[1].slice(0,this.parent.frozenRows).concat(t))}}return t},n.prototype.getReorderedVFRows=function(n){return this.parent.contentModule.getReorderedFrozenRows(n)},n.prototype.virtualFrozenHdrRefresh=function(n,t,i,r,u,f){var o,s,e;if(this.parent.frozenRows&&this.parent.getFrozenColumns()&&this.parent.enableVirtualization&&("reorder"===r.requestType||"refresh"===r.requestType)){for(o=void 0,this.currentMovableRows=u,s=this.getReorderedVFRows(r),e=0;e<s.length;e++)o=i.render(s[e],f),n.appendChild(o);1===r.virtualInfo.page&&t.splice(0,this.parent.frozenRows);r.renderMovableContent&&(this.parent.currentViewData=this.currentMovableRows,this.currentMovableRows=null)}},n.prototype.getInfiniteRows=function(){var n=[],r=this.parent.getFrozenColumns(),i,t;if(this.parent.enableInfiniteScrolling)if(this.parent.infiniteScrollSettings.enableCache)for(i=Object.keys(this.infiniteCache),t=0;t<i.length;t++)n=r?n.concat(this.infiniteCache[i[t]][0]):n.concat(this.infiniteCache[i[t]]);else n=r?this.visibleFrozenRows:this.visibleRows;return n},n.prototype.getInfiniteMovableRows=function(){var n=this.getCurrentBlockInfiniteRecords();return this.parent.enableInfiniteScrolling?n.length?n:this.visibleRows:[]},n.prototype.getPanel=function(){return this.contentPanel},n.prototype.setPanel=function(n){this.contentPanel=n},n.prototype.getTable=function(){return this.contentTable},n.prototype.setTable=function(n){this.contentTable=n},n.prototype.getRows=function(){var n=this.getInfiniteRows();return n.length?n:this.parent.getFrozenColumns()?this.freezeRows:this.rows},n.prototype.getMovableRows=function(){var n=this.getInfiniteMovableRows();return n.length?n:this.movableRows},n.prototype.getRowElements=function(){return this.parent.getFrozenColumns()?this.freezeRowElements:this.rowElements},n.prototype.getMovableRowElements=function(){return this.rowElements},n.prototype.setRowElements=function(n){this.rowElements=n},n.prototype.getColGroup=function(){return this.colgroup},n.prototype.setColGroup=function(n){return Object(r.isNullOrUndefined)(n)||(n.id="content-"+n.id),this.colgroup=n},n.prototype.setVisible=function(n){var t=this.parent,o,u,s,h,c,g,nt,tt;if(Object(r.isBlazor)()&&t.isServerRendered&&this.parent.notify("setvisibility",n),u=t.getFrozenColumns(),s=[],u)for(var w=this.freezeRows,b=this.movableRows,it=w.length,k=void 0,f=0,v=void 0;f<it;f++){for(k=b[f].cells.length,v=w[f].clone(),h=0;h<k;h++)v.cells.push(b[f].cells[h]);s.push(v)}else s=this.getRows();s.some(function(n){return n.isDataRow&&(o=n),n.isDataRow});c=!0;!t.groupSettings.columns.length&&o&&(c=!1);for(var y=t.getDataRows(),rt=this.infiniteRowVisibility(),l=rt||this.rows.filter(function(n){return!n.isDetailRow}),p=0,ut=n.length;p<ut;p++){var e=n[p],i=this.parent.getNormalizedColumnIndex(e.uid),d=this.parent.getColumnIndexByUid(e.uid),a=!0===e.visible?"":"none";-1!==i&&o&&i<o.cells.length&&(u?i<(this.parent.isRowDragable()?u+1:u)?(Object(r.setStyleAttribute)(this.getColGroup().childNodes[i],{display:a}),g=this.infiniteRowVisibility(!0),l=g||this.freezeRows,y=t.getDataRows()):(nt=t.getContent().querySelector(".e-movablecontent").querySelector("colgroup"),d=i-=u,Object(r.setStyleAttribute)(nt.childNodes[i],{display:a}),y=t.getMovableDataRows(),tt=this.infiniteRowVisibility(),l=tt||this.movableRows):Object(r.setStyleAttribute)(this.getColGroup().childNodes[i],{display:a}));c||this.setDisplayNone(y,d,a,l);!this.parent.invokedFromMedia&&e.hideAtMedia&&this.parent.updateMediaColumns(e);this.parent.invokedFromMedia=!1}c?this.refreshContentRows({requestType:"refresh"}):this.parent.getFrozenColumns()?(this.parent.notify(uu,{rows:this.freezeRows,args:{isFrozen:!0,rows:this.freezeRows}}),this.parent.notify(uu,{rows:this.movableRows,args:{isFrozen:!1,rows:this.movableRows}})):this.parent.notify(uu,{rows:l,args:{}})},n.prototype.setDisplayNone=function(n,t,i,u){for(var o,s,e=Object.keys(n),f=0;f<e.length;f++)o=n[e[f]].querySelectorAll("td.e-rowcell")[t],n[e[f]].querySelectorAll("td.e-rowcell").length&&o&&((Object(r.setStyleAttribute)(n[e[f]].querySelectorAll("td.e-rowcell")[t],{display:i}),n[e[f]].querySelectorAll("td.e-rowcell")[t].classList.contains("e-hide")&&Object(r.removeClass)([n[e[f]].querySelectorAll("td.e-rowcell")[t]],["e-hide"]),this.parent.isRowDragable())?(s=this.parent.getFrozenColumns()?t:t+1,u[e[f]].cells[s].visible=""===i):u[e[f]].cells[t].visible=""===i);this.parent.notify(cs,{visible:i,index:t,isFreeze:this.isInfiniteFreeze})},n.prototype.infiniteRowVisibility=function(n){var t;return this.parent.enableInfiniteScrolling&&(this.isInfiniteFreeze=n,t=this.parent.infiniteScrollSettings.enableCache?n?this.getCurrentBlockInfiniteRecords(!0):this.getCurrentBlockInfiniteRecords():n?this.visibleFrozenRows:this.visibleRows),t},n.prototype.colGroupRefresh=function(){if(this.getColGroup()){var n=void 0;n=this.parent.enableColumnVirtualization&&this.parent.getFrozenColumns()&&this.parent.contentModule.isXaxis()?this.parent.getMovableVirtualHeader().querySelector("colgroup").cloneNode(!0):Object(r.isBlazor)()?this.parent.getHeaderTable().querySelector("colgroup").cloneNode(!0):this.parent.element.querySelector(".e-gridheader").querySelector("colgroup").cloneNode(!0);this.getTable().replaceChild(n,this.getColGroup());this.setColGroup(n)}},n.prototype.initializeContentDrop=function(){var n=this.parent;this.droppable=new r.Droppable(n.element,{accept:".e-dragclone",drop:this.drop})},n.prototype.droppableDestroy=function(){this.droppable&&!this.droppable.isDestroyed&&this.droppable.destroy()},n.prototype.canSkip=function(n,t,i){return Object(r.isNullOrUndefined)(t)||Object(r.isNullOrUndefined)(n.visible)||t.cells[i].visible===n.visible},n.prototype.getModelGenerator=function(){return this.generator=this.parent.allowGrouping?new be(this.parent):new vi(this.parent)},n.prototype.renderEmpty=function(n){Object(r.isBlazor)()&&!this.parent.isJsComponent&&this.parent.frozenRows||(this.getTable().appendChild(n),this.parent.frozenRows&&(this.parent.getHeaderContent().querySelector("tbody").innerHTML=""))},n.prototype.setSelection=function(n,t,i){var o,u,f,r,s,e;if(this.parent.getFrozenColumns())for(o=this.getMovableRows().filter(function(t){return i||n===t.uid}),u=0;u<o.length;u++)o[u].isSelected=t;for(f=this.getRows().filter(function(t){return i||n===t.uid}),r=0;r<f.length;r++)for(f[r].isSelected=t,s=f[r].cells,e=0;e<s.length;e++)s[e].isSelected=t},n.prototype.getRowByIndex=function(n){return n=this.getInfiniteRowIndex(n),this.parent.getDataRows()[n]},n.prototype.getInfiniteRowIndex=function(n){if(this.parent.infiniteScrollSettings.enableCache){var t=this.parent.frozenRows,i=t>n?0:t,r=parseInt(this.parent.getRows()[i].getAttribute("aria-rowindex"),10);n=t>n?n:n-r+t}return n},n.prototype.getVirtualRowIndex=function(n){return n},n.prototype.getMovableRowByIndex=function(n){return n=this.getInfiniteRowIndex(n),this.parent.getMovableDataRows()[n]},n.prototype.enableAfterRender=function(n){"group"===n.module&&n.enable&&(this.generator=this.getModelGenerator())},n.prototype.setRowObjects=function(n){this.rows=n},n.prototype.immutableModeRendering=function(n){var nt=this,u,d,v,t,s,rt,g,y,e,ut;void 0===n&&(n={});u=this.parent;u.hideSpinner();var f=u.getPrimaryKeyFieldNames()[0],p={},tt={},o=[],it={},h=u.getRowsObject().slice(),w=this.getBatchEditedRecords(f,h),a={},b=0!==Object.keys(w).length;if(u.getContent().querySelector(".e-emptyrow")||"reorder"===n.requestType||this.parent.groupSettings.columns.length)this.refreshContentRows(n);else{if(0===u.currentViewData.length)return;var k={},l=u.createElement("tbody"),i=u.currentViewData,c=[].slice.call(this.getTable().querySelector("tbody").children);if(this.prevCurrentView.length)if(d=this.prevCurrentView.length,v=i.length,d===v)for(t=0;t<v;t++)"Batch"===this.parent.editSettings.mode&&c[t].classList.contains("e-insertedrow")?(c.splice(t,1),--t):(tt[i[t][f]]=p[this.prevCurrentView[t][f]]=t,a[t]=i[t][f],k[h[t].uid]=c[t],it[t]=this.prevCurrentView[t][f]);else{for(t=0;t<v;t++)tt[i[t][f]]=t,a[t]=i[t][f];for(t=0;t<d;t++)"Batch"===this.parent.editSettings.mode&&c[t].classList.contains("e-insertedrow")?(c.splice(t,1),--t):(k[h[t].uid]=c[t],p[this.prevCurrentView[t][f]]=t,it[t]=this.prevCurrentView[t][f])}for(t=0;t<i.length;t++)if(s=p[i[t][f]],Object(r.isNullOrUndefined)(s))rt=new dt(this.serviceLocator,null,u),g=this.generator.generateRows([i[t]]),o.push(g[0]),e=rt.render(g[0],u.getColumns()),l.appendChild(e),this.refreshImmutableContent(t,e,o[t]);else{if(y=!1,this.mutableData&&(y=this.objectEqualityChecker(this.prevCurrentView[t],i[t])),e=k[h[s].uid],o.push(h[s]),this.rowElements[t]&&this.rowElements[t].getAttribute("data-uid")===o[t].uid&&(b&&Object(r.isNullOrUndefined)(w[a[t]])||!b&&(y||this.prevCurrentView[t]===i[t]))){s!==t&&this.refreshImmutableContent(t,e,o[t]);l.appendChild(e);continue}(!b||Object(r.isNullOrUndefined)(w[a[t]]))&&(this.mutableData||i[t]===this.prevCurrentView[s])&&(!this.mutableData||y)||h[s].setRowValue(i[t]);l.appendChild(e);this.refreshImmutableContent(t,e,o[t])}(this.rows=o,this.rowElements=[].slice.call(l.children),Object(r.remove)(this.getTable().querySelector("tbody")),this.getTable().appendChild(l),this.parent.trigger(ct,{},function(){nt.parent.allowTextWrap&&nt.parent.notify(ki,{"case":"textwrap"})}),n)&&(ut=(n.requestType||"").toLowerCase()+"-complete",this.parent.notify(ut,n))}},n.prototype.objectEqualityChecker=function(n,t){for(var r=Object.keys(n),u=!0,i=0;i<r.length;i++)if(n[r[i]]!==t[r[i]]){u=!1;break}return u},n.prototype.getBatchEditedRecords=function(n,t){var o={},u=this.parent.getBatchChanges(),f=[],r=[],e,i;for(Object.keys(u).length&&(f=u.changedRecords,r=u.addedRecords),e={cancel:!1},this.parent.notify(vw,{rows:t,args:e}),r.length&&("Bottom"===this.parent.editSettings.newRowPosition?t.splice(t.length-1,r.length):e.cancel||t.splice(0,r.length)),i=0;i<f.length;i++)o[f[i][n]]=i;return o},n.prototype.refreshImmutableContent=function(n,t,i){i.isAltRow=!!this.parent.enableAltRow&&n%2!=0;i.isAltRow?t.classList.add("e-altrow"):t.classList.remove("e-altrow");i.index=n;i.edit=void 0;i.isDirty=!1;t.setAttribute("aria-rowindex",n.toString());this.updateCellIndex(t,n)},n.prototype.updateCellIndex=function(n,t){for(var i=0;i<n.cells.length;i++)n.cells[i].setAttribute("index",t.toString())},n}(),ds=function(){function n(n,t){var i=this;this.frzIdx=0;this.notfrzIdx=0;this.isFirstCol=!1;this.isReplaceDragEle=!0;this.helper=function(){var f=i.parent,s=i.draggable.currentStateTarget,h=o(s,"e-headercell"),n,t,u,c,e,l;if(!f.allowReordering&&!f.allowGrouping||!Object(r.isNullOrUndefined)(h)&&h.querySelectorAll(".e-checkselectall").length>0||(n=i.parent.createElement("div",{className:"e-cloneproperties e-dragclone e-headerclone"}),t=s.classList.contains("e-headercell")?s:h,!t||!f.allowReordering&&t.classList.contains("e-stackedheadercell")))return!1;if(c=t.offsetHeight,e=t.querySelector(".e-headercelldiv")||t.querySelector(".e-stackedheadercelldiv"),e){if(u=t.querySelector(".e-stackedheadercelldiv")?f.getStackedHeaderColumnByHeaderText(e.innerText.trim(),f.columns):f.getColumnByUid(e.getAttribute("e-mappinguid")),i.column=u,i.column.lockColumn)return!1;n.setAttribute("e-mappinguid",i.column.uid)}return u&&!Object(r.isNullOrUndefined)(u.headerTemplate)?Object(r.isNullOrUndefined)(u.headerTemplate)?n.innerHTML=u.headerTemplate:(l=f.getColumnIndexByField(u.field),rt(n,u.getHeaderTemplate()(Object(r.extend)({index:l},u),f,"headerTemplate"))):n.innerHTML=e?u.headerText:t.firstElementChild.innerHTML,n.style.width=t.offsetWidth+"px",n.style.height=t.offsetHeight+"px",n.style.lineHeight=(c-6).toString()+"px",f.element.appendChild(n),n};this.dragStart=function(n){var t=i.parent;t.element.querySelector(".e-gridpopup").style.display="none";t.notify(kr,{target:i.draggable.currentStateTarget,column:i.column,event:n.event});Object(r.isBlazor)()&&n.bindEvents(n.dragElement)};this.drag=function(n){var t=i.parent,f=n.target,u,e;if(f){if(u=Object(r.closest)(f,".e-grid"),e=i.parent.element.querySelector(".e-cloneproperties"),!(u&&u.getAttribute("id")===t.element.getAttribute("id")||(Object(r.classList)(e,["e-notallowedcur"],["e-defaultcur"]),t.allowReordering&&(t.element.querySelector(".e-reorderuparrow").style.display="none",t.element.querySelector(".e-reorderdownarrow").style.display="none"),t.groupSettings.allowReordering)))return;t.notify(or,{target:n.target,column:i.column,event:n.event})}};this.dragStop=function(n){var u,t=i.parent;t.element.querySelector(".e-gridpopup").style.display="none";(!o(n.target,"e-headercell")&&!o(n.target,"e-groupdroparea")||!t.allowReordering&&o(n.target,"e-headercell")||!n.helper.getAttribute("e-mappinguid")&&o(n.target,"e-groupdroparea"))&&(Object(r.remove)(n.helper),u=!0);t.notify(vo,{target:n.target,event:n.event,column:i.column,cancel:u})};this.drop=function(n){var t=i.parent,f=n.droppedElement.getAttribute("e-mappinguid"),u=Object(r.closest)(n.target,".e-grid");Object(r.remove)(n.droppedElement);(!u||u.getAttribute("id")===t.element.getAttribute("id"))&&(t.allowReordering||t.allowGrouping)&&t.notify(tu,{target:n.target,uid:f,droppedElement:n.droppedElement})};this.parent=n;this.serviceLocator=t;this.ariaService=this.serviceLocator.getService("ariaService");this.widthService=this.serviceLocator.getService("widthService");this.parent.isDestroyed||(this.parent.enableColumnVirtualization||this.parent.on(ui,this.setVisible,this),this.parent.on(lr,this.colPosRefresh,this))}return n.prototype.renderPanel=function(){var n=this.parent.element.querySelector(".e-gridheader"),t=null!=n,i;n=t?n:this.parent.createElement("div",{className:"e-gridheader"});i=t?n.querySelector(".e-headercontent"):this.parent.createElement("div",{className:"e-headercontent"});this.toggleStackClass(n);n.appendChild(i);this.setPanel(n);t||this.parent.element.appendChild(n)},n.prototype.renderTable=function(){var n=this.getPanel();n.appendChild(this.createHeaderTable());this.setTable(n.querySelector(".e-table"));this.parent.getFrozenColumns()||(this.initializeHeaderDrag(),this.initializeHeaderDrop());this.parent.notify(g,{rows:this.rows,args:{isFrozen:0!==this.parent.getFrozenColumns()}})},n.prototype.getPanel=function(){return this.headerPanel},n.prototype.setPanel=function(n){this.headerPanel=n},n.prototype.getTable=function(){return this.headerTable},n.prototype.setTable=function(n){this.headerTable=n},n.prototype.getColGroup=function(){return this.colgroup},n.prototype.setColGroup=function(n){return this.colgroup=n},n.prototype.getRows=function(){return this.getTable().tHead.rows},n.prototype.createHeaderTable=function(){var t=Object(r.isBlazor)()&&0!==this.parent.frozenRows,i=this.createTable(),n=this.getPanel().querySelector(".e-headercontent");return t||n.appendChild(i),n},n.prototype.createTable=function(n){var u,t,e,y;void 0===n&&(n=null);u=Object(r.isBlazor)()&&0!==this.parent.frozenRows;t=this.parent;Object(r.isBlazor)()&&!t.isJsComponent||!this.getTable()||t.getFrozenColumns()||Object(r.remove)(this.getTable());t.getColumns();var p=this.getPanel().querySelector(".e-headercontent"),i=u?n||p.querySelector(".e-table"):this.parent.createElement("table",{className:"e-table",attrs:{cellspacing:"0.25px",role:"grid"}}),s=this.createHeaderContent(),w=s.thead,c=this.parent.createElement("tbody",{className:this.parent.frozenRows?"":"e-hide"});this.caption=this.parent.createElement("caption",{innerHTML:this.parent.element.id+"_header_table",className:"e-hide"});for(var l,a=this.parent.createElement("colgroup"),v=this.parent.createElement("tr"),o=this.rows=s.rows,f=(new dt(this.serviceLocator,h.Header,this.parent),0),b=o.length;f<b;f++)for(e=0,y=o[f].cells.length;e<y;e++)o[f].cells[e],l=this.parent.createElement("td"),v.appendChild(l);return(t.allowFiltering||t.allowSorting||t.allowGrouping)&&i.classList.add("e-sortfilter"),this.updateColGroup(a),u||c.appendChild(v),i.appendChild(this.setColGroup(a)),i.appendChild(w),u||i.appendChild(c),i.appendChild(this.caption),this.ariaService.setOptions(i,{colcount:t.getColumns().length.toString()}),i},n.prototype.createHeaderContent=function(){var u=this.parent,s=u.getColumns(),e=this.parent.createElement("thead"),c=this.parent.createElement("tr",{className:"e-columnheader"}),o=new dt(this.serviceLocator,h.Header,u),i,n,t,r,f;for(o.element=c,n=[],this.colDepth=sh(u.columns),t=0,r=this.colDepth;t<r;t++)n[t]=this.generateRow(t),n[t].cells=[];for(n=this.ensureColumns(n),n=this.getHeaderCells(n),f=this.parent.getFrozenColumns(),this.parent.isRowDragable()&&f&&n[0].cells[1].column.index===f&&n[0].cells.shift(),t=0,r=this.colDepth;t<r;t++)i=o.render(n[t],s),this.parent.rowHeight&&i.querySelector(".e-headercell")&&(i.style.height=this.parent.rowHeight+"px"),e.appendChild(i);return{thead:e,rows:n}},n.prototype.updateColGroup=function(n){var t,f=this.parent.getColumns(),e=this.parent.getColumnIndexesInView(),i,u;if(this.parent.enableColumnVirtualization&&this.parent.getFrozenColumns()&&this.parent.contentModule.isXaxis()&&(f=Object(r.extend)([],this.parent.getColumns())).splice(0,this.parent.getFrozenColumns()),n.id=this.parent.element.id+"colGroup",this.parent.allowGrouping)for(i=0,u=this.parent.groupSettings.columns.length;i<u;i++)this.parent.enableColumnVirtualization&&-1===e.indexOf(i)||(t=this.parent.createElement("col",{className:"e-group-intent"}),n.appendChild(t));for((this.parent.detailTemplate||this.parent.childGrid)&&(t=this.parent.createElement("col",{className:"e-detail-intent"}),n.appendChild(t)),this.parent.isRowDragable()&&(t=this.parent.createElement("col",{className:"e-drag-intent"}),n.appendChild(t)),i=0,u=f.length;i<u;i++)t=this.parent.createElement("col"),!1===f[i].visible&&Object(r.setStyleAttribute)(t,{display:"none"}),n.appendChild(t);return n},n.prototype.ensureColumns=function(n){for(var r,f,u,t=this.parent,e=this.parent.getColumnIndexesInView(),i=0,o=n.length;i<o;i++){if(t.allowGrouping)for(r=0,f=t.groupSettings.columns.length;r<f;r++)this.parent.enableColumnVirtualization&&-1===e.indexOf(r)||n[i].cells.push(this.generateCell({},h.HeaderIndent));(t.detailTemplate||t.childGrid)&&(u={},this.parent.notify(bl,u),n[i].cells.push(this.generateCell(u,h.DetailHeader)));t.isRowDragable()&&n[i].cells.push(this.generateCell({},h.RowDragHIcon))}return n},n.prototype.getHeaderCells=function(n){var u=this.parent.getHeaderTable()&&this.parent.getHeaderTable().querySelector("thead"),i=this.parent.enableColumnVirtualization?this.parent.getColumns(this.parent.enablePersistence):this.parent.columns,t,r;if(this.frzIdx=0,this.notfrzIdx=0,this.parent.lockcolPositionCount)for(t=0;t<i.length;t++)this.lockColsRendered=!1,n=this.appendCells(i[t],n,0,0===t,!1,t===i.length-1,u);for(t=0,r=i.length;t<r;t++)this.notfrzIdx=0,this.lockColsRendered=!0,n=this.appendCells(i[t],n,0,0===t,!1,t===r-1,u);return n},n.prototype.appendCells=function(n,t,i,r,u,f,e){var y,b=f?"e-lastcell":"",s=this.parent.getFrozenColumns(),c,l,a,o,v,p,w;if(this.parent.enableColumnVirtualization&&s&&(y=this.parent.getContent().querySelector(".e-movablecontent").scrollLeft),n.columns){if(this.isFirstCol=!1,c=this.getCellCnt(n,0),c&&(l=this.refreshFrozenHdr(n.columns,{isPartial:!1,isComp:!0,cnt:0}),a=this.getStackedLockColsCount(n,0),(!s&&(!this.parent.lockcolPositionCount||!this.lockColsRendered&&a||this.lockColsRendered&&c-a)||s&&(!e&&this.checkFrozenStackHeader(n.columns,e)&&(this.parent.frozenColumns-this.frzIdx>0||l.isPartial)||e&&(c+this.frzIdx>this.parent.frozenColumns&&!l.isComp||this.checkFrozenStackHeader(n.columns,e))))&&t[i].cells.push(new st({cellType:h.StackedHeader,column:n,colSpan:this.getColSpan(c,e,l.cnt,a)}))),this.parent.lockcolPositionCount&&!this.lockColsRendered)for(o=0;o<n.columns.length;o++)t=this.appendCells(n.columns[o],t,i+1,r,0===o,o===n.columns.length-1&&f,e);if(this.lockColsRendered)for(o=0,v=n.columns.length;o<v;o++)p=this.isFirstCol=n.columns[o].visible&&!this.isFirstCol&&1!==v,w=o===v-1,t=this.appendCells(n.columns[o],t,i+1,r,p,w&&f,e)}else(y&&y>0&&this.parent.contentModule.isXaxis()&&0!==this.parent.inViewIndexes[0]&&this.frzIdx>this.parent.getFrozenColumns()||!s&&(!this.parent.lockcolPositionCount||n.lockColumn&&!this.lockColsRendered||!n.lockColumn&&this.lockColsRendered)||s&&(!e&&(this.frzIdx+this.notfrzIdx<this.parent.frozenColumns||n.isFrozen)&&(!this.parent.lockcolPositionCount||n.lockColumn&&!this.lockColsRendered||!n.lockColumn&&this.lockColsRendered)||e&&this.frzIdx+this.notfrzIdx>=this.parent.frozenColumns&&!n.isFrozen&&(!this.parent.lockcolPositionCount||n.lockColumn&&!this.lockColsRendered||!n.lockColumn&&this.lockColsRendered)))&&t[i].cells.push(this.generateCell(n,h.Header,this.colDepth-i,(r?"":u?"e-firstcell":"")+b,i,this.parent.getColumnIndexByUid(n.uid))),this.parent.lockcolPositionCount?this.frzIdx+this.notfrzIdx<this.parent.frozenColumns&&(n.lockColumn&&!this.lockColsRendered||!n.lockColumn&&this.lockColsRendered)?this.frzIdx++:this.notfrzIdx++:this.frzIdx++;return t},n.prototype.checkFrozenStackHeader=function(n,t){for(var i,f,r=!1,u=0;u<n.length;u++)if(i=n[u],f=this.parent.getNormalizedColumnIndex(i.uid),!i.columns){if(t&&f>=this.parent.getFrozenColumns()&&i.visible){r=!0;break}if(!t&&f<this.parent.getFrozenColumns()&&i.visible){r=!0;break}}return r},n.prototype.getStackedLockColsCount=function(n,t){if(n.columns)for(var i=0;i<n.columns.length;i++)t=this.getStackedLockColsCount(n.columns[i],t);else n.lockColumn&&t++;return t},n.prototype.refreshFrozenHdr=function(n,t){for(var i=0;i<n.length;i++)n[i].columns?t=this.refreshFrozenHdr(n[i].columns,t):(n[i].isFrozen&&(t.isPartial=!0,t.cnt++),t.isComp=t.isComp&&(n[i].isFrozen||this.parent.getColumnIndexByField(n[i].field)<this.parent.frozenColumns));return t},n.prototype.getColSpan=function(n,t,i,r){var u=this.parent.frozenColumns;return this.parent.getFrozenColumns()&&this.frzIdx+n>u?t?n=n-(u>this.frzIdx?u-this.frzIdx:0)-i:n-=n-(u>this.frzIdx?u+i-this.frzIdx:i):this.parent.lockcolPositionCount&&(n=this.lockColsRendered?n-r:r),n},n.prototype.generateRow=function(){return new kt({})},n.prototype.generateCell=function(n,t,i,u,f,e){var o={visible:n.visible,isDataCell:!1,isTemplate:!Object(r.isNullOrUndefined)(n.headerTemplate),rowID:"",column:n,cellType:t,rowSpan:i,className:u,index:f,colIndex:e};return(!o.rowSpan||o.rowSpan<2)&&delete o.rowSpan,new st(o)},n.prototype.setVisible=function(n){for(var o,s,h,c,i,t,u=this.parent,f=([].slice.call(this.getRows()),u.getFrozenColumns()),e=0,l=n.length;e<l;e++)o=n[e],(t=u.getNormalizedColumnIndex(o.uid),i=o.visible?"":"none",f)?(s=this.parent.isRowDragable()?f+1:f,t<s?Object(r.isBlazor)()&&u.isServerRendered?(Object(r.setStyleAttribute)(this.getTable().querySelector("colgroup").children[t],{display:i}),Object(r.setStyleAttribute)(this.getTable().querySelectorAll("th")[t],{display:i})):Object(r.setStyleAttribute)(this.getColGroup().children[t],{display:i}):(h=u.getHeaderContent().querySelector(".e-movableheader").querySelector("colgroup"),c=u.getHeaderContent().querySelector(".e-movableheader").querySelector("table"),Object(r.setStyleAttribute)(h.children[t-s],{display:i}),Object(r.isBlazor)()&&u.isServerRendered&&Object(r.setStyleAttribute)(c.querySelectorAll("th")[t-f],{display:i}))):Object(r.setStyleAttribute)(this.getColGroup().children[t],{display:i});this.refreshUI()},n.prototype.colPosRefresh=function(){Object(r.isBlazor)()&&this.parent.isServerRendered&&this.parent.frozenRows&&this.parent.getFrozenColumns()&&(this.freezeReorder=!0);this.refreshUI()},n.prototype.refreshUI=function(){var t=this.parent.getFrozenColumns(),u=this.parent.enableColumnVirtualization&&0!==t,h=Object(r.isBlazor)()&&this.parent.isServerRendered&&0!==this.parent.frozenRows&&0!==t,c=this.getPanel(),n,f,e,v,i;if(this.toggleStackClass(c),n=this.freezeReorder?this.headerPanel.querySelector(".e-movableheader").querySelector(".e-table"):this.getTable(),u&&(n=this.parent.contentModule.getVirtualFreezeHeader()),h&&!u&&(n=this.freezeReorder?this.headerPanel.querySelector(".e-movableheader").querySelector(".e-table"):this.headerPanel.querySelector(".e-frozenheader").querySelector(".e-table")),n){Object(r.isBlazor)()&&this.parent.isServerRendered?(n.removeChild(n.querySelector("colgroup")),n.removeChild(n.querySelector("thead"))):(Object(r.remove)(n),n.removeChild(n.firstChild),n.removeChild(n.childNodes[0]));f=this.parent.createElement("colgroup");e=this.createHeaderContent();this.rows=e.rows;n.insertBefore(e.thead,n.firstChild);this.updateColGroup(f);n.insertBefore(this.setColGroup(f),n.firstChild);u||h||this.setTable(n);Object(r.isBlazor)()&&this.parent.isServerRendered||this.appendContent(n);this.parent.notify(gf,{});this.widthService.setWidthToColumns();this.parent.updateDefaultCursor();(!t||this.parent.enableColumnVirtualization&&t)&&this.initializeHeaderDrag();for(var l=[].slice.call(c.querySelectorAll("tr.e-columnheader")),s=0,a=l;s<a.length;s++)v=a[s],i=[].slice.call(v.querySelectorAll(".e-grouptopleftcell")),i.length&&i[i.length-1].classList.add("e-lastgrouptopleftcell");t||this.parent.notify(g,{rows:this.rows,args:{isFrozen:0!==this.parent.getFrozenColumns()}});this.parent.enableColumnVirtualization&&o(n,"e-movableheader")&&this.parent.notify(g,{rows:this.rows,args:{isFrozen:!1,isXaxis:!0}});this.parent.allowTextWrap&&"Header"===this.parent.textWrapSettings.wrapMode&&vt(l,!0)}},n.prototype.toggleStackClass=function(n){this.parent.columns.some(function(n){return!Object(r.isNullOrUndefined)(n.columns)})?n.classList.add("e-stackedheader"):n.classList.remove("e-stackedheader")},n.prototype.appendContent=function(n){this.getPanel().querySelector(".e-headercontent").appendChild(n)},n.prototype.getCellCnt=function(n,t){if(n.columns)for(var i=0,r=n.columns.length;i<r;i++)t=this.getCellCnt(n.columns[i],t);else n.visible&&t++;return t},n.prototype.initializeHeaderDrag=function(){var n=this.parent;(this.parent.allowReordering||this.parent.allowGrouping&&this.parent.groupSettings.showDropArea)&&(this.draggable=new r.Draggable(n.getHeaderContent(),{dragTarget:".e-headercell",distance:5,helper:this.helper,dragStart:this.dragStart,drag:this.drag,dragStop:this.dragStop,abort:".e-rhandler",isReplaceDragEle:this.isReplaceDragEle}))},n.prototype.initializeHeaderDrop=function(){var n=this.parent;new r.Droppable(n.getHeaderContent(),{accept:".e-dragclone",drop:this.drop})},n}(),gt=i(4),ht=function(){function n(n,t){this.localizer=t.getService("localization");this.formatter=t.getService("valueFormatter");this.parent=n;this.element=this.parent.createElement("TD",{className:"e-rowcell",attrs:{role:"gridcell",tabindex:"-1"}});this.rowChkBox=this.parent.createElement("input",{className:"e-checkselect",attrs:{type:"checkbox"}})}return n.prototype.getGui=function(){return""},n.prototype.format=function(n,t){return Object(r.isNullOrUndefined)(n.format)||("number"===n.type&&isNaN(parseInt(t,10))&&(t=null),t=this.formatter.toView(t,n.getFormatter())),Object(r.isNullOrUndefined)(t)?"":t.toString()},n.prototype.evaluate=function(n,t,i,u,f,e){var h,o,y,p;if(t.column.template){var v=this.parent.isReact&&"string"!=typeof t.column.template,c=["index"],l=ro({},i,((h={})[ll]=f,h.column=t.column,h)),s=this.parent.element.id+t.column.uid,a="isStringTemplate";return Object(r.isBlazor)()&&e?(y="Batch"!==this.parent.editSettings.mode?parseInt(u.index,10):null,o=t.column.getColumnTemplate()(Object(r.extend)({index:u[c[0]]},l),this.parent,"template",s,this.parent[a],y),window[s]=null,"Batch"!==this.parent.editSettings.mode&&Object(r.updateBlazorTemplate)(s,"Template",t.column,!1)):v?(p={index:u[c[0]]},t.column.getColumnTemplate()(Object(r.extend)(p,l),this.parent,"columnTemplate",s,this.parent[a],null,n),this.parent.renderTemplates()):o=t.column.getColumnTemplate()(Object(r.extend)({index:u[c[0]]},l),this.parent,"template",s,this.parent[a]),v||rt(n,o),this.parent.notify("template-result",{template:o}),o=null,n.setAttribute("aria-label",n.innerText+" is template cell column header "+t.column.headerText),!1}return!0},n.prototype.invokeFormatter=function(n,t,i){return Object(r.isNullOrUndefined)(n.formatter)||(t=nk(n.formatter,"getValue")?(new n.formatter).getValue(n,i):"function"==typeof n.formatter?n.formatter(n,i):n.formatter.getValue(n,i)),t},n.prototype.render=function(n,t,i,r,u){return this.refreshCell(n,t,i,u)},n.prototype.refreshTD=function(n,t,i,u){var l="Batch"===this.parent.editSettings.mode&&n.classList.contains("e-editedbatchcell"),s,f,e,h,o,c,a;if(this.parent.isReact)n.innerHTML="",s=n.cellIndex,f=n.parentElement,Object(r.remove)(n),e=this.refreshCell(t,i,u,l),this.cloneAttributes(e,n),f.cells.length!==s-1?f.insertBefore(e,f.cells[s]):f.appendChild(e);else for(h=this.refreshCell(t,i,u,l),n.innerHTML="",n.setAttribute("aria-label",h.getAttribute("aria-label")),o=0,c=[].slice.call(h.childNodes);o<c.length;o++)a=c[o],n.appendChild(a)},n.prototype.cloneAttributes=function(n,t){for(var i,r=t.attributes,u=r.length;u--;)i=r[u],n.setAttribute(i.name,i.value)},n.prototype.refreshCell=function(n,t,i,u){var y,c,o=this.element.cloneNode(),f=n.column,s,e,l,a,v,h;return n.isForeignKey&&(c=n.foreignKeyData[0]||((y={})[f.foreignKeyValue]=f.format?null:"",y)),s=this.getGui(),e=n.isForeignKey?this.getValue(f.foreignKeyValue,c,f):this.getValue(f.field,t,f),("date"!==f.type&&"datetime"!==f.type||Object(r.isNullOrUndefined)(e)||(e=new Date(e)),s=(e=this.format(f,e,t)).toString(),"boolean"!==f.type||f.displayAsCheckBox)||(l="true"!==e&&"false"!==e?null:"true"===e?"True":"False",s=l?this.localizer.getConstant(l):s),a=this.invokeFormatter(f,e,t),(s=Object(r.isNullOrUndefined)(f.formatter)?s:Object(r.isNullOrUndefined)(a)?"":a.toString(),o.setAttribute("aria-label",s+" column header "+n.column.headerText),this.evaluate(o,n,t,i,c,u)&&"checkbox"!==f.type)?this.appendHtml(o,s,f.getDomSetter?f.getDomSetter():"innerHTML"):"checkbox"===f.type&&(o.classList.add("e-gridchkbox"),o.setAttribute("aria-label","checkbox"),e=!!this.parent.selectionSettings.persistSelection&&"true"===e,(h=Object(gt.createCheckBox)(this.parent.createElement,!1,{checked:e,label:" "})).insertBefore(this.rowChkBox.cloneNode(),h.firstChild),o.appendChild(h)),("Check"===this.parent.checkAllRows&&this.parent.enableVirtualization&&(n.isSelected=!0),this.setAttributes(o,n,i),"boolean"===f.type&&f.displayAsCheckBox)&&(v=isNaN(parseInt(e.toString(),10))?"true"===e:parseInt(e.toString(),10)>0,h=Object(gt.createCheckBox)(this.parent.createElement,!1,{checked:v,label:" "}),o.innerHTML="",h.classList.add("e-checkbox-disabled"),o.appendChild(h),o.setAttribute("aria-label",v+" column header "+n.column.headerText)),o},n.prototype.appendHtml=function(n,t,i){return void 0===i&&(i="innerHTML"),n[i]=t,n},n.prototype.setAttributes=function(n,t,i){var r=t.column;this.buildAttributeFromCell(n,t,"checkbox"===r.type);yi(n,i);yi(n,t.attributes);r.customAttributes&&yi(n,r.customAttributes);r.textAlign&&(n.style.textAlign=r.textAlign);"Clip"===r.clipMode||!r.clipMode&&"Clip"===this.parent.clipMode?n.classList.add("e-gridclip"):("EllipsisWithTooltip"===r.clipMode||!r.clipMode&&"EllipsisWithTooltip"===this.parent.clipMode)&&"checkbox"!==r.type&&n.classList.add("e-ellipsistooltip")},n.prototype.buildAttributeFromCell=function(n,t,i){var f={},u=[];t.colSpan&&(f.colSpan=t.colSpan);t.rowSpan&&(f.rowSpan=t.rowSpan);t.isTemplate&&u.push("e-templatecell");t.isSelected&&(u.push.apply(u,["e-selectionbackground","e-active"]),i&&n.querySelector(".e-frame").classList.add("e-check"));t.isColumnSelected&&u.push.apply(u,["e-columnselection"]);Object(r.isNullOrUndefined)(t.index)||(f["aria-colindex"]=t.index);t.visible||u.push("e-hide");f.class=u;yi(n,f)},n.prototype.getValue=function(n,t,i){return i.valueAccessor(n,t,i)},n}(),sf=function(){function n(){}return n.prototype.setOptions=function(n,t){for(var r=Object.keys(t),i=0;i<r.length;i++)ou(n,su[r[i]],t[r[i]])},n.prototype.setExpand=function(n,t){ou(n,su.expand,t)},n.prototype.setSort=function(n,t){ou(n,su.sort,t,"boolean"==typeof t)},n.prototype.setBusy=function(n,t){ou(n,su.busy,t);ou(n,su.invalid,null,!0)},n.prototype.setGrabbed=function(n,t,i){ou(n,su.grabbed,t,i)},n.prototype.setDropTarget=function(n,t){ou(n,su.dropeffect,"copy",!t)},n}();var su={expand:"aria-expanded",role:"role",selected:"aria-selected",multiselectable:"aria-multiselectable",sort:"aria-sort",busy:"aria-busy",invalid:"aria-invalid",grabbed:"aria-grabbed",dropeffect:"aria-dropeffect",haspopup:"aria-haspopup",level:"aria-level",colcount:"aria-colcount",rowcount:"aria-rowcount"},an=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),ww=function(n){function t(){var t=null!==n&&n.apply(this,arguments)||this;return t.element=t.parent.createElement("TH",{className:"e-headercell",attrs:{role:"columnheader",tabindex:"-1"}}),t.ariaService=new sf,t.hTxtEle=t.parent.createElement("span",{className:"e-headertext"}),t.sortEle=t.parent.createElement("div",{className:"e-sortfilterdiv e-icons"}),t.gui=t.parent.createElement("div"),t.chkAllBox=t.parent.createElement("input",{className:"e-checkselectall",attrs:{type:"checkbox"}}),t}return an(t,n),t.prototype.getGui=function(){return this.gui.cloneNode()},t.prototype.render=function(n){var t=this.element.cloneNode(),i=this.parent.createElement("div",{className:"e-filtermenudiv e-icons e-icon-filter"});return this.prepareHeader(n,t,i)},t.prototype.refresh=function(n,t){this.clean(t);var i=this.parent.createElement("div",{className:"e-filtermenudiv e-icons e-icon-filter"});return this.prepareHeader(n,t,i)},t.prototype.clean=function(n){n.innerHTML=""},t.prototype.prepareHeader=function(n,t,i){var c,b,u=n.column,l={},f=this.getGui(),a,v,s,y,p,h,o,w,nt,e;if((Object(r.attributes)(f,{"e-mappinguid":u.uid,"class":"e-headercelldiv"}),Object(r.isNullOrUndefined)(u.headerValueAccessor)||(c=this.getValue(u.headerText,u)),"checkbox"!==u.type)?(a=u.headerText,Object(r.isNullOrUndefined)(c)||(a=c),v=this.hTxtEle.cloneNode(),v[u.getDomSetter()]=a,f.appendChild(v)):(u.editType="booleanedit",s=Object(gt.createCheckBox)(this.parent.createElement,!1,{checked:!1,label:" "}),s.insertBefore(this.chkAllBox.cloneNode(),s.firstChild),f.appendChild(s),f.classList.add("e-headerchkcelldiv")),this.buildAttributeFromCell(t,n),this.appendHtml(t,f),t.appendChild(this.sortEle.cloneNode()),this.parent.allowFiltering&&"FilterBar"!==this.parent.filterSettings.type&&u.allowFiltering&&!Object(r.isNullOrUndefined)(u.field)&&(!this.parent.showColumnMenu||!u.showColumnMenu)){if(Object(r.attributes)(i,{"e-mappinguid":"e-flmenu-"+u.uid}),t.classList.add("e-fltr-icon"),y=[],this.parent.filterSettings.columns.length&&this.parent.filterSettings.columns.length!==y.length)for(p=0;p<this.parent.columns.length;p++)for(h=0;h<this.parent.filterSettings.columns.length;h++)if(this.parent.filterSettings.columns[h].field===u.field){i.classList.add("e-filtered");y.push(u.field);break}t.appendChild(i.cloneNode())}if(n.className&&t.classList.add(n.className),u.customAttributes&&yi(t,u.customAttributes),u.allowSorting&&(l.sort="none"),u.allowGrouping&&(l.grabbed=!1),t=this.extendPrepareHeader(u,t),o=this.parent,w=o.getColumnIndexByField(u.field),!Object(r.isNullOrUndefined)(u.headerTemplate)){var k=o.element.id+u.uid+"headerTemplate",d="isStringTemplate",g=Object(r.isBlazor)()?u.toJSON():u;this.parent.isReact&&"string"!=typeof u.headerTemplate?(nt={index:w},t.firstElementChild.innerHTML="",u.getHeaderTemplate()(Object(r.extend)(nt,g),o,"headerTemplate",k,this.parent[d],null,t.firstElementChild),this.parent.renderTemplates()):(b=u.getHeaderTemplate()(Object(r.extend)({index:w},g),o,"headerTemplate",k,this.parent[d]),t.firstElementChild.innerHTML="",rt(t.firstElementChild,b))}return(this.ariaService.setOptions(t,l),Object(r.isNullOrUndefined)(u.headerTextAlign)&&Object(r.isNullOrUndefined)(u.textAlign))||(e=u.headerTextAlign||u.textAlign,f.style.textAlign=e,"Right"===e||"Left"===e?t.classList.add("Right"===e?"e-rightalign":"e-leftalign"):"Center"===e&&t.classList.add("e-centeralign")),"Clip"===u.clipMode||!u.clipMode&&"Clip"===this.parent.clipMode?t.classList.add("e-gridclip"):("EllipsisWithTooltip"===u.clipMode||!u.clipMode&&"EllipsisWithTooltip"===this.parent.clipMode)&&"checkbox"!==u.type&&t.classList.add("e-ellipsistooltip"),t.setAttribute("aria-rowspan",(Object(r.isNullOrUndefined)(n.rowSpan)?1:n.rowSpan).toString()),t.setAttribute("aria-colspan","1"),this.parent.trigger(rc,{cell:n,node:t}),t},t.prototype.getValue=function(n,t){return t.headerValueAccessor(n,t)},t.prototype.extendPrepareHeader=function(n,t){var u,f,e,i,o;if(this.parent.showColumnMenu&&n.showColumnMenu&&!Object(r.isNullOrUndefined)(n.field)){if(u=this.parent.createElement("div",{className:"e-icons e-columnmenu"}),f=[],this.parent.filterSettings.columns.length&&this.parent.filterSettings.columns.length!==f.length)for(e=0;e<this.parent.columns.length;e++)for(i=0;i<this.parent.filterSettings.columns.length;i++)if(this.parent.filterSettings.columns[i].field===n.field){u.classList.add("e-filtered");f.push(n.field);break}t.classList.add("e-fltr-icon");t.appendChild(u)}return this.parent.allowResizing&&(o=this.parent.createElement("div"),o.className=n.allowResizing?"e-rhandler e-rcursor":"e-rsuppress",t.appendChild(o)),t},t.prototype.appendHtml=function(n,t){return n.appendChild(t),n},t}(ht),vn=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),fa=function(n){function t(){var t=null!==n&&n.apply(this,arguments)||this;return t.element=t.parent.createElement("TH",{className:"e-headercell e-stackedheadercell",attrs:{role:"columnheader",tabindex:"-1"}}),t}return vn(t,n),t.prototype.render=function(n){var t=this.element.cloneNode(),u=this.parent.createElement("div",{className:"e-stackedheadercelldiv",attrs:{"e-mappinguid":n.column.uid}}),i=n.column,f;return(t.appendChild(u),Object(r.isNullOrUndefined)(i.headerTemplate)?this.appendHtml(u,i.headerText,i.getDomSetter()):rt(u,i.getHeaderTemplate()(i,this.parent,"headerTemplate")),n.column.toolTip&&t.setAttribute("title",n.column.toolTip),"Clip"===i.clipMode||!i.clipMode&&"Clip"===this.parent.clipMode?t.classList.add("e-gridclip"):("EllipsisWithTooltip"===i.clipMode||!i.clipMode&&"EllipsisWithTooltip"===this.parent.clipMode)&&t.classList.add("e-ellipsistooltip"),Object(r.isNullOrUndefined)(n.column.textAlign)||(u.style.textAlign=n.column.textAlign),n.column.customAttributes&&yi(t,n.column.customAttributes),t.setAttribute("colspan",n.colSpan.toString()),t.setAttribute("aria-colspan",n.colSpan.toString()),t.setAttribute("aria-rowspan","1"),this.parent.allowResizing)&&(f=this.parent.createElement("div"),f.className=n.column.allowResizing?"e-rhandler e-rcursor":"e-rsuppress",t.appendChild(f)),this.parent.trigger(rc,{cell:n,node:t}),t},t}(ht),yn=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),gs=function(n){function t(){var t=null!==n&&n.apply(this,arguments)||this;return t.element=t.parent.createElement("TD",{className:"e-indentcell"}),t}return yn(t,n),t.prototype.render=function(n){var t=this.element.cloneNode();return yi(t,n.attributes),t},t}(ht),bw=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),kw=function(n){function t(){var t=null!==n&&n.apply(this,arguments)||this;return t.element=t.parent.createElement("TD",{className:"e-groupcaption",attrs:{id:t.parent.element.id+"captioncell",role:"gridcell",tabindex:"-1"}}),t}return bw(t,n),t.prototype.render=function(n,t){var e,h,i=this.element.cloneNode(),u=this.parent,o,s,f;return t.headerText=n.column.headerText,n.isForeignKey&&(h=this.format(n.column,n.column.valueAccessor("foreignKey",t,n.column))),o=n.isForeignKey?h:n.column.enableGroupByFormat?t.key:this.format(n.column,n.column.valueAccessor("key",t,n.column)),Object(r.isNullOrUndefined)(u.groupSettings.captionTemplate)?i.innerHTML=u.groupSettings.enableLazyLoading?n.column.headerText+": "+o:n.column.headerText+": "+o+" - "+t.count+" "+(t.count<2?this.localizer.getConstant("Item"):this.localizer.getConstant("Items")):(s=this.parent.isReact&&"string"!=typeof u.groupSettings.captionTemplate,Object(r.isBlazor)()?(f=u.element.id+"captionTemplate",e=et(u.groupSettings.captionTemplate)(t,null,null,f)):s?(f=u.element.id+"captionTemplate",et(u.groupSettings.captionTemplate)(t,this.parent,"captionTemplate",f,null,null,i),this.parent.renderTemplates()):e=this.parent.isVue?et(u.groupSettings.captionTemplate)(t,this.parent):et(u.groupSettings.captionTemplate)(t),s||rt(i,e)),i.setAttribute("colspan",n.colSpan.toString()),i.setAttribute("aria-label",i.innerHTML+" is groupcaption cell"),i.setAttribute("title",i.innerHTML),i},t}(ht),dw=function(n){function t(){var t=null!==n&&n.apply(this,arguments)||this;return t.element=t.parent.createElement("TD",{className:"e-groupcaption"}),t}return bw(t,n),t.prototype.render=function(n){var t=this.element.cloneNode();return t.innerHTML="&nbsp;",t.setAttribute("colspan",n.colSpan.toString()),t},t}(ht),pn=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),wn=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return pn(t,n),t.prototype.render=function(n,t,i,r){var u=this.element.cloneNode();return u.className=r?"e-recordplusexpand":"e-recordpluscollapse",u.setAttribute("ej-mappingname",t.field),u.setAttribute("ej-mappingvalue",t.key),u.setAttribute("aria-expanded",r?"true":"false"),u.setAttribute("tabindex","-1"),u.appendChild(this.parent.createElement("div",{className:r?"e-icons e-gdiagonaldown e-icon-gdownarrow":"e-icons e-gnextforward e-icon-grightarrow"})),u},t}(gs),bn=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),kn=function(n){function t(){var t=null!==n&&n.apply(this,arguments)||this;return t.element=t.parent.createElement("TH",{className:"e-grouptopleftcell"}),t}return bn(t,n),t.prototype.render=function(){var n=this.element.cloneNode();return n.appendChild(this.parent.createElement("div",{className:"e-headercelldiv e-emptycell",innerHTML:""})),n},t}(ht),dn=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),gn=function(n){function t(){var t=null!==n&&n.apply(this,arguments)||this;return t.element=t.parent.createElement("TH",{className:"e-detailheadercell"}),t}return dn(t,n),t.prototype.render=function(){var n=this.element.cloneNode();return n.appendChild(this.parent.createElement("div",{className:"e-emptycell"})),n},t}(ht),ntt=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),ttt=function(n){function t(){var t=null!==n&&n.apply(this,arguments)||this;return t.element=t.parent.createElement("TD",{className:"e-detailrowcollapse",attrs:{"aria-expanded":"false",role:"gridcell",tabindex:"-1"}}),t}return ntt(t,n),t.prototype.render=function(n,t,i){var u=this.element.cloneNode();return i&&!Object(r.isNullOrUndefined)(i.class)?(u.className="",u.className=i.class,u.appendChild(this.parent.createElement("div",{className:"e-icons e-dtdiagonaldown e-icon-gdownarrow"}))):u.appendChild(this.parent.createElement("div",{className:"e-icons e-dtdiagonalright e-icon-grightarrow"})),u},t}(ht),itt=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),rtt=function(n){function t(){var t=null!==n&&n.apply(this,arguments)||this;return t.element=t.parent.createElement("TD",{className:"e-rowdragdrop",attrs:{role:"gridcell",tabindex:"-1"}}),t}return itt(t,n),t.prototype.render=function(n){var t=this.element.cloneNode();return t.appendChild(this.parent.createElement("div",{className:"e-icons e-rowcelldrag e-dtdiagonalright e-icon-rowdragicon"})),n.isSelected&&(t.classList.add("e-selectionbackground"),t.classList.add("e-active")),t},t}(ht),utt=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),ftt=function(n){function t(){var t=null!==n&&n.apply(this,arguments)||this;return t.element=t.parent.createElement("TH",{className:"e-rowdragheader"}),t}return utt(t,n),t.prototype.render=function(){var n=this.element.cloneNode();return n.appendChild(Object(r.createElement)("div",{className:"e-emptycell"})),n},t}(ht),gw=function(){function n(n,t){this.emptyGrid=!1;this.counter=0;this.parent=n;this.locator=t;this.data=new ye(n,t);this.l10n=t.getService("localization");this.ariaService=this.locator.getService("ariaService");this.renderer=this.locator.getService("rendererFactory");this.addEventListener()}return n.prototype.render=function(){var n=this.parent;this.headerRenderer=this.renderer.getRenderer(ut.Header);this.contentRenderer=this.renderer.getRenderer(ut.Content);this.headerRenderer.renderPanel();this.contentRenderer.renderPanel();n.getColumns().length&&(this.isLayoutRendered=!0,this.headerRenderer.renderTable(),this.contentRenderer.renderTable(),this.emptyRow(!1));this.parent.scrollModule.setWidth();this.parent.scrollModule.setHeight();"auto"!==this.parent.height&&this.parent.scrollModule.setPadding();Object(r.isBlazor)()&&this.parent.isServerRendered||this.refreshDataManager()},n.prototype.refresh=function(n){var i=this,t,u;void 0===n&&(n={requestType:"refresh"});t=this.parent;(t.notify(n.requestType+"-begin",n),Object(r.isBlazor)()&&this.resetTemplates(),Object(r.isBlazor)()&&t.isServerRendered)&&((t.bulkChanges.dataSource&&delete t.bulkChanges.dataSource,t.notify("blazor-action-begin",n),"filtering"===n.requestType)&&(n.columns=null),"sorting"===n.requestType&&(n.target=null),"Batch"!==t.editSettings.mode||t.isEdit||t.notify("closebatch",{}));u=this.parent.preventUpdate;t.trigger(l,n,function(f){var s,o,e;if((void 0===f&&(f={requestType:"refresh"}),"delete"===f.requestType&&Object(r.isBlazor)()&&!t.isJsComponent)&&(Object(r.isNullOrUndefined)(t.commandDelIndex)?f.data=t.getSelectedRecords():(s=f.data,f.data={},f.data[0]=s)),f.cancel)t.notify(tf,f);else if((Object(r.isBlazor)()&&"Normal"===t.editSettings.mode&&t.isEdit&&"infiniteScroll"!==n.requestType&&t.notify("closeinline",{}),"delete"===f.requestType&&t.allowPaging)&&(o=f.data.length,e=t.pageSettings.totalRecordsCount-o,t.currentViewData.length-o||!e||(t.prevPageMoving=!0,t.setProperties({pageSettings:{totalRecordsCount:e,currentPage:Math.ceil(e/t.pageSettings.pageSize)}},!0),t.pagerModule.pagerObj.totalRecordsCount=e)),Object(r.isBlazor)()&&i.parent.isServerRendered){if(u)return void(t.bulkChanges={});"refresh"===n.requestType&&i.parent.notify("updateaction",f);"virtualscroll"!==f.requestType&&i.parent.showSpinner();"delete"===f.requestType||"save"===f.requestType?(i.parent.notify(bo,f),i.parent.notify("add-delete-success",f)):(i.parent.allowServerDataBinding=!0,i.parent.serverDataBind(),i.parent.allowServerDataBinding=!1)}else"reorder"===f.requestType&&i.parent.dataSource&&"result"in i.parent.dataSource||("paging"===f.requestType||"columnstate"===f.requestType||"reorder"===f.requestType)&&i.parent.groupSettings.enableLazyLoading&&i.parent.groupSettings.columns.length&&i.parent.contentModule.getGroupCache()[i.parent.pageSettings.currentPage]?i.contentRenderer.refreshContentRows(f):i.refreshDataManager(f)})},n.prototype.resetTemplates=function(){var n=this.parent,f=n.getColumns(),o,t,i,u,e;for(n.detailTemplate&&(o=n.element.id+"detailTemplate",r.blazorTemplates[o]=[],Object(r.resetBlazorTemplate)(o,"DetailTemplate")),n.groupSettings.captionTemplate&&Object(r.resetBlazorTemplate)(n.element.id+"captionTemplate","CaptionTemplate"),n.rowTemplate&&Object(r.resetBlazorTemplate)(n.element.id+"rowTemplate","RowTemplate"),n.toolbarTemplate&&Object(r.resetBlazorTemplate)(n.element.id+"toolbarTemplate","ToolbarTemplate"),n.pageSettings.template&&Object(r.resetBlazorTemplate)(n.element.id+"_template","pageSettings"),t=0;t<f.length;t++)f[t].template&&(r.blazorTemplates[n.element.id+f[t].uid]=[],Object(r.resetBlazorTemplate)(n.element.id+f[t].uid,"Template")),f[t].headerTemplate&&Object(r.resetBlazorTemplate)(n.element.id+f[t].uid+"headerTemplate","HeaderTemplate"),f[t].filterTemplate&&Object(r.resetBlazorTemplate)(n.element.id+f[t].uid+"filterTemplate","FilterTemplate");for(i=0;i<n.aggregates.length;i++)for(u=0;u<n.aggregates[i].columns.length;u++)n.aggregates[i].columns[u].footerTemplate&&(e=n.element.id+n.aggregates[i].columns[u].guid+"footerTemplate",Object(r.resetBlazorTemplate)(e,"FooterTemplate")),n.aggregates[i].columns[u].groupFooterTemplate&&(e=n.element.id+n.aggregates[i].columns[u].guid+"groupFooterTemplate",Object(r.resetBlazorTemplate)(e,"GroupFooterTemplate")),n.aggregates[i].columns[u].groupCaptionTemplate&&(e=n.element.id+n.aggregates[i].columns[u].guid+"groupCaptionTemplate",Object(r.resetBlazorTemplate)(e,"GroupCaptionTemplate"))},n.prototype.refreshComplete=function(n){Object(r.isBlazor)()&&!this.parent.isJsComponent&&(n.rows=null);this.parent.trigger(c,n)},n.prototype.refreshDataManager=function(n){var t,i=this,r,f,u;void 0===n&&(n={});"virtualscroll"!==n.requestType&&this.parent.showSpinner();this.parent.notify(os,n);this.emptyGrid=!1;r=this.isNeedForeignAction();(this.ariaService.setBusy(this.parent.getContent().querySelector(".e-content"),!0),r)&&(f=new e.Deferred,t=this.getFData(f,n));(t=t?t.then(function(){var r=i.data.generateQuery().requiresCount(),t;return i.emptyGrid?(t=new e.Deferred,t.resolve({result:[],count:0}),t.promise):i.data.getData(n,r)}):this.data.getData(n,this.data.generateQuery().requiresCount()),this.parent.getForeignKeyColumns().length&&(!r||this.parent.searchSettings.key.length))&&(u=new e.Deferred,t=t.then(function(r){return i.parent.notify(fe,{dataManager:t,result:r,promise:u,action:n}),u.promise}));this.parent.groupSettings.disablePageWiseAggregates&&this.parent.groupSettings.columns.length&&(t=t.then(function(n){return i.validateGroupRecords(n)}));t.then(function(t){return i.dataManagerSuccess(t,n)}).catch(function(t){return i.dataManagerFailure(t,n)})},n.prototype.getFData=function(n,t){return this.parent.notify(fe,{isComplex:!0,promise:n,action:t}),n.promise},n.prototype.isNeedForeignAction=function(){var n=this.parent;return!!(n.allowFiltering&&n.filterSettings.columns.length||n.searchSettings.key.length)&&this.foreignKey(this.parent.getForeignKeyColumns())},n.prototype.foreignKey=function(n){var t=this;return n.some(function(n){return!(!t.parent.filterSettings.columns.some(function(t){return n.uid===t.uid})&&!t.parent.searchSettings.key.length)})},n.prototype.sendBulkRequest=function(n){var t=this,i,u;if(n.requestType="batchsave",i=this.data.saveChanges(n.changes,this.parent.getPrimaryKeyFieldNames()[0],n.original),Object(r.isBlazor)()&&!this.parent.isJsComponent)i.then(function(){t.parent.notify("editsuccess",n)}).catch(function(n){Object(r.isNullOrUndefined)(n.error)||Object(r.isNullOrUndefined)(n.error.message)||(n.error=n.error.message);t.parent.trigger(hi,n)});else{if(u=this.data.generateQuery().requiresCount(),this.data.dataManager.dataSource.offline)return void this.refreshDataManager({requestType:"batchsave"});i.then(function(){t.data.getData(n,u).then(function(i){return t.dmSuccess(i,n)}).catch(function(i){return t.dmFailure(i,n)})}).catch(function(i){return t.dmFailure(i,n)})}},n.prototype.dmSuccess=function(n,t){this.dataManagerSuccess(n,t)},n.prototype.dmFailure=function(n,t){this.dataManagerFailure(n,t)},n.prototype.renderEmptyRow=function(){this.emptyRow(!0)},n.prototype.emptyRow=function(n){var f,i=this.parent,t=this.contentRenderer.getTable().querySelector("tbody"),u;Object(r.isNullOrUndefined)(t)||Object(r.remove)(t);t=this.parent.createElement("tbody");u=0;(i.detailTemplate||i.childGrid)&&++u;(f=this.parent.createElement("tr",{className:"e-emptyrow"})).appendChild(this.parent.createElement("td",{innerHTML:this.l10n.getConstant("EmptyRecord"),attrs:{colspan:(i.getColumns().length+u).toString()}}));t.appendChild(f);this.contentRenderer.renderEmpty(t);n&&(this.parent.trigger(ct,{}),this.parent.notify(bt,{rows:[new kt({isDataRow:!0,cells:[new st({isDataCell:!0,visible:!0})]})]}))},n.prototype.dynamicColumnChange=function(){this.parent.getCurrentViewRecords().length&&this.updateColumnType(this.parent.getCurrentViewRecords()[0])},n.prototype.updateColumnType=function(n){for(var f,e,u,i=this.parent.getColumns(),o=n&&n.items?n.items[0]:n,s=this.locator.getService("valueFormatter"),t=0,h=i.length;t<h;t++)u=k(i[t].field||"",o),Object(r.isNullOrUndefined)(i[t].customFormat)||(i[t].format=i[t].customFormat),Object(r.isNullOrUndefined)(i[t].validationRules)||Object(r.isNullOrUndefined)(i[t].validationRules.equalTo)||(i[t].validationRules.equalTo[0]=this.parent.element.id+i[t].validationRules.equalTo[0]),i[t].isForeignColumn()&&i[t].columnData&&(u=k(i[t].foreignKeyValue||"",i[t].columnData[0])),Object(r.isNullOrUndefined)(u)?i[t].type=i[t].type||(Object(r.isBlazor)()&&this.parent.isServerRendered?"none":null):(this.isColTypeDef=!0,(!i[t].type||Object(r.isBlazor)()&&this.parent.isServerRendered&&"none"===i[t].type)&&(i[t].type=u.getDay?u.getHours()>0||u.getMinutes()>0||u.getSeconds()>0||u.getMilliseconds()>0?"datetime":"date":typeof u)),f=new er,(i[t].format&&(i[t].format.skeleton||i[t].format.format)&&(i[t].setFormatter(f.getFormatFunction(Object(r.extend)({},i[t].format))),i[t].setParser(f.getParserFunction(i[t].format))),"string"==typeof i[t].format)?(e=this.parent.isServerRendered||this.parent.printModule.isPrintGrid(),da(this.locator,i[t],e)):i[t].format||"number"!==i[t].type||i[t].setParser(s.getParserFunction({format:"n2"}))},n.prototype.dataManagerSuccess=function(n,t){var i=this,u=this.parent,f;this.contentRenderer=this.renderer.getRenderer(ut.Content);this.headerRenderer=this.renderer.getRenderer(ut.Header);n.actionArgs=t;f=this.parent.enableInfiniteScrolling&&!this.parent.infiniteScrollSettings.enableCache&&("delete"===t.requestType||"save"===t.requestType&&"add"===this.parent.infiniteScrollModule.requestType);u.trigger(ac,n,function(e){var s,h,o,l,p;if(!e.cancel&&(e.result=Object(r.isNullOrUndefined)(e.result)?[]:e.result,s=Object.keys(e.result).length,!i.parent.isDestroyed))if(u.getColumns().length||s||u.columns.length&&u.columns[0]instanceof wt)if(!i.isInfiniteEnd(t)||s){if(i.parent.isEdit=!1,i.parent.notify(ce,{}),i.parent.notify(bi,{}),i.contentRenderer.prevCurrentView=i.parent.currentViewData.slice(),u.currentViewData=e.result,Object(r.isBlazor)()&&"FilterBar"===u.filterSettings.type&&(Object(r.isNullOrUndefined)(u.currentViewData)||!Object(r.isNullOrUndefined)(u.currentViewData)&&!u.currentViewData.length))for(h=u.getColumns(),o=0;o<h.length;o++)if(h[o].filterTemplate){l=u.element.id+h[o].uid+"filterTemplate";Object(r.resetBlazorTemplate)(l,"FilterTemplate");for(var y=h[o].field,v=u.filterSettings.columns,a=0;a<v.length;a++)y===v[a].field&&(r.blazorTemplates[l][0][y]=v[a].value);Object(r.updateBlazorTemplate)(l,"FilterTemplate",h[o],!1)}if(!s&&e.count&&u.allowPaging&&t&&"delete"!==t.requestType)return!i.parent.groupSettings.enableLazyLoading||"grouping"!==t.requestType&&"ungrouping"!==t.requestType||i.parent.notify(co,t),u.prevPageMoving=!0,u.pageSettings.totalRecordsCount=e.count,"paging"!==t.requestType&&(u.pageSettings.currentPage=Math.ceil(e.count/u.pageSettings.pageSize)),void u.dataBind();if((u.getColumns().length||!s)&&i.isLayoutRendered||nt(u)||i.updatesOnInitialRender(e),!i.isColTypeDef&&u.getCurrentViewRecords()&&(i.data.dataManager.dataSource.offline&&u.dataSource.length?i.updateColumnType(u.dataSource[0]):i.updateColumnType(u.getCurrentViewRecords()[0])),i.parent.isInitialLoad||!i.parent.groupSettings.disablePageWiseAggregates||i.parent.groupSettings.columns.length||(e.result=i.parent.dataSource instanceof Array?i.parent.dataSource:i.parent.currentViewData),i.parent.notify(at,Object(r.extend)({count:e.count,result:e.result,aggregates:e.aggregates},t)),(u.groupSettings.columns.length||t&&"ungrouping"===t.requestType)&&t&&"filtering"!==t.requestType&&i.headerRenderer.refreshUI(),s)nt(u)&&(t.scrollTop={top:i.contentRenderer.content.scrollTop}),f?i.parent.notify(ae,{e:t,result:n.result,count:n.count,agg:n.aggregates}):i.parent.enableImmutableMode?i.contentRenderer.immutableModeRendering(t):i.contentRenderer.refreshContentRows(t);else{if(!u.getColumns().length)return u.element.innerHTML="",void alert(i.l10n.getConstant("EmptyDataSourceError"));(i.contentRenderer.setRowElements([]),i.contentRenderer.setRowObjects([]),i.ariaService.setBusy(i.parent.getContent().querySelector(".e-content"),!1),i.renderEmptyRow(),t)&&(p=(t.requestType||"").toLowerCase()+"-complete",i.parent.notify(p,t),"batchsave"===t.requestType&&(t.cancel=!1,t.rows=[],t.isFrozen=0!==i.parent.getFrozenColumns()&&!t.isFrozen,i.parent.trigger(c,t)));i.parent.hideSpinner()}i.parent.notify(lt,{});i.setRowCount(i.parent.getCurrentViewRecords().length);i.parent.getDataModule().isQueryInvokedFromData=!1}else i.parent.notify(ae,{e:t,result:n.result,count:n.count,agg:n.aggregates});else u.hideSpinner()})},n.prototype.dataManagerFailure=function(n,t){this.ariaService.setOptions(this.parent.getContent().querySelector(".e-content"),{busy:!1,invalid:!0});this.setRowCount(1);this.parent.trigger(hi,{error:n});this.parent.hideSpinner();"save"!==t.requestType&&"delete"!==t.requestType&&"bulk-save"!==t.name&&(this.parent.currentViewData=[],this.renderEmptyRow(),this.parent.log("actionfailure",{error:n}))},n.prototype.setRowCount=function(n){this.parent;this.ariaService.setOptions(this.parent.getHeaderTable(),{rowcount:n?n.toString():"1"})},n.prototype.isInfiniteEnd=function(n){return this.parent.enableInfiniteScrolling&&!this.parent.infiniteScrollSettings.enableCache&&"delete"===n.requestType},n.prototype.updatesOnInitialRender=function(n){this.isLayoutRendered=!0;this.parent.columns.length<1&&this.buildColumns(n.result[0]);lu(this.parent.columns,null,this.parent);this.headerRenderer.renderTable();this.contentRenderer.renderTable();this.parent.isAutoGen=!0;this.parent.notify(wi,{})},n.prototype.iterateComplexColumns=function(n,t,i){for(var u=Object.keys(n),r=0;r<u.length;r++)("object"!=typeof n[u[r]]||!n[u[r]]||n[u[r]]instanceof Date?[]:Object.keys(n[u[r]])).length?this.iterateComplexColumns(n[u[r]],t+(u[r]+"."),i):(i[this.counter]=t+u[r],this.counter++)},n.prototype.buildColumns=function(n){var i=[],u={};this.iterateComplexColumns(n,"",u);for(var f=Object.keys(u).filter(function(n){return"BlazId"!==u[n]}).map(function(n){return u[n]}),t=0,e=f.length;t<e;t++)i[t]={field:f[t]},this.parent.enableColumnVirtualization&&(i[t].width=Object(r.isNullOrUndefined)(i[t].width)?200:i[t].width);this.parent.setProperties({columns:i},!0)},n.prototype.instantiateRenderer=function(){this.renderer.addRenderer(ut.Header,new ds(this.parent,this.locator));this.renderer.addRenderer(ut.Content,new of(this.parent,this.locator));var n=this.locator.getService("cellRendererFactory");n.addCellRenderer(h.Header,new ww(this.parent,this.locator));n.addCellRenderer(h.Data,new ht(this.parent,this.locator));n.addCellRenderer(h.StackedHeader,new fa(this.parent,this.locator));n.addCellRenderer(h.Indent,new gs(this.parent,this.locator));n.addCellRenderer(h.GroupCaption,new kw(this.parent,this.locator));n.addCellRenderer(h.GroupCaptionEmpty,new dw(this.parent,this.locator));n.addCellRenderer(h.Expand,new wn(this.parent,this.locator));n.addCellRenderer(h.HeaderIndent,new kn(this.parent,this.locator));n.addCellRenderer(h.StackedHeader,new fa(this.parent,this.locator));n.addCellRenderer(h.DetailHeader,new gn(this.parent,this.locator));n.addCellRenderer(h.RowDragHIcon,new ftt(this.parent,this.locator));n.addCellRenderer(h.DetailExpand,new ttt(this.parent,this.locator));n.addCellRenderer(h.DetailFooterIntent,new gs(this.parent,this.locator));n.addCellRenderer(h.RowDragIcon,new rtt(this.parent,this.locator))},n.prototype.addEventListener=function(){var n=this;this.parent.isDestroyed||(this.parent.on(ii,this.instantiateRenderer,this),this.parent.on("refreshdataSource",this.dataManagerSuccess,this),this.parent.on(p,this.refresh,this),this.parent.on(ep,this.refreshComplete,this),this.parent.on(el,this.sendBulkRequest,this),this.parent.on(cl,function(){n.emptyGrid=!0},this),this.parent.on(wi,this.dynamicColumnChange,this))},n.prototype.validateGroupRecords=function(n){var o=this,s=n.result.length-1,i,t,u;if(s<0)return Promise.resolve(n);var h=n.result[0],c=n.result[s],l=[],a=function(n){for(var i=[h,c],t=0;t<i.length;t++)l.push(new e.Predicate("field","==",i[t].field).and(o.getPredicate("key","equal",i[t].key)));n.where(e.Predicate.or(l))},v=new e.Query;a(v);var p=new e.DataManager(n.result).executeLocal(v),f=this.data.generateQuery(!0),y=[];if(this.data.isRemote()||Object(r.isBlazor)()){for(i=[h,c],t=0;t<i.length;t++)y.push(this.getPredicate(i[t].field,"equal",i[t].key));f.where(e.Predicate.or(y))}else a(f);return u=new e.Deferred,this.data.getData({},f).then(function(t){o.updateGroupInfo(p,t.result);u.resolve(n)}).catch(function(n){return u.reject(n)}),u.promise},n.prototype.getPredicate=function(n,t,i){return i instanceof Date?ir({field:n,operator:t,value:i}):new e.Predicate(n,t,i)},n.prototype.updateGroupInfo=function(n,t){for(var o,c,a,v,l,u,i,h,s,p,w=new e.DataManager(t),f=n,r=0;r<f.length;r++)for(o=w.executeLocal((new e.Query).where(new e.Predicate("field","==",f[r].field).and(this.getPredicate("key","equal",f[r].key))))[0],f[r].count=o.count,c=f[r].items,a=o.items,c.GroupGuid&&(f[r].items=this.updateGroupInfo(f[r].items,o.items)),v=this.parent.aggregates,l=0;l<v.length;l++)for(u=v[l],i=0;i<u.columns.length;i++)for(h=u.columns[i].type instanceof Array?u.columns[i].type:[u.columns[i].type],s=0;s<h.length;s++){var y=u.columns[i].field+" - "+h[s].toLowerCase(),b=c.level?a.records:o.items,k=this.parent;"Custom"===h[s]?(p=c.level?a:o,f[r].aggregates[y]=u.columns[i].customAggregate?u.columns[i].customAggregate.call(k,p,u.columns[i]):""):f[r].aggregates[y]=e.DataUtil.aggregates[h[s].toLowerCase()](b,u.columns[i].field)}return n},n}(),nb=function(){function n(){this.cellRenderMap={}}return n.prototype.addCellRenderer=function(n,t){n="string"==typeof n?n:Object(r.getEnumValue)(h,n);Object(r.isNullOrUndefined)(this.cellRenderMap[n])&&(this.cellRenderMap[n]=t)},n.prototype.getCellRenderer=function(n){if(n="string"==typeof n?n:Object(r.getEnumValue)(h,n),Object(r.isNullOrUndefined)(this.cellRenderMap[n]))throw"The cellRenderer "+n+" is not found";return this.cellRenderMap[n]},n}(),tb=function(){function n(){this.services={}}return n.prototype.register=function(n,t){Object(r.isNullOrUndefined)(this.services[n])&&(this.services[n]=t)},n.prototype.getService=function(n){if(Object(r.isNullOrUndefined)(this.services[n]))throw"The service "+n+" is not registered";return this.services[n]},n}(),ett=function(){function n(){this.rendererMap={}}return n.prototype.addRenderer=function(n,t){var i=Object(r.getEnumValue)(ut,n);Object(r.isNullOrUndefined)(this.rendererMap[i])&&(this.rendererMap[i]=t)},n.prototype.getRenderer=function(n){var t=Object(r.getEnumValue)(ut,n);if(Object(r.isNullOrUndefined)(this.rendererMap[t]))throw"The renderer "+t+" is not found";return this.rendererMap[t]},n}(),ea=function(){function n(n){this.parent=n}return n.prototype.setWidthToColumns=function(){var r,n=0,e=this.parent.getColumnIndexesInView(),u=!0,f,i,t;if(this.parent.allowGrouping)for(f=this.parent.groupSettings.columns.length;n<f;n++)this.parent.enableColumnVirtualization&&-1===e.indexOf(n)?u=!1:this.setColumnWidth(new wt({width:"30px"}),n);for((this.parent.detailTemplate||this.parent.childGrid)&&(this.setColumnWidth(new wt({width:"30px"}),n),n++),this.parent.isRowDragable()&&(this.setColumnWidth(new wt({width:"30px"}),n),n++),i=this.parent.getColumns(),t=0;t<i.length;t++)this.setColumnWidth(i[t],u&&this.parent.enableColumnVirtualization?void 0:t+n);r=this.getTableWidth(this.parent.getColumns());"auto"!==this.parent.width&&-1===this.parent.width.toString().indexOf("%")&&this.setMinwidthBycalculation(r)},n.prototype.setMinwidthBycalculation=function(n){var f=0,t=this.parent.getColumns().filter(function(n){return Object(r.isNullOrUndefined)(n.width)||"auto"===n.width}),u,i;if(t.length){f=Object(r.isNullOrUndefined)(this.parent.width)||"auto"===this.parent.width||"string"!=typeof this.parent.width||-1!==this.parent.width.indexOf("%")?this.parent.element.getBoundingClientRect().width-n:("string"==typeof this.parent.width?parseInt(this.parent.width,10):this.parent.width)-n;for(var e=0,o=0,s=t;o<s.length;o++)u=s[o],e+=Object(r.isNullOrUndefined)(u.minWidth)?0:"string"==typeof u.minWidth?parseInt(u.minWidth,10):u.minWidth;for(i=0;i<t.length;i++)0===n&&this.parent.allowResizing&&this.isWidthUndefined()&&i!==t.length-1&&this.setUndefinedColumnWidth(t),0!==n&&f<e?this.setWidth(t[i].minWidth,this.parent.getColumnIndexByField(t[i].field)):0!==n&&f>e&&this.setWidth("",this.parent.getColumnIndexByField(t[i].field)+this.parent.getIndentCount(),!0)}},n.prototype.setUndefinedColumnWidth=function(n){for(var t=0;t<n.length;t++)t!==n.length-1&&(n[t].width=200,this.setWidth(200,this.parent.getColumnIndexByField(n[t].field)))},n.prototype.setColumnWidth=function(n,t,i){if(!(this.parent.getColumns().length<1)){var f=Object(r.isNullOrUndefined)(t)?this.parent.getNormalizedColumnIndex(n.uid):t,u=this.getWidth(n),e=this.getTableWidth(this.parent.getColumns());null!==u&&(this.setWidth(u,f),"auto"!==this.parent.width&&-1===this.parent.width.toString().indexOf("%")&&this.setMinwidthBycalculation(e),(this.parent.allowResizing&&"resize"===i||this.parent.getFrozenColumns()&&this.parent.allowResizing)&&this.setWidthToTable(),this.parent.notify(nu,{index:f,width:u,column:n,module:i}))}},n.prototype.setWidth=function(n,t,i){var s,f,p,l,a;this.parent.groupSettings.columns.length>t&&vh(this.parent)&&(n=(3e3/this.parent.element.offsetWidth).toFixed(1)+"%");var e,w=this.parent.getHeaderTable(),b=this.parent.getContentTable(),v=Object(r.formatUnit)(n),u=this.parent.getFrozenColumns();u=u&&this.parent.isRowDragable()?u+1:u;f=this.parent.getHeaderContent().querySelector(".e-movableheader");p=this.parent.getContent().querySelector(".e-movablecontent");e=u&&t>=u&&f&&f.querySelector("colgroup")?f.querySelector("colgroup").children[t-u]:this.parent.enableColumnVirtualization&&u&&this.parent.contentModule.isXaxis()&&f.scrollLeft>0?(l=f.querySelector("colgroup")).children[l.children.length-1-t]:w.querySelector("colgroup").children[t];s=(e&&!i?e.style.width=v:e&&i&&(e.style.width=""),u&&t>=u)?this.parent.getContent().querySelector(".e-movablecontent").querySelector("colgroup").children[t-u]:this.parent.enableColumnVirtualization&&u&&this.parent.contentModule.isXaxis()&&p.scrollLeft>0?(l=this.parent.getContent().querySelector(".e-movablecontent").querySelector("colgroup")).children[l.children.length-1-t]:b.querySelector("colgroup").children[t];s&&!i?s.style.width=v:s&&i&&(s.style.width="");for(var h=this.parent.element.querySelectorAll(".e-table.e-inline-edit"),y=[],c=0;c<h.length;c++)if(o(h[c],"e-grid").id===this.parent.element.id)for(a=0;a<h[c].querySelector("colgroup").children.length;a++)y.push(h[c].querySelector("colgroup").children[a]);h.length&&y.length&&(y[t].style.width=v)},n.prototype.getSiblingsHeight=function(n){return this.getHeightFromDirection(n,"previous")+this.getHeightFromDirection(n,"next")},n.prototype.getHeightFromDirection=function(n,t){for(var i=n[t+"ElementSibling"],r=0,u=["e-gridheader","e-gridfooter","e-groupdroparea","e-gridpager","e-toolbar"];i;)u.some(function(n){return i.classList.contains(n)})&&(r+=i.offsetHeight),i=i[t+"ElementSibling"];return r},n.prototype.isWidthUndefined=function(){var n=this.parent.getColumns().filter(function(n){return Object(r.isNullOrUndefined)(n.width)&&Object(r.isNullOrUndefined)(n.minWidth)}).length;return this.parent.getColumns().length===n},n.prototype.getWidth=function(n){if(Object(r.isNullOrUndefined)(n.width)&&this.parent.allowResizing&&Object(r.isNullOrUndefined)(n.minWidth)&&!this.isWidthUndefined()&&(n.width=200),this.parent.frozenColumns&&Object(r.isNullOrUndefined)(n.width)&&n.index<this.parent.frozenColumns&&(n.width=200),!n.width)return null;var t=parseInt(n.width.toString(),10);return n.minWidth&&t<parseInt(n.minWidth.toString(),10)?n.minWidth:n.maxWidth&&t>parseInt(n.maxWidth.toString(),10)?n.maxWidth:n.width},n.prototype.getTableWidth=function(n){for(var t,i,u=0,r=0,f=n;r<f.length;r++)t=f[r],i=this.getWidth(t),"auto"===t.width&&(i=0),!1!==t.visible&&null!==i&&(u+=parseInt(i.toString(),10));return u},n.prototype.calcMovableOrFreezeColWidth=function(n){var t=this.parent.getColumns().slice();return"movable"===n?t.splice(0,this.parent.getFrozenColumns()):"freeze"===n&&t.splice(this.parent.getFrozenColumns(),t.length),Object(r.formatUnit)(this.getTableWidth(t))},n.prototype.setWidthToFrozenTable=function(){var n=this.calcMovableOrFreezeColWidth("freeze");n=this.isAutoResize()?"100%":n;this.parent.getHeaderTable().style.width=n;this.parent.getContentTable().style.width=n},n.prototype.setWidthToMovableTable=function(){var n="",t=this.parent.getColumns().filter(function(n){return Object(r.isNullOrUndefined)(n.width)}).length>=1,i=this.parent.getColumns().filter(function(n){return"auto"===n.width}).length>=1;"number"!=typeof this.parent.width||t||i?t||i||(n=this.calcMovableOrFreezeColWidth("movable")):n=Object(r.formatUnit)(this.parent.width-parseInt(this.calcMovableOrFreezeColWidth("freeze").split("px")[0],10)-5);n=this.isAutoResize()?"100%":n;this.parent.getHeaderContent().querySelector(".e-movableheader").firstElementChild&&(this.parent.getHeaderContent().querySelector(".e-movableheader").firstElementChild.style.width=n);this.parent.getContent().querySelector(".e-movablecontent").firstElementChild.style.width=n},n.prototype.setWidthToFrozenEditTable=function(){var n=this.calcMovableOrFreezeColWidth("freeze");n=this.isAutoResize()?"100%":n;this.parent.element.querySelectorAll(".e-table.e-inline-edit")[0].style.width=n},n.prototype.setWidthToMovableEditTable=function(){var n=this.calcMovableOrFreezeColWidth("movable");n=this.isAutoResize()?"100%":n;this.parent.element.querySelectorAll(".e-table.e-inline-edit")[1].style.width=n},n.prototype.setWidthToTable=function(){var n=Object(r.formatUnit)(this.getTableWidth(this.parent.getColumns())),t;this.parent.getFrozenColumns()?(this.setWidthToFrozenTable(),this.setWidthToMovableTable()):((this.parent.detailTemplate||this.parent.childGrid)&&this.setColumnWidth(new wt({width:"30px"})),n=this.isAutoResize()?"100%":n,this.parent.getHeaderTable().style.width=n,this.parent.getContentTable().style.width=n);t=this.parent.element.querySelector(".e-table.e-inline-edit");t&&this.parent.getFrozenColumns()?(this.setWidthToFrozenEditTable(),this.setWidthToMovableEditTable()):t&&(t.style.width=n)},n.prototype.isAutoResize=function(){return this.parent.allowResizing&&"Auto"===this.parent.resizeSettings.mode},n}(),oa=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),ott=function(){function n(n){this.currentInfo={};this.oneTime=!0;this.swap={};this.forget=!1;this.skipFocus=!0;this.focusByClick=!1;this.prevIndexes={};this.refMatrix=this.refreshMatrix(!0);this.actions=["downArrow","upArrow"];this.parent=n;this.rowModelGen=new vi(this.parent);this.addEventListener()}return n.prototype.focusCheck=function(n){var t=n.target;this.focusByClick=!0;this.skipFocus=t.classList.contains("e-grid")},n.prototype.onFocus=function(){if(!(this.parent.isDestroyed||r.Browser.isDevice||this.parent.enableVirtualization)){this.setActive(!this.parent.enableHeaderFocus&&0===this.parent.frozenRows,0!==this.parent.frozenColumns);this.parent.enableHeaderFocus||this.parent.getCurrentViewRecords().length||"Batch"===this.parent.editSettings.mode&&("Batch"!==this.parent.editSettings.mode||this.parent.editModule.getBatchChanges().addedRecords.length)||this.getContent().matrix.generate(this.rowModelGen.generateRows({rows:[new kt({isDataRow:!0})]}),this.getContent().selector,!1);var n=this.getContent().matrix.get(0,-1,[0,1],null,this.getContent().validator());this.getContent().matrix.select(n[0],n[1]);this.skipFocus&&(this.focus(),this.skipFocus=!1)}},n.prototype.passiveFocus=function(n){this.parent.isDestroyed||n.target&&n.target.classList.contains("e-detailcell")&&(this.currentInfo.skipAction=!1,Object(r.addClass)([this.currentInfo.element],["e-focused","e-focus"]))},n.prototype.onBlur=function(n){this.parent.isEdit||n&&(!n.relatedTarget||Object(r.closest)(n.relatedTarget,".e-grid"))||(this.removeFocus(),this.skipFocus=!1,this.currentInfo.skipAction=!1,this.getContent().getFocusInfo().elementToFocus&&(this.getContent().getFocusInfo().elementToFocus.tabIndex=0))},n.prototype.onClick=function(n,t){var i,e,u,f;if((!o(n.target,"e-filterbarcell")||!n.target.classList.contains("e-input-group-icon"))&&(i=!Object(r.isNullOrUndefined)(Object(r.closest)(n.target,".e-gridcontent")),e=!Object(r.isNullOrUndefined)(Object(r.closest)(n.target,".e-gridheader")),i=i&&e?!i:i,u=!Object(r.isNullOrUndefined)(Object(r.closest)(n.target,".e-frozencontent"))||!Object(r.isNullOrUndefined)(Object(r.closest)(n.target,".e-frozenheader")),!(!i&&Object(r.isNullOrUndefined)(Object(r.closest)(n.target,".e-gridheader"))||n.target.classList.contains("e-content"))&&Object(r.isNullOrUndefined)(Object(r.closest)(n.target,".e-unboundcell"))))if(this.setActive(i,u),i||!Object(r.isNullOrUndefined)(Object(r.closest)(n.target,".e-gridheader"))){if(f={cancel:!1,byKey:!1,byClick:!Object(r.isNullOrUndefined)(n.target),clickArgs:n},this.parent.notify(hr,f),!f.cancel&&!Object(r.closest)(n.target,".e-inline-edit")&&(this.setActive(i,u),this.getContent())){if(!1===this.getContent().onClick(n,t))return;this.focus()}}else this.clearOutline()},n.prototype.onKeyPress=function(n){var i,r,t;this.skipOn(n)||(this.activeKey=n.action,i={cancel:!1,byKey:!0,byClick:!1,keyArgs:n},(this.parent.notify(hr,i),i.cancel)||(r=this.getContent().matrix.current,this.currentInfo.outline=!0,t=this.getContent().jump(n.action,r),this.swap=t,t.swap&&(this.setActive(!t.toHeader,t.toFrozen),this.getContent().matrix.current=this.getContent().getNextCurrent(r,t,this.active,n.action),this.prevIndexes={}),this.setActiveByKey(n.action,this.getContent()),!1!==this.getContent().onKeyPress(n)?(n.preventDefault(),this.focus(n)):this.clearIndicator()))},n.prototype.skipOn=function(n){var t=n.target,e,i,u,f;return t?this.currentInfo.skipAction?(this.clearIndicator(),!0):["pageUp","pageDown","altDownArrow"].indexOf(n.action)>-1?(this.clearIndicator(),!0):(e=Object(r.closest)(t,"th")&&!Object(r.closest)(t,"th").tabIndex,n.target.classList.contains("e-filterbaroperator")&&(13===n.keyCode||27===n.keyCode)&&Object(r.closest)(n.target,".e-filterbarcell").querySelector("input").focus(),e&&null!==Object(r.closest)(document.activeElement,".e-filterbarcell")&&this.removeFocus(),i=null!==Object(r.closest)(document.activeElement,".e-filterbarcell"),this.parent.enableHeaderFocus&&i&&(u=this.active.matrix,f=u.current,i=u.matrix[f[0]].lastIndexOf(1)!==f[1]),"delete"===n.action||"Batch"!==this.parent.editSettings.mode&&(this.parent.isEdit||["insert","f2"].indexOf(n.action)>-1)||i||null!==Object(r.closest)(document.activeElement,"#"+this.parent.element.id+"_searchbar")&&["enter","leftArrow","rightArrow","shiftLeft","shiftRight","ctrlPlusA"].indexOf(n.action)>-1||null===Object(r.closest)(t,".e-gridcontent")&&null===Object(r.closest)(t,".e-gridheader")||"space"===n.action&&!t.classList.contains("e-gridchkbox")&&null===Object(r.closest)(t,".e-gridchkbox")&&null===Object(r.closest)(t,".e-headerchkcelldiv")||null!==Object(r.closest)(t,".e-filter-popup")):!1},n.prototype.focusVirtualElement=function(n){var u=this,t,i,r;(this.parent.enableVirtualization||this.parent.enableInfiniteScrolling)&&(t={virtualData:{},isAdd:!1,isCancel:!1},this.parent.notify(eu,t),i=this.actions.some(function(n){return n===u.activeKey}),r=!!this.parent.contentModule&&this.parent.contentModule.selectedRowIndex>-1,t.isAdd||Object.keys(t.virtualData).length||i||t.isCancel||r?(t.isCancel=!1,this.parent.contentModule.selectedRowIndex=-1,i&&(this.activeKey=this.empty,this.parent.notify("virtaul-key-handler",n)),this.currentInfo.elementToFocus.focus({preventScroll:!0})):this.currentInfo.elementToFocus.focus())},n.prototype.getFocusedElement=function(){return this.currentInfo.elementToFocus},n.prototype.getContent=function(){return this.active||this.content},n.prototype.setActive=function(n,t){this.active=n?t?this.fContent:this.content:t?this.fHeader:this.header},n.prototype.setFocusedElement=function(n,t){var i=this;this.currentInfo.elementToFocus=n;setTimeout(function(){Object(r.isNullOrUndefined)(i.currentInfo.elementToFocus)||(i.parent.enableVirtualization||i.parent.enableInfiniteScrolling?i.focusVirtualElement(t):i.currentInfo.elementToFocus.focus())},0)},n.prototype.focus=function(n){this.parent.notify(kl,n);this.removeFocus();this.addFocus(this.getContent().getFocusInfo(),n)},n.prototype.removeFocus=function(){this.currentInfo.element&&(Object(r.removeClass)([this.currentInfo.element,this.currentInfo.elementToFocus],["e-focused","e-focus"]),this.currentInfo.element.tabIndex=-1)},n.prototype.addOutline=function(){var n=this.getContent().getFocusInfo();n.element&&(Object(r.addClass)([n.element],["e-focused"]),Object(r.addClass)([n.elementToFocus],["e-focus"]))},n.prototype.focusHeader=function(){this.setActive(!1,0!==this.parent.frozenColumns);this.resetFocus()},n.prototype.focusContent=function(){this.setActive(!0,0!==this.parent.frozenColumns);this.resetFocus()},n.prototype.resetFocus=function(){var n=this.getContent().matrix.get(0,-1,[0,1],null,this.getContent().validator());this.getContent().matrix.select(n[0],n[1]);this.focus()},n.prototype.addFocus=function(n,t){var i;if((this.currentInfo=n,this.currentInfo.outline=n.outline&&!Object(r.isNullOrUndefined)(t),n.element)&&(i=n.elementToFocus.classList.contains("e-focus"),!i)){this.currentInfo.outline&&Object(r.addClass)([n.element],["e-focused"]);Object(r.addClass)([n.elementToFocus],["e-focus"]);n.element.tabIndex=0;i||this.setFocusedElement(n.elementToFocus,t);this.parent.notify(cr,{element:n.elementToFocus,parent:n.element,indexes:this.getContent().matrix.current,byKey:!Object(r.isNullOrUndefined)(t),byClick:Object(r.isNullOrUndefined)(t),keyArgs:t,isJump:this.swap.swap,container:this.getContent().getInfo(t),outline:!Object(r.isNullOrUndefined)(t),swapInfo:this.swap});var u=this.getContent().matrix.current,e=u[0],f=u[1];this.prevIndexes={rowIndex:e,cellIndex:f};this.focusedColumnUid=this.parent.getColumnByIndex(f).uid;this.focusByClick=!1}},n.prototype.refreshMatrix=function(n){var t=this;return function(i){var a,v,f,h,s;n&&i.args&&i.args.isFrozen&&!t.fContent?t.fContent=new htt(t.parent):n&&!t.content&&(t.content=new sa(t.parent));!n&&i.args&&i.args.isFrozen&&!t.fHeader?t.fHeader=new ctt(t.parent):n||t.header||(t.header=new ib(t.parent));var u=n?i.args&&i.args.isFrozen?t.fContent:t.content:i.args&&i.args.isFrozen?t.fHeader:t.header,e=n?i.rows.slice(t.parent.frozenRows):i.rows,c=n?i.rows.slice(0,t.parent.frozenRows):i.rows;t.parent.isCollapseStateEnabled()&&n&&(e=e.filter(function(n){return!1!==n.visible}));var l,o=!Object(r.isNullOrUndefined)(t.parent.rowTemplate),y=u.matrix.generate(c,u.selector,o),p=t.parent.getFrozenColumns();"batchAdd"===i.name&&p?(a=t.parent.getMovableRowsObject().map(function(n){return n.clone()}),v=e.map(function(n){return n.clone()}),t.fContent.matrix.generate(v,t.fContent.selector,o),t.content.matrix.generate(a,t.content.selector,o)):u.matrix.generate(e,u.selector,o);(u.generateRows(c,{matrix:y,handlerInstance:i.args&&i.args.isFrozen?t.fHeader:t.header}),!r.Browser.isDevice&&i&&i.args&&(t.focusByClick||"paging"!==i.args.requestType||(t.skipFocus=!1,t.parent.element.focus()),"grouping"===i.args.requestType&&(t.skipFocus=!0)),i&&i.args&&"virtualscroll"===i.args.requestType)&&(t.currentInfo.uid?i.rows.some(function(n,i){return l=i,n.uid===t.currentInfo.uid})&&(t.content.matrix.current[0]=l,t.content.matrix.current[1]=t.parent.getColumnIndexByUid(t.focusedColumnUid)||0,s=t.getContent().getFocusInfo().elementToFocus)&&(f=s.getBoundingClientRect(),h=t.parent.element.getBoundingClientRect(),f.top>=0&&f.left>=0&&f.right<=Math.min(h.right,window.innerWidth||document.documentElement.clientWidth)&&f.bottom<=Math.min(h.bottom,window.innerHeight||document.documentElement.clientHeight)&&t.focus()):i.args.focusElement&&i.args.focusElement.classList.contains("e-filtertext")&&(s=t.parent.element.querySelector("#"+i.args.focusElement.id))&&s.focus())}},n.prototype.addEventListener=function(){var f=this,i,n,u,t;if(!this.parent.isDestroyed){for(r.EventHandler.add(this.parent.element,"mousedown",this.focusCheck,this),r.EventHandler.add(this.parent.element,"focus",this.onFocus,this),this.parent.element.addEventListener("focus",this.passiveHandler=function(n){return f.passiveFocus(n)},!0),r.EventHandler.add(this.parent.element,"focusout",this.onBlur,this),this.parent.on(w,this.onKeyPress,this),this.parent.on(it,this.onClick,this),this.parent.on(y,this.refMatrix,this),this.parent.on(uu,this.refMatrix,this),this.parent.on(g,this.refreshMatrix(),this),this.parent.on("close-edit",this.restoreFocus,this),this.parent.on("restore-Focus",this.restoreFocus,this),i=["start-edit","start-add"],n=0;n<i.length;n++)this.parent.on(i[n],this.clearIndicator,this);for(this.parent.on("sorting-complete",this.restoreFocus,this),this.parent.on("filtering-complete",this.filterfocus,this),u=["grouping","ungrouping"],t=0;t<u.length;t++)this.parent.on(u[t]+"-complete",this.restoreFocusWithAction,this);this.parent.on(kf,this.refMatrix,this);this.parent.on(gr,this.refMatrix,this);this.parent.on(df,this.refMatrix,this);this.parent.on(sr,this.refMatrix,this);this.parent.on(bt,this.refMatrix,this);this.parent.on(cr,this.internalCellFocus,this)}},n.prototype.filterfocus=function(){"FilterBar"!==this.parent.filterSettings.type&&this.restoreFocus()},n.prototype.removeEventListener=function(){var i,n,u,t;if(!this.parent.isDestroyed){for(r.EventHandler.remove(this.parent.element,"mousedown",this.focusCheck),r.EventHandler.remove(this.parent.element,"focus",this.onFocus),r.EventHandler.remove(this.parent.element,"focusout",this.onBlur),this.parent.element.removeEventListener("focus",this.passiveHandler,!0),this.parent.off(w,this.onKeyPress),this.parent.off(it,this.onClick),this.parent.off(y,this.refMatrix),this.parent.off(uu,this.refMatrix),this.parent.off(g,this.refreshMatrix()),this.parent.off("close-edit",this.restoreFocus),this.parent.off("restore-focus",this.restoreFocus),i=["start-edit","start-add"],n=0;n<i.length;n++)this.parent.off(i[n],this.clearOutline);for(this.parent.off("sorting-complete",this.restoreFocus),this.parent.off("filtering-complete",this.filterfocus),u=["grouping","ungrouping"],t=0;t<u.length;t++)this.parent.on(u[t]+"-complete",this.restoreFocusWithAction);this.parent.off(kf,this.refMatrix);this.parent.off(df,this.refMatrix);this.parent.off(gr,this.refMatrix);this.parent.off(sr,this.refMatrix);this.parent.off(bt,this.refMatrix);this.parent.off(cr,this.internalCellFocus)}},n.prototype.destroy=function(){this.removeEventListener()},n.prototype.restoreFocus=function(){this.addFocus(this.getContent().getFocusInfo())},n.prototype.restoreFocusWithAction=function(n){if(!this.parent.enableInfiniteScrolling){var i=this.getContent().matrix,t=i.current;switch(n.requestType){case"grouping":case"ungrouping":t[1]=!t.length||this.parent.groupSettings.showGroupedColumn||Object(r.isNullOrUndefined)(i.matrix[t[0]])?"grouping"===n.requestType?t[1]+1:t[1]-1:i.matrix[t[0]].indexOf(1)}this.getContent().matrix.current=t;this.addFocus(this.getContent().getFocusInfo())}},n.prototype.clearOutline=function(){this.getContent().matrix.current=this.getContent().matrix.get(0,-1,[0,1],"downArrow",this.getContent().validator());this.clearIndicator()},n.prototype.clearIndicator=function(){this.currentInfo.element&&this.currentInfo.elementToFocus&&Object(r.removeClass)([this.currentInfo.element,this.currentInfo.elementToFocus],["e-focus","e-focused"])},n.prototype.getPrevIndexes=function(){var n=this.forget;return this.forget=!1,n||!Object.keys(this.prevIndexes).length?{rowIndex:null,cellIndex:null}:this.prevIndexes},n.prototype.forgetPrevious=function(){this.forget=!0},n.prototype.setActiveByKey=function(n,t){var f=this,i,r,u;(0!==this.parent.frozenColumns||0!==this.parent.frozenRows)&&(r={home:function(){return{toHeader:!i.isContent,toFrozen:!0}},end:function(){return{toHeader:!i.isContent,toFrozen:!1}},ctrlHome:function(){return{toHeader:!0,toFrozen:0!==f.parent.frozenColumns}},ctrlEnd:function(){return{toHeader:!1,toFrozen:!1}}},n in r&&(i=t.getInfo(),u=r[n](),this.setActive(!u.toHeader,u.toFrozen),this.getContent().matrix.current=t.matrix.current))},n.prototype.internalCellFocus=function(n){if(n.byKey&&n.container.isContent&&"enter"===n.keyArgs.action&&(n.parent.classList.contains("e-detailcell")||n.parent.classList.contains("e-unboundcell")||n.parent.classList.contains("e-templatecell"))){this.clearIndicator();var t=this.getContent().getFocusable(this.getFocusedElement());this.setFocusedElement(t);this.currentInfo.skipAction=!0}},n}(),stt=function(){function n(){this.matrix=[];this.current=[]}return n.prototype.set=function(n,t,i){n=Math.max(0,Math.min(n,this.rows));t=Math.max(0,Math.min(t,this.columns));this.matrix[n]=this.matrix[n]||[];this.matrix[n][t]=i?1:0},n.prototype.get=function(n,t,i,u,f){var e=t,h,o,c,s;if(n+i[0]<0)return[n,t];if(n=Math.max(0,Math.min(n+i[0],this.rows)),h=!0,Object(r.isNullOrUndefined)(this.matrix[n]))return null;if(t=Math.max(0,Math.min(t+i[1],this.matrix[n].length-1)),e+i[1]>this.matrix[n].length-1&&f(n,t,u))return[n,e];if(o=this.first(this.matrix[n],t,i,!0,u),t=null===o?e:o,c=Object(r.getValue)(n+"."+t,this.matrix),n!==this.rows||"downArrow"!==u&&"enter"!==u||(i[0]=-1),null===o){for(n=this.current[0],s=0;s<this.rows;s++)if(this.matrix[s].some(function(n){return 1===n})){h=!1;break}if(h)return[n,t]}return this.inValid(c)||!f(n,t,u)?this.get(n,e,i,u,f):[n,t]},n.prototype.first=function(n,t,i,r,u){return(t<0||t===n.length)&&this.inValid(n[t])&&"upArrow"!==u&&"downArrow"!==u||!n.some(function(n){return 1===n})?null:this.inValid(n[t])?this.first(n,-1!==["upArrow","downArrow","shiftUp","shiftDown"].indexOf(u)?r?0:++t:t+i[1],i,!1,u):t},n.prototype.select=function(n,t){n=Math.max(0,Math.min(n,this.rows));t=Math.max(0,Math.min(t,this.matrix[n].length-1));this.current=[n,t]},n.prototype.generate=function(n,t,i){var r,f,u;for(this.rows=n.length-1,this.matrix=[],r=0;r<n.length;r++)for(f=n[r].cells.filter(function(n){return!0!==n.isSpanned}),this.columns=Math.max(f.length-1,0|this.columns),u=0;u<f.length;u++)this.set(r,u,t(n[r],f[u],i));return this.matrix},n.prototype.inValid=function(n){return 0===n||void 0===n},n}(),sa=function(){function n(n){var t=this;this.matrix=new stt;this.parent=n;this.keyActions={rightArrow:[0,1],tab:[0,1],leftArrow:[0,-1],shiftTab:[0,-1],upArrow:[-1,0],downArrow:[1,0],shiftUp:[-1,0],shiftDown:[1,0],shiftRight:[0,1],shiftLeft:[0,-1],enter:[1,0],shiftEnter:[-1,0]};this.indexesByKey=function(n){return{home:[t.matrix.current[0],-1,0,1],end:[t.matrix.current[0],t.matrix.columns+1,0,-1],ctrlHome:[0,-1,0,1],ctrlEnd:[t.matrix.rows,t.matrix.columns+1,0,-1]}[n]||null}}return n.prototype.getTable=function(){return this.parent.getFrozenColumns()?this.parent.getContent().querySelector(".e-movablecontent .e-table"):this.parent.getContentTable()},n.prototype.onKeyPress=function(n){var i=this.keyActions[n.action],t=this.getCurrentFromAction(n.action,i,n.action in this.keyActions,n);if(t){if((["tab","shiftTab"].indexOf(n.action)>-1&&this.matrix.current||[]).toString()===t.toString()){if(t.toString()===[this.matrix.rows,this.matrix.columns].toString()||t.toString()===[0,0].toString()||this.matrix.current[0]===this.matrix.rows&&this.matrix.current.toString()===t.toString())return!1;t=this.editNextRow(t[0],t[1],n.action)}this.matrix.select(t[0],t[1])}},n.prototype.editNextRow=function(n,t,i){var r=this.parent,f=r.editSettings.allowNextRowEdit&&(r.isEdit||r.isLastCellPrimaryKey),e=r.getColumnIndexByField(r.getVisibleColumns()[0].field),u=this.getTable().rows[n].cells[t];return"tab"===i&&f&&(n++,t=e+(this.getTable().rows[n].querySelectorAll(".e-indentcell").length+this.getTable().rows[n].querySelectorAll(".e-detailrowcollapse").length)),"shiftTab"===i&&f&&(n--,t=r.getColumnIndexByField(r.getVisibleColumns()[r.getVisibleColumns().length-1].field)),u.classList.contains("e-rowcell")||u.classList.contains("e-headercell")||u.classList.contains("e-groupcaption")?[n,t]:this.editNextRow(n,t,i)},n.prototype.getCurrentFromAction=function(n,t,i,r){if(void 0===t&&(t=[0,0]),!i&&!this.indexesByKey(n)||0===this.matrix.current.length)return null;if(!this.shouldFocusChange(r))return this.matrix.current;var u=this.indexesByKey(n)||this.matrix.current.concat(t),f=u[0],e=u[1],o=u[2],s=u[3];return this.matrix.get(f,e,[o,s],n,this.validator())},n.prototype.onClick=function(n,t){var i=n.target;if(i=(i=i.classList.contains("e-rowcell")?i:Object(r.closest)(i,"td"))||Object(r.closest)(n.target,"td.e-detailrowcollapse")||Object(r.closest)(n.target,"td.e-detailrowexpand"),!(i=(i=Object(r.closest)(n.target,"td.e-detailcell")&&Object(r.isNullOrUndefined)(Object(r.closest)(Object(r.closest)(n.target,".e-grid"),"td.e-detailcell"))?null:i)&&Object(r.closest)(i,"table").classList.contains("e-table")?i:null))return!1;var e=[i.parentElement.rowIndex,i.cellIndex],u=e[0],f=e[1],s=this.matrix.current,h=s[0],c=s[1],l=Object(r.getValue)(u+"."+f,this.matrix.matrix);if(this.matrix.inValid(l)||!t&&h===u&&c===f||!o(n.target,"e-rowcell")&&!o(n.target,"e-groupcaption"))return!1;this.matrix.select(u,f)},n.prototype.getFocusInfo=function(){var n={},i=this.matrix.current,u=i[0],t=void 0===u?0:u,f=i[1],e=void 0===f?0:f;return this.matrix.current=[t,e],n.element=Object(r.isNullOrUndefined)(this.getTable().rows[t])?null:this.getTable().rows[t].cells[e],n.element?(n.elementToFocus=n.element.classList.contains("e-unboundcell")||n.element.classList.contains("e-detailcell")?n.element:this.getFocusable(n.element),n.outline=!0,n.uid=n.element.parentElement.getAttribute("data-uid"),n):n},n.prototype.getFocusable=function(n){var i='button, [href], input:not([type="hidden"]), select, textarea, [tabindex]:not([tabindex="-1"])',t;return this.parent.isEdit&&(i='input:not([type="hidden"]), select:not([aria-hidden="true"]), textarea'),t=[].slice.call(n.querySelectorAll(i)),t.length?t[0]:n},n.prototype.selector=function(n,t,i){var u=[h.Expand,h.GroupCaption,h.CaptionSummary,h.GroupSummary];return(n.isDataRow&&t.visible&&(t.isDataCell||t.isTemplate)||n.isDataRow&&t.cellType===h.DetailExpand&&Object(r.isNullOrUndefined)(t.visible)||!n.isDataRow&&u.indexOf(t.cellType)>-1||t.column&&"checkbox"===t.column.type||t.cellType===h.CommandColumn||n.isDataRow&&i)&&!("delete"===n.edit&&n.isDirty)},n.prototype.jump=function(n,t){var i=this.parent.frozenColumns>0&&("leftArrow"===n||"shiftTab"===n)&&0===t[1],f=0!==this.parent.frozenRows&&"shiftEnter"===n,r,u;return"tab"!==n||this.parent.isEdit||t[1]!==this.matrix.matrix[t[0]].lastIndexOf(1)||this.matrix.matrix.length-1===t[0]||(this.matrix.current[0]=this.matrix.current[0]+1,this.matrix.current[1]=-1,i=this.parent.frozenColumns>0),"shiftTab"!==n||this.parent.isEdit||0===t[0]||this.matrix.matrix[t[0]].indexOf(1)!==t[1]||(this.matrix.current[0]=this.matrix.current[0]-1,this.matrix.current[1]=this.matrix.matrix[t[0]].length),r=!1,u=document.activeElement.parentElement,(this.parent.enableVirtualization||this.parent.infiniteScrollSettings.enableCache)&&u.classList.contains("e-row")&&(r=parseInt(u.getAttribute("aria-rowindex"),10)>0),{swap:!r&&(("upArrow"===n||f)&&0===t[0]||i),toHeader:("upArrow"===n||f)&&0===t[0],toFrozen:i}},n.prototype.getNextCurrent=function(n,t,i,r){void 0===n&&(n=[]);var u=[];return"rightArrow"===r||"tab"===r?(u[0]=n[0],u[1]=-1):"downArrow"!==r&&"enter"!==r||(u[0]=-1,u[1]=n[1]),u},n.prototype.generateRows=function(n,t){var r,u=t.matrix,i=t.handlerInstance,f=i.matrix.matrix.length,e=this.parent.allowFiltering&&"FilterBar"===this.parent.filterSettings.type?f+1:f;i.matrix.matrix=i.matrix.matrix.slice(0,e);i.matrix.rows=e;(r=i.matrix.matrix).push.apply(r,u);i.matrix.rows+=u.length},n.prototype.getInfo=function(n){var t=this.getFocusInfo(),i=this.matrix.current,f=i[0],e=i[1],r=t.element.classList.contains("e-rowcell"),o=r||n&&"enter"!==n.action&&(t.element.classList.contains("e-detailrowcollapse")||t.element.classList.contains("e-detailrowexpand")),u=[Math.min(parseInt(t.element.parentElement.getAttribute("aria-rowindex"),10),f),Math.min(parseInt(t.element.getAttribute("aria-colindex"),10),e)];return{isContent:!0,isDataCell:r,indexes:[u[0],u[1]],isSelectable:o}},n.prototype.validator=function(){var n=this.getTable();return function(t,i,u){var f,e;if(!Object(r.isNullOrUndefined)(n.rows[t])){if(f=void 0,i=n.querySelector(".e-emptyrow")?0:i,e=0!==(f=n.rows[t].cells[0].classList.contains("e-editcell")?n.rows[t].cells[0].querySelectorAll("td")[i]:n.rows[t].cells[i]).getBoundingClientRect().width,"enter"===u||"shiftEnter"===u)return e&&f.classList.contains("e-rowcell");if(("shiftUp"===u||"shiftDown"===u)&&f.classList.contains("e-rowcell")||"shiftUp"!==u&&"shiftDown"!==u)return e}return!1}},n.prototype.shouldFocusChange=function(n){var i=this.matrix.current,u=i[0],f=void 0===u?-1:u,e=i[1],o=void 0===e?-1:e,t;return f<0||o<0?!0:(t=Object(r.getValue)(f+".cells."+o,this.getTable().rows),!t||"enter"!==n.action&&"shiftEnter"!==n.action||t.classList.contains("e-rowcell")&&!t.classList.contains("e-unboundcell")&&(!t.classList.contains("e-templatecell")||t.classList.contains("e-editedbatchcell"))&&!t.classList.contains("e-detailcell"))},n.prototype.getGridSeletion=function(){return!Object(r.isBlazor)()&&this.parent.allowSelection&&"Column"===this.parent.selectionSettings.mode},n}(),ib=function(n){function t(t){return n.call(this,t)||this}return oa(t,n),t.prototype.getTable=function(){return this.parent.getFrozenColumns()?this.parent.getHeaderContent().querySelector(".e-movableheader .e-table"):this.parent.getHeaderTable()},t.prototype.onClick=function(n){var t=n.target;if((t=t.classList.contains("e-headercell")?t:Object(r.closest)(t,"th"))||0===this.parent.frozenRows||(t=n.target.classList.contains("e-rowcell")?n.target:Object(r.closest)(n.target,"td")),n.target.classList.contains("e-columnheader")||n.target.querySelector(".e-stackedheadercell"))return!1;if(t){var i=[t.parentElement.rowIndex,t.cellIndex],u=i[0],f=i[1],e=Object(r.getValue)(u+"."+f,this.matrix.matrix);if(this.matrix.inValid(e))return!1;this.matrix.select(t.parentElement.rowIndex,t.cellIndex)}},t.prototype.getFocusInfo=function(){var n={},t=this.matrix.current,i=t[0],f=void 0===i?0:i,u=t[1],e=void 0===u?0:u;return n.element=this.getTable().rows[f].cells[e],Object(r.isNullOrUndefined)(n.element)||(n.elementToFocus=this.getFocusable(n.element),n.outline=!n.element.classList.contains("e-filterbarcell")),n},t.prototype.selector=function(n,t){return t.visible&&(void 0!==t.column.field||t.isTemplate||!Object(r.isNullOrUndefined)(t.column.template))||"checkbox"===t.column.type||t.cellType===h.StackedHeader},t.prototype.jump=function(n,t){var f,i,u=this.parent.frozenColumns>0&&("leftArrow"===n||"shiftLeft"===n&&this.getGridSeletion()||"shiftTab"===n)&&0===t[1],s=0!==this.parent.frozenRows&&"enter"===n,e=u,o=this.parent.focusModule.fHeader&&this.parent.focusModule.fHeader.matrix.matrix,h=o&&!Object(r.isNullOrUndefined)(o[t[0]]);return this.parent.enableHeaderFocus&&"tab"===n&&(i=this.matrix.matrix.length-1===t[0],(f=t[1]===this.matrix.matrix[t[0]].lastIndexOf(1))&&(this.matrix.current[0]=i?0:this.matrix.current[0]+1,this.matrix.current[1]=-1),this.parent.frozenColumns>0&&i&&f&&(u=!0,e=!1)),{swap:("downArrow"===n||s)&&t[0]===this.matrix.matrix.length-1||h&&u||"tab"===n&&i&&f,toHeader:e,toFrozen:u}},t.prototype.getNextCurrent=function(n,t,i,r){void 0===n&&(n=[]);var u=[];return"upArrow"===r||"shiftEnter"===r?(u[0]=this.matrix.matrix.length,u[1]=n[1]):("rightArrow"===r||"shiftRight"===r&&this.getGridSeletion()||"tab"===r)&&(u[0]=n[0],u[1]=-1),u},t.prototype.generateRows=function(n){var r=this.matrix.matrix.length,i,t;if(this.parent.allowFiltering&&"FilterBar"===this.parent.filterSettings.type)for(this.matrix.rows=++this.matrix.rows,i=n[0].cells,t=0;t<i.length;t++)this.matrix.set(r,t,i[t].visible&&!1!==i[t].column.allowFiltering)},t.prototype.getInfo=function(t){return Object(r.extend)(n.prototype.getInfo.call(this,t),{isContent:!1,isHeader:!0})},t.prototype.validator=function(){return function(){return!0}},t.prototype.shouldFocusChange=function(n){var i=this.matrix.current,u=i[0],f=i[1],t;return u<0||f<0?!0:(t=Object(r.getValue)(u+".cells."+f,this.getTable().rows),!t||"enter"!==n.action&&"altDownArrow"!==n.action||!t.classList.contains("e-headercell"))},t}(sa),htt=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return oa(t,n),t.prototype.getTable=function(){return this.parent.getContent().querySelector(".e-frozencontent .e-table")},t.prototype.jump=function(n,t){var i=0!==this.parent.frozenRows&&"shiftEnter"===n;return{swap:("upArrow"===n||i)&&0===t[0]||("tab"===n||"rightArrow"===n)&&t[1]===this.matrix.columns,toHeader:("upArrow"===n||i)&&0===t[0],toFrozen:("upArrow"===n||i)&&0===t[0]}},t.prototype.getNextCurrent=function(n,t,i,r){void 0===n&&(n=[]);var u=[];return"tab"===r&&this.parent.enableHeaderFocus&&(u[0]=n[0],u[1]=-1),"leftArrow"===r||"shiftTab"===r?(u[0]=n[0],u[1]=i.matrix.columns+1):"downArrow"!==r&&"enter"!==r||(u[0]=-1,u[1]=n[1]),u},t}(sa),ctt=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return oa(t,n),t.prototype.jump=function(n,t){var i=0!==this.parent.frozenRows&&"enter"===n,u=this.parent.focusModule.header&&this.parent.focusModule.header.matrix.matrix,f=u&&!Object(r.isNullOrUndefined)(u[t[0]]);return{swap:("downArrow"===n||i)&&t[0]===this.matrix.matrix.length-1||("rightArrow"===n||"shiftRight"===n&&this.getGridSeletion()||"tab"===n)&&t[1]===this.matrix.columns&&f,toHeader:("rightArrow"===n||"shiftRight"===n&&this.getGridSeletion()||"tab"===n)&&t[1]===this.matrix.columns,toFrozen:("downArrow"===n||i)&&t[0]===this.matrix.matrix.length-1}},t.prototype.getTable=function(){return this.parent.getHeaderContent().querySelector(".e-frozenheader .e-table")},t.prototype.getNextCurrent=function(n,t,i,r){void 0===n&&(n=[]);var u=[];return"leftArrow"===r||"shiftLeft"===r&&this.getGridSeletion()||"shiftTab"===r?(u[0]=n[0],u[1]=i.matrix.columns+1):"upArrow"!==r&&"shiftEnter"!==r||(u[0]=this.matrix.matrix.length,u[1]=n[1]),u},t}(ib),rb=function(){function n(n){this.searchBox=n}return n.prototype.searchFocus=function(n){n.target.parentElement.classList.add("e-input-focus")},n.prototype.searchBlur=function(n){n.target.parentElement.classList.remove("e-input-focus")},n.prototype.wireEvent=function(){this.searchBox&&(r.EventHandler.add(this.searchBox,"focus",this.searchFocus,this),r.EventHandler.add(this.searchBox,"blur",this.searchBlur,this))},n.prototype.unWireEvent=function(){this.searchBox&&(r.EventHandler.remove(this.searchBox,"focus",this.searchFocus),r.EventHandler.remove(this.searchBox,"blur",this.searchBlur))},n}(),ltt=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),hu=function(n,t,i,r){var f,e=arguments.length,u=e<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r,o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(n,t,i,r);else for(o=n.length-1;o>=0;o--)(f=n[o])&&(u=(e<3?f(u):e>3?f(t,i,u):f(t,i))||u);return e>3&&u&&Object.defineProperty(t,i,u),u},att=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return ltt(t,n),hu([Object(r.Property)(12)],t.prototype,"pageSize",void 0),hu([Object(r.Property)(8)],t.prototype,"pageCount",void 0),hu([Object(r.Property)(1)],t.prototype,"currentPage",void 0),hu([Object(r.Property)()],t.prototype,"totalRecordsCount",void 0),hu([Object(r.Property)(!1)],t.prototype,"enableQueryString",void 0),hu([Object(r.Property)(!1)],t.prototype,"pageSizes",void 0),hu([Object(r.Property)(null)],t.prototype,"template",void 0),t}(r.ChildProperty),vtt=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),ytt=function(n,t,i,r){var f,e=arguments.length,u=e<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r,o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(n,t,i,r);else for(o=n.length-1;o>=0;o--)(f=n[o])&&(u=(e<3?f(u):e>3?f(t,i,u):f(t,i))||u);return e>3&&u&&Object.defineProperty(t,i,u),u},ptt=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return vtt(t,n),ytt([Object(r.Property)("startsWith")],t.prototype,"operator",void 0),t}(r.ChildProperty),ha=function(){return(ha=Object.assign||function(n){for(var r,i,t=1,u=arguments.length;t<u;t++)for(i in r=arguments[t])Object.prototype.hasOwnProperty.call(r,i)&&(n[i]=r[i]);return n}).apply(this,arguments)},ub=function(){function n(n,t,i){this.selectedRowIndexes=[];this.selectedRowCellIndexes=[];this.selectedRecords=[];this.preventFocus=!1;this.selectedColumnsIndexes=[];this.checkBoxState=!1;this.isMultiShiftRequest=!1;this.isMultiCtrlRequest=!1;this.enableSelectMultiTouch=!1;this.clearRowCheck=!1;this.selectRowCheck=!1;this.selectedRowState={};this.totalRecordsCount=0;this.chkAllCollec=[];this.isCheckedOnAdd=!1;this.persistSelectedData=[];this.needColumnSelection=!1;this.isCancelDeSelect=!1;this.isPreventCellSelect=!1;this.disableUI=!1;this.isPersisted=!1;this.cmdKeyPressed=!1;this.cellselected=!1;this.isMultiSelection=!1;this.isAddRowsToSelection=!1;this.initialRowSelection=!1;this.autoFillRLselection=!0;this.parent=n;this.selectionSettings=t;this.factory=i.getService("rendererFactory");this.focus=i.getService("focus");this.addEventListener();this.wireEvents()}return n.prototype.initializeSelection=function(){this.parent.log("selection_key_missing");this.render()},n.prototype.onActionBegin=function(n,t){this.parent.trigger(t,this.fDataUpdate(n))},n.prototype.fDataUpdate=function(n){if(!(this.isMultiSelection||Object(r.isNullOrUndefined)(n.cellIndex)&&Object(r.isNullOrUndefined)(n.rowIndex))){var t=this.getRowObj(Object(r.isNullOrUndefined)(n.rowIndex)?Object(r.isNullOrUndefined)(n.cellIndex)?this.currentIndex:n.cellIndex.rowIndex:n.rowIndex);n.foreignKeyData=t.foreignKeyData}return n},n.prototype.onActionComplete=function(n,t){this.parent.trigger(t,this.fDataUpdate(n));this.isMultiSelection=!1},n.prototype.getModuleName=function(){return"selection"},n.prototype.destroy=function(){var n=this.parent.element;n&&(n.querySelector(".e-gridheader")||n.querySelector(".e-gridcontent"))&&(this.hidePopUp(),this.clearSelection(),this.removeEventListener(),this.unWireEvents(),r.EventHandler.remove(this.parent.getContent(),"mousedown",this.mouseDownHandler),r.EventHandler.remove(this.parent.getHeaderContent(),"mousedown",this.mouseDownHandler))},n.prototype.isEditing=function(){return("Normal"===this.parent.editSettings.mode||"Batch"===this.parent.editSettings.mode&&this.parent.editModule&&this.parent.editModule.formObj&&!this.parent.editModule.formObj.validate())&&this.parent.isEdit&&!this.parent.isPersistSelection},n.prototype.getSelectedMovableRow=function(n){var t=this.parent;return t.getFrozenColumns()&&this.parent.getContent().querySelector(".e-movablecontent")?t.getMovableRowByIndex(n):null},n.prototype.getCurrentBatchRecordChanges=function(){var i=this.parent,n,t;if("Batch"===i.editSettings.mode&&i.editModule){n=ih(this.parent.getCurrentViewRecords());n="Bottom"===i.editSettings.newRowPosition?n.concat(this.parent.editModule.getBatchChanges().addedRecords):this.parent.editModule.getBatchChanges().addedRecords.concat(n);for(var u=this.parent.editModule.getBatchChanges().deletedRecords,f=this.parent.getPrimaryKeyFieldNames()[0],r=0;r<u.length;r++)for(t=0;t<n.length;t++)if(u[r][f]===n[t][f]){n.splice(t,1);break}return n}return i.getCurrentViewRecords()},n.prototype.selectRow=function(n,t){var o,i,s;if(this.selectedRowIndexes.length&&this.selectionSettings.enableSimpleMultiRowSelection)this.addRowsToSelection([n]);else{var f,u=this.parent,e=u.getRowByIndex(n),h=this.getSelectedMovableRow(n);if(u.enableVirtualization&&n>-1){if(this.parent.notify(pl,{selectedIndex:n}),o=u.getFrozenColumns()?u.contentModule.getRowObjectByIndex(n):null,!e||!u.getRowObjectFromUID(e.getAttribute("data-uid"))&&!o)return void(this.parent.getSelectedRecords().length>0&&this.clearRowSelection());f=o||u.getRowObjectFromUID(e.getAttribute("data-uid")).data}else f=this.getCurrentBatchRecordChanges()[n];this.isRowType()&&e&&!this.isEditing()&&(s=e.hasAttribute("aria-selected"),this.activeTarget(),(t=t?!!this.selectedRowIndexes.length&&1===this.selectedRowIndexes.length&&n===this.selectedRowIndexes[0]:t)?this.rowSelectingCallBack(i,t,n,f,!1,s,"cancel")(i):(!Object(r.isBlazor)()||this.parent.isJsComponent||this.parent.isHybrid?(i={data:f,rowIndex:n,isCtrlPressed:this.isMultiCtrlRequest,isShiftPressed:this.isMultiShiftRequest,row:e,previousRow:u.getRowByIndex(this.prevRowIndex),previousRowIndex:this.prevRowIndex,target:this.actualTarget,cancel:!1,isInteracted:this.isInteracted,isHeaderCheckboxClicked:this.isHeaderCheckboxClicked},i=this.addMovableArgs(i,h)):i={data:f,rowIndex:n,isCtrlPressed:this.isMultiCtrlRequest,isShiftPressed:this.isMultiShiftRequest,previousRowIndex:this.prevRowIndex,cancel:!1,isInteracted:this.isInteracted,isHeaderCheckboxClicked:this.isHeaderCheckboxClicked},this.parent.trigger(oo,this.fDataUpdate(i),this.rowSelectingCallBack(i,t,n,f,!1,s,"cancel"))))}},n.prototype.rowSelectingCallBack=function(n,t,i,u,f,e,o){var s=this;return function(n){Object(r.isNullOrUndefined)(n)||!0!==n[o]?(s.index=i,s.toggle=t,s.data=u,s.removed=f,e&&s.selectionSettings.persistSelection&&"ResetOnRowClick"!==s.selectionSettings.checkboxMode?(s.clearSelectedRow(i),s.selectRowCallBack()):!e&&s.selectionSettings.persistSelection&&"ResetOnRowClick"!==s.selectionSettings.checkboxMode&&s.selectRowCallBack(),"ResetOnRowClick"===s.selectionSettings.checkboxMode&&s.clearSelection(),(!s.selectionSettings.persistSelection||"ResetOnRowClick"===s.selectionSettings.checkboxMode||!s.parent.isCheckBoxSelection&&s.selectionSettings.persistSelection)&&(s.selectRowCheck=!0,s.clearRow())):s.disableInteracted()}},n.prototype.selectRowCallBack=function(){var t,i=this.parent,n=this.index,f=this.toggle,e=this.data,s=this.removed,u=i.getRowByIndex(n),o=this.getSelectedMovableRow(n);(f||s||(this.selectedRowIndexes.indexOf(n)<=-1&&(i.getFrozenColumns()&&this.updateRowSelection(o,n),this.updateRowSelection(u,n)),this.selectRowIndex(n)),f)||(!Object(r.isBlazor)()||this.parent.isJsComponent||this.parent.isHybrid?(t={data:e,rowIndex:n,row:u,previousRow:i.getRowByIndex(this.prevRowIndex),previousRowIndex:this.prevRowIndex,target:this.actualTarget,isInteracted:this.isInteracted,isHeaderCheckBoxClicked:this.isHeaderCheckboxClicked},t=this.addMovableArgs(t,o)):t={data:e,rowIndex:n,row:u,previousRow:i.getRowByIndex(this.prevRowIndex),previousRowIndex:this.prevRowIndex,isInteracted:this.isInteracted,isHeaderCheckBoxClicked:this.isHeaderCheckboxClicked},this.onActionComplete(t,wf));Object(r.isBlazor)()&&this.parent.isServerRendered&&this.parent.enableVirtualization&&this.parent.interopAdaptor.invokeMethodAsync("MaintainSelection",!0,"normal",[n]);this.isInteracted=!1;this.updateRowProps(n)},n.prototype.addMovableArgs=function(n,t){if(this.parent.getFrozenColumns()){var i={mRow:t,previousMovRow:this.parent.getMovableRows()[this.prevRowIndex]};n=ha({},n,i)}return n},n.prototype.selectRowsByRange=function(n,t){this.selectRows(this.getCollectionFromIndexes(n,t));this.selectRowIndex(t)},n.prototype.selectRows=function(n){var t=this,u=this.parent,i=this.isSingleSel()?n[n.length-1]:n[0],h,y,l,c,o;this.isMultiSelection=!0;var s=[],f=[],a=this.getSelectedMovableRow(i),v=u.getFrozenColumns(),e=[];if(this.isRowType()&&!this.isEditing()){for(h=0,y=n.length;h<y;h++)l=this.parent.getDataRows()[n[h]],c=this.getRowObj(l),c&&(e.push(c.data),s.push(l),f.push(c.foreignKeyData));this.activeTarget();!Object(r.isBlazor)()||this.parent.isJsComponent||this.parent.isHybrid?(o={cancel:!1,rowIndexes:n,row:s,rowIndex:i,target:this.actualTarget,prevRow:u.getRows()[this.prevRowIndex],previousRowIndex:this.prevRowIndex,isInteracted:this.isInteracted,isCtrlPressed:this.isMultiCtrlRequest,isShiftPressed:this.isMultiShiftRequest,data:e,isHeaderCheckboxClicked:this.isHeaderCheckboxClicked,foreignKeyData:f},o=this.addMovableArgs(o,a)):o={cancel:!1,rowIndexes:n,rowIndex:i,previousRowIndex:this.prevRowIndex,isCtrlPressed:this.isMultiCtrlRequest,isShiftPressed:this.isMultiShiftRequest,data:e,isHeaderCheckboxClicked:this.isHeaderCheckboxClicked,foreignKeyData:f};this.parent.trigger(oo,this.fDataUpdate(o),function(o){var c,l,h;if(Object(r.isNullOrUndefined)(o)||!0!==o.cancel){if(t.clearRow(),t.selectRowIndex(n.slice(-1)[0]),t.isSingleSel())t.updateRowSelection(u.getRowByIndex(i),i),v&&t.updateRowSelection(u.getMovableRowByIndex(i),i),t.updateRowProps(i);else for(c=0,l=n;c<l.length;c++)h=l[c],t.updateRowSelection(u.getRowByIndex(h),h),v&&t.updateRowSelection(u.getMovableRowByIndex(h),h),t.updateRowProps(i);!Object(r.isBlazor)()||t.parent.isJsComponent||t.parent.isHybrid?(o={rowIndexes:n,row:s,rowIndex:i,target:t.actualTarget,prevRow:u.getRows()[t.prevRowIndex],previousRowIndex:t.prevRowIndex,data:Object(r.isBlazor)()?e:t.getSelectedRecords(),isInteracted:t.isInteracted,isHeaderCheckboxClicked:t.isHeaderCheckboxClicked,foreignKeyData:f},o=t.addMovableArgs(o,a)):o={rowIndexes:n,rowIndex:i,previousRowIndex:t.prevRowIndex,row:s,prevRow:u.getRows()[t.prevRowIndex],data:Object(r.isBlazor)()?e:t.getSelectedRecords(),isInteracted:t.isInteracted,isHeaderCheckboxClicked:t.isHeaderCheckboxClicked,foreignKeyData:f};t.isRowSelected&&t.onActionComplete(o,wf)}else t.disableInteracted()})}},n.prototype.addRowsToSelection=function(n){var o=this,e=this.parent,l=this.target,h;this.isMultiSelection=!0;var s=e.getSelectedRowIndexes().concat(n),u=this.isSingleSel()?e.getRowByIndex(n[n.length-1]):e.getRowByIndex(n[0]),f=this.isSingleSel()?this.getSelectedMovableRow(n[n.length-1]):this.getSelectedMovableRow(n[0]),v=e.getFrozenColumns();if(this.isRowType()&&!this.isEditing()||this.selectionSettings.checkboxOnly)for(var i,y=this.parent.getColumns().filter(function(n){return"checkbox"===n.type}),p=function(n){var h=t.getRowObj(n),a=t.selectedRowIndexes.indexOf(n)>-1,c;if(t.selectRowIndex(n),a&&(y.length||t.selectionSettings.enableToggle||t.isMultiCtrlRequest)){if(t.isAddRowsToSelection=!0,t.rowDeselect(uc,[n],[h.data],[u],[h.foreignKeyData],l),t.isCancelDeSelect)return{value:void 0};t.selectedRowIndexes.splice(t.selectedRowIndexes.indexOf(n),1);t.selectedRecords.splice(t.selectedRecords.indexOf(u),1);u.removeAttribute("aria-selected");t.addRemoveClassesForRow(u,!1,null,"e-selectionbackground","e-active");f&&(t.selectedRecords.splice(t.selectedRecords.indexOf(f),1),f.removeAttribute("aria-selected"),t.addRemoveClassesForRow(f,!1,null,"e-selectionbackground","e-active"));t.rowDeselect(fc,[n],[h.data],[u],[h.foreignKeyData],l,[f]);t.isInteracted=!1;t.isMultiSelection=!1;t.isAddRowsToSelection=!1}else c="isHybrid",t.activeTarget(),!Object(r.isBlazor)()||t.parent.isJsComponent||t.parent[c]?(i={cancel:!1,data:h.data,rowIndex:n,row:u,target:t.actualTarget,prevRow:e.getRows()[t.prevRowIndex],previousRowIndex:t.prevRowIndex,isCtrlPressed:t.isMultiCtrlRequest,isShiftPressed:t.isMultiShiftRequest,foreignKeyData:h.foreignKeyData,isInteracted:t.isInteracted,isHeaderCheckboxClicked:t.isHeaderCheckboxClicked,rowIndexes:s},i=t.addMovableArgs(i,f)):i={cancel:!1,data:h.data,rowIndex:n,previousRowIndex:t.prevRowIndex,isCtrlPressed:t.isMultiCtrlRequest,isShiftPressed:t.isMultiShiftRequest,foreignKeyData:h.foreignKeyData,isInteracted:t.isInteracted,isHeaderCheckboxClicked:t.isHeaderCheckboxClicked,rowIndexes:s},t.parent.trigger(oo,t.fDataUpdate(i),function(t){Object(r.isNullOrUndefined)(t)||!0!==t.cancel?(o.isSingleSel()&&o.clearRow(),o.updateRowSelection(u,n),v&&o.updateRowSelection(f,n)):o.disableInteracted()});return a||(c="isHybrid",!Object(r.isBlazor)()||t.parent.isJsComponent||t.parent[c]?(i={data:h.data,rowIndex:n,row:u,target:t.actualTarget,prevRow:e.getRows()[t.prevRowIndex],previousRowIndex:t.prevRowIndex,foreignKeyData:h.foreignKeyData,isInteracted:t.isInteracted,isHeaderCheckboxClicked:t.isHeaderCheckboxClicked,rowIndexes:s},i=t.addMovableArgs(i,f)):i={data:h.data,rowIndex:n,previousRowIndex:t.prevRowIndex,row:u,prevRow:e.getRows()[t.prevRowIndex],foreignKeyData:h.foreignKeyData,isInteracted:t.isInteracted,isHeaderCheckboxClicked:t.isHeaderCheckboxClicked,rowIndexes:s},t.onActionComplete(i,wf)),(t.isInteracted=!1,t.updateRowProps(n),t.isSingleSel())?"break":void 0},t=this,c=0,a=n;c<a.length;c++){if(h=p(a[c]),"object"==typeof h)return h.value;if("break"===h)break}},n.prototype.getCollectionFromIndexes=function(n,t){for(var i=[],u=n<=t?{i:n,max:t}:{i:t,max:n},r=u.i,f=u.max;r<=f;r++)i.push(r);return n>t&&i.reverse(),i},n.prototype.clearRow=function(){this.clearRowCheck=!0;this.clearRowSelection()},n.prototype.clearRowCallBack=function(){this.isCancelDeSelect&&"Check"!==this.parent.checkAllRows||(this.selectedRowIndexes=[],this.selectedRecords=[],this.selectRowIndex(-1),this.isSingleSel()&&this.parent.isPersistSelection&&(this.selectedRowState={}))},n.prototype.clearSelectedRow=function(n){if(this.toggle){var t=this.parent.getRowByIndex(n);this.disableUI||(t.removeAttribute("aria-selected"),this.addRemoveClassesForRow(t,!1,!0,"e-selectionbackground","e-active"));this.removed=!0;this.updatePersistCollection(t,!1);this.updateCheckBoxes(t);this.selectedRowIndexes.splice(this.selectedRowIndexes.indexOf(n),1);this.selectedRecords.splice(this.selectedRecords.indexOf(this.parent.getRowByIndex(n)),1)}},n.prototype.updateRowProps=function(n){this.prevRowIndex=n;this.isRowSelected=this.selectedRowIndexes.length&&!0},n.prototype.updatePersistCollection=function(n,t){var f=this,i,u;if((this.parent.isPersistSelection||this.parent.selectionSettings.persistSelection&&this.parent.getPrimaryKeyFieldNames().length>0)&&!Object(r.isNullOrUndefined)(n)){if(this.parent.isPersistSelection||this.ensureCheckboxFieldSelection(),i=this.getRowObj(n),u=i.data?i.data[this.primaryKey]:null,null===u)return;i.isSelected=t;t?(this.selectedRowState[u]=t,this.persistSelectedData.some(function(n){return n[f.primaryKey]===u})||this.persistSelectedData.push(i.data)):this.updatePersistDelete(u)}},n.prototype.updatePersistDelete=function(n){var t,i=this;delete this.selectedRowState[n];this.persistSelectedData.some(function(r,u){return t=u,r[i.primaryKey]===n})&&this.persistSelectedData.splice(t,1)},n.prototype.updateCheckBoxes=function(n,t,i){if(!Object(r.isNullOrUndefined)(n)){var u=n.querySelector(".e-checkselect");Object(r.isNullOrUndefined)(u)||(lf(u.nextElementSibling,t),wr(u,t),(Object(r.isNullOrUndefined)(this.checkedTarget)||!Object(r.isNullOrUndefined)(this.checkedTarget)&&!this.checkedTarget.classList.contains("e-checkselectall"))&&this.setCheckAllState(i))}},n.prototype.updateRowSelection=function(n,t){var i,r;if(n&&(this.selectedRowIndexes.push(t),i=this.selectedRowIndexes.length,this.parent.getFrozenColumns()&&i>1&&this.selectedRowIndexes[i-2]===this.selectedRowIndexes[i-1]&&this.selectedRowIndexes.pop(),this.selectedRecords.push(n),n.setAttribute("aria-selected","true"),this.updatePersistCollection(n,!0),this.updateCheckBoxes(n,!0),this.addRemoveClassesForRow(n,!0,null,"e-selectionbackground","e-active"),!this.preventFocus)){if(r=this.focus.getPrevIndexes().cellIndex?n.cells[this.focus.getPrevIndexes().cellIndex]:n.querySelector(".e-selectionbackground:not(.e-hide):not(.e-detailrowcollapse):not(.e-detailrowexpand)"),this.parent.contextMenuModule&&2===this.mouseButton&&(r=this.parent.contextMenuModule.cell),!r)return;this.focus.onClick({target:r},!0)}},n.prototype.clearSelection=function(){if(!this.parent.isPersistSelection||this.parent.isPersistSelection&&!this.parent.isEdit||!Object(r.isNullOrUndefined)(this.checkedTarget)&&this.checkedTarget.classList.contains("e-checkselectall")){var n=this.parent.element.querySelector(".e-gridpopup").querySelector("span");n.classList.contains("e-rowselect")&&n.classList.remove("e-spanclicked");this.parent.isPersistSelection&&(this.persistSelectedData=[],this.selectedRowState={});this.clearRowSelection();this.clearCellSelection();this.clearColumnSelection();this.prevRowIndex=void 0;this.enableSelectMultiTouch=!1;this.isInteracted=!1}},n.prototype.clearRowSelection=function(){var n=this,h,i;if(this.isRowSelected){for(var c=this.parent,a=this.parent.getDataRows(),u=[],f=[],e=[],o=[],v=c.getFrozenColumns(),s=[],l=this.target,t=(this.parent.getCurrentViewRecords(),0),y=this.selectedRowIndexes.length;t<y;t++)h="Batch"===this.parent.editSettings.mode?this.parent.getRows()[this.selectedRowIndexes[t]]:this.parent.getDataRows()[this.selectedRowIndexes[t]],i=this.getRowObj(h),i&&(u.push(i.data),f.push(h),o.push(this.selectedRowIndexes[t]),s.push(i.foreignKeyData)),v&&e.push(c.getMovableRows()[this.selectedRowIndexes[t]]);this.selectionSettings.persistSelection&&"ResetOnRowClick"!==this.selectionSettings.checkboxMode&&(this.isInteracted=!!this.checkSelectAllClicked);this.rowDeselect(uc,o,u,f,s,l,e,function(){var t,h,i,v,c;if(n.isCancelDeSelect&&(n.isInteracted||n.checkSelectAllClicked)){if(n.parent.isPersistSelection)if("Intermediate"===n.getCheckAllStatus(n.parent.element.querySelector(".e-checkselectall")))for(t=0;t<n.selectedRecords.length;t++)n.updatePersistCollection(n.selectedRecords[t],!0);else n.parent.checkAllRows="Check",n.updatePersistSelectedData(!0);n.clearRowCheck&&(n.clearRowCallBack(),n.clearRowCheck=!1,n.selectRowCheck&&(n.selectRowCallBack(),n.selectRowCheck=!1))}else{for(h=[].slice.call(a.filter(function(n){return n.hasAttribute("aria-selected")})),i=0;i<h.length;i++)n.disableUI&&!Object(r.isBlazor)()||(h[i].removeAttribute("aria-selected"),n.addRemoveClassesForRow(h[i],!1,!0,"e-selectionbackground","e-active")),n.updatePersistCollection(h[i],!1),n.updateCheckBoxes(h[i]);for(Object(r.isBlazor)()&&n.parent.isServerRendered&&n.parent.enableVirtualization&&n.getRenderer().setSelection(null,!1,!0),t=0,v=n.selectedRowIndexes.length;t<v;t++)c=n.getSelectedMovableRow(n.selectedRowIndexes[t]),c&&(n.disableUI&&!Object(r.isBlazor)()||(c.removeAttribute("aria-selected"),n.addRemoveClassesForRow(c,!1,!0,"e-selectionbackground","e-active")),n.updatePersistCollection(c,!1));n.selectedRowIndexes=[];n.selectedRecords=[];n.isRowSelected=!1;n.selectRowIndex(-1);n.rowDeselect(fc,o,u,f,s,l,e);n.clearRowCheck&&(n.clearRowCallBack(),n.clearRowCheck=!1,n.selectRowCheck&&(n.selectRowCallBack(),n.selectRowCheck=!1))}})}else this.clearRowCheck&&(this.clearRowCallBack(),this.clearRowCheck=!1,this.selectRowCheck&&(this.selectRowCallBack(),this.selectRowCheck=!1))},n.prototype.rowDeselect=function(n,t,i,u,f,e,o,s){var c=this,h;this.selectionSettings.persistSelection&&this.isInteracted||!this.selectionSettings.persistSelection?(h={rowIndex:t[0],data:this.selectionSettings.persistSelection&&"Uncheck"===this.parent.checkAllRows&&"ResetOnRowClick"!==this.selectionSettings.checkboxMode?this.persistSelectedData:i,foreignKeyData:f,cancel:!1,isInteracted:this.isInteracted,isHeaderCheckboxClicked:this.isHeaderCheckboxClicked},"rowDeselected"===n&&delete h.cancel,!Object(r.isBlazor)()||this.parent.isJsComponent||this.parent.isHybrid?(h.row=u,h.target=this.actualTarget,this.actualTarget&&!Object(r.isNullOrUndefined)(Object(r.closest)(this.actualTarget,"thead"))||t.length>1?(h.rowIndex=t[0],h.rowIndexes=t):1===t.length&&(h.data=h.data[0],h.row=h.row[0],h.foreignKeyData=h.foreignKeyData[0],this.isAddRowsToSelection&&(h.rowIndexes=t))):(h.rowIndex=h.rowIndex[h.rowIndex.length-1],h.data=h.data[h.data.length-1]),this.parent.trigger(n,Object(r.isBlazor)()&&!this.parent.isJsComponent||0===this.parent.getFrozenColumns()?h:ha({},h,{mRow:o}),function(n){c.isCancelDeSelect=n.cancel;c.isCancelDeSelect&&(c.isInteracted||c.checkSelectAllClicked)||(c.updatePersistCollection(u[0],!1),c.updateCheckBoxes(u[0],void 0,t[0]));void 0!==s&&s()})):this.selectionSettings.persistSelection&&!this.isInteracted&&void 0!==s&&s()},n.prototype.getRowObj=function(n){return void 0===n&&(n=this.currentIndex),Object(r.isNullOrUndefined)(n)?{}:("number"==typeof n&&(n=this.parent.getRowByIndex(n)),n&&this.parent.getRowObjectFromUID(n.getAttribute("data-uid"))||{})},n.prototype.getSelectedMovableCell=function(n){var t=this.parent,i=t.getFrozenColumns();return i&&n.cellIndex>=i?t.getMovableCellFromIndex(n.rowIndex,this.getColIndex(n.rowIndex,n.cellIndex)):null},n.prototype.selectCell=function(n,t){var u,e,i,f,o;this.isCellType()&&(e=this.parent,i=this.getSelectedMovableCell(n),i||(i=e.getCellFromIndex(n.rowIndex,this.getColIndex(n.rowIndex,n.cellIndex))),this.currentIndex=n.rowIndex,f=this.getCurrentBatchRecordChanges()[this.currentIndex],this.isCellType()&&i&&!this.isEditing()&&(o=i.classList.contains("e-cellselectionbackground"),(t=t?!Object(r.isUndefined)(this.prevCIdxs)&&n.rowIndex===this.prevCIdxs.rowIndex&&n.cellIndex===this.prevCIdxs.cellIndex&&o:t)?this.successCallBack(u,t,n,i,f)(u):((u={data:f,cellIndex:n,isCtrlPressed:this.isMultiCtrlRequest,isShiftPressed:this.isMultiShiftRequest,previousRowCell:this.prevECIdxs?this.getCellIndex(this.prevECIdxs.rowIndex,this.prevECIdxs.cellIndex):void 0,cancel:!1},!Object(r.isBlazor)()||this.parent.isJsComponent)&&(u.currentCell=i,u.previousRowCellIndex=this.prevECIdxs),this.parent.trigger(wu,this.fDataUpdate(u),this.successCallBack(u,t,n,i,f)),this.cellselected=!0)))},n.prototype.successCallBack=function(n,t,i,u,f){var e=this;return function(n){if((Object(r.isNullOrUndefined)(n)||!0!==n.cancel)&&(t||(n.currentCell=n.currentCell?n.currentCell:u),e.clearCell(),t||e.updateCellSelection(u,i.rowIndex,i.cellIndex),!t)){var o=void 0;!Object(r.isBlazor)()||e.parent.isJsComponent||e.parent.isHybrid?(o={data:f,cellIndex:i,currentCell:u,selectedRowCellIndex:e.selectedRowCellIndexes,previousRowCell:e.prevECIdxs?e.getCellIndex(e.prevECIdxs.rowIndex,e.prevECIdxs.cellIndex):void 0}).previousRowCellIndex=e.prevECIdxs:o={data:f,cellIndex:i,selectedRowCellIndex:e.selectedRowCellIndexes};e.updateCellProps(i,i);e.onActionComplete(o,bf)}}},n.prototype.getCellIndex=function(n,t){return this.parent.getFrozenColumns()&&t>=this.parent.getFrozenColumns()?this.parent.getMovableCellFromIndex(n,t):this.parent.getCellFromIndex(n,t)},n.prototype.selectCellsByRange=function(n,t){var i=this,c,v,s,h,l;if(this.isCellType()){var u,f,e=this.parent,o=this.getSelectedMovableCell(n),a=e.getFrozenColumns();o||(o=e.getCellFromIndex(n.rowIndex,n.cellIndex));v=n;s=t=t||n;this.currentIndex=n.rowIndex;h=this.getCurrentBatchRecordChanges()[this.currentIndex];this.isSingleSel()||!this.isCellType()||this.isEditing()||(l={data:h,cellIndex:n,currentCell:o,isCtrlPressed:this.isMultiCtrlRequest,isShiftPressed:this.isMultiShiftRequest,previousRowCell:this.prevECIdxs?this.getCellIndex(this.prevECIdxs.rowIndex,this.prevECIdxs.cellIndex):void 0},Object(r.isBlazor)()||(l.previousRowCellIndex=this.prevECIdxs),this.parent.trigger(wu,this.fDataUpdate(l),function(l){var b,y,p,k,w;if(Object(r.isNullOrUndefined)(l)||!0!==l.cancel){for((i.clearCell(),n.rowIndex>t.rowIndex)&&(b=n,n=t,t=b),y=n.rowIndex;y<=t.rowIndex;y++){for(i.selectionSettings.cellSelectionMode.indexOf("Box")<0?(u=y===n.rowIndex?n.cellIndex:0,f=y===t.rowIndex?t.cellIndex:i.getLastColIndex(y)):(u=n.cellIndex,f=t.cellIndex),c=[],p=u<f?u:f,k=u>f?u:f;p<=k;p++)(o=a?p<a?e.getCellFromIndex(y,p):e.getMovableCellFromIndex(y,p):e.getCellFromIndex(y,p))&&(c.push(p),i.updateCellSelection(o),i.addAttribute(o));i.selectedRowCellIndexes.push({rowIndex:y,cellIndexes:c})}!Object(r.isBlazor)()||i.parent.isJsComponent||i.parent.isHybrid?(w={data:h,cellIndex:s,currentCell:e.getCellFromIndex(s.rowIndex,s.cellIndex),selectedRowCellIndex:i.selectedRowCellIndexes,previousRowCell:i.prevECIdxs?i.getCellIndex(i.prevECIdxs.rowIndex,i.prevECIdxs.cellIndex):void 0}).previousRowCellIndex=i.prevECIdxs:w={data:h,cellIndex:s,selectedRowCellIndex:i.selectedRowCellIndexes};i.isDragged||(i.onActionComplete(w,bf),i.cellselected=!0);i.updateCellProps(v,s)}}))}},n.prototype.selectCells=function(n){var e,o,s,t,c,i,l;if(this.isCellType()){var f=this.parent,u=this.getSelectedMovableCell(n[0]),h=f.getFrozenColumns();if(u||(u=f.getCellFromIndex(n[0].rowIndex,n[0].cellIndexes[0])),this.currentIndex=n[0].rowIndex,e=this.getCurrentBatchRecordChanges()[this.currentIndex],!this.isSingleSel()&&this.isCellType()&&!this.isEditing()){!Object(r.isBlazor)()||this.parent.isJsComponent||this.parent.isHybrid?(o={data:e,cellIndex:n[0].cellIndexes[0],currentCell:u,isCtrlPressed:this.isMultiCtrlRequest,isShiftPressed:this.isMultiShiftRequest,previousRowCell:this.prevECIdxs?this.getCellIndex(this.prevECIdxs.rowIndex,this.prevECIdxs.cellIndex):void 0}).previousRowCellIndex=this.prevECIdxs:o={data:e,cellIndex:n[0].cellIndexes[0],isCtrlPressed:this.isMultiCtrlRequest,isShiftPressed:this.isMultiShiftRequest};this.onActionBegin(o,wu);for(t=0,c=n.length;t<c;t++)for(i=0,l=n[t].cellIndexes.length;i<l;i++)(u=h?n[t].cellIndexes[i]<h?f.getCellFromIndex(n[t].rowIndex,n[t].cellIndexes[i]):f.getMovableCellFromIndex(n[t].rowIndex,n[t].cellIndexes[i]):f.getCellFromIndex(n[t].rowIndex,n[t].cellIndexes[i]))&&(this.updateCellSelection(u),this.addAttribute(u),this.addRowCellIndex({rowIndex:n[t].rowIndex,cellIndex:n[t].cellIndexes[i]}));(this.updateCellProps({rowIndex:n[0].rowIndex,cellIndex:n[0].cellIndexes[0]},{rowIndex:n[0].rowIndex,cellIndex:n[0].cellIndexes[0]}),!Object(r.isBlazor)()||this.parent.isJsComponent||this.parent.isHybrid)?(s={data:e,cellIndex:n[0].cellIndexes[0],currentCell:u,selectedRowCellIndex:this.selectedRowCellIndexes,previousRowCell:this.prevECIdxs?this.getCellIndex(this.prevECIdxs.rowIndex,this.prevECIdxs.cellIndex):void 0}).previousRowCellIndex=this.prevECIdxs:s={data:e,cellIndex:n[0].cellIndexes[0],selectedRowCellIndex:this.selectedRowCellIndexes};this.onActionComplete(s,bf)}}},n.prototype.addCellsToSelection=function(n){var i,h,o,e,u,p,f,l,s,a;if(this.isCellType()&&(o=this.parent,e=o.getFrozenColumns(),this.currentIndex=n[0].rowIndex,u=this.getCurrentBatchRecordChanges()[this.currentIndex],!this.isSingleSel()&&this.isCellType()&&!this.isEditing())){this.hideAutoFill();p=e&&n[0].cellIndex>=e?o.getMovableRowsObject()[n[0].rowIndex]:this.getRowObj(n[0].rowIndex);for(var v=[],y=0,w=n;y<w.length;y++){for(var t=w[y],c=0,b=this.selectedRowCellIndexes.length;c<b;c++)if(this.selectedRowCellIndexes[c].rowIndex===t.rowIndex){h=c;break}if((i=this.getSelectedMovableCell(t))||(i=o.getCellFromIndex(t.rowIndex,this.getColIndex(t.rowIndex,t.cellIndex))),v.push(p.cells[e&&n[0].cellIndex>=e?t.cellIndex-e:t.cellIndex].foreignKeyData),f=void 0,!Object(r.isBlazor)()||this.parent.isJsComponent||this.parent.isHybrid?(f={cancel:!1,data:u,cellIndex:n[0],isShiftPressed:this.isMultiShiftRequest,currentCell:i,isCtrlPressed:this.isMultiCtrlRequest,previousRowCell:this.prevECIdxs?o.getCellFromIndex(this.prevECIdxs.rowIndex,this.prevECIdxs.cellIndex):void 0}).previousRowCellIndex=this.prevECIdxs:f={cancel:!1,data:u,cellIndex:n[0],isShiftPressed:this.isMultiShiftRequest,isCtrlPressed:this.isMultiCtrlRequest},l=h>-1,l)s=this.selectedRowCellIndexes[h].cellIndexes,s.indexOf(t.cellIndex)>-1?(this.cellDeselect(ec,[{rowIndex:t.rowIndex,cellIndexes:[t.cellIndex]}],u,[i],v),s.splice(s.indexOf(t.cellIndex),1),0===s.length&&this.selectedRowCellIndexes.splice(h,1),i.classList.remove("e-cellselectionbackground"),i.removeAttribute("aria-selected"),this.cellDeselect(oc,[{rowIndex:t.rowIndex,cellIndexes:[t.cellIndex]}],u,[i],v)):(l=!1,this.onActionBegin(f,wu),this.addRowCellIndex({rowIndex:t.rowIndex,cellIndex:t.cellIndex}),this.updateCellSelection(i),this.addAttribute(i));else{if(this.onActionBegin(f,wu),!Object(r.isNullOrUndefined)(f)&&!0===f.cancel)return;this.updateCellSelection(i,t.rowIndex,t.cellIndex)}l||(a=void 0,!Object(r.isBlazor)()||this.parent.isJsComponent||this.parent.isHybrid?(a={data:u,cellIndex:n[0],currentCell:i,previousRowCell:this.prevECIdxs?this.getCellIndex(this.prevECIdxs.rowIndex,this.prevECIdxs.cellIndex):void 0,selectedRowCellIndex:this.selectedRowCellIndexes}).previousRowCellIndex=this.prevECIdxs:a={data:u,cellIndex:n[0],selectedRowCellIndex:this.selectedRowCellIndexes},this.onActionComplete(a,bf),this.cellselected=!0);this.updateCellProps(t,t)}}},n.prototype.getColIndex=function(n,t){var i,u=this.parent.getFrozenColumns(),r;if(u&&t>=u&&(i=this.parent.getMovableDataRows()[n]&&this.parent.getMovableDataRows()[n].querySelectorAll("td.e-rowcell")),i||(i=this.parent.getDataRows()[n]&&this.parent.getDataRows()[n].querySelectorAll("td.e-rowcell")),i)for(r=0;r<i.length;r++)if(parseInt(i[r].getAttribute("aria-colindex"),10)===t)return u&&t>=u&&(r+=u),r;return-1},n.prototype.getLastColIndex=function(n){var t=this.parent.getFrozenColumns()?this.parent.getMovableDataRows()[n].querySelectorAll("td.e-rowcell"):this.parent.getDataRows()[n].querySelectorAll("td.e-rowcell");return parseInt(t[t.length-1].getAttribute("aria-colindex"),10)},n.prototype.clearCell=function(){this.clearCellSelection()},n.prototype.cellDeselect=function(n,t,i,u,f){u[0]&&u[0].classList.contains("e-gridchkbox")&&this.updateCheckBoxes(Object(r.closest)(u[0],"tr"));var e={cells:u,data:i,cellIndexes:t,foreignKeyData:f,cancel:!1};this.parent.trigger(n,e);this.isPreventCellSelect=e.cancel},n.prototype.updateCellSelection=function(n,t,i){Object(r.isNullOrUndefined)(t)||this.addRowCellIndex({rowIndex:t,cellIndex:i});n.classList.add("e-cellselectionbackground");n.classList.contains("e-gridchkbox")&&this.updateCheckBoxes(Object(r.closest)(n,"tr"),!0);this.addAttribute(n)},n.prototype.addAttribute=function(n){this.target=n;Object(r.isNullOrUndefined)(n)||(n.setAttribute("aria-selected","true"),this.preventFocus||this.focus.onClick({target:n},!0))},n.prototype.updateCellProps=function(n,t){this.prevCIdxs=n;this.prevECIdxs=t;this.isCellSelected=this.selectedRowCellIndexes.length&&!0},n.prototype.addRowCellIndex=function(n){for(var r,i,t=0,u=this.selectedRowCellIndexes.length;t<u;t++)if(this.selectedRowCellIndexes[t].rowIndex===n.rowIndex){r=!0;i=t;break}r?this.selectedRowCellIndexes[i].cellIndexes.indexOf(n.cellIndex)<0&&this.selectedRowCellIndexes[i].cellIndexes.push(n.cellIndex):this.selectedRowCellIndexes.push({rowIndex:n.rowIndex,cellIndexes:[n.cellIndex]})},n.prototype.clearCellSelection=function(){var n,f;if(this.isCellSelected){var u=this.parent,e=this.getSelectedCellsElement(),t=this.selectedRowCellIndexes,o=[],r=[],s=[],l=this.getCurrentBatchRecordChanges(),h=u.getFrozenColumns();for(this.hideAutoFill(),n=0,f=t.length;n<f;n++){o.push(l[t[n].rowIndex]);for(var c=this.getRowObj(t[n].rowIndex),i=0,a=t[n].cellIndexes.length;i<a;i++)h?t[n].cellIndexes[i]<h?r.push(u.getCellFromIndex(t[n].rowIndex,t[n].cellIndexes[i])):r.push(u.getMovableCellFromIndex(t[n].rowIndex,t[n].cellIndexes[i])):(c.cells&&s.push(c.cells[t[n].cellIndexes[i]].foreignKeyData),r.push(u.getCellFromIndex(t[n].rowIndex,t[n].cellIndexes[i])))}if(this.cellDeselect(ec,t,o,r,s),!0===this.isPreventCellSelect)return;for(n=0,f=e.length;n<f;n++)e[n].classList.remove("e-cellselectionbackground"),e[n].removeAttribute("aria-selected");this.bdrElement&&this.showHideBorders("none");this.selectedRowCellIndexes=[];this.isCellSelected=!1;!this.isDragged&&this.cellselected&&this.cellDeselect(oc,t,o,r,s)}},n.prototype.getSelectedCellsElement=function(){var u,n=this.parent,t=n.getDataRows();n.getFrozenColumns()&&(u=n.getMovableDataRows(),t=n.addMovableRows(t,u));for(var i=[],r=0,f=t.length;r<f;r++)i=i.concat([].slice.call(t[r].querySelectorAll(".e-cellselectionbackground")));return i},n.prototype.mouseMoveHandler=function(n){var h,c;n.preventDefault();var u,l=this.parent.element.getBoundingClientRect(),t=this.x,i=this.y,a=gi(n),f=a.x-l.left,e=a.y-l.top,s=Object(r.closest)(n.target,"tr");(this.isDragged=!0,this.isCellDrag||(s||(s=Object(r.closest)(document.elementFromPoint(this.parent.element.offsetLeft+2,n.clientY),"tr")),t>f&&(u=f,f=t,t=u),i>e&&(u=e,e=i,i=u),this.element.style.left=t+"px",this.element.style.top=i+"px",this.element.style.width=f-t+"px",this.element.style.height=e-i+"px"),!s||n.ctrlKey||n.shiftKey)||(h=parseInt(s.getAttribute("aria-rowindex"),10),this.isCellDrag?(c=o(n.target,"e-rowcell"),c&&(this.startAFCell=this.startCell,this.endAFCell=o(n.target,"e-rowcell"),this.selectLikeExcel(n,h,parseInt(c.getAttribute("aria-colindex"),10)))):(this.hideAutoFill(),this.selectRowsByRange(this.startDIndex,h)))},n.prototype.selectLikeExcel=function(n,t,i){this.isAutoFillSel?(this.showAFBorders(),this.selectLikeAutoFill(n)):(this.clearCellSelection(),this.selectCellsByRange({rowIndex:this.startDIndex,cellIndex:this.startDCellIndex},{rowIndex:t,cellIndex:i}),this.drawBorders())},n.prototype.drawBorders=function(){"BoxWithBorder"===this.selectionSettings.cellSelectionMode&&this.selectedRowCellIndexes.length&&!this.parent.isEdit?(this.parent.element.classList.add("e-enabledboxbdr"),this.bdrElement||this.createBorders(),this.positionBorders()):this.showHideBorders("none")},n.prototype.isLastCell=function(n){var t=[].slice.call(n.parentElement.querySelectorAll(".e-rowcell:not(.e-hide)"));return t[t.length-1]===n},n.prototype.isLastRow=function(n){var t=[].slice.call(Object(r.closest)(n,"tbody").querySelectorAll(".e-row:not(.e-hiddenrow)"));return n.parentElement===t[t.length-1]},n.prototype.isFirstRow=function(n){var t=[].slice.call(Object(r.closest)(n,"tbody").querySelectorAll(".e-row:not(.e-hiddenrow)"));return n.parentElement===t[0]},n.prototype.isFirstCell=function(n){return[].slice.call(n.parentElement.querySelectorAll(".e-rowcell:not(.e-hide)"))[0]===n},n.prototype.setBorders=function(n,t,i){var e=[].slice.call(n.querySelectorAll(".e-cellselectionbackground")).filter(function(n){return""===n.style.display});if(e.length){var o=e[0],c=e[e.length-1],r=o.getBoundingClientRect(),u=c.getBoundingClientRect(),f=o.offsetParent.getBoundingClientRect(),l=!this.isLastRow(c)||"1"!==i&&"2"!==i?0:2,h=this.parent.frozenRows&&("1"===i||"2"===i)&&this.isFirstRow(o)?1.5:0,s=this.parent.getFrozenColumns()&&("2"===i||"4"===i)&&this.isFirstCell(o)?1:0;this.parent.enableRtl?(t.style.right=f.right-r.right-s+"px",t.style.width=r.right-u.left+s+1+"px"):(t.style.left=r.left-f.left-s+"px",t.style.width=u.right-r.left+s+1+"px");t.style.top=r.top-f.top-h+"px";t.style.height=u.top-r.top>0?u.top-f.top+u.height+1-(r.top-f.top)-l+h+"px":u.height+h-l+1+"px";this.selectDirection+=i}else t.style.display="none"},n.prototype.positionBorders=function(){this.updateStartEndCells();this.startCell&&this.bdrElement&&this.selectedRowCellIndexes.length&&(this.selectDirection="",this.showHideBorders(""),this.setBorders(this.parent.getContentTable(),this.bdrElement,"1"),this.parent.getFrozenColumns()&&this.setBorders(this.parent.contentModule.getMovableContent(),this.mcBdrElement,"2"),this.parent.frozenRows&&(this.setBorders(this.parent.getHeaderTable(),this.fhBdrElement,"3"),this.parent.getFrozenColumns()&&this.setBorders(this.parent.headerModule.getMovableHeader(),this.mhBdrElement,"4")),this.applyBorders(this.selectDirection))},n.prototype.applyBorders=function(n){var t=this.parent.enableRtl;switch(n.length){case 4:this.bdrElement.style.borderWidth=t?"0 2px 2px 0":"0 0 2px 2px";this.mcBdrElement.style.borderWidth=t?"0 0 2px 2px":"0 2px 2px 0";this.fhBdrElement.style.borderWidth=t?"2px 2px 0 0":"2px 0 0 2px";this.mhBdrElement.style.borderWidth=t?"2px 0 0 2px":"2px 2px 0 0";break;case 2:this.bdrElement.style.borderWidth=n.includes("2")?t?"2px 2px 2px 0":"2px 0 2px 2px":"0 2px 2px 2px";this.parent.getFrozenColumns()&&(this.mcBdrElement.style.borderWidth=n.includes("1")?t?"2px 0 2px 2px":"2px 2px 2px 0":"0 2px 2px 2px");this.parent.frozenRows&&(this.fhBdrElement.style.borderWidth=n.includes("1")?"2px 2px 0 2px":t?"2px 2px 2px 0":"2px 0 2px 2px",this.parent.getFrozenColumns()&&(this.mhBdrElement.style.borderWidth=n.includes("2")?"2px 2px 0 2px":t?"2px 0 2px 2px":"2px 2px 2px 0"));break;default:this.bdrElement.style.borderWidth="2px";this.parent.getFrozenColumns()&&(this.mcBdrElement.style.borderWidth="2px");this.parent.frozenRows&&(this.fhBdrElement.style.borderWidth="2px",this.parent.getFrozenColumns()&&(this.mhBdrElement.style.borderWidth="2px"))}},n.prototype.createBorders=function(){this.bdrElement||(this.bdrElement=this.parent.getContentTable().parentElement.appendChild(Object(r.createElement)("div",{className:"e-xlsel",id:this.parent.element.id+"_bdr",styles:"width: 2px; border-width: 0;"})),this.parent.getFrozenColumns()&&(this.mcBdrElement=this.parent.contentModule.getMovableContent().appendChild(Object(r.createElement)("div",{className:"e-xlsel",id:this.parent.element.id+"_mcbdr",styles:"height: 2px; border-width: 0;"}))),this.parent.frozenRows&&(this.fhBdrElement=this.parent.getHeaderTable().parentElement.appendChild(Object(r.createElement)("div",{className:"e-xlsel",id:this.parent.element.id+"_fhbdr",styles:"height: 2px;"}))),this.parent.frozenRows&&this.parent.getFrozenColumns()&&(this.mhBdrElement=this.parent.headerModule.getMovableHeader().appendChild(Object(r.createElement)("div",{className:"e-xlsel",id:this.parent.element.id+"_mhbdr",styles:"height: 2px;"}))))},n.prototype.showHideBorders=function(n){this.bdrElement&&(this.bdrElement.style.display=n,this.parent.getFrozenColumns()&&(this.mcBdrElement.style.display=n),this.parent.frozenRows&&(this.fhBdrElement.style.display=n),this.parent.frozenRows&&this.parent.getFrozenColumns()&&(this.mhBdrElement.style.display=n))},n.prototype.drawAFBorders=function(){this.bdrAFBottom||this.createAFBorders();this.positionAFBorders()},n.prototype.positionAFBorders=function(){var c,v,y,p;if(this.startCell&&this.bdrAFLeft){var t=this.startAFCell.getBoundingClientRect(),n=this.endAFCell.getBoundingClientRect(),w=n.top-t.top>0?1:0,s=n.top-t.top>=0&&(o(this.startAFCell,"e-movablecontent")||o(this.startAFCell,"e-frozencontent"))&&this.isFirstRow(this.startAFCell)?1.5:0,f=(o(this.startAFCell,"e-movablecontent")||o(this.startAFCell,"e-movableheader"))&&this.isFirstCell(this.startAFCell)?1:0,l=this.isLastRow(this.endAFCell)&&(o(this.endAFCell,"e-movablecontent")||o(this.endAFCell,"e-frozencontent"))?2:0,a=this.startAFCell.offsetParent.getBoundingClientRect(),i=this.parent.element.getBoundingClientRect(),b=this.startAFCell.offsetParent.parentElement.scrollTop,k=this.startAFCell.offsetParent.parentElement.scrollLeft,r=b-this.startAFCell.offsetTop,u=k-this.startAFCell.offsetLeft,h=this.parent.element.clientHeight,e=this.parent.element.clientWidth;r=r>0?Math.floor(r)-1:0;u=u>0?u:0;c=t.left-i.left;this.parent.enableRtl?(v=o(this.startAFCell,"e-movablecontent")||o(this.startAFCell,"e-movableheader")?t.right-this.startAFCell.offsetParent.parentElement.getBoundingClientRect().width-i.left:0,this.bdrAFLeft.style.right=i.right-n.right-2+n.width+"px",this.bdrAFLeft.style.width=e<=parseInt(this.bdrAFLeft.style.right,10)?"0px":"2px",this.bdrAFRight.style.right=i.right-t.right-f+v-1+"px",this.bdrAFTop.style.left=n.left-i.left-.5+"px",this.bdrAFTop.style.width=parseInt(this.bdrAFLeft.style.right,10)-parseInt(this.bdrAFRight.style.right,10)-f+1+"px",parseInt(this.bdrAFTop.style.left,10)<0&&(this.bdrAFTop.style.width=parseInt(this.bdrAFTop.style.width,10)+parseInt(this.bdrAFTop.style.left,10)+"px",this.bdrAFTop.style.left="0px")):(this.bdrAFLeft.style.left=c-f+u-1+"px",this.bdrAFRight.style.left=n.left-i.left-2+n.width+"px",this.bdrAFRight.style.width=e<=parseInt(this.bdrAFRight.style.left,10)?"0px":"2px",this.bdrAFTop.style.left=c+u-.5+"px",this.bdrAFTop.style.width=parseInt(this.bdrAFRight.style.left,10)-parseInt(this.bdrAFLeft.style.left,10)-f+1+"px",e<=parseInt(this.bdrAFTop.style.width,10)+parseInt(this.bdrAFTop.style.left,10))&&(y=parseInt(this.bdrAFTop.style.width,10)+parseInt(this.bdrAFTop.style.left,10)-e,this.bdrAFTop.style.width=parseInt(this.bdrAFTop.style.width,10)-y+"px");(this.bdrAFLeft.style.top=t.top-i.top-s+r+"px",this.bdrAFLeft.style.height=n.top-t.top>0?n.top-a.top+n.height+1-(t.top-a.top)+s-l-r+"px":n.height+s-l-r+"px",this.bdrAFRight.style.top=this.bdrAFLeft.style.top,this.bdrAFRight.style.height=parseInt(this.bdrAFLeft.style.height,10)+"px",this.bdrAFTop.style.top=this.bdrAFRight.style.top,this.bdrAFBottom.style.left=this.bdrAFTop.style.left,this.bdrAFBottom.style.top=parseFloat(this.bdrAFLeft.style.top)+parseFloat(this.bdrAFLeft.style.height)-w-1+"px",this.bdrAFBottom.style.width=h<=parseFloat(this.bdrAFBottom.style.top)?"0px":this.bdrAFTop.style.width,h<=parseInt(this.bdrAFLeft.style.height,10)+parseInt(this.bdrAFLeft.style.top,10))&&(p=parseInt(this.bdrAFLeft.style.height,10)+parseInt(this.bdrAFLeft.style.top,10)-h,this.bdrAFLeft.style.height=parseInt(this.bdrAFLeft.style.height,10)-p+"px",this.bdrAFRight.style.height=parseInt(this.bdrAFLeft.style.height,10)+"px")}},n.prototype.createAFBorders=function(){this.bdrAFLeft||(this.bdrAFLeft=this.parent.element.appendChild(Object(r.createElement)("div",{className:"e-xlselaf",id:this.parent.element.id+"_bdrafleft",styles:"width: 2px;"})),this.bdrAFRight=this.parent.element.appendChild(Object(r.createElement)("div",{className:"e-xlselaf",id:this.parent.element.id+"_bdrafright",styles:"width: 2px;"})),this.bdrAFBottom=this.parent.element.appendChild(Object(r.createElement)("div",{className:"e-xlselaf",id:this.parent.element.id+"_bdrafbottom",styles:"height: 2px;"})),this.bdrAFTop=this.parent.element.appendChild(Object(r.createElement)("div",{className:"e-xlselaf",id:this.parent.element.id+"_bdraftop",styles:"height: 2px;"})))},n.prototype.showAFBorders=function(){this.bdrAFLeft&&(this.bdrAFLeft.style.display="",this.bdrAFRight.style.display="",this.bdrAFBottom.style.display="",this.bdrAFTop.style.display="")},n.prototype.hideAFBorders=function(){this.bdrAFLeft&&(this.bdrAFLeft.style.display="none",this.bdrAFRight.style.display="none",this.bdrAFBottom.style.display="none",this.bdrAFTop.style.display="none")},n.prototype.updateValue=function(n,t,i){var u=this.createBeforeAutoFill(n,t,i),r;u.cancel||(r=this.parent.getColumnByIndex(t),this.parent.editModule&&i&&("number"===r.type?this.parent.editModule.updateCell(n,r.field,parseInt(u.value,10)):this.parent.editModule.updateCell(n,r.field,u.value)))},n.prototype.createBeforeAutoFill=function(n,t,i){var r={column:this.parent.getColumnByIndex(t),value:i.innerText};return this.parent.trigger(tp,r),r},n.prototype.getAutoFillCells=function(n){var t=[].slice.call(this.parent.getDataRows()[n].querySelectorAll(".e-cellselectionbackground"));return this.parent.getFrozenColumns()&&(t=t.concat([].slice.call(this.parent.getMovableDataRows()[n].querySelectorAll(".e-cellselectionbackground")))),t},n.prototype.selectLikeAutoFill=function(n,t){var u=parseInt(o(this.startAFCell,"e-row").getAttribute("aria-rowindex"),10),i=parseInt(this.startAFCell.getAttribute("aria-colindex"),10),e=parseInt(o(this.endAFCell,"e-row").getAttribute("aria-rowindex"),10),s=parseInt(this.endAFCell.getAttribute("aria-colindex"),10),a=this.selectedRowCellIndexes.length-1,h=this.selectedRowCellIndexes[0].cellIndexes.length-1,w,r,l,y,p;switch(!0){case!t&&this.endAFCell.classList.contains("e-cellselectionbackground")&&!!o(n.target,"e-rowcell"):this.startAFCell=this.parent.getCellFromIndex(u,i);this.endAFCell=this.parent.getCellFromIndex(u+a,i+h);this.drawAFBorders();break;case this.autoFillRLselection&&i+h<s&&s-i-h+1>e-u-a&&s-i-h+1>u-e:if(this.endAFCell=this.parent.getCellFromIndex(u+a,s),e=parseInt(o(this.endAFCell,"e-row").getAttribute("aria-rowindex"),10),s=parseInt(this.endAFCell.getAttribute("aria-colindex"),10),t){for(w=parseInt(this.endCell.getAttribute("aria-colindex"),10),r=u;r<=e;r++)for(var v=this.getAutoFillCells(r,i),f=0,c=w+1;c<=s;c++)f>h&&(f=0),this.updateValue(r,c,v[f]),f++;this.selectCellsByRange({rowIndex:u,cellIndex:this.startCellIndex},{rowIndex:e,cellIndex:s})}else this.drawAFBorders();break;case this.autoFillRLselection&&i>s&&i-s+1>e-u-a&&i-s+1>u-e:if(this.startAFCell=this.parent.getCellFromIndex(u,s),this.endAFCell=this.endCell,t){for(r=u;r<=u+a;r++)for((v=this.getAutoFillCells(r,i)).reverse(),f=0,c=this.startCellIndex-1;c>=s;c--)f>h&&(f=0),this.updateValue(r,c,v[f]),f++;this.selectCellsByRange({rowIndex:u,cellIndex:s},{rowIndex:u+a,cellIndex:this.startCellIndex+h})}else this.drawAFBorders();break;case u>e:if(this.startAFCell=this.parent.getCellFromIndex(e,i),this.endAFCell=this.endCell,t){for(l=y=parseInt(this.endCell.parentElement.getAttribute("aria-rowindex"),10),r=u-1;r>=e;r--)for(l===this.startIndex-1&&(l=y),v=this.getAutoFillCells(l,i),f=0,l--,c=this.startCellIndex;c<=this.startCellIndex+h;c++)this.updateValue(r,c,v[f]),f++;this.selectCellsByRange({rowIndex:e,cellIndex:i+h},{rowIndex:u+a,cellIndex:i})}else this.drawAFBorders();break;default:if(this.endAFCell=this.parent.getCellFromIndex(e,i+h),t){for(y=parseInt(this.endCell.parentElement.getAttribute("aria-rowindex"),10),l=this.startIndex,r=y+1;r<=e;r++)for(l===y+1&&(l=this.startIndex),v=this.getAutoFillCells(l,i),l++,f=0,p=this.startCellIndex;p<=this.startCellIndex+h;p++)this.updateValue(r,p,v[f]),f++;this.selectCellsByRange({rowIndex:y-a,cellIndex:i},{rowIndex:e,cellIndex:i+h})}else this.drawAFBorders()}},n.prototype.mouseUpHandler=function(n){var i;if(document.body.classList.remove("e-disableuserselect"),this.element&&Object(r.remove)(this.element),this.mUPTarget=this.isDragged&&1===this.selectedRowCellIndexes.length&&1===this.selectedRowCellIndexes[0].cellIndexes.length?o(n.target,"e-rowcell"):null,this.isDragged&&!this.isAutoFillSel&&"Cell"===this.selectionSettings.mode){var t=n.target,u=parseInt(t.parentElement.getAttribute("aria-rowindex"),10),f=parseInt(t.getAttribute("aria-colindex"),10);this.isDragged=!1;this.clearCellSelection();this.selectCellsByRange({rowIndex:this.startDIndex,cellIndex:this.startDCellIndex},{rowIndex:u,cellIndex:f})}(this.isDragged=!1,this.updateAutoFillPosition(),this.isAutoFillSel)&&(i=o(n.target,"e-rowcell"),this.endAFCell=i||(this.endCell===this.endAFCell?this.startAFCell:this.endAFCell),this.startAFCell=this.startCell,this.updateStartCellsIndex(),this.selectLikeAutoFill(n,!0),this.updateAutoFillPosition(),this.hideAFBorders(),this.positionBorders(),this.isAutoFillSel=!1);r.EventHandler.remove(this.parent.getContent(),"mousemove",this.mouseMoveHandler);this.parent.frozenRows&&r.EventHandler.remove(this.parent.getHeaderContent(),"mousemove",this.mouseMoveHandler);r.EventHandler.remove(document.body,"mouseup",this.mouseUpHandler)},n.prototype.hideAutoFill=function(){this.autofill&&(this.autofill.style.display="none")},n.prototype.updateAutoFillPosition=function(){var n;if(this.parent.enableAutoFill&&!this.parent.isEdit&&this.selectionSettings.cellSelectionMode.indexOf("Box")>-1&&!this.isRowType()&&!this.isSingleSel()&&this.selectedRowCellIndexes.length){var f=this.parent.getFrozenColumns(),e=parseInt(this.target.getAttribute("aria-colindex"),10),l=parseInt(this.target.getAttribute("index"),10),a=this.selectedRowCellIndexes[this.selectedRowCellIndexes.length-1].rowIndex,s=this.getAutoFillCells(a,e).filter(function(n){return""===n.style.display}),i=void 0,h=void 0;if(f&&e>=f&&(i=!0),l<this.parent.frozenRows&&(h=!0),Object(r.select)("#"+this.parent.element.id+"_autofill",o(this.target,"e-table"))||(Object(r.select)("#"+this.parent.element.id+"_autofill",this.parent.element)&&Object(r.select)("#"+this.parent.element.id+"_autofill",this.parent.element).remove(),this.autofill=Object(r.createElement)("div",{className:"e-autofill",id:this.parent.element.id+"_autofill"}),this.autofill.style.display="none",h?i?this.parent.headerModule.getMovableHeader().appendChild(this.autofill):this.parent.getHeaderTable().parentElement.appendChild(this.autofill):i?this.parent.contentModule.getMovableContent().appendChild(this.autofill):this.parent.getContentTable().parentElement.appendChild(this.autofill)),n=s[s.length-1],n&&n.offsetParent){var t=n.getBoundingClientRect(),u=n.offsetParent.getBoundingClientRect(),c=this.isLastCell(n)?4:0,v=this.isLastRow(n)?3:0;this.parent.enableRtl?this.autofill.style.right=u.right-t.right+t.width-4-c+"px":this.autofill.style.left=t.left-u.left+t.width-4-c+"px";this.autofill.style.top=t.top-u.top+t.height-5-v+"px"}this.autofill.style.display=""}else this.hideAutoFill()},n.prototype.mouseDownHandler=function(n){this.mouseButton=n.button;var u,t=n.target,i=this.parent,f=o(t,"e-grid");if(!(f&&f.id!==i.element.id||o(t,"e-headercontent")&&!this.parent.frozenRows||o(t,"e-editedbatchcell")||o(t,"e-editedrow"))){if((n.shiftKey||n.ctrlKey)&&n.preventDefault(),o(t,"e-rowcell")&&!n.shiftKey&&!n.ctrlKey){if(i.selectionSettings.cellSelectionMode.indexOf("Box")>-1&&!this.isRowType()&&!this.isSingleSel())this.isCellDrag=!0,u=!0;else if(i.allowRowDragAndDrop&&!i.isEdit){if(!this.isRowType()||this.isSingleSel()||Object(r.closest)(t,"td").classList.contains("e-selectionbackground"))return void(this.isDragged=!1);u=!0;this.element=this.parent.createElement("div",{className:"e-griddragarea"});i.getContent().appendChild(this.element)}u&&this.enableDrag(n,!0)}this.updateStartEndCells();(t.classList.contains("e-autofill")||t.classList.contains("e-xlsel"))&&(this.isCellDrag=!0,this.isAutoFillSel=!0,this.enableDrag(n))}},n.prototype.updateStartEndCells=function(){var n=[].slice.call(this.parent.element.querySelectorAll(".e-cellselectionbackground"));this.startCell=n[0];this.endCell=n[n.length-1];this.startCell&&(this.startIndex=parseInt(this.startCell.parentElement.getAttribute("aria-rowindex"),10),this.startCellIndex=parseInt(o(this.startCell,"e-rowcell").getAttribute("aria-colindex"),10))},n.prototype.updateStartCellsIndex=function(){this.startCell&&(this.startIndex=parseInt(this.startCell.parentElement.getAttribute("aria-rowindex"),10),this.startCellIndex=parseInt(o(this.startCell,"e-rowcell").getAttribute("aria-colindex"),10))},n.prototype.enableDrag=function(n,t){var i=this.parent,e,u,f;t&&(e=Object(r.closest)(n.target,"tr"),this.startDIndex=parseInt(e.getAttribute("aria-rowindex"),10),this.startDCellIndex=parseInt(o(n.target,"e-rowcell").getAttribute("aria-colindex"),10));document.body.classList.add("e-disableuserselect");u=i.element.getBoundingClientRect();f=gi(n);this.x=f.x-u.left;this.y=f.y-u.top;r.EventHandler.add(i.getContent(),"mousemove",this.mouseMoveHandler,this);this.parent.frozenRows&&r.EventHandler.add(i.getHeaderContent(),"mousemove",this.mouseMoveHandler,this);r.EventHandler.add(document.body,"mouseup",this.mouseUpHandler,this)},n.prototype.clearSelAfterRefresh=function(n){var t=this.parent.enableInfiniteScrolling&&"infiniteScroll"===n.requestType;"virtualscroll"===n.requestType||this.parent.isPersistSelection||t||this.clearSelection()},n.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(v,this.enableAfterRender,this),this.parent.on(tt,this.initializeSelection,this),this.parent.on(ul,this.onActionComplete,this),this.parent.on(fl,this.onActionComplete,this),this.parent.on(d,this.onPropertyChanged,this),this.parent.on(cr,this.onCellFocused,this),this.parent.on(ts,this.clearSelAfterRefresh,this),this.parent.on(lr,this.columnPositionChanged,this),this.parent.on(y,this.initialEnd,this),this.actionBeginFunction=this.actionBegin.bind(this),this.actionCompleteFunction=this.actionComplete.bind(this),this.parent.addEventListener(l,this.actionBeginFunction),this.parent.addEventListener(c,this.actionCompleteFunction),this.parent.on(bu,this.rowsRemoved,this),this.parent.on(g,this.refreshHeader,this),this.addEventListener_checkbox())},n.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(v,this.enableAfterRender),this.parent.off(tt,this.initializeSelection),this.parent.off(ul,this.onActionComplete),this.parent.off(fl,this.onActionComplete),this.parent.off(d,this.onPropertyChanged),this.parent.off(cr,this.onCellFocused),this.parent.off(ts,this.clearSelAfterRefresh),this.parent.off(lr,this.columnPositionChanged),this.parent.removeEventListener(l,this.actionBeginFunction),this.parent.removeEventListener(c,this.actionCompleteFunction),this.parent.off(bu,this.rowsRemoved),this.parent.off(g,this.refreshHeader),this.removeEventListener_checkbox())},n.prototype.wireEvents=function(){this.isMacOS=-1!==navigator.userAgent.indexOf("Mac OS");this.isMacOS&&(r.EventHandler.add(this.parent.element,"keydown",this.keyDownHandler,this),r.EventHandler.add(this.parent.element,"keyup",this.keyUpHandler,this))},n.prototype.unWireEvents=function(){this.isMacOS&&(r.EventHandler.remove(this.parent.element,"keydown",this.keyDownHandler),r.EventHandler.remove(this.parent.element,"keyup",this.keyUpHandler))},n.prototype.columnPositionChanged=function(){this.parent.isPersistSelection||this.clearSelection()},n.prototype.refreshHeader=function(){this.setCheckAllState()},n.prototype.rowsRemoved=function(n){for(var t=0;t<n.records.length;t++)delete this.selectedRowState[n.records[t][this.primaryKey]],--this.totalRecordsCount;this.setCheckAllState()},n.prototype.beforeFragAppend=function(n){"virtualscroll"===n.requestType||this.parent.isPersistSelection||this.clearSelection()},n.prototype.getCheckAllBox=function(){return this.parent.getHeaderContent().querySelector(".e-checkselectall")},n.prototype.enableAfterRender=function(n){n.module===this.getModuleName()&&n.enable&&(this.render(),this.initPerisistSelection())},n.prototype.render=function(){r.EventHandler.add(this.parent.getContent(),"mousedown",this.mouseDownHandler,this);r.EventHandler.add(this.parent.getHeaderContent(),"mousedown",this.mouseDownHandler,this)},n.prototype.onPropertyChanged=function(n){if(n.module===this.getModuleName()){var t=this.parent;Object(r.isNullOrUndefined)(n.properties.type)||"Single"!==this.selectionSettings.type||(this.selectedRowCellIndexes.length>1&&(this.clearCellSelection(),this.prevCIdxs=void 0),this.selectedRowIndexes.length>1&&(this.clearRowSelection(),this.prevRowIndex=void 0),this.selectedColumnsIndexes.length>1&&(this.clearColumnSelection(),this.prevColIndex=void 0),this.enableSelectMultiTouch=!1,this.hidePopUp());Object(r.isNullOrUndefined)(n.properties.mode)&&Object(r.isNullOrUndefined)(n.properties.cellSelectionMode)||(this.clearSelection(),this.prevRowIndex=void 0,this.prevCIdxs=void 0,this.prevColIndex=void 0);this.isPersisted=!0;this.checkBoxSelectionChanged();this.isPersisted=!1;this.initPerisistSelection();this.parent.getColumns().filter(function(n){return"checkbox"===n.type}).length&&(t.isCheckBoxSelection=!("ResetOnRowClick"===this.selectionSettings.checkboxMode));this.drawBorders()}},n.prototype.hidePopUp=function(){this.parent.element.querySelector(".e-gridpopup").querySelectorAll(".e-rowselect").length&&(this.parent.element.querySelector(".e-gridpopup").style.display="none")},n.prototype.initialEnd=function(){this.parent.off(y,this.initialEnd);this.selectRow(this.parent.selectedRowIndex)},n.prototype.checkBoxSelectionChanged=function(){this.parent.off(y,this.checkBoxSelectionChanged);var n=this.parent,t=n.getColumns().filter(function(n){return"checkbox"===n.type});t.length>0&&(n.isCheckBoxSelection=!0,this.chkField=t[0].field,this.totalRecordsCount=this.parent.pageSettings.totalRecordsCount,Object(r.isNullOrUndefined)(this.totalRecordsCount)&&(this.totalRecordsCount=this.getCurrentBatchRecordChanges().length),this.isSingleSel()?(n.selectionSettings.type="Multiple",n.dataBind()):this.initPerisistSelection());n.isCheckBoxSelection||this.isPersisted||(this.chkField=null,this.initPerisistSelection())},n.prototype.initPerisistSelection=function(){var n=this.parent;this.parent.selectionSettings.persistSelection&&this.parent.getPrimaryKeyFieldNames().length>0?(n.isPersistSelection=!0,this.ensureCheckboxFieldSelection()):this.parent.getPrimaryKeyFieldNames().length>0?(n.isPersistSelection=!1,this.ensureCheckboxFieldSelection()):(n.isPersistSelection=!1,this.selectedRowState={})},n.prototype.ensureCheckboxFieldSelection=function(){var i=this.parent,r,n,u,t;(this.primaryKey=this.parent.getPrimaryKeyFieldNames()[0],!i.enableVirtualization&&this.chkField&&(i.isPersistSelection&&0===Object.keys(this.selectedRowState).length||!i.isPersistSelection))&&(r=this.parent.getDataModule(),n=(new e.Query).where(this.chkField,"equal",!0),n.params||(n.params=this.parent.query.params),u=r.getData({},n),t=this,this.parent.showSpinner(),u.then(function(n){t.dataSuccess(n.result);t.refreshPersistSelection();t.parent.hideSpinner()}))},n.prototype.dataSuccess=function(n){for(var t=0;t<n.length;t++)Object(r.isNullOrUndefined)(this.selectedRowState[n[t][this.primaryKey]])&&n[t][this.chkField]&&(this.selectedRowState[n[t][this.primaryKey]]=n[t][this.chkField]);this.persistSelectedData=n},n.prototype.setRowSelection=function(n){var t,f,i,u,e;if(!this.parent.getDataModule().isRemote()&&!Object(r.isBlazor)())if(n)if(this.parent.groupSettings.columns.length)for(t=0,f=this.getData().records;t<f.length;t++)i=f[t],this.selectedRowState[i[this.primaryKey]]=!0;else for(u=0,e=this.getData();u<e.length;u++)i=e[u],this.selectedRowState[i[this.primaryKey]]=!0;else this.selectedRowState={}},n.prototype.getData=function(){return this.parent.getDataModule().dataManager.executeLocal(this.parent.getDataModule().generateQuery(!0))},n.prototype.refreshPersistSelection=function(){var n=this.parent.getRows(),i,t,u,f,e,o;if(this.totalRecordsCount=this.parent.pageSettings.totalRecordsCount,null!==n&&n.length>0&&(this.parent.isPersistSelection||this.chkField)){for(i=[],t=0;t<n.length;t++){if(u=this.getRowObj(n[t]),f=u&&u.data?u.data[this.primaryKey]:null,null===f)return;e=void 0;o=n[t].querySelector(".e-checkselect");this.selectedRowState[f]||"Check"===this.parent.checkAllRows&&this.totalRecordsCount===Object.keys(this.selectedRowState).length&&this.chkAllCollec.indexOf(f)<0||"Uncheck"===this.parent.checkAllRows&&this.chkAllCollec.indexOf(f)>0||"Intermediate"===this.parent.checkAllRows&&!Object(r.isNullOrUndefined)(this.chkField)&&u.data[this.chkField]?(i.push(parseInt(n[t].getAttribute("aria-rowindex"),10)),e=!0):(e=!1,this.checkedTarget!==o&&this.parent.isCheckBoxSelection&&lf(o.nextElementSibling,e));this.updatePersistCollection(n[t],e)}this.isSingleSel()&&i.length>0?this.selectRow(i[0],!0):this.selectRows(i)}this.parent.isCheckBoxSelection&&this.getCurrentBatchRecordChanges().length>0&&this.setCheckAllState()},n.prototype.actionBegin=function(n){var t,i,u;if("save"===n.requestType&&this.parent.isPersistSelection&&(t=this.parent.element.querySelector(".e-edit-checkselect"),!Object(r.isNullOrUndefined)(t)))if(i=Object(r.closest)(t,".e-editedrow"),i){if("Dialog"===this.parent.editSettings.mode&&(i=this.parent.element.querySelector(".e-dlgeditrow")),u=this.getRowObj(i),!u)return;this.selectedRowState[u.data[this.primaryKey]]=u.isSelected=t.checked}else this.isCheckedOnAdd=t.checked},n.prototype.actionComplete=function(n){var u,i,t;if("save"===n.requestType&&this.parent.isPersistSelection&&("add"===n.action&&this.isCheckedOnAdd&&(u=this.parent.getRowObjectFromUID(this.parent.getRows()[n.selectedRow].getAttribute("data-uid")),this.selectedRowState[u.data[this.primaryKey]]=u.isSelected=this.isCheckedOnAdd),this.refreshPersistSelection()),"delete"===n.requestType&&this.parent.isPersistSelection){for(i=(Object(r.isBlazor)()?this.getSelectedRecords():n.data).slice(),t=0;t<i.length;t++)Object(r.isNullOrUndefined)(i[t][this.primaryKey])||this.updatePersistDelete(i[t][this.primaryKey]);this.setCheckAllState();this.totalRecordsCount=this.parent.pageSettings.totalRecordsCount}"paging"===n.requestType&&(this.prevRowIndex=void 0,this.prevCIdxs=void 0,this.prevECIdxs=void 0)},n.prototype.onDataBound=function(){if(!this.parent.enableVirtualization&&this.parent.isPersistSelection&&this.refreshPersistSelection(),this.parent.enableVirtualization&&this.setCheckAllState(),this.parent.isCheckBoxSelection&&!this.initialRowSelection){for(var i=this.parent.getRowsObject(),t=[],n=0;n<i.length;n++)i[n].isSelected&&t.push(n);t.length&&this.selectRows(t);this.initialRowSelection=!0}},n.prototype.updatePersistSelectedData=function(n){if(this.parent.isPersistSelection){for(var i=this.parent.getRows(),t=0;t<i.length;t++)this.updatePersistCollection(i[t],n);"Uncheck"===this.parent.checkAllRows?(this.setRowSelection(!1),this.persistSelectedData=this.parent.getDataModule().isRemote()?this.persistSelectedData:[]):"Check"===this.parent.checkAllRows&&(this.setRowSelection(!0),this.persistSelectedData=this.parent.getDataModule().isRemote()||Object(r.isBlazor)()?this.persistSelectedData:this.parent.groupSettings.columns.length?this.getData().records.slice():this.getData().slice())}},n.prototype.checkSelectAllAction=function(n){var i=this.getRenderer(),u=this.parent.element.querySelector(".e-gridform"),t;(this.checkedTarget=this.getCheckAllBox(),n&&this.getCurrentBatchRecordChanges().length?(this.parent.checkAllRows="Check",this.updatePersistSelectedData(n),Object(r.isBlazor)()&&this.parent.enableVirtualization&&!Object(r.isNullOrUndefined)(this.parent.contentModule.currentInfo.endIndex)?this.selectRowsByRange(this.parent.contentModule.currentInfo.startIndex,this.parent.contentModule.currentInfo.endIndex):this.selectRowsByRange(i.getVirtualRowIndex(0),i.getVirtualRowIndex(this.getCurrentBatchRecordChanges().length-1))):(this.parent.checkAllRows="Uncheck",this.updatePersistSelectedData(n),this.clearSelection()),this.chkAllCollec=[],Object(r.isNullOrUndefined)(u))||(t=u.querySelector(".e-edit-checkselect"),Object(r.isNullOrUndefined)(t)||lf(t.nextElementSibling,n))},n.prototype.checkSelectAll=function(n){var f=this,e=this.getCheckAllStatus(n),t="Check"===e,i,u;if((this.isHeaderCheckboxClicked=!0,"Intermediate"===e&&(t=this.getCurrentBatchRecordChanges().some(function(n){return n[f.primaryKey]in f.selectedRowState})),this.parent.isPersistSelection&&this.parent.allowPaging&&(this.totalRecordsCount=this.parent.pageSettings.totalRecordsCount),this.checkSelectAllAction(!t),Object(r.isBlazor)()&&this.parent.isServerRendered&&this.parent.enableVirtualization)&&(this.parent.interopAdaptor.invokeMethodAsync("MaintainSelection",!t,"checkbox",null),this.checkBoxState=!t,!t))for(i=this.parent.contentModule.vgenerator.rowCache,Object.values(i).forEach(function(n){return n.isSelected=!0}),u=0;u<Object.keys(i).length;u++)-1===this.parent.selectionModule.selectedRowIndexes.indexOf(Number(Object.keys(i)[u]))&&this.parent.selectionModule.selectedRowIndexes.push(Number(Object.keys(i)[u]));this.target=null;this.getCurrentBatchRecordChanges().length>0&&this.setCheckAllState();this.triggerChkChangeEvent(n,!t)},n.prototype.getCheckAllStatus=function(n){var t=n?n.nextElementSibling.classList:this.getCheckAllBox().nextElementSibling.classList;return t.contains("e-check")?"Check":t.contains("e-uncheck")?"Uncheck":t.contains("e-stop")?"Intermediate":"None"},n.prototype.checkSelect=function(n){var i=Object(r.closest)(this.checkedTarget,".e-rowcell"),u=this.parent,t,f;this.isMultiCtrlRequest=!0;t=0;(this.isHeaderCheckboxClicked=!1,nt(u))?(f=i.parentElement.getAttribute("data-uid"),t=u.getRows().map(function(n){return n.getAttribute("data-uid")}).indexOf(f)):t=parseInt(i.parentElement.getAttribute("aria-rowindex"),10);this.parent.isPersistSelection&&this.parent.element.querySelectorAll(".e-addedrow").length>0&&"Top"===this.parent.editSettings.newRowPosition&&++t;this.rowCellSelectionHandler(t,parseInt(i.getAttribute("aria-colindex"),10));this.moveIntoUncheckCollection(Object(r.closest)(i,".e-row"));this.setCheckAllState();this.isMultiCtrlRequest=!1;this.triggerChkChangeEvent(n,n.nextElementSibling.classList.contains("e-check"))},n.prototype.moveIntoUncheckCollection=function(n){if("Check"===this.parent.checkAllRows||"Uncheck"===this.parent.checkAllRows){var i=this.getRowObj(n),t=i&&i.data?i.data[this.primaryKey]:null;if(!t)return;this.chkAllCollec.indexOf(t)<0?this.chkAllCollec.push(t):this.chkAllCollec.splice(this.chkAllCollec.indexOf(t),1)}},n.prototype.triggerChkChangeEvent=function(n,t){this.parent.trigger(dy,{checked:t,selectedRowIndexes:this.parent.getSelectedRowIndexes(),target:n});this.parent.isEdit||(this.checkedTarget=null)},n.prototype.updateSelectedRowIndex=function(n){var i,t,u;if(this.parent.isCheckBoxSelection&&(this.parent.enableVirtualization||this.parent.enableInfiniteScrolling)&&!this.parent.getDataModule().isRemote()&&(!Object(r.isBlazor)()||!this.parent.isServerRendered))if("Check"===this.parent.checkAllRows)for(this.selectedRowIndexes=[],i=this.getData().length,t=0;t<i;t++)this.selectedRowIndexes.push(t);else"Uncheck"===this.parent.checkAllRows?this.selectedRowIndexes=[]:n&&"false"===this.parent.getRowByIndex(n).getAttribute("aria-selected")&&(u=this.selectedRowIndexes.indexOf(n),this.selectedRowIndexes.splice(u,1))},n.prototype.setCheckAllState=function(n,t){var o,e,f,i,u;(this.parent.isCheckBoxSelection||"ResetOnRowClick"===this.parent.selectionSettings.checkboxMode)&&(o=void 0,e=Object(r.isBlazor)()&&this.parent.isServerRendered&&this.parent.enableVirtualization,e&&(o=!Object.values(this.parent.contentModule.vgenerator.rowCache).filter(function(n){return void 0===n.isSelected||!1===n.isSelected}).length&&Object.values(this.parent.contentModule.vgenerator.rowCache).filter(function(n){return n.isSelected}).length===this.selectedRowIndexes.length),f=Object.keys(this.selectedRowState).length,this.parent.isPersistSelection||e||(f=this.selectedRowIndexes.length,this.totalRecordsCount=this.getCurrentBatchRecordChanges().length),i=this.getCheckAllBox(),i&&(u=i.nextElementSibling,Object(r.removeClass)([u],["e-check","e-stop","e-uncheck"]),wr(i,!1),i.indeterminate=!1,o||f===this.totalRecordsCount&&this.totalRecordsCount||!(!this.parent.enableVirtualization&&!this.parent.enableInfiniteScrolling||this.parent.allowPaging||this.parent.getDataModule().isRemote()||Object(r.isBlazor)()&&this.parent.isServerRendered||f!==this.getData().length)?(Object(r.addClass)([u],["e-check"]),wr(i,!0),t&&this.getRenderer().setSelection(null,!0,!0),this.parent.checkAllRows="Check"):e&&!this.selectedRowIndexes.length||0===f&&!e||0===this.getCurrentBatchRecordChanges().length?(Object(r.addClass)([u],["e-uncheck"]),t&&this.getRenderer().setSelection(null,!1,!0),this.parent.checkAllRows="Uncheck",0===f&&0===this.getCurrentBatchRecordChanges().length?Object(r.addClass)([u.parentElement],["e-checkbox-disabled"]):Object(r.removeClass)([u.parentElement],["e-checkbox-disabled"])):(Object(r.addClass)([u],["e-stop"]),this.parent.checkAllRows="Intermediate",i.indeterminate=!0),!this.parent.enableVirtualization&&!this.parent.enableInfiniteScrolling||this.parent.allowPaging||this.parent.getDataModule().isRemote()||this.updateSelectedRowIndex(n)))},n.prototype.keyDownHandler=function(n){(("chrome"===r.Browser.info.name||"safari"===r.Browser.info.name)&&(91===n.keyCode||93===n.keyCode)||"opera"===r.Browser.info.name&&17===n.keyCode||"mozilla"===r.Browser.info.name&&224===n.keyCode)&&(this.cmdKeyPressed=!0)},n.prototype.keyUpHandler=function(n){(("chrome"===r.Browser.info.name||"safari"===r.Browser.info.name)&&(91===n.keyCode||93===n.keyCode)||"opera"===r.Browser.info.name&&17===n.keyCode||"mozilla"===r.Browser.info.name&&224===n.keyCode)&&(this.cmdKeyPressed=!1)},n.prototype.clickHandler=function(n){var t=n.target,i,s,u,h,f,e;this.actualTarget=t;(o(t,"e-row")||o(t,"e-headerchkcelldiv"))&&(this.isInteracted=!0);this.isMultiCtrlRequest=n.ctrlKey||this.enableSelectMultiTouch||this.isMacOS&&this.cmdKeyPressed;this.isMultiShiftRequest=n.shiftKey;this.popUpClickHandler(n);s=!1;this.preventFocus=!0;u=o(t,"e-checkbox-wrapper");(this.checkSelectAllClicked=!(!u||!u.querySelectorAll(".e-checkselectall")),u&&u.querySelectorAll(".e-checkselect,.e-checkselectall").length>0&&(i=u.querySelector('input[type="checkbox"]'),s=!0),this.drawBorders(),this.updateAutoFillPosition(),(t=o(t,"e-rowcell"))&&t.parentElement.classList.contains("e-row")&&!this.parent.selectionSettings.checkboxOnly||s)?((this.parent.isCheckBoxSelection&&(this.isMultiCtrlRequest=!0),this.target=t,Object(r.isNullOrUndefined)(i))?(h=this.parent,f=0,nt(h)?(e=t.parentElement.getAttribute("data-uid"),f=h.getRows().map(function(n){return n.getAttribute("data-uid")}).indexOf(e)):f=parseInt(t.parentElement.getAttribute("aria-rowindex"),10),this.parent.isPersistSelection&&this.parent.element.querySelectorAll(".e-addedrow").length>0&&++f,this.mUPTarget&&this.mUPTarget.isEqualNode(t)||this.rowCellSelectionHandler(f,parseInt(t.getAttribute("aria-colindex"),10)),this.parent.hoverFrozenRows(n),this.parent.isCheckBoxSelection&&(this.moveIntoUncheckCollection(Object(r.closest)(t,".e-row")),this.setCheckAllState())):(this.checkedTarget=i,i.classList.contains("e-checkselectall")?this.checkSelectAll(i):this.checkSelect(i)),this.parent.isCheckBoxSelection||!r.Browser.isDevice||this.isSingleSel()||this.showPopup(n)):n.target.classList.contains("e-headercell")&&!n.target.classList.contains("e-stackedheadercell")&&(e=n.target.querySelector(".e-headercelldiv").getAttribute("e-mappinguid"),this.headerSelectionHandler(this.parent.getColumnIndexByUid(e)));this.isMultiCtrlRequest=!1;this.isMultiShiftRequest=!1;Object(r.isNullOrUndefined)(Object(r.closest)(n.target,".e-unboundcell"))&&(this.preventFocus=!1)},n.prototype.popUpClickHandler=function(n){var t=n.target;Object(r.closest)(t,".e-headercell")||n.target.classList.contains("e-rowcell")||Object(r.closest)(t,".e-gridpopup")?t.classList.contains("e-rowselect")&&(t.classList.contains("e-spanclicked")?(t.classList.remove("e-spanclicked"),this.enableSelectMultiTouch=!1,this.parent.element.querySelector(".e-gridpopup").style.display="none"):(t.classList.add("e-spanclicked"),this.enableSelectMultiTouch=!0)):this.parent.element.querySelector(".e-gridpopup").style.display="none"},n.prototype.showPopup=function(n){this.selectionSettings.enableSimpleMultiRowSelection||pa(this.parent.element.querySelector(".e-gridpopup"),n,"e-rowselect e-icons e-icon-rowselect"+(!this.isSingleSel()&&(this.selectedRecords.length>(this.parent.getFrozenColumns()?2:1)||this.selectedRowCellIndexes.length>1)?" e-spanclicked":""))},n.prototype.rowCellSelectionHandler=function(n,t){if(this.parent,(this.isMultiCtrlRequest||this.isMultiShiftRequest)&&!this.isSingleSel())if(this.isMultiShiftRequest)this.parent.isCheckBoxSelection||!this.parent.isCheckBoxSelection&&!Object(r.closest)(this.target,".e-rowcell").classList.contains("e-gridchkbox")?this.selectRowsByRange(Object(r.isUndefined)(this.prevRowIndex)?n:this.prevRowIndex,n):this.addRowsToSelection([n]),this.selectCellsByRange(Object(r.isUndefined)(this.prevCIdxs)?{rowIndex:n,cellIndex:t}:this.prevCIdxs,{rowIndex:n,cellIndex:t}),this.updateAutoFillPosition(),this.drawBorders();else{if(this.addRowsToSelection([n]),Object(r.isBlazor)()&&this.parent.enableVirtualization&&this.parent.isServerRendered){var i=this.parent.getSelectedRowIndexes();this.parent.interopAdaptor.invokeMethodAsync("MaintainSelection",!0,"normal",i)}this.addCellsToSelection([{rowIndex:n,cellIndex:t}]);this.showHideBorders("none")}else this.isDragged||this.selectRow(n,this.selectionSettings.enableToggle),this.selectCell({rowIndex:n,cellIndex:t},this.selectionSettings.enableToggle),this.selectedRowCellIndexes.length&&this.updateAutoFillPosition(),this.drawBorders();this.isDragged=!1},n.prototype.onCellFocused=function(n){var h,o,c,s,f,e,a;if(this.parent.frozenRows&&n.container.isHeader&&n.byKey&&("upArrow"===n.keyArgs.action?n.isJump=this.parent.allowFiltering?"INPUT"===n.element.tagName:"TH"===n.element.tagName:"downArrow"===n.keyArgs.action?(h=Number(n.element.parentElement.getAttribute("aria-rowindex")),n.isJump=0===h):"ctrlHome"===n.keyArgs.action&&(n.isJump=!0)),o=this.parent.getFrozenColumns()?(n.container.isHeader&&"TD"!==n.element.tagName&&n.isJump&&"Column"!==this.selectionSettings.mode||(n.container.isContent||"TD"===n.element.tagName)&&!(n.container.isSelectable||"TD"===n.element.tagName))&&!(n.byKey&&"space"===n.keyArgs.action):(n.container.isHeader&&n.isJump||n.container.isContent&&!n.container.isSelectable)&&!(n.byKey&&"space"===n.keyArgs.action)&&!(n.element.classList.contains("e-detailrowexpand")||n.element.classList.contains("e-detailrowcollapse")),c=n.container.isHeader&&"TD"!==n.element.tagName&&!Object(r.closest)(n.element,".e-rowcell")&&!(n.byKey&&"space"===n.keyArgs.action),n.byKey&&!o){var l=n.container.isContent?n.container.indexes:n.indexes,i=l[0],u=l[1],t=this.focus.getPrevIndexes();if(this.parent.frozenRows&&(n.container.isHeader&&("TD"===n.element.tagName||Object(r.closest)(n.element,".e-rowcell"))?(s=this.parent.getHeaderTable().querySelector("thead").childElementCount,i-=s,t.rowIndex=Object(r.isNullOrUndefined)(t.rowIndex)?null:t.rowIndex-s):(i+=this.parent.frozenRows,t.rowIndex=0!==t.rowIndex&&Object(r.isNullOrUndefined)(t.rowIndex)?null:t.rowIndex+this.parent.frozenRows)),this.parent.getFrozenColumns()&&(f=Number(n.element.getAttribute("aria-colindex")),e=this.parent.getSelectedRowCellIndexes(),e.length&&0===t.cellIndex&&(t.cellIndex=e[e.length-1].cellIndexes[0]),t.cellIndex=Object(r.isNullOrUndefined)(t.cellIndex)?null:t.cellIndex===u?f:f-1,u=f),!(c||-1===["ctrlPlusA","escape"].indexOf(n.keyArgs.action)&&"space"!==n.keyArgs.action&&i===t.rowIndex&&u===t.cellIndex)||"Column"===this.selectionSettings.mode){this.preventFocus=!0;a=this.getKeyColIndex(n);switch(this.needColumnSelection&&(u=a),n.keyArgs.action){case"downArrow":case"upArrow":case"enter":case"shiftEnter":this.target=n.element;this.applyDownUpKey(i,u);break;case"rightArrow":case"leftArrow":this.applyRightLeftKey(i,u);break;case"shiftDown":case"shiftUp":this.shiftDownKey(i,u);break;case"shiftLeft":case"shiftRight":this.applyShiftLeftRightKey(i,u);break;case"home":case"end":u="end"===n.keyArgs.action?this.getLastColIndex(i):0;this.applyHomeEndKey(i,u);break;case"ctrlHome":case"ctrlEnd":this.applyCtrlHomeEndKey(i,u);break;case"escape":this.clearSelection();break;case"ctrlPlusA":this.ctrlPlusA();break;case"space":this.applySpaceSelection(n.element);break;case"tab":this.parent.editSettings.allowNextRowEdit&&this.selectRow(i)}this.needColumnSelection=!1;this.preventFocus=!1;this.positionBorders();this.updateAutoFillPosition()}}else o&&!this.parent.isCheckBoxSelection&&this.clearSelection()},n.prototype.getKeyColIndex=function(n){var r,t=null,u=n.element.querySelector(".e-stackedheadercelldiv");if("Column"===this.selectionSettings.mode&&o(n.element,"e-columnheader"))if(this.needColumnSelection=!!n.container.isHeader,u){if("rightArrow"===n.keyArgs.action||"leftArrow"===n.keyArgs.action)return t;r=u.getAttribute("e-mappinguid");var i=this.getstackedColumns(this.parent.getColumnByUid(r).columns),f=this.parent.getColumnIndexByUid(i[i.length-1].uid),e=this.parent.getColumnIndexByUid(i[0].uid);t=this.prevColIndex>=f?e:f}else t=this.parent.getColumnIndexByUid(n.element.querySelector(".e-headercelldiv").getAttribute("e-mappinguid"));return t},n.prototype.ctrlPlusA=function(){this.isRowType()&&!this.isSingleSel()&&this.selectRowsByRange(0,this.getCurrentBatchRecordChanges().length-1);this.isCellType()&&!this.isSingleSel()&&this.selectCellsByRange({rowIndex:0,cellIndex:0},{rowIndex:this.parent.getRows().length-1,cellIndex:this.parent.getColumns().length-1})},n.prototype.applySpaceSelection=function(n){n.classList.contains("e-checkselectall")?(this.checkedTarget=n,this.checkSelectAll(this.checkedTarget)):n.classList.contains("e-checkselect")&&(this.checkedTarget=n,this.checkSelect(this.checkedTarget))},n.prototype.applyDownUpKey=function(n,t){var i=this.parent;this.parent.isCheckBoxSelection&&"Check"===this.parent.checkAllRows&&!this.selectionSettings.persistSelection&&(this.checkSelectAllAction(!1),this.checkedTarget=null);this.isRowType()&&(this.parent.frozenRows,this.selectRow(n,!0),this.applyUpDown(i.selectedRowIndex));this.isCellType()&&this.selectCell({rowIndex:n,cellIndex:t},!0);"Column"===this.selectionSettings.mode&&this.needColumnSelection&&this.selectColumn(t)},n.prototype.applyUpDown=function(n){if(!(n<0)){this.target||(this.target=this.parent.getRows()[0].children[this.parent.groupSettings.columns.length||0]);var t=parseInt(this.target.getAttribute("aria-colindex"),10),i=this.parent.getFrozenColumns();this.target=i&&t>=i?this.contentRenderer.getMovableRowByIndex(n).querySelectorAll(".e-rowcell")[t-i]:this.contentRenderer.getRowByIndex(n).querySelectorAll(".e-rowcell")[t];this.addAttribute(this.target)}},n.prototype.applyRightLeftKey=function(n,t){this.parent;"Column"===this.selectionSettings.mode&&this.needColumnSelection?this.selectColumn(t):this.isCellType()&&(this.selectCell({rowIndex:n,cellIndex:t},!0),this.addAttribute(this.target))},n.prototype.applyHomeEndKey=function(n,t){this.isCellType()?this.selectCell({rowIndex:n,cellIndex:t},!0):this.addAttribute(this.parent.getCellFromIndex(n,t))},n.prototype.shiftDownKey=function(n,t){this.parent;this.isMultiShiftRequest=!0;this.isRowType()&&!this.isSingleSel()&&(Object(r.isUndefined)(this.prevRowIndex)?this.selectRow(0,!0):(this.selectRowsByRange(this.prevRowIndex,n),this.applyUpDown(n)));this.isCellType()&&!this.isSingleSel()&&this.selectCellsByRange(this.prevCIdxs||{rowIndex:0,cellIndex:0},{rowIndex:n,cellIndex:t});this.isMultiShiftRequest=!1},n.prototype.applyShiftLeftRightKey=function(n,t){this.parent;this.isMultiShiftRequest=!0;"Column"===this.selectionSettings.mode&&this.needColumnSelection?this.selectColumnsByRange(this.prevColIndex,t):this.selectCellsByRange(this.prevCIdxs,{rowIndex:n,cellIndex:t});this.isMultiShiftRequest=!1},n.prototype.getstackedColumns=function(n){for(var i=[],t=0,r=n.length;t<r;t++)n[t].columns?this.getstackedColumns(n[t].columns):i.push(n[t]);return i},n.prototype.applyCtrlHomeEndKey=function(n,t){this.isRowType()&&(this.selectRow(n,!0),this.addAttribute(this.parent.getCellFromIndex(n,t)));this.isCellType()&&this.selectCell({rowIndex:n,cellIndex:t},!0)},n.prototype.addRemoveClassesForRow=function(n,t,i){for(var u=[],r=3;r<arguments.length;r++)u[r-3]=arguments[r];if(n){var f=[].slice.call(n.querySelectorAll(".e-rowcell")),e=n.querySelector(".e-detailrowcollapse")||n.querySelector(".e-detailrowexpand"),o=n.querySelector(".e-rowdragdrop");e&&f.push(e);o&&f.push(o);yt.apply(void 0,[f,t].concat(u))}this.getRenderer().setSelection(n?n.getAttribute("data-uid"):null,t,i)},n.prototype.isRowType=function(){return"Row"===this.selectionSettings.mode||"Both"===this.selectionSettings.mode},n.prototype.isCellType=function(){return"Cell"===this.selectionSettings.mode||"Both"===this.selectionSettings.mode},n.prototype.isSingleSel=function(){return"Single"===this.selectionSettings.type},n.prototype.getRenderer=function(){return Object(r.isNullOrUndefined)(this.contentRenderer)&&(this.contentRenderer=this.factory.getRenderer(ut.Content)),this.contentRenderer},n.prototype.getSelectedRecords=function(){return this.selectionSettings.persistSelection?this.persistSelectedData:this.parent.getRowsObject().filter(function(n){return n.isSelected}).map(function(n){return n.data})},n.prototype.selectColumn=function(n){var t=this.parent,i,u,f,e;if(!Object(r.isNullOrUndefined)(t.getColumns()[n])&&(i=t.getColumnHeaderByUid(t.getColumnByIndex(n).uid),u=i.classList.contains("e-columnselection"),"Column"===t.selectionSettings.mode)){if(this.clearColDependency(),!u||!this.selectionSettings.enableToggle){if(f={columnIndex:n,headerCell:i,cancel:!1,target:this.actualTarget,isInteracted:this.isInteracted,previousColumnIndex:this.prevColIndex,isCtrlPressed:this.isMultiCtrlRequest,isShiftPressed:this.isMultiShiftRequest},this.onActionBegin(f,so),f.cancel)return;t.selectionSettings.enableToggle&&n===this.prevColIndex&&u||this.updateColSelection(i,n);e={columnIndex:n,headerCell:i,target:this.actualTarget,isInteracted:this.isInteracted,previousColumnIndex:this.prevColIndex};this.onActionComplete(e,ho)}this.updateColProps(n)}},n.prototype.selectColumnsByRange=function(n,t){var e=this.parent,u,f,i;if(!Object(r.isNullOrUndefined)(e.getColumns()[n])){if(u=[],"Single"===e.selectionSettings.type||Object(r.isNullOrUndefined)(t))u[0]=n;else for(f=n<t,i=n;f?i<=t:i>=t;f?i++:i--)u.push(i);this.selectColumns(u)}},n.prototype.selectColumns=function(n){var i=this.parent,r=this.getselectedCols(),u,t,f,e;if(("Single"===i.selectionSettings.type&&(n=[n[0]]),"Column"===i.selectionSettings.mode)&&(this.clearColDependency(),u={columnIndex:n[0],headerCell:r,columnIndexes:n,cancel:!1,target:this.actualTarget,isInteracted:this.isInteracted,previousColumnIndex:this.prevColIndex,isCtrlPressed:this.isMultiCtrlRequest,isShiftPressed:this.isMultiShiftRequest},this.onActionBegin(u,so),!u.cancel)){for(t=0,f=n.length;t<f;t++)this.updateColSelection(i.getColumnHeaderByUid(i.getColumnByIndex(n[t]).uid),n[t]);r=this.getselectedCols();e={columnIndex:n[0],headerCell:r,columnIndexes:n,target:this.actualTarget,isInteracted:this.isInteracted,previousColumnIndex:this.prevColIndex};this.onActionComplete(e,ho);this.updateColProps(n[0])}},n.prototype.selectColumnWithExisting=function(n){var t=this.parent,e,o,s,i,a,h,v;if(!Object(r.isNullOrUndefined)(t.getColumns()[n])){var u=t.getFrozenColumns(),c=u&&n>=u,l=t.getColumnHeaderByUid(t.getColumnByIndex(n).uid),f=this.getselectedCols();if("Single"===t.selectionSettings.type&&this.clearColDependency(),"Column"===t.selectionSettings.mode){if(e=c?t.getMovableRows():t.getDataRows(),this.selectedColumnsIndexes.indexOf(n)>-1){if(o={columnIndex:n,headerCell:f,columnIndexes:this.selectedColumnsIndexes,cancel:!1,target:this.actualTarget,isInteracted:this.isInteracted},this.columnDeselect(o,sc))return;for(this.selectedColumnsIndexes.splice(this.selectedColumnsIndexes.indexOf(n),1),yt([l],!1,"e-columnselection"),s=c?n-u:n,s+=t.getIndentCount(),i=0,a=e.length;i<a;i++)yt([e[i].childNodes[s]],!1,"e-columnselection");this.columnDeselect(o,hc);this.parent.getColumns()[n].isSelected=!1}else{if(h={columnIndex:n,headerCell:f,columnIndexes:this.selectedColumnsIndexes,cancel:!1,target:this.actualTarget,isInteracted:this.isInteracted,previousColumnIndex:this.prevColIndex,isCtrlPressed:this.isMultiCtrlRequest,isShiftPressed:this.isMultiShiftRequest},this.onActionBegin(h,so),h.cancel)return;this.updateColSelection(l,n);v={columnIndex:n,headerCell:f=this.getselectedCols(),columnIndexes:this.selectedColumnsIndexes,target:this.actualTarget,isInteracted:this.isInteracted,previousColumnIndex:this.prevColIndex};this.onActionComplete(v,ho)}this.updateColProps(n)}}},n.prototype.clearColumnSelection=function(){if(this.isColumnSelected){var t=this.parent,u=t.getFrozenColumns(),i=this.selectedColumnsIndexes[this.selectedColumnsIndexes.length-1],f={columnIndex:i,headerCell:u&&i>=u?t.getHeaderContent().querySelectorAll(".e-headercell")[i]:t.getColumnHeaderByIndex(i),columnIndexes:this.selectedColumnsIndexes,cancel:!1,target:this.actualTarget,isInteracted:this.isInteracted};if(this.columnDeselect(f,sc))return;for(var e=t.getHeaderContent().querySelectorAll(".e-columnselection"),o=this.getSelectedColumnCells(),n=0,r=e.length;n<r;n++)yt([e[n]],!1,"e-columnselection");for(n=0,r=o.length;n<r;n++)yt([o[n]],!1,"e-columnselection");this.columnDeselect(f,hc);this.selectedColumnsIndexes=[];this.isColumnSelected=!1;this.parent.getColumns().filter(function(n){return n.isSelected=!1})}},n.prototype.getselectedCols=function(){var n,t=this.parent,i;if(this.selectedColumnsIndexes.length>1)for(n=[],i=0;i<this.selectedColumnsIndexes.length;i++)n.push(t.getColumnHeaderByUid(t.getColumnByIndex(this.selectedColumnsIndexes[i]).uid));else n=t.getColumnHeaderByUid(t.getColumnByIndex(this.selectedColumnsIndexes[0]).uid);return n},n.prototype.getSelectedColumnCells=function(){var f,n=this.parent,e=!Object(r.isNullOrUndefined)(this.parent.rowTemplate),t=e?n.getRows():n.getDataRows();n.getFrozenColumns()&&n.getContent().querySelector(".e-movablecontent")&&(f=e?n.getMovableRows():n.getMovableDataRows(),t=n.addMovableRows(t,f));for(var i=[],u=0,o=t.length;u<o;u++)i=i.concat([].slice.call(t[u].querySelectorAll(".e-columnselection")));return i},n.prototype.columnDeselect=function(n,t){return"columnDeselected"===t&&delete n.cancel,this.onActionComplete(n,t),n.cancel},n.prototype.updateColProps=function(n){this.prevColIndex=n;this.isColumnSelected=this.selectedColumnsIndexes.length&&!0},n.prototype.clearColDependency=function(){this.clearColumnSelection();this.selectedColumnsIndexes=[]},n.prototype.updateColSelection=function(n,t){var i,o;if(!Object(r.isNullOrUndefined)(this.parent.getColumns()[t])){var f=this.parent.getFrozenColumns(),e=f&&t>=f,s=!Object(r.isNullOrUndefined)(this.parent.rowTemplate),u=e?this.parent.getMovableRows():s?this.parent.getRows():this.parent.getDataRows();for(this.selectedColumnsIndexes.push(t),this.parent.getColumns()[t].isSelected=!0,t=e?t-f:t+this.parent.getIndentCount(),yt([n],!0,"e-columnselection"),i=0,o=u.length;i<o;i++)u[i].classList.contains("e-row")&&(!u[i].classList.contains("e-editedrow")&&!u[i].classList.contains("e-addedrow")||"Normal"!==this.parent.editSettings.mode||Object(r.isNullOrUndefined)(u[i].querySelector("tr").childNodes[t])?Object(r.isNullOrUndefined)(u[i].childNodes[t])||yt([u[i].childNodes[t]],!0,"e-columnselection"):yt([u[i].querySelector("tr").childNodes[t]],!0,"e-columnselection"))}},n.prototype.headerSelectionHandler=function(n){!this.isMultiCtrlRequest&&!this.isMultiShiftRequest||this.isSingleSel()?this.selectColumn(n):this.isMultiShiftRequest?this.selectColumnsByRange(Object(r.isUndefined)(this.prevColIndex)?n:this.prevColIndex,n):this.selectColumnWithExisting(n)},n.prototype.addEventListener_checkbox=function(){var n=this;this.parent.on(at,this.dataReady,this);this.onDataBoundFunction=this.onDataBound.bind(this);this.parent.addEventListener(ct,this.onDataBoundFunction);this.parent.on(y,this.checkBoxSelectionChanged,this);this.parent.on(ks,this.initPerisistSelection,this);this.parent.on(bt,this.setCheckAllForEmptyGrid,this);this.actionCompleteFunc=this.actionCompleteHandler.bind(this);this.parent.addEventListener(c,this.actionCompleteFunc);this.parent.on(it,this.clickHandler,this);this.resizeEndFn=function(){n.updateAutoFillPosition();n.drawBorders()};this.resizeEndFn.bind(this);this.parent.addEventListener(vc,this.resizeEndFn)},n.prototype.removeEventListener_checkbox=function(){this.parent.off(at,this.dataReady);this.parent.removeEventListener(ct,this.onDataBoundFunction);this.parent.removeEventListener(c,this.actionCompleteFunc);this.parent.off(bt,this.setCheckAllForEmptyGrid);this.parent.off(it,this.clickHandler);this.parent.off(ks,this.initPerisistSelection)},n.prototype.setCheckAllForEmptyGrid=function(){var n=this.getCheckAllBox(),t;n&&(this.parent.isCheckBoxSelection=!0,t=n.nextElementSibling,Object(r.removeClass)([t],["e-check","e-stop","e-uncheck"]))},n.prototype.dataReady=function(n){this.isHeaderCheckboxClicked=!1;var t=this.parent.enableInfiniteScrolling&&"infiniteScroll"===n.requestType;"virtualscroll"===n.requestType||this.parent.isPersistSelection||t||(this.disableUI=!this.parent.enableImmutableMode,this.clearSelection(),this.setCheckAllState(),this.disableUI=!1)},n.prototype.actionCompleteHandler=function(n){"save"===n.requestType&&this.parent.isPersistSelection&&this.refreshPersistSelection()},n.prototype.selectRowIndex=function(n){this.parent.isSelectedRowIndexUpdating=!0;this.parent.selectedRowIndex=n},n.prototype.disableInteracted=function(){this.isInteracted=!1},n.prototype.activeTarget=function(){this.actualTarget=this.isInteracted?this.actualTarget:null},n}(),fb=function(){function n(n){this.parent=n;this.addEventListener()}return n.prototype.search=function(n){var t=this.parent;n=Object(r.isNullOrUndefined)(n)?"":n;si(t)?t.notify(ot,{instance:this,handler:this.search,arg1:n}):n!==t.searchSettings.key?(t.searchSettings.key=n.toString(),t.dataBind()):this.refreshSearch&&t.refresh()},n.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(d,this.onPropertyChanged,this),this.parent.on(gc,this.onSearchComplete,this),this.parent.on(ri,this.destroy,this),this.actionCompleteFunc=this.onActionComplete.bind(this),this.parent.addEventListener(c,this.actionCompleteFunc),this.parent.on(tf,this.cancelBeginEvent,this))},n.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(d,this.onPropertyChanged),this.parent.off(gc,this.onSearchComplete),this.parent.off(ri,this.destroy),this.parent.removeEventListener(c,this.actionCompleteFunc),this.parent.off(tf,this.cancelBeginEvent))},n.prototype.destroy=function(){this.removeEventListener()},n.prototype.onPropertyChanged=function(n){n.module===this.getModuleName()&&(Object(r.isNullOrUndefined)(n.properties.key)?this.parent.notify(p,{requestType:"searching",type:l}):this.parent.notify(p,{requestType:"searching",type:l,searchString:this.parent.searchSettings.key}))},n.prototype.onSearchComplete=function(n){Object(r.isBlazor)()&&!this.parent.isJsComponent&&(n.rows=null);this.parent.trigger(c,Object(r.extend)(n,{searchString:this.parent.searchSettings.key,requestType:"searching",type:c}))},n.prototype.onActionComplete=function(n){this.refreshSearch="searching"!==n.requestType},n.prototype.cancelBeginEvent=function(n){"searching"===n.requestType&&this.parent.setProperties({searchSettings:{key:""}},!0)},n.prototype.getModuleName=function(){return"search"},n}(),wtt=function(){function n(n){this.parent=n}return n.prototype.show=function(n,t){var u=this.getToggleFields(n),r=this.getColumns(u,t),i;for(this.parent.notify(bi,{module:"edit"}),i=0;i<r.length;i++)r[i].visible=!0;this.setVisible(r)},n.prototype.hide=function(n,t){var u=this.getToggleFields(n),r=this.getColumns(u,t),i;for(this.parent.notify(bi,{module:"edit"}),i=0;i<r.length;i++)r[i].visible=!1;this.setVisible(r)},n.prototype.getToggleFields=function(n){return"string"==typeof n?[n]:n},n.prototype.getColumns=function(n,t){var i=this;return yr(n,function(n){return yr(i.parent.columnModel,function(i){if(i[t]===n)return i})[0]})},n.prototype.setVisible=function(n,t){var i=this,u;void 0===t&&(t=[]);u={requestType:"columnstate",cancel:!1,columns:t=t.length>0?t:Object(r.isBlazor)()?JSON.parse(JSON.stringify(n)):n};this.parent.trigger(l,u,function(u){var f=i.parent.getColumns(),e;if(n=Object(r.isNullOrUndefined)(n)?f:n,u.cancel)return i.parent.notify(ws,{showHideArgs:u}),void(n.length>0&&(n[0].visible=!0));(i.parent.allowSelection&&i.parent.getSelectedRecords().length&&i.parent.clearSelection(),i.parent.enableColumnVirtualization)?n.filter(function(n){return f.some(function(t){return n.field===t.field})}).length&&i.parent.notify(ui,n):i.parent.notify(ui,n);e={requestType:"columnstate",columns:t};i.parent.trigger(c,e);"All"!==i.parent.columnQueryMode&&i.parent.refresh()})},n}(),ca=function(){function n(n){this.lastScrollTop=0;this.previousValues={top:0,left:0};this.oneTimeReady=!0;this.parent=n;this.widthService=new ea(n);this.addEventListener()}return n.prototype.getModuleName=function(){return"scroll"},n.prototype.setWidth=function(n){this.parent.element.style.width=Object(r.formatUnit)(this.parent.width);n&&this.widthService.setWidthToColumns();this.parent.toolbarModule&&this.parent.toolbarModule.toolbar&&this.parent.toolbarModule.toolbar.element&&this.parent.toolbarModule.toolbar.refreshOverflow()},n.prototype.setHeight=function(){var i=0,n=this.parent.getContent().querySelector(".e-content"),t;!this.parent.enableVirtualization&&this.parent.frozenRows&&"auto"!==this.parent.height?(t=this.parent.getHeaderContent().querySelector("tbody"),i=t?t.offsetHeight:0,n.style.height=Object(r.formatUnit)(this.parent.height-i)):n.style.height=Object(r.formatUnit)(this.parent.height);this.ensureOverflow(n)},n.prototype.setPadding=function(){var i=this.parent.getHeaderContent(),t=n.getScrollBarWidth()-this.getThreshold(),r=this.getCssProperties();i.querySelector(".e-headercontent").style[r.border]=t>0?"1px":"0px";i.style[r.padding]=t>0?t+"px":"0px"},n.prototype.removePadding=function(n){var i=this.getCssProperties(n),r=this.parent.getHeaderContent().querySelector(".e-headercontent"),t;r.style[i.border]="";r.parentElement.style[i.padding]="";t=this.parent.getFooterContent();t&&t.classList.contains("e-footerpadding")&&t.classList.remove("e-footerpadding")},n.prototype.refresh=function(){var n,t;"100%"===this.parent.height&&(n=this.parent.getContent(),this.parent.element.style.height="100%",t=this.widthService.getSiblingsHeight(n),n.style.height="calc(100% - "+t+"px)")},n.prototype.getThreshold=function(){return"mozilla"===r.Browser.info.name?.5:1},n.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(bt,this.wireEvents,this),this.parent.on(y,this.wireEvents,this),this.parent.on(v,this.onPropertyChanged,this),this.parent.on(is,this.wireEvents,this),this.parent.on(g,this.setScrollLeft,this))},n.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(bt,this.wireEvents),this.parent.off(y,this.wireEvents),this.parent.off(v,this.onPropertyChanged),this.parent.off(is,this.wireEvents),this.parent.off(g,this.setScrollLeft))},n.prototype.setScrollLeft=function(){this.parent.frozenColumns?this.parent.headerModule.getMovableHeader().scrollLeft=this.previousValues.left:this.parent.getHeaderContent().querySelector(".e-headercontent").scrollLeft=this.previousValues.left},n.prototype.onContentScroll=function(n){var t=this,i=n,u=i.classList.contains("e-headercontent");return function(n){var o;if(null!==t.content.querySelector("tbody")&&!t.parent.isPreventScrollEvent){(!Object(r.isNullOrUndefined)(t.parent.infiniteScrollModule)&&t.parent.enableInfiniteScrolling&&t.parent.notify(ss,n),t.parent.groupSettings.columns.length&&t.parent.groupSettings.enableLazyLoading)&&(o=t.previousValues.top<t.parent.getContent().firstElementChild.scrollTop,t.parent.notify(ra,{scrollDown:o}));t.parent.notify(gl,{});var e=n.target,f=e.scrollLeft,s=(e.scrollWidth,e.classList.contains("e-summarycontent"));t.previousValues.left!==f?(t.parent.notify(ps,n),i.scrollLeft=f,s&&(t.header.scrollLeft=f),t.previousValues.left=f,t.parent.notify(lo,{left:f})):t.previousValues.top=u?e.scrollTop:t.previousValues.top}}},n.prototype.onFreezeContentScroll=function(n){var t=this,i=n;return function(n){if(null!==t.content.querySelector("tbody")){var r=n.target.scrollTop;t.previousValues.top!==r&&(i.scrollTop=r,t.previousValues.top=r,t.parent.isDestroyed)}}},n.prototype.onWheelScroll=function(n){var t=this,i=n;return function(n){if(null!==t.content.querySelector("tbody")){var r=i.scrollTop+(1===n.deltaMode?30*n.deltaY:n.deltaY);t.previousValues.top!==r&&(n.preventDefault(),t.parent.getContent().querySelector(".e-frozencontent").scrollTop=r,i.scrollTop=r,t.previousValues.top=r)}}},n.prototype.onTouchScroll=function(n){var t=this,i=n;return function(n){if("mouse"!==n.pointerType){var u,e,o=t.getPointXY(n),r=i.scrollTop+(t.pageXY.y-o.y),f=i.scrollLeft+(t.pageXY.x-o.x);if(t.parent.getHeaderContent().contains(n.target)){if(e=t.parent.getFrozenColumns()?t.parent.getHeaderContent().querySelector(".e-movableheader"):t.parent.getHeaderContent().querySelector(".e-headercontent"),t.previousValues.left===f||f<0||e.scrollWidth-e.clientWidth<f)return;n.preventDefault();e.scrollLeft=f;i.scrollLeft=f;t.pageXY.x=o.x;t.previousValues.left=f}else{if(u=t.parent.getContent().querySelector(".e-frozencontent"),t.previousValues.top===r&&(r<0||u.scrollHeight-u.clientHeight<r)||r<0||u.scrollHeight-u.clientHeight<r)return;n.preventDefault();u.scrollTop=r;i.scrollTop=r;t.pageXY.y=o.y;t.previousValues.top=r}}}},n.prototype.setPageXY=function(){var n=this;return function(t){"mouse"!==t.pointerType&&(n.pageXY=n.getPointXY(t))}},n.prototype.getPointXY=function(n){var t={x:0,y:0};return n.touches&&n.touches.length?(t.x=n.touches[0].pageX,t.y=n.touches[0].pageY):(t.x=n.pageX,t.y=n.pageY),t},n.prototype.wireEvents=function(){var n=this,i,o,s,h,e;if(this.oneTimeReady){i=this.parent.getFrozenColumns();this.content=this.parent.getContent().querySelector(".e-content");this.header=this.parent.getHeaderContent().querySelector(".e-headercontent");var t=this.content.querySelector(".e-movablecontent"),u=this.content.querySelector(".e-frozencontent"),f=this.header.querySelector(".e-movableheader");this.parent.frozenRows&&(r.EventHandler.add(i?f:this.header,"touchstart pointerdown",this.setPageXY(),this),r.EventHandler.add(i?f:this.header,"touchmove pointermove",this.onTouchScroll(i?t:this.content),this));i?(r.EventHandler.add(t,"scroll",this.onContentScroll(f),this),r.EventHandler.add(t,"scroll",this.onFreezeContentScroll(u),this),r.EventHandler.add(u,"scroll",this.onFreezeContentScroll(t),this),r.EventHandler.add(f,"scroll",this.onContentScroll(t),this),r.EventHandler.add(u,"wheel",this.onWheelScroll(t),this),r.EventHandler.add(u,"touchstart pointerdown",this.setPageXY(),this),r.EventHandler.add(u,"touchmove pointermove",this.onTouchScroll(t),this)):(r.EventHandler.add(this.content,"scroll",this.onContentScroll(this.header),this),r.EventHandler.add(this.header,"scroll",this.onContentScroll(this.content),this));this.parent.aggregates.length&&r.EventHandler.add(this.parent.getFooterContent().firstChild,"scroll",this.onContentScroll(this.content),this);this.refresh();this.oneTimeReady=!1}e=this.parent.getContentTable();aa(function(){o=n.header.scrollLeft;s=e.scrollHeight;h=n.parent.getContent().clientHeight},function(){n.parent.enableVirtualization||(s<h&&(Object(r.addClass)(e.querySelectorAll("tr:last-child td"),"e-lastrowcell"),n.parent.getFrozenColumns()&&Object(r.addClass)(n.parent.getContent().querySelector(".e-movablecontent").querySelectorAll("tr:last-child td"),"e-lastrowcell")),(n.parent.frozenRows>0||n.parent.frozenColumns>0)&&n.header.querySelector(".e-movableheader")?n.header.querySelector(".e-movableheader").scrollLeft=n.previousValues.left:n.header.scrollLeft=n.previousValues.left,n.content.scrollLeft=n.previousValues.left,n.content.scrollTop=n.previousValues.top);n.parent.enableColumnVirtualization||(n.content.scrollLeft=o);n.parent.frozenColumns&&n.header.querySelector(".e-movableheader")&&(n.header.querySelector(".e-movableheader").scrollLeft=n.content.querySelector(".e-movablecontent").scrollLeft)});this.parent.isPreventScrollEvent=!1},n.prototype.getCssProperties=function(n){var t={},i=Object(r.isNullOrUndefined)(n)?this.parent.enableRtl:n;return t.border=i?"borderLeftWidth":"borderRightWidth",t.padding=i?"paddingLeft":"paddingRight",t},n.prototype.ensureOverflow=function(n){this.parent.getFrozenColumns()?(n.querySelector(".e-movablecontent").style.overflowY="auto"===this.parent.height?"auto":"scroll","scroll"===n.querySelector(".e-movablecontent").style.overflowY&&this.setPadding()):n.style.overflowY="auto"===this.parent.height?"auto":"scroll"},n.prototype.onPropertyChanged=function(n){n.module===this.getModuleName()&&(this.setPadding(),this.oneTimeReady=!0,"auto"===this.parent.height&&this.removePadding(),this.wireEvents(),this.setHeight(),this.setWidth(!Object(r.isNullOrUndefined)(n.properties.width)))},n.prototype.destroy=function(){var t=this.parent.element,n;t&&(t.querySelector(".e-gridheader")||t.querySelector(".e-gridcontent"))&&(this.removeEventListener(),this.removePadding(),n=this.parent.getContent().querySelector(".e-content"),Object(r.removeClass)([this.parent.getHeaderContent().querySelector(".e-headercontent")],"e-headercontent"),Object(r.removeClass)([n],"e-content"),n.style.height="",this.parent.element.style.width="",r.EventHandler.remove(n,"scroll",this.onContentScroll))},n.getScrollBarWidth=function(){return oi()},n}(),eb=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),di=function(n,t,i,r){var f,e=arguments.length,u=e<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r,o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(n,t,i,r);else for(o=n.length-1;o>=0;o--)(f=n[o])&&(u=(e<3?f(u):e>3?f(t,i,u):f(t,i))||u);return e>3&&u&&Object.defineProperty(t,i,u),u},btt=function(n){function t(){var t=null!==n&&n.apply(this,arguments)||this;return t.templateFn={},t}return eb(t,n),t.prototype.setFormatter=function(n){this.formatFn=n},t.prototype.getFormatter=function(){return this.formatFn},t.prototype.setTemplate=function(n){void 0===n&&(n={});void 0!==this.footerTemplate&&(this.templateFn[Object(r.getEnumValue)(h,h.Summary)]={fn:Object(r.compile)(this.footerTemplate,n),property:"footerTemplate"});void 0!==this.groupFooterTemplate&&(this.templateFn[Object(r.getEnumValue)(h,h.GroupSummary)]={fn:Object(r.compile)(this.groupFooterTemplate,n),property:"groupFooterTemplate"});void 0!==this.groupCaptionTemplate&&(this.templateFn[Object(r.getEnumValue)(h,h.CaptionSummary)]={fn:Object(r.compile)(this.groupCaptionTemplate,n),property:"groupCaptionTemplate"})},t.prototype.getTemplate=function(n){return this.templateFn[Object(r.getEnumValue)(h,n)]},t.prototype.setPropertiesSilent=function(n){this.setProperties(n,!0)},di([Object(r.Property)()],t.prototype,"type",void 0),di([Object(r.Property)()],t.prototype,"field",void 0),di([Object(r.Property)()],t.prototype,"columnName",void 0),di([Object(r.Property)()],t.prototype,"format",void 0),di([Object(r.Property)()],t.prototype,"footerTemplate",void 0),di([Object(r.Property)()],t.prototype,"groupFooterTemplate",void 0),di([Object(r.Property)()],t.prototype,"groupCaptionTemplate",void 0),di([Object(r.Property)()],t.prototype,"customAggregate",void 0),t}(r.ChildProperty),ktt=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return eb(t,n),di([Object(r.Collection)([],btt)],t.prototype,"columns",void 0),t}(r.ChildProperty),ob=function(){function n(n){this.copyContent="";this.isSelect=!1;this.parent=n;this.addEventListener()}return n.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(y,this.initialEnd,this),this.parent.on(w,this.keyDownHandler,this),this.parent.on(it,this.clickHandler,this),r.EventHandler.add(this.parent.element,"keydown",this.pasteHandler,this))},n.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(w,this.keyDownHandler),this.parent.off(y,this.initialEnd),this.parent.off(it,this.clickHandler),r.EventHandler.remove(this.parent.element,"keydown",this.pasteHandler))},n.prototype.clickHandler=function(n){var t=n.target;t=o(t,"e-rowcell")},n.prototype.pasteHandler=function(n){var t=this,i=this.parent,e=/(Mac)/i.test(navigator.platform),u,f;if(86===n.keyCode&&(n.ctrlKey||e&&n.metaKey)&&!i.isEdit){if(!Object(r.closest)(document.activeElement,".e-rowcell")||!i.editSettings.allowEditing||"Batch"!==i.editSettings.mode||"Cell"!==i.selectionSettings.mode||"Flow"===i.selectionSettings.cellSelectionMode)return;this.activeElement=document.activeElement;this.clipBoardTextArea.value="";u=window.scrollX;f=window.scrollY;this.clipBoardTextArea.focus();setTimeout(function(){t.activeElement.focus();window.scrollTo(u,f);t.paste(t.clipBoardTextArea.value,t.parent.getSelectedRowCellIndexes()[0].rowIndex,t.parent.getSelectedRowCellIndexes()[0].cellIndexes[0])},10)}},n.prototype.paste=function(n,t,i){var o,p,v,u=this.parent,e=i,f=t,s,c,k,d,h,y;if(u.editSettings.allowEditing&&"Batch"===u.editSettings.mode&&"Cell"===u.selectionSettings.mode&&"Flow"!==u.selectionSettings.cellSelectionMode){var l,w,a=n.split("\n"),g=u.getDataRows(),b=this.parent.getFrozenColumns();for(b&&(w=u.getMovableDataRows()),s=0;s<a.length;s++){if(l=a[s].split("\t"),e=i,s===a.length-1&&""===a[s]||Object(r.isUndefined)(u.getRowByIndex(f))){e++;break}for(c=0;c<l.length;c++){if((v=u.getCellFromIndex(f,e),b)&&(k=g[f],d=w[f],v=!!k.querySelector('[aria-colindex="'+e+'"]')||d.querySelector('[aria-colindex="'+e+'"]')),!v){e++;break}(p=(o=u.getColumnByIndex(e)).getParser()?o.getParser()(l[c]):l[c],!o.allowEditing||o.isPrimaryKey||o.template)||(h={column:o,data:p,rowIndex:f},this.parent.trigger(np,h),f=h.rowIndex,h.cancel||u.editModule&&("number"===o.type?this.parent.editModule.updateCell(f,o.field,parseFloat(h.data)):u.editModule.updateCell(f,o.field,h.data)));e++}f++}u.selectionModule.selectCellsByRange({rowIndex:t,cellIndex:i},{rowIndex:f-1,cellIndex:e-1});y=this.parent.getCellFromIndex(f-1,e-1);y&&Object(r.classList)(y,["e-focus","e-focused"],[])}},n.prototype.initialEnd=function(){this.parent.off(y,this.initialEnd);this.clipBoardTextArea=this.parent.createElement("textarea",{className:"e-clipboard",styles:"opacity: 0",attrs:{tabindex:"-1","aria-label":"clipboard"}});this.parent.element.appendChild(this.clipBoardTextArea)},n.prototype.keyDownHandler=function(n){"ctrlPlusC"===n.action?this.copy():"ctrlShiftPlusH"===n.action&&this.copy(!0)},n.prototype.setCopyData=function(n){var f,e,h,o,c,t,i,u,l,s;if(""===window.getSelection().toString()){if(f=this.parent.getFrozenColumns(),this.clipBoardTextArea.value=this.copyContent="",e=void 0,h=this.parent.getRows(),f&&(e=this.parent.getMovableDataRows()),"Cell"!==this.parent.selectionSettings.mode){if(o=this.parent.getSelectedRowIndexes().sort(function(n,t){return n-t}),n){for(c=[],t=0;t<this.parent.getVisibleColumns().length;t++)c[t]=this.parent.getVisibleColumns()[t].headerText;this.getCopyData(c,!1,"\t",n);this.copyContent+="\n"}for(t=0;t<o.length;t++)t>0&&(this.copyContent+="\n"),i=[].slice.call(h[o[t]].querySelectorAll(".e-rowcell")),f&&i.push.apply(i,[].slice.call(e[o[t]].querySelectorAll(".e-rowcell"))),this.getCopyData(i,!1,"\t",n)}else if(u=this.checkBoxSelection(),u.status){if(n){for(l=[],t=0;t<u.colIndexes.length;t++)l.push(this.parent.getColumnHeaderByIndex(u.colIndexes[t]));this.getCopyData(l,!1,"\t",n);this.copyContent+="\n"}for(t=0;t<u.rowIndexes.length;t++)t>0&&(this.copyContent+="\n"),i=[].slice.call(h[u.rowIndexes[t]].querySelectorAll(".e-cellselectionbackground")),f&&i.push.apply(i,[].slice.call(e[u.rowIndexes[t]].querySelectorAll(".e-cellselectionbackground"))),this.getCopyData(i,!1,"\t",n)}else this.getCopyData([].slice.call(this.parent.element.querySelectorAll(".e-cellselectionbackground")),!0,"\n",n);if(s={data:this.copyContent,cancel:!1},this.parent.trigger(gy,s),s.cancel)return;this.clipBoardTextArea.value=this.copyContent=s.data;r.Browser.userAgent.match(/ipad|ipod|iphone/i)?this.clipBoardTextArea.setSelectionRange(0,this.clipBoardTextArea.value.length):this.clipBoardTextArea.select();this.isSelect=!0}},n.prototype.getCopyData=function(n,t,i,u){for(var e="string"!=typeof n[0],f=0;f<n.length;f++)u&&t&&(this.copyContent+=this.parent.getColumns()[parseInt(n[f].getAttribute("aria-colindex"),10)].headerText+"\n"),e?n[f].classList.contains("e-hide")||(this.copyContent+=Object(r.isBlazor)()?!n[f].classList.contains("e-gridchkbox")&&Object.keys(n[f].querySelectorAll(".e-check")).length?!0:!n[f].classList.contains("e-gridchkbox")&&Object.keys(n[f].querySelectorAll(".e-uncheck")).length?!1:n[f].innerText:n[f].innerText):this.copyContent+=n[f],f<n.length-1&&(this.copyContent+=i)},n.prototype.copy=function(n){document.queryCommandSupported("copy")&&(this.setCopyData(n),document.execCommand("copy"),this.clipBoardTextArea.blur());this.isSelect&&(window.getSelection().removeAllRanges(),this.isSelect=!1)},n.prototype.getModuleName=function(){return"clipboard"},n.prototype.destroy=function(){this.removeEventListener();this.clipBoardTextArea&&Object(r.remove)(this.clipBoardTextArea)},n.prototype.checkBoxSelection=function(){var u=this.parent,f={status:!1};if("Cell"===u.selectionSettings.mode){for(var t=u.getSelectedRowCellIndexes(),r=void 0,i=[],n=void 0,n=0;n<t.length&&(t[n].cellIndexes.length&&i.push(t[n].rowIndex),!t[n].cellIndexes.length||(r||(r=JSON.stringify(t[n].cellIndexes.sort())),r===JSON.stringify(t[n].cellIndexes.sort())));n++);i.sort(function(n,t){return n-t});n===t.length&&i[i.length-1]-i[0]==i.length-1&&(f={status:!0,rowIndexes:i,colIndexes:t[0].cellIndexes})}return f},n}(),sb=new r.Observer,dtt=function(){function n(n){this.aria=new sf;this.actionArgs={};this.virtualHeight=0;this.parent=n;this.addEventListener()}return n.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on("detailclick",this.onDetailRowClick,this),this.parent.on("add-delete-success",this.addDeleteSuccess,this),this.parent.on("editsuccess",this.editSuccess,this),this.parent.on("setvisibility",this.setColumnVisibility,this),this.parent.on("offset",this.setServerOffSet,this),this.parent.on("updateaction",this.modelChanged,this),this.parent.on(p,this.modelChanged,this),this.parent.on("group-expand-collapse",this.onGroupClick,this),this.parent.on("setcolumnstyles",this.setColVTableWidthAndTranslate,this),this.parent.on("refresh-virtual-indices",this.invokeServerDataBind,this),this.parent.on("contentcolgroup",this.contentColGroup,this),this.parent.on(ar,this.dataSourceModified,this))},n.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off("detailclick",this.onDetailRowClick),this.parent.off("add-delete-success",this.addDeleteSuccess),this.parent.off("editsuccess",this.editSuccess),this.parent.off("setvisibility",this.setColumnVisibility),this.parent.off("offset",this.setServerOffSet),this.parent.off("updateaction",this.modelChanged),this.parent.off(p,this.modelChanged),this.parent.off("group-expand-collapse",this.onGroupClick),this.parent.off("setcolumnstyles",this.setColVTableWidthAndTranslate),this.parent.off("refresh-virtual-indices",this.invokeServerDataBind),this.parent.off("contentcolgroup",this.contentColGroup),this.parent.off(ar,this.dataSourceModified))},n.prototype.getModuleName=function(){return"blazor"},n.prototype.modelChanged=function(n){this.actionArgs=n;this.parent.currentAction=n},n.prototype.addDeleteSuccess=function(n){var i,t=this;i={requestType:n.requestType,data:n.data,action:n.action};Object(r.isNullOrUndefined)(n.index)||(i.index=n.index);n.promise.then(function(){return t.editSuccess(i)}).catch(function(n){Object(r.isBlazor)()&&t.parent.isServerRendered&&(Object(r.isNullOrUndefined)(n.error)||Object(r.isNullOrUndefined)(n.error.message)||(n.error=n.error.message));t.parent.trigger(hi,Object(r.isBlazor)()&&n instanceof Array?n[0]:n);t.parent.hideSpinner();t.parent.log("actionfailure",{error:n})})},n.prototype.editSuccess=function(n){this.parent.renderModule.resetTemplates();this.invokeServerDataBind(n)},n.prototype.invokeServerDataBind=function(n){this.actionArgs=n;this.parent.currentAction=n;this.parent.allowServerDataBinding=!0;this.parent.serverDataBind();this.parent.allowServerDataBinding=!1},n.prototype.onDetailRowClick=function(n){var t=this.parent,u=n.parentElement,f=u.getAttribute("data-uid"),i=t.getRowObjectFromUID(f),r={uid:f,classList:n.classList[0],index:u.getAttribute("aria-rowindex"),rowIndex:t.getRowsObject().indexOf(i),colSpan:this.parent.getVisibleColumns().length};if(t.interopAdaptor.invokeMethodAsync("OnDetailClick",r),n.classList.contains("e-detailrowcollapse")){for(var s=t.getRowsObject(),c=i.data,l=this.parent.getRowUid("grid-row"),a=t.groupSettings.columns.length,e=new kt({isDataRow:!0,isExpand:!0,uid:l,isDetailRow:!0,cells:[new st({cellType:h.Indent}),new st({isDataCell:!0,visible:!0})]}),o=0;o<a;o++)e.cells.unshift(new st({cellType:h.Indent}));s.splice(r.rowIndex+1,0,e);t.trigger(sr,{data:c});t.notify(sr,{rows:t.getRowsObject()});i.isExpand=!0;this.aria.setExpand(n,!0)}else t.getRowsObject().splice(r.rowIndex+1,1),t.notify(sr,{rows:t.getRowsObject()}),i.isExpand=!1,this.aria.setExpand(n,!1)},n.prototype.setColumnVisibility=function(n){for(var i={},t=0;t<n.length;t++)i[n[t].uid]=n[t].visible;this.parent.interopAdaptor.invokeMethodAsync("setColumnVisibility",{visible:i})},n.prototype.dataSuccess=function(n){var s,u,t,c,l,h,i,y,r,f,o;if(this.parent.enableVirtualization&&0===Object.keys(this.actionArgs).length&&(this.actionArgs.requestType="virtualscroll"),(this.actionArgs.startIndex=n.startIndex,this.actionArgs.endIndex=n.endIndex,this.parent.enableVirtualization)&&((this.virtualContentModule=this.parent.contentModule,"downArrow"===this.virtualContentModule.activeKey||"upArrow"===this.virtualContentModule.activeKey)&&(s=this.parent.getRowByIndex(this.virtualContentModule.blzRowIndex),s&&(this.parent.selectRow(parseInt(s.getAttribute("aria-rowindex"),10)),s.cells[0].focus({preventScroll:!0}))),this.virtualContentModule.blazorDataLoad=!1),n.foreignColumnsData)for(u=this.parent.getColumns(),t=0;t<u.length;t++)n.foreignColumnsData[u[t].field]&&(u[t].columnData=n.foreignColumnsData[u[t].field]);if(this.parent.allowGrouping&&this.parent.groupSettings.columns){for(c=[],l=this.parent.aggregates,t=0;t<l.length;t++)for(h=l[t],i=0;i<h.columns.length;i++)y={type:h.columns[i].type.toString().toLowerCase(),field:h.columns[i].field},c.push(y);for(var a=void 0,p=void 0,w=this.parent.groupSettings.columns,v=0;v<w.length;v++)p=a||n.result,a=e.DataUtil.group(p,w[v],c,null,null);n.result=a||n.result}if(r="offset",this.parent.rowUid=n.rowUid,n[r]=1===Math.sign(n[r])?-Math.abs(n[r]):Math.abs(n[r]),this.parent.offsetTime=n[r],this.parent.offsetTime!==(new Date).getTimezoneOffset()/60)if("Batch"!==this.parent.editSettings.mode)"edit"===this.actionArgs.action?this.setClientOffSet(n,this.actionArgs.rowIndex):"add"===this.actionArgs.action&&this.setClientOffSet(n,this.actionArgs.index);else if("Batch"===this.parent.editSettings.mode){for(f=this.parent.getPrimaryKeyFieldNames()[0],o=this.actionArgs.changes||{changedRecords:[],addedRecords:[]},t=0;t<o.changedRecords.length;t++)for(i=0;i<n.result.length;i++)o.changedRecords[t][f]===n.result[i][f]&&this.setClientOffSet(n,i);for(t=0;t<o.addedRecords.length;t++)for(i=0;i<n.result.length;i++)o.addedRecords[t][f]===n.result[i][f]&&this.setClientOffSet(n,i)}this.parent.renderModule.dataManagerSuccess(n,this.actionArgs);this.parent.getMediaColumns();this.parent.enableVirtualization&&(this.virtualContentModule=this.parent.contentModule,this.setColVTableWidthAndTranslate(),this.parent.groupSettings.columns.length&&this.virtualContentModule.setVirtualHeight(this.virtualHeight));this.actionArgs=this.parent.currentAction={}},n.prototype.removeDisplayNone=function(){for(var r,t,i=this.parent.getContentTable().querySelectorAll("tr"),n=0;n<i.length;n++)for(r=i[n].querySelectorAll("td"),t=0;t<r.length;t++)r[t].style.display=""},n.prototype.setVirtualTrackHeight=function(n){this.virtualHeight=n.VisibleGroupedRowsCount*this.parent.getRowHeight();this.virtualContentModule.setVirtualHeight(this.virtualHeight)},n.prototype.setColVTableWidthAndTranslate=function(n){if(this.parent.enableColumnVirtualization&&this.virtualContentModule.prevInfo&&JSON.stringify(this.virtualContentModule.currentInfo.columnIndexes)!==JSON.stringify(this.virtualContentModule.prevInfo.columnIndexes)||n&&n.refresh){var i=this.virtualContentModule.getColumnOffset(this.virtualContentModule.startColIndex-1),t=this.virtualContentModule.getColumnOffset(this.virtualContentModule.endColIndex-1)-i+"";this.virtualContentModule.header.virtualEle.setWrapperWidth(t);this.virtualContentModule.virtualEle.setWrapperWidth(t);this.virtualContentModule.header.virtualEle.adjustTable(i,0);this.parent.getContentTable().parentElement.style.width=t+"px"}this.dataSourceChanged&&(this.virtualContentModule.getPanel().firstElementChild.scrollTop=0,this.virtualContentModule.getPanel().firstElementChild.scrollLeft=0,this.virtualContentModule.header.virtualEle&&this.virtualContentModule.header.virtualEle.adjustTable(0,0),this.parent.getContentTable().parentElement.style.transform="translate(0px,0px)",this.virtualContentModule.refreshOffsets(),this.virtualContentModule.refreshVirtualElement(),this.dataSourceChanged=!1)},n.prototype.dataSourceModified=function(){this.dataSourceChanged=!0},n.prototype.setClientOffSet=function(n,t){var i=e.DataUtil.serverTimezoneOffset;e.DataUtil.serverTimezoneOffset=0;n.result[t]=e.DataUtil.parse.parseJson(JSON.stringify(n.result[t]));e.DataUtil.serverTimezoneOffset=i},n.prototype.setServerOffSet=function(n){var t=e.DataUtil.serverTimezoneOffset,i=(new Date).getTimezoneOffset()/30+this.parent.offsetTime;e.DataUtil.serverTimezoneOffset=i;n.data=e.DataUtil.parse.parseJson(JSON.stringify(n.data));e.DataUtil.serverTimezoneOffset=t},n.prototype.onGroupClick=function(n){var t=this;n.exactTopIndex=Math.round(this.parent.element.querySelector(".e-content").scrollTop/this.parent.getRowHeight());n.rowHeight=this.parent.getRowHeight();this.parent.interopAdaptor.invokeMethodAsync("OnGroupExpandClick",n).then(function(){t.parent.contentModule.rowElements=[].slice.call(t.parent.getContentTable().querySelectorAll("tr.e-row[data-uid]"))})},n.prototype.setPersistData=function(n){var t=this.parent;t.mergePersistGridData(n);t.bulkChanges.columns&&delete t.bulkChanges.columns;t.headerModule.refreshUI();t.notify("persist-data-changed",{});t.notify(ui,t.getColumns())},n.prototype.resetPersistData=function(n){var t=this.parent,r=JSON.parse(n),u={filterSettings:r.filterSettings,groupSettings:r.groupSettings,pageSettings:r.pageSettings,sortSettings:r.sortSettings,searchSettings:r.searchSettings,columns:r.columns},i;for(u.sortSettings.columns||(u.sortSettings.columns=[]),u.groupSettings.columns||(u.groupSettings.columns=[]),u.pageSettings.currentPage||(t.pageSettings.currentPage=1),i=0;i<t.columns.length;i++)t.groupSettings.columns.indexOf(t.columns[i].field)>-1&&(t.columns[i].visible=!0);for(t.mergePersistGridData(u),t.notify("persist-data-changed",{}),t.bulkChanges.columns&&delete t.bulkChanges.columns,t.headerModule.refreshUI(),i=0;i<t.columns.length;i++)t.columns[i].editType=t.columns[i].editType.toLowerCase();t.setProperties({filterSettings:{columns:[]}},!0)},n.prototype.contentColGroup=function(){var n=this.parent,u=n.getContent().querySelector(".e-table"),t,i,r;(u.insertBefore(u.querySelector("#content-"+n.element.id+"colGroup"),u.querySelector("tbody")),n.frozenRows)&&(t=n.getHeaderContent().querySelector(".e-table"),t.insertBefore(t.querySelector("#"+n.element.id+"colGroup"),t.querySelector("tbody")));0!==n.getFrozenColumns()&&(i=n.getContent().querySelector(".e-movablecontent").querySelector(".e-table"),(i.insertBefore(i.querySelector("#"+n.element.id+"colGroup"),i.querySelector("tbody")),n.frozenRows)&&(r=n.getHeaderContent().querySelector(".e-movableheader").querySelector(".e-table"),r.insertBefore(r.querySelector("#"+n.element.id+"colGroup"),r.querySelector("tbody"))))},n.prototype.dataFailure=function(n){this.parent.renderModule.dataManagerFailure(n,this.actionArgs);this.actionArgs=this.parent.currentAction={}},n.prototype.destroy=function(){this.removeEventListener()},n}(),fi=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),f=function(n,t,i,r){var f,e=arguments.length,u=e<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r,o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(n,t,i,r);else for(o=n.length-1;o>=0;o--)(f=n[o])&&(u=(e<3?f(u):e>3?f(t,i,u):f(t,i))||u);return e>3&&u&&Object.defineProperty(t,i,u),u},hb=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return fi(t,n),f([Object(r.Property)()],t.prototype,"field",void 0),f([Object(r.Property)()],t.prototype,"direction",void 0),f([Object(r.Property)(!1)],t.prototype,"isFromGroup",void 0),t}(r.ChildProperty),cb=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return fi(t,n),f([Object(r.Collection)([],hb)],t.prototype,"columns",void 0),f([Object(r.Property)(!0)],t.prototype,"allowUnsort",void 0),t}(r.ChildProperty),lb=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return fi(t,n),f([Object(r.Property)()],t.prototype,"field",void 0),f([Object(r.Property)()],t.prototype,"operator",void 0),f([Object(r.Property)()],t.prototype,"value",void 0),f([Object(r.Property)()],t.prototype,"matchCase",void 0),f([Object(r.Property)(!1)],t.prototype,"ignoreAccent",void 0),f([Object(r.Property)()],t.prototype,"predicate",void 0),f([Object(r.Property)({})],t.prototype,"actualFilterValue",void 0),f([Object(r.Property)({})],t.prototype,"actualOperator",void 0),f([Object(r.Property)()],t.prototype,"type",void 0),f([Object(r.Property)()],t.prototype,"ejpredicate",void 0),f([Object(r.Property)()],t.prototype,"uid",void 0),f([Object(r.Property)()],t.prototype,"isForeignKey",void 0),t}(r.ChildProperty),ab=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return fi(t,n),f([Object(r.Property)(!1)],t.prototype,"enableCache",void 0),f([Object(r.Property)(3)],t.prototype,"maxBlocks",void 0),f([Object(r.Property)(3)],t.prototype,"initialBlocks",void 0),t}(r.ChildProperty),vb=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return fi(t,n),f([Object(r.Collection)([],lb)],t.prototype,"columns",void 0),f([Object(r.Property)("FilterBar")],t.prototype,"type",void 0),f([Object(r.Property)()],t.prototype,"mode",void 0),f([Object(r.Property)(!0)],t.prototype,"showFilterBarStatus",void 0),f([Object(r.Property)(1500)],t.prototype,"immediateModeDelay",void 0),f([Object(r.Property)()],t.prototype,"operators",void 0),f([Object(r.Property)(!1)],t.prototype,"ignoreAccent",void 0),f([Object(r.Property)(!1)],t.prototype,"enableCaseSensitivity",void 0),f([Object(r.Property)(!1)],t.prototype,"showFilterBarOperator",void 0),t}(r.ChildProperty),yb=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return fi(t,n),f([Object(r.Property)("Row")],t.prototype,"mode",void 0),f([Object(r.Property)("Flow")],t.prototype,"cellSelectionMode",void 0),f([Object(r.Property)("Single")],t.prototype,"type",void 0),f([Object(r.Property)(!1)],t.prototype,"checkboxOnly",void 0),f([Object(r.Property)(!1)],t.prototype,"persistSelection",void 0),f([Object(r.Property)("Default")],t.prototype,"checkboxMode",void 0),f([Object(r.Property)(!1)],t.prototype,"enableSimpleMultiRowSelection",void 0),f([Object(r.Property)(!0)],t.prototype,"enableToggle",void 0),t}(r.ChildProperty),pb=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return fi(t,n),f([Object(r.Property)([])],t.prototype,"fields",void 0),f([Object(r.Property)("")],t.prototype,"key",void 0),f([Object(r.Property)("contains")],t.prototype,"operator",void 0),f([Object(r.Property)(!0)],t.prototype,"ignoreCase",void 0),f([Object(r.Property)(!1)],t.prototype,"ignoreAccent",void 0),t}(r.ChildProperty),wb=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return fi(t,n),f([Object(r.Property)()],t.prototype,"targetID",void 0),t}(r.ChildProperty),bb=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return fi(t,n),f([Object(r.Property)("Both")],t.prototype,"wrapMode",void 0),t}(r.ChildProperty),kb=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return fi(t,n),f([Object(r.Property)("Normal")],t.prototype,"mode",void 0),t}(r.ChildProperty),db=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return fi(t,n),f([Object(r.Property)(!0)],t.prototype,"showDropArea",void 0),f([Object(r.Property)(!1)],t.prototype,"allowReordering",void 0),f([Object(r.Property)(!1)],t.prototype,"showToggleButton",void 0),f([Object(r.Property)(!1)],t.prototype,"showGroupedColumn",void 0),f([Object(r.Property)(!0)],t.prototype,"showUngroupButton",void 0),f([Object(r.Property)(!1)],t.prototype,"disablePageWiseAggregates",void 0),f([Object(r.Property)([])],t.prototype,"columns",void 0),f([Object(r.Property)()],t.prototype,"captionTemplate",void 0),f([Object(r.Property)(!1)],t.prototype,"enableLazyLoading",void 0),t}(r.ChildProperty),gb=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return fi(t,n),f([Object(r.Property)(!1)],t.prototype,"allowAdding",void 0),f([Object(r.Property)(!1)],t.prototype,"allowEditing",void 0),f([Object(r.Property)(!1)],t.prototype,"allowDeleting",void 0),f([Object(r.Property)("Normal")],t.prototype,"mode",void 0),f([Object(r.Property)(!0)],t.prototype,"allowEditOnDblClick",void 0),f([Object(r.Property)(!0)],t.prototype,"showConfirmDialog",void 0),f([Object(r.Property)(!1)],t.prototype,"showDeleteConfirmDialog",void 0),f([Object(r.Property)("")],t.prototype,"template",void 0),f([Object(r.Property)("")],t.prototype,"headerTemplate",void 0),f([Object(r.Property)("")],t.prototype,"footerTemplate",void 0),f([Object(r.Property)("Top")],t.prototype,"newRowPosition",void 0),f([Object(r.Property)({})],t.prototype,"dialog",void 0),f([Object(r.Property)(!1)],t.prototype,"allowNextRowEdit",void 0),t}(r.ChildProperty),nh=function(n){function t(t,u){var f=n.call(this,t,u)||this;return f.isPreventScrollEvent=!1,f.inViewIndexes=[],f.keyA=!1,f.media={},f.componentRefresh=r.Component.prototype.refresh,f.isVirtualAdaptive=!1,f.vRows=[],f.vcRows=[],f.vGroupOffsets={},f.rowUid=0,f.currentViewData=[],f.lockcolPositionCount=0,f.prevPageMoving=!1,f.pageTemplateChange=!1,f.isAutoGen=!1,f.mediaBindInstance={},f.commandDelIndex=void 0,f.asyncTimeOut=50,f.enableLogger=!0,f.needsID=!0,i.Inject(ub),Object(r.setValue)("mergePersistData",f.mergePersistGridData,f),f}var i;return fi(t,n),i=t,t.prototype.getPersistData=function(){for(var n=["pageSettings","sortSettings","filterSettings","groupSettings","columns","searchSettings","selectedRowIndex","scrollPosition"],f={pageSettings:["template","pageSizes","enableQueryString","totalRecordsCount","pageCount"],filterSettings:["type","mode","showFilterBarStatus","immediateModeDelay","ignoreAccent"],groupSettings:["showDropArea","showToggleButton","showGroupedColumn","showUngroupButton","disablePageWiseAggregates","hideCaptionCount"],searchSettings:["fields","operator","ignoreCase"],sortSettings:[],columns:[],selectedRowIndex:[],scrollPosition:[]},t=0;t<n.length;t++)for(var e=this[n[t]],i=0,u=f[n[t]];i<u.length;i++)delete e[u[i]];return this.pageSettings.template=void 0,this.isAngular&&delete this.groupSettings.properties.captionTemplate,this.pageTemplateChange=!Object(r.isNullOrUndefined)(this.pagerTemplate),this.addOnPersist(n)},t.prototype.requiredModules=function(){var n=[];return this.isDestroyed||(this.allowFiltering&&n.push({member:"filter",args:[this,this.filterSettings,this.serviceLocator]}),this.allowExcelExport&&n.push({member:"ExcelExport",args:[this,this.serviceLocator]}),this.allowPdfExport&&n.push({member:"PdfExport",args:[this]}),this.allowSorting&&n.push({member:"sort",args:[this,this.sortSettings,this.sortedColumns,this.serviceLocator]}),this.allowPaging&&n.push({member:"pager",args:[this,this.pageSettings]}),this.allowSelection&&n.push({member:"selection",args:[this,this.selectionSettings,this.serviceLocator]}),n.push({member:"resize",args:[this]}),this.allowReordering&&n.push({member:"reorder",args:[this]}),this.allowRowDragAndDrop&&n.push({member:"rowDragAndDrop",args:[this]}),this.allowGrouping&&n.push({member:"group",args:[this,this.groupSettings,this.sortedColumns,this.serviceLocator]}),this.aggregates.length&&n.push({member:"aggregate",args:[this,this.serviceLocator]}),this.isDetail()&&n.push({member:"detailRow",args:[this,this.serviceLocator]}),(this.toolbar||this.toolbarTemplate)&&n.push({member:"toolbar",args:[this,this.serviceLocator]}),(this.enableVirtualization||this.enableColumnVirtualization)&&n.push({member:"virtualscroll",args:[this,this.serviceLocator]}),(this.getFrozenColumns()||this.frozenRows)&&n.push({member:"freeze",args:[this,this.serviceLocator]}),this.isCommandColumn(this.columns)&&n.push({member:"commandColumn",args:[this,this.serviceLocator]}),(this.editSettings.allowAdding||this.editSettings.allowDeleting||this.editSettings.allowEditing)&&n.push({member:"edit",args:[this,this.serviceLocator]}),this.extendRequiredModules(n)),n},t.prototype.extendRequiredModules=function(n){this.enableInfiniteScrolling&&n.push({member:"infiniteScroll",args:[this,this.serviceLocator]});this.groupSettings.enableLazyLoading&&n.push({member:"lazyLoadGroup",args:[this,this.serviceLocator]});this.contextMenuItems&&n.push({member:"contextMenu",args:[this,this.serviceLocator]});this.showColumnMenu&&n.push({member:"columnMenu",args:[this,this.serviceLocator]});this.showColumnChooser&&n.push({member:"columnChooser",args:[this,this.serviceLocator]});this.isForeignKeyEnabled(this.columns)&&n.push({member:"foreignKey",args:[this,this.serviceLocator]});this.enableLogger&&n.push({member:"logger",args:[this]});Object(r.isBlazor)()&&n.push({member:"blazor",args:[this]})},t.prototype.preRender=function(){this.serviceLocator=new tb;this.initProperties();this.initializeServices()},t.prototype.initProperties=function(){(this.isInitial=!0,this.sortedColumns=[],this.inViewIndexes=[],this.mediaCol=[],this.isInitialLoad=!1,this.allowServerDataBinding=!1,this.ignoreCollectionWatch=!0,Object(r.isBlazor)()&&this.enableVirtualization&&this.allowGrouping)&&(this.isExpanded=!1);this.mergeCells={};this.isEdit=!1;this.checkAllRows="None";this.isCheckBoxSelection=!1;this.isPersistSelection=!1;this.componentRefresh=r.Component.prototype.refresh;this.filterOperators={contains:"contains",endsWith:"endswith",equal:"equal",greaterThan:"greaterthan",greaterThanOrEqual:"greaterthanorequal",lessThan:"lessthan",lessThanOrEqual:"lessthanorequal",notEqual:"notequal",startsWith:"startswith"};this.defaultLocale={EmptyRecord:"No records to display",True:"true",False:"false",InvalidFilterMessage:"Invalid Filter Data",GroupDropArea:"Drag a column header here to group its column",UnGroup:"Click here to ungroup",UnGroupButton:"Click here to ungroup",GroupDisable:"Grouping is disabled for this column",FilterbarTitle:"'s filter bar cell",EmptyDataSourceError:"DataSource must not be empty at initial load since columns are generated from dataSource in AutoGenerate Column Grid",Add:"Add",Edit:"Edit",Cancel:"Cancel",Update:"Update",Delete:"Delete",Print:"Print",Pdfexport:"PDF Export",Excelexport:"Excel Export",Wordexport:"Word Export",Csvexport:"CSV Export",Search:"Search",Columnchooser:"Columns",Save:"Save",Item:"item",Items:"items",EditOperationAlert:"No records selected for edit operation",DeleteOperationAlert:"No records selected for delete operation",SaveButton:"Save",OKButton:"OK",CancelButton:"Cancel",EditFormTitle:"Details of ",AddFormTitle:"Add New Record",BatchSaveConfirm:"Are you sure you want to save changes?",BatchSaveLostChanges:"Unsaved changes will be lost. Are you sure you want to continue?",ConfirmDelete:"Are you sure you want to Delete Record?",CancelEdit:"Are you sure you want to Cancel the changes?",ChooseColumns:"Choose Column",SearchColumns:"search columns",Matchs:"No Matches Found",FilterButton:"Filter",ClearButton:"Clear",StartsWith:"Starts With",EndsWith:"Ends With",Contains:"Contains",Equal:"Equal",NotEqual:"Not Equal",LessThan:"Less Than",LessThanOrEqual:"Less Than Or Equal",GreaterThan:"Greater Than",GreaterThanOrEqual:"Greater Than Or Equal",ChooseDate:"Choose a Date",EnterValue:"Enter the value",Copy:"Copy",Group:"Group by this column",Ungroup:"Ungroup by this column",autoFitAll:"Autofit all columns",autoFit:"Autofit this column",AutoFitAll:"Autofit all columns",AutoFit:"Autofit this column",Export:"Export",FirstPage:"First Page",LastPage:"Last Page",PreviousPage:"Previous Page",NextPage:"Next Page",SortAscending:"Sort Ascending",SortDescending:"Sort Descending",EditRecord:"Edit Record",DeleteRecord:"Delete Record",FilterMenu:"Filter",SelectAll:"Select All",Blanks:"Blanks",FilterTrue:"True",FilterFalse:"False",NoResult:"No Matches Found",ClearFilter:"Clear Filter",NumberFilter:"Number Filters",TextFilter:"Text Filters",DateFilter:"Date Filters",DateTimeFilter:"DateTime Filters",MatchCase:"Match Case",Between:"Between",CustomFilter:"Custom Filter",CustomFilterPlaceHolder:"Enter the value",CustomFilterDatePlaceHolder:"Choose a date",AND:"AND",OR:"OR",ShowRowsWhere:"Show rows where:",FilterMenuDialogARIA:"Filter menu dialog",ExcelFilterDialogARIA:"Excel filter dialog",DialogEditARIA:"Edit dialog",ColumnChooserDialogARIA:"Column chooser dialog",ColumnMenuDialogARIA:"Column menu dialog",CustomFilterDialogARIA:"Customer filter dialog",SortAtoZ:"Sort A to Z",SortZtoA:"Sort Z to A",SortByOldest:"Sort by Oldest",SortByNewest:"Sort by Newest",SortSmallestToLargest:"Sort Smallest to Largest",SortLargestToSmallest:"Sort Largest to Smallest"};this.keyConfigs={downArrow:"downarrow",upArrow:"uparrow",rightArrow:"rightarrow",leftArrow:"leftarrow",shiftDown:"shift+downarrow",shiftUp:"shift+uparrow",shiftRight:"shift+rightarrow",shiftLeft:"shift+leftarrow",home:"home",end:"end",escape:"escape",ctrlHome:"ctrl+home",ctrlEnd:"ctrl+end",pageUp:"pageup",pageDown:"pagedown",ctrlAltPageUp:"ctrl+alt+pageup",ctrlAltPageDown:"ctrl+alt+pagedown",altPageUp:"alt+pageup",altPageDown:"alt+pagedown",altDownArrow:"alt+downarrow",altUpArrow:"alt+uparrow",ctrlDownArrow:"ctrl+downarrow",ctrlUpArrow:"ctrl+uparrow",ctrlPlusA:"ctrl+A",ctrlPlusP:"ctrl+P",insert:"insert","delete":"delete",f2:"f2",enter:"enter",ctrlEnter:"ctrl+enter",shiftEnter:"shift+enter",tab:"tab",shiftTab:"shift+tab",space:"space",ctrlPlusC:"ctrl+C",ctrlShiftPlusH:"ctrl+shift+H",ctrlSpace:"ctrl+space",ctrlLeftArrow:"ctrl+leftarrow",ctrlRightArrow:"ctrl+rightarrow"}},t.prototype.render=function(){this.log(["module_missing","promise_enabled","locale_missing","check_datasource_columns"]);this.ariaService.setOptions(this.element,{role:"grid"});Object(r.isBlazor)()&&this.renderComplete();Object(ft.createSpinner)({target:this.element},this.createElement);this.renderModule=new gw(this,this.serviceLocator);this.searchModule=new fb(this);this.scrollModule=new ca(this);this.notify(ii,{});!0!==this.getDataModule().dataManager.dataSource.offline&&void 0!==this.getDataModule().dataManager.dataSource.url||(this.isVirtualAdaptive=!0);this.trigger(tc);lu(this.columns,this.enableColumnVirtualization,this);this.enablePersistence&&this.notify(fs,{});Object(r.isBlazor)()&&this.isServerRendered||(this.getMediaColumns(),de(this.columns));this.checkLockColumns(this.columns);this.getColumns();this.processModel();this.gridRender();this.wireEvents();this.addListener();this.updateDefaultCursor();this.updateStackedFilter();this.showSpinner();this.notify(tt,{});Object(r.isBlazor)()&&this.isServerRendered&&sb.notify(sw,{id:this.element.id,grid:this})},t.prototype.showSpinner=function(){Object(ft.showSpinner)(this.element)},t.prototype.hideSpinner=function(){Object(ft.hideSpinner)(this.element)},t.prototype.updateStackedFilter=function(){this.allowFiltering&&"FilterBar"===this.filterSettings.type&&this.getHeaderContent().querySelectorAll(".e-stackedheadercell").length?this.getHeaderContent().classList.add("e-stackedfilter"):this.getHeaderContent().classList.remove("e-stackedfilter")},t.prototype.getMediaColumns=function(){var t,n;if(!this.enableColumnVirtualization&&(t=this.getColumns(),this.getShowHideService=this.serviceLocator.getService("showHideService"),!Object(r.isNullOrUndefined)(t)))for(n=0;n<t.length;n++)!Object(r.isNullOrUndefined)(t[n].hideAtMedia)&&(Object(r.isNullOrUndefined)(t[n].visible)||t[n].visible)&&this.pushMediaColumn(t[n],n)},t.prototype.pushMediaColumn=function(n,t){this.mediaCol.push(n);this.media[n.uid]=window.matchMedia(n.hideAtMedia);this.mediaQueryUpdate(t,this.media[n.uid]);this.mediaBindInstance[t]=this.mediaQueryUpdate.bind(this,t);this.media[n.uid].addListener(this.mediaBindInstance[t])},t.prototype.updateMediaColumns=function(n){if(!this.enableColumnVirtualization){for(var i=this.getColumnIndexByUid(n.uid),t=0;t<this.mediaCol.length;t++)if(n.uid===this.mediaCol[t].uid)return void this.mediaCol.splice(t,1);this.pushMediaColumn(n,i)}},t.prototype.mediaQueryUpdate=function(n,t){var i=this.getColumns()[n];this.mediaCol.some(function(n){return n.uid===i.uid})&&(i.visible=t.matches,this.isInitialLoad&&(this.invokedFromMedia=!0,i.visible?this.showHider.show(i.headerText,"headerText"):this.showHider.hide(i.headerText,"headerText")))},t.prototype.refreshMediaCol=function(){this.isInitialLoad=!0;var n=this.element.querySelector(".e-gridfooter");this.aggregates.length&&this.element.scrollHeight>this.height&&n&&Object(r.addClass)([n],["e-footerpadding"]);this.getColumns().filter(function(n){return"checkbox"===n.type}).length&&"ResetOnRowClick"===this.selectionSettings.checkboxMode&&(this.isCheckBoxSelection=!1)},t.prototype.removeMediaListener=function(){for(var n=0;n<this.mediaCol.length;n++)this.media[this.mediaCol[n].uid].removeListener(this.mediaBindInstance[this.mediaCol[n].index])},t.prototype.eventInitializer=function(){},t.prototype.destroy=function(){var u=this.element,f,i,t;if(u){for(f=!(!u.querySelector(".e-gridheader")||!u.querySelector(".e-gridcontent")),f&&this.unwireEvents(),this.removeListener(),this.removeMediaListener(),this.notify(ri,{}),this.destroyDependentModules(),f&&n.prototype.destroy.call(this),this.toolTipObj.destroy(),i=["renderModule","headerModule","contentModule","valueFormatterService","serviceLocator","ariaService","keyboardModule","widthService","searchModule","showHider","scrollModule","printModule","clipboardModule","focusModule"],t=0;t<i.length;t++)this[i[t]]&&(this[i[t]]=null);Object(r.isBlazor)()&&this.isServerRendered?this.element.style.display="none":this.element.innerHTML="";Object(r.classList)(this.element,[],["e-rtl","e-gridhover","e-responsive","e-default","e-device","e-grid-min-height"]);this.isAngular&&(this.element=null)}},t.prototype.destroyDependentModules=function(){var n=this.element;n&&(n.querySelector(".e-gridheader")||n.querySelector(".e-gridcontent"))&&(this.scrollModule.destroy(),this.keyboardModule.destroy(),this.focusModule.destroy())},t.prototype.getModuleName=function(){return"grid"},t.prototype.enableBoxSelection=function(){this.enableAutoFill?(this.selectionSettings.cellSelectionMode="BoxWithBorder",this.element.classList.add("e-afenabled")):this.element.classList.remove("e-afenabled")},t.prototype.onPropertyChanged=function(n,t){var u,i=!1,f=!1,c=!1,o,e,s,h;if(!this.isDestroyed){for(this.log("module_missing"),this.isEllipsisTooltip()&&this.toolTipObj.close(),o=Object.keys(n),o.indexOf("columns")>-1&&(this.updateColumnObject(),f=!0),e=0,s=o;e<s.length;e++){h=s[e];switch(h){case"allowPaging":this.notify(v,{module:"pager",enable:this.allowPaging});i=!0;break;case"pageSettings":if(this.pageTemplateChange){this.pageTemplateChange=!1;this.notify(d,{module:"pager",properties:n.pageSettings});break}this.notify(d,{module:"pager",properties:n.pageSettings});(Object(r.isNullOrUndefined)(n.pageSettings.currentPage)&&Object(r.isNullOrUndefined)(n.pageSettings.pageSize)&&Object(r.isNullOrUndefined)(n.pageSettings.totalRecordsCount)||!Object(r.isNullOrUndefined)(t.pageSettings)&&n.pageSettings.currentPage!==t.pageSettings.currentPage&&!this.enableColumnVirtualization&&!this.enableVirtualization&&this.pageSettings.totalRecordsCount<=this.pageSettings.pageSize)&&(i=!0);break;case"allowSorting":this.notify(v,{module:"sort",enable:this.allowSorting});i=!0;u=!0;break;case"allowFiltering":this.updateStackedFilter();this.notify(v,{module:"filter",enable:this.allowFiltering});i=!0;"FilterBar"!==this.filterSettings.type&&this.refreshHeader();break;case"height":case"width":this.notify(v,{module:"scroll",properties:{width:n.width,height:n.height}});break;case"allowReordering":this.headerModule.refreshUI();u=!0;break;case"allowRowDragAndDrop":this.notify(v,{module:"rowDragAndDrop",enable:this.allowRowDragAndDrop});this.renderModule.refresh();this.headerModule.refreshUI();break;case"allowSelection":this.notify(v,{module:"selection",enable:this.allowSelection});break;case"enableAutoFill":this.selectionModule&&(this.enableBoxSelection(),this.selectionModule.updateAutoFillPosition());break;case"rowTemplate":this.rowTemplateFn=et(this.rowTemplate);i=!0;break;case"detailTemplate":this.detailTemplateFn=et(this.detailTemplate);i=!0;break;case"allowGrouping":this.notify(v,{module:"group",enable:this.allowGrouping});this.headerModule.refreshUI();i=!0;u=!0;break;case"enableInfiniteScrolling":case"childGrid":i=!0;break;case"toolbar":this.notify(v,{module:"toolbar"});break;case"groupSettings":this.notify(d,{module:"group",properties:n.groupSettings,oldProperties:t.groupSettings});break;case"aggregates":!this.aggregates.length&&this.allowGrouping&&this.groupSettings.columns.length&&(i=!0);this.notify(v,{module:"aggregate",properties:n});break;case"frozenColumns":case"frozenRows":case"enableVirtualization":case"currencyCode":case"locale":this.log("frozen_rows_columns");c=!0;f=!0;break;case"query":this.getDataModule().isQueryInvokedFromData||(i=!0);this.getDataModule().isQueryInvokedFromData=!1;break;default:this.extendedPropertyChange(h,n,f)}}u&&this.updateDefaultCursor();f?c||this.getFrozenColumns()||this.frozenRows?Object(r.isBlazor)()&&this.isServerRendered||this.freezeRefresh():this.refresh():i&&(this.notify(p,{requestType:"refresh"}),i=!1,this.maintainSelection(n.selectedRowIndex))}},t.prototype.extendedPropertyChange=function(n,t,i){var f,o,h;switch(n){case"enableRtl":this.updateRTL();this.allowPaging&&(this.element.querySelector(".e-gridpager").ej2_instances[0].enableRtl=t.enableRtl,this.element.querySelector(".e-gridpager").ej2_instances[0].dataBind());"auto"!==this.height&&(this.scrollModule.removePadding(!t.enableRtl),this.scrollModule.setPadding());this.toolbar&&this.toolbarModule&&(this.toolbarModule.getToolbar().ej2_instances[0].enableRtl=t.enableRtl,this.toolbarModule.getToolbar().ej2_instances[0].dataBind());this.contextMenuItems&&this.contextMenuModule&&(this.contextMenuModule.getContextMenu().ej2_instances[0].enableRtl=t.enableRtl,this.contextMenuModule.getContextMenu().ej2_instances[0].dataBind());this.showColumnMenu&&this.columnMenuModule&&(this.columnMenuModule.getColumnMenu().ej2_instances[0].enableRtl=t.enableRtl,this.columnMenuModule.getColumnMenu().ej2_instances[0].dataBind());"FilterBar"===this.filterSettings.type&&this.filterSettings.showFilterBarOperator&&this.refreshHeader();this.notify(ns,{});break;case"enableAltRow":this.renderModule.refresh();break;case"allowResizing":this.headerModule.refreshUI();this.updateResizeLines();break;case"rowHeight":this.rowHeight?Object(r.addClass)([this.element],"e-grid-min-height"):Object(r.removeClass)([this.element],"e-grid-min-height");this.renderModule.refresh();this.headerModule.refreshUI();break;case"gridLines":this.updateGridLines();break;case"showColumnMenu":this.headerModule.refreshUI();this.notify(v,{module:"columnMenu",enable:!0});break;case"columnMenuItems":this.notify(v,{module:"columnMenu",enable:this.columnMenuItems});break;case"contextMenuItems":this.notify(v,{module:"contextMenu",enable:this.contextMenuItems});break;case"showColumnChooser":this.notify(v,{module:"columnChooser",enable:this.showColumnChooser});break;case"filterSettings":this.updateStackedFilter();this.notify(d,{module:"filter",properties:t.filterSettings});break;case"searchSettings":this.notify(d,{module:"search",properties:t.searchSettings});break;case"sortSettings":this.notify(d,{module:"sort"});break;case"selectionSettings":this.notify(d,{module:"selection",properties:t.selectionSettings});break;case"editSettings":this.notify(d,{module:"edit",properties:t.editSettings});break;case"allowTextWrap":case"textWrapSettings":this.allowTextWrap?this.applyTextWrap():this.removeTextWrap();this.notify(ki,{"case":"textwrap",isModeChg:"textWrapSettings"===n});break;case"dataSource":if(f=this.getDataModule().getState(),Object.getPrototypeOf(t).deepWatch)for(var c=this.getPrimaryKeyFieldNames()[0],u=0,s=Object.keys(t.dataSource);u<s.length;u++)this.setRowData(Object(r.getValue)(c,this.dataSource[s[u]]),this.dataSource[s[u]]);else if(f.isPending){for(o=Object(r.isNullOrUndefined)(this.dataSource)?[]:this.dataSource.result,h=f.group||[],u=0;u<h.length;u++)o=e.DataUtil.group(o,h[u],f.aggregates||[]);this.dataSource={result:o,count:this.dataSource.count,aggregates:this.dataSource.aggregates};this.getDataModule().setState({});f.resolver(this.dataSource)}else this.getDataModule().setState({isDataChanged:!1}),this.notify(ar,{}),i||(this.renderModule.refresh(),this.isCheckBoxSelection&&this.notify(ks,{}));this.scrollRefresh();break;case"enableHover":(t.enableHover?r.addClass:r.removeClass)([this.element],"e-gridhover");break;case"selectedRowIndex":this.isSelectedRowIndexUpdating||this.selectRow(t.selectedRowIndex);this.isSelectedRowIndexUpdating=!1;break;case"resizeSettings":this.widthService.setWidthToTable()}},t.prototype.maintainSelection=function(n){var i=this,t;if(-1!==n){t=function(){i.selectRow(n);i.off(y,t)};this.on(y,t,this)}},t.prototype.setProperties=function(t,i){n.prototype.setProperties.call(this,t,i);t.filterSettings&&this.filterModule&&i&&this.filterModule.refreshFilter()},t.prototype.updateDefaultCursor=function(){var t=[].slice.call(this.getHeaderContent().querySelectorAll(".e-headercell:not(.e-stackedheadercell)")),e=[].slice.call(this.getHeaderContent().querySelectorAll(".e-stackedheadercell")),r=this.getColumns(),u,n,f,i;for(this.enableColumnVirtualization&&this.getFrozenColumns()&&(u=this.contentModule.getHeaderCells(),t=u.length?u:t),n=0;n<t.length;n++)f=t[n],(this.allowGrouping||this.allowReordering||this.allowSorting)&&(r[n].allowReordering&&r[n].allowSorting&&r[n].allowGrouping?f.classList.add("e-mousepointer"):f.classList.add("e-defaultcursor"));for(i=0;i<e.length;i++)this.allowReordering&&e[i].classList.add("e-mousepointer")},t.prototype.updateColumnModel=function(n){for(var t=0,i=n.length;t<i;t++)n[t].columns?this.updateColumnModel(n[t].columns):this.columnModel.push(n[t]);this.updateFrozenColumns();this.updateLockableColumns()},t.prototype.updateFrozenColumns=function(){for(var n=this.columnModel,i=0,t=0,r=n.length;t<r;t++)n[t].isFrozen&&(n.splice(this.frozenColumns+i,0,n.splice(t,1)[0]),i++)},t.prototype.updateLockableColumns=function(){for(var n=this.columnModel,i=0,r=0,u=this.getFrozenColumns(),t=0;t<n.length;t++)n[t].lockColumn&&(t<u?(n.splice(i,0,n.splice(t,1)[0]),i++):(n.splice(u+r,0,n.splice(t,1)[0]),r++))},t.prototype.checkLockColumns=function(n){for(var t=0;t<n.length;t++)n[t].columns?this.checkLockColumns(n[t].columns):n[t].lockColumn&&this.lockcolPositionCount++},t.prototype.getColumns=function(n){var f=this,t=this.inViewIndexes.map(function(n){return n-f.groupSettings.columns.length}).filter(function(n){return n>-1}),u=t.length,i;return(!this.enableColumnVirtualization||Object(r.isNullOrUndefined)(this.columnModel)||0===this.columnModel.length||n)&&(this.columnModel=[],this.updateColumnModel(this.columns)),i=0===u?this.columnModel:this.columnModel.slice(t[0],t[u-1]+1),this.contentModule&&this.enableColumnVirtualization&&this.getFrozenColumns()&&t.length&&t[0]>0&&(i=this.contentModule.ensureFrozenCols(i)),i},t.prototype.getStackedHeaderColumnByHeaderText=function(n,t){for(var i,r=0;r<t.length;r++){if(i=t[r],i.field===n||i.headerText===n){this.stackedColumn=i;break}i.columns&&this.getStackedHeaderColumnByHeaderText(n,i.columns)}return this.stackedColumn},t.prototype.getColumnIndexesInView=function(){return this.inViewIndexes},t.prototype.getQuery=function(){return this.query},t.prototype.getLocaleConstants=function(){return this.defaultLocale},t.prototype.setColumnIndexesInView=function(n){this.inViewIndexes=n},t.prototype.getVisibleColumns=function(){for(var t,i=[],n=0,r=this.columnModel;n<r.length;n++)t=r[n],t.visible&&i.push(t);return i},t.prototype.getHeaderContent=function(){return this.headerModule.getPanel()},t.prototype.setGridHeaderContent=function(n){this.headerModule.setPanel(n)},t.prototype.getContentTable=function(){return this.contentModule.getTable()},t.prototype.setGridContentTable=function(n){this.contentModule.setTable(n)},t.prototype.getContent=function(){return this.contentModule.getPanel()},t.prototype.setGridContent=function(n){this.contentModule.setPanel(n)},t.prototype.getHeaderTable=function(){return this.headerModule.getTable()},t.prototype.setGridHeaderTable=function(n){this.headerModule.setTable(n)},t.prototype.getFooterContent=function(){return this.footerElement=this.element.getElementsByClassName("e-gridfooter")[0],this.footerElement},t.prototype.getFooterContentTable=function(){return this.footerElement=this.element.getElementsByClassName("e-gridfooter")[0],this.footerElement.firstChild.firstChild},t.prototype.getPager=function(){return this.gridPager},t.prototype.setGridPager=function(n){this.gridPager=n},t.prototype.getRowByIndex=function(n){return this.contentModule.getRowByIndex(n)},t.prototype.getMovableRowByIndex=function(n){return this.contentModule.getMovableRowByIndex(n)},t.prototype.getFrozenRowByIndex=function(n){return this.getFrozenDataRows()[n]},t.prototype.getRows=function(){return this.contentModule.getRowElements()},t.prototype.getRowInfo=function(n){var f=n,e={target:n},t,u,a,s,i;if(!Object(r.isNullOrUndefined)(n)&&Object(r.isNullOrUndefined)(o(f,"e-detailrowcollapse")&&Object(r.isNullOrUndefined)(o(f,"e-recordplusexpand")))){if(t=Object(r.closest)(f,".e-rowcell"),!t)return u=Object(r.closest)(f,".e-row"),Object(r.isNullOrUndefined)(u)||(a=this.getRowObjectFromUID(u.getAttribute("data-uid")),s=parseInt(u.getAttribute("aria-rowindex"),10),e={row:u,rowData:a.data,rowIndex:s}),e;if(i=parseInt(t.getAttribute("aria-colindex"),10),!Object(r.isNullOrUndefined)(t)&&!isNaN(i)){var h=Object(r.closest)(t,".e-row"),c=(s=parseInt(h.getAttribute("aria-rowindex"),10),this.getFrozenColumns()),v=!!c&&i>=c,l=(v?this.contentModule.getMovableRows():this.contentModule.getRows()).filter(function(n){return n.uid===h.getAttribute("data-uid")}),y={},p=void 0;Object.keys(l).length&&(y=l[0].data,p=l[0].cells[v?i-c:i+this.getIndentCount()].column);e={cell:t,cellIndex:i,row:h,rowIndex:s,rowData:y,column:p,target:n}}}return e},t.prototype.getMovableRows=function(){return this.contentModule.getMovableRowElements()},t.prototype.getDataRows=function(){var n,t;return Object(r.isNullOrUndefined)(this.getContentTable().querySelector("tbody"))?[]:(n=[].slice.call(this.getContentTable().querySelector("tbody").children),this.frozenRows&&(t=[].slice.call(this.getHeaderTable().querySelector("tbody").children),n=this.addMovableRows(t,n)),this.generateDataRows(n))},t.prototype.addMovableRows=function(n,t){for(var i=0,r=t.length;i<r;i++)n.push(t[i]);return n},t.prototype.generateDataRows=function(n){for(var i=[],t=0,r=n.length;t<r;t++)n[t].classList.contains("e-row")&&!n[t].classList.contains("e-hiddenrow")&&(this.isCollapseStateEnabled()?i[parseInt(n[t].getAttribute("aria-rowindex"))]=n[t]:i.push(n[t]));return i},t.prototype.getMovableDataRows=function(){var n=[].slice.call(this.getContent().querySelector(".e-movablecontent").querySelector("tbody").children),t;return this.frozenRows&&(t=[].slice.call(this.getHeaderContent().querySelector(".e-movableheader").querySelector("tbody").children),n=this.addMovableRows(t,n)),this.generateDataRows(n)},t.prototype.getFrozenDataRows=function(){var n=[].slice.call(this.getContent().querySelector(".e-frozencontent").querySelector("tbody").children),t;return this.frozenRows&&(t=[].slice.call(this.getHeaderContent().querySelector(".e-frozenheader").querySelector("tbody").children),n=this.addMovableRows(t,n)),this.generateDataRows(n)},t.prototype.setCellValue=function(n,t,i){var u,l,o,a,f,v=this.getPrimaryKeyFieldNames()[0],y=new ht(this,this.serviceLocator),e={},p=this.contentModule.getRows(),w=this.contentModule.getMovableRows(),s,h,c;(u=this.getColumnIndexByField(t),this.groupSettings.columns.length&&(u+=this.groupSettings.columns.length),(this.childGrid||this.detailTemplate)&&u++,this.isRowDragable()&&u++,l=this.getColumnByField(t),f=p.filter(function(t){return Object(r.getValue)(v,t.data)===n})[0],e=w.filter(function(t){return Object(r.getValue)(v,t.data)===n})[0],o=Object(r.isNullOrUndefined)(f)?null:this.element.querySelector("[data-uid="+f.uid+"]"),a=Object(r.isNullOrUndefined)(e)?null:this.element.querySelector("[data-uid="+e.uid+"]"),Object(r.isNullOrUndefined)(o))||(Object(r.setValue)(t,i,f.data),s=Object(r.isNullOrUndefined)(o.cells[u])?a.cells[u-this.frozenColumns]:o.cells[u],Object(r.isNullOrUndefined)(s)||(h=f.cells[u],c=void 0,this.frozenColumns&&(c=e.cells[u-this.frozenColumns]),y.refreshTD(s,Object(r.isNullOrUndefined)(h)?c:h,f.data,{index:f.index}),this.aggregates.length>0&&(this.notify(ai,{}),this.groupSettings.columns.length>0&&this.notify(pi,{})),Object(r.isNullOrUndefined)(e)||Object(r.isNullOrUndefined)(e.changes)||(e.changes[t]=i),this.trigger(eo,{cell:s,column:l,data:f.data})))},t.prototype.setRowData=function(n,t){var i,u=this.contentModule.getRows(),f=this.getPrimaryKeyFieldNames()[0],e=new dt(this.serviceLocator,null,this);this.groupSettings.columns.length>0&&this.aggregates.length>0&&(u=u.filter(function(n){return n.isDataRow}));i=u.filter(function(t){return Object(r.getValue)(f,t.data)===n})[0];!Object(r.isNullOrUndefined)(i)&&this.element.querySelectorAll("[data-uid="+i.uid+"]").length&&(i.changes=t,ge(i,this.getForeignKeyColumns(),i.changes),e.refresh(i,this.getColumns(),!0),this.aggregates.length>0&&(this.notify(ai,{}),this.groupSettings.columns.length>0&&this.notify(pi,{})))},t.prototype.getCellFromIndex=function(n,t){var i=this.getFrozenColumns();return i&&t>=i?this.getMovableDataRows()[n]&&this.getMovableDataRows()[n].querySelectorAll(".e-rowcell")[t-i]:this.getDataRows()[n]&&this.getDataRows()[n].querySelectorAll(".e-rowcell")[t]},t.prototype.getMovableCellFromIndex=function(n,t){return this.getMovableDataRows()[n]&&this.getMovableDataRows()[n].querySelectorAll(".e-rowcell")[t-this.getFrozenColumns()]},t.prototype.getColumnHeaderByIndex=function(n){return this.getHeaderTable().querySelectorAll(".e-headercell")[n]},t.prototype.getRowObjectFromUID=function(n){var i=this.contentModule.getRows(),t=this.rowObject(i,n);return this.getFrozenColumns()&&!t?t=this.rowObject(this.contentModule.getMovableRows(),n):Object(r.isNullOrUndefined)(t)&&this.enableVirtualization&&this.groupSettings.columns.length>0?t=this.rowObject(this.vRows,n):t},t.prototype.rowObject=function(n,t){for(var u,i=0,r=n;i<r.length;i++)if(u=r[i],u.uid===t)return u;return null},t.prototype.getRowsObject=function(){return this.contentModule.getRows()},t.prototype.getMovableRowsObject=function(){return this.contentModule.getMovableRows()},t.prototype.getColumnHeaderByField=function(n){var t=this.getColumnByField(n);if(t)return this.getColumnHeaderByUid(t.uid)},t.prototype.getColumnHeaderByUid=function(n){var t=this.getHeaderContent().querySelector("[e-mappinguid="+n+"]");if(t)return t.parentElement},t.prototype.getColumnByIndex=function(n){var t;return this.getColumns().some(function(i,r){return t=i,r===n}),t},t.prototype.getColumnByField=function(n){return yr(this.getColumns(),function(t){if(t.field===n)return t})[0]},t.prototype.getColumnIndexByField=function(n){for(var i=this.getColumns(),t=0;t<i.length;t++)if(i[t].field===n)return t;return-1},t.prototype.getColumnByUid=function(n){return yr(this.getColumns().concat(this.getStackedColumns(this.columns)),function(t){if(t.uid===n)return t})[0]},t.prototype.getStackedColumns=function(n,t){var i,u,r;for(void 0===t&&(t=[]),i=0,u=n;i<u.length;i++)r=u[i],r.columns&&(t.push(r),this.getStackedColumns(r.columns,t));return t},t.prototype.getColumnIndexByUid=function(n){var t=yr(this.getColumns(),function(t,i){if(t.uid===n)return i})[0];return Object(r.isNullOrUndefined)(t)?-1:t},t.prototype.getUidByColumnField=function(n){return yr(this.getColumns(),function(t){if(t.field===n)return t.uid})[0]},t.prototype.getNormalizedColumnIndex=function(n){return this.getColumnIndexByUid(n)+this.getIndentCount()},t.prototype.getIndentCount=function(){var n=0;return this.allowGrouping&&(n+=this.groupSettings.columns.length),this.isDetail()&&n++,this.isRowDragable()&&Object(r.isNullOrUndefined)(this.rowDropSettings.targetID)&&n++,n},t.prototype.getColumnFieldNames=function(){for(var t,i=[],n=0,r=this.getColumns().length;n<r;n++)(t=this.getColumns()[n]).visible&&i.push(t.field);return i},t.prototype.getRowTemplate=function(){return this.rowTemplateFn},t.prototype.getDetailTemplate=function(){return this.detailTemplateFn},t.prototype.getEditTemplate=function(){return this.editTemplateFn},t.prototype.getEditHeaderTemplate=function(){return this.editHeaderTemplateFn},t.prototype.getEditFooterTemplate=function(){return this.editFooterTemplateFn},t.prototype.getPrimaryKeyFieldNames=function(){for(var t=[],n=0;n<this.columnModel.length;n++)this.columnModel[n].isPrimaryKey&&t.push(this.columnModel[n].field);return t},t.prototype.refresh=function(){this.headerModule.refreshUI();this.updateStackedFilter();this.renderModule.refresh()},t.prototype.refreshHeader=function(){this.headerModule.refreshUI()},t.prototype.getSelectedRows=function(){return this.selectionModule?this.selectionModule.selectedRecords:[]},t.prototype.getSelectedRowIndexes=function(){return this.selectionModule?this.selectionModule.selectedRowIndexes:[]},t.prototype.getSelectedRowCellIndexes=function(){return this.selectionModule?this.selectionModule.selectedRowCellIndexes:[]},t.prototype.getSelectedRecords=function(){return this.selectionModule?this.selectionModule.getSelectedRecords():[]},t.prototype.getSelectedColumnsUid=function(){var t=this,n=[];return this.selectionModule&&this.selectionModule.selectedColumnsIndexes.filter(function(i){return n.push(t.getColumns()[i].uid)}),n},t.prototype.getDataModule=function(){return this.renderModule.data},t.prototype.showColumns=function(n,t){t=t||"headerText";this.showHider.show(n,t)},t.prototype.hideColumns=function(n,t){t=t||"headerText";this.showHider.hide(n,t)},t.prototype.getFrozenColumns=function(){return this.frozenColumns+this.getFrozenCount(this.columns,0)},t.prototype.getVisibleFrozenColumns=function(){return this.getVisibleFrozenColumnsCount()+this.getVisibleFrozenCount(this.columns,0)},t.prototype.getFilterUIInfo=function(){return this.filterModule?this.filterModule.getFilterUIInfo():{}},t.prototype.getVisibleFrozenColumnsCount=function(){for(var t=0,i=this.columnModel,n=0;n<this.frozenColumns;n++)i[n].visible&&t++;return t},t.prototype.getVisibleFrozenCount=function(n,t){for(var i=0,r=n.length;i<r;i++)n[i].columns?t=this.getVisibleFrozenCount(n[i].columns,t):n[i].isFrozen&&n[i].visible&&t++;return t},t.prototype.getFrozenCount=function(n,t){for(var i=0,r=n.length;i<r;i++)n[i].columns?t=this.getFrozenCount(n[i].columns,t):n[i].isFrozen&&t++;return t},t.prototype.goToPage=function(n){this.pagerModule&&this.pagerModule.goToPage(n)},t.prototype.updateExternalMessage=function(n){this.pagerModule&&this.pagerModule.updateExternalMessage(n)},t.prototype.sortColumn=function(n,t,i){this.sortModule&&this.sortModule.sortColumn(n,t,i)},t.prototype.clearSorting=function(){this.sortModule&&this.sortModule.clearSorting()},t.prototype.removeSortColumn=function(n){this.sortModule&&this.sortModule.removeSortColumn(n)},t.prototype.filterByColumn=function(n,t,i,r,u,f,e,o){this.filterModule&&this.filterModule.filterByColumn(n,t,i,r,u,f,e,o)},t.prototype.clearFiltering=function(n){this.filterModule&&this.filterModule.clearFiltering(n)},t.prototype.removeFilteredColsByField=function(n,t){this.filterModule&&this.filterModule.removeFilteredColsByField(n,t)},t.prototype.selectRow=function(n,t){this.selectionModule&&this.selectionModule.selectRow(n,t)},t.prototype.selectRows=function(n){this.selectionModule&&this.selectionModule.selectRows(n)},t.prototype.clearSelection=function(){this.selectionModule&&this.selectionModule.clearSelection()},t.prototype.selectCell=function(n,t){this.selectionModule&&this.selectionModule.selectCell(n,t)},t.prototype.selectCellsByRange=function(n,t){this.selectionModule.selectCellsByRange(n,t)},t.prototype.search=function(n){this.searchModule&&this.searchModule.search(n)},t.prototype.print=function(){this.printModule&&this.printModule.print()},t.prototype.deleteRecord=function(n,t){this.editModule&&this.editModule.deleteRecord(n,t)},t.prototype.startEdit=function(){this.editModule&&this.editModule.startEdit()},t.prototype.endEdit=function(){this.editModule&&this.editModule.endEdit()},t.prototype.closeEdit=function(){this.editModule&&this.editModule.closeEdit()},t.prototype.addRecord=function(n,t){this.editModule&&this.editModule.addRecord(n,t)},t.prototype.deleteRow=function(n){this.editModule&&this.editModule.deleteRow(n)},t.prototype.editCell=function(n,t){this.editModule&&this.editModule.editCell(n,t)},t.prototype.saveCell=function(){this.editModule&&this.editModule.saveCell()},t.prototype.updateCell=function(n,t,i){this.editModule&&this.editModule.updateCell(n,t,i)},t.prototype.updateRow=function(n,t){this.editModule&&this.editModule.updateRow(n,t)},t.prototype.getBatchChanges=function(){return this.editModule?this.editModule.getBatchChanges():{}},t.prototype.enableToolbarItems=function(n,t){this.toolbarModule&&this.toolbarModule.enableItems(n,t)},t.prototype.copy=function(n){this.clipboardModule&&this.clipboardModule.copy(n)},t.prototype.recalcIndentWidth=function(){var r=this;if(this.getHeaderTable().querySelector(".e-emptycell")&&(this.groupSettings.columns.length||this.isDetail()||this.isRowDragable())&&!this.getHeaderTable().querySelector(".e-emptycell").getAttribute("indentRefreshed")&&this.getContentTable()){var n=this.getHeaderTable().querySelector(".e-emptycell").parentElement.offsetWidth,u=[].slice.call(this.getHeaderTable().querySelector("colgroup").childNodes),f=[].slice.call(this.getContentTable().querySelector("colgroup").childNodes),e=n/30,t=0,o=this.element.offsetWidth,i=function(n,t){if(vh(r)){var i=(t/o*100).toFixed(1)+"%";u[n].style.width=i;f[n].style.width=i}else u[n].style.width=t+"px",f[n].style.width=t+"px";r.notify(nu,{index:n,width:t})};for(e>=1&&(n=30/e),(this.enableColumnVirtualization||this.isAutoGen)&&(n=30);t<this.groupSettings.columns.length;)i(t,n),t++;this.isDetail()&&(i(t,n),t++);this.isRowDragable()&&i(t,n);this.isAutoGen=!1;this.getHeaderTable().querySelector(".e-emptycell").setAttribute("indentRefreshed","true")}},t.prototype.resetIndentWidth=function(){if(vh(this)&&(this.getHeaderTable().querySelector(".e-emptycell").removeAttribute("indentRefreshed"),this.widthService.setWidthToColumns(),this.recalcIndentWidth()),("auto"===this.width||"string"==typeof this.width&&-1!==this.width.indexOf("%"))&&this.getColumns().filter(function(n){return(!n.width||"auto"===n.width)&&n.minWidth}).length>0){var n=this.widthService.getTableWidth(this.getColumns());this.widthService.setMinwidthBycalculation(n)}},t.prototype.isRowDragable=function(){return this.allowRowDragAndDrop&&!this.rowDropSettings.targetID&&!this.enableVirtualization},t.prototype.reorderColumns=function(n,t){this.reorderModule&&this.reorderModule.reorderColumns(n,t)},t.prototype.reorderColumnByIndex=function(n,t){this.reorderModule&&this.reorderModule.reorderColumnByIndex(n,t)},t.prototype.reorderColumnByTargetIndex=function(n,t){this.reorderModule&&this.reorderModule.reorderColumnByTargetIndex(n,t)},t.prototype.reorderRows=function(n,t){this.rowDragAndDropModule&&this.rowDragAndDropModule.reorderRows(n,t)},t.prototype.refreshDataSource=function(n){this.notify("refreshdataSource",n)},t.prototype.disableRowDD=function(n){var f=this.getHeaderTable(),o=this.getContentTable(),s=f.querySelectorAll("th.e-rowdragheader, th.e-mastercell"),h=this.getRows(),e=n?"none":"",i,t,u;for(Object(r.setStyleAttribute)(f.querySelector("colgroup").childNodes[0],{display:e}),Object(r.setStyleAttribute)(o.querySelector("colgroup").childNodes[0],{display:e}),i=0;i<this.getRows().length;i++)t=h[i].firstElementChild,n?Object(r.addClass)([t],"e-hide"):Object(r.removeClass)([t],["e-hide"]);for(u=0;u<f.querySelectorAll("th.e-rowdragheader, th.e-mastercell").length;u++)t=s[u],n?Object(r.addClass)([t],"e-hide"):Object(r.removeClass)([t],["e-hide"])},t.prototype.autoFitColumns=function(n){this.resizeModule&&this.resizeModule.autoFitColumns(n)},t.prototype.createColumnchooser=function(n,t,i){this.columnChooserModule&&this.columnChooserModule.renderColumnChooser(n,t,i)},t.prototype.initializeServices=function(){this.serviceLocator.register("widthService",this.widthService=new ea(this));this.serviceLocator.register("cellRendererFactory",new nb);this.serviceLocator.register("rendererFactory",new ett);this.serviceLocator.register("localization",this.localeObj=new r.L10n(this.getModuleName(),this.defaultLocale,this.locale));this.serviceLocator.register("valueFormatter",this.valueFormatterService=new er(this.locale));this.serviceLocator.register("showHideService",this.showHider=new wtt(this));this.serviceLocator.register("ariaService",this.ariaService=new sf);this.serviceLocator.register("focus",this.focusModule=new ott(this))},t.prototype.processModel=function(){var e,f,n=this.groupSettings.columns,t=this.sortSettings.columns,o;if(this.allowGrouping)for(var s=function(r){var o,u;for(f=0,o=t.length;f<o;f++)if(t[f].field===n[r]){e=!0;break}(e?i.allowSorting?i.sortedColumns.push(t[f].field):t[f].direction="Ascending":t.push({field:n[r],direction:"Ascending",isFromGroup:!0}),i.groupSettings.showGroupedColumn)||(u=i.enableColumnVirtualization?i.columns.filter(function(t){return t.field===n[r]})[0]:i.getColumnByField(n[r]),u?u.visible=!1:i.log("initial_action",{moduleName:"group",columnName:n[r]}))},i=this,u=0,h=n.length;u<h;u++)s(u);if(!n.length)for(u=0;u<t.length;u++)this.sortedColumns.push(t[u].field);(this.rowTemplateFn=et(this.rowTemplate),this.detailTemplateFn=et(this.detailTemplate),this.editTemplateFn=et(this.editSettings.template),this.editHeaderTemplateFn=et(this.editSettings.headerTemplate),this.editFooterTemplateFn=et(this.editSettings.footerTemplate),Object(r.isNullOrUndefined)(this.parentDetails))||(o=Object(r.isNullOrUndefined)(this.parentDetails.parentKeyFieldValue)?"undefined":this.parentDetails.parentKeyFieldValue,this.query.where(this.queryString,"equal",o,!0));this.initForeignColumn()},t.prototype.initForeignColumn=function(){this.isForeignKeyEnabled(this.getColumns())&&this.notify(go,this.getForeignKeyColumns())},t.prototype.gridRender=function(){this.updateRTL();this.enableHover&&this.element.classList.add("e-gridhover");r.Browser.isDevice&&this.element.classList.add("e-device");this.rowHeight&&this.element.classList.add("e-grid-min-height");Object(r.classList)(this.element,["e-responsive","e-default"],[]);var n=this.serviceLocator.getService("rendererFactory");this.headerModule=n.getRenderer(ut.Header);this.contentModule=n.getRenderer(ut.Content);this.printModule=new th(this,this.scrollModule);this.clipboardModule=new ob(this);this.renderModule.render();this.eventInitializer();this.createGridPopUpElement();this.widthService.setWidthToColumns();this.updateGridLines();this.applyTextWrap();this.createTooltip();this.enableBoxSelection()},t.prototype.dataReady=function(){this.scrollModule.setWidth();this.scrollModule.setHeight();"auto"!==this.height&&this.scrollModule.setPadding()},t.prototype.updateRTL=function(){this.enableRtl?this.element.classList.add("e-rtl"):this.element.classList.remove("e-rtl")},t.prototype.createGridPopUpElement=function(){var n=this.createElement("div",{className:"e-gridpopup",styles:"display:none;"}),t=this.createElement("div",{className:"e-content",attrs:{tabIndex:"-1"}});Object(r.append)([t,this.createElement("div",{className:"e-uptail e-tail"})],n);t.appendChild(this.createElement("span"));Object(r.append)([t,this.createElement("div",{className:"e-downtail e-tail"})],n);this.element.appendChild(n)},t.prototype.updateGridLines=function(){switch(Object(r.classList)(this.element,[],["e-verticallines","e-horizontallines","e-hidelines","e-bothlines"]),this.gridLines){case"Horizontal":this.element.classList.add("e-horizontallines");break;case"Vertical":this.element.classList.add("e-verticallines");break;case"None":this.element.classList.add("e-hidelines");break;case"Both":this.element.classList.add("e-bothlines")}this.updateResizeLines()},t.prototype.updateResizeLines=function(){this.allowResizing&&"Vertical"!==this.gridLines&&"Both"!==this.gridLines?this.element.classList.add("e-resize-lines"):this.element.classList.remove("e-resize-lines")},t.prototype.applyTextWrap=function(){if(this.allowTextWrap){var n=[].slice.call(this.element.querySelectorAll(".e-columnheader"));switch(this.textWrapSettings.wrapMode){case"Header":vt(this.element,!1);vt(this.getContent(),!1);vt(n,!0);break;case"Content":vt(this.getContent(),!0);vt(this.element,!1);vt(n,!1);break;default:vt(this.element,!0);vt(this.getContent(),!1);vt(n,!1)}"Content"!==this.textWrapSettings.wrapMode&&this.notify(ve,{})}},t.prototype.removeTextWrap=function(){vt(this.element,!1);vt([].slice.call(this.element.querySelectorAll(".e-columnheader")),!1);vt(this.getContent(),!1);"Content"!==this.textWrapSettings.wrapMode&&this.notify(ve,{})},t.prototype.createTooltip=function(){this.toolTipObj=new ft.Tooltip({opensOn:"custom",content:""},this.element)},t.prototype.freezeRefresh=function(){this.enableVirtualization&&(this.pageSettings.currentPage=1);this.componentRefresh()},t.prototype.getTooltipStatus=function(n){var r,u=this.getHeaderTable(),f=(this.getContentTable(),this.createTable(u,"e-gridheader","header")),e=this.createTable(u,"e-gridheader","content"),t=n.classList.contains("e-headercell")?f:e,i=n.classList.contains("e-headercell")?"th":"tr";return t.querySelector(i).className=n.className,t.querySelector(i).innerHTML=n.innerHTML,r=t.querySelector(i).getBoundingClientRect().width,document.body.removeChild(f),document.body.removeChild(e),r>n.getBoundingClientRect().width},t.prototype.mouseMoveHandler=function(n){var t,i;if(this.isEllipsisTooltip()&&(t=o(n.target,"e-ellipsistooltip"),this.prevElement===t&&"mouseout"!==n.type||this.toolTipObj.close(),i=n.target.tagName,t&&"mouseout"!==n.type&&(!r.Browser.isDevice||-1===["A","BUTTON","INPUT"].indexOf(i)))){if(t.getAttribute("aria-describedby"))return;this.getTooltipStatus(t)&&(this.toolTipObj.content=t.getElementsByClassName("e-headertext").length?t.getElementsByClassName("e-headertext")[0].innerText:t.innerText,this.prevElement=t,this.toolTipObj.open(t))}this.hoverFrozenRows(n)},t.prototype.hoverFrozenRows=function(n){var i,t,r;if(this.getFrozenColumns())if(i=o(n.target,"e-row"),[].slice.call(this.element.querySelectorAll(".e-frozenhover")).length&&"mouseout"===n.type)for(t=[].slice.call(this.element.querySelectorAll(".e-frozenhover")),r=0;r<t.length;r++)t[r].classList.remove("e-frozenhover");else i&&((t=[].slice.call(this.element.querySelectorAll('tr[aria-rowindex="'+i.getAttribute("aria-rowindex")+'"]'))).splice(t.indexOf(i),1),"true"!=i.getAttribute("aria-selected")&&t[0]?t[0].classList.add("e-frozenhover"):t[0]&&t[0].classList.remove("e-frozenhover"))},t.prototype.isEllipsisTooltip=function(){var t=this.getColumns(),n;if("EllipsisWithTooltip"===this.clipMode)return!0;for(n=0;n<t.length;n++)if("EllipsisWithTooltip"===t[n].clipMode)return!0;return!1},t.prototype.scrollHandler=function(){this.isEllipsisTooltip()&&this.toolTipObj.close()},t.prototype.createTable=function(n,t,i){var r=this.createElement("div"),f,u;r.className=this.element.className;r.style.cssText="display: inline-block;visibility:hidden;position:absolute";f=this.createElement("div");f.className=t;u=this.createElement("table");u.className=n.className;u.style.cssText="table-layout: auto;width: auto";var o="header"===i?"th":"td",e=this.createElement("tr"),s=this.createElement(o);return e.appendChild(s),u.appendChild(e),f.appendChild(u),r.appendChild(f),document.body.appendChild(r),r},t.prototype.onKeyPressed=function(n){"tab"!==n.action&&"shiftTab"!==n.action||this.toolTipObj.close()},t.prototype.wireEvents=function(){r.EventHandler.add(this.element,"click",this.mouseClickHandler,this);r.EventHandler.add(this.element,"touchend",this.mouseClickHandler,this);r.EventHandler.add(this.element,"focusout",this.focusOutHandler,this);r.EventHandler.add(this.element,"dblclick",this.dblClickHandler,this);r.EventHandler.add(this.element,"keydown",this.keyPressHandler,this);r.EventHandler.add(window,"resize",this.resetIndentWidth,this);this.allowKeyboard&&(this.element.tabIndex=-1===this.element.tabIndex?0:this.element.tabIndex);this.keyboardModule=new r.KeyboardEvents(this.element,{keyAction:this.keyActionHandler.bind(this),keyConfigs:this.keyConfigs,eventName:"keydown"});r.EventHandler.add(this.getContent().firstElementChild,"scroll",this.scrollHandler,this);r.EventHandler.add(this.element,"mousemove",this.mouseMoveHandler,this);r.EventHandler.add(this.element,"mouseout",this.mouseMoveHandler,this);r.EventHandler.add(this.getContent(),"touchstart",this.tapEvent,this);r.EventHandler.add(document.body,"keydown",this.keyDownHandler,this)},t.prototype.unwireEvents=function(){r.EventHandler.remove(this.element,"click",this.mouseClickHandler);r.EventHandler.remove(this.element,"touchend",this.mouseClickHandler);r.EventHandler.remove(this.element,"focusout",this.focusOutHandler);r.EventHandler.remove(this.element,"dblclick",this.dblClickHandler);r.EventHandler.remove(this.getContent().firstElementChild,"scroll",this.scrollHandler);r.EventHandler.remove(this.element,"mousemove",this.mouseMoveHandler);r.EventHandler.remove(this.element,"mouseout",this.mouseMoveHandler);r.EventHandler.remove(this.element,"keydown",this.keyPressHandler);r.EventHandler.remove(this.getContent(),"touchstart",this.tapEvent);r.EventHandler.remove(document.body,"keydown",this.keyDownHandler);r.EventHandler.remove(window,"resize",this.resetIndentWidth)},t.prototype.addListener=function(){this.isDestroyed||(this.on(at,this.dataReady,this),this.on(y,this.recalcIndentWidth,this),this.on(g,this.recalcIndentWidth,this),this.dataBoundFunction=this.refreshMediaCol.bind(this),this.addEventListener(ct,this.dataBoundFunction),this.on(w,this.onKeyPressed,this),this.on(y,this.blazorTemplate,this))},t.prototype.removeListener=function(){this.isDestroyed||(this.off(at,this.dataReady),this.off(y,this.recalcIndentWidth),this.off(g,this.recalcIndentWidth),this.removeEventListener(ct,this.dataBoundFunction),this.off(w,this.onKeyPressed))},t.prototype.blazorTemplate=function(){var n,i;if(Object(r.isBlazor)()){for(this.pageSettings.template&&Object(r.updateBlazorTemplate)(this.element.id+"_template","Template",this.pageSettings),n=0;n<this.columnModel.length;n++){if(this.columnModel[n].template&&Object(r.updateBlazorTemplate)(this.element.id+this.columnModel[n].uid,"Template",this.columnModel[n],!1),this.columnModel[n].headerTemplate&&Object(r.updateBlazorTemplate)(this.element.id+this.columnModel[n].uid+"headerTemplate","HeaderTemplate",this.columnModel[n],!1),"FilterBar"==this.filterSettings.type&&this.columnModel[n].filterTemplate){for(var f=this.columnModel[n].field,e=this.element.id+this.columnModel[n].uid+"filterTemplate",u=this.filterSettings.columns,t=0;t<u.length;t++)f==u[t].field&&(r.blazorTemplates[e][0][f]=u[t].value);Object(r.updateBlazorTemplate)(this.element.id+this.columnModel[n].uid+"filterTemplate","FilterTemplate",this.columnModel[n],!1)}"FilterBar"!=this.filterSettings.type&&this.columnModel[n].filterTemplate&&Object(r.updateBlazorTemplate)(this.element.id+this.columnModel[n].uid+"filterTemplate","FilterTemplate",this.columnModel[n])}for(this.groupSettings.captionTemplate&&Object(r.updateBlazorTemplate)(this.element.id+"captionTemplate","CaptionTemplate",this.groupSettings),t=0;t<this.aggregates.length;t++)for(i=0;i<this.aggregates[t].columns.length;i++)this.aggregates[t].columns[i].footerTemplate&&Object(r.updateBlazorTemplate)(this.element.id+this.aggregates[t].columns[i].guid+"footerTemplate","FooterTemplate",this.aggregates[t].columns[i]),this.aggregates[t].columns[i].groupFooterTemplate&&Object(r.updateBlazorTemplate)(this.element.id+this.aggregates[t].columns[i].guid+"groupFooterTemplate","GroupFooterTemplate",this.aggregates[t].columns[i]),this.aggregates[t].columns[i].groupCaptionTemplate&&Object(r.updateBlazorTemplate)(this.element.id+this.aggregates[t].columns[i].guid+"groupCaptionTemplate","GroupCaptionTemplate",this.aggregates[t].columns[i])}},t.prototype.getCurrentViewRecords=function(){return nt(this)?Object(r.isNullOrUndefined)(this.currentViewData.records)?this.currentViewData:this.currentViewData.records:this.groupSettings.enableLazyLoading?this.currentViewData:this.allowGrouping&&this.groupSettings.columns.length&&this.currentViewData.length&&this.currentViewData.records?this.currentViewData.records:this.currentViewData},t.prototype.mouseClickHandler=function(n){var t,u,i,f,e;this.isChildGrid(n)||o(n.target,"e-gridpopup")&&n.touches||this.element.querySelectorAll(".e-cloneproperties").length||this.checkEdit(n)||(!this.allowRowDragAndDrop&&(o(n.target,"e-gridcontent")||"TD"===n.target.tagName)||!this.allowGrouping&&!this.allowReordering&&o(n.target,"e-gridheader"))&&n.touches||(o(n.target,"e-gridheader")&&this.allowRowDragAndDrop&&!o(n.target,"e-filterbarcell")&&n.preventDefault(),t=this.getRowInfo(n.target),t.cancel=!1,u=!1,i=Object(r.closest)(n.target,"tr"),i&&i.getAttribute("data-uid")&&(f=this.getRowObjectFromUID(i.getAttribute("data-uid")),u=!!f&&f.isDataRow),Object(r.isBlazor)()&&(e=Object(r.extend)({},t.column),t={rowData:t.rowData,rowIndex:t.rowIndex,cellIndex:t.cellIndex,column:e}),u&&this.trigger(py,t),this.notify(it,n))},t.prototype.checkEdit=function(n){var t=o(n.target,"e-row"),i="Batch"!==this.editSettings.mode&&this.isEdit&&t&&(t.classList.contains("e-editedrow")||t.classList.contains("e-addedrow"));return!o(n.target,"e-unboundcelldiv")&&(i||o(n.target,"e-rowcell")&&o(n.target,"e-rowcell").classList.contains("e-editedbatchcell"))},t.prototype.dblClickHandler=function(n){var e=o(n.target,"e-grid"),i,t,u,f;Object(r.isNullOrUndefined)(e)||e.id!==this.element.id||Object(r.closest)(n.target,".e-unboundcelldiv")||(i=!1,t=Object(r.closest)(n.target,"tr"),t&&t.getAttribute("data-uid")&&(u=this.getRowObjectFromUID(t.getAttribute("data-uid")),i=!!u&&u.isDataRow),f=this.getRowInfo(n.target),f.target=n.target,i&&this.trigger(yy,f),this.notify(vr,n))},t.prototype.focusOutHandler=function(n){var i,t,u;this.isChildGrid(n)||(o(n.target,"e-grid")||(this.element.querySelector(".e-gridpopup").style.display="None"),i=this.element.querySelector(".e-cancel:not(.e-hide)"),i&&i.classList.add("e-hide"),t=n.relatedTarget,u=t?t.getAttribute("aria-owns"):null,t&&(o(t,"e-grid")||(!Object(r.isNullOrUndefined)(u)&&u)===n.target.getAttribute("aria-owns"))||this.keyPress||!this.isEdit||r.Browser.isDevice||("Batch"===this.editSettings.mode&&(this.editModule.saveCell(),this.notify(rf,{})),"Normal"===this.editSettings.mode&&this.editModule.editFormValidate()),this.keyPress=!1)},t.prototype.isChildGrid=function(n){var t=o(n.target,"e-grid");return!(!t||t.id===this.element.id)},t.prototype.mergePersistGridData=function(n){var f=window.localStorage.getItem(this.getModuleName()+this.element.id),i,o,u,e,t;if(!Object(r.isNullOrUndefined)(f)&&""!==f||!Object(r.isNullOrUndefined)(n)){for(i=Object(r.isNullOrUndefined)(n)?JSON.parse(f):n,this.enableVirtualization&&(i.pageSettings.currentPage=1),o=Object.keys(i),this.isProtectedOnChange=!0,u=0,e=o;u<e.length;u++)t=e[u],"object"!=typeof this[t]||Object(r.isNullOrUndefined)(this[t])?this[t]=i[t]:Array.isArray(this[t])&&"columns"===t?(Object(r.isBlazor)()&&this.isServerRendered||de(this[t]),this.mergeColumns(i[t],this[t]),this[t]=i[t]):Object(r.extend)(this[t],i[t]);this.isProtectedOnChange=!1}},t.prototype.mergeColumns=function(n,t){for(var i=n,f=function(n){var u=t.filter(function(t){return t.index===i[n].index})[0];Object(r.isNullOrUndefined)(u)||(u.columns&&u.columns.length?(e.mergeColumns(i[n].columns,u.columns),i[n]=Object(r.extend)(u,i[n],{},!0)):(Object(r.isBlazor)()&&(i[n].guid=u.guid,i[n].uid=u.uid),i[n]=Object(r.extend)(u,i[n],{},!0)))},e=this,u=0;u<i.length;u++)f(u)},t.prototype.isDetail=function(){return!Object(r.isNullOrUndefined)(this.detailTemplate)||!Object(r.isNullOrUndefined)(this.childGrid)},t.prototype.isCommandColumn=function(n){var t=this;return n.some(function(n){return n.columns?t.isCommandColumn(n.columns):!(!n.commands&&!n.commandsTemplate)})},t.prototype.isForeignKeyEnabled=function(n){var t=this;return n.some(function(n){return n.columns?t.isForeignKeyEnabled(n.columns):!(!n.dataSource||!n.foreignKeyValue)})},t.prototype.keyPressHandler=function(n){var t=Object(r.extend)(n,{cancel:!1});this.trigger("keyPressed",t);!0===t.cancel&&n.stopImmediatePropagation()},t.prototype.keyDownHandler=function(n){n.altKey&&(74===n.keyCode&&(this.keyA?(this.notify(bs,{target:n.target,collapse:!1}),this.keyA=!1):(this.focusModule.focusHeader(),this.focusModule.addOutline())),87===n.keyCode&&(this.focusModule.focusContent(),this.focusModule.addOutline()),65===n.keyCode&&(this.keyA=!0),72===n.keyCode&&this.keyA&&(this.notify(bs,{target:n.target,collapse:!0}),this.keyA=!1))},t.prototype.keyActionHandler=function(n){this.isChildGrid(n)||this.isEdit&&"escape"!==n.action&&"enter"!==n.action&&"shiftEnter"!==n.action&&"tab"!==n.action&&"shiftTab"!==n.action||(this.keyPress=!0,this.allowKeyboard&&("ctrlPlusP"===n.action&&(n.preventDefault(),this.print()),this.notify(w,n)))},t.prototype.setInjectedModules=function(n){this.injectedModules=n},t.prototype.updateColumnObject=function(){lu(this.columns,this.enableColumnVirtualization,this);Object(r.isBlazor)()&&this.isServerRendered||de(this.columns);this.initForeignColumn();this.notify(wi,{})},t.prototype.getForeignKeyColumns=function(){return this.getColumns().filter(function(n){return n.isForeignColumn()})},t.prototype.getRowHeight=function(){return this.rowHeight?this.rowHeight:fk(this.element)},t.prototype.refreshColumns=function(){var t=this.getContent().querySelector(".e-frozencontent"),n,i;1===this.getFrozenColumns()&&!t||0===this.getFrozenColumns()&&t?(this.enableColumnVirtualization&&(this.columnModel=[],this.updateColumnModel(this.columns)),this.freezeRefresh()):(this.isPreventScrollEvent=!0,this.updateColumnObject(),this.checkLockColumns(this.getColumns()),this.refresh(),this.getFrozenColumns())&&(n=this.contentModule.getMovableContent().querySelector(".e-table"),Object(r.remove)(n.querySelector("colgroup")),i=this.getHeaderContent().querySelector(".e-movableheader").querySelector("colgroup").cloneNode(!0),n.insertBefore(i,n.querySelector("tbody")));this.getFrozenColumns()&&(this.headerModule.getMovableHeader().scrollLeft=this.contentModule.getMovableContent().scrollLeft)},t.prototype.excelExport=function(n,t,i,u){return Object(r.isBlazor)()?(this.excelExportModule.Map(this,n,t,i,!1,u),null):this.excelExportModule?this.excelExportModule.Map(this,n,t,i,!1,u):null},t.prototype.csvExport=function(n,t,i,u){return Object(r.isBlazor)()?(this.excelExportModule.Map(this,n,t,i,!0,u),null):this.excelExportModule?this.excelExportModule.Map(this,n,t,i,!0,u):null},t.prototype.pdfExport=function(n,t,i,u){return Object(r.isBlazor)()?(this.pdfExportModule.Map(this,n,t,i,u),null):this.pdfExportModule?this.pdfExportModule.Map(this,n,t,i,u):null},t.prototype.groupColumn=function(n){this.groupModule&&this.groupModule.groupColumn(n)},t.prototype.groupExpandAll=function(){this.groupModule&&this.groupModule.expandAll()},t.prototype.groupCollapseAll=function(){this.groupModule&&this.groupModule.collapseAll()},t.prototype.clearGrouping=function(){this.groupModule&&this.groupModule.clearGrouping()},t.prototype.ungroupColumn=function(n){this.groupModule&&this.groupModule.ungroupColumn(n)},t.prototype.openColumnChooser=function(n,t){this.columnChooserModule&&this.columnChooserModule.openColumnChooser(n,t)},t.prototype.scrollRefresh=function(){var n=this,t=function(){n.scrollModule.refresh();n.off(y,t)};this.on(y,t,this)},t.prototype.detailCollapseAll=function(){this.detailRowModule&&this.detailRowModule.collapseAll()},t.prototype.detailExpandAll=function(){this.detailRowModule&&this.detailRowModule.expandAll()},t.prototype.clearCellSelection=function(){this.selectionModule&&this.selectionModule.clearCellSelection()},t.prototype.clearRowSelection=function(){this.selectionModule&&this.selectionModule.clearRowSelection()},t.prototype.selectCells=function(n){this.selectionModule&&this.selectionModule.selectCells(n)},t.prototype.selectRowsByRange=function(n,t){this.selectionModule&&this.selectionModule.selectRowsByRange(n,t)},t.prototype.isContextMenuOpen=function(){return this.contextMenuModule&&this.contextMenuModule.isOpen},t.prototype.ensureModuleInjected=function(n){return this.getInjectedModules().indexOf(n)>=0},t.prototype.destroyTemplate=function(n,t){this.clearTemplate(n,t)},t.prototype.log=function(n,t){this.loggerModule&&this.loggerModule.log(n,t)},t.prototype.applyBiggerTheme=function(n){this.element.classList.contains("e-bigger")&&n.classList.add("e-bigger")},t.prototype.getPreviousRowData=function(){return this.getRowsObject()[this.getRows().length-1].data},t.prototype.hideScroll=function(){var t=this.getContent().querySelector(".e-content"),n=t.querySelector(".e-movablecontent")?t.querySelector(".e-movablecontent"):t,i=t.querySelector(".e-frozencontent")?t.querySelector(".e-frozencontent"):t;n.scrollHeight<=n.clientHeight&&i.scrollHeight<=i.clientHeight&&(this.scrollModule.removePadding(),n.style.overflowY="auto");this.frozenColumns&&n.scrollWidth<=n.clientWidth&&(n.style.overflowX="auto",n.style.overflowY="auto",this.notify(ru,0))},t.prototype.getRowIndexByPrimaryKey=function(n){var i=this.getPrimaryKeyFieldNames()[0],t;for(n="object"==typeof n?n[i]:n,t=0;t<this.getRowsObject().length;t++)if(this.getRowsObject()[t].data[i]===n)return this.getRowsObject()[t].index;return-1},t.prototype.grabColumnByFieldFromAllCols=function(n){var r,i,t;for(this.columnModel=[],this.updateColumnModel(this.columns),i=this.columnModel,t=0;t<i.length;t++)n===i[t].field&&(r=i[t]);return r},t.prototype.grabColumnByUidFromAllCols=function(n){var r,i,t;for(this.columnModel=[],this.updateColumnModel(this.columns),i=this.columnModel,t=0;t<i.length;t++)n===i[t].uid&&(r=i[t]);return r},t.prototype.getFilteredRecords=function(){if(this.allowFiltering&&this.filterSettings.columns.length){var n=this.renderModule.data.generateQuery(!0);return this.dataSource&&this.renderModule.data.isRemote()&&this.dataSource instanceof e.DataManager?this.renderModule.data.getData(this.dataSource,n):this.dataSource instanceof e.DataManager?this.dataSource.executeLocal(n):new e.DataManager(this.dataSource,n).executeLocal(n)}return[]},t.prototype.getUserAgent=function(){var n=r.Browser.userAgent.toLowerCase();return/iphone|ipod|ipad/.test(n)},t.prototype.tapEvent=function(n){this.getUserAgent()&&(pr.timer?(clearTimeout(pr.timer),pr.timer=null,this.dblClickHandler(n),this.notify(gu,n)):pr.timer=setTimeout(function(){pr.timer=null},300))},t.prototype.getRowUid=function(n){return""+n+this.rowUid++},t.prototype.getMovableVirtualContent=function(){return this.getContent().querySelector(".e-movablecontent")},t.prototype.getFrozenVirtualContent=function(){return this.getContent().querySelector(".e-frozencontent")},t.prototype.getMovableVirtualHeader=function(){return this.getHeaderContent().querySelector(".e-movableheader")},t.prototype.getFrozenVirtualHeader=function(){return this.getHeaderContent().querySelector(".e-frozenheader")},t.prototype.getRowElementByUID=function(n){var s,t=[],r,u,f,i,e,o;for(this.getFrozenColumns()?(r=[].slice.call(this.getFrozenVirtualContent().querySelector("tbody").children),u=[].slice.call(this.getMovableVirtualContent().querySelector("tbody").children),t=this.frozenRows?(t=(t=[].slice.call(this.getFrozenVirtualHeader().querySelector("tbody").children)).concat([].slice.call(this.getMovableVirtualHeader().querySelector("tbody").children))).concat(r).concat(u):r.concat(u)):(f=[].slice.call(this.getContent().querySelector("tbody").children),t=this.frozenRows?(t=[].slice.call(this.getHeaderContent().querySelector("tbody").children)).concat(f):f),i=0,e=t;i<e.length;i++)if(o=e[i],o.getAttribute("data-uid")===n){s=o;break}return s},t.prototype.getHiddenColumns=function(){for(var t,i=[],n=0,r=this.columnModel;n<r.length;n++)t=r[n],!1===t.visible&&i.push(t);return i},t.prototype.calculatePageSizeByParentHeight=function(n){if(this.allowPaging&&(this.allowTextWrap&&"Header"==this.textWrapSettings.wrapMode||!this.allowTextWrap)){var t=0;if((-1!=n.indexOf("%")&&(n=parseInt(n)/100*this.element.clientHeight),n>this.getNoncontentHeight()+this.getRowHeight())&&(t=(n-this.getNoncontentHeight())/this.getRowHeight()),t>0)return Math.floor(t)}return 0},t.prototype.getNoncontentHeight=function(){var n=0,t;if(Object(r.isNullOrUndefined)(this.getHeaderContent().clientHeight)||(n+=this.getHeaderContent().clientHeight),this.toolbar&&!Object(r.isNullOrUndefined)(this.element.querySelector(".e-toolbar").clientHeight)&&(n+=this.element.querySelector(".e-toolbar").clientHeight),this.allowPaging&&!Object(r.isNullOrUndefined)(this.element.querySelector(".e-gridpager").clientHeight)&&(n+=this.element.querySelector(".e-gridpager").clientHeight),this.showColumnChooser&&!Object(r.isNullOrUndefined)(this.element.querySelector(".e-columnheader").clientHeight)&&(n+=this.element.querySelector(".e-columnheader").clientHeight),this.allowGrouping&&this.groupSettings.showDropArea&&!Object(r.isNullOrUndefined)(this.element.querySelector(".e-groupdroparea").clientHeight)&&(n+=this.element.querySelector(".e-groupdroparea").clientHeight),this.aggregates.length>0&&!Object(r.isNullOrUndefined)(this.element.querySelector(".e-summaryrow").clientHeight))for(t=0;t<this.element.querySelectorAll(".e-summaryrow").length;t++)n+=this.element.querySelectorAll(".e-summaryrow")[t].clientHeight;return n},t.prototype.getSummaryValues=function(n,t){return e.DataUtil.aggregates[n.type.toLowerCase()](t,n.field)},t.prototype.isCollapseStateEnabled=function(){return!1===this.isExpanded},t.prototype.updateRowValue=function(n,t){var i={requestType:"save",data:t};this.showSpinner();this.notify(du,i);this.refresh()},t.prototype.setForeignKeyData=function(){this.dataBind();var n=this.getDataModule().getForeignKeyDataState();n.isPending?(this.getDataModule().setForeignKeyDataState({}),n.resolver()):(this.getDataModule().setForeignKeyDataState({isDataChanged:!1}),(this.contentModule||this.headerModule)&&this.renderModule.render())},t.prototype.resetFilterDlgPosition=function(n){var r=this.getColumnHeaderByField(n),i,t,u,f;r&&(i=r.querySelector(".e-filtermenudiv"),t=this.element.querySelector(".e-filter-popup"),i&&t&&(u=this.element.getBoundingClientRect(),f=i.getBoundingClientRect(),t&&(t.style.left=(f.right-u.left).toString()+"px")))},t.prototype.renderTemplates=function(){this.notify("reactTemplateRender",this.portals);this.renderReactTemplates()},t.prototype.batchUpdate=function(n){this.processRowChanges(n)},t.prototype.batchAsyncUpdate=function(n){this.processBulkRowChanges(n)},t.prototype.processBulkRowChanges=function(n){var i=this;if(this.dataToBeUpdated)for(var r=["addedRecords","changedRecords","deletedRecords"],u=this.getPrimaryKeyFieldNames()[0],t=0;t<r.length;t++)n[r[t]]&&lk(this,n,r[t],u);else this.dataToBeUpdated=Object.assign({addedRecords:[],changedRecords:[],deletedRecords:[]},n),setTimeout(function(){i.processRowChanges(i.dataToBeUpdated);i.dataToBeUpdated=null},this.asyncTimeOut)},t.prototype.processRowChanges=function(n){var i=this,r=this.getPrimaryKeyFieldNames()[0],t;n=Object.assign({addedRecords:[],changedRecords:[],deletedRecords:[]},n);t=this.getDataModule().saveChanges(n,r,{},this.getDataModule().generateQuery().requiresCount());this.getDataModule().isRemote()?t.then(function(){i.setNewData()}):this.setNewData()},t.prototype.setNewData=function(){var n=this,t=JSON.parse(JSON.stringify(this.getCurrentViewRecords()));this.getDataModule().getData({},this.getDataModule().generateQuery().requiresCount()).then(function(i){n.bulkRefresh(i.result,t,i.count)})},t.prototype.deleteRowElement=function(n){var t=this.getRowElementByUID(n.uid),u=parseInt(t.getAttribute("aria-rowindex"),10),i;(Object(r.remove)(t),this.getFrozenColumns())&&(i=this.getMovableRows()[u],Object(r.remove)(i))},t.prototype.bulkRefresh=function(n,t,i){for(var o,s,h,e,c=this,f=this.getRowsObject(),u=this.getPrimaryKeyFieldNames()[0],l=function(t){n.filter(function(n){return n[u]===f[t].data[u]}).length||(a.deleteRowElement(f[t]),f.splice(t,1),t--);e=t},a=this,r=0;r<f.length;r++)l(r),r=e;for(o=function(i){var r;t.filter(function(t){t[u]===n[i][u]&&(t!==n[i]&&c.setRowData(n[i][u],n[i]),r=!0)});r||s.renderRowElement(n[i],i)},s=this,r=0;r<n.length;r++)o(r);this.currentViewData=n;h=[].slice.call(this.getContentTable().querySelectorAll(".e-row"));fv(this,this.getRowsObject(),h);uo(this);this.allowPaging&&this.notify(d,{module:"pager",properties:{totalRecordsCount:i}})},t.prototype.renderRowElement=function(n,t){var f,s=new dt(this.serviceLocator,null,this),e=new vi(this).generateRows([n]),o=s.render(e[0],this.getColumns()),i,r,u;this.addRowObject(e[0],t);i=this.getContentTable().querySelector("tbody");i.querySelector(".e-emptyrow")&&(r=i.querySelector(".e-emptyrow"),(r.parentNode.removeChild(r),this.getFrozenColumns())&&(u=this.getContent().querySelector(".e-movablecontent").querySelector("tbody"),u.firstElementChild.parentNode.removeChild(u.firstElementChild)));this.getFrozenColumns()&&(f=no(o,this.getFrozenColumns(),this),(this.frozenRows&&t<this.frozenRows?this.getHeaderContent().querySelector(".e-movableheader").querySelector("tbody"):this.getContent().querySelector(".e-movablecontent").querySelector("tbody")).appendChild(f),"auto"===this.height&&this.notify(ru,{}));i=this.frozenRows&&t<this.frozenRows?this.getHeaderContent().querySelector("tbody"):this.getContent().querySelector("tbody");(i=this.getContent().querySelector("tbody")).appendChild(o)},t.prototype.addRowObject=function(n,t){var r=this.getFrozenColumns(),u,i;r&&(u=this.getMovableRowsObject(),i=n.clone(),i.cells=i.cells.slice(r),n.cells=n.cells.slice(0,r),u.splice(t,1,i));this.getRowsObject().splice(t,1,n)},t.prototype.getHeight=function(n){return Number.isInteger(n)||-1==n.indexOf("%")?Number.isInteger(n)||"auto"===this.height?this.height:parseInt(n):parseInt(n)/100*this.element.clientHeight},f([Object(r.Property)()],t.prototype,"parentDetails",void 0),f([Object(r.Property)([])],t.prototype,"columns",void 0),f([Object(r.Property)(!0)],t.prototype,"enableAltRow",void 0),f([Object(r.Property)(!0)],t.prototype,"enableHover",void 0),f([Object(r.Property)(!1)],t.prototype,"enableAutoFill",void 0),f([Object(r.Property)(!0)],t.prototype,"allowKeyboard",void 0),f([Object(r.Property)(!1)],t.prototype,"allowTextWrap",void 0),f([Object(r.Complex)({},bb)],t.prototype,"textWrapSettings",void 0),f([Object(r.Complex)({},kb)],t.prototype,"resizeSettings",void 0),f([Object(r.Property)(!1)],t.prototype,"allowPaging",void 0),f([Object(r.Complex)({},att)],t.prototype,"pageSettings",void 0),f([Object(r.Property)(!1)],t.prototype,"enableVirtualization",void 0),f([Object(r.Property)(!1)],t.prototype,"enableColumnVirtualization",void 0),f([Object(r.Property)(!1)],t.prototype,"enableInfiniteScrolling",void 0),f([Object(r.Complex)({},pb)],t.prototype,"searchSettings",void 0),f([Object(r.Property)(!1)],t.prototype,"allowSorting",void 0),f([Object(r.Property)("Ellipsis")],t.prototype,"clipMode",void 0),f([Object(r.Property)(!0)],t.prototype,"allowMultiSorting",void 0),f([Object(r.Property)(!1)],t.prototype,"allowExcelExport",void 0),f([Object(r.Property)(!1)],t.prototype,"allowPdfExport",void 0),f([Object(r.Complex)({},cb)],t.prototype,"sortSettings",void 0),f([Object(r.Complex)({},ab)],t.prototype,"infiniteScrollSettings",void 0),f([Object(r.Property)(!0)],t.prototype,"allowSelection",void 0),f([Object(r.Property)(-1)],t.prototype,"selectedRowIndex",void 0),f([Object(r.Complex)({},yb)],t.prototype,"selectionSettings",void 0),f([Object(r.Property)(!1)],t.prototype,"allowFiltering",void 0),f([Object(r.Property)(!1)],t.prototype,"allowReordering",void 0),f([Object(r.Property)(!1)],t.prototype,"allowResizing",void 0),f([Object(r.Property)(!1)],t.prototype,"allowRowDragAndDrop",void 0),f([Object(r.Complex)({},wb)],t.prototype,"rowDropSettings",void 0),f([Object(r.Complex)({},vb)],t.prototype,"filterSettings",void 0),f([Object(r.Property)(!1)],t.prototype,"allowGrouping",void 0),f([Object(r.Property)(!1)],t.prototype,"enableImmutableMode",void 0),f([Object(r.Property)(!1)],t.prototype,"showColumnMenu",void 0),f([Object(r.Complex)({},db)],t.prototype,"groupSettings",void 0),f([Object(r.Complex)({},gb)],t.prototype,"editSettings",void 0),f([Object(r.Collection)([],ktt)],t.prototype,"aggregates",void 0),f([Object(r.Property)(!1)],t.prototype,"showColumnChooser",void 0),f([Object(r.Complex)({},ptt)],t.prototype,"columnChooserSettings",void 0),f([Object(r.Property)(!1)],t.prototype,"enableHeaderFocus",void 0),f([Object(r.Property)("auto")],t.prototype,"height",void 0),f([Object(r.Property)("auto")],t.prototype,"width",void 0),f([Object(r.Property)("Default")],t.prototype,"gridLines",void 0),f([Object(r.Property)()],t.prototype,"rowTemplate",void 0),f([Object(r.Property)()],t.prototype,"detailTemplate",void 0),f([Object(r.Property)()],t.prototype,"childGrid",void 0),f([Object(r.Property)()],t.prototype,"queryString",void 0),f([Object(r.Property)("AllPages")],t.prototype,"printMode",void 0),f([Object(r.Property)("Expanded")],t.prototype,"hierarchyPrintMode",void 0),f([Object(r.Property)([])],t.prototype,"dataSource",void 0),f([Object(r.Property)(null)],t.prototype,"rowHeight",void 0),f([Object(r.Property)()],t.prototype,"query",void 0),f([Object(r.Property)("USD")],t.prototype,"currencyCode",void 0),f([Object(r.Property)()],t.prototype,"toolbar",void 0),f([Object(r.Property)()],t.prototype,"contextMenuItems",void 0),f([Object(r.Property)()],t.prototype,"columnMenuItems",void 0),f([Object(r.Property)()],t.prototype,"toolbarTemplate",void 0),f([Object(r.Property)()],t.prototype,"pagerTemplate",void 0),f([Object(r.Property)(0)],t.prototype,"frozenRows",void 0),f([Object(r.Property)(0)],t.prototype,"frozenColumns",void 0),f([Object(r.Property)("All")],t.prototype,"columnQueryMode",void 0),f([Object(r.Property)({})],t.prototype,"currentAction",void 0),f([Object(r.Property)("18.3.53")],t.prototype,"ej2StatePersistenceVersion",void 0),f([Object(r.Event)()],t.prototype,"created",void 0),f([Object(r.Event)()],t.prototype,"destroyed",void 0),f([Object(r.Event)()],t.prototype,"load",void 0),f([Object(r.Event)()],t.prototype,"rowDataBound",void 0),f([Object(r.Event)()],t.prototype,"queryCellInfo",void 0),f([Object(r.Event)()],t.prototype,"headerCellInfo",void 0),f([Object(r.Event)()],t.prototype,"actionBegin",void 0),f([Object(r.Event)()],t.prototype,"actionComplete",void 0),f([Object(r.Event)()],t.prototype,"actionFailure",void 0),f([Object(r.Event)()],t.prototype,"dataBound",void 0),f([Object(r.Event)()],t.prototype,"recordDoubleClick",void 0),f([Object(r.Event)()],t.prototype,"recordClick",void 0),f([Object(r.Event)()],t.prototype,"rowSelecting",void 0),f([Object(r.Event)()],t.prototype,"rowSelected",void 0),f([Object(r.Event)()],t.prototype,"rowDeselecting",void 0),f([Object(r.Event)()],t.prototype,"rowDeselected",void 0),f([Object(r.Event)()],t.prototype,"cellSelecting",void 0),f([Object(r.Event)()],t.prototype,"cellSelected",void 0),f([Object(r.Event)()],t.prototype,"cellDeselecting",void 0),f([Object(r.Event)()],t.prototype,"cellDeselected",void 0),f([Object(r.Event)()],t.prototype,"columnSelecting",void 0),f([Object(r.Event)()],t.prototype,"columnSelected",void 0),f([Object(r.Event)()],t.prototype,"columnDeselecting",void 0),f([Object(r.Event)()],t.prototype,"columnDeselected",void 0),f([Object(r.Event)()],t.prototype,"columnDragStart",void 0),f([Object(r.Event)()],t.prototype,"columnDrag",void 0),f([Object(r.Event)()],t.prototype,"columnDrop",void 0),f([Object(r.Event)()],t.prototype,"printComplete",void 0),f([Object(r.Event)()],t.prototype,"beforePrint",void 0),f([Object(r.Event)()],t.prototype,"pdfQueryCellInfo",void 0),f([Object(r.Event)()],t.prototype,"pdfHeaderQueryCellInfo",void 0),f([Object(r.Event)()],t.prototype,"pdfAggregateQueryCellInfo",void 0),f([Object(r.Event)()],t.prototype,"excelAggregateQueryCellInfo",void 0),f([Object(r.Event)()],t.prototype,"exportDetailDataBound",void 0),f([Object(r.Event)()],t.prototype,"excelQueryCellInfo",void 0),f([Object(r.Event)()],t.prototype,"excelHeaderQueryCellInfo",void 0),f([Object(r.Event)()],t.prototype,"beforeExcelExport",void 0),f([Object(r.Event)()],t.prototype,"excelExportComplete",void 0),f([Object(r.Event)()],t.prototype,"beforePdfExport",void 0),f([Object(r.Event)()],t.prototype,"pdfExportComplete",void 0),f([Object(r.Event)()],t.prototype,"rowDragStartHelper",void 0),f([Object(r.Event)()],t.prototype,"detailDataBound",void 0),f([Object(r.Event)()],t.prototype,"rowDragStart",void 0),f([Object(r.Event)()],t.prototype,"rowDrag",void 0),f([Object(r.Event)()],t.prototype,"rowDrop",void 0),f([Object(r.Event)()],t.prototype,"toolbarClick",void 0),f([Object(r.Event)()],t.prototype,"beforeOpenColumnChooser",void 0),f([Object(r.Event)()],t.prototype,"batchAdd",void 0),f([Object(r.Event)()],t.prototype,"batchDelete",void 0),f([Object(r.Event)()],t.prototype,"batchCancel",void 0),f([Object(r.Event)()],t.prototype,"beforeBatchAdd",void 0),f([Object(r.Event)()],t.prototype,"beforeBatchDelete",void 0),f([Object(r.Event)()],t.prototype,"beforeBatchSave",void 0),f([Object(r.Event)()],t.prototype,"beginEdit",void 0),f([Object(r.Event)()],t.prototype,"commandClick",void 0),f([Object(r.Event)()],t.prototype,"cellEdit",void 0),f([Object(r.Event)()],t.prototype,"cellSave",void 0),f([Object(r.Event)()],t.prototype,"cellSaved",void 0),f([Object(r.Event)()],t.prototype,"resizeStart",void 0),f([Object(r.Event)()],t.prototype,"resizing",void 0),f([Object(r.Event)()],t.prototype,"resizeStop",void 0),f([Object(r.Event)()],t.prototype,"keyPressed",void 0),f([Object(r.Event)()],t.prototype,"beforeDataBound",void 0),f([Object(r.Event)()],t.prototype,"contextMenuOpen",void 0),f([Object(r.Event)()],t.prototype,"contextMenuClick",void 0),f([Object(r.Event)()],t.prototype,"columnMenuOpen",void 0),f([Object(r.Event)()],t.prototype,"columnMenuClick",void 0),f([Object(r.Event)()],t.prototype,"checkBoxChange",void 0),f([Object(r.Event)()],t.prototype,"beforeCopy",void 0),f([Object(r.Event)()],t.prototype,"beforePaste",void 0),f([Object(r.Event)()],t.prototype,"beforeAutoFill",void 0),f([Object(r.Event)()],t.prototype,"columnDataStateChange",void 0),f([Object(r.Event)()],t.prototype,"dataStateChange",void 0),f([Object(r.Event)()],t.prototype,"dataSourceChanged",void 0),f([Object(r.Event)()],t.prototype,"exportGroupCaption",void 0),f([Object(r.Event)()],t.prototype,"lazyLoadGroupExpand",void 0),f([Object(r.Event)()],t.prototype,"lazyLoadGroupCollapse",void 0),t=i=f([r.NotifyPropertyChanges],t)}(r.Component);th=function(){function n(n,t){this.isAsyncPrint=!1;this.defered=new e.Deferred;this.parent=n;this.parent.isDestroyed||(this.parent.on(y,this.isContentReady(),this),this.parent.addEventListener(l,this.actionBegin.bind(this)),this.parent.on(bt,this.onEmpty.bind(this)),this.parent.on(rs,this.hierarchyPrint,this),this.scrollModule=t)}return n.prototype.isContentReady=function(){var n=this;return!this.isPrintGrid()||"None"!==this.parent.hierarchyPrintMode&&this.parent.childGrid?function(){n.defered.promise.then(function(){n.contentReady()});n.isPrintGrid()&&n.hierarchyPrint()}:this.contentReady},n.prototype.hierarchyPrint=function(){this.removeColGroup(this.parent);var n=window.printGridObj;n&&!n.element.querySelector("[aria-busy=true")&&n.printModule.defered.resolve()},n.prototype.print=function(){this.renderPrintGrid();this.printWind=window.open("","print","height="+window.outerHeight+",width="+window.outerWidth+",tabbar=no");this.printWind.moveTo(0,0);this.printWind.resizeTo(screen.availWidth,screen.availHeight)},n.prototype.onEmpty=function(){this.isPrintGrid()&&this.contentReady()},n.prototype.actionBegin=function(){this.isPrintGrid()&&(this.isAsyncPrint=!0)},n.prototype.renderPrintGrid=function(){var t=this.parent,i=Object(r.createElement)("div",{id:this.parent.element.id+"_print",className:t.element.className+" e-print-grid"}),n,u,f;document.body.appendChild(i);n=new nh(io(t,t.hierarchyPrintMode));this.parent.isAngular&&(n.viewContainerRef=this.parent.viewContainerRef);n.load=function(){};n.query=t.getQuery().clone();window.printGridObj=n;n.isPrinting=!0;u=n.getInjectedModules();f=t.getInjectedModules();u&&u.length===f.length||n.setInjectedModules(f);t.notify(kp,{element:i,printgrid:n});this.parent.log("exporting_begin",this.getModuleName());n.registeredTemplate=this.parent.registeredTemplate;n.appendTo(i);n.trigger=t.trigger},n.prototype.contentReady=function(){var n,t;if(this.isPrintGrid()){if(n=this.parent,this.isAsyncPrint)return void this.printGrid();if(t={requestType:"print",element:n.element,selectedRows:n.getContentTable().querySelectorAll('tr[aria-selected="true"]'),cancel:!1,hierarchyPrintMode:n.hierarchyPrintMode},this.isAsyncPrint||n.trigger(cc,t),t.cancel)return void Object(r.detach)(n.element);this.isAsyncPrint||this.printGrid()}},n.prototype.printGrid=function(){var n=this.parent,t,i,f,c;if("auto"!==n.height){var e=this.scrollModule.getCssProperties(),o=n.element.querySelector(".e-content"),s=n.element.querySelector(".e-gridheader");o.style.height="auto";o.style.overflowY="auto";s.style[e.padding]="";s.firstElementChild.style[e.border]=""}for(n.allowGrouping&&(n.groupSettings.columns.length?this.removeColGroup(n):n.element.querySelector(".e-groupdroparea").style.display="none"),t=0,i=[].slice.call(n.element.querySelectorAll(".e-content"));t<i.length;t++)(f=i[t]).style.overflowX="hidden";for(var l=n.element.querySelectorAll(".e-spin-show"),u=0,h=[].slice.call(l);u<h.length;u++)f=h[u],Object(r.classList)(f,["e-spin-hide"],["e-spin-show"]);this.printGridElement(n);n.isPrinting=!1;delete window.printGridObj;c={element:n.element};n.trigger(lc,c);this.parent.log("exporting_complete",this.getModuleName())},n.prototype.printGridElement=function(n){Object(r.classList)(n.element,["e-print-grid-layout"],["e-print-grid"]);n.isPrinting&&Object(r.detach)(n.element);this.printWind=Object(r.print)(n.element,this.printWind)},n.prototype.removeColGroup=function(n){var t=n.groupSettings.columns.length,i=n.element,e="#"+n.element.id,o,s;if(t){for(var u=Object(r.selectAll)(e+"captioncell.e-groupcaption",i),h=u[t-1].getAttribute("colspan"),f=0;f<u.length;f++)u[f].setAttribute("colspan",h);o=Object(r.selectAll)("colgroup"+e+"colGroup",i);s=Object(r.selectAll)(".e-content colgroup",i);this.hideColGroup(o,t);this.hideColGroup(s,t)}},n.prototype.hideColGroup=function(n,t){for(var r,i=0;i<n.length;i++)for(r=0;r<t;r++)n[i].children[r].style.display="none"},n.prototype.isPrintGrid=function(){return this.parent.element.id.indexOf("_print")>0&&this.parent.isPrinting},n.prototype.destroy=function(){this.parent.isDestroyed||(this.parent.off(y,this.contentReady.bind(this)),this.parent.removeEventListener(l,this.actionBegin.bind(this)),this.parent.off(bt,this.onEmpty.bind(this)),this.parent.off(rs,this.hierarchyPrint))},n.prototype.getModuleName=function(){return"print"},n.printGridProp=["aggregates","allowGrouping","allowFiltering","allowMultiSorting","allowReordering","allowSorting","allowTextWrap","childGrid","columns","currentViewData","dataSource","detailTemplate","enableAltRow","enableColumnVirtualization","filterSettings","gridLines","groupSettings","height","locale","pageSettings","printMode","query","queryString","enableRtl","rowHeight","rowTemplate","sortSettings","textWrapSettings","allowPaging","hierarchyPrintMode","searchSettings","queryCellInfo","beforeDataBound"].concat([cc,lc,tc]),n}();ni=0;rk=0;eh=null;!function(n){n.timer=null}(pr||(pr={}));var rr=i(6),au=function(){function n(n){this.existingPredicate={};this.foreignKeyQuery=new e.Query;this.filterState=!0;this.values={};this.renderEmpty=!1;this.parent=n;this.id=this.parent.element.id;this.valueFormatter=new er(this.parent.locale);this.cBoxTrue=Object(gt.createCheckBox)(this.parent.createElement,!1,{checked:!0,label:" "});this.cBoxFalse=Object(gt.createCheckBox)(this.parent.createElement,!1,{checked:!1,label:" "});this.cBoxTrue.insertBefore(this.parent.createElement("input",{className:"e-chk-hidden",attrs:{type:"checkbox"}}),this.cBoxTrue.firstChild);this.cBoxFalse.insertBefore(this.parent.createElement("input",{className:"e-chk-hidden",attrs:{type:"checkbox"}}),this.cBoxFalse.firstChild);this.cBoxFalse.querySelector(".e-frame").classList.add("e-uncheck");this.parent.enableRtl&&Object(r.addClass)([this.cBoxTrue,this.cBoxFalse],["e-rtl"])}return n.prototype.destroy=function(){this.closeDialog()},n.prototype.wireEvents=function(){r.EventHandler.add(this.dlg,"click",this.clickHandler,this);r.EventHandler.add(this.dlg,"keyup",this.keyupHandler,this);this.searchHandler=Object(r.debounce)(this.searchBoxKeyUp,200);r.EventHandler.add(this.dlg.querySelector(".e-searchinput"),"keyup",this.searchHandler,this)},n.prototype.unWireEvents=function(){r.EventHandler.remove(this.dlg,"click",this.clickHandler);r.EventHandler.remove(this.dlg,"keyup",this.keyupHandler);var n=this.dlg.querySelector(".e-searchinput");n&&r.EventHandler.remove(n,"keyup",this.searchHandler)},n.prototype.foreignKeyFilter=function(n,t,i){var r=this,u={},f=[],e=this.foreignKeyQuery.clone();this.options.column.dataSource.executeQuery(e.where(i)).then(function(i){r.options.column.columnData=i.result;r.parent.notify(iu,{predicate:u,column:r.options.column});n.ejpredicate=u.predicate.predicates;for(var o=u.predicate.predicates,e=0;e<o.length;e++)f.push({field:o[e].field,predicate:"or",matchCase:o[e].ignoreCase,ignoreAccent:o[e].ignoreAccent,operator:o[e].operator,value:o[e].value,type:r.options.type});n.filterCollection=f.length?f:t.filter(function(n){return n.field=r.options.field});r.options.handler(n)})},n.prototype.foreignFilter=function(n,t){var i=this.options.isRemote?"string"===this.options.column.type?"contains":"equal":this.options.column.type?"contains":"equal",r=new e.Predicate(this.options.column.foreignKeyValue,i,t,!0,this.options.ignoreAccent);this.foreignKeyFilter(n,[n.filterCollection],r)},n.prototype.searchBoxClick=function(n){n.target.classList.contains("e-searchclear")&&(this.sInput.value="",this.refreshCheckboxes(),this.updateSearchIcon(),this.sInput.focus())},n.prototype.searchBoxKeyUp=function(){this.refreshCheckboxes();this.updateSearchIcon()},n.prototype.updateSearchIcon=function(){this.sInput.value.length?Object(r.classList)(this.sIcon,["e-chkcancel-icon"],["e-search-icon"]):Object(r.classList)(this.sIcon,["e-search-icon"],["e-chkcancel-icon"])},n.prototype.getLocalizedLabel=function(n){return this.localeObj.getConstant(n)},n.prototype.updateDataSource=function(){var n=this.options.dataSource,t,i;if(!(n instanceof e.DataManager))for(t=0;t<n.length;t++)"object"!=typeof n&&(i={},i[this.options.field]=n[t],n[t]=i)},n.prototype.updateModel=function(n){this.options=n;this.existingPredicate=n.actualPredicate||{};this.options.dataSource=n.dataSource;this.options.dataManager=n.dataManager?n.dataManager:n.dataSource;this.updateDataSource();this.options.type=n.type;this.options.format=n.format||"";this.options.ignoreAccent=n.ignoreAccent||!1;this.options.filteredColumns=n.filteredColumns||this.parent.filterSettings.columns;this.options.query=n.query||new e.Query;this.options.allowCaseSensitive=n.allowCaseSensitive||!1;this.options.uid=n.column.uid;this.values={};this.localeObj=n.localeObj;this.isFiltered=n.filteredColumns.length},n.prototype.getAndSetChkElem=function(n){if(this.dlg=this.parent.createElement("div",{id:this.id+this.options.type+"_excelDlg",attrs:{uid:this.options.column.uid},className:"e-checkboxfilter e-filter-popup"}),this.sBox=this.parent.createElement("div",{className:"e-searchcontainer"}),!n.hideSearchbox){this.sInput=this.parent.createElement("input",{id:this.id+"_SearchBox",className:"e-searchinput"});this.sIcon=this.parent.createElement("span",{className:"e-searchclear e-search-icon e-icons e-input-group-icon",attrs:{type:"text",title:this.getLocalizedLabel("Search")}});this.searchBox=this.parent.createElement("span",{className:"e-searchbox e-fields"});this.searchBox.appendChild(this.sInput);this.sBox.appendChild(this.searchBox);var t={element:this.sInput,floatLabelType:"Never",properties:{placeholder:this.getLocalizedLabel("Search")}};rr.Input.createInput(t,this.parent.createElement);this.searchBox.querySelector(".e-input-group").appendChild(this.sIcon)}return this.spinner=this.parent.createElement("div",{className:"e-spinner"}),this.cBox=this.parent.createElement("div",{id:this.id+this.options.type+"_CheckBoxList",className:"e-checkboxlist e-fields"}),this.spinner.appendChild(this.cBox),this.sBox.appendChild(this.spinner),this.sBox},n.prototype.showDialog=function(n){var t={requestType:wc,columnName:this.options.field,columnType:this.options.type,cancel:!1};(!Object(r.isBlazor)()||this.parent.isJsComponent)&&(t.filterModel=this);(this.parent.notify(es,t),t.cancel)||(this.dialogObj=new ft.Dialog({visible:!1,content:this.sBox,close:this.closeDialog.bind(this),width:!Object(r.isNullOrUndefined)(o(n.target,"e-bigger"))||this.parent.element.classList.contains("e-device")?260:255,target:this.parent.element,animationSettings:{effect:"None"},buttons:[{click:this.btnClick.bind(this),buttonModel:{content:this.getLocalizedLabel(this.isExcel?"OKButton":"FilterButton"),cssClass:"e-primary",isPrimary:!0}},{click:this.btnClick.bind(this),buttonModel:{cssClass:"e-flat",content:this.getLocalizedLabel(this.isExcel?"CancelButton":"ClearButton")}}],created:this.dialogCreated.bind(this),open:this.dialogOpen.bind(this)}),this.dialogObj.isStringTemplate=!0,this.dlg.setAttribute("aria-label",this.getLocalizedLabel("ExcelFilterDialogARIA")),this.parent.element.appendChild(this.dlg),this.dialogObj.appendTo(this.dlg),this.dialogObj.element.style.maxHeight=this.options.height+"px",this.dialogObj.show(),this.wireEvents(),Object(ft.createSpinner)({target:this.spinner},this.parent.createElement),Object(ft.showSpinner)(this.spinner),this.getAllData())},n.prototype.dialogCreated=function(n){r.Browser.isDevice?this.dialogObj.position={X:"center",Y:"center"}:ga(this.options.target,this.dialogObj,this.parent);this.parent.notify(re,n)},n.prototype.openDialog=function(n){this.updateModel(n);this.getAndSetChkElem(n);this.showDialog(n)},n.prototype.closeDialog=function(){if(this.dialogObj&&!this.dialogObj.isDestroyed){var t=this.options.columns.filter(function(n){return n.getFilterItemTemplate()}),n=this.parent.registeredTemplate;t.length&&!Object(r.isNullOrUndefined)(n)&&n.filterItemTemplate&&this.parent.destroyTemplate(["filterItemTemplate"]);this.parent.isReact&&(this.parent.destroyTemplate(["filterItemTemplate"]),this.parent.renderTemplates());this.parent.notify(ue,{field:this.options.field});this.dialogObj.destroy();this.unWireEvents();Object(r.remove)(this.dlg);this.dlg=null}},n.prototype.clearFilter=function(){var n={instance:this,handler:this.clearFilter,cancel:!1};this.parent.notify(uf,n);n.cancel||this.options.handler({action:"clear-filter",field:this.options.field})},n.prototype.btnClick=function(n){var t,i,r;this.filterState?("input"===n.target.tagName.toLowerCase()&&n.target.classList.contains("e-searchinput")?(t=n.target.value,"boolean"===this.options.column.type&&(""!==t&&-1!==this.getLocalizedLabel("FilterTrue").toLowerCase().indexOf(t.toLowerCase())?t=!0:""!==t&&-1!==this.getLocalizedLabel("FilterFalse").toLowerCase().indexOf(t.toLowerCase())&&(t=!1)),i={action:"filtering",filterCollection:{field:this.options.field,operator:this.options.isRemote?"string"===this.options.column.type?"contains":"equal":"date"===this.options.column.type||"datetime"===this.options.column.type||"boolean"===this.options.column.type?"equal":"contains",value:t,matchCase:!1,type:this.options.column.type},field:this.options.field},null!=t&&""!==t?this.isForeignColumn(this.options.column)?this.foreignFilter(i,t):this.options.handler(i):this.closeDialog()):13===n.keyCode?this.fltrBtnHandler():(r=n.target.firstChild.textContent.toLowerCase(),this.getLocalizedLabel(this.isExcel?"OKButton":"FilterButton").toLowerCase()===r?this.fltrBtnHandler():this.getLocalizedLabel("ClearButton").toLowerCase()===r&&this.clearFilter()),this.closeDialog()):"input"!==n.target.tagName.toLowerCase()&&(this.clearFilter(),this.closeDialog())},n.prototype.fltrBtnHandler=function(){var u,a,v,t,i=[].slice.call(this.cBox.querySelectorAll(".e-check:not(.e-selectall)")),y=i,p="equal",h=this.searchBox.querySelector(".e-searchinput"),w=this.options.allowCaseSensitive,f={field:this.options.field,predicate:"or",uid:this.options.uid,operator:p,type:this.options.type,matchCase:w,ignoreAccent:this.options.ignoreAccent},c=this.itemsCnt!==i.length&&this.itemsCnt-i.length<i.length,e,s,l;if(c&&""===h.value&&(p="notequal",i=[].slice.call(this.cBox.querySelectorAll(".e-uncheck:not(.e-selectall)")),f.predicate="and",f.operator="notequal"),e=[],i.length!==this.itemsCnt||h.value&&""!==h.value){for(s=0;s<i.length;s++)if(u=this.values[o(i[s],"e-ftrchk").getAttribute("uid")],t=Object(r.extend)({},{value:u},f),u&&!u.toString().length&&(t.operator=c?"notequal":"equal"),""===u||Object(r.isNullOrUndefined)(u)?e=e.concat(n.generateNullValuePredicates(f)):e.push(t),l={instance:this,handler:this.fltrBtnHandler,arg1:t.field,arg2:t.predicate,arg3:t.operator,arg4:t.matchCase,arg5:t.ignoreAccent,arg6:t.value,cancel:!1},this.parent.notify(uf,l),l.cancel)return;"date"!==this.options.type&&"datetime"!==this.options.type||(v=y.length-1,a=this.values[o(y[v],"e-ftrchk").getAttribute("uid")],Object(r.isNullOrUndefined)(a)&&c&&e.push({field:f.field,matchCase:f.matchCase,operator:"equal",predicate:"and",value:null}));this.initiateFilter(e)}else this.clearFilter()},n.generateNullValuePredicates=function(n){var t=[];return"string"===n.type&&t.push({field:n.field,ignoreAccent:n.ignoreAccent,matchCase:n.matchCase,operator:n.operator,predicate:n.predicate,value:""}),t.push({field:n.field,matchCase:n.matchCase,operator:n.operator,predicate:n.predicate,value:null}),t.push({field:n.field,matchCase:n.matchCase,operator:n.operator,predicate:n.predicate,value:void 0}),t},n.prototype.initiateFilter=function(n){var u,i=n[0],t,f;if(!Object(r.isNullOrUndefined)(i)){for(u=i.ejpredicate?i.ejpredicate:new e.Predicate(i.field,i.operator,i.value,!i.matchCase,i.ignoreAccent),t=1;t<n.length;t++)u=void 0!==n[t].ejpredicate?u[n[t].predicate](n[t].ejpredicate):u[n[t].predicate](n[t].field,n[t].operator,n[t].value,!n[t].matchCase,n[t].ignoreAccent);f={action:"filtering",filterCollection:n,field:this.options.field,ejpredicate:e.Predicate.or(u)};this.options.handler(f)}},n.prototype.isForeignColumn=function(n){return!!n.isForeignColumn&&n.isForeignColumn()},n.prototype.refreshCheckboxes=function(){var t=this,f=this.sInput.value,i=this.options.column,u=this.isForeignColumn(i)?this.foreignKeyQuery.clone():this.options.query.clone(),h=this.options.query.clone(),c=u.queries.filter(function(n){return n&&"onWhere"===n.fn})[0],s,y;u.queries=[];h.queries=[];var o,n="string"!==this.options.type&&parseFloat(f)?parseFloat(f):f,a=this.options.isRemote?"string"===this.options.type?"contains":"equal":this.options.type?"contains":"equal",p=this.options.ignoreAccent,v=this.isForeignColumn(i)?i.foreignKeyValue:i.field;n=""===n||void 0===n?void 0:n;s=this.options.dataManager.adaptor.getModuleName;"boolean"===this.options.type&&(void 0!==n&&-1!==this.getLocalizedLabel("FilterTrue").toLowerCase().indexOf(n.toLowerCase())&&s?(s(),n=!0):void 0!==n&&-1!==this.getLocalizedLabel("FilterFalse").toLowerCase().indexOf(n.toLowerCase())&&s&&(s(),n=!1),a="equal");"date"!==this.options.type&&"datetime"!==this.options.type||(n=this.valueFormatter.fromView(f,this.options.parserFn,this.options.type));this.addDistinct(u);y={requestType:ip,filterModel:this,columnName:v,column:i,operator:a,matchCase:!0,ignoreAccent:p,filterChoiceCount:null,query:u,value:n};Object(r.isBlazor)()&&!this.parent.isJsComponent&&(y.filterModel={});this.parent.trigger(l,y,function(s){if(s.operator=Object(r.isBlazor)()&&"none"!==s.excelSearchOperator?s.excelSearchOperator:s.operator,o=new e.Predicate(v,s.operator,n,s.matchCase,s.ignoreAccent),"date"===t.options.type||"datetime"===t.options.type){if(a="equal",Object(r.isNullOrUndefined)(n)&&f.length)return;o=ir({field:v,operator:a,value:n,matchCase:!0,ignoreAccent:p},t.options.type)}f.length?(o=Object(r.isNullOrUndefined)(c)?o:o.and(c.e),u.where(o)):Object(r.isNullOrUndefined)(c)||u.where(c.e);s.filterChoiceCount=Object(r.isNullOrUndefined)(s.filterChoiceCount)?1e3:s.filterChoiceCount;var l={};(Object(ft.showSpinner)(t.spinner),t.renderEmpty=!1,t.isForeignColumn(i)&&f.length)?("result"in i.dataSource?new e.DataManager(i.dataSource.result):i.dataSource).executeQuery(u).then(function(n){var r=t.options.column.columnData;t.options.column.columnData=n.result;t.parent.notify(iu,{predicate:l,column:i});l.predicate.predicates.length?h.where(l.predicate):t.renderEmpty=!0;t.options.column.columnData=r;h.take(s.filterChoiceCount);t.search(s,h)}):(u.take(s.filterChoiceCount),t.search(s,u))})},n.prototype.search=function(n,t){this.parent.dataSource&&"result"in this.parent.dataSource?this.filterEvent(n,t):this.processSearch(t)},n.prototype.getPredicateFromCols=function(t){for(var r,u,s=n.getPredicate(t),i=[],f={},h=void 0!==this.parent.getForeignKeyColumns,l=h?this.parent.getForeignKeyColumns():[],o=0,c=Object.keys(s);o<c.length;o++)r=c[o],u=void 0,h&&this.parent.getColumnByField(r).isForeignColumn()&&(u=af(r,l)),u?(this.parent.notify(iu,{predicate:f,column:u}),f.predicate.predicates.length&&i.push(e.Predicate.or(f.predicate.predicates))):i.push(s[r]);return i.length&&e.Predicate.and(i)},n.prototype.getQuery=function(){return this.parent.getQuery?this.parent.getQuery().clone():new e.Query},n.prototype.getAllData=function(){var t=this,n=this.getQuery(),i;n.requiresCount();this.addDistinct(n);i={requestType:yc,query:n,filterChoiceCount:null};(!Object(r.isBlazor)()||this.parent.isJsComponent)&&(i.filterModel=this);this.parent.trigger(l,i,function(i){i.filterChoiceCount=Object(r.isNullOrUndefined)(i.filterChoiceCount)?1e3:i.filterChoiceCount;n.take(i.filterChoiceCount);t.parent.dataSource&&"result"in t.parent.dataSource?t.filterEvent(i,n):t.processDataOperation(n,!0)})},n.prototype.addDistinct=function(n){var t=e.DataUtil.distinct(this.options.filteredColumns,"field");return t.indexOf(this.options.column.field)<=-1&&(t=t.concat(this.options.column.field)),n.distinct(t),n},n.prototype.filterEvent=function(n,t){var r=this,i=ah(n,t);this.parent.trigger(nf,i.state);i.deffered.promise.then(function(n){r.dataSuccess(n)})},n.prototype.processDataOperation=function(n,t){var o=this,i,r,u,f;this.options.dataSource=this.options.dataSource instanceof e.DataManager?this.options.dataSource:new e.DataManager(this.options.dataSource);i=[];r=[];this.isForeignColumn(this.options.column)&&t&&(u="result"in this.options.column.dataSource?new e.DataManager(this.options.column.dataSource.result):this.options.column.dataSource,this.foreignKeyQuery.params=n.params,i.push(u.executeQuery(this.foreignKeyQuery)),r.push(function(n){return o.foreignKeyData=n}));i.push(this.options.dataSource.executeQuery(n));r.push(this.dataSuccess.bind(this));f=0;Promise.all(i).then(function(n){for(var t=0;t<n.length;t++)r[f++](n[t].result)})},n.prototype.dataSuccess=function(t){var u,s,i,a,h,f,o,c,v,y,p,l;if(this.fullData=t,u={dataSource:this.fullData,executeQuery:!0,field:this.options.field},this.parent.notify(aw,u),u.executeQuery){if(s=new e.Query,this.parent.searchSettings&&this.parent.searchSettings.key.length&&(i=this.parent.searchSettings,a=i.fields.length?i.fields:this.options.columns.map(function(n){return n.field}),s.search(i.key,a,i.operator,i.ignoreCase,i.ignoreAccent)),this.options.filteredColumns.length){for(h=[],f=0;f<this.options.filteredColumns.length;f++)o=this.options.filteredColumns[f],this.options.uid?(o.uid=o.uid||this.parent.getColumnByField(o.field).uid,o.uid!==this.options.uid&&h.push(this.options.filteredColumns[f])):o.field!==this.options.field&&h.push(this.options.filteredColumns[f]);c=this.getPredicateFromCols(h);c&&s.where(c)}v=new e.DataManager(u.dataSource).executeLocal(s);y=this.options.column;this.filteredData=n.getDistinct(v,this.options.field,y,this.foreignKeyData).records||[]}p=u.executeQuery?this.filteredData:u.dataSource;this.processDataSource(null,!0,p);this.sInput.focus();l={requestType:pc,columnName:this.options.field,columnType:this.options.type};(!Object(r.isBlazor)()||this.parent.isJsComponent)&&(l.filterModel=this);this.parent.notify(oe,l)},n.prototype.processDataSource=function(n,t,i){Object(ft.showSpinner)(this.spinner);this.updateResult();this.createFilterItems(i,t)},n.prototype.processSearch=function(n){this.processDataOperation(n)},n.prototype.updateResult=function(){var t,i,n,r,u;for(this.result={},t=this.getPredicateFromCols(this.options.filteredColumns),i=new e.Query,t&&i.where(t),n=0,r=new e.DataManager(this.fullData).executeLocal(i);n<r.length;n++)u=r[n],this.result[k(this.options.field,u)]=!0},n.prototype.clickHandler=function(n){var r=n.target,t=o(r,"e-checkbox-wrapper"),i;(o(r,"e-searchbox")&&this.searchBoxClick(n),t)&&(i=t.querySelector(".e-selectall"),i?this.updateAllCBoxes(!i.classList.contains("e-check")):tv(t.parentElement),this.updateIndeterminatenBtn(),t.querySelector(".e-chk-hidden").focus());this.setFocus(o(t,"e-ftrchk"))},n.prototype.keyupHandler=function(n){this.setFocus(o(n.target,"e-ftrchk"))},n.prototype.setFocus=function(n){var t=this.dlg.querySelector(".e-chkfocus");t&&t.classList.remove("e-chkfocus");n&&n.classList.add("e-chkfocus")},n.prototype.updateAllCBoxes=function(n){for(var r,t=0,i=[].slice.call(this.cBox.querySelectorAll(".e-frame"));t<i.length;t++)r=i[t],lf(r,n),wr(r.previousSibling,n)},n.prototype.dialogOpen=function(){this.parent.element.classList.contains("e-device")&&(this.dialogObj.element.querySelector(".e-input-group").classList.remove("e-input-focus"),this.dialogObj.element.querySelector(".e-btn").focus())},n.prototype.createCheckbox=function(n,t,i){var f=t?this.cBoxTrue.cloneNode(!0):this.cBoxFalse.cloneNode(!0),u,e;return wr(f.querySelector("input"),t),u=f.querySelector(".e-label"),e=ro({},i,{column:this.options.column,parent:this.parent}),(u.innerHTML=!Object(r.isNullOrUndefined)(n)&&n.toString().length?n:this.getLocalizedLabel("Blanks"),Object(r.addClass)([u],["e-checkboxfiltertext"]),this.options.template&&i[this.options.column.field]!==this.getLocalizedLabel("SelectAll"))&&(u.innerHTML="",this.parent.isReact&&this.options.column.filter&&"string"!=typeof this.options.column.filter.itemTemplate?(this.options.template(e,this.parent,"filterItemTemplate",null,null,null,u),this.parent.renderTemplates()):rt(u,this.options.template(e,this.parent,"filterItemTemplate"))),f},n.prototype.updateIndeterminatenBtn=function(){var e=this.cBox.children.length-1,t=[],u=this.cBox.querySelector(".e-selectall"),f=this.cBox.querySelectorAll(".e-check:not(.e-selectall)").length,i=this.dialogObj.btnObj[0],n;i.disabled=!1;n=u.previousSibling;wr(n,!1);n.indeterminate=!1;e===f?(t=["e-check"],wr(n,!0)):f?(t=["e-stop"],n.indeterminate=!0):(t=["e-uncheck"],i.disabled=!0);this.filterState=!i.disabled;i.dataBind();Object(r.removeClass)([u],["e-check","e-stop","e-uncheck"]);Object(r.addClass)([u],t)},n.prototype.createFilterItems=function(n){for(var c,o,b,l,s,i,a,k,v,y,u=this.parent.createElement("div"),f=this.dialogObj.btnObj[0],h=-1,t=0;t<n.length;t++)c=Object(r.getValue)("ejValue",n[t]),(""===c||Object(r.isNullOrUndefined)(c))&&(h+=1);if(this.itemsCnt=-1!==h?n.length-h:n.length,n.length&&!this.renderEmpty){var p=this.getLocalizedLabel("SelectAll"),d=this.createCheckbox(p,!1,((y={})[this.options.field]=p,y)),w=oh(ei("cbox"),d,"e-ftrchk");for(w.querySelector(".e-frame").classList.add("e-selectall"),u.appendChild(w),o=new e.Predicate("field","equal",this.options.field),this.options.foreignKeyValue&&(o=o.or("field","equal",this.options.foreignKeyValue)),b=new e.DataManager(this.options.filteredColumns).executeLocal((new e.Query).where(o)).length,l=void 0,t=0;t<n.length;t++){if(s=ei("cbox"),this.values[s]=Object(r.getValue)("ejValue",n[t]),i=Object(r.getValue)(this.options.field,n[t]),this.options.formatFn&&(i=this.valueFormatter.toView(i,this.options.formatFn)),a={value:i,column:this.options.column,data:n[t]},this.parent.notify(ow,a),""===(i=a.value)||Object(r.isNullOrUndefined)(i)){if(l)continue;l=!0}k=this.createCheckbox(i,this.getCheckedState(b,this.values[s]),Object(r.getValue)("dataObj",n[t]));u.appendChild(oh(s,k,"e-ftrchk"))}this.cBox.innerHTML="";rt(this.cBox,[].slice.call(u.children));this.updateIndeterminatenBtn();f.disabled=!1}else u.appendChild(this.parent.createElement("span",{innerHTML:this.getLocalizedLabel("NoResult")})),this.cBox.innerHTML="",rt(this.cBox,[].slice.call(u.children)),f.disabled=!0;this.filterState=!f.disabled;f.dataBind();v={requestType:yc,dataSource:this.renderEmpty||Object(r.isBlazor)()&&this.parent.isServerRendered?[]:n};(!Object(r.isBlazor)()||this.parent.isJsComponent)&&(v.filterModel=this);this.parent.notify(oe,v);Object(ft.hideSpinner)(this.spinner)},n.prototype.getCheckedState=function(n,t){return!this.isFiltered||!n||this.result[t]},n.getDistinct=function(n,t,i,u){for(var o,h,f,s=n.length,c=[],l={},a=!(!i||!i.isForeignColumn)&&i.isForeignColumn();s--;)(f=k(t,f=n[s]))in l||(o={},(o.ejValue=f,l[f]=!0,a)&&(h=tr(i,{},f,u)[0],Object(r.setValue)(ll,h,n[s]),f=Object(r.getValue)(i.foreignKeyValue,h)),Object(r.setValue)(t,Object(r.isNullOrUndefined)(f)?null:f,o),Object(r.setValue)("dataObj",n[s],o),c.push(o));return e.DataUtil.group(e.DataUtil.sort(c,t,e.DataUtil.fnAscending),"ejValue")},n.getPredicate=function(t){for(var r=e.DataUtil.distinct(t,"field",!0)||[],u=[],f={},i=0;i<r.length;i++)0!==(u=new e.DataManager(t).executeLocal((new e.Query).where("field","equal",r[i].field))).length&&(f[r[i].field]=n.generatePredicate(u));return f},n.generatePredicate=function(t){var f,u,o=t?t.length:0,i;for((u=n.updateDateFilter(t[0])).ignoreAccent=!Object(r.isNullOrUndefined)(u.ignoreAccent)&&u.ignoreAccent,f="date"===u.type||"datetime"===u.type?ir(u,u.type):u.ejpredicate?u.ejpredicate:new e.Predicate(u.field,u.operator,u.value,!n.getCaseValue(u),u.ignoreAccent),i=1;i<o;i++)t[i]=n.updateDateFilter(t[i]),o>2&&i>1&&"or"===t[i].predicate?"date"===t[i].type||"datetime"===t[i].type?f.predicates.push(ir(t[i],t[i].type)):f.predicates.push(new e.Predicate(t[i].field,t[i].operator,t[i].value,!n.getCaseValue(t[i]),t[i].ignoreAccent)):f="date"===t[i].type||"datetime"===t[i].type?"and"===t[i].predicate&&"equal"===t[i].operator?f.or(ir(t[i],t[i].type),t[i].type,t[i].ignoreAccent):f[t[i].predicate](ir(t[i],t[i].type),t[i].type,t[i].ignoreAccent):t[i].ejpredicate?f[t[i].predicate](t[i].ejpredicate):f[t[i].predicate](t[i].field,t[i].operator,t[i].value,!n.getCaseValue(t[i]),t[i].ignoreAccent);return f||null},n.getCaseValue=function(n){return Object(r.isNullOrUndefined)(n.matchCase)?!("string"===n.type||Object(r.isNullOrUndefined)(n.type)&&"string"==typeof n.value):n.matchCase},n.updateDateFilter=function(n){return("date"===n.type||"datetime"===n.type||n.value instanceof Date)&&(n.type=n.type||"date"),n},n}(),li=i(5),vu=i(7),yf=i(8),iit=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),ak=function(n){function t(t,i){var r=n.call(this,t)||this;return r.customFilterOperators=i,r.isExcel=!0,r}return iit(t,n),t.prototype.getCMenuDS=function(n,t){var i={number:["Equal","NotEqual","","LessThan","LessThanOrEqual","GreaterThan","GreaterThanOrEqual","Between","","CustomFilter"],string:["Equal","NotEqual","","StartsWith","EndsWith","","Contains","","CustomFilter"]},u,r;for(i.date=i.number,i.datetime=i.number,u=[],r=0;r<i[n].length;r++)i[n][r].length?t?u.push({text:this.getLocalizedLabel(i[n][r])+"...",iconCss:"e-icons e-icon-check "+(t===i[n][r].toLowerCase()?"":"e-emptyicon")}):u.push({text:this.getLocalizedLabel(i[n][r])+"..."}):u.push({separator:!0});return u},t.prototype.destroy=function(){this.dlg&&(this.unwireExEvents(),n.prototype.destroy.call(this));this.cmenu&&this.cmenu.parentElement&&Object(r.remove)(this.cmenu)},t.prototype.createMenu=function(n,t,i,r){var u,f,s;if(this.menu=this.parent.createElement("div",{className:"e-contextmenu-wrapper"}),this.parent.enableRtl?this.menu.classList.add("e-rtl"):this.menu.classList.remove("e-rtl"),u=this.parent.createElement("ul"),f=t?"e-excl-filter-icon e-filtered":"e-excl-filter-icon",this.parent.allowSorting){var e=this.parent.getColumnHeaderByUid(r.uid).getAttribute("aria-sort"),o=this.parent.getColumnByField(r.field).allowSorting,h=o&&"Ascending"!==e?"e-excel-ascending":"e-disabled e-excel-ascending",c=o&&"Descending"!==e?"e-excel-descending":"e-disabled e-excel-descending",l="string"===n?this.getLocalizedLabel("SortAtoZ"):"datetime"===n||"date"===n?this.getLocalizedLabel("SortByOldest"):this.getLocalizedLabel("SortSmallestToLargest"),a="string"===n?this.getLocalizedLabel("SortZtoA"):"datetime"===n||"date"===n?this.getLocalizedLabel("SortByNewest"):this.getLocalizedLabel("SortLargestToSmallest");u.appendChild(this.createMenuElem(l,h,"e-sortascending"));u.appendChild(this.createMenuElem(a,c,"e-sortdescending"));s=this.parent.createElement("li",{className:"e-separator e-menu-item e-excel-separator"});u.appendChild(s)}u.appendChild(this.createMenuElem(this.getLocalizedLabel("ClearFilter"),t?"":"e-disabled",f));"boolean"!==n&&u.appendChild(this.createMenuElem(this.getLocalizedLabel({string:"TextFilter",date:"DateFilter",datetime:"DateTimeFilter",number:"NumberFilter"}[n]),"e-submenu",i&&this.ensureTextFilter()?"e-icon-check":f+" e-emptyicon",!0));this.menu.appendChild(u);this.parent.notify(fw,{element:this.menu})},t.prototype.createMenuElem=function(n,t,i,r){var u=this.parent.createElement("li",{className:t+" e-menu-item"});return u.innerHTML=n,u.insertBefore(this.parent.createElement("span",{className:"e-menu-icon e-icons "+i}),u.firstChild),r&&u.appendChild(this.parent.createElement("span",{className:"e-icons e-caret"})),u},t.prototype.wireExEvents=function(){r.EventHandler.add(this.dlg,"mouseover",this.hoverHandler,this);r.EventHandler.add(this.dlg,"click",this.clickExHandler,this)},t.prototype.unwireExEvents=function(){r.EventHandler.remove(this.dlg,"mouseover",this.hoverHandler);r.EventHandler.remove(this.dlg,"click",this.clickExHandler)},t.prototype.clickExHandler=function(n){var t=o(n.target,"e-menu-item");t&&this.getLocalizedLabel("ClearFilter")===t.innerText.trim()&&(this.clearFilter(),this.closeDialog())},t.prototype.destroyCMenu=function(){this.menuObj&&!this.menuObj.isDestroyed&&(this.menuObj.destroy(),Object(r.remove)(this.cmenu))},t.prototype.hoverHandler=function(n){var u,a=n.target.querySelector(".e-contextmenu"),i=o(n.target,"e-menu-item"),c=this.menu.querySelector(".e-focused"),f,e,l,s,t,h;(c&&c.classList.remove("e-focused"),i&&(i.classList.add("e-focused"),u=i.classList.contains("e-submenu")),a)||(u||(f=this.menu.querySelector(".e-submenu"),Object(r.isNullOrUndefined)(f)||f.classList.remove("e-selected"),this.isCMenuOpen=!1,this.destroyCMenu()),e=this.ensureTextFilter(),!this.isCMenuOpen&&u&&(i.classList.add("e-selected"),this.isCMenuOpen=!0,l={items:this.getCMenuDS(this.options.type,e?e.replace(/\s/g,""):void 0),select:this.selectHandler.bind(this),onClose:this.destroyCMenu.bind(this),enableRtl:this.parent.enableRtl,beforeClose:this.preventClose},this.parent.element.appendChild(this.cmenu),this.menuObj=new yf.ContextMenu(l,this.cmenu),s=this.menu.querySelector(".e-submenu").getBoundingClientRect(),t={top:0,left:0},r.Browser.isDevice?(h=this.getContextBounds(this.menuObj),t.top=(window.innerHeight-h.height)/2,t.left=(window.innerWidth-h.width)/2,this.closeDialog()):(t.top=r.Browser.isIE?window.pageYOffset+s.top:window.scrollY+s.top,t.left=this.getCMenuYPosition(this.dlg,this.menuObj)),this.menuObj.open(t.top,t.left,n.target),vf(this.parent.element,this.menuObj.element.parentElement)))},t.prototype.ensureTextFilter=function(){var t,n=this.existingPredicate[this.options.field];return n&&2===n.length?t="greaterthanorequal"===n[0].operator&&"lessthanorequal"===n[1].operator?"between":"customfilter":n&&1===n.length&&(this.optrData=this.customFilterOperators[this.options.type+"Operator"],t=n[0].operator),t},t.prototype.preventClose=function(n){n.event instanceof MouseEvent&&n.event.target.classList.contains("e-submenu")&&(n.cancel=!0)},t.prototype.getContextBounds=function(){return this.menuObj.element.style.display,this.menuObj.element.style.display="block",this.menuObj.element.getBoundingClientRect()},t.prototype.getCMenuYPosition=function(n,t){var u=this.getContextBounds(t).width,r=n.getBoundingClientRect(),f=r.right+u-this.parent.element.clientWidth,i=n.offsetWidth-n.clientWidth;return i=i?i+1:0,f<1?r.right+1-i:r.left-u-1+i},t.prototype.openDialog=function(n){var i=this,t;this.updateModel(n);this.getAndSetChkElem(n);this.showDialog(n);this.dialogObj.dataBind();t=this.existingPredicate[n.field]&&this.existingPredicate[n.field].length||this.options.filteredColumns.filter(function(n){return i.options.field===n.field}).length;this.createMenu(n.type,t>0,1===t||2===t,n);this.dlg.insertBefore(this.menu,this.dlg.firstChild);this.dlg.classList.add("e-excelfilter");this.parent.enableRtl&&this.dlg.classList.add("e-rtl");this.dlg.classList.remove("e-checkboxfilter");this.cmenu=this.parent.createElement("ul",{className:"e-excel-menu"});this.wireExEvents()},t.prototype.closeDialog=function(){n.prototype.closeDialog.call(this)},t.prototype.selectHandler=function(n){n.item&&(this.menuItem=n.item,this.renderDialogue(n))},t.prototype.renderDialogue=function(n){var i=this,e=n.element,t=this.options.field,u=!Object(r.isNullOrUndefined)(t)&&nr(t),f=!Object(r.isNullOrUndefined)(t)&&b(t),o=this.parent.createElement("div",{className:"e-xlfl-maindiv",id:u?f+"-xlflmenu":t+"-xlflmenu"});this.dlgDiv=this.parent.createElement("div",{className:"e-xlflmenu",id:u?f+"-xlfldlg":t+"-xlfldlg"});this.parent.element.appendChild(this.dlgDiv);this.dlgObj=new ft.Dialog({header:this.getLocalizedLabel("CustomFilter"),isModal:!0,overlayClick:this.removeDialog.bind(this),showCloseIcon:!0,closeOnEscape:!1,target:document.body,visible:!1,enableRtl:this.parent.enableRtl,open:function(){var n=i.dlgObj.element.querySelector("table.e-xlfl-table>tr");i.options.column.filterTemplate?Object(r.isBlazor)()?n.querySelector(".e-xlfl-valuediv").children[0].focus():n.querySelector("#"+i.options.column.field+"-xlfl-frstvalue").focus():n.cells[1].querySelector("input:not([type=hidden])").focus()},close:this.removeDialog.bind(this),created:this.createdDialog.bind(this,e,t),buttons:[{click:this.filterBtnClick.bind(this,t),buttonModel:{content:this.getLocalizedLabel("OKButton"),isPrimary:!0,cssClass:"e-xlfl-okbtn"}},{click:this.removeDialog.bind(this),buttonModel:{content:this.getLocalizedLabel("CancelButton"),cssClass:"e-xlfl-cancelbtn"}}],content:o,width:430,animationSettings:{effect:"None"}});this.dlgObj.isStringTemplate=!0;this.dlgDiv.setAttribute("aria-label",this.getLocalizedLabel("CustomFilterDialogARIA"));this.dlgObj.appendTo(this.dlgDiv)},t.prototype.removeDialog=function(){var t,n,i;if(Object(r.isBlazor)())for(t=this.options.columns||[],n=0;n<t.length;n++)t[n].filterTemplate&&(i=this.parent.element.id+t[n].uid+"filterTemplate",Object(r.updateBlazorTemplate)(i,"FilterTemplate",t[n]));this.parent.isReact&&(this.parent.destroyTemplate(["filterTemplate"]),this.parent.renderTemplates());this.removeObjects([this.dropOptr,this.datePicker,this.dateTimePicker,this.actObj,this.numericTxtObj,this.dlgObj]);Object(r.remove)(this.dlgDiv)},t.prototype.createdDialog=function(n,t){this.renderCustomFilter(n,t);this.dlgObj.element.style.left="0px";this.dlgObj.element.style.top="0px";r.Browser.isDevice&&window.innerWidth<440&&(this.dlgObj.element.style.width="90%");this.parent.notify(uw,{column:t,dialog:this.dialogObj});this.dlgObj.show();vf(this.parent.element,this.dlgObj.element.parentElement)},t.prototype.renderCustomFilter=function(n,t){var i=this.dlgObj.element.querySelector(".e-xlfl-maindiv"),u=this.parent.createElement("div",{innerHTML:this.getLocalizedLabel("ShowRowsWhere"),className:"e-xlfl-dlgfields"}),r;i.appendChild(u);r=this.parent.createElement("div",{innerHTML:this.options.displayName,className:"e-xlfl-fieldset"});i.appendChild(r);this.renderFilterUI(t,i)},t.prototype.filterBtnClick=function(n){var u,o=!Object(r.isNullOrUndefined)(n)&&nr(n),s=!Object(r.isNullOrUndefined)(n)&&b(n),t=o?s:n,h=this.options.column.filterTemplate&&Object(r.isBlazor)()?this.dlgDiv.querySelector(".-xlfl-frstvalue").children[0].querySelector(".e-control").ej2_instances[0]:this.dlgDiv.querySelector("#"+t+"-xlfl-frstvalue").ej2_instances[0],c=this.dlgDiv.querySelector("#"+t+"-xlfl-frstoptr").ej2_instances[0],f=this.options.column.filterTemplate&&Object(r.isBlazor)()?this.dlgDiv.querySelector(".-xlfl-secndvalue").children[0].querySelector(".e-control").ej2_instances[0]:this.dlgDiv.querySelector("#"+t+"-xlfl-secndvalue").ej2_instances[0],l=this.dlgDiv.querySelector("#"+t+"-xlfl-secndoptr").ej2_instances[0],e,i;"string"===this.options.type&&(u=this.dlgDiv.querySelector("#"+t+"-xlflmtcase").ej2_instances[0].checked);e=this.dlgDiv.querySelector("#"+t+"e-xlfl-frstpredicate").ej2_instances[0];i=(this.dlgDiv.querySelector("#"+t+"e-xlfl-secndpredicate").ej2_instances[0],e.checked?"and":"or");null===f.value&&(i="or");this.filterByColumn(this.options.field,c.value,h.value,i,u,this.options.ignoreAccent,l.value,f.value);this.removeDialog()},t.prototype.filterByColumn=function(n,t,i,u,f,o,s,h){var c,v=this.parent.getColumnByField?this.parent.getColumnByField(n):this.options.column,a=this.isForeignColumn(v)?v.foreignKeyValue:n,l=[],y,p;l.push({field:a,predicate:u,matchCase:f,ignoreAccent:o,operator:t,value:i,type:this.options.type});y={instance:this,handler:this.filterByColumn,arg1:n,arg2:t,arg3:i,arg4:u,arg5:f,arg6:o,arg7:s,arg8:h,cancel:!1};(this.parent.notify(uf,y),y.cancel)||(c=new e.Predicate(a,t.toLowerCase(),i,!f,o),Object(r.isNullOrUndefined)(h)||Object(r.isNullOrUndefined)(s)||(l.push({field:a,predicate:u,matchCase:f,ignoreAccent:o,operator:s,value:h,type:this.options.type}),c=c[u](a,s.toLowerCase(),h,!f,o)),p={action:"filtering",filterCollection:l,field:this.options.field,ejpredicate:c,actualPredicate:l},this.isForeignColumn(v)?this.foreignKeyFilter(p,l,c):this.options.handler(p))},t.prototype.renderOperatorUI=function(n,t,i,u,f){var s=this.parent.createElement("tr",{className:"e-xlfl-fields"}),h,v,c,e,o,y;t.appendChild(s);h=this.parent.createElement("td",{className:"e-xlfl-optr"});s.appendChild(h);var l=this.parent.createElement("div",{className:"e-xlfl-optrdiv"}),p=!Object(r.isNullOrUndefined)(n)&&nr(n),w=!Object(r.isNullOrUndefined)(n)&&b(n),a=this.parent.createElement("input",{id:p?w+i:n+i});return l.appendChild(a),h.appendChild(l),v=this.options.type+"Operator",c=this.customFilterOperators[v],this.optrData=c,e=this.dropSelectedVal(this.options.column,u,f),o="",this.menuItem&&((o=this.menuItem.text.slice(0,-3))!==this.getLocalizedLabel("CustomFilter")&&(e=f?o:void 0),o===this.getLocalizedLabel("Between")&&(e=this.getLocalizedLabel(f?"GreaterThanOrEqual":"LessThanOrEqual"))),y=this.options.column,this.dropOptr=new li.DropDownList(cu({dataSource:c,fields:{text:"text",value:"value"},text:e,open:this.dropDownOpen.bind(this),enableRtl:this.parent.enableRtl,change:this.dropDownValueChange.bind(this)},y.filter.params)),this.dropOptr.appendTo(a),{fieldElement:s,operator:this.getSelectedValue(e)}},t.prototype.dropDownOpen=function(n){n.popup.element.style.zIndex=(this.dialogObj.zIndex+1).toString()},t.prototype.dropDownValueChange=function(n){n.element.id.includes("-xlfl-frstoptr")?this.firstOperator=n.value.toString():this.secondOperator=n.value.toString()},t.prototype.getFilterUIInfo=function(){return{firstOperator:this.firstOperator,secondOperator:this.secondOperator,field:this.options.field}},t.prototype.getSelectedValue=function(n){var t=new e.DataManager(this.optrData).executeLocal((new e.Query).where("text","equal",n));return Object(r.isNullOrUndefined)(t[0])?"":t[0].value},t.prototype.dropSelectedVal=function(n,t,i){var r;return r=t&&t.length>0?2===t.length?i?t[0].operator:t[1].operator:i?t[0].operator:void 0:i&&"string"===n.type&&!n.filter.operator?"startswith":i?n.filter.operator||"equal":void 0,this.getSelectedText(r)},t.prototype.getSelectedText=function(n){var t=new e.DataManager(this.optrData).executeLocal((new e.Query).where("value","equal",n));return Object(r.isNullOrUndefined)(t[0])?"":t[0].text},t.prototype.renderFilterUI=function(n,t){var r=this.existingPredicate[n],u=this.parent.createElement("table",{className:"e-xlfl-table"}),f,i,e;t.appendChild(u);f=this.parent.createElement("colGroup");f.innerHTML='<col style="width: 50%"><\/col><col style="width: 50%"><\/col>';u.appendChild(f);i=this.renderOperatorUI(n,u,"-xlfl-frstoptr",r,!0);this.firstOperator=i.operator;this.renderFlValueUI(n,i,"-xlfl-frstvalue",r,!0);e=this.parent.createElement("tr",{className:"e-xlfl-predicate"});u.appendChild(e);this.renderRadioButton(n,e,r);i=this.renderOperatorUI(n,u,"-xlfl-secndoptr",r,!1);this.secondOperator=i.operator;this.renderFlValueUI(n,i,"-xlfl-secndvalue",r,!1)},t.prototype.renderRadioButton=function(n,t,i){var e=this.parent.createElement("td",{className:"e-xlfl-radio",attrs:{colSpan:"2"}}),u,f;t.appendChild(e);var o=this.parent.createElement("div",{className:"e-xlfl-radiodiv",attrs:{style:"display: inline-block"}}),s=!Object(r.isNullOrUndefined)(n)&&nr(n),h=!Object(r.isNullOrUndefined)(n)&&b(n),c=this.parent.createElement("input",{id:s?h+"e-xlfl-frstpredicate":n+"e-xlfl-frstpredicate",attrs:{type:"radio"}}),l=this.parent.createElement("input",{id:s?h+"e-xlfl-secndpredicate":n+"e-xlfl-secndpredicate",attrs:{type:"radio"}});o.appendChild(c);o.appendChild(l);e.appendChild(o);"string"===this.options.type&&this.renderMatchCase(n,t,e,"-xlflmtcase",i);u=new gt.RadioButton({label:this.getLocalizedLabel("AND"),name:"default",cssClass:"e-xlfl-radio-and",checked:!0,enableRtl:this.parent.enableRtl});f=new gt.RadioButton({label:this.getLocalizedLabel("OR"),name:"default",cssClass:"e-xlfl-radio-or",enableRtl:this.parent.enableRtl});"and"===(i&&2===i.length?i[1].predicate:"and")?(u.checked=!0,f.checked=!1):(f.checked=!0,u.checked=!1);u.appendTo(c);f.appendTo(l)},t.prototype.removeObjects=function(n){for(var i,t=0,r=n;t<r.length;t++)i=r[t],i&&!i.isDestroyed&&i.destroy()},t.prototype.renderFlValueUI=function(n,t,i,u,f){var l=this.parent.createElement("td",{className:"e-xlfl-value"}),o,s,w,h,a,v,c;t.fieldElement.appendChild(l);var y=!Object(r.isNullOrUndefined)(n)&&nr(n),p=!Object(r.isNullOrUndefined)(n)&&b(n),e=this.parent.createElement("div",{className:"e-xlfl-valuediv"}),k=this.options.filteredColumns.some(function(t){return n===t.field}),d=this.options.filteredColumns.filter(function(t){return t.field===n});this.options.column.filterTemplate?(o={},s=this.options.column,k&&i&&(o=this.getExcelFilterData(i,o,s,u,d)),w=this.parent.isReact&&"string"!=typeof this.options.column.filterTemplate,h=this.parent.element.id+s.uid+"filterTemplate",w?(this.options.column.getFilterTemplate()(o,this.parent,"filterTemplate",h,null,null,e),this.parent.renderTemplates()):rt(e,this.options.column.getFilterTemplate()(o,this.parent,"filterTemplate",h)),Object(r.isBlazor)()?(e.children[0].classList.add(i),this.dlgDiv.querySelectorAll(".e-xlfl-value").length>1&&Object(r.updateBlazorTemplate)(h,"FilterTemplate",s)):e.children[0].id=y?p+i:n+i,l.appendChild(e)):(a=this.parent.createElement("input",{id:y?p+i:n+i}),e.appendChild(a),l.appendChild(e),v=void 0,c=void 0,u&&u.length>0&&(v=(c=2===u.length?f?u[0]:u[1]:f?u[0]:void 0)&&c.operator===t.operator?c.value:void 0),{string:this.renderAutoComplete.bind(this),number:this.renderNumericTextBox.bind(this),date:this.renderDate.bind(this),datetime:this.renderDateTime.bind(this)}[this.options.type](this.options,n,a,v,this.parent.enableRtl))},t.prototype.getExcelFilterData=function(n,t,i,r,u){var e="-xlfl-frstvalue"===n?0:1,f;return("-xlfl-frstvalue"===n||u.length>1)&&(t={column:r instanceof Array?r[e]:r},f=this.options.column.columnData&&u.length>1?1===this.options.column.columnData.length?0:1:e,t[this.options.field]=i.foreignKeyValue?this.options.column.columnData[f][i.foreignKeyValue]:u[f].value,this.options.foreignKeyValue&&(t[this.options.foreignKeyValue]=this.options.column.columnData[f][i.foreignKeyValue])),t},t.prototype.renderMatchCase=function(n,t,i,u,f){var e=this.parent.createElement("div",{className:"e-xlfl-matchcasediv",attrs:{style:"display: inline-block"}}),h=!Object(r.isNullOrUndefined)(n)&&nr(n),c=!Object(r.isNullOrUndefined)(n)&&b(n),o=this.parent.createElement("input",{id:h?c+u:n+u,attrs:{type:"checkbox"}}),s;e.appendChild(o);i.appendChild(e);s=!!(f&&f.length>0)&&(f&&2===f.length?f[1].matchCase:f[0].matchCase);new gt.CheckBox({label:this.getLocalizedLabel("MatchCase"),enableRtl:this.parent.enableRtl,checked:s}).appendTo(o)},t.prototype.renderDate=function(n,t,i,r,u){var f=to(n.format,n.type);this.datePicker=new vu.DatePicker(cu({format:f,cssClass:"e-popup-flmenu",placeholder:this.getLocalizedLabel("CustomFilterDatePlaceHolder"),width:"100%",enableRtl:u,value:new Date(r),locale:this.parent.locale},n.column.filter.params));this.datePicker.appendTo(i)},t.prototype.renderDateTime=function(n,t,i,r,u){var f=to(n.format,n.type);this.dateTimePicker=new vu.DateTimePicker(cu({format:f,cssClass:"e-popup-flmenu",placeholder:this.getLocalizedLabel("CustomFilterDatePlaceHolder"),width:"100%",enableRtl:u,value:new Date(r),locale:this.parent.locale},n.column.filter.params));this.dateTimePicker.appendTo(i)},t.prototype.completeAction=function(n){n.result=ek(n.result)},t.prototype.renderNumericTextBox=function(n,t,i,r,u){this.numericTxtObj=new rr.NumericTextBox(cu({format:n.format,placeholder:this.getLocalizedLabel("CustomFilterPlaceHolder"),enableRtl:u,value:r,locale:this.parent.locale},n.column.filter.params));this.numericTxtObj.appendTo(i)},t.prototype.renderAutoComplete=function(n,t,i,u,f){var s=this,c=this.options.column,a=this.isForeignColumn(c),h=a?c.dataSource:n.dataSource,v={value:a?c.foreignKeyValue:t},o=new li.AutoComplete(cu({dataSource:h instanceof e.DataManager?h:new e.DataManager(h),fields:v,query:this.getQuery(),sortOrder:"Ascending",locale:this.parent.locale,cssClass:"e-popup-flmenu",autofill:!0,focus:function(){var f=!Object(r.isNullOrUndefined)(t)&&nr(t),e=!Object(r.isNullOrUndefined)(t)&&b(t),u=f?e:t;o.filterType=s.dlgDiv.querySelector("#"+u+(i.id===u+"-xlfl-frstvalue"?"-xlfl-frstoptr":"-xlfl-secndoptr")).ej2_instances[0].value;o.ignoreCase="string"!==n.type||!s.dlgDiv.querySelector("#"+u+"-xlflmtcase").ej2_instances[0].checked;o.filterType=Object(r.isNullOrUndefined)(o.filterType)?"equal":o.filterType},placeholder:this.getLocalizedLabel("CustomFilterPlaceHolder"),enableRtl:f,actionComplete:function(n){var i=!Object(r.isNullOrUndefined)(t)&&nr(t);n.result=n.result.filter(function(n,t,r){return r.map(function(n){return i?s.performComplexDataOperation(o.fields.value,n):n[o.fields.value]}).indexOf(i?s.performComplexDataOperation(o.fields.value,n):n[s.actObj.fields.value])===t})},text:u},c.filter.params)),l;h&&"result"in h&&(l=ah({requestType:"stringfilterrequest"},this.getQuery()),this.parent.trigger(nf,l.state),l.deffered.promise.then(function(n){o.dataSource=new e.DataManager(n)}));o.appendTo(i);this.actObj=o},t.prototype.performComplexDataOperation=function(n,t){for(var r,f=n.split(".").length,e=n.split("."),u=t,i=0;i<f;i++)u=r=u[e[i]];return r},t}(au),pf=function(){function n(n,t,i,r){this.contentRefresh=!0;this.isModelChanged=!0;this.aria=new sf;this.currentTarget=null;this.parent=n;this.sortSettings=t;this.sortedColumns=i;this.focus=r.getService("focus");this.addEventListener()}return n.prototype.updateModel=function(){var f,r={field:this.columnName,direction:this.direction},n=this.parent.groupSettings.columns,e=!1,u;if(this.isMultiSort)(f=this.getSortedColsIndexByField(this.columnName))>-1&&this.sortSettings.columns.splice(f,1),this.sortSettings.columns.push(r),this.sortSettings.columns=this.sortSettings.columns;else if(n.length){for(var t=[],i=0,o=n.length;i<o;i++)(f=this.getSortedColsIndexByField(n[i],t),this.columnName===n[i])?(e=!0,t.push(r)):(u=this.getSortColumnFromField(n[i]),t.push({field:u.field,direction:u.direction,isFromGroup:u.isFromGroup}));e||t.push(r);this.sortSettings.columns=t}else this.sortSettings.columns=[r];this.parent.dataBind();this.lastSortedCol=this.columnName},n.prototype.onActionComplete=function(n){Object(r.isBlazor)()&&!this.parent.isJsComponent&&(n.rows=null);var t=this.isRemove?{requestType:"sorting",type:c}:{columnName:this.columnName,direction:this.direction,requestType:"sorting",type:c};this.isRemove=!1;this.parent.trigger(c,Object(r.extend)(n,t))},n.prototype.sortColumn=function(n,t,i){var r=this.parent;!1===this.parent.getColumnByField(n).allowSorting||this.parent.isContextMenuOpen()?this.parent.log("action_disabled_column",{moduleName:this.getModuleName(),columnName:n}):(r.allowMultiSorting||(i=r.allowMultiSorting),this.isActionPrevent())?r.notify(ot,{instance:this,handler:this.sortColumn,arg1:n,arg2:t,arg3:i}):(this.backupSettings(),this.columnName=n,this.direction=t,this.isMultiSort=i,this.removeSortIcons(),r.getColumnHeaderByField(n),this.updateSortedCols(n,i),this.updateModel())},n.prototype.backupSettings=function(){this.lastSortedCols=ih(this.sortSettings.columns);this.lastCols=this.sortedColumns},n.prototype.restoreSettings=function(){this.isModelChanged=!1;this.isMultiSort=!0;this.parent.setProperties({sortSettings:{columns:this.lastSortedCols}},!0);this.sortedColumns=this.lastCols;this.isModelChanged=!0},n.prototype.updateSortedCols=function(n,t){if(!t)if(this.parent.allowGrouping)for(var i=0,r=this.sortedColumns.length;i<r;i++)this.parent.groupSettings.columns.indexOf(this.sortedColumns[i])<0&&(this.sortedColumns.splice(i,1),r--,i--);else this.sortedColumns.splice(0,this.sortedColumns.length);this.sortedColumns.indexOf(n)<0&&this.sortedColumns.push(n)},n.prototype.onPropertyChanged=function(n){if(n.module===this.getModuleName()){if(this.contentRefresh){var t=this.sortSettings.columns.length?{columnName:this.columnName,direction:this.direction,requestType:"sorting",type:l,target:this.currentTarget,cancel:!1}:{requestType:"sorting",type:l,cancel:!1,target:this.currentTarget};this.parent.notify(p,t)}this.refreshSortSettings();this.removeSortIcons();this.addSortIcons()}},n.prototype.refreshSortSettings=function(){this.sortedColumns.length=0;for(var t=this.sortSettings.columns,n=0;n<t.length;n++)t[n].isFromGroup||this.sortedColumns.push(t[n].field)},n.prototype.clearSorting=function(){var t=uh(this.sortSettings.columns),n,i;if(this.isActionPrevent())this.parent.notify(ot,{instance:this,handler:this.clearSorting});else{for(n=0,i=t.length;n<i;n++)this.removeSortColumn(t[n].field);Object(r.isBlazor)()&&!this.parent.isJsComponent&&(this.sortSettings.columns=this.sortSettings.columns)}},n.prototype.isActionPrevent=function(){return si(this.parent)},n.prototype.removeSortColumn=function(n){var r=this.parent,i=this.sortSettings.columns,t,u;if(!(0===i.length&&this.sortedColumns.indexOf(n)<0))if(this.isActionPrevent())this.parent.notify(ot,{instance:this,handler:this.removeSortColumn,arg1:n});else{for(this.backupSettings(),this.removeSortIcons(),t=0,u=i.length;t<u;t++)if(i[t].field===n){if(r.allowGrouping&&r.groupSettings.columns.indexOf(i[t].field)>-1)continue;this.sortedColumns.splice(this.sortedColumns.indexOf(i[t].field),1);i.splice(t,1);this.isRemove=!0;this.isModelChanged&&this.parent.notify(p,{requestType:"sorting",type:l,target:this.currentTarget});break}this.addSortIcons()}},n.prototype.getSortedColsIndexByField=function(n,t){for(var r=t||this.sortSettings.columns,i=0,u=r.length;i<u;i++)if(r[i].field===n)return i;return-1},n.prototype.getModuleName=function(){return"sort"},n.prototype.initialEnd=function(){var u,n,i,t;if(this.parent.off(y,this.initialEnd),(!Object(r.isBlazor)()||!this.parent.isServerRendered)&&this.parent.getColumns().length&&this.sortSettings.columns.length){for(u=this.parent,this.contentRefresh=!1,this.isMultiSort=this.sortSettings.columns.length>1,n=0,i=u.sortSettings.columns.slice();n<i.length;n++)t=i[n],this.sortedColumns.indexOf(t.field)>-1&&this.sortColumn(t.field,t.direction,!0);this.isMultiSort=!1;this.contentRefresh=!0}},n.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(y,this.initialEnd,this),this.parent.on(ne,this.onActionComplete,this),this.parent.on(d,this.onPropertyChanged,this),this.parent.on(it,this.clickHandler,this),this.parent.on(g,this.refreshSortIcons,this),this.parent.on(w,this.keyPressed,this),this.parent.on(tf,this.cancelBeginEvent,this))},n.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(ne,this.onActionComplete),this.parent.off(d,this.onPropertyChanged),this.parent.off(it,this.clickHandler),this.parent.off(g,this.refreshSortIcons),this.parent.off(w,this.keyPressed),this.parent.off(tf,this.cancelBeginEvent))},n.prototype.destroy=function(){this.isModelChanged=!1;var n=this.parent.element;n&&(n.querySelector(".e-gridheader")||n.querySelector(".e-gridcontent"))&&(this.parent.element.querySelector(".e-gridpopup").querySelectorAll(".e-sortdirect").length&&(this.parent.element.querySelector(".e-gridpopup").style.display="none"),this.parent.refreshing||this.clearSorting(),this.isModelChanged=!0,this.removeEventListener())},n.prototype.cancelBeginEvent=function(n){"sorting"===n.requestType&&(this.restoreSettings(),this.refreshSortIcons(),this.isMultiSort=!0)},n.prototype.clickHandler=function(n){var i=this.parent,t,u,f,e;this.currentTarget=null;this.popUpClickHandler(n);t=Object(r.closest)(n.target,".e-headercell");!t||n.target.classList.contains("e-grptogglebtn")||t.classList.contains("e-resized")||n.target.classList.contains("e-rhandler")||n.target.classList.contains("e-columnmenu")||n.target.classList.contains("e-filtermenudiv")||o(n.target,"e-stackedheadercell")||i.allowSelection&&"Column"===i.selectionSettings.mode&&n.target.classList.contains("e-headercell")||(u=this.parent.getColumnByUid(t.querySelector(".e-headercelldiv").getAttribute("e-mappinguid")),f=t.querySelectorAll(".e-ascending").length?"Descending":"Ascending","checkbox"!==u.type&&(this.initiateSort(t,n,u),r.Browser.isDevice&&this.showPopUp(n)));(t&&t.classList.remove("e-resized"),n.target.classList.contains("e-excel-ascending")||n.target.classList.contains("e-excel-descending"))&&(e=Object(r.closest)(n.target,".e-filter-popup").getAttribute("uid"),f=n.target.classList.contains("e-excel-ascending")?"Ascending":"Descending",this.sortColumn(i.getColumnByUid(e).field,f,!1))},n.prototype.keyPressed=function(n){var u=n.target,t,i;if(!this.parent.isEdit&&("enter"===n.action||"ctrlEnter"===n.action||"shiftEnter"===n.action)&&Object(r.closest)(u,".e-headercell")){if(t=this.focus.getFocusedElement(),Object(r.isNullOrUndefined)(t)||!t.classList.contains("e-headercell")||!t.querySelector(".e-headercelldiv"))return;i=this.parent.getColumnByUid(t.querySelector(".e-headercelldiv").getAttribute("e-mappinguid"));this.initiateSort(t,n,i)}},n.prototype.initiateSort=function(n,t,i){var e=this.parent,u=i.field,f;this.currentTarget=t.target;f=n.querySelectorAll(".e-ascending").length?"Descending":"Ascending";t.shiftKey||this.sortSettings.allowUnsort&&n.querySelectorAll(".e-descending").length&&!(e.groupSettings.columns.indexOf(u)>-1)?(this.removeSortColumn(u),Object(r.isBlazor)()&&!this.parent.isJsComponent&&(this.sortSettings.columns=this.sortSettings.columns)):this.sortColumn(u,f,t.ctrlKey||this.enableSortMultiTouch||-1!==navigator.userAgent.indexOf("Mac OS")&&t.metaKey)},n.prototype.showPopUp=function(n){var t=Object(r.closest)(n.target,".e-headercell");this.parent.allowMultiSorting&&(!Object(r.isNullOrUndefined)(t)||this.parent.isContextMenuOpen())&&pa(this.parent.element.querySelector(".e-gridpopup"),n,"e-sortdirect e-icons e-icon-sortdirect"+(this.sortedColumns.length>1?" e-spanclicked":""))},n.prototype.popUpClickHandler=function(n){var t=n.target;Object(r.closest)(t,".e-headercell")||n.target.classList.contains("e-rowcell")||Object(r.closest)(t,".e-gridpopup")?t.classList.contains("e-sortdirect")&&(t.classList.contains("e-spanclicked")?(t.classList.remove("e-spanclicked"),this.enableSortMultiTouch=!1,this.parent.element.querySelector(".e-gridpopup").style.display="none"):(t.classList.add("e-spanclicked"),this.enableSortMultiTouch=!0)):this.parent.element.querySelector(".e-gridpopup").style.display="none"},n.prototype.addSortIcons=function(){for(var t,u,f=this.parent,i=this.sortSettings.columns,e=this.parent.getColumns().map(function(n){return n.field}),n=0,o=i.length;n<o;n++)t=f.getColumnHeaderByField(i[n].field),-1===e.indexOf(i[n].field)||Object(r.isNullOrUndefined)(t)||(this.aria.setSort(t,i[n].direction),this.isMultiSort&&i.length>1&&t.querySelector(".e-headercelldiv").insertBefore(this.parent.createElement("span",{className:"e-sortnumber",innerHTML:(n+1).toString()}),t.querySelector(".e-headertext")),u=t.querySelector(".e-sortfilterdiv"),"Ascending"===i[n].direction?Object(r.classList)(u,["e-ascending","e-icon-ascending"],[]):Object(r.classList)(u,["e-descending","e-icon-descending"],[]))},n.prototype.removeSortIcons=function(n){for(var t,f=this.parent,u=this.sortSettings.columns,e=this.parent.getColumns().map(function(n){return n.field}),i=n||0,o=Object(r.isNullOrUndefined)(n)?u.length:n+1;i<o;i++)t=f.getColumnHeaderByField(u[i].field),Object(r.isNullOrUndefined)(t)||f.allowGrouping&&f.groupSettings.columns.indexOf(u[i].field)>-1&&!t.querySelector(".e-sortfilterdiv")||-1!==e.indexOf(u[i].field)&&(this.aria.setSort(t,"none"),Object(r.classList)(t.querySelector(".e-sortfilterdiv"),[],["e-descending","e-icon-descending","e-ascending","e-icon-ascending"]),t.querySelector(".e-sortnumber")&&t.querySelector(".e-headercelldiv").removeChild(t.querySelector(".e-sortnumber")))},n.prototype.getSortColumnFromField=function(n){for(var t=0,i=this.sortSettings.columns.length;t<i;t++)if(this.sortSettings.columns[t].field===n)return this.sortSettings.columns[t];return!1},n.prototype.updateAriaAttr=function(){for(var n,r,u=this.parent.getColumns().map(function(n){return n.field}),t=0,i=this.sortedColumns;t<i.length;t++)n=i[t],-1!==u.indexOf(n)&&(r=this.parent.getColumnHeaderByField(n),this.aria.setSort(r,this.getSortColumnFromField(n).direction))},n.prototype.refreshSortIcons=function(n){void 0===n&&(n={args:{isFrozen:!1}});n.args.isFrozen||(this.removeSortIcons(),this.isMultiSort=!0,this.removeSortIcons(),this.addSortIcons(),this.isMultiSort=!1,this.updateAriaAttr())},n}(),vk=function(){function n(n){this.pagerModule=n}return n.prototype.render=function(){this.pagerElement=this.pagerModule.element;this.renderNumericContainer();this.refreshNumericLinks();this.wireEvents()},n.prototype.refresh=function(){this.pagerModule.updateTotalPages();this.links.length&&this.updateLinksHtml();this.updateStyles()},n.prototype.refreshNumericLinks=function(){var t,i=this.pagerModule,u=i.element.querySelector(".e-numericcontainer"),f=document.createDocumentFragment(),n;for(u.innerHTML="",n=1;n<=i.pageCount;n++)t=Object(r.createElement)("a",{className:"e-link e-numericitem e-spacing e-pager-default",attrs:{role:"link",tabindex:"-1","aria-label":"Goto Page "+n,href:"javascript:void(0);",name:"Goto page"+n}}),i.currentPage===n&&Object(r.classList)(t,["e-currentitem","e-active"],["e-pager-default"]),f.appendChild(t);u.appendChild(f);this.links=[].slice.call(u.childNodes)},n.prototype.wireEvents=function(){r.EventHandler.add(this.pagerElement,"click",this.clickHandler,this)},n.prototype.unwireEvents=function(){r.EventHandler.remove(this.pagerModule.element,"click",this.clickHandler)},n.prototype.destroy=function(){this.unwireEvents()},n.prototype.renderNumericContainer=function(){this.element=Object(r.createElement)("div",{className:"e-pagercontainer",attrs:{role:"navigation"}});this.renderFirstNPrev(this.element);this.renderPrevPagerSet(this.element);this.element.appendChild(Object(r.createElement)("div",{className:"e-numericcontainer"}));this.renderNextPagerSet(this.element);this.renderNextNLast(this.element);this.pagerModule.element.appendChild(this.element)},n.prototype.renderFirstNPrev=function(n){this.first=Object(r.createElement)("div",{className:"e-first e-icons e-icon-first",attrs:{title:Object(r.isBlazor)()?this.pagerModule.getLocalizedLabel("FirstPageTooltip"):this.pagerModule.getLocalizedLabel("firstPageTooltip"),"aria-label":Object(r.isBlazor)()?this.pagerModule.getLocalizedLabel("FirstPageTooltip"):this.pagerModule.getLocalizedLabel("firstPageTooltip"),tabindex:"-1"}});this.prev=Object(r.createElement)("div",{className:"e-prev e-icons e-icon-prev",attrs:{title:Object(r.isBlazor)()?this.pagerModule.getLocalizedLabel("PreviousPageTooltip"):this.pagerModule.getLocalizedLabel("previousPageTooltip"),"aria-label":Object(r.isBlazor)()?this.pagerModule.getLocalizedLabel("PreviousPageTooltip"):this.pagerModule.getLocalizedLabel("previousPageTooltip"),tabindex:"-1"}});Object(r.append)([this.first,this.prev],n)},n.prototype.renderPrevPagerSet=function(n){var t=Object(r.createElement)("div");this.PP=Object(r.createElement)("a",{className:"e-link e-pp e-spacing",innerHTML:"...",attrs:{title:Object(r.isBlazor)()?this.pagerModule.getLocalizedLabel("PreviousPagerTooltip"):this.pagerModule.getLocalizedLabel("previousPagerTooltip"),role:"link","aria-label":Object(r.isBlazor)()?this.pagerModule.getLocalizedLabel("PreviousPagerTooltip"):this.pagerModule.getLocalizedLabel("previousPagerTooltip"),tabindex:"-1",name:Object(r.isBlazor)()?this.pagerModule.getLocalizedLabel("PreviousPagerTooltip"):this.pagerModule.getLocalizedLabel("previousPagerTooltip"),href:"javascript:void(0);"}});t.appendChild(this.PP);n.appendChild(t)},n.prototype.renderNextPagerSet=function(n){var t=Object(r.createElement)("div");this.NP=Object(r.createElement)("a",{className:"e-link e-np e-spacing",innerHTML:"...",attrs:{title:Object(r.isBlazor)()?this.pagerModule.getLocalizedLabel("NextPagerTooltip"):this.pagerModule.getLocalizedLabel("nextPagerTooltip"),role:"link","aria-label":Object(r.isBlazor)()?this.pagerModule.getLocalizedLabel("NextPagerTooltip"):this.pagerModule.getLocalizedLabel("nextPagerTooltip"),tabindex:"-1",name:Object(r.isBlazor)()?this.pagerModule.getLocalizedLabel("NextPagerTooltip"):this.pagerModule.getLocalizedLabel("nextPagerTooltip"),href:"javascript:void(0);"}});t.appendChild(this.NP);n.appendChild(t)},n.prototype.renderNextNLast=function(n){this.next=Object(r.createElement)("div",{className:"e-next e-icons e-icon-next",attrs:{title:Object(r.isBlazor)()?this.pagerModule.getLocalizedLabel("NextPageTooltip"):this.pagerModule.getLocalizedLabel("nextPageTooltip"),"aria-label":Object(r.isBlazor)()?this.pagerModule.getLocalizedLabel("NextPageTooltip"):this.pagerModule.getLocalizedLabel("nextPageTooltip"),tabindex:"-1"}});this.last=Object(r.createElement)("div",{className:"e-last e-icons e-icon-last",attrs:{title:Object(r.isBlazor)()?this.pagerModule.getLocalizedLabel("LastPageTooltip"):this.pagerModule.getLocalizedLabel("lastPageTooltip"),"aria-label":Object(r.isBlazor)()?this.pagerModule.getLocalizedLabel("LastPageTooltip"):this.pagerModule.getLocalizedLabel("lastPageTooltip"),tabindex:"-1"}});Object(r.append)([this.next,this.last],n)},n.prototype.clickHandler=function(n){var t=this.pagerModule,i=n.target;return t.previousPageNo=t.currentPage,i.classList.contains("e-disable")||Object(r.isNullOrUndefined)(i.getAttribute("index"))||(t.currentPage=parseInt(i.getAttribute("index"),10),t.dataBind()),!1},n.prototype.updateLinksHtml=function(){var u,i,n=this.pagerModule,t;for(n.currentPage=1===n.totalPages?1:n.currentPage,n.currentPage>n.totalPages&&n.totalPages&&(n.currentPage=n.totalPages),u=parseInt((n.currentPage/n.pageCount).toString(),10),n.currentPage%n.pageCount==0&&u>0&&(u-=1),t=0;t<n.pageCount;t++)(i=u*n.pageCount+1+t)<=n.totalPages?(this.links[t].style.display="",this.links[t].setAttribute("index",i.toString()),this.links[t].innerHTML=n.customText?n.customText+i:i.toString(),n.currentPage!==i?this.links[t].classList.add("e-pager-default"):this.links[t].classList.remove("e-pager-default")):(this.links[t].innerHTML=n.customText?n.customText+i:i.toString(),this.links[t].style.display="none"),Object(r.classList)(this.links[t],[],["e-currentitem","e-active"]);this.first.setAttribute("index","1");this.last.setAttribute("index",n.totalPages.toString());this.prev.setAttribute("index",(n.currentPage-1).toString());this.next.setAttribute("index",(n.currentPage+1).toString());this.pagerElement.querySelector(".e-mfirst").setAttribute("index","1");this.pagerElement.querySelector(".e-mlast").setAttribute("index",n.totalPages.toString());this.pagerElement.querySelector(".e-mprev").setAttribute("index",(n.currentPage-1).toString());this.pagerElement.querySelector(".e-mnext").setAttribute("index",(n.currentPage+1).toString());this.PP.setAttribute("index",(parseInt(this.links[0].getAttribute("index"),10)-n.pageCount).toString());this.NP.setAttribute("index",(parseInt(this.links[this.links.length-1].getAttribute("index"),10)+1).toString())},n.prototype.updateStyles=function(){this.updateFirstNPrevStyles();this.updatePrevPagerSetStyles();this.updateNextPagerSetStyles();this.updateNextNLastStyles();this.links.length&&Object(r.classList)(this.links[(this.pagerModule.currentPage-1)%this.pagerModule.pageCount],["e-currentitem","e-active"],[])},n.prototype.updateFirstNPrevStyles=function(){var n=["e-firstpage","e-pager-default"],t=["e-firstpagedisabled","e-disable"],i=["e-prevpage","e-pager-default"],u=["e-prevpagedisabled","e-disable"];this.pagerModule.totalPages>0&&this.pagerModule.currentPage>1?(Object(r.classList)(this.prev,i,u),Object(r.classList)(this.first,n,t),Object(r.classList)(this.pagerElement.querySelector(".e-mfirst"),n,t),Object(r.classList)(this.pagerElement.querySelector(".e-mprev"),i,u)):(Object(r.classList)(this.prev,u,i),Object(r.classList)(this.first,t,n),Object(r.classList)(this.pagerElement.querySelector(".e-mprev"),u,i),Object(r.classList)(this.pagerElement.querySelector(".e-mfirst"),t,n))},n.prototype.updatePrevPagerSetStyles=function(){this.pagerModule.currentPage>this.pagerModule.pageCount?Object(r.classList)(this.PP,["e-numericitem","e-pager-default"],["e-nextprevitemdisabled","e-disable"]):Object(r.classList)(this.PP,["e-nextprevitemdisabled","e-disable"],["e-numericitem","e-pager-default"])},n.prototype.updateNextPagerSetStyles=function(){var n=this.pagerModule,t=this.links[0].innerHTML.replace(n.customText,"");!t.length||!this.links.length||parseInt(t,10)+n.pageCount>n.totalPages?Object(r.classList)(this.NP,["e-nextprevitemdisabled","e-disable"],["e-numericitem","e-pager-default"]):Object(r.classList)(this.NP,["e-numericitem","e-pager-default"],["e-nextprevitemdisabled","e-disable"])},n.prototype.updateNextNLastStyles=function(){var n=["e-lastpage","e-pager-default"],t=["e-lastpagedisabled","e-disable"],i=["e-nextpage","e-pager-default"],u=["e-nextpagedisabled","e-disable"],f=this.pagerModule;f.currentPage===f.totalPages||0===f.totalRecordsCount?(Object(r.classList)(this.last,t,n),Object(r.classList)(this.next,u,i),Object(r.classList)(this.pagerElement.querySelector(".e-mlast"),t,n),Object(r.classList)(this.pagerElement.querySelector(".e-mnext"),u,i)):(Object(r.classList)(this.last,n,t),Object(r.classList)(this.next,i,u),Object(r.classList)(this.pagerElement.querySelector(".e-mlast"),n,t),Object(r.classList)(this.pagerElement.querySelector(".e-mnext"),i,u))},n}(),yk=function(){function n(n){this.pagerModule=n}return n.prototype.render=function(){var n=Object(r.createElement)("div",{className:"e-parentmsgbar",attrs:{"aria-label":"Pager Information"}});this.pageNoMsgElem=Object(r.createElement)("span",{className:"e-pagenomsg",styles:"textalign:right"});this.pageCountMsgElem=Object(r.createElement)("span",{className:"e-pagecountmsg",styles:"textalign:right"});Object(r.append)([this.pageNoMsgElem,this.pageCountMsgElem],n);this.pagerModule.element.appendChild(n);this.refresh()},n.prototype.refresh=function(){var n=this.pagerModule;Object(r.isBlazor)()?(this.pageNoMsgElem.textContent=this.format(n.getLocalizedLabel("CurrentPageInfo"),[0===n.totalRecordsCount?0:n.currentPage,n.totalPages||0])+" ",this.pageCountMsgElem.textContent=this.format(n.getLocalizedLabel("TotalItemsInfo"),[n.totalRecordsCount||0])):(this.pageNoMsgElem.textContent=this.format(n.getLocalizedLabel("currentPageInfo"),[0===n.totalRecordsCount?0:n.currentPage,n.totalPages||0,n.totalRecordsCount||0])+" ",this.pageCountMsgElem.textContent=this.format(n.getLocalizedLabel(n.totalRecordsCount<=1?"totalItemInfo":"totalItemsInfo"),[n.totalRecordsCount||0]));this.pageNoMsgElem.parentElement.setAttribute("aria-label",this.pageNoMsgElem.textContent+this.pageCountMsgElem.textContent)},n.prototype.hideMessage=function(){this.pageNoMsgElem&&(this.pageNoMsgElem.style.display="none");this.pageCountMsgElem&&(this.pageCountMsgElem.style.display="none")},n.prototype.showMessage=function(){this.pageNoMsgElem||this.render();this.pageNoMsgElem.style.display="";this.pageCountMsgElem.style.display=""},n.prototype.destroy=function(){},n.prototype.format=function(n,t){for(var r,i=0;i<t.length;i++)r=new RegExp("\\{"+i+"\\}","gm"),n=n.replace(r,t[i].toString());return n},n}(),rit=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),pt=function(n,t,i,r){var f,e=arguments.length,u=e<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r,o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(n,t,i,r);else for(o=n.length-1;o>=0;o--)(f=n[o])&&(u=(e<3?f(u):e>3?f(t,i,u):f(t,i))||u);return e>3&&u&&Object.defineProperty(t,i,u),u},ev=function(n){function t(t,i){var r=n.call(this,t,i)||this;return r.hasParent=!1,r}return rit(t,n),t.prototype.requiredModules=function(){var n=[];return this.enableExternalMessage&&n.push({member:"externalMessage",args:[this]}),this.checkpagesizes()&&n.push({member:"pagerdropdown",args:[this]}),n},t.prototype.preRender=function(){this.defaultConstants={currentPageInfo:"{0} of {1} pages",totalItemsInfo:"({0} items)",totalItemInfo:"({0} item)",firstPageTooltip:"Go to first page",lastPageTooltip:"Go to last page",nextPageTooltip:"Go to next page",previousPageTooltip:"Go to previous page",nextPagerTooltip:"Go to next pager",previousPagerTooltip:"Go to previous pager",pagerDropDown:"Items per page",pagerAllDropDown:"Items",CurrentPageInfo:"{0} of {1} pages",TotalItemsInfo:"({0} items)",FirstPageTooltip:"Go to first page",LastPageTooltip:"Go to last page",NextPageTooltip:"Go to next page",PreviousPageTooltip:"Go to previous page",NextPagerTooltip:"Go to next pager",PreviousPagerTooltip:"Go to previous pager",PagerDropDown:"Items per page",PagerAllDropDown:"Items",All:"All"};this.containerModule=new vk(this);this.pagerMessageModule=new yk(this)},t.prototype.render=function(){this.template?this.isReactTemplate()?(this.on("pager-refresh",this.pagerTemplate,this),this.notify("pager-refresh",{})):this.pagerTemplate():(this.initLocalization(),this.updateRTL(),this.totalRecordsCount=this.totalRecordsCount||0,this.renderFirstPrevDivForDevice(),this.containerModule.render(),this.enablePagerMessage&&this.pagerMessageModule.render(),this.renderNextLastDivForDevice(),this.checkpagesizes()&&this.pagerdropdownModule&&this.pagerdropdownModule.render(),this.addAriaLabel(),this.enableExternalMessage&&this.externalMessageModule&&this.externalMessageModule.render(),this.refresh(),this.trigger("created",{currentPage:this.currentPage,totalRecordsCount:this.totalRecordsCount}))},t.prototype.getPersistData=function(){return this.addOnPersist(["currentPage","pageSize"])},t.prototype.destroy=function(){this.isReactTemplate()&&(this.off("pager-refresh",this.pagerTemplate),this.hasParent||this.destroyTemplate(["template"]));n.prototype.destroy.call(this);this.containerModule.destroy();this.pagerMessageModule.destroy();this.isReactTemplate()||(this.element.innerHTML="")},t.prototype.destroyTemplate=function(n,t){this.clearTemplate(n,t)},t.prototype.getModuleName=function(){return"pager"},t.prototype.onPropertyChanged=function(n,t){if(!this.isDestroyed){n.pageCount!==t.pageCount&&(this.containerModule.refreshNumericLinks(),this.containerModule.refresh());for(var i=0,r=Object.keys(n);i<r.length;i++)switch(r[i]){case"currentPage":this.checkGoToPage(n.currentPage,t.currentPage)&&this.currentPageChanged(n,t);break;case"pageSize":case"totalRecordsCount":case"customText":this.checkpagesizes()&&this.pagerdropdownModule&&(t.pageSize!==n.pageSize&&(this.currentPage=1),this.pagerdropdownModule.setDropDownValue("value",this.pageSize));n.pageSize!==t.pageSize?(this.pageSize=n.pageSize,this.currentPageChanged(n,t)):this.refresh();break;case"pageSizes":this.checkpagesizes()&&this.pagerdropdownModule&&(this.pagerdropdownModule.destroy(),this.pagerdropdownModule.render());this.refresh();break;case"template":this.templateFn=this.compile(this.template);this.refresh();break;case"locale":this.initLocalization();this.refresh();break;case"enableExternalMessage":this.enableExternalMessage&&this.externalMessageModule&&this.externalMessageModule.render();break;case"externalMessage":this.externalMessageModule&&this.externalMessageModule.refresh();break;case"enableRtl":this.updateRTL();break;case"enablePagerMessage":this.enablePagerMessage?this.pagerMessageModule.showMessage():this.pagerMessageModule.hideMessage()}}},t.prototype.getLocalizedLabel=function(n){return this.localeObj.getConstant(n)},t.prototype.goToPage=function(n){this.checkGoToPage(n)&&(this.currentPage=n,this.dataBind())},t.prototype.setPageSize=function(n){this.pageSize=n;this.dataBind()},t.prototype.checkpagesizes=function(){return!(!0!==this.pageSizes&&!this.pageSizes.length)},t.prototype.checkGoToPage=function(n,t){return n!==this.currentPage&&(this.previousPageNo=this.currentPage),Object(r.isNullOrUndefined)(t)||(this.previousPageNo=t),this.previousPageNo!==n&&n>=1&&n<=this.totalPages},t.prototype.currentPageChanged=function(n,t){if(this.enableQueryString&&this.updateQueryString(this.currentPage),n.currentPage!==t.currentPage||n.pageSize!==t.pageSize){var i={currentPage:this.currentPage,newProp:n,oldProp:t,cancel:!1};this.trigger("click",i);i.cancel||this.refresh()}},t.prototype.pagerTemplate=function(){var i,n,t;this.isReactTemplate()&&this.hasParent||(this.element.classList.add("e-pagertemplate"),this.compile(this.template),n={currentPage:this.currentPage,pageSize:this.pageSize,pageCount:this.pageCount,totalRecordsCount:this.totalRecordsCount,totalPages:this.totalPages},t=this.element.parentElement.id+"_template",this.isReactTemplate()?(this.getPagerTemplate()(n,this,"template",t,null,null,this.element),this.renderReactTemplates()):(i=Object(r.isBlazor)()?this.getPagerTemplate()(n,this,"template",t,this.isStringTemplate):this.getPagerTemplate()(n),rt(this.element,i)))},t.prototype.updateTotalPages=function(){this.totalPages=this.totalRecordsCount%this.pageSize==0?this.totalRecordsCount/this.pageSize:parseInt((this.totalRecordsCount/this.pageSize).toString(),10)+1},t.prototype.getPagerTemplate=function(){return this.templateFn},t.prototype.compile=function(n){if(n)try{document.querySelectorAll(n).length&&(this.templateFn=Object(r.compile)(document.querySelector(n).innerHTML.trim()))}catch(t){this.templateFn=Object(r.compile)(n)}},t.prototype.refresh=function(){this.template?this.isReactTemplate()?(this.updateTotalPages(),this.notify("pager-refresh",{})):(this.element.innerHTML="",this.updateTotalPages(),this.pagerTemplate()):(this.updateRTL(),this.containerModule.refresh(),this.enablePagerMessage&&this.pagerMessageModule.refresh(),this.pagerdropdownModule&&this.pagerdropdownModule.refresh(),this.enableExternalMessage&&this.externalMessageModule&&this.externalMessageModule.refresh())},t.prototype.updateRTL=function(){this.enableRtl?this.element.classList.add("e-rtl"):this.element.classList.remove("e-rtl")},t.prototype.initLocalization=function(){this.localeObj=new r.L10n(this.getModuleName(),this.defaultConstants,this.locale)},t.prototype.updateQueryString=function(n){var t=this.getUpdatedURL(window.location.href,"page",n.toString());window.history.pushState({path:t},"",t)},t.prototype.getUpdatedURL=function(n,t,i){var u=new RegExp("([?|&])"+t+"=.*?(&|#|$)","i"),r;return n.match(u)?n.replace(u,"$1"+t+"="+i+"$2"):(r="",-1!==n.indexOf("#")&&(r=n.replace(/.*#/,"#"),n=n.replace(/#.*/,"")),n+(-1!==n.indexOf("?")?"&":"?")+t+"="+i+r)},t.prototype.renderFirstPrevDivForDevice=function(){this.element.appendChild(Object(r.createElement)("div",{className:"e-mfirst e-icons e-icon-first",attrs:{title:Object(r.isBlazor)()?this.getLocalizedLabel("FirstPageTooltip"):this.getLocalizedLabel("firstPageTooltip"),tabindex:"-1"}}));this.element.appendChild(Object(r.createElement)("div",{className:"e-mprev e-icons e-icon-prev",attrs:{title:Object(r.isBlazor)()?this.getLocalizedLabel("PreviousPageTooltip"):this.getLocalizedLabel("previousPageTooltip"),tabindex:"-1"}}))},t.prototype.renderNextLastDivForDevice=function(){this.element.appendChild(Object(r.createElement)("div",{className:"e-mnext e-icons e-icon-next",attrs:{title:Object(r.isBlazor)()?this.getLocalizedLabel("NextPageTooltip"):this.getLocalizedLabel("nextPageTooltip"),tabindex:"-1"}}));this.element.appendChild(Object(r.createElement)("div",{className:"e-mlast e-icons e-icon-last",attrs:{title:Object(r.isBlazor)()?this.getLocalizedLabel("LastPageTooltip"):this.getLocalizedLabel("lastPageTooltip"),tabindex:"-1"}}))},t.prototype.addAriaLabel=function(){var i=[".e-mfirst",".e-mprev",".e-mnext",".e-mlast"],n,t;if(!r.Browser.isDevice)for(n=0;n<i.length;n++)t=this.element.querySelector(i[n]),t.setAttribute("aria-label",t.getAttribute("title"))},t.prototype.isReactTemplate=function(){return this.isReact&&this.template&&"string"!=typeof this.template},pt([Object(r.Property)(!1)],t.prototype,"enableQueryString",void 0),pt([Object(r.Property)(!1)],t.prototype,"enableExternalMessage",void 0),pt([Object(r.Property)(!0)],t.prototype,"enablePagerMessage",void 0),pt([Object(r.Property)(12)],t.prototype,"pageSize",void 0),pt([Object(r.Property)(10)],t.prototype,"pageCount",void 0),pt([Object(r.Property)(1)],t.prototype,"currentPage",void 0),pt([Object(r.Property)()],t.prototype,"totalRecordsCount",void 0),pt([Object(r.Property)()],t.prototype,"externalMessage",void 0),pt([Object(r.Property)(!1)],t.prototype,"pageSizes",void 0),pt([Object(r.Property)()],t.prototype,"template",void 0),pt([Object(r.Property)("")],t.prototype,"customText",void 0),pt([Object(r.Event)()],t.prototype,"click",void 0),pt([Object(r.Event)()],t.prototype,"dropDownChanged",void 0),pt([Object(r.Event)()],t.prototype,"created",void 0),t=pt([r.NotifyPropertyChanges],t)}(r.Component),pk=function(){function n(n){this.pagerModule=n}return n.prototype.getModuleName=function(){return"pagerdropdown"},n.prototype.render=function(){var n=this.pagerModule;this.pagerDropDownDiv=Object(r.createElement)("div",{className:"e-pagesizes"});var u=Object(r.createElement)("div",{className:"e-pagerdropdown"}),f=Object(r.createElement)("div",{className:"e-pagerconstant"}),e=Object(r.createElement)("input",{attrs:{type:"text",tabindex:"1"}});this.pagerCons=Object(r.createElement)("span",{className:"e-constant",innerHTML:Object(r.isBlazor)()?this.pagerModule.getLocalizedLabel("PagerDropDown"):this.pagerModule.getLocalizedLabel("pagerDropDown")});u.appendChild(e);f.appendChild(this.pagerCons);this.pagerDropDownDiv.appendChild(u);this.pagerDropDownDiv.appendChild(f);this.pagerModule.element.appendChild(this.pagerDropDownDiv);var t=this.pagerModule.pageSizes,o=t.length?this.convertValue(t):[this.pagerModule.getLocalizedLabel("All"),"5","10","12","20"],i=this.pagerModule.pageSize;this.dropDownListObject=new li.DropDownList({dataSource:o,value:i.toString(),change:this.onChange.bind(this),cssClass:"e-alldrop"});this.dropDownListObject.appendTo(e);t.length&&(this.dropDownListObject.element.value=this.pagerModule.pageSize.toString());n.pageSize=i;n.dataBind();n.trigger("dropDownChanged",{pageSize:i});this.addEventListener()},n.prototype.onChange=function(n){this.dropDownListObject.value===this.pagerModule.getLocalizedLabel("All")?(this.pagerModule.pageSize=this.pagerModule.totalRecordsCount,this.refresh(),n.value=this.pagerModule.pageSize,document.getElementsByClassName("e-popup-open e-alldrop").length&&(document.getElementsByClassName("e-popup-open e-alldrop")[0].style.display="none")):(this.pagerModule.pageSize=parseInt(this.dropDownListObject.value,10),this.pagerCons.innerHTML!==this.pagerModule.getLocalizedLabel("pagerDropDown")&&this.refresh());this.pagerModule.dataBind();this.pagerModule.trigger("dropDownChanged",{pageSize:parseInt(this.dropDownListObject.value,10)})},n.prototype.refresh=function(){this.pagerCons.innerHTML=this.pagerModule.pageSize===this.pagerModule.totalRecordsCount?Object(r.isBlazor)()?this.pagerModule.getLocalizedLabel("PagerAllDropDown"):this.pagerModule.getLocalizedLabel("pagerAllDropDown"):Object(r.isBlazor)()?this.pagerModule.getLocalizedLabel("PagerDropDown"):this.pagerModule.getLocalizedLabel("pagerDropDown")},n.prototype.beforeValueChange=function(n){if("number"==typeof n.newProp.value){var t=n.newProp.value.toString();n.newProp.value=t}},n.prototype.convertValue=function(n){for(var t=n,i=0;i<t.length;i++)t[i]=parseInt(t[i],10)?t[i].toString():this.pagerModule.getLocalizedLabel(t[i]);return t},n.prototype.setDropDownValue=function(n,t){this.dropDownListObject&&(this.dropDownListObject[n]=t)},n.prototype.addEventListener=function(){this.dropDownListObject.on("beforeValueChange",this.beforeValueChange,this)},n.prototype.removeEventListener=function(){this.dropDownListObject.off("beforeValueChange",this.beforeValueChange)},n.prototype.destroy=function(){this.dropDownListObject&&!this.dropDownListObject.isDestroyed&&(this.removeEventListener(),this.dropDownListObject.destroy(),Object(r.remove)(this.pagerDropDownDiv))},n}(),wk=function(){function n(n){this.pagerModule=n}return n.prototype.getModuleName=function(){return"externalMessage"},n.prototype.render=function(){this.element=Object(r.createElement)("div",{className:"e-pagerexternalmsg",attrs:{"aria-label":"Pager external message"}});this.pagerModule.element.appendChild(this.element);this.refresh()},n.prototype.refresh=function(){this.pagerModule.externalMessage&&this.pagerModule.externalMessage.toString().length?(this.showMessage(),this.element.innerHTML=this.pagerModule.externalMessage):this.hideMessage()},n.prototype.hideMessage=function(){Object(r.isNullOrUndefined)(this.element)||(this.element.style.display="none")},n.prototype.showMessage=function(){this.element.style.display=""},n.prototype.destroy=function(){Object(r.remove)(this.element)},n}(),fo=function(){function n(n,t){this.isInitialRender=!0;ev.Inject(wk,pk);this.parent=n;this.pageSettings=t;this.addEventListener()}return n.prototype.getModuleName=function(){return"pager"},n.prototype.render=function(){var n,t=this.parent;this.pagerDestroy();Object(r.isNullOrUndefined)(this.parent.pagerTemplate)||(this.pageSettings.template=this.parent.pagerTemplate,this.parent.pageTemplateChange=!0);this.element=this.parent.createElement("div",{className:"e-gridpager"});n=cu({},Object(r.extend)({},hf(this.pageSettings)),{click:this.clickHandler.bind(this),dropDownChanged:this.onSelect.bind(this),enableRtl:t.enableRtl,locale:t.locale,created:this.addAriaAttr.bind(this)},["parentObj","propName"]);this.pagerObj=new ev(n);this.pagerObj.hasParent=!0;this.pagerObj.on("pager-refresh",this.renderReactPagerTemplate,this);this.pagerObj.allowServerDataBinding=!1},n.prototype.onSelect=function(n){this.pageSettings.pageSize=n.pageSize;this.isInitialLoad||(this.pageSettings.currentPage=1)},n.prototype.addAriaAttr=function(){var r,u,i,s;if(!this.pageSettings.template){for(var f=this.parent.createElement("div",{className:"e-numericcontainer"}),h=this.element.querySelector(".e-pagercontainer"),e=document.createDocumentFragment(),o=this.element.querySelector(".e-numericcontainer"),t=o.querySelectorAll("a"),n=0;n<t.length;n++)this.parent.getContentTable()?t[n].setAttribute("aria-owns",this.parent.getContentTable().id):t[n].setAttribute("aria-owns",this.parent.element.getAttribute("id")+"_content_table"),r=this.parent.createElement("div"),r.appendChild(t[n]),e.appendChild(r);for(f.appendChild(e),h.replaceChild(f,o),u=[".e-mfirst",".e-mprev",".e-first",".e-prev",".e-next",".e-last",".e-mnext",".e-mlast"],i=0;i<u.length;i++)s=this.element.querySelector(u[i]),this.parent.getContentTable()&&s.setAttribute("aria-owns",this.parent.getContentTable().id)}},n.prototype.dataReady=function(n){this.updateModel(n)},n.prototype.refresh=function(){this.pagerObj.refresh()},n.prototype.goToPage=function(n){this.pagerObj.goToPage(n)},n.prototype.setPageSize=function(n){this.pagerObj.setPageSize(n)},n.prototype.updateModel=function(n){this.parent.pageSettings.totalRecordsCount=n.count;this.parent.dataBind()},n.prototype.onActionComplete=function(n){Object(r.isBlazor)()&&!this.parent.isJsComponent&&(n.rows=null);this.parent.trigger(c,Object(r.extend)(n,{currentPage:this.parent.pageSettings.currentPage,requestType:"paging",type:c}))},n.prototype.onPropertyChanged=function(n){var i;if(n.module===this.getModuleName()){for(var r=n.properties,t=0,u=Object.keys(r);t<u.length;t++)i=u[t],this.pagerObj[i]=r[i];this.pagerObj.dataBind()}},n.prototype.clickHandler=function(n){var t=this.parent,u,i;if(this.isForceCancel||si(t)&&!t.prevPageMoving)return this.isForceCancel?this.isForceCancel=!1:(Object(r.isNullOrUndefined)(n.newProp)||Object(r.isNullOrUndefined)(n.newProp.pageSize)?n.currentPage&&(t.notify(ot,{instance:this,handler:this.goToPage,arg1:n.currentPage}),this.pagerObj.currentPage=t.pageSettings.currentPage===this.pagerObj.currentPage?this.pagerObj.previousPageNo:t.pageSettings.currentPage):(t.notify(ot,{instance:this,handler:this.setPageSize,arg1:n.newProp.pageSize}),this.pagerObj.pageSize=n.oldProp.pageSize,t.pageSettings.pageSize=n.newProp.pageSize),this.isForceCancel=!0,this.pagerObj.dataBind()),void(n.cancel=!0);t.pageSettings.pageSize=this.pagerObj.pageSize;t.prevPageMoving=!1;u=this.pageSettings.currentPage;this.pageSettings.currentPage=n.currentPage;i={cancel:!1,requestType:"paging",previousPage:u,currentPage:n.currentPage,type:l};this.parent.notify(p,i);i.cancel&&(n.cancel=!0);this.parent.requestTypeAction="paging"},n.prototype.keyPressHandler=function(n){n.action in bk&&(n.preventDefault(),this.element.querySelector(bk[n.action]).click())},n.prototype.updateExternalMessage=function(n){this.pagerObj.enableExternalMessage||(this.pagerObj.enableExternalMessage=!0,this.pagerObj.dataBind());this.pagerObj.externalMessage=n;this.pagerObj.dataBind()},n.prototype.appendToElement=function(){this.isInitialLoad=!0;this.parent.element.appendChild(this.element);this.parent.setGridPager(this.element);this.pagerObj.isReact=this.parent.isReact;this.pagerObj.appendTo(this.element);this.isInitialLoad=!1},n.prototype.enableAfterRender=function(n){n.module===this.getModuleName()&&n.enable&&(this.render(),this.appendToElement(),this.isReactTemplate()&&(this.pagerObj.updateTotalPages(),this.created()))},n.prototype.addEventListener=function(){this.handlers={load:this.render,end:this.appendToElement,ready:this.dataReady,complete:this.onActionComplete,updateLayout:this.enableAfterRender,inboundChange:this.onPropertyChanged,keyPress:this.keyPressHandler,created:this.created};this.parent.isDestroyed||(this.parent.isReact&&this.parent.addEventListener("created",this.handlers.created.bind(this)),this.parent.on(ii,this.handlers.load,this),this.parent.on(tt,this.handlers.end,this),this.parent.on(at,this.handlers.ready,this),this.parent.on(kc,this.handlers.complete,this),this.parent.on(v,this.handlers.updateLayout,this),this.parent.on(d,this.handlers.inboundChange,this),this.parent.on(w,this.handlers.keyPress,this))},n.prototype.created=function(){this.isInitialRender&&this.isReactTemplate()&&(this.isInitialRender=!1,this.renderReactPagerTemplate())},n.prototype.isReactTemplate=function(){return this.parent.isReact&&this.pagerObj.template&&"string"!=typeof this.pagerObj.template},n.prototype.renderReactPagerTemplate=function(){if(!this.isInitialRender&&this.isReactTemplate()){this.parent.destroyTemplate(["pagerTemplate"]);this.element.classList.add("e-pagertemplate");this.pagerObj.compile(this.pagerObj.template);var n=this.parent.pageSettings,t={currentPage:n.currentPage,pageSize:n.pageSize,pageCount:n.pageCount,totalRecordsCount:n.totalRecordsCount,totalPages:this.pagerObj.totalPages},i=this.parent.id+"_pagertemplate";this.pagerObj.templateFn(t,this.parent,"pagerTemplate",i,null,null,this.pagerObj.element);this.parent.renderTemplates()}},n.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.isReact&&this.parent.removeEventListener("created",this.handlers.created),this.parent.off("pager-refresh",this.renderReactPagerTemplate),this.parent.off(ii,this.handlers.load),this.parent.off(tt,this.handlers.end),this.parent.off(at,this.handlers.ready),this.parent.off(kc,this.handlers.complete),this.parent.off(v,this.handlers.updateLayout),this.parent.off(d,this.handlers.inboundChange),this.parent.off(w,this.handlers.keyPress))},n.prototype.destroy=function(){this.removeEventListener();this.isReactTemplate()&&this.parent.destroyTemplate(["pagerTemplate"]);this.pagerObj.destroy()},n.prototype.pagerDestroy=function(){this.pagerObj&&!this.pagerObj.isDestroyed&&(this.pagerObj.destroy(),Object(r.remove)(this.element))},n}(),bk={pageUp:".e-prev",pageDown:".e-next",ctrlAltPageDown:".e-last",ctrlAltPageUp:".e-first",altPageUp:".e-pp",altPageDown:".e-np"},uit=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),kk=function(n){function t(){var t=null!==n&&n.apply(this,arguments)||this;return t.element=t.parent.createElement("TH",{className:"e-filterbarcell"}),t}return uit(t,n),t.prototype.getGui=function(){return this.parent.createElement("div")},t.prototype.render=function(n,t){var u,y=this.parent.element.querySelector(".e-filterbar"),f=this.element.cloneNode(),e=this.getGui(),i=n.column,s,v,l,o,h,a,c;return(y.appendChild(f),f.setAttribute("e-mappinguid",i.uid),i.filterTemplate)?(s={},t&&(s[i.field]=t[i.field]),(s.column=i,i.visible)?(v=this.parent.isReact&&"string"!=typeof i.filterTemplate,l=this.parent.element.id+i.uid+"filterTemplate",v?(i.getFilterTemplate()(s,this.parent,"filterTemplate",l,null,null,f),this.parent.renderTemplates()):rt(f,i.getFilterTemplate()(s,this.parent,"filterTemplate",l))):f.classList.add("e-hide")):"checkbox"!==i.type&&((Object(r.isNullOrUndefined)(i.allowFiltering)||i.allowFiltering)&&!Object(r.isNullOrUndefined)(i.filterBarTemplate)?(f.classList.add("e-fltrtemp"),Object(r.attributes)(e,{"class":"e-fltrtempdiv"}),Object(r.isNullOrUndefined)(i.filterBarTemplate.create))?(u=this.parent.createElement("input",{id:i.field+"_filterBarcell",className:"e-filterUi_input e-filtertext e-fltrTemp",attrs:{type:"search",title:i.headerText}}),e.appendChild(u)):(o={column:i,node:Element},h=i.filterBarTemplate.create,("string"==typeof h&&(h=Object(r.getValue)(h,window)),"string"==typeof(u=h(o)))&&(a=this.parent.createElement("div"),a.innerHTML=u,u=a.firstChild),Object(r.attributes)(e,{"class":"e-filterUi_input e-filtertext e-fltrTemp",title:i.headerText,id:i.field+"_filterBarcell"}),e.appendChild(u)):(Object(r.attributes)(e,{"class":"e-filterdiv e-fltrinputdiv"}),u=this.parent.createElement("input",{id:i.field+"_filterBarcell",className:"e-filtertext",attrs:{type:"search",title:i.headerText+n.attributes.title,value:t[n.column.field]?t[n.column.field]:"",role:"search"}}),e.appendChild(u),o={element:u,floatLabelType:"Never",properties:{enableRtl:this.parent.enableRtl,showClearButton:!0}},rr.Input.createInput(o,this.parent.createElement)),((!1===i.allowFiltering||""===i.field||Object(r.isNullOrUndefined)(i.field))&&(u.setAttribute("disabled","true"),u.classList.add("e-disable")),i.visible||f.classList.add("e-hide"),this.appendHtml(f,e),this.parent.filterSettings.showFilterBarOperator&&"FilterBar"===this.parent.filterSettings.type&&!this.parent.isPrinting&&Object(r.isNullOrUndefined)(i.filterTemplate)&&this.operatorIconRender(e,i,n),(Object(r.isNullOrUndefined)(i.allowFiltering)||i.allowFiltering)&&!Object(r.isNullOrUndefined)(i.filterBarTemplate))&&(c=i.filterBarTemplate.write,o={element:u,column:i},"string"==typeof c&&(c=Object(r.getValue)(c,window)),c.call(this,o))),f},t.prototype.appendHtml=function(n,t){return n.appendChild(t),n},t.prototype.operatorIconRender=function(n,t,i){var u=this.parent,o=this.parent.createElement("input",{className:" e-filterbaroperator e-icons e-icon-filter",id:i.column.uid}),f,e;n.querySelector("span").appendChild(o);f=t.filter&&t.filter.operator?t.filter.operator:"equal";Object(r.isNullOrUndefined)(u.filterModule.operators[t.field])||(f=u.filterModule.operators[t.field]);this.dropOptr=new li.DropDownList({fields:{text:"text",value:"value"},popupHeight:"auto",value:f,width:"0px",enabled:t.allowFiltering,popupWidth:"auto",enableRtl:this.parent.enableRtl,change:this.internalEvent.bind(this),beforeOpen:function(){var i=u.filterModule.customOperators,n;for(this.dataSource=i[u.getColumnByUid(this.element.id).type+"Operator"],n=0;n<this.dataSource.length;n++)t.filter&&t.filter.operator&&Object(r.isNullOrUndefined)(u.filterModule.operators[t.field])&&this.dataSource[n].value===t.filter.operator&&(this.value=t.filter.operator)}});this.dropOptr.appendTo(o);e=Object(r.closest)(this.dropOptr.element,"span");e.classList.add("e-filterbardropdown");e.removeAttribute("tabindex")},t.prototype.internalEvent=function(n){var t=this.parent,i=t.getColumnByUid(n.element.getAttribute("id"));n.column=i;t.filterModule.operators[i.field]=n.value;t.notify(cw,n)},t}(ht),dk=function(){function n(n,t,i,r){this.parent=n;this.serviceLocator=i;this.filterSettings=r;this.customFilterOperators=t}return n.prototype.renderOperatorUI=function(n,t,i,u){var f,o;this.dialogObj=u;f=i.type+"Operator";this.optrData=this.customOptr=Object(r.isNullOrUndefined)(this.parent.filterSettings.operators)||Object(r.isNullOrUndefined)(this.parent.filterSettings.operators[f])?this.customFilterOperators[f]:this.parent.filterSettings.operators[f];var s=this.customOptr,h=this.dropSelectedVal(i,f),e=this.parent.createElement("div",{className:"e-flm_optrdiv"});n.appendChild(e);o=this.parent.createElement("input",{id:i.uid+"-floptr"});e.appendChild(o);this.dropOptr=new li.DropDownList({dataSource:s,fields:{text:"text",value:"value"},open:this.dropDownOpen.bind(this),cssClass:"e-popup-flmenu",text:h});this.dropOptr.appendTo("#"+i.uid+"-floptr")},n.prototype.dropDownOpen=function(n){n.popup.element.style.zIndex=(this.dialogObj.zIndex+1).toString()},n.prototype.dropSelectedVal=function(n){for(var u,o,h,i,t="",f=0,s=this.parent.filterSettings.columns;f<s.length;f++)u=s[f],(n.field===u.field||n.isForeignColumn()&&n.foreignKeyValue===u.field)&&(o=new e.DataManager(this.optrData).executeLocal((new e.Query).where("value","equal",u.operator)),t=Object(r.isNullOrUndefined)(o[0])?"":o[0].text);if(""===t)if(n.filter.operator)for(h=Object.keys(this.optrData).length,i=0;i<h;i++)this.optrData[i].value===n.filter.operator&&(t=this.optrData[i].text);else t=this.optrData[0].text;return t},n.prototype.getFlOperator=function(){return this.dropOptr.value},n}(),gk=function(){function n(n,t,i){this.parent=n;this.serLocator=t;this.filterSettings=i}return n.prototype.create=function(n){this.instance=this.parent.createElement("input",{className:"e-flmenu-input",id:"strui-"+n.column.uid});n.target.appendChild(this.instance);this.dialogObj=n.dialogObj;this.actObj=this.getAutoCompleteOptions(n);this.actObj.appendTo(this.instance)},n.prototype.getAutoCompleteOptions=function(n){var i=this,f=n.column.isForeignColumn(),t=f?n.column.dataSource:this.parent.dataSource,s={value:f?n.column.foreignKeyValue:n.column.field},o=new li.AutoComplete(Object(r.extend)({dataSource:t instanceof e.DataManager?t:new e.DataManager(t),fields:s,locale:this.parent.locale,enableRtl:this.parent.enableRtl,query:this.parent.query.clone(),sortOrder:"Ascending",open:this.openPopup.bind(this),cssClass:"e-popup-flmenu",focus:function(){i.actObj.filterType=n.getOptrInstance.getFlOperator()},autofill:!0,placeholder:n.localizeText.getConstant("EnterValue"),actionComplete:function(n){n.result=n.result.filter(function(n,t,u){return u.map(function(n){return Object(r.getValue)(i.actObj.fields.value,n)}).indexOf(Object(r.getValue)(i.actObj.fields.value,n))===t})}},n.column.filter.params)),u;return t&&"result"in t&&(u=ah({requestType:"stringfilterrequest"},this.parent.getQuery?this.parent.getQuery().clone():new e.Query),this.parent.trigger(nf,u.state),u.deffered.promise.then(function(n){o.dataSource=new e.DataManager(n)})),o},n.prototype.write=function(n){this.filterSettings.columns;""===n.filteredValue||Object(r.isNullOrUndefined)(n.filteredValue)||(document.querySelector("#strui-"+n.column.uid).ej2_instances[0].value=n.filteredValue)},n.prototype.read=function(n,t,i,u){var e=document.querySelector("#strui-"+t.uid).ej2_instances[0],f;r.Browser.isDevice&&(e.hidePopup(),e.focusOut());f=e.value;(Object(r.isNullOrUndefined)(f)||""===f)&&(f=null);u.filterByColumn(t.field,i,f,"and",this.parent.filterSettings.enableCaseSensitivity)},n.prototype.openPopup=function(n){nv(n,this.dialogObj)},n}(),nd=function(){function n(n,t,i){this.filterSettings=i;this.parent=n;this.serviceLocator=t}return n.prototype.create=function(n){this.instance=this.parent.createElement("input",{className:"e-flmenu-input",id:"numberui-"+n.column.uid});n.target.appendChild(this.instance);this.numericTxtObj=new rr.NumericTextBox(Object(r.extend)({format:"string"==typeof n.column.format||Object(r.isUndefined)(n.column.format)?n.column.format:n.column.format.format,locale:this.parent.locale,cssClass:"e-popup-flmenu",placeholder:n.localizeText.getConstant("EnterValue"),enableRtl:this.parent.enableRtl},n.column.filter.params));this.numericTxtObj.appendTo(this.instance)},n.prototype.write=function(n){document.querySelector("#numberui-"+n.column.uid).ej2_instances[0].value=n.filteredValue},n.prototype.read=function(n,t,i,r){var u=document.querySelector("#numberui-"+t.uid).ej2_instances[0].value;r.filterByColumn(t.field,i,u,"and",!0)},n}(),td=function(){function n(n,t,i){this.parent=n;this.serviceLocator=t;this.filterSettings=i}return n.prototype.create=function(n){var u=n.column.isForeignColumn(),i=u?n.column.dataSource:this.parent.dataSource,t=u?n.column.foreignKeyValue:n.column.field;this.elem=this.parent.createElement("input",{className:"e-flmenu-input",id:"bool-ui-"+n.column.uid});n.target.appendChild(this.elem);this.dialogObj=n.dialogObj;this.dropInstance=new li.DropDownList(Object(r.extend)({dataSource:i instanceof e.DataManager?i:new e.DataManager(i),query:(new e.Query).select(t),fields:{text:t,value:t},placeholder:n.localizeText.getConstant("SelectValue"),cssClass:"e-popup-flmenu",locale:this.parent.locale,enableRtl:this.parent.enableRtl,open:this.openPopup.bind(this),actionComplete:function(n){n.result=e.DataUtil.distinct(n.result,t,!0)}},n.column.filter.params));this.dropInstance.appendTo(this.elem)},n.prototype.write=function(n){var t=document.querySelector("#bool-ui-"+n.column.uid).ej2_instances[0];Object(r.isNullOrUndefined)(n.filteredValue)||(t.text=n.filteredValue)},n.prototype.read=function(n,t,i,r){var u=document.querySelector("#bool-ui-"+t.uid).ej2_instances[0].value;r.filterByColumn(t.field,i,u,"and",!1)},n.prototype.openPopup=function(n){nv(n,this.dialogObj)},n}(),ov=function(){function n(n,t,i){this.parent=n;this.locator=t;this.fltrSettings=i}return n.prototype.create=function(n){var t=to(n.column.format,n.column.type);this.dialogObj=n.dialogObj;this.inputElem=this.parent.createElement("input",{className:"e-flmenu-input",id:"dateui-"+n.column.uid});n.target.appendChild(this.inputElem);"date"===n.column.type?this.datePickerObj=new vu.DatePicker(Object(r.extend)({format:t,cssClass:"e-popup-flmenu",placeholder:n.localizeText.getConstant("ChooseDate"),width:"100%",locale:this.parent.locale,enableRtl:this.parent.enableRtl,open:this.openPopup.bind(this)},n.column.filter.params)):"datetime"===n.column.type&&(this.datePickerObj=new vu.DateTimePicker(Object(r.extend)({format:t,cssClass:"e-popup-flmenu",placeholder:n.localizeText.getConstant("ChooseDate"),width:"100%",locale:this.parent.locale,enableRtl:this.parent.enableRtl,open:this.openPopup.bind(this)},n.column.filter.params)));this.datePickerObj.appendTo(this.inputElem)},n.prototype.write=function(n){this.fltrSettings.columns;document.querySelector("#dateui-"+n.column.uid).ej2_instances[0].value=Object(r.isNullOrUndefined)(n.filteredValue)?null:new Date(n.filteredValue)},n.prototype.read=function(n,t,i,u){var f=document.querySelector("#dateui-"+t.uid).ej2_instances[0].value;f=Object(r.isNullOrUndefined)(f)?null:f;u.filterByColumn(t.field,i,f,"and",!0)},n.prototype.openPopup=function(n){n.popup.element.style.zIndex=(this.dialogObj.zIndex+1).toString()},n}(),fit=function(){function n(n,t,i,r,u){this.isDialogOpen=!1;this.colTypes={string:gk,number:nd,date:ov,boolean:td,datetime:ov};this.parent=n;this.filterSettings=t;this.serviceLocator=i;this.customFilterOperators=r;this.filterObj=u;this.flMuiObj=new dk(this.parent,this.customFilterOperators,this.serviceLocator);this.l10n=this.serviceLocator.getService("localization")}return n.prototype.openDialog=function(n){this.col=this.parent.getColumnByField(n.field);(Object(r.isNullOrUndefined)(this.col.filter)||Object(r.isNullOrUndefined)(this.col.filter.type)||"Menu"===this.col.filter.type)&&this.renderDlgContent(n.target,this.col)},n.prototype.closeDialog=function(n){var i,t,e,u,f;if(this.dlgObj){if(Object(r.isBlazor)())for(i=this.parent.getColumns(),t=0;t<i.length;t++)i[t].filterTemplate&&(e=this.parent.element.id+i[t].uid+"filterTemplate",Object(r.updateBlazorTemplate)(e,"FilterTemplate",i[t]));if(this.parent.isReact&&(this.parent.destroyTemplate(["filterTemplate"]),this.parent.renderTemplates()),u=document.getElementById(this.dlgObj.element.id),this.dlgObj&&!this.dlgObj.isDestroyed&&u){if(f={cancel:!1,column:this.col,target:n,element:u},this.parent.notify(ue,f),f.cancel)return;this.isDialogOpen=!1;this.dlgObj.destroy();Object(r.remove)(u)}}},n.prototype.renderDlgContent=function(n,t){var i={requestType:wc,columnName:t.field,columnType:t.type},u;(!Object(r.isBlazor)()||this.parent.isJsComponent)&&(i.filterModel=this);this.parent.trigger(l,i);u=this.parent.createElement("div",{className:"e-flmenu-maindiv",id:t.uid+"-flmenu"});this.dlgDiv=this.parent.createElement("div",{className:"e-flmenu",id:t.uid+"-flmdlg"});this.dlgDiv.setAttribute("aria-label",this.l10n.getConstant("FilterMenuDialogARIA"));this.parent.element.appendChild(this.dlgDiv);this.dlgObj=new ft.Dialog({showCloseIcon:!1,closeOnEscape:!1,locale:this.parent.locale,visible:!1,enableRtl:this.parent.enableRtl,created:this.dialogCreated.bind(this,n,t),position:this.parent.element.classList.contains("e-device")?{X:"center",Y:"center"}:{X:"",Y:""},target:this.parent.element.classList.contains("e-device")?document.body:this.parent.element,buttons:[{click:this.filterBtnClick.bind(this,t),buttonModel:{content:this.l10n.getConstant("FilterButton"),isPrimary:!0,cssClass:"e-flmenu-okbtn"}},{click:this.clearBtnClick.bind(this,t),buttonModel:{content:this.l10n.getConstant("ClearButton"),cssClass:"e-flmenu-cancelbtn"}}],content:u,width:!Object(r.isNullOrUndefined)(o(n,"e-bigger"))||this.parent.element.classList.contains("e-device")?260:250,animationSettings:{effect:"None"},cssClass:"e-filter-popup"});this.dlgObj.isStringTemplate=!0;this.dlgObj.appendTo(this.dlgDiv)},n.prototype.dialogCreated=function(n,t){r.Browser.isDevice||ga(n,this.dlgObj,this.parent);this.renderFilterUI(n,t);this.parent.notify(re,{});this.dlgObj.element.style.maxHeight="350px";this.dlgObj.show();t.filterTemplate||this.writeMethod(t,this.dlgObj.element.querySelector("#"+t.uid+"-flmenu"));var i={requestType:pc,columnName:t.field,columnType:t.type};(!Object(r.isBlazor)()||this.parent.isJsComponent)&&(i.filterModel=this);this.isDialogOpen=!0;this.parent.trigger(c,i)},n.prototype.renderFilterUI=function(n,t){var i=this.dlgObj.element.querySelector(".e-flmenu-maindiv");this.parent.log("column_type_missing",{column:t});this.renderOperatorUI(i,n,t);this.renderFlValueUI(i,n,t)},n.prototype.renderOperatorUI=function(n,t,i){this.flMuiObj.renderOperatorUI(n,t,i,this.dlgObj)},n.prototype.renderFlValueUI=function(n,t,i){var f=this.parent.createElement("div",{className:"e-flmenu-valuediv"}),s=this.filterObj,h,u,c,o,l,e;n.appendChild(f);this.flMuiObj;this.dlgObj;h=new this.colTypes[i.type](this.parent,this.serviceLocator,this.parent.filterSettings);i.filterTemplate?(u={},u[i.field]=u.value=s.values[i.field],i.foreignKeyValue&&(u[i.foreignKeyValue]=s.values[i.field],u[i.field]=void 0),u.column=i,c=this.parent.isReact&&"string"!=typeof i.filterTemplate,o=this.parent.element.id+i.uid+"filterTemplate",c?(i.getFilterTemplate()(u,this.parent,"filterTemplate",o,null,null,f),this.parent.renderTemplates()):(l=i.getFilterTemplate()(u,this.parent,"filterTemplate",o),Object(r.updateBlazorTemplate)(o,"FilterTemplate",i),rt(f,l))):Object(r.isNullOrUndefined)(i.filter)||Object(r.isNullOrUndefined)(i.filter.ui)||Object(r.isNullOrUndefined)(i.filter.ui.create)?h.create({column:i,target:f,getOptrInstance:this.flMuiObj,localizeText:this.l10n,dialogObj:this.dlgObj}):(e=i.filter.ui.create,"string"==typeof e&&(e=Object(r.getValue)(e,window)),e({column:i,target:f,getOptrInstance:this.flMuiObj,dialogObj:this.dlgObj}))},n.prototype.writeMethod=function(n,t){for(var e,i,u,o=t.querySelector(".e-flmenu-valinput"),h=new this.colTypes[n.type](this.parent,this.serviceLocator,this.parent.filterSettings),f=0,s=this.filterSettings.columns;f<s.length;f++)e=s[f],n.uid===e.uid&&(u=e.value);Object(r.isNullOrUndefined)(n.filter)||Object(r.isNullOrUndefined)(n.filter.ui)||Object(r.isNullOrUndefined)(n.filter.ui.write)?h.write({column:n,target:o,parent:this.parent,filteredValue:u}):(i=n.filter.ui.write,"string"==typeof i&&(i=Object(r.getValue)(i,window)),i({column:n,target:o,parent:this.parent,filteredValue:u}))},n.prototype.filterBtnClick=function(n){var e,s=this.dlgObj.element.querySelector(".e-flmenu-valuediv input"),h,t,i,u,f,c,o;e=this.flMuiObj.getFlOperator();h=new this.colTypes[n.type](this.parent,this.serviceLocator,this.parent.filterSettings);n.filterTemplate?(t=this.dlgDiv.querySelector(".e-flmenu-valuediv"),i=void 0,t.children[0].value?i=t.children[0].value:Object(r.isBlazor)()||Object(r.isNullOrUndefined)(t.children[0].ej2_instances)?(u=t.querySelector(".e-control"),i="boolean"===n.type?u.checked:Object(r.isNullOrUndefined)(u.ej2_instances)?u.value:u.ej2_instances[0].value):i=t.children[0].ej2_instances[0].value,this.filterObj.filterByColumn(n.field,e,i)):Object(r.isNullOrUndefined)(n.filter)||Object(r.isNullOrUndefined)(n.filter.ui)||Object(r.isNullOrUndefined)(n.filter.ui.read)?h.read(s,n,e,this.filterObj):(f=n.filter.ui.read,"string"==typeof f&&(f=Object(r.getValue)(f,window)),f({element:s,column:n,operator:e,fltrObj:this.filterObj}));c=this.parent.showColumnMenu?".e-columnmenu":".e-icon-filter";o=this.parent.element.querySelector('[e-mappinguid="'+n.uid+'"]').parentElement.querySelector(c);o&&o.classList.add("e-filtered");this.closeDialog()},n.prototype.clearBtnClick=function(n){this.filterObj.removeFilteredColsByField(n.field);Object(r.isBlazor)()&&!this.parent.isJsComponent&&this.parent.setProperties({filterSettings:{columns:this.filterSettings.columns}},!0);this.closeDialog();var i=this.parent.showColumnMenu?".e-columnmenu":".e-icon-filter",t=this.parent.element.querySelector('[e-mappinguid="'+n.uid+'"]').parentElement.querySelector(i);t&&t.classList.remove("e-filtered")},n.prototype.destroy=function(){this.closeDialog()},n.prototype.getFilterUIInfo=function(){return{field:this.col.field,operator:this.flMuiObj.getFlOperator()}},n}(),sv=function(){function n(n){this.parent=n;this.isresetFocus=!0;this.checkBoxBase=new au(n);this.addEventListener()}return n.prototype.destroy=function(){this.removeEventListener();this.checkBoxBase.closeDialog()},n.prototype.openDialog=function(n){this.checkBoxBase.openDialog(n);this.parent.log("column_type_missing",{column:n.column})},n.prototype.closeDialog=function(){this.removeEventListener();this.checkBoxBase.closeDialog();this.isresetFocus&&this.parent.notify(fu,{})},n.prototype.getModuleName=function(){return"checkboxFilter"},n.prototype.actionBegin=function(n){this.parent.trigger(l,n)},n.prototype.actionComplete=function(n){this.parent.trigger(c,n)},n.prototype.actionPrevent=function(n){si(this.parent)&&(this.parent.notify(ot,n),n.cancel=!0)},n.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(es,this.actionBegin,this),this.parent.on(oe,this.actionComplete,this),this.parent.on(uf,this.actionPrevent,this))},n.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(es,this.actionBegin),this.parent.off(oe,this.actionComplete),this.parent.off(uf,this.actionPrevent))},n}(),eit=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),id=function(n){function t(t,i,r,u){var f=n.call(this,t,i,r)||this;return f.parent=t,f.isresetFocus=!0,f.excelFilterBase=new ak(t,u),f}return eit(t,n),t.prototype.destroy=function(){this.excelFilterBase.closeDialog()},t.prototype.openDialog=function(n){this.excelFilterBase.openDialog(n)},t.prototype.closeDialog=function(){this.excelFilterBase.closeDialog();this.isresetFocus&&this.parent.notify(fu,{})},t.prototype.filterByColumn=function(n,t,i,r,u,f,e,o){this.excelFilterBase.filterByColumn(n,t,i,r,u,f,e,o)},t.prototype.getFilterUIInfo=function(){return this.excelFilterBase.getFilterUIInfo()},t.prototype.getModuleName=function(){return"excelFilter"},t}(sv),yh=function(){function n(n,t,i){this.predicate="and";this.contentRefresh=!0;this.filterByMethod=!0;this.refresh=!0;this.values={};this.operators={};this.cellText={};this.nextFlMenuOpen="";this.type={Menu:fit,CheckBox:sv,Excel:id};this.filterOperators={contains:"contains",endsWith:"endswith",equal:"equal",greaterThan:"greaterthan",greaterThanOrEqual:"greaterthanorequal",lessThan:"lessthan",lessThanOrEqual:"lessthanorequal",notEqual:"notequal",startsWith:"startswith"};this.fltrDlgDetails={field:"",isOpen:!1};this.skipNumberInput=["="," ","!"];this.skipStringInput=[">","<","="];this.actualPredicate={};this.parent=n;this.filterSettings=t;this.serviceLocator=i;this.addEventListener()}return n.prototype.render=function(n){var i,f,t,o,s,c,u;e.DataUtil.getObject("args.isFrozen",n)||(i=this.parent,(this.l10n=this.serviceLocator.getService("localization"),this.getLocalizedCustomOperators(),"FilterBar"===this.parent.filterSettings.type&&i.columns.length)&&(f=this.parent.element.querySelector(".e-filterbar"),f&&Object(r.remove)(f),t=new dt(this.serviceLocator,h.Filter,i),o=void 0,this.serviceLocator.getService("cellRendererFactory").addCellRenderer(h.Filter,new kk(this.parent,this.serviceLocator)),this.valueFormatter=this.serviceLocator.getService("valueFormatter"),t.element=this.parent.createElement("tr",{className:"e-filterbar"}),(o=this.generateRow()).data=this.values,this.parent.getHeaderContent().querySelector("thead").appendChild(t.element),s=this.parent.element.querySelector(".e-rowdragheader"),this.element=t.render(o,i.getColumns(),null,null,t.element),c=this.element.querySelector(".e-detailheadercell"),c&&(c.className="e-filterbarcell e-mastercell"),s&&(s.className="e-dragheadercell e-mastercell"),u=[].slice.call(this.element.querySelectorAll(".e-grouptopleftcell")),u.length&&u[u.length-1].classList.add("e-lastgrouptopleftcell"),this.wireEvents(),this.parent.notify(ki,{"case":"filter"})))},n.prototype.destroy=function(){var t=this.parent.element,i,n,u;if(t&&(t.querySelector(".e-gridheader")||t.querySelector(".e-gridcontent"))){if(this.filterModule&&this.filterModule.destroy(),this.parent.refreshing||(this.filterSettings.columns=[]),this.updateFilterMsg(),this.removeEventListener(),this.unWireEvents(),"FilterBar"===this.filterSettings.type&&this.filterSettings.showFilterBarOperator)for(i=this.element.querySelectorAll(".e-filterbaroperator"),n=0;n<i.length;n++)i[n].ej2_instances[0].destroy();this.element&&(Object(r.remove)(this.element),u=this.parent.getHeaderContent().querySelector(".e-filterbar"),this.parent.getFrozenColumns()&&u&&Object(r.remove)(u))}},n.prototype.generateRow=function(){var n=new kt({});return n.cells=this.generateCells(),n},n.prototype.generateCells=function(){var n=[],i,u,t,r,f;if(this.parent.allowGrouping)for(i=0,u=this.parent.groupSettings.columns.length;i<u;i++)n.push(this.generateCell({},h.HeaderIndent));for((this.parent.detailTemplate||this.parent.childGrid)&&n.push(this.generateCell({},h.DetailHeader)),this.parent.isRowDragable()&&n.push(this.generateCell({},h.RowDragHIcon)),t=0,r=this.parent.getColumns();t<r.length;t++)f=r[t],n.push(this.generateCell(f));return n},n.prototype.generateCell=function(n,t){var i={visible:n.visible,isDataCell:!1,rowId:"",column:n,cellType:t||h.Filter,attributes:{title:this.l10n.getConstant("FilterbarTitle")}};return new st(i)},n.prototype.updateModel=function(){for(var u,i,n=this.parent.getColumnByField(this.fieldName),r=Array.isArray(this.value)?this.value:[this.value],t=0,f=r.length;t<f;t++)u=n.isForeignColumn()?n.foreignKeyValue:this.fieldName,this.currentFilterObject={field:u,uid:n.uid,isForeignKey:n.isForeignColumn(),operator:this.operator,value:r[t],predicate:this.predicate,matchCase:this.matchCase,ignoreAccent:this.ignoreAccent,actualFilterValue:{},actualOperator:{}},i=this.getFilteredColsIndexByField(n),i>-1&&!Array.isArray(this.value)?this.filterSettings.columns[i]=this.currentFilterObject:this.filterSettings.columns.push(this.currentFilterObject);this.filterSettings.columns=this.filterSettings.columns;this.parent.dataBind()},n.prototype.getFilteredColsIndexByField=function(n){for(var i=this.filterSettings.columns,t=0,r=i.length;t<r;t++)if(i[t].uid===n.uid||n.isForeignColumn()&&this.parent.getColumnByUid(n.uid).field===n.foreignKeyValue)return t;return-1},n.prototype.onActionComplete=function(n){Object(r.isBlazor)()&&!this.parent.isJsComponent&&(n.rows=null);var t=this.isRemove?{requestType:"filtering",type:c}:{currentFilterObject:this.currentFilterObject,currentFilteringColumn:Object(r.isNullOrUndefined)(this.column)?void 0:this.column.field,columns:this.filterSettings.columns,requestType:"filtering",type:c};this.parent.trigger(c,Object(r.extend)(n,t));this.isRemove=!1},n.prototype.wireEvents=function(){r.EventHandler.add(this.parent.getHeaderContent(),"keyup",this.keyUpHandlerImmediate,this)},n.prototype.unWireEvents=function(){r.EventHandler.remove(this.parent.getHeaderContent(),"keyup",this.keyUpHandlerImmediate)},n.prototype.enableAfterRender=function(n){n.module===this.getModuleName()&&n.enable&&(this.parent.getHeaderTable().classList.add("e-sortfilter"),this.render())},n.prototype.initialEnd=function(){var r,t,i,n;if(this.parent.off(y,this.initialEnd),this.parent.getColumns().length&&this.filterSettings.columns.length){for(r=this.parent,this.contentRefresh=!1,this.initialLoad=!0,t=0,i=r.filterSettings.columns;t<i.length;t++)n=i[t],this.filterByColumn(n.field,n.operator,n.value,n.predicate,n.matchCase,n.ignoreAccent,n.actualFilterValue,n.actualOperator);this.initialLoad=!1;this.updateFilterMsg();this.contentRefresh=!0}},n.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(v,this.enableAfterRender,this),this.parent.on(dc,this.onActionComplete,this),this.parent.on(d,this.onPropertyChanged,this),this.parent.on(w,this.keyUpHandler,this),this.parent.on(lr,this.columnPositionChanged,this),this.parent.on(g,this.render,this),this.parent.on(y,this.initialEnd,this),this.parent.on(ue,this.filterMenuClose,this),r.EventHandler.add(document,"click",this.clickHandler,this),this.parent.on(ko,this.columnMenuFilter,this),this.parent.on(it,this.filterIconClickHandler,this),this.parent.on("persist-data-changed",this.initialEnd,this),this.parent.on(ps,this.clickHandler,this))},n.prototype.removeEventListener=function(){r.EventHandler.remove(document,"click",this.clickHandler);this.parent.isDestroyed||(this.parent.off(v,this.enableAfterRender),this.parent.off(dc,this.onActionComplete),this.parent.off(d,this.onPropertyChanged),this.parent.off(w,this.keyUpHandler),this.parent.off(lr,this.columnPositionChanged),this.parent.off(g,this.render),this.parent.off(ko,this.columnMenuFilter),this.parent.off(ue,this.filterMenuClose),this.parent.off(it,this.filterIconClickHandler),this.parent.off(ps,this.clickHandler))},n.prototype.filterMenuClose=function(){this.fltrDlgDetails.isOpen=!1},n.prototype.filterByColumn=function(n,t,i,u,f,e,o,s){var h,a=this,c=this.parent,l;if(this.column=c.grabColumnByFieldFromAllCols(n),"FilterBar"===this.filterSettings.type&&this.filterSettings.showFilterBarOperator&&(t=this.getOperatorName(n)),this.column)if("FilterBar"===this.filterSettings.type&&(h=c.getHeaderContent().querySelector("[id='"+this.column.field+"_filterBarcell']")),Object(r.isNullOrUndefined)(this.column.allowFiltering)||this.column.allowFiltering)if(si(c))c.notify(ot,{instance:this,handler:this.filterByColumn,arg1:n,arg2:t,arg3:i,arg4:u,arg5:f,arg6:e,arg7:o,arg8:s});else{if(this.predicate=u||(Array.isArray(i)?"or":"and"),this.value=i,this.matchCase=f||!1,this.ignoreAccent=this.ignoreAccent=Object(r.isNullOrUndefined)(e)?this.parent.filterSettings.ignoreAccent:e,this.fieldName=n,this.operator=t,i=!Object(r.isNullOrUndefined)(i)&&i.toString(),"number"!==this.column.type&&"date"!==this.column.type||(this.matchCase=!0),c.getColumnHeaderByField(n).setAttribute("aria-filtered","true"),h&&"FilterBar"===this.filterSettings.type){if(i.length<1||!this.filterByMethod&&this.checkForSkipInput(this.column,i))return this.filterStatusMsg=i.length<1?"":this.l10n.getConstant("InvalidFilterMessage"),void this.updateFilterMsg();h.value!==i&&(h.value=i)}Object(r.isNullOrUndefined)(this.column.format)?this.values[this.column.field]=i:(this.applyColumnFormat(i),this.initialLoad&&"FilterBar"===this.filterSettings.type&&(h.value=this.values[this.column.field]));l={field:this.fieldName,predicate:u,matchCase:f,ignoreAccent:e,operator:this.operator,value:this.value,type:this.column.type};this.parent.filterSettings.columns.filter(function(n){return n.field===a.fieldName}).length>1&&!Object(r.isNullOrUndefined)(this.actualPredicate[this.fieldName])?this.actualPredicate[this.fieldName].push(l):this.actualPredicate[this.fieldName]=[l];this.addFilteredClass(this.fieldName);this.checkAlreadyColFiltered(this.column.field)||this.updateModel()}else this.parent.log("action_disabled_column",{moduleName:this.getModuleName(),columnName:this.column.headerText})},n.prototype.applyColumnFormat=function(n){var t="date"===this.column.type||"datetime"===this.column.type?new Date(n):parseFloat(n);this.values[this.column.field]=this.setFormatForFlColumn(t,this.column)},n.prototype.skipUid=function(n){for(var i,r=!0,u=Object.keys(n).length,t=0;t<u;t++)i=Object.keys(n[t]),1===i.length&&"uid"===i[0]&&(r=!1);return r},n.prototype.onPropertyChanged=function(n){var t,i,r;if(n.module===this.getModuleName())for(t=0,i=Object.keys(n.properties);t<i.length;t++){r=i[t];switch(r){case"columns":this.contentRefresh&&this.skipUid(n.properties.columns)&&(this.parent.notify(p,{currentFilterObject:this.currentFilterObject,currentFilteringColumn:this.column?this.column.field:void 0,action:"filter",columns:this.filterSettings.columns,requestType:"filtering",type:l,cancel:!1}),this.refreshFilterSettings(),this.updateFilterMsg(),this.updateFilter());break;case"showFilterBarStatus":n.properties[r]?this.updateFilterMsg():this.parent.allowPaging&&this.parent.updateExternalMessage("");break;case"showFilterBarOperator":case"type":this.parent.refreshHeader();this.refreshFilterSettings()}}},n.prototype.refreshFilterSettings=function(){var n,t,f,u,i;if("FilterBar"===this.filterSettings.type){for(n=0;n<this.filterSettings.columns.length;n++)this.column=this.parent.grabColumnByUidFromAllCols(this.filterSettings.columns[n].uid),t=this.filterSettings.columns[n].value,(t=!Object(r.isNullOrUndefined)(t)&&t.toString(),Object(r.isNullOrUndefined)(this.column.format))?(f=this.filterSettings.columns[n].field,this.values[f]=this.filterSettings.columns[n].value):this.applyColumnFormat(t),(i=this.getFilterBarElement(this.column.field))&&(i.value=""===this.cellText[this.filterSettings.columns[n].field]||Object(r.isNullOrUndefined)(this.cellText[this.filterSettings.columns[n].field])?this.filterSettings.columns[n].value:this.cellText[this.column.field]);if(0===this.filterSettings.columns.length)for(u=this.parent.getColumns(),n=0;n<u.length;n++)(i=this.getFilterBarElement(u[n].field))&&""!==i.value&&(i.value="",delete this.values[u[n].field])}},n.prototype.getFilterBarElement=function(n){var t,i="[id='"+n+"_filterBarcell']";return i&&!Object(r.isNullOrUndefined)(this.element)&&(t=this.element.querySelector(i)),t},n.prototype.refreshFilter=function(){this.refreshFilterSettings();this.updateFilterMsg()},n.prototype.clearFiltering=function(n){var s=this,i=uh(this.filterSettings.columns),t,o,u,f,e;if(!Object(r.isNullOrUndefined)(n))return this.refresh=!1,n.forEach(function(n){s.removeFilteredColsByField(n,!1)}),this.parent.setProperties({filterSettings:{columns:this.filterSettings.columns}},!0),this.parent.renderModule.refresh(),void(this.refresh=!0);if(si(this.parent))this.parent.notify(ot,{instance:this,handler:this.clearFiltering});else{for(t=0;t<i.length;t++)i[t].uid=i[t].uid||this.parent.getColumnByField(i[t].field).uid;for(o=i.map(function(n){return n.uid}),u=o.filter(function(n,t){return o.indexOf(n)===t}),this.refresh=!1,t=0,f=u.length;t<f;t++)this.removeFilteredColsByField(this.parent.getColumnByUid(u[t]).field,!1);if(Object(r.isBlazor)()&&!this.parent.isJsComponent&&this.parent.setProperties({filterSettings:{columns:this.filterSettings.columns}},!0),this.refresh=!0,u.length&&this.parent.renderModule.refresh(),0===this.parent.filterSettings.columns.length&&this.parent.element.querySelector(".e-filtered"))for(e=[].slice.call(this.parent.element.querySelectorAll(".e-filtered")),t=0,f=e.length;t<f;t++)e[0].removeAttribute("aria-filtered"),e[0].classList.remove("e-filtered");this.isRemove=!0;this.filterStatusMsg="";this.updateFilterMsg()}},n.prototype.checkAlreadyColFiltered=function(n){for(var t,i=0,r=this.filterSettings.columns;i<r.length;i++)if(t=r[i],t.field===n&&t.value===this.value&&t.operator===this.operator&&t.predicate===this.predicate)return!0;return!1},n.prototype.columnMenuFilter=function(n){this.column=n.col;var t=Object(r.closest)(n.target,"#"+n.id);n.isClose&&!t?this.filterModule.closeDialog():t&&this.filterDialogOpen(this.column,n.target)},n.prototype.filterDialogOpen=function(n,t,i,u){var f=this.parent,e;this.filterModule&&this.filterModule.closeDialog();this.filterModule=new this.type[n.filter.type||this.parent.filterSettings.type](this.parent,f.filterSettings,this.serviceLocator,this.customOperators,this);e=n.filter.dataSource||f.dataSource&&"result"in f.dataSource?f.dataSource:f.getDataModule().dataManager;this.filterModule.openDialog({type:n.type,field:n.field,displayName:n.headerText,dataSource:e,format:n.format,height:800,columns:f.getColumns(),filteredColumns:f.filterSettings.columns,target:t,dataManager:f.getDataModule().dataManager,formatFn:n.getFormatter(),ignoreAccent:f.filterSettings.ignoreAccent,parserFn:n.getParser(),query:f.query,template:n.getFilterItemTemplate(),hideSearchbox:!Object(r.isNullOrUndefined)(n.filter.hideSearchbox)&&n.filter.hideSearchbox,handler:this.filterHandler.bind(this),localizedStrings:f.getLocaleConstants(),position:{X:i,Y:u},column:n,foreignKeyValue:n.foreignKeyValue,actualPredicate:this.actualPredicate,localeObj:f.localeObj,isRemote:f.getDataModule().isRemote(),allowCaseSensitive:this.filterSettings.enableCaseSensitivity})},n.prototype.removeFilteredColsByField=function(n,t){var e,u=this.filterSettings.columns,o;if(si(this.parent))o={instance:this,handler:this.removeFilteredColsByField,arg1:n,arg2:t},this.parent.notify(ot,o);else{for(var s=u.map(function(n){return n.uid}),h=s.filter(function(n,t){return s.indexOf(n)===t}),c=function(f){var s,o,a,v,c,y;if(u[f].uid=u[f].uid||i.parent.getColumnByField(u[f].field).uid,s=u.length,o=i.parent.grabColumnByUidFromAllCols(h[f]),o.field===n||o.field===o.foreignKeyValue&&o.isForeignColumn()){for(a=i.filterSettings.columns.filter(function(n){return n.uid===o.uid})[0],"FilterBar"!==i.filterSettings.type||t||(v="[id='"+o.field+"_filterBarcell']",(e=i.parent.getHeaderContent().querySelector(v))&&(e.value="",delete i.values[n]));s--;)u[s].uid===o.uid&&u.splice(s,1);return c=i.parent.getColumnHeaderByField(o.field),(c.removeAttribute("aria-filtered"),"FilterBar"!==i.filterSettings.type)&&(y=i.parent.showColumnMenu?".e-columnmenu":".e-icon-filter",c.querySelector(y).classList.remove("e-filtered")),i.isRemove=!0,i.actualPredicate[n]&&delete i.actualPredicate[n],i.values[n]&&delete i.values[n],i.refresh&&(Object(r.isBlazor)()&&!i.parent.isJsComponent?(i.parent.setProperties({filterSettings:{columns:i.filterSettings.columns}},!0),i.parent.notify(p,{requestType:"filtering",type:l,currentFilterObject:{field:o.field,operator:i.operator,value:i.value,predicate:i.predicate,matchCase:i.matchCase,ignoreAccent:i.ignoreAccent,actualFilterValue:{},actualOperator:{}},currentFilterColumn:o})):i.parent.notify(p,{requestType:"filtering",type:l,currentFilterObject:a,currentFilterColumn:o,action:"clearFilter"})),"break"}},i=this,f=0,a=h.length;f<a;f++)if("break"===c(f))break;this.updateFilterMsg()}},n.prototype.getModuleName=function(){return"filter"},n.prototype.keyUpHandlerImmediate=function(n){13!==n.keyCode&&this.keyUpHandler(n)},n.prototype.keyUpHandler=function(n){var i=this.parent,t=n.target,e,f,u,o;if(t&&Object(r.matches)(t,".e-filterbar input")){if(e=Object(r.closest)(t,"th.e-filterbarcell"),this.column=i.getColumnByUid(e.getAttribute("e-mappinguid")),!this.column)return;"altDownArrow"===n.action&&this.parent.filterSettings.showFilterBarOperator&&(f=Object(r.closest)(t,"span").querySelector(".e-filterbaroperator"),f.ej2_instances[0].showPopup(),f.focus());"Immediate"!==this.filterSettings.mode&&(13!==n.keyCode||n.target.classList.contains("e-filterbaroperator"))||9===n.keyCode||(this.value=t.value.trim(),this.processFilter(n))}"altDownArrow"===n.action&&"FilterBar"!==this.filterSettings.type&&(u=i.focusModule.currentInfo.element,u&&u.classList.contains("e-headercell")&&(o=i.getColumnByUid(u.firstElementChild.getAttribute("e-mappinguid")),this.openMenuByField(o.field),this.parent.focusModule.clearIndicator()));"escape"===n.action&&"Menu"===this.filterSettings.type&&this.filterModule&&(this.filterModule.closeDialog(),i.notify(fu,{}))},n.prototype.updateCrossIcon=function(n){n.value.length&&n.nextElementSibling.classList.remove("e-hide")},n.prototype.updateFilterMsg=function(){var t,f;if("FilterBar"===this.filterSettings.type){var i=this.parent,e=void 0,u=this.filterSettings.columns,n=(this.serviceLocator.getService("valueFormatter"),void 0);if(!this.filterSettings.showFilterBarStatus)return;if(u.length>0&&this.filterStatusMsg!==this.l10n.getConstant("InvalidFilterMessage"))for(this.filterStatusMsg="",t=0;t<u.length;t++)(n=i.grabColumnByUidFromAllCols(u[t].uid)||i.grabColumnByFieldFromAllCols(u[t].field),t&&(this.filterStatusMsg+=" && "),Object(r.isNullOrUndefined)(n.format))?this.filterStatusMsg+=n.headerText+": "+this.values[n.field]:(f="date"===n.type||"datetime"===n.type?this.valueFormatter.fromView(this.values[n.field],n.getParser(),n.type):this.values[n.field],e="date"!==n.type&&"datetime"!==n.type?this.serviceLocator.getService("valueFormatter").toView(f,n.getParser()).toString():this.setFormatForFlColumn(f,n),this.filterStatusMsg+=n.headerText+": "+e);i.allowPaging&&i.updateExternalMessage(this.filterStatusMsg);this.filterStatusMsg=""}},n.prototype.setFormatForFlColumn=function(n,t){return this.serviceLocator.getService("valueFormatter").toView(n,t.getFormatter()).toString()},n.prototype.checkForSkipInput=function(n,t){var r,i,u,f;if("number"===n.type)(e.DataUtil.operatorSymbols[t]||this.skipNumberInput.indexOf(t)>-1)&&(r=!0);else if("string"===n.type)for(i=0,u=t;i<u.length;i++)f=u[i],this.skipStringInput.indexOf(f)>-1&&(r=!0);return r},n.prototype.processFilter=function(n){this.stopTimer();this.startTimer(n)},n.prototype.startTimer=function(n){var t=this;this.timer=window.setInterval(function(){t.onTimerTick()},13===n.keyCode?0:this.filterSettings.immediateModeDelay)},n.prototype.stopTimer=function(){window.clearInterval(this.timer)},n.prototype.onTimerTick=function(){var i,u="[id='"+this.column.field+"_filterBarcell']",n=this.element.querySelector(u),t;(!n&&this.parent.getFrozenColumns()&&(n=this.parent.getHeaderContent().querySelector(u)),this.cellText[this.column.field]=n.value,this.stopTimer(),Object(r.isNullOrUndefined)(this.column.filterBarTemplate))?i=JSON.parse(JSON.stringify(n.value)):(t=this.column.filterBarTemplate.read,"string"==typeof t&&(t=Object(r.getValue)(t,window)),Object(r.isNullOrUndefined)(t)||(this.value=t.call(this,n)));Object(r.isNullOrUndefined)(this.value)||""===this.value?this.removeFilteredColsByField(this.column.field):(this.validateFilterValue(this.value),this.filterByMethod=!1,this.filterByColumn(this.column.field,this.operator,this.value,this.predicate,this.filterSettings.enableCaseSensitivity,this.ignoreAccent),this.filterByMethod=!0,n.value=i,this.updateFilterMsg())},n.prototype.validateFilterValue=function(n){var u,i,t;this.parent;switch(this.matchCase=this.filterSettings.enableCaseSensitivity,this.column.type){case"number":for(this.operator=this.column.filter.operator?this.column.filter.operator:this.filterOperators.equal,u=[">","<","=","!"],t=0;t<n.length;t++)if(u.indexOf(n[t])>-1){i=t;break}this.getOperator(n.substring(i));0!==i&&(this.value=n.substring(0,i));""!==this.value&&n.length>=1&&(this.value=this.valueFormatter.fromView(this.value,this.column.getParser(),this.column.type));isNaN(this.value)&&(this.filterStatusMsg=this.l10n.getConstant("InvalidFilterMessage"));break;case"date":case"datetime":this.operator=this.filterOperators.equal;""===this.value||this.value instanceof Date||(this.getOperator(n),this.value=this.valueFormatter.fromView(this.value,this.column.getParser(),this.column.type),Object(r.isNullOrUndefined)(this.value)&&(this.filterStatusMsg=this.l10n.getConstant("InvalidFilterMessage")));break;case"string":this.matchCase=!1;"*"===n.charAt(0)?(this.value=this.value.slice(1),this.operator=this.filterOperators.startsWith):"%"===n.charAt(n.length-1)?(this.value=this.value.slice(0,-1),this.operator=this.filterOperators.startsWith):"%"===n.charAt(0)?(this.value=this.value.slice(1),this.operator=this.filterOperators.endsWith):this.operator=this.column.filter.operator?this.column.filter.operator:this.filterOperators.startsWith;break;case"boolean":"true"===n.toLowerCase()||"1"===n?this.value=!0:"false"===n.toLowerCase()||"0"===n?this.value=!1:n.length&&(this.filterStatusMsg=this.l10n.getConstant("InvalidFilterMessage"));this.operator=this.filterOperators.equal;break;default:this.operator=this.column.filter.operator?this.column.filter.operator:this.filterOperators.equal}},n.prototype.getOperator=function(n){var i=n.charAt(0),u=n.slice(0,2),t=Object(r.extend)({"=":this.filterOperators.equal,"!":this.filterOperators.notEqual},e.DataUtil.operatorSymbols);(t.hasOwnProperty(i)||t.hasOwnProperty(u))&&(this.operator=t[i],this.value=n.substring(1),this.operator||(this.operator=t[u],this.value=n.substring(2)));this.operator!==this.filterOperators.lessThan&&this.operator!==this.filterOperators.greaterThan||"="===this.value.charAt(0)&&(this.operator=this.operator+"orequal",this.value=this.value.substring(1))},n.prototype.columnPositionChanged=function(){this.parent.filterSettings.type},n.prototype.getLocalizedCustomOperators=function(){var n=[{value:"equal",text:this.l10n.getConstant("Equal")},{value:"greaterthan",text:this.l10n.getConstant("GreaterThan")},{value:"greaterthanorequal",text:this.l10n.getConstant("GreaterThanOrEqual")},{value:"lessthan",text:this.l10n.getConstant("LessThan")},{value:"lessthanorequal",text:this.l10n.getConstant("LessThanOrEqual")},{value:"notequal",text:this.l10n.getConstant("NotEqual")}];this.customOperators={stringOperator:[{value:"startswith",text:this.l10n.getConstant("StartsWith")},{value:"endswith",text:this.l10n.getConstant("EndsWith")},{value:"contains",text:this.l10n.getConstant("Contains")},{value:"equal",text:this.l10n.getConstant("Equal")},{value:"notequal",text:this.l10n.getConstant("NotEqual")}],numberOperator:n,dateOperator:n,datetimeOperator:n,booleanOperator:[{value:"equal",text:this.l10n.getConstant("Equal")},{value:"notequal",text:this.l10n.getConstant("NotEqual")}]}},n.prototype.openMenuByField=function(n){var t=this.parent,f=t.getColumnByField(n),i=t.getColumnHeaderByField(n).querySelector(".e-filtermenudiv"),r,u;i&&(r=t.element.getBoundingClientRect(),u=i.getBoundingClientRect(),this.filterDialogOpen(f,i,u.right-r.left,u.bottom-r.top))},n.prototype.filterIconClickHandler=function(n){var i=n.target,t;if(i.classList.contains("e-filtermenudiv")&&("Menu"===this.parent.filterSettings.type||"CheckBox"===this.parent.filterSettings.type||"Excel"===this.parent.filterSettings.type)){if(t=this.parent.getColumnByUid(o(i,"e-headercell").firstElementChild.getAttribute("e-mappinguid")),this.column=t,this.fltrDlgDetails.field===t.field&&this.fltrDlgDetails.isOpen)return;this.filterModule&&this.filterModule.closeDialog();this.fltrDlgDetails={field:t.field,isOpen:!0};this.openMenuByField(t.field)}},n.prototype.clickHandler=function(n){var i,s;if("FilterBar"===this.filterSettings.type&&this.filterSettings.showFilterBarOperator&&(o(n.target,"e-filterbarcell")&&n.target.classList.contains("e-input-group-icon")&&Object(r.closest)(n.target,"div").querySelector(".e-filterbaroperator").focus(),n.target.classList.contains("e-list-item"))&&(i=document.querySelector(".e-popup-open").getAttribute("id").replace("_popup",""),-1!==i.indexOf("grid-column")&&Object(r.closest)(document.getElementById(i),"div").querySelector(".e-filtertext").focus()),"Immediate"===this.filterSettings.mode||"Menu"===this.parent.filterSettings.type||"CheckBox"===this.parent.filterSettings.type||"Excel"===this.parent.filterSettings.type){this.parent;var t=n.target,h=t.classList.contains("e-day"),f=o(this.parent.element,"e-dialog"),e=!1,u=o(t,"e-popup"),c=this.parent.element.querySelector(".e-filter-popup");if(f&&u&&(e=f.id===u.id),(t.classList.contains("e-excel-ascending")||t.classList.contains("e-excel-descending"))&&this.filterModule.closeDialog(t),o(t,"e-filter-popup")||t.classList.contains("e-filtermenudiv"))return;(!this.filterModule||o(t,"e-popup-wrapper")||Object(r.closest)(t,".e-filter-item.e-menu-item")||h||(e&&!o(t,"e-filter-popup")&&!o(t,"e-popup-flmenu")||!u&&c)&&(this.filterModule.isresetFocus=o(t,"e-grid")&&o(t,"e-grid").id===this.parent.element.id,this.filterModule.closeDialog(t)),"Immediate"===this.filterSettings.mode&&t.classList.contains("e-clear-icon"))&&(s=t.previousElementSibling,this.removeFilteredColsByField(s.id.slice(0,-14)))}},n.prototype.filterHandler=function(n){var t,u,i,s;this.actualPredicate[n.field]=n.actualPredicate;for(var h=new e.DataManager(this.filterSettings.columns),c=(new e.Query).where("field",this.filterOperators.equal,n.field),o=h.executeLocal(c),f=0;f<o.length;f++){for(u=-1,i=0;i<this.filterSettings.columns.length;i++)if(o[f].field===this.filterSettings.columns[i].field){u=i;break}-1!==u&&this.filterSettings.columns.splice(u,1)}"clear-filter"===n.action&&Object(r.isBlazor)()&&!this.parent.isJsComponent&&this.parent.setProperties({filterSettings:{columns:this.filterSettings.columns}},!0);this.values[n.field]&&delete this.values[n.field];s=this.parent.showColumnMenu?".e-columnmenu":".e-icon-filter";t=this.parent.getColumnHeaderByField(n.field).querySelector(s);"filtering"===n.action?(this.filterSettings.columns=this.filterSettings.columns.concat(n.filterCollection),this.filterSettings.columns.length&&t&&t.classList.add("e-filtered")):(t&&t.classList.remove("e-filtered"),n.requestType="filtering",this.parent.renderModule.refresh(n));this.parent.dataBind()},n.prototype.updateFilter=function(){var t=this.filterSettings.columns,n,i;for(this.actualPredicate={},n=0;n<t.length;n++)this.column=this.parent.getColumnByField(t[n].field)||af(t[n].field,this.parent.getForeignKeyColumns()),i=t[n].field,this.parent.getColumnByField(t[n].field)||(i=af(t[n].field,this.parent.getForeignKeyColumns()).field),this.refreshFilterIcon(i,t[n].operator,t[n].value,t[n].type,t[n].predicate,t[n].matchCase,t[n].ignoreAccent,t[n].uid)},n.prototype.refreshFilterIcon=function(n,t,i,r,u,f,e,o){var s,h;s={field:n,predicate:u,matchCase:f,ignoreAccent:e,operator:t,value:i,type:r};this.actualPredicate[n]?this.actualPredicate[n].push(s):this.actualPredicate[n]=[s];h=o?this.parent.grabColumnByUidFromAllCols(o).field:n;this.addFilteredClass(h)},n.prototype.addFilteredClass=function(n){var t;this.parent.showColumnMenu?t=this.parent.getColumnHeaderByField(n).querySelector(".e-columnmenu"):this.parent.getColumnByField(n)&&(t=this.parent.getColumnHeaderByField(n).querySelector(".e-icon-filter"));t&&t.classList.add("e-filtered")},n.prototype.getFilterUIInfo=function(){return this.filterModule?this.filterModule.getFilterUIInfo():{}},n.prototype.getOperatorName=function(n){return document.getElementById(this.parent.getColumnByField(n).uid).ej2_instances[0].value},n}(),ti={root:"e-rhandler",suppress:"e-rsuppress",icon:"e-ricon",helper:"e-rhelper",header:"th.e-headercell",cursor:"e-rcursor"},ph=function(){function n(n){this.tapped=!1;this.isDblClk=!0;this.parent=n;this.parent.isDestroyed||(this.widthService=new ea(n),this.addEventListener())}return n.prototype.autoFitColumns=function(n){var t=null==n||n.length<=0?this.parent.getColumns().map(function(n){return n.field}):"string"==typeof n?[n]:n;this.findColumn(t)},n.prototype.autoFit=function(){var n=this.parent.getColumns().filter(function(n){return!0===n.autoFit}).map(function(n){return n.field||n.headerText});n.length>0&&this.autoFitColumns(n);"Auto"===this.parent.resizeSettings.mode&&this.widthService.setWidthToTable()},n.prototype.resizeColumn=function(n,t,i){var o,s,e,v,c,l,f=this.parent,d=0,g=0,y=i||this.parent.getUidByColumnField(n),h=this.parent.getNormalizedColumnIndex(y),it=this.parent.getColumnIndexByField(n),p=f.getFrozenColumns(),w,u,nt,k,a,et;if(Object(r.isNullOrUndefined)(f.getFooterContent())||(e=f.getFooterContentTable()),p?t<p?(o=f.getHeaderTable(),s=f.getContentTable(),v=o.querySelector('[e-mappinguid="'+y+'"]').parentElement.cloneNode(!0),c=s.querySelectorAll("td:nth-child("+(h+1)+")"),e&&(l=e.querySelectorAll("td:nth-child("+(h+1)+")"))):(o=f.getHeaderContent().querySelector(".e-movableheader").children[0],s=f.getContent().querySelector(".e-movablecontent").children[0],v=o.querySelector('[e-mappinguid="'+y+'"]').parentElement.cloneNode(!0),c=s.querySelectorAll("td:nth-child("+(h-p+1)+")"),e&&(l=(e=f.getFooterContent().querySelector(".e-movablefootercontent").children[0]).querySelectorAll("td:nth-child("+(h-p+1)+")"))):(o=f.getHeaderTable(),s=f.getContentTable(),v=o.querySelector('[e-mappinguid="'+y+'"]').parentElement.cloneNode(!0),c=s.querySelectorAll("td:nth-child("+(h+1)+"):not(.e-groupcaption)"),e&&(l=e.querySelectorAll("td:nth-child("+(h+1)+"):not(.e-groupcaption)"))),w=o.querySelector("tr").querySelectorAll(".e-grouptopleftcell"),w.length>0)for(u=0;u<w.length;u++)g+=w[u].offsetWidth;nt=s.querySelector(".e-detailrowcollapse")||s.querySelector(".e-detailrowexpand");(this.parent.detailTemplate||this.parent.childGrid)&&nt&&(g+=nt.offsetWidth);var ot=[v],rt=[],tt=[];if(e)for(u=0;u<l.length;u++)tt[u]=l[u].cloneNode(!0);for(u=0;u<c.length;u++)rt[u]=c[u].cloneNode(!0);var st=this.createTable(o,ot,"e-gridheader"),ht=this.createTable(s,rt,"e-gridcontent"),ut=null;tt.length&&(ut=this.createTable(e,tt,"e-gridfooter"));var b=f.getColumns()[it],ct=b.width=Object(r.formatUnit)(Math.max(st,ht,ut)),ft=b.maxWidth&&parseFloat(b.maxWidth.toString());if(parseInt(ct,10)>ft&&(b.width=ft),this.widthService.setColumnWidth(f.getColumns()[it]),!1===f.getColumns().some(function(n){return null===n.width||void 0===n.width||n.width.length<=0}))for(k=f.getColumns(),u=0;u<k.length;u++)k[u].visible&&(d+=parseFloat(k[u].width));a=d+g;d>0&&!f.getFrozenColumns()&&((this.parent.detailTemplate||this.parent.childGrid)&&this.widthService.setColumnWidth(new wt({width:"30px"})),"Auto"===this.parent.resizeSettings.mode&&(a="100%"),o.style.width=Object(r.formatUnit)(a),s.style.width=Object(r.formatUnit)(a),Object(r.isNullOrUndefined)(e)||(e.style.width=Object(r.formatUnit)(a)));et=o.offsetWidth;f.getContent().scrollWidth>et?(o.classList.add("e-tableborder"),s.classList.add("e-tableborder")):(o.classList.remove("e-tableborder"),s.classList.remove("e-tableborder"));Object(r.isNullOrUndefined)(e)||e.classList.add("e-tableborder")},n.prototype.destroy=function(){var n=this.parent.element;n&&(n.querySelector(".e-gridheader")||n.querySelector(".e-gridcontent"))&&(this.widthService=null,this.unwireEvents(),this.removeEventListener())},n.prototype.getModuleName=function(){return"resize"},n.prototype.findColumn=function(n){for(var t=0;t<n.length;t++){var u=n[t],i=this.parent.getColumnIndexByField(u),f=this.parent.getColumns()[i];i>-1&&!Object(r.isNullOrUndefined)(f)&&!0===f.visible&&this.resizeColumn(u,i)}},n.prototype.createTable=function(n,t,i){var u=this.parent.createElement("div"),f,r,s,e,o,h;for(u.className=this.parent.element.className,u.style.cssText="display: inline-block;visibility:hidden;position:absolute",f=this.parent.createElement("div"),f.className=i,r=this.parent.createElement("table"),r.className=n.className,r.classList.add("e-resizetable"),r.style.cssText="table-layout: auto;width: auto",s=this.parent.createElement("tr"),e=0;e<t.length;e++)o=s.cloneNode(),o.className=n.querySelector("tr").className,o.appendChild(t[e]),r.appendChild(o);return f.appendChild(r),u.appendChild(f),document.body.appendChild(u),h=r.getBoundingClientRect().width,document.body.removeChild(u),Math.ceil(h)},n.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(g,this.refreshHeight,this),this.parent.on(tt,this.wireEvents,this),this.parent.on(y,this.autoFit,this),this.parent.on(ve,this.refreshHeight,this))},n.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(g,this.refreshHeight),this.parent.off(tt,this.wireEvents),this.parent.off(ve,this.refreshHeight))},n.prototype.render=function(){this.unwireEvents();this.wireEvents();this.setHandlerHeight()},n.prototype.refreshHeight=function(){for(var t=this.getResizeHandlers(),n=0;n<t.length;n++)t[n].parentElement.offsetHeight>0&&(t[n].style.height=t[n].parentElement.offsetHeight+"px");this.setHandlerHeight()},n.prototype.wireEvents=function(){r.EventHandler.add(this.parent.getHeaderContent(),r.Browser.touchStartEvent,this.resizeStart,this);r.EventHandler.add(this.parent.getHeaderContent(),vr,this.callAutoFit,this)},n.prototype.unwireEvents=function(){r.EventHandler.remove(this.parent.getHeaderContent(),r.Browser.touchStartEvent,this.resizeStart);r.EventHandler.remove(this.parent.getHeaderContent(),vr,this.callAutoFit)},n.prototype.getResizeHandlers=function(){return this.parent.getFrozenColumns()?[].slice.call(this.parent.getHeaderContent().querySelectorAll("."+ti.root)):[].slice.call(this.parent.getHeaderTable().querySelectorAll("."+ti.root))},n.prototype.setHandlerHeight=function(){for(var t=[].slice.call(this.parent.getHeaderTable().querySelectorAll("."+ti.suppress)),n=0;n<t.length;n++)t[n].style.height=t[n].parentElement.offsetHeight+"px"},n.prototype.callAutoFit=function(n){if(n.target.classList.contains("e-rhandler")){var t=this.getTargetColumn(n);if(t.columns)return;this.resizeColumn(t.field,this.parent.getNormalizedColumnIndex(t.uid),t.uid);Object(r.closest)(n.target,ti.header).classList.add("e-resized")}},n.prototype.resizeStart=function(n){var i=this,t,u,f,s,o;if(n.target.classList.contains("e-rhandler")){if(!this.helper){if(0===this.getScrollBarWidth()){if(this.parent.allowGrouping)for(t=0;t<this.parent.groupSettings.columns.length;t++)this.widthService.setColumnWidth(new wt({width:"30px"}),t);for(u=0,f=this.refreshColumnWidth();u<f.length;u++)s=f[u],this.widthService.setColumnWidth(s);this.widthService.setWidthToTable()}if(this.refreshStackedColumnWidth(),this.element=n.target,this.parent.getVisibleFrozenColumns()){var c=this.parent.getContent().querySelector(".e-movablecontent").querySelector("tbody"),l=this.parent.getContent().querySelector(".e-frozencontent").querySelector("tbody"),e=c.querySelectorAll("tr"),h=l.querySelectorAll("tr");for(t=0;t<e.length;t++)this.parent.rowHeight?(e[t].style.height=this.parent.rowHeight+"px",h[t].style.height=this.parent.rowHeight+"px"):(e[t].style.removeProperty("height"),h[t].style.removeProperty("height"))}this.parentElementWidth=this.parent.element.getBoundingClientRect().width;this.appendHelper();this.column=this.getTargetColumn(n);this.pageX=this.getPointX(n);this.minMove=this.parent.enableRtl?parseFloat(this.column.width.toString())-(this.column.minWidth?parseFloat(this.column.minWidth.toString()):0):(this.column.minWidth?parseFloat(this.column.minWidth.toString()):0)-parseFloat(Object(r.isNullOrUndefined)(this.column.width)?"":this.column.width.toString());this.minMove+=this.pageX}r.Browser.isDevice&&!this.helper.classList.contains(ti.icon)?(this.helper.classList.add(ti.icon),r.EventHandler.add(document,r.Browser.touchStartEvent,this.removeHelper,this),r.EventHandler.add(this.helper,r.Browser.touchStartEvent,this.resizeStart,this)):(o=void 0,o=!Object(r.isBlazor)()||this.parent.isJsComponent?{e:n,column:this.column}:{column:Object(r.extend)({},this.column)},this.parent.trigger(by,o,function(n){n.cancel||i.parent.isEdit?i.cancelResizeAction():(r.EventHandler.add(document,r.Browser.touchEndEvent,i.resizeEnd,i),r.EventHandler.add(i.parent.element,r.Browser.touchMoveEvent,i.resizing,i),i.updateCursor("add"))}))}},n.prototype.cancelResizeAction=function(n){n&&(r.EventHandler.remove(this.parent.element,r.Browser.touchMoveEvent,this.resizing),r.EventHandler.remove(document,r.Browser.touchEndEvent,this.resizeEnd),this.updateCursor("remove"));r.Browser.isDevice&&(r.EventHandler.remove(document,r.Browser.touchStartEvent,this.removeHelper),r.EventHandler.remove(this.helper,r.Browser.touchStartEvent,this.resizeStart));Object(r.detach)(this.helper);this.refresh()},n.prototype.getWidth=function(n,t,i){return t&&n<t?t:i&&n>i?i:n},n.prototype.updateResizeEleHeight=function(){for(var t=[].slice.call(this.parent.getHeaderContent().querySelectorAll(".e-rhandler")),n=0;n<t.length;n++)t[n].style.height=this.element.parentElement.offsetHeight+"px"},n.prototype.getColData=function(n,t){return{width:parseFloat(Object(r.isNullOrUndefined)(this.widthService.getWidth(n))||"auto"===this.widthService.getWidth(n)?"0":this.widthService.getWidth(n).toString())+t,minWidth:n.minWidth?parseFloat(n.minWidth.toString()):null,maxWidth:n.maxWidth?parseFloat(n.maxWidth.toString()):null}},n.prototype.resizing=function(n){var s,u,c,f,l,e,a,v;if(!Object(r.isNullOrUndefined)(this.column)){s=0;Object(r.isNullOrUndefined)(this.column)&&(s=o(this.element,"th").offsetWidth);this.parent.allowTextWrap&&(this.updateResizeEleHeight(),this.setHelperHeight());var t=this.getPointX(n),h=this.parent.enableRtl?-(t-this.pageX):t-this.pageX,i=this.getColData(this.column,h);if(i.width||(i.width=Object(r.closest)(this.element,"th").offsetWidth),u=this.getWidth(i.width,i.minWidth,i.maxWidth),this.parent.log("resize_min_max",{column:this.column,width:u}),(!this.parent.enableRtl&&this.minMove>=t||this.parent.enableRtl&&this.minMove<=t)&&(u=this.column.minWidth?parseFloat(this.column.minWidth.toString()):10,this.pageX=t=this.minMove),u!==parseFloat(Object(r.isNullOrUndefined)(this.column.width)||"auto"===this.column.width?s.toString():this.column.width.toString())){if(this.pageX=t,this.column.width=Object(r.formatUnit)(u),c={e:n,column:this.column},this.parent.trigger(ky,c),c.cancel)return void this.cancelResizeAction(!0);for(f=[this.column],l=[this.column],this.column.columns&&(f=this.getSubColumns(this.column,[]),f=this.calulateColumnsWidth(f,!1,h),l=this.calulateColumnsWidth(f,!0,h)),e=0,a=l;e<a.length;e++)v=a[e],this.widthService.setColumnWidth(v,null,"resize");this.updateHelper()}this.isDblClk=!1}},n.prototype.calulateColumnsWidth=function(n,t,i){for(var f,e,h=[],o=0,c=n;o<c.length;o++){for(var u=c[o],l=0,s=0;s<n.length;s++)l+=parseFloat(n[s].width.toString());f=this.getColData(u,parseFloat(u.width)*i/l);e=this.getWidth(f.width,f.minWidth,f.maxWidth);e!==parseFloat(u.width.toString())&&(t&&(u.width=Object(r.formatUnit)(e<1?1:e)),h.push(u))}return h},n.prototype.getSubColumns=function(n,t){for(var i,r=0,u=n.columns;r<u.length;r++)i=u[r],!1!==i.visible&&i.allowResizing&&(i.columns?this.getSubColumns(i,t):t.push(i));return t},n.prototype.resizeEnd=function(n){var u,t,i;this.helper&&!this.parent.isDestroyed&&(u=(r.EventHandler.remove(this.parent.element,r.Browser.touchMoveEvent,this.resizing),r.EventHandler.remove(document,r.Browser.touchEndEvent,this.resizeEnd),this.updateCursor("remove"),Object(r.detach)(this.helper),!Object(r.isBlazor)()||this.parent.isJsComponent)?{e:n,column:this.column}:{column:Object(r.extend)({},this.column)},t=this.parent.getContent().querySelector(".e-content"),i=t.querySelector(".e-movablecontent")?t.querySelector(".e-movablecontent"):t,i.scrollHeight>i.clientHeight&&(this.parent.scrollModule.setPadding(),i.style.overflowY="scroll"),this.parent.trigger(vc,u),Object(r.closest)(this.element,".e-headercell").classList.add("e-resized"),this.isFrozenColResized=o(this.element,"e-frozenheader")?!0:!1,this.parent.getFrozenColumns()&&this.parent.notify(ki,{"case":"textwrap"}),this.parent.allowTextWrap&&(this.updateResizeEleHeight(),this.parent.notify(is,{"case":"textwrap"})),this.refresh(),this.doubleTapEvent(n),this.isDblClk=!0)},n.prototype.getPointX=function(n){return n.touches&&n.touches.length?n.touches[0].pageX:n.pageX},n.prototype.refreshColumnWidth=function(){for(var n,u=this.parent.getColumns(),t=0,f=[].slice.apply(this.parent.getHeaderContent().querySelectorAll("th.e-headercell"));t<f.length;t++)for(var i=f[t],r=0,e=u;r<e.length;r++)if(n=e[r],i.querySelector("[e-mappinguid]")&&i.querySelector("[e-mappinguid]").getAttribute("e-mappinguid")===n.uid&&n.visible){n.width=i.getBoundingClientRect().width;break}return u},n.prototype.refreshStackedColumnWidth=function(){for(var i,n=0,t=this.parent.getStackedColumns(this.parent.columns);n<t.length;n++)i=t[n],i.width=this.getStackedWidth(i,0)},n.prototype.getStackedWidth=function(n,t){for(var i,r=0,u=n.columns;r<u.length;r++)i=u[r],!1!==i.visible&&(i.columns?this.getStackedWidth(i,t):t+=i.width);return t},n.prototype.getTargetColumn=function(n){var t=Object(r.closest)(n.target,ti.header),i=(t=t.querySelector(".e-headercelldiv")||t.querySelector(".e-stackedheadercelldiv")).getAttribute("e-mappinguid");return this.parent.getColumnByUid(i)},n.prototype.updateCursor=function(n){var r=[].slice.call(this.parent.getHeaderContent().querySelectorAll("th")),t,i;for(r.push(this.parent.element),t=0,i=r;t<i.length;t++)i[t].classList[n](ti.cursor)},n.prototype.refresh=function(){this.column=null;this.pageX=null;this.element=null;this.helper=null},n.prototype.appendHelper=function(){this.helper=this.parent.createElement("div",{className:ti.helper});this.parent.element.appendChild(this.helper);this.setHelperHeight()},n.prototype.setHelperHeight=function(){var f=this.parent.getContent().offsetHeight-this.getScrollBarWidth(),i=Object(r.closest)(this.element,ti.header),n=[].slice.call(this.parent.getHeaderContent().querySelectorAll("tr")),e=this.parent.getFrozenColumns(),t,u;for(e&&(i.parentElement.children.length!==e?n.splice(0,n.length/2):n.splice(n.length/2,n.length/2)),t=n.indexOf(i.parentElement);t<n.length&&t>-1;t++)f+=n[t].offsetHeight;u=this.calcPos(i);u.left+=this.parent.enableRtl?-1:i.offsetWidth-2;this.helper.style.cssText="height: "+f+"px; top: "+u.top+"px; left:"+Math.floor(u.left)+"px;"},n.prototype.getScrollBarWidth=function(n){var t=this.parent.getFrozenColumns()?this.parent.getContent().querySelector(".e-movablecontent"):this.parent.getContent().firstChild;return t.scrollHeight>t.clientHeight&&n||t.scrollWidth>t.clientWidth?oi():0},n.prototype.removeHelper=function(n){var t=n.target.classList;t.contains(ti.root)||t.contains(ti.icon)||!this.helper||(r.EventHandler.remove(document,r.Browser.touchStartEvent,this.removeHelper),r.EventHandler.remove(this.helper,r.Browser.touchStartEvent,this.resizeStart),Object(r.detach)(this.helper),this.refresh())},n.prototype.updateHelper=function(){var t=Object(r.closest)(this.element,ti.header),n=Math.floor(this.calcPos(t).left+(this.parent.enableRtl?-1:t.offsetWidth-2)),i;(n>this.parentElementWidth&&(n=this.parentElementWidth-2),this.parent.getFrozenColumns())&&(i=Object(r.closest)(t,".e-table").offsetLeft,n<i&&(n=i));this.helper.style.left=n+"px"},n.prototype.calcPos=function(n){for(var i={top:0,left:0},u=n.getBoundingClientRect(),r=n.ownerDocument,t=o(n,"e-grid")||r.documentElement;t&&(t===r.body||t===r.documentElement)&&"static"===t.style.position;)t=t.parentNode;return t&&t!==n&&1===t.nodeType&&(i=t.getBoundingClientRect()),{top:u.top-i.top,left:u.left-i.left}},n.prototype.doubleTapEvent=function(n){this.getUserAgent()&&this.isDblClk&&(this.tapped?(clearTimeout(this.tapped),this.callAutoFit(n),this.tapped=null):this.tapped=setTimeout(this.timeoutHandler(),300))},n.prototype.getUserAgent=function(){var n=r.Browser.userAgent.toLowerCase();return/iphone|ipod|ipad/.test(n)},n.prototype.timeoutHandler=function(){this.tapped=null},n}(),oit=function(){function n(n){this.parent=n;this.parent.isDestroyed||(this.parent.on(tu,this.headerDrop,this),this.parent.on(v,this.enableAfterRender,this),this.parent.on(nl,this.onActionComplete,this),this.parent.on(or,this.drag,this),this.parent.on(kr,this.dragStart,this),this.parent.on(vo,this.dragStop,this),this.parent.on(tu,this.headerDrop,this),this.parent.on(g,this.createReorderElement,this),this.parent.on(w,this.keyPressHandler,this))}return n.prototype.chkDropPosition=function(n,t){var i=this.parent.getColumnByUid(t.firstElementChild.getAttribute("e-mappinguid")),u=!i||!i.lockColumn;return(n.parentElement.isEqualNode(t.parentElement)||this.parent.enableColumnVirtualization||this.parent.getFrozenColumns()&&Array.prototype.indexOf.call(Object(r.closest)(n,"thead").children,n.parentElement)===Array.prototype.indexOf.call(Object(r.closest)(t,"thead").children,t.parentElement))&&this.targetParentContainerIndex(n,t)>-1&&u},n.prototype.chkDropAllCols=function(n,t){for(var i,r=this.getHeaderCells();!i&&r.length>0;)i=n!==r.pop()&&this.targetParentContainerIndex(n,t)>-1;return i},n.prototype.findColParent=function(n,t,i){var r,f,u;for(i=i,r=0,f=t.length;r<f;r++){if(n===t[r])return!0;if(t[r].columns){if(u=i.length,i.push(t[r]),this.findColParent(n,t[r].columns,i))return!0;i.splice(u,i.length-u)}}return!1},n.prototype.getColumnsModel=function(n){for(var i=[],r=[],t=0,u=n.length;t<u;t++)i.push(n[t]),n[t].columns&&(r=r.concat(n[t].columns));return r.length&&(i=i.concat(this.getColumnsModel(r))),i},n.prototype.headerDrop=function(n){var h=this.parent,a=(this.element.querySelector(".e-headercelldiv")||this.element.querySelector(".e-stackedheadercelldiv")).getAttribute("e-mappinguid"),i=h.getColumnByUid(a),t,f,u,o,s;if(Object(r.closest)(n.target,"th")&&(Object(r.isNullOrUndefined)(i)||i.allowReordering&&!i.lockColumn)){if(t=Object(r.closest)(n.target,".e-headercell"),f=(t.querySelector(".e-headercelldiv")||t.querySelector(".e-stackedheadercelldiv")).getAttribute("e-mappinguid"),!Object(r.isNullOrUndefined)(f)&&(u=h.getColumnByUid(f),Object(r.isNullOrUndefined)(u)||!u.allowReordering||u.lockColumn))return void this.parent.log("action_disabled_column",{moduleName:this.getModuleName(),column:i,destColumn:u});if(t&&this.chkDropPosition(this.element,t)&&this.chkDropAllCols(this.element,t))if(this.parent.enableColumnVirtualization){var c=this.parent.columns,v=this.element.querySelector(".e-headercelldiv").getAttribute("e-mappinguid"),y=this.parent.columns.filter(function(n){return n.uid===v}),e=null,p=y[0],l=t.querySelector(".e-headercelldiv").getAttribute("e-mappinguid");c.some(function(n,t){return n.uid===l&&(e=t,n.uid===l)});Object(r.isNullOrUndefined)(e)||this.moveColumns(e,p)}else if(o=this.targetParentContainerIndex(this.element,t),s=this.element.firstElementChild.getAttribute("e-mappinguid"),this.destElement=t,s)this.moveColumns(o,this.parent.getColumnByUid(s));else{var w=this.getHeaderCells(),b=rh(this.element,w),k=(c=this.getColumnsModel(this.parent.columns))[b];this.moveColumns(o,k)}}else this.parent.log("action_disabled_column",{moduleName:this.getModuleName(),column:i})},n.prototype.isActionPrevent=function(n){return si(n)},n.prototype.moveColumns=function(n,t,i,r){var e=this.parent,u,h;if(this.isActionPrevent(e))e.notify(ot,{instance:this,handler:this.moveColumns,arg1:n,arg2:t});else{var s=this.getColParent(t,this.parent.columns),f=s?s.columns:this.parent.columns,o=cf(t,f);if((this.parent.getFrozenColumns()&&s||this.parent.lockcolPositionCount)&&!i){for(u=0;u<f.length;u++)if(f[u].field===t.field){o=u;break}if(h=this.parent.getColumnByUid(this.destElement.firstElementChild.getAttribute("e-mappinguid")),h){for(u=0;u<f.length;u++)if(f[u].field===h.field){n=u;break}}else for(u=0;u<f.length;u++)f[u].headerText===this.destElement.innerText.trim()&&(n=u)}e.allowReordering&&o!==n&&-1!==o&&-1!==n&&(f.splice(n,0,f.splice(o,1)[0]),e.getColumns(!0),e.notify(lr,{fromIndex:n,toIndex:o}),!1!==r&&e.notify(p,{type:l,requestType:"reorder",fromIndex:n,toIndex:o,toColumnUid:t.uid}))}},n.prototype.targetParentContainerIndex=function(n,t){var r=this.getHeaderCells(),i=this.parent.columns,u=this.getColumnsModel(i),f=this.getColParent(u[rh(n,r)],i);return i=f?f.columns:i,cf(u[rh(t,r)],i)},n.prototype.getHeaderCells=function(){var s=this.parent.getFrozenColumns(),h,r,f,i,n;if(s||this.parent.lockcolPositionCount){var e=void 0,t=void 0,u=[],o=[].slice.call(this.parent.getHeaderTable().querySelectorAll(".e-columnheader"));if(s)for(h=[].slice.call(this.parent.getHeaderContent().querySelector(".e-movableheader").querySelectorAll(".e-columnheader")),r=0;r<o.length;r++){for(e=[].slice.call(o[r].getElementsByClassName("e-headercell")),t=[].slice.call(h[r].getElementsByClassName("e-headercell")),f=void 0,i=0;i<e.length;i++){for(n=0;n<t.length;n++)if(t[n].innerText===e[i].innerText){f=!0;break}f||(u=u.concat([e[i]]))}for(n=0;n<t.length;n++)u.push(t[n])}else for(r=0;r<o.length;r++)for(t=[].slice.call(o[r].getElementsByClassName("e-headercell")),i=0;i<t.length;i++){for(f=void 0,n=i+1;n<t.length;n++)if(t[n].innerText===t[i].innerText){f=!0;break}f||(u=u.concat([t[i]]))}return u}return[].slice.call(this.parent.element.getElementsByClassName("e-headercell"))},n.prototype.getColParent=function(n,t){var i=[];return this.findColParent(n,t,i),i[i.length-1]},n.prototype.reorderSingleColumn=function(n,t){var i=this.parent.enableColumnVirtualization?this.parent.columns.filter(function(t){return t.field===n})[0]:this.parent.getColumnByField(n),u=this.parent.enableColumnVirtualization?this.parent.columns.filter(function(n){return n.field===t})[0]:this.parent.getColumnByField(t);if((Object(r.isNullOrUndefined)(i)||i.allowReordering&&!i.lockColumn)&&(Object(r.isNullOrUndefined)(u)||u.allowReordering&&!i.lockColumn)){var f=u,e=this.getColParent(f,this.parent.columns),o=cf(f,e?e.columns:this.parent.columns);o>-1&&this.moveColumns(o,i,!0)}else this.parent.log("action_disabled_column",{moduleName:this.getModuleName(),column:i,destColumn:u})},n.prototype.reorderMultipleColumns=function(n,t){var o=this.parent.getColumnIndexByField(t),f=this.parent.getColumnByField(t),i,u,s,e,h;if(!(o<0)&&(Object(r.isNullOrUndefined)(f)||f.allowReordering&&!f.lockColumn)){for(i=0;i<n.length;i++)if(u=this.parent.getColumnByField(n[i]),!Object(r.isNullOrUndefined)(u)&&(!u.allowReordering||u.lockColumn))return;for(i=0;i<n.length;i++)u=this.parent.getColumnByIndex(o),s=this.getColParent(u,this.parent.columns),e=cf(u,s?s.columns:this.parent.columns),e>-1&&this.moveColumns(e,this.parent.getColumnByField(n[i]),!0,!(Object(r.isBlazor)()&&!this.parent.isJsComponent)),this.parent.getColumnIndexByField(n[i+1])>=e&&o++;Object(r.isBlazor)()&&!this.parent.isJsComponent&&(h=this.parent.getColumns(),this.parent.notify(p,{fromColumnUid:n.map(function(n){return h.filter(function(t){return t.field===n})[0].uid}),toColumnUid:f.uid,isMultipleReorder:!0,requestType:"reorder",type:"actionBegin"}))}},n.prototype.moveTargetColumn=function(n,t){t>-1&&this.moveColumns(t,n,!0)},n.prototype.reorderSingleColumnByTarget=function(n,t){var i=this.parent.getColumnByField(n);this.moveTargetColumn(i,t)},n.prototype.reorderMultipleColumnByTarget=function(n,t){for(var i=0;i<n.length;i++)this.reorderSingleColumnByTarget(n[i],t)},n.prototype.reorderColumns=function(n,t){"string"==typeof n?(this.reorderSingleColumn(n,t),this.fromCol=n):(this.reorderMultipleColumns(n,t),this.fromCol=n[0])},n.prototype.reorderColumnByIndex=function(n,t){var i=this.parent.getColumnByIndex(n);this.moveTargetColumn(i,t)},n.prototype.reorderColumnByTargetIndex=function(n,t){"string"==typeof n?this.reorderSingleColumnByTarget(n,t):this.reorderMultipleColumnByTarget(n,t)},n.prototype.enableAfterRender=function(n){n.module===this.getModuleName()&&n.enable&&this.createReorderElement()},n.prototype.createReorderElement=function(n){n&&n.args.isXaxis&&this.setDisplay("none");var t=this.parent.element.querySelector(".e-headercontent");this.upArrow=t.appendChild(this.parent.createElement("div",{className:"e-icons e-icon-reorderuparrow e-reorderuparrow",attrs:{style:"display:none"}}));this.downArrow=t.appendChild(this.parent.createElement("div",{className:"e-icons e-icon-reorderdownarrow e-reorderdownarrow",attrs:{style:"display:none"}}))},n.prototype.onActionComplete=function(n){Object(r.isBlazor)()&&!this.parent.isJsComponent&&(n.rows=null);this.parent.trigger(c,Object(r.extend)(n,{type:c}));var t=this.fromCol&&this.parent.getColumnHeaderByField(this.fromCol);t&&this.parent.focusModule.onClick({target:t},!0)},n.prototype.destroy=function(){var n=this.parent.element;!this.parent.isDestroyed&&n&&(n.querySelector(".e-gridheader")||n.querySelector(".e-gridcontent"))&&(Object(r.remove)(this.upArrow),Object(r.remove)(this.downArrow),this.parent.off(tu,this.headerDrop),this.parent.off(v,this.enableAfterRender),this.parent.off(nl,this.onActionComplete),this.parent.off(or,this.drag),this.parent.off(kr,this.dragStart),this.parent.off(vo,this.dragStop),this.parent.off(g,this.createReorderElement),this.parent.off(w,this.keyPressHandler))},n.prototype.keyPressHandler=function(n){var i=this.parent,t;switch(n.action){case"ctrlLeftArrow":case"ctrlRightArrow":if(t=i.focusModule.currentInfo.element,t&&t.classList.contains("e-headercell")){var r=i.getColumnByUid(t.firstElementChild.getAttribute("e-mappinguid")),u=i.getVisibleColumns(),e=u.indexOf(r),f="ctrlLeftArrow"===n.action?u[e-1]:u[e+1];f&&f.field&&r.field&&this.reorderColumns(r.field,f.field)}}},n.prototype.drag=function(n){var t=this.parent,i=n.target;if(n.column.allowReordering&&!n.column.lockColumn){var u=Object(r.closest)(i,".e-headercell:not(.e-stackedHeaderCell)"),f=t.element.querySelector(".e-cloneproperties"),e=t.getFrozenColumns()?t.getMovableVirtualContent():t.getContent().firstElementChild,s=this.x>gi(n.event).x+e.scrollLeft;Object(r.removeClass)(t.getHeaderTable().querySelectorAll(".e-reorderindicate"),["e-reorderindicate"]);this.setDisplay("none");this.stopTimer();Object(r.classList)(f,["e-defaultcur"],["e-notallowedcur"]);this.updateScrollPostion(n.event);u&&!u.isEqualNode(this.element)&&(i=u,this.chkDropPosition(this.element,i)&&this.chkDropAllCols(this.element,i)?(this.updateArrowPosition(i,s),Object(r.classList)(i,["e-allowDrop","e-reorderindicate"],[])):t.allowGrouping&&o(n.target,"e-groupdroparea")||Object(r.classList)(f,["e-notallowedcur"],["e-defaultcur"]));t.trigger(or,{target:i,draggableType:"headercell",column:n.column})}},n.prototype.updateScrollPostion=function(n){var i=this,r=this.parent.getFrozenColumns(),t=gi(n).x,u=this.parent.element.getBoundingClientRect(),f=r?this.parent.element.querySelector(".e-movableheader").getBoundingClientRect().left:u.left,e=u.right,o=r?this.parent.getContent().querySelector(".e-movablecontent"):this.parent.getContent().firstElementChild;t>f&&t<f+35?this.timer=window.setInterval(function(){i.setScrollLeft(o,!0)},50):t<e&&t>e-35&&(this.timer=window.setInterval(function(){i.setScrollLeft(o,!1)},50))},n.prototype.setScrollLeft=function(n,t){var i=n.scrollLeft;n.scrollLeft=n.scrollLeft+(t?-5:5);i!==n.scrollLeft&&this.setDisplay("none")},n.prototype.stopTimer=function(){window.clearInterval(this.timer)},n.prototype.updateArrowPosition=function(n,t){var i=n.getBoundingClientRect(),r=this.parent.element.getBoundingClientRect();if(!(t&&i.left<r.left||!t&&i.right>r.right)){if(this.parent.getFrozenColumns()&&n.classList.contains("e-headercell")){var u=this.parent.getColumnByUid(n.firstElementChild.getAttribute("e-mappinguid")),f=Math.round(this.parent.getFrozenVirtualHeader().getBoundingClientRect().right),e=Math.round(this.parent.getMovableVirtualHeader().getBoundingClientRect().right);if(u&&this.parent.getNormalizedColumnIndex(u.uid)>=this.parent.getFrozenColumns()&&(t&&Math.round(i.left)<f||!t&&e<i.right))return}this.upArrow.style.top=i.top+i.height-r.top+"px";this.downArrow.style.top=i.top-r.top-4+"px";this.upArrow.style.left=this.downArrow.style.left=(t?i.left:i.right)-r.left-4+"px";this.setDisplay("")}},n.prototype.dragStart=function(n){var t=this.parent,i=n.target,r;(this.element=i.classList.contains("e-headercell")?i:o(i,"e-headercell"),n.column.allowReordering&&!n.column.lockColumn)&&(r=t.getFrozenColumns()?t.getMovableVirtualContent():t.getContent().firstElementChild,this.x=gi(n.event).x+r.scrollLeft,t.trigger(kr,{target:i,draggableType:"headercell",column:n.column}))},n.prototype.dragStop=function(n){var t=this.parent;this.setDisplay("none");this.stopTimer();n.cancel||t.trigger(dr,{target:n.target,draggableType:"headercell",column:n.column});Object(r.removeClass)(t.getHeaderTable().querySelectorAll(".e-reorderindicate"),["e-reorderindicate"])},n.prototype.setDisplay=function(n){this.upArrow.style.display=n;this.downArrow.style.display=n},n.prototype.getModuleName=function(){return"reorder"},n}(),sit=function(){function n(n){var t=this;this.selectedRows=[];this.isOverflowBorder=!0;this.selectedRowColls=[];this.isRefresh=!0;this.isReplaceDragEle=!0;this.helper=function(n){var i=t.parent,u=t.draggable.currentStateTarget,f=t.parent.createElement("div",{className:"e-cloneproperties e-draganddrop e-grid e-dragclone",styles:'height:"auto", z-index:2, width:'+i.element.offsetWidth}),a=t.parent.createElement("table",{styles:"width:"+i.element.offsetWidth}),v=t.parent.createElement("tbody"),e,s,h,c,y,p,l;return document.getElementsByClassName("e-griddragarea").length||i.rowDropSettings.targetID&&!u.classList.contains("e-selectionbackground")&&"Single"!==i.selectionSettings.type||!i.rowDropSettings.targetID&&!o(n.sender.target,"e-rowdragdrop")?!1:(i.rowDropSettings.targetID&&"Row"===i.selectionSettings.mode&&"Single"===i.selectionSettings.type&&i.selectRow(parseInt(t.draggable.currentStateTarget.parentElement.getAttribute("aria-rowindex"),10)),t.startedRow=Object(r.closest)(u,"tr").cloneNode(!0),e=t.parent.getFrozenColumns(),e&&(s=parseInt(Object(r.closest)(u,"tr").getAttribute("aria-rowindex"),10),t.startedRow.innerHTML=t.parent.getRows()[s].innerHTML+t.parent.getMovableRows()[s].innerHTML),t.processArgs(u),h={selectedRow:t.rows,dragelement:u,cloneElement:f,cancel:!1,data:t.rowData},c=i.getSelectedRows(),i.trigger(iy,h),h.cancel)?!1:(fh(t.startedRow,".e-indentcell"),fh(t.startedRow,".e-detailrowcollapse"),fh(t.startedRow,".e-detailrowexpand"),t.removeCell(t.startedRow,"e-gridchkbox"),y=new RegExp("e-active","g"),(t.startedRow.innerHTML=t.startedRow.innerHTML.replace(y,""),v.appendChild(t.startedRow),i.getSelectedRowIndexes().length>1&&t.startedRow.hasAttribute("aria-selected"))&&(p=t.parent.createElement("span",{className:"e-dropitemscount",innerHTML:e?""+c.length/2:""+c.length}),f.appendChild(p)),l=Object(r.closest)(u,"tr").querySelector(".e-icon-rowdragicon"),l&&l.classList.add("e-dragstartrow"),a.appendChild(v),f.appendChild(a),i.element.appendChild(f),f)};this.dragStart=function(n){var u=t.parent,e,f,i;document.getElementsByClassName("e-griddragarea").length||(e=n.target,f=t.parent.element.querySelector(".e-dropitemscount"),t.parent.getSelectedRecords().length>1&&f&&(f.style.left=t.parent.element.querySelector(".e-cloneproperties table").offsetWidth-5+"px"),t.processArgs(e),u.trigger(ry,{rows:Object(r.isBlazor)()?null:t.rows,target:Object(r.isBlazor)()?null:n.target,draggableType:"rows",fromIndex:parseInt(t.rows[0].getAttribute("aria-rowindex"),10),data:Object.keys(t.rowData[0]).length>0?t.rowData:t.currentViewData()}),Object(r.isBlazor)()&&n.bindEvents(n.dragElement),t.dragStartData=t.rowData,i=document.getElementById(u.rowDropSettings.targetID),u.rowDropSettings.targetID&&i&&i.ej2_instances&&"grid"===i.ej2_instances[0].getModuleName()&&i.ej2_instances[0].getContent().classList.add("e-allowRowDrop"))};this.drag=function(n){var f=t.parent,i=t.parent.element.querySelector(".e-cloneproperties"),u=t.getElementFromPosition(i,n.event),e,c,l,s,h;Object(r.classList)(i,["e-defaultcur"],["e-notallowedcur","e-movecur"]);t.isOverflowBorder=!0;t.hoverState=f.enableHover;e=o(u,"e-grid")?Object(r.closest)(n.target,"tr"):null;(f.enableHover=!1,n.target)&&(t.processArgs(u),c={rows:t.rows,target:u,draggableType:"rows",data:t.rowData,originalEvent:n,cancel:!1},(f.trigger(uy,c),t.stopTimer(),c.cancel)||((f.element.classList.add("e-rowdrag"),t.dragTarget=e&&o(u,"e-grid").id===i.parentElement.id?parseInt(e.getAttribute("aria-rowindex"),10):parseInt(t.startedRow.getAttribute("aria-rowindex"),10),f.rowDropSettings.targetID)?o(u,"e-grid")&&o(i.parentElement,"e-grid").id!==o(u,"e-grid").id?Object(r.classList)(i,["e-defaultcur"],["e-notallowedcur"]):Object(r.classList)(i,["e-notallowedcur"],["e-defaultcur"]):(l=o(u,"e-grid"),l&&l.id===i.parentElement.id?Object(r.classList)(i,["e-movecur"],["e-defaultcur"]):Object(r.classList)(i,["e-notallowedcur"],["e-movecur"])),f.rowDropSettings.targetID||f.groupSettings.columns.length&&!n.target.classList.contains("e-selectionbackground")||((o(u,"e-grid")&&t.updateScrollPostion(n.event,u),(t.isOverflowBorder||t.parent.frozenRows>t.dragTarget)&&parseInt(t.startedRow.getAttribute("aria-rowindex"),10)!==t.dragTarget)?t.moveDragRows(n,t.startedRow,e):(e&&t.parent.getRowByIndex(t.parent.getCurrentViewRecords().length-1).getAttribute("data-uid")===e.getAttribute("data-uid")&&(s=t.parent.createElement("div",{className:"e-lastrow-dragborder"}),h=t.parent.getContent(),s.style.width=t.parent.element.offsetWidth-t.getScrollWidth()+"px",h.querySelectorAll(".e-lastrow-dragborder").length||(h.classList.add("e-grid-relative"),h.appendChild(s),s.style.bottom=t.getScrollWidth()+"px")),t.removeBorder(e)))))};this.dragStop=function(n){si(t.parent)?t.parent.notify(ot,{instance:t,handler:t.processDragStop,arg1:n}):t.processDragStop(n)};this.processDragStop=function(n){var i=t.parent,f,s,h,c,u;t.parent.isDestroyed||(f=t.getElementFromPosition(n.helper,n.event),s=f&&!f.classList.contains("e-dlg-overlay")?f:n.target,t.parent.element.querySelector(".e-cloneproperties"),i.element.classList.remove("e-rowdrag"),h=document.getElementById(i.rowDropSettings.targetID),(i.rowDropSettings.targetID&&h&&h.ej2_instances&&"grid"===h.ej2_instances[0].getModuleName()&&h.ej2_instances[0].getContent().classList.remove("e-allowRowDrop"),i.isRowDragable())&&(t.stopTimer(),i.enableHover=t.hoverState,t.parent.getContent().classList.remove("e-grid-relative"),t.removeBorder(f),c=i.element.querySelector(".e-dragstartrow"),c&&c.classList.remove("e-dragstartrow")),t.processArgs(s),u={target:Object(r.isBlazor)()?null:s,draggableType:"rows",cancel:!1,fromIndex:parseInt(t.rows[0].getAttribute("aria-rowindex"),10),dropIndex:t.dragTarget,rows:Object(r.isBlazor)()?null:t.rows,data:Object.keys(t.dragStartData[0]).length>0?t.dragStartData:t.currentViewData()},i.trigger(fy,u,function(){var f;if(!o(s,"e-row")&&!o(s,"e-emptyrow")||u.cancel)return t.dragTarget=null,void Object(r.remove)(n.helper);if(t.isRefresh=!1,f=t.parent.getSelectedRowIndexes(),i.isRowDragable()){if(Object(r.isBlazor)()){var l=t.parent.getSelectedRecords().length?t.parent.getSelectedRecords():t.currentViewData(),h={addedRecords:[],deletedRecords:l,changedRecords:[]},a=t.dragTarget?t.dragTarget:u.dropIndex,c=new e.Query;c.dragDropDestinationIndex=a;t.saveChange(h,c);h.deletedRecords=[];h.addedRecords=l;t.saveChange(h,c)}else!t.parent.rowDropSettings.targetID&&t.startedRow.querySelector("td.e-selectionbackground")&&f.length>1&&f.length!==t.parent.getCurrentViewRecords().length?t.reorderRows(f,u.dropIndex):t.reorderRows([parseInt(t.startedRow.getAttribute("aria-rowindex"),10)],t.dragTarget);t.dragTarget=null;i.rowDropSettings.targetID||(Object(r.remove)(n.helper),t.rowOrder(u))}t.isRefresh=!0}))};this.removeCell=function(n,t){return[].slice.call(n.querySelectorAll("td")).filter(function(i){i.classList.contains(t)&&n.deleteCell(i.cellIndex)})};this.parent=n;this.parent.isDestroyed||(this.parent.on(tt,this.initializeDrag,this),this.parent.on(dr,this.columnDrop,this),this.onDataBoundFn=this.onDataBound.bind(this),this.parent.addEventListener(ct,this.onDataBoundFn),this.parent.on(v,this.enableAfterRender,this))}return n.prototype.refreshRow=function(n,t,i){var c,l,a,v,o=this.parent,f=this.parent.getFrozenColumns(),y=o.getContentTable().querySelector("tbody"),p=o.getHeaderContent().querySelector("tbody"),s,r,u,h,e;for(f&&(a=o.getHeaderContent().querySelector(".e-movableheader").querySelector("tbody"),v=o.getContent().querySelector(".e-movablecontent").querySelector("tbody")),s=parseInt(n.target.parentElement.getAttribute("aria-rowindex"),10),(n.fromIndex<n.dropIndex||n.fromIndex===n.dropIndex)&&(s+=1),c=t.querySelectorAll(".e-row")[s],f&&(l=i.querySelectorAll(".e-row")[s]),r=0,u=n.rows.length;r<u;r++)n.rows[r]=f?r%2==0?t.children[parseInt(n.rows[r].getAttribute("aria-rowindex"),10)]:i.children[parseInt(n.rows[r].getAttribute("aria-rowindex"),10)]:t.children[parseInt(n.rows[r].getAttribute("aria-rowindex"),10)];for(r=0,u=n.rows.length;r<u;r++)f?r%2==0?t.insertBefore(n.rows[r],c):i.insertBefore(n.rows[r],l):t.insertBefore(n.rows[r],c);if(e=[].slice.call(t.querySelectorAll(".e-row")),f&&(h=[].slice.call(i.querySelectorAll(".e-row"))),this.refreshData(e,h),this.parent.frozenRows)for(r=0,u=e.length;r<u;r++)r<this.parent.frozenRows?(p.appendChild(e[r]),this.parent.getFrozenColumns()&&a.appendChild(h[r])):(y.appendChild(e[r]),this.parent.getFrozenColumns()&&v.appendChild(h[r]))},n.prototype.updateFrozenRowreOrder=function(n){var o,s,t=this.parent,r=this.parent.getFrozenColumns(),l=t.getContentTable().querySelector("tbody"),a=t.getHeaderContent().querySelector("tbody"),h,u,f,e,i,c;for(r&&(o=t.getHeaderContent().querySelector(".e-movableheader").querySelector("tbody"),s=t.getContent().querySelector(".e-movablecontent").querySelector("tbody")),u=[].slice.call(a.querySelectorAll(".e-row")).concat([].slice.call(l.querySelectorAll(".e-row"))),r&&(h=[].slice.call(o.querySelectorAll(".e-row")).concat([].slice.call(s.querySelectorAll(".e-row")))),f=t.createElement("tbody"),e=t.createElement("tbody"),this.parent.clearSelection(),i=0,c=u.length;i<c;i++)f.appendChild(u[i]),r&&e.appendChild(h[i]);this.refreshRow(n,f,e)},n.prototype.updateFrozenColumnreOrder=function(n){var t,i=this.parent,r=this.parent.getFrozenColumns(),u=i.getContentTable().querySelector("tbody");r&&(t=i.getContent().querySelector(".e-movablecontent").querySelector("tbody"));this.parent.clearSelection();this.refreshRow(n,u,t)},n.prototype.refreshData=function(n,t){for(var r,f={},e={},o={},i=0,u=n.length;i<u;i++)r=parseInt(n[i].getAttribute("aria-rowindex"),10),f[i]=this.parent.getRowsObject()[r],o[i]=this.parent.getCurrentViewRecords()[r],this.parent.frozenColumns&&(e[i]=this.parent.getMovableRowsObject()[r]);for(i=0,u=n.length;i<u;i++)n[i].setAttribute("aria-rowindex",i.toString()),n[i].setAttribute("data-uid","grid-row"+i.toString()),this.parent.getRows()[i]=n[i],this.parent.getRowsObject()[i]=f[i],this.parent.getRowsObject()[i].uid="grid-row"+i.toString(),this.parent.getRowsObject()[i].index=i,this.parent.getCurrentViewRecords()[i]=o[i],this.parent.frozenColumns&&(t[i].setAttribute("aria-rowindex",i.toString()),t[i].setAttribute("data-uid","grid-row"+(i+n.length).toString()),this.parent.getMovableRows()[i]=t[i],this.parent.getMovableRowsObject()[i]=e[i],this.parent.getMovableRowsObject()[i].uid="grid-row"+(i+n.length).toString(),this.parent.getMovableRowsObject()[i].index=i)},n.prototype.rowOrder=function(n){n.target.classList.contains("e-rowcelldrag")&&(n.target=n.target.parentElement);this.parent.frozenRows?this.updateFrozenRowreOrder(n):this.updateFrozenColumnreOrder(n);this.selectedRowColls.length>0&&this.parent.selectRows(this.selectedRowColls)},n.prototype.currentViewData=function(){for(var t=this.parent.getSelectedRowIndexes(),i=[],r=parseInt(this.startedRow.getAttribute("aria-rowindex"),10),n=0,u=t.length;n<u;n++)i[n]=this.parent.currentViewData[t[n]];return this.parent.rowDropSettings.targetID||0!==t.length||(i[0]=this.parent.currentViewData[r]),i},n.prototype.saveChange=function(n,t){var i=this;this.parent.getDataModule().saveChanges(n,this.parent.getPrimaryKeyFieldNames()[0],{},t).then(function(){i.parent.notify(p,{type:l,requestType:"rowdraganddrop"})}).catch(function(n){Object(r.isNullOrUndefined)(n.error)||Object(r.isNullOrUndefined)(n.error.message)||(n.error=n.error.message);i.parent.trigger(hi,n)})},n.prototype.reorderRows=function(n,t){for(var r,f,o=this.parent.getSelectedRowIndexes(),h=[],s=[],e=this.parent.renderModule.data.dataManager.dataSource.json,a=t,c=n[0],i=0,u=n.length;i<u;i++)s[i]=e[n[i]];for(i=0,u=o.length;i<u;i++)h[i]=e[o[i]];for(i=0,u=s.length;i<u;i++){if(0!==i){for(r=0,f=e.length;r<f;r++)if(JSON.stringify(this.parent.renderModule.data.dataManager.dataSource.json[r])===JSON.stringify(s[i])){c=r;break}for(r=0,f=e.length;r<f;r++)if(JSON.stringify(this.parent.renderModule.data.dataManager.dataSource.json[r])===JSON.stringify(s[i-1])){c>r&&(a=r+1);break}}this.reorderRow(c,a)}for(this.isRefresh&&this.parent.notify(p,{type:l,requestType:"rowdraganddrop"}),i=0,u=h.length;i<u;i++)for(r=0,f=e.length;r<f;r++)if(JSON.stringify(this.parent.renderModule.data.dataManager.dataSource.json[r])===JSON.stringify(h[i])){o[i]=r;break}this.selectedRowColls=o},n.prototype.stopTimer=function(){window.clearInterval(this.timer)},n.prototype.initializeDrag=function(){var n=this.parent;this.draggable=new r.Draggable(n.element,{dragTarget:".e-rowcelldrag, .e-rowdragdrop, .e-rowcell",distance:5,helper:this.helper,dragStart:this.dragStart,drag:this.drag,dragStop:this.dragStop,isReplaceDragEle:this.isReplaceDragEle})},n.prototype.updateScrollPostion=function(n){var t=this,s=this.parent.getFrozenColumns(),i=gi(n).y,r=this.parent.getContent().getBoundingClientRect(),u=this.parent.getRowHeight()-15,f=s?this.parent.getContent().querySelector(".e-movablecontent"):this.parent.getContent().firstElementChild,e,o;r.top+u>=i?(e=-this.parent.getRowHeight(),this.isOverflowBorder=!1,this.timer=window.setInterval(function(){t.setScrollDown(f,e,!0)},200)):r.top+this.parent.getContent().clientHeight-u-33<=i&&(o=this.parent.getRowHeight(),this.isOverflowBorder=!1,this.timer=window.setInterval(function(){t.setScrollDown(f,o,!0)},200))},n.prototype.setScrollDown=function(n,t){n.scrollTop=n.scrollTop+t},n.prototype.moveDragRows=function(n,t,i){var e=this.parent.element.querySelector(".e-cloneproperties"),u=Object(r.closest)(n.target,"tr"),f;o(u,"e-grid")&&o(e.parentElement,"e-grid").id===o(u,"e-grid").id&&(f=u||this.startedRow,this.setBorder(f,n.event,t,i))},n.prototype.setBorder=function(n,t,i,u){var a=this.parent.element,y=this.parent.element.querySelector(".e-cloneproperties"),f,e,h,s,v,c,l;(this.removeFirstRowBorder(n),this.removeLastRowBorder(n),o(n,"e-grid")&&o(y.parentElement,"e-grid").id===o(n,"e-grid").id)&&(Object(r.removeClass)(a.querySelectorAll(".e-rowcell,.e-rowdragdrop"),["e-dragborder"]),f=[],e=parseInt(u.getAttribute("aria-rowindex"),10),u&&0===e?(h=this.parent.createElement("div",{className:"e-firstrow-dragborder"}),s=this.parent.getHeaderContent(),s.classList.add("e-grid-relative"),h.style.width=a.offsetWidth-this.getScrollWidth()+"px",s.querySelectorAll(".e-firstrow-dragborder").length||s.appendChild(h)):u&&parseInt(i.getAttribute("aria-rowindex"),10)>e?(n=this.parent.getRowByIndex(e-1),f=[].slice.call(n.querySelectorAll(".e-rowcell,.e-rowdragdrop,.e-detailrowcollapse"))):f=[].slice.call(n.querySelectorAll(".e-rowcell,.e-rowdragdrop,.e-detailrowcollapse")),v=this.parent.getFrozenColumns(),u&&0!==e&&v&&(c=parseInt(n.getAttribute("aria-rowindex"),10),l=".e-rowcell,.e-rowdragdrop,.e-detailrowcollapse",f=[].slice.call(this.parent.getRows()[c].querySelectorAll(l)).concat([].slice.call(this.parent.getMovableRows()[c].querySelectorAll(l)))),f.length>0&&yt(f,!0,"e-dragborder"))},n.prototype.getScrollWidth=function(){var n=this.parent.getContent().firstElementChild;return n.scrollWidth>n.offsetWidth?ca.getScrollBarWidth():0},n.prototype.removeFirstRowBorder=function(n){this.parent.element.getElementsByClassName("e-firstrow-dragborder").length>0&&n&&0!==n.rowIndex&&Object(r.remove)(this.parent.element.getElementsByClassName("e-firstrow-dragborder")[0])},n.prototype.removeLastRowBorder=function(n){var t=n&&this.parent.getRowByIndex(this.parent.getCurrentViewRecords().length-1).getAttribute("data-uid")!==n.getAttribute("data-uid");this.parent.element.getElementsByClassName("e-lastrow-dragborder").length>0&&n&&t&&Object(r.remove)(this.parent.element.getElementsByClassName("e-lastrow-dragborder")[0])},n.prototype.removeBorder=function(n){var t,i;(this.removeFirstRowBorder(n),this.removeLastRowBorder(n),n=this.parent.getRows().filter(function(n){return n.querySelector("td.e-dragborder")})[0])&&(t=[].slice.call(n.querySelectorAll(".e-dragborder")),this.parent.getFrozenColumns()&&(i=parseInt(n.getAttribute("aria-rowindex"),10),t=[].slice.call(this.parent.getRows()[i].querySelectorAll(".e-dragborder")).concat([].slice.call(this.parent.getMovableRows()[i].querySelectorAll(".e-dragborder")))),yt(t,!1,"e-dragborder"))},n.prototype.getElementFromPosition=function(n,t){var i,r=gi(t);return n.style.display="none",i=document.elementFromPoint(r.x,r.y),n.style.display="",i},n.prototype.onDataBound=function(){this.selectedRowColls.length>0&&(this.parent.selectRows(this.selectedRowColls),this.selectedRowColls=[])},n.prototype.getTargetIdx=function(n){return n?parseInt(n.getAttribute("aria-rowindex"),10):0},n.prototype.singleRowDrop=function(n){var t,i,u=Object(r.closest)(n.target,"tr");i=n.droppedElement.parentElement.ej2_instances[0];t=u?u.rowIndex:i.currentViewData.length-1;this.reorderRow(this.startedRowIndex,t)},n.prototype.columnDrop=function(n){var i=this.parent,t,y,s,f,a,v,h,c,w,b,u,k;if(n.droppedElement.parentElement.ej2_instances[0],"grouping"!==n.droppedElement.getAttribute("action")&&(o(n.target,"e-row")||o(n.target,"e-emptyrow"))){if(y=Object(r.closest)(n.target,"tr"),"true"!==n.droppedElement.querySelector("tr").getAttribute("single-dragrow")&&n.droppedElement.parentElement.id===i.element.id||"true"===n.droppedElement.querySelector("tr").getAttribute("single-dragrow")&&n.droppedElement.parentElement.id!==i.element.id)return;if(n.droppedElement.parentElement.id!==i.element.id)t=n.droppedElement.parentElement.ej2_instances[0];else if(this.isSingleRowDragDrop||"true"===n.droppedElement.querySelector("tr").getAttribute("single-dragrow"))return void this.singleRowDrop(n);if(t.element.id!==i.element.id&&t.rowDropSettings.targetID!==i.element.id)return;if(s=t.getSelectedRecords(),f=this.getTargetIdx(y),isNaN(f)&&(f=0),i.allowPaging&&(f=f+i.pageSettings.currentPage*i.pageSettings.pageSize-i.pageSettings.pageSize),Object(r.isBlazor)()){for(a=[],v=t.getSelectedRowIndexes(),u=0;u<v.length;u++)a[u]=t.currentViewData[v[u]];h={addedRecords:s=a,deletedRecords:[],changedRecords:[]};c=new e.Query;c.dragDropDestinationIndex=f;i.getDataModule().saveChanges(h,i.getPrimaryKeyFieldNames()[0],{},c).then(function(){i.notify(p,{type:l,requestType:"rowdraganddrop"})}).catch(function(n){Object(r.isNullOrUndefined)(n.error)||Object(r.isNullOrUndefined)(n.error.message)||(n.error=n.error.message);i.trigger(hi,n)});h.deletedRecords=s;h.addedRecords=[];t.getDataModule().saveChanges(h,t.getPrimaryKeyFieldNames()[0],{},c).then(function(){t.notify(p,{type:l,requestType:"rowdraganddrop"})}).catch(function(n){Object(r.isNullOrUndefined)(n.error)||Object(r.isNullOrUndefined)(n.error.message)||(n.error=n.error.message);t.trigger(hi,n)})}else{for(i.notify(ao,{toIndex:f,records:s}),i.notify(p,{type:l,requestType:"rowdraganddrop"}),w=t.getSelectedRowIndexes(),b=t.allowPaging?t.pageSettings.currentPage*t.pageSettings.pageSize-t.pageSettings.pageSize:0,this.selectedRows=[],u=0,k=s.length;u<k;u++)this.selectedRows.push(b+w[u]);t.notify(bu,{indexes:this.selectedRows,records:s});t.notify(p,{type:l,requestType:"rowdraganddrop"})}}},n.prototype.reorderRow=function(n,t){var i=this.parent,r;i.sortSettings.columns.length||i.groupSettings.columns.length||i.filterSettings.columns.length||(r=i.allowPaging?i.pageSettings.currentPage*i.pageSettings.pageSize-i.pageSettings.pageSize:0,t+=r,this.selectedRows=i.getSelectedRowIndexes(),i.notify(yl,{fromIndex:n+r,toIndex:t}))},n.prototype.enableAfterRender=function(n){n.module===this.getModuleName()&&n.enable&&this.initializeDrag()},n.prototype.destroy=function(){var n=this.parent.element;!this.parent.isDestroyed&&n&&(n.querySelector(".e-gridheader")||n.querySelector(".e-gridcontent"))&&(this.draggable.destroy(),this.parent.off(tt,this.initializeDrag),this.parent.off(dr,this.columnDrop),this.parent.removeEventListener(ct,this.onDataBoundFn),this.parent.off(v,this.enableAfterRender))},n.prototype.getModuleName=function(){return"rowDragAndDrop"},n.prototype.processArgs=function(){var n=this.parent;n.getSelectedRecords().length>0&&!1===this.startedRow.cells[0].classList.contains("e-selectionbackground")||0===n.getSelectedRecords().length?(this.rows=[this.startedRow],this.rowData=[this.parent.getRowInfo(this.startedRow.querySelector(".e-rowcell")).rowData]):(this.rows=n.getSelectedRows(),this.rowData=n.getSelectedRecords())},n}(),br=function(){function n(n,t,i,u){var f=this;this.sortRequired=!0;this.isAppliedGroup=!1;this.isAppliedUnGroup=!1;this.reorderingColumns=[];this.visualElement=Object(r.createElement)("div",{className:"e-cloneproperties e-dragclone e-gdclone",styles:"line-height:23px",attrs:{action:"grouping"}});this.helper=function(n){var r=f.parent,i=n.sender.target,t=i.classList.contains("e-groupheadercell")?i:o(i,"e-groupheadercell");return!(!t||!i.classList.contains("e-drag")&&f.groupSettings.allowReordering)&&(f.column=r.getColumnByField(t.firstElementChild.getAttribute("ej-mappingname")),f.visualElement.textContent=t.textContent,f.visualElement.style.width=t.offsetWidth+2+"px",f.visualElement.style.height=t.offsetHeight+2+"px",f.visualElement.setAttribute("e-mappinguid",f.column.uid),r.element.appendChild(f.visualElement),f.visualElement)};this.dragStart=function(n){f.parent.element.classList.add("e-ungroupdrag");Object(r.isBlazor)()&&n.bindEvents(n.dragElement)};this.drag=function(n){f.groupSettings.allowReordering&&f.animateDropper(n);var t=n.target,i=f.parent.element.querySelector(".e-cloneproperties");f.parent.trigger(or,{target:t,draggableType:"headercell",column:f.column});f.groupSettings.allowReordering||(Object(r.classList)(i,["e-defaultcur"],["e-notallowedcur"]),o(t,"e-gridcontent")||o(t,"e-headercell")||Object(r.classList)(i,["e-notallowedcur"],["e-defaultcur"]))};this.dragStop=function(n){var t,i;f.parent.element.classList.remove("e-ungroupdrag");t=!(o(n.target,"e-gridcontent")||o(n.target,"e-gridheader"));f.groupSettings.allowReordering&&t?(Object(r.remove)(n.helper),o(n.target,"e-groupdroparea"))?f.rearrangeGroup(n):o(n.target,"e-grid")||(i=f.parent.getColumnByUid(n.helper.getAttribute("e-mappinguid")).field,-1!==f.groupSettings.columns.indexOf(i)&&f.ungroupColumn(i)):t&&Object(r.remove)(n.helper)};this.animateDropper=function(n){var a=f.parent.element.querySelector(".e-cloneproperties").getAttribute("e-mappinguid"),i=f.parent.getColumnByUid(a).field,h=o(n.target,"e-groupdroparea"),r=o(n.target,"e-group-animator"),v=[].slice.call(f.element.querySelectorAll(".e-groupheadercell")).map(function(n){return n.querySelector("div").getAttribute("ej-mappingname")}),t=JSON.parse(JSON.stringify(v)),c,u,e,l,s;if(r||h)for(r?(c=r.querySelector("div[ej-mappingname]").getAttribute("ej-mappingname"),u=+r.getAttribute("index"),c!==i&&(e=t.indexOf(i),-1!==e&&t.splice(e,1),l=-1!==u&&e===u,t.splice(u+(l?1:0),0,i))):h&&-1===t.indexOf(i)&&t.push(i),f.element.innerHTML="",t.length&&!f.element.classList.contains("e-grouped")&&f.element.classList.add("e-grouped"),f.reorderingColumns=t,s=0;s<t.length;s++)f.addColToGroupDrop(t[s]);else f.addLabel(),f.removeColFromGroupDrop(i)};this.drop=function(n){var i=f.parent,t=i.getColumnByUid(n.droppedElement.getAttribute("e-mappinguid"));f.element.classList.remove("e-hover");Object(r.remove)(n.droppedElement);f.aria.setDropTarget(f.parent.element.querySelector(".e-groupdroparea"),!1);f.aria.setGrabbed(f.parent.getHeaderTable().querySelector("[aria-grabbed=true]"),!1);Object(r.isNullOrUndefined)(t)||!1===t.allowGrouping||o(i.getColumnHeaderByUid(t.uid),"e-grid").getAttribute("id")!==i.element.getAttribute("id")?f.parent.log("action_disabled_column",{moduleName:f.getModuleName(),columnName:t.headerText}):f.groupColumn(t.field)};this.contentRefresh=!0;this.aria=new sf;this.parent=n;this.groupSettings=t;this.serviceLocator=u;this.sortedColumns=i;this.focus=u.getService("focus");this.addEventListener();this.groupGenerator=new be(this.parent)}return n.prototype.addLabel=function(){if(!this.element.querySelectorAll(".e-group-animator").length){var n=this.l10n.getConstant("GroupDropArea");this.element.innerHTML=n;this.element.classList.remove("e-grouped")}},n.prototype.rearrangeGroup=function(){this.sortRequired=!1;this.updateModel()},n.prototype.columnDrag=function(n){this.groupSettings.allowReordering&&this.animateDropper(n);this.parent;var t=this.parent.element.querySelector(".e-cloneproperties");Object(r.classList)(t,["e-defaultcur"],["e-notallowedcur"]);o(n.target,"e-groupdroparea")||this.parent.allowReordering&&o(n.target,"e-headercell")||Object(r.classList)(t,["e-notallowedcur"],["e-defaultcur"]);n.target.classList.contains("e-groupdroparea")?this.element.classList.add("e-hover"):this.element.classList.remove("e-hover")},n.prototype.columnDragStart=function(n){var t,i;n.target.classList.contains("e-stackedheadercell")||(this.parent,t=this.parent.element.querySelector(".e-groupdroparea"),this.aria.setDropTarget(t,n.column.allowGrouping),i=n.target.classList.contains("e-headercell")?n.target:o(n.target,"e-headercell"),this.aria.setGrabbed(i,!0,!n.column.allowGrouping))},n.prototype.columnDrop=function(n){var i=this.parent,t;if("grouping"===n.droppedElement.getAttribute("action")){if(t=i.getColumnByUid(n.droppedElement.getAttribute("e-mappinguid")),Object(r.isNullOrUndefined)(t)||!1===t.allowGrouping||o(i.getColumnHeaderByUid(t.uid),"e-grid").getAttribute("id")!==i.element.getAttribute("id"))return;this.ungroupColumn(t.field)}},n.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(v,this.enableAfterRender,this),this.parent.on(co,this.onActionComplete,this),this.parent.on(tl,this.onActionComplete,this),this.parent.on(d,this.onPropertyChanged,this),this.parent.on(it,this.clickHandler,this),this.parent.on(or,this.columnDrag,this),this.parent.on(kr,this.columnDragStart,this),this.parent.on(tu,this.columnDrop,this),this.parent.on(dr,this.columnDrop,this),this.parent.on(g,this.refreshSortIcons,this),this.parent.on(ne,this.refreshSortIcons,this),this.parent.on(w,this.keyPressHandler,this),this.parent.on(y,this.initialEnd,this),this.parent.on(bt,this.initialEnd,this),this.parent.on(tt,this.render,this),this.parent.on(pi,this.onGroupAggregates,this),this.parent.on("blazor-action-begin",this.blazorActionBegin,this),this.parent.on("group-expand-collapse",this.updateExpand,this),this.parent.on("persist-data-changed",this.initialEnd,this))},n.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(tt,this.render),this.parent.off(v,this.enableAfterRender),this.parent.off(co,this.onActionComplete),this.parent.off(tl,this.onActionComplete),this.parent.off(d,this.onPropertyChanged),this.parent.off(it,this.clickHandler),this.parent.off(or,this.columnDrag),this.parent.off(kr,this.columnDragStart),this.parent.off(dr,this.columnDrop),this.parent.off(tu,this.columnDrop),this.parent.off(g,this.refreshSortIcons),this.parent.off(ne,this.refreshSortIcons),this.parent.off(w,this.keyPressHandler),this.parent.off(pi,this.onGroupAggregates),this.parent.off("blazor-action-begin",this.blazorActionBegin),this.parent.off("group-expand-collapse",this.updateExpand))},n.prototype.blazorActionBegin=function(){this.parent.allowGrouping&&!this.parent.isCollapseStateEnabled()&&this.expandAll()},n.prototype.initialEnd=function(){var n=this.parent,t,i,u,f;if(this.parent.off(y,this.initialEnd),this.parent.off(bt,this.initialEnd),Object(r.isBlazor)()&&n.isServerRendered){for(t=0;t<n.columns.length;t++)this.removeColFromGroupDrop(n.columns[t].field);this.updateGroupDropArea()}if(this.parent.getColumns().length&&this.groupSettings.columns.length){for(this.contentRefresh=!1,i=0,u=n.groupSettings.columns;i<u.length;i++)f=u[i],this.groupColumn(f);this.contentRefresh=!0}},n.prototype.keyPressHandler=function(n){var t=this.parent,f,s,h,e,u;if("ctrlSpace"===n.action||this.groupSettings.columns.length&&-1!==["altDownArrow","altUpArrow","ctrlDownArrow","ctrlUpArrow","enter"].indexOf(n.action))switch(n.preventDefault(),n.action){case"altDownArrow":case"altUpArrow":if(f=t.allowSelection?t.getSelectedRowIndexes():[],f.length){for(var o=t.getContentTable().querySelector("tbody").children,c=void 0,i=t.getDataRows()[f[f.length-1]].rowIndex;i>=0;i--)if(!o[i].classList.contains("e-row")&&!o[i].classList.contains("e-detailrow")){c=o[i];break}this.expandCollapseRows(c.querySelector("altUpArrow"===n.action?".e-recordplusexpand":".e-recordpluscollapse"))}break;case"ctrlDownArrow":this.expandAll();break;case"ctrlUpArrow":this.collapseAll();break;case"enter":if(this.parent.isEdit||null!==Object(r.closest)(n.target,"#"+this.parent.element.id+"_searchbar"))return;if(s=this.focus.getFocusedElement(),h=s?s.parentElement.querySelector('[class^="e-record"]'):null,!h)break;this.expandCollapseRows(h);break;case"ctrlSpace":e=t.focusModule.currentInfo.element;e&&e.classList.contains("e-headercell")&&(u=t.getColumnByUid(e.firstElementChild.getAttribute("e-mappinguid")),u.field&&t.groupSettings.columns.indexOf(u.field)<0?this.groupColumn(u.field):this.ungroupColumn(u.field))}},n.prototype.clickHandler=function(n){this.expandCollapseRows(n.target);this.applySortFromTarget(n.target);this.unGroupFromTarget(n.target);this.toogleGroupFromHeader(n.target)},n.prototype.unGroupFromTarget=function(n){n.classList.contains("e-ungroupbutton")&&this.ungroupColumn(n.parentElement.getAttribute("ej-mappingname"))},n.prototype.toogleGroupFromHeader=function(n){this.groupSettings.showToggleButton&&(n.classList.contains("e-grptogglebtn")?n.classList.contains("e-toggleungroup")?this.ungroupColumn(this.parent.getColumnByUid(n.parentElement.getAttribute("e-mappinguid")).field):this.groupColumn(this.parent.getColumnByUid(n.parentElement.getAttribute("e-mappinguid")).field):n.classList.contains("e-toggleungroup")&&this.ungroupColumn(n.parentElement.getAttribute("ej-mappingname")))},n.prototype.applySortFromTarget=function(n){var t=this.parent,u=Object(r.closest)(n,".e-groupheadercell"),i;t.allowSorting&&u&&!n.classList.contains("e-ungroupbutton")&&!n.classList.contains("e-toggleungroup")&&(i=u.firstElementChild.getAttribute("ej-mappingname"),t.getColumnHeaderByField(i).querySelectorAll(".e-ascending").length?t.sortColumn(i,"Descending",!0):t.sortColumn(i,"Ascending",!0))},n.prototype.expandCollapseRows=function(n){var i=o(n,"e-recordplusexpand")||o(n,"e-recordpluscollapse"),t,s;if(i){var l=i.cellIndex,y=i.parentElement.rowIndex,a=this.parent.getContentTable().querySelector("tbody").children,u=[].slice.call(a).slice(y+1,a.length),h=void 0,v=void 0,f=[],e=this.parent,p=i.parentElement.querySelectorAll(".e-indentcell").length,c=!1;if(Object(r.isBlazor)()&&this.parent.isCollapseStateEnabled())return void this.parent.notify("group-expand-collapse",{uid:i.parentElement.getAttribute("data-uid"),isExpand:i.classList.contains("e-recordpluscollapse")});if(i.classList.contains("e-recordpluscollapse")?(Object(r.addClass)([i],"e-recordplusexpand"),Object(r.removeClass)([i],"e-recordpluscollapse"),i.firstElementChild.className="e-icons e-gdiagonaldown e-icon-gdownarrow",c=!0,nt(e)&&this.updateVirtualRows(e,n,c,void 0,void 0),this.parent.groupSettings.enableLazyLoading&&this.parent.contentModule.captionExpand(i.parentElement)):(h=!0,Object(r.removeClass)([i],"e-recordplusexpand"),Object(r.addClass)([i],"e-recordpluscollapse"),i.firstElementChild.className="e-icons e-gnextforward e-icon-grightarrow",nt(e)&&this.updateVirtualRows(e,n,!h,void 0,void 0),this.parent.groupSettings.enableLazyLoading&&this.parent.contentModule.captionCollapse(i.parentElement)),this.aria.setExpand(i,c),!nt(e)&&!this.parent.groupSettings.enableLazyLoading)for(t=0,s=u.length;t<s&&u[t].querySelectorAll("td")[l]&&u[t].querySelectorAll("td")[l].classList.contains("e-indentcell")&&u;t++)h?u[t].style.display="none":u[t].querySelectorAll(".e-indentcell").length===p+1&&(u[t].style.display="",(v=u[t].querySelector(".e-recordplusexpand"))&&f.push(v),u[t].classList.contains("e-detailrow")&&u[t-1].querySelectorAll(".e-detailrowcollapse").length&&(u[t].style.display="none"));for(t=0,s=f.length;t<s;t++)Object(r.removeClass)([f[t]],"e-recordplusexpand"),Object(r.addClass)([f[t]],"e-recordpluscollapse"),f[t].firstElementChild.className="e-icons e-gnextforward e-icon-grightarrow",this.expandCollapseRows(f[t])}},n.prototype.updateVirtualRows=function(n,t,i,r){var f=n.getRowObjectFromUID(t.closest("tr").getAttribute("data-uid")),u;f.isExpand=i;tk(n);(r=n.getDataModule().generateQuery(!1)).queries=n.getDataModule().aggregateQuery(n.getQuery().clone()).queries;u={requestType:"virtualscroll",rowObject:f};n.getDataModule().getData(u,r.requiresCount()).then(function(t){return n.renderModule.dataManagerSuccess(t,u)})},n.prototype.expandCollapse=function(n){if(Object(r.isBlazor)()&&this.parent.isCollapseStateEnabled())this.parent.notify("group-expand-collapse",{isExpand:n});else{n||this.parent.notify(ys,n);for(var u,i=this.parent.getContentTable().querySelector("tbody").children,t=0,f=i.length;t<f;t++)i[t].querySelectorAll(".e-recordplusexpand, .e-recordpluscollapse").length?((u=i[t].querySelector(n?".e-recordpluscollapse":".e-recordplusexpand"))&&(u.className=n?"e-recordplusexpand":"e-recordpluscollapse",u.firstElementChild.className=n?"e-icons e-gdiagonaldown e-icon-gdownarrow":"e-icons e-gnextforward e-icon-grightarrow"),i[t].firstElementChild.classList.contains("e-recordplusexpand")||i[t].firstElementChild.classList.contains("e-recordpluscollapse")||(i[t].style.display=n?"":"none")):i[t].style.display=n?"":"none"}},n.prototype.expandAll=function(){this.expandCollapse(!0)},n.prototype.collapseAll=function(){this.expandCollapse(!1)},n.prototype.render=function(){this.l10n=this.serviceLocator.getService("localization");this.renderGroupDropArea();this.initDragAndDrop();this.refreshToggleBtn()},n.prototype.renderGroupDropArea=function(){var n=this.parent.element.querySelector(".e-groupdroparea");n&&Object(r.remove)(n);this.element=this.parent.createElement("div",{className:"e-groupdroparea",attrs:{tabindex:"-1"}});this.groupSettings.allowReordering&&this.element.classList.add("e-group-animate");this.updateGroupDropArea();this.parent.element.insertBefore(this.element,this.parent.element.firstChild);this.groupSettings.showDropArea||(this.element.style.display="none")},n.prototype.updateGroupDropArea=function(n){if(this.groupSettings.showDropArea&&!this.groupSettings.columns.length){var t=this.l10n.getConstant("GroupDropArea");this.element.innerHTML=t;this.element.classList.remove("e-grouped")}else(this.element.innerHTML!==this.l10n.getConstant("GroupDropArea")||1!==this.groupSettings.columns.length&&(this.isAppliedGroup||this.isAppliedUnGroup))&&!n||(this.element.innerHTML=""),this.element.classList.add("e-grouped")},n.prototype.initDragAndDrop=function(){this.initializeGHeaderDrop();this.initializeGHeaderDrag()},n.prototype.initializeGHeaderDrag=function(){new r.Draggable(this.element,{dragTarget:this.groupSettings.allowReordering?".e-drag":".e-groupheadercell",distance:this.groupSettings.allowReordering?-10:5,helper:this.helper,dragStart:this.dragStart,drag:this.drag,dragStop:this.dragStop})},n.prototype.initializeGHeaderDrop=function(){this.parent;new r.Droppable(this.element,{accept:".e-dragclone",drop:this.drop})},n.prototype.groupColumn=function(n){var t=this.parent,i=t.getColumnByField(n);Object(r.isNullOrUndefined)(i)||!1===i.allowGrouping||this.contentRefresh&&this.groupSettings.columns.indexOf(n)>-1?this.parent.log("action_disabled_column",{moduleName:this.getModuleName(),columnName:i.headerText}):si(t)?t.notify(ot,{instance:this,handler:this.groupColumn,arg1:n}):(i.visible=t.groupSettings.showGroupedColumn,this.colName=n,this.isAppliedGroup=!0,this.contentRefresh?this.updateModel():this.addColToGroupDrop(n),this.updateGroupDropArea(),this.isAppliedGroup=!1)},n.prototype.ungroupColumn=function(n){var t=this.parent,i=this.parent.enableColumnVirtualization?this.parent.columns.filter(function(t){return t.field===n})[0]:t.getColumnByField(n),e,u,f,o;if(!(Object(r.isNullOrUndefined)(i)||!1===i.allowGrouping||this.groupSettings.columns.indexOf(n)<0))if(si(t))t.notify(ot,{instance:this,handler:this.ungroupColumn,arg1:n});else{if((i.visible=!0,Object(r.isBlazor)()&&t.isServerRendered)&&(e=[],e[0]=i,this.parent.notify("setvisibility",e)),this.colName=i.field,u=JSON.parse(JSON.stringify(this.groupSettings.columns)),u.splice(u.indexOf(this.colName),1),this.sortedColumns.indexOf(n)<0)for(f=0,o=t.sortSettings.columns.length;f<o;f++)if(n===t.sortSettings.columns[f].field){t.sortSettings.columns.splice(f,1);break}Object(r.isBlazor)()&&this.parent.isServerRendered&&(t.sortSettings.columns=t.sortSettings.columns);this.groupSettings.allowReordering&&(this.reorderingColumns=u);this.groupSettings.columns=u;t.allowGrouping&&(this.isAppliedUnGroup=!0,this.parent.dataBind())}},n.prototype.updateModel=function(){this.parent;var n=JSON.parse(JSON.stringify(this.groupSettings.columns));n=this.reorderingColumns.length?JSON.parse(JSON.stringify(this.reorderingColumns)):n;this.sortRequired&&(-1===n.indexOf(this.colName)&&n.push(this.colName),this.groupAddSortingQuery(this.colName));this.sortRequired=!0;this.parent.groupSettings.columns=n;this.parent.dataBind()},n.prototype.onActionComplete=function(n){Object(r.isBlazor)()&&!this.parent.isJsComponent&&(n.rows=null);this.parent;"grouping"===n.requestType?this.addColToGroupDrop(this.colName):this.removeColFromGroupDrop(this.colName);var t=this.groupSettings.columns.indexOf(this.colName)>-1?{columnName:this.colName,requestType:"grouping",type:c}:{requestType:"ungrouping",type:c};this.parent.trigger(c,Object(r.extend)(n,t));this.colName=null},n.prototype.groupAddSortingQuery=function(n){for(var t=0;t<this.parent.sortSettings.columns.length&&this.parent.sortSettings.columns[t].field!==n;)t++;this.parent.sortSettings.columns.length===t?(this.parent.sortSettings.columns.push({field:n,direction:"Ascending",isFromGroup:!0}),Object(r.isBlazor)()&&this.parent.isServerRendered&&(this.parent.sortSettings.columns=this.parent.sortSettings.columns)):this.parent.allowSorting||(this.parent.sortSettings.columns[t].direction="Ascending")},n.prototype.createElement=function(n){var s=this.parent,u="Ascending",f=this.parent.createElement("div",{className:"e-grid-icon e-group-animator"}),i=this.parent.createElement("div",{className:"e-grid-icon e-groupheadercell"}),t=this.parent.createElement("div",{attrs:{"ej-mappingname":n}}),e=this.parent.getColumnByField(n),o=s.getColumnHeaderByUid(e.uid);return this.groupSettings.allowReordering&&t.appendChild(this.parent.createElement("span",{className:"e-drag e-icons e-icon-drag",innerHTML:"&nbsp;",attrs:{title:"Drag",tabindex:"-1","aria-label":"Drag the grouped column"}})),t.appendChild(this.parent.createElement("span",{className:"e-grouptext",innerHTML:e.headerText,attrs:{tabindex:"-1","aria-label":"sort the grouped column"}})),this.groupSettings.showToggleButton&&t.appendChild(this.parent.createElement("span",{className:"e-togglegroupbutton e-icons e-icon-ungroup e-toggleungroup",innerHTML:"&nbsp;",attrs:{tabindex:"-1","aria-label":"ungroup button"}})),o.querySelectorAll(".e-ascending,.e-descending").length&&(u=o.querySelector(".e-ascending")?"Ascending":"Descending"),t.appendChild(this.parent.createElement("span",{className:"e-groupsort e-icons e-"+u.toLowerCase()+" e-icon-"+u.toLowerCase(),innerHTML:"&nbsp;",attrs:{tabindex:"-1","aria-label":"sort the grouped column"}})),t.appendChild(this.parent.createElement("span",{className:"e-ungroupbutton e-icons e-icon-hide",innerHTML:"&nbsp;",attrs:{title:Object(r.isBlazor)()?this.l10n.getConstant("UnGroupButton"):this.l10n.getConstant("UnGroup"),tabindex:"-1","aria-label":"ungroup the grouped column"},styles:this.groupSettings.showUngroupButton?"":"display:none"})),i.appendChild(t),this.groupSettings.columns.indexOf(n),this.groupSettings.allowReordering&&(f.appendChild(i),f.appendChild(this.createSeparator()),i=f),i},n.prototype.addColToGroupDrop=function(n){var i,t,u;this.groupSettings.allowReordering&&this.parent.element.querySelector(".e-groupdroparea div[ej-mappingname="+n+"]")||(i=this.parent.getColumnByField(n),Object(r.isNullOrUndefined)(i)||(t=this.createElement(n),this.groupSettings.allowReordering&&(u=this.element.querySelectorAll(".e-group-animator").length,t.setAttribute("index",u.toString())),this.element.appendChild(t)))},n.prototype.createSeparator=function(){return this.parent.createElement("span",{className:"e-nextgroup e-icons e-icon-next",innerHTML:"&nbsp;",attrs:{tabindex:"-1","aria-label":"Separator for the grouped columns"},styles:this.groupSettings.showUngroupButton?"":"display:none"})},n.prototype.refreshToggleBtn=function(n){var u;if(this.groupSettings.showToggleButton)for(var i=[].slice.call(this.parent.getHeaderTable().getElementsByClassName("e-headercelldiv")),t=0,f=i.length;t<f;t++)i[t].classList.contains("e-emptycell")||i[t].classList.contains("e-headerchkcelldiv")||(u=this.parent.getColumnByUid(i[t].getAttribute("e-mappinguid")),this.parent.showColumnMenu&&(!this.parent.showColumnMenu||u.showColumnMenu)||(i[t].querySelectorAll(".e-grptogglebtn").length&&Object(r.remove)(i[t].querySelectorAll(".e-grptogglebtn")[0]),n||i[t].appendChild(this.parent.createElement("span",{className:"e-grptogglebtn e-icons "+(this.groupSettings.columns.indexOf(u.field)>-1?"e-toggleungroup e-icon-ungroup":"e-togglegroup e-icon-group"),attrs:{tabindex:"-1","aria-label":"Group button"}}))))},n.prototype.removeColFromGroupDrop=function(n){var t,i;Object(r.isNullOrUndefined)(this.getGHeaderCell(n))||(t=this.getGHeaderCell(n),this.groupSettings.allowReordering?(i=o(t,"e-group-animator"),Object(r.remove)(i)):Object(r.remove)(t),this.updateGroupDropArea());this.isAppliedUnGroup=!1},n.prototype.onPropertyChanged=function(n){var f,o,i,u,t,e;if(n.module===this.getModuleName())for(f=0,o=Object.keys(n.properties);f<o.length;f++){i=o[f];switch(i){case"columns":if(u=void 0,this.contentRefresh){if(this.isAppliedUnGroup)u={columnName:this.colName,requestType:"ungrouping",type:l};else{if(!this.isAppliedGroup)for(this.updateGroupDropArea(!0),t=0;t<this.groupSettings.columns.length;t++)this.colName=this.groupSettings.columns[t],this.parent.getColumnByField(this.colName).visible=this.parent.groupSettings.showGroupedColumn,this.groupAddSortingQuery(this.colName),t<this.groupSettings.columns.length-1&&this.addColToGroupDrop(this.groupSettings.columns[t]);u={columnName:this.colName,requestType:n.properties[i].length?"grouping":"ungrouping",type:l}}if(!this.groupSettings.showGroupedColumn)for(e=n.oldProperties[i],t=0;t<e.length;t++)-1===n.properties[i].indexOf(e[t])&&(this.parent.getColumnByField(e[t]).visible=!0);Object(r.isBlazor)()&&this.parent.isServerRendered&&this.parent.isCollapseStateEnabled()&&"grouping"===u.requestType&&this.parent.refreshHeader();this.parent.notify(p,u)}break;case"showDropArea":this.updateGroupDropArea();this.element.style.display=this.groupSettings.showDropArea?"":"none";break;case"showGroupedColumn":this.updateGroupedColumn(this.groupSettings.showGroupedColumn);this.parent.notify(p,{requestType:"refresh"});break;case"showUngroupButton":this.updateButtonVisibility(this.groupSettings.showUngroupButton,"e-ungroupbutton");break;case"showToggleButton":this.updateButtonVisibility(this.groupSettings.showToggleButton,"e-togglegroupbutton ");this.parent.refreshHeader();break;case"enableLazyLoading":this.parent.freezeRefresh()}}},n.prototype.updateGroupedColumn=function(n){for(var t=0;t<this.groupSettings.columns.length;t++)this.parent.getColumnByField(this.groupSettings.columns[t]).visible=n},n.prototype.updateButtonVisibility=function(n,t){for(var r=[].slice.call(this.element.querySelectorAll("."+t)),i=0;i<r.length;i++)r[i].style.display=n?"":"none"},n.prototype.enableAfterRender=function(n){n.module===this.getModuleName()&&n.enable&&this.render()},n.prototype.destroy=function(){var n=this.parent.element;n&&(n.querySelector(".e-gridheader")||n.querySelector(".e-gridcontent"))&&(this.parent.isDestroyed||this.parent.refreshing||this.clearGrouping(),this.removeEventListener(),this.refreshToggleBtn(!0),Object(r.remove)(this.element))},n.prototype.clearGrouping=function(){var i=JSON.parse(JSON.stringify(this.groupSettings.columns)),n,t;for(this.contentRefresh=!1,n=0,t=i.length;n<t;n++)n===t-1&&(this.contentRefresh=!0),this.ungroupColumn(i[n]);this.contentRefresh=!0},n.prototype.getModuleName=function(){return"group"},n.prototype.refreshSortIcons=function(){var f,i=this.parent,t=i.sortSettings.columns,e=i.groupSettings.columns,o=this.parent.getColumns().map(function(n){return n.field}),n,u;for(this.refreshToggleBtn(),n=0,u=t.length;n<u;n++)-1!==o.indexOf(t[n].field)&&(f=i.getColumnHeaderByField(t[n].field),!i.allowSorting&&(this.sortedColumns.indexOf(t[n].field)>-1||this.groupSettings.columns.indexOf(t[n].field)>-1)?(Object(r.classList)(f.querySelector(".e-sortfilterdiv"),["e-ascending","e-icon-ascending"],[]),t.length>1&&f.querySelector(".e-headercelldiv").appendChild(this.parent.createElement("span",{className:"e-sortnumber",innerHTML:(n+1).toString()}))):this.getGHeaderCell(t[n].field)&&this.getGHeaderCell(t[n].field).querySelectorAll(".e-groupsort").length&&("Ascending"===t[n].direction?Object(r.classList)(this.getGHeaderCell(t[n].field).querySelector(".e-groupsort"),["e-ascending","e-icon-ascending"],["e-descending","e-icon-descending"]):Object(r.classList)(this.getGHeaderCell(t[n].field).querySelector(".e-groupsort"),["e-descending","e-icon-descending"],["e-ascending","e-icon-ascending"])));for(n=0,u=e.length;n<u;n++)-1!==o.indexOf(e[n])&&i.getColumnHeaderByField(e[n]).setAttribute("aria-grouped","true")},n.prototype.getGHeaderCell=function(n){return this.element&&this.element.querySelector('[ej-mappingname="'+n+'"]')?this.element.querySelector('[ej-mappingname="'+n+'"]').parentElement:null},n.prototype.onGroupAggregates=function(n){var e=this.iterateGroupAggregates(n),o=this.groupGenerator.generateRows(e,{}),r=this.parent.getRowsObject().filter(function(n){return!n.isDataRow}),u=o.filter(function(n){return!n.isDataRow}),t,i,f;for(this.parent.isReact&&this.parent.destroyTemplate(["groupFooterTemplate","groupCaptionTemplate","footerTemplate"]),t=0;t<u.length;t++)i=u[t],f={cells:i.cells.filter(function(n){return n.isDataCell}),data:i.data,dataUid:r[t]?r[t].uid:""},this.parent.notify(il,f)},n.prototype.iterateGroupAggregates=function(n){var v=n instanceof Array?n:[],g=this.parent.getRowsObject(),nt=this.parent.getCurrentViewRecords(),i=[],s=g.map(function(n){return"delete"===n.edit&&i.push(n.data),n.changes instanceof Object?n.changes:n.data}),y=this.parent.getPrimaryKeyFieldNames()[0],r,h,u,p,f,t,d,a,o;if(s=0===v.length?s:v,r=nt.map(function(n){var t,i=e.DataUtil.getObject(y,n);return s.some(function(n){return t=n,i===e.DataUtil.getObject(y,n)})?t:n}),h=n,(!h.type||"cancel"!==h.type)&&i.length>0)for(u=0;u<i.length;u++)p=r.indexOf(i[u]),r.splice(p,1);for(var c,w,b=[],k=this.parent.aggregates,l=0;l<k.length;l++)for(f=k[l],t=0;t<f.columns.length;t++)d={type:f.columns[t].type.toString().toLowerCase(),field:f.columns[t].field},b.push(d);for(a=this.parent.groupSettings.columns,o=0;o<a.length;o++)w=c||r,c=e.DataUtil.group(w,a[o],b,null,null);return c},n.prototype.updateExpand=function(n){for(var i,o,f,e=n.uid,s=n.isExpand,t=this.parent.getRowsObject(),u=0;u<t.length;u++)if(i=t[u],i.uid===e||Object(r.isNullOrUndefined)(e))for(i.isExpand=s,o=function(n){var u=t[n],f=void 0;if(u.parentUid!==i.uid&&(f=t.filter(function(n){return n.uid===u.parentUid})[0]),u.parentUid===i.uid?u.visible=i.isExpand:Object(r.isNullOrUndefined)(f)||u.parentUid!==f.uid||(f.isExpand&&!0===f.visible?u.visible=!0:f.isExpand&&!1===f.visible&&(u.visible=!1)),Object(r.isNullOrUndefined)(e))return"break"},f=u+1;f<t.length;f++)if("break"===o(f))break;this.parent.notify(y,{rows:t,args:{isFrozen:!1,rows:t}})},n}(),hit=function(){function n(n,t){this.aria=new sf;this.parent=n;this.parent.isDestroyed||(this.focus=t.getService("focus"),this.parent.on(it,this.clickHandler,this),this.parent.on(ri,this.destroy,this),this.parent.on(w,this.keyPressHandler,this),this.parent.on(us,this.expand,this),this.parent.on(ui,this.refreshColSpan,this))}return n.prototype.clickHandler=function(n){this.toogleExpandcollapse(Object(r.closest)(n.target,"td"))},n.prototype.toogleExpandcollapse=function(n){var i,t=this.parent,a=this.parent.getContentTable(),ut=this.parent.getCurrentViewRecords().length-1,b=n&&n.classList.contains("e-detailrowcollapse"),o,tt,l,v,p,w,it;if(n&&(n.classList.contains("e-detailrowcollapse")||n.classList.contains("e-detailrowexpand")))if(Object(r.isBlazor)()&&this.parent.isServerRendered)this.parent.notify("detailclick",n);else{var u=n.parentElement,ft=u.getAttribute("data-uid"),e=t.getRowObjectFromUID(ft),c=this.parent.getContentTable().querySelector("tbody").children[u.rowIndex+1];if(n.classList.contains("e-detailrowcollapse")){if(o=e.data,this.isDetailRow(c))c.style.display="",t.notify(wl,{data:o,childGrid:t.childGrid,detailElement:n,isExpanded:b});else if(t.getDetailTemplate()||t.childGrid){var k=ei("grid-row"),f=this.parent.createElement("tr",{className:"e-detailrow",attrs:{"data-uid":k}}),s=this.parent.createElement("td",{className:"e-detailcell"}),d=this.parent.getVisibleColumns().length;this.parent.allowRowDragAndDrop&&d++;s.setAttribute("colspan",d.toString());for(var g=new kt({isDataRow:!0,isExpand:!0,uid:k,isDetailRow:!0,cells:[new st({cellType:h.Indent}),new st({isDataCell:!0,visible:!0})]}),nt=0,et=t.groupSettings.columns.length;nt<et;nt++)f.appendChild(this.parent.createElement("td",{className:"e-indentcell"})),g.cells.unshift(new st({cellType:h.Indent}));(f.appendChild(this.parent.createElement("td",{className:"e-detailindentcell"})),f.appendChild(s),u.parentNode.insertBefore(f,u.nextSibling),t.detailTemplate)?(tt=this.parent.isReact&&"string"!=typeof t.detailTemplate,l=t.element.id+"detailTemplate",tt?(t.getDetailTemplate()(o,t,"detailTemplate",l,null,null,s),this.parent.renderTemplates()):rt(s,t.getDetailTemplate()(o,t,"detailTemplate",l)),Object(r.isBlazor)()&&Object(r.updateBlazorTemplate)(l,"DetailTemplate",t,!1)):((i=new nh(this.getGridModel(t,e,t.printMode))).query&&(i.query=i.query.clone()),i.parentDetails={parentID:t.element.id,parentPrimaryKeys:t.getPrimaryKeyFieldNames(),parentKeyField:t.childGrid.queryString,parentKeyFieldValue:o[t.childGrid.queryString],parentRowData:o},t.isPrinting&&(i.isPrinting=!0,i.on(y,this.promiseResolve(i),this),i.on(bt,this.promiseResolve(i),this)),e.childGrid=i,v=i.getInjectedModules(),p=t.getInjectedModules(),v&&v.length===p.length||i.setInjectedModules(p),w=this.parent.createElement("div",{id:"child"+uk(u,"e-grid").length+"_grid"+u.rowIndex+ei("")}),s.appendChild(w),i.appendTo(w));f.appendChild(s);u.nextSibling?u.parentNode.insertBefore(f,u.nextSibling):u.parentNode.appendChild(f);t.getRows().splice(u.rowIndex+1,0,f);t.getRowsObject().splice(e.index+1,0,g);t.trigger(sr,{detailElement:s,data:o,childGrid:i});t.notify(sr,{rows:t.getRowsObject()})}(Object(r.classList)(n,["e-detailrowexpand"],["e-detailrowcollapse"]),Object(r.classList)(n.firstElementChild,["e-dtdiagonaldown","e-icon-gdownarrow"],["e-dtdiagonalright","e-icon-grightarrow"]),e.isExpand=!0,n.classList.contains("e-lastrowcell")&&this.parent.getContent().clientHeight>a.scrollHeight)&&(Object(r.removeClass)(n.parentElement.querySelectorAll("td"),"e-lastrowcell"),it=a.querySelector("tbody").querySelectorAll(".e-detailrow").length-1,Object(r.addClass)(a.querySelector("tbody").querySelectorAll(".e-detailrow")[it].childNodes,["e-lastrowcell"]),this.lastrowcell=!0);this.aria.setExpand(n,!0)}else this.isDetailRow(c)&&(c.style.display="none",t.notify(wl,{data:e.data,childGrid:t.childGrid,detailElement:n,isExpanded:b})),Object(r.classList)(n,["e-detailrowcollapse"],["e-detailrowexpand"]),Object(r.classList)(n.firstElementChild,["e-dtdiagonalright","e-icon-grightarrow"],["e-dtdiagonaldown","e-icon-gdownarrow"]),parseInt(u.getAttribute("aria-rowindex"),10)===ut&&this.lastrowcell&&(Object(r.addClass)(n.parentElement.querySelectorAll("td"),"e-lastrowcell"),this.lastrowcell=!1),e.isExpand=!1,this.aria.setExpand(n,!1)}},n.prototype.getGridModel=function(n,t,i){var r;return n.isPrinting&&t.isExpand&&n.expandedRows&&n.expandedRows[t.index]&&n.expandedRows[t.index].gridModel?(n.expandedRows[t.index].gridModel.hierarchyPrintMode=n.childGrid.hierarchyPrintMode,r=n.expandedRows[t.index].gridModel):n.isPrinting&&n.childGrid.allowPaging?(n.childGrid.allowPaging="CurrentPage"===i,r=n.childGrid):r=n.childGrid,r},n.prototype.promiseResolve=function(n){var t=this;return function(){n.off(y,t.promiseResolve);n.off(bt,t.promiseResolve);n.notify(rs,{})}},n.prototype.isDetailRow=function(n){return n&&n.classList.contains("e-detailrow")},n.prototype.destroy=function(){var n=this.parent.element;!this.parent.isDestroyed&&n&&(n.querySelector(".e-gridheader")||n.querySelector(".e-gridcontent"))&&(this.parent.off(it,this.clickHandler),this.parent.off(ri,this.destroy),this.parent.off(w,this.keyPressHandler),this.parent.off(us,this.expand),this.parent.off(ui,this.refreshColSpan))},n.prototype.getTDfromIndex=function(n,t){var i=this.parent.getDataRows()[n];return i&&i.querySelector(t)?i.querySelector(t):null},n.prototype.expand=function(n){isNaN(n)||(n=this.getTDfromIndex(n,".e-detailrowcollapse"));n&&n.classList.contains("e-detailrowcollapse")&&this.toogleExpandcollapse(n)},n.prototype.collapse=function(n){isNaN(n)||(n=this.getTDfromIndex(n,".e-detailrowexpand"));n&&n.classList.contains("e-detailrowexpand")&&this.toogleExpandcollapse(n)},n.prototype.expandAll=function(){this.expandCollapse(!0);this.parent.trigger(c,{requestType:"expandAllComplete",type:c,moduleObj:this})},n.prototype.collapseAll=function(){this.expandCollapse(!1);this.parent.trigger(c,{requestType:"collapseAllComplete",type:c,moduleObj:this})},n.prototype.expandCollapse=function(n){for(var t,r=this.parent.getDataRows(),i=0,u=r.length;i<u;i++)t=r[i].querySelector(".e-detailrowcollapse, .e-detailrowexpand"),n?this.expand(t):this.collapse(t)},n.prototype.keyPressHandler=function(n){var i=this.parent,t,r,u;switch(n.action){case"ctrlDownArrow":this.expandAll();break;case"ctrlUpArrow":this.collapseAll();break;case"altUpArrow":case"altDownArrow":t=i.allowSelection?i.getSelectedRowIndexes():[];t.length&&(r=i.getDataRows()[t[t.length-1]].querySelector(".e-detailrowcollapse, .e-detailrowexpand"),"altDownArrow"===n.action?this.expand(r):this.collapse(r));break;case"enter":if(this.parent.isEdit)return;if(u=this.focus.getFocusedElement(),!n.target.classList.contains("e-detailrowcollapse")&&!n.target.classList.contains("e-detailrowexpand"))break;this.toogleExpandcollapse(u)}},n.prototype.refreshColSpan=function(){for(var t=this.parent.contentModule.getTable().querySelectorAll("tr.e-detailrow"),i=this.parent.getVisibleColumns().length,n=0;n<t.length;n++)t[n].querySelector(".e-detailcell").setAttribute("colspan",i+"")},n.prototype.getModuleName=function(){return"detailRow"},n}(),cit=function(){function n(n,t){this.predefinedItems={};this.items=["Add","Edit","Update","Delete","Cancel","Print","Search","ColumnChooser","PdfExport","ExcelExport","CsvExport","WordExport"];this.parent=n;this.gridID=n.element.id;this.serviceLocator=t;this.addEventListener()}return n.prototype.render=function(){var n,i;for(this.l10n=this.serviceLocator.getService("localization"),n=0,i=["Add","Edit","Update","Delete","Cancel","Print","PdfExport","ExcelExport","WordExport","CsvExport"];n<i.length;n++){var r=i[n],t=r.toLowerCase(),u=t[0].toUpperCase()+t.slice(1);this.predefinedItems[r]={id:this.gridID+"_"+t,prefixIcon:"e-"+t,text:this.l10n.getConstant(u),tooltipText:this.l10n.getConstant(u)}}this.predefinedItems.Search={id:this.gridID+"_search",tooltipText:this.l10n.getConstant("Search"),align:"Right",cssClass:"e-search-wrapper",type:"Input"};this.predefinedItems.ColumnChooser={id:this.gridID+"_columnchooser",cssClass:"e-cc e-ccdiv e-cc-toolbar",suffixIcon:"e-columnchooser-btn",text:this.l10n.getConstant("Columnchooser"),tooltipText:this.l10n.getConstant("Columnchooser"),align:"Right"};this.createToolbar()},n.prototype.getToolbar=function(){return this.toolbar.element},n.prototype.destroy=function(){this.toolbar&&!this.toolbar.isDestroyed&&(this.toolbar.element?(this.toolbar.off("render-react-toolbar-template",this.addReactToolbarPortals),this.toolbar.destroy()):(this.parent.destroyTemplate(["toolbarTemplate"]),this.parent.isReact&&this.parent.renderTemplates()),this.unWireEvent(),this.removeEventListener(),Object(r.remove)(this.element))},n.prototype.bindSearchEvents=function(){this.searchElement=Object(r.select)("#"+this.gridID+"_searchbar",this.element);this.wireEvent();this.refreshToolbarItems();this.parent.searchSettings&&this.updateSearchBox()},n.prototype.toolbarCreated=function(){this.element.querySelector(".e-search-wrapper")&&(this.element.querySelector(".e-search-wrapper").innerHTML='<div class="e-input-group e-search" role="search">        <input id="'+this.gridID+'_searchbar" class="e-input" name="input" type="search"         placeholder= "'+this.l10n.getConstant("Search")+'"/>        <span id="'+this.gridID+'_searchbutton" class="e-input-group-icon e-search-icon e-icons"         tabindex="-1" title="'+this.l10n.getConstant("Search")+'" aria-label= "search"><\/span>         <\/div>');this.bindSearchEvents()},n.prototype.createToolbar=function(){var u=this.getItems(),n,t,i;if(this.toolbar=new yf.Toolbar({items:u,clicked:this.toolbarClickHandler.bind(this),enablePersistence:this.parent.enablePersistence,enableRtl:this.parent.enableRtl,created:this.toolbarCreated.bind(this)}),this.toolbar.isReact=this.parent.isReact,this.toolbar.on("render-react-toolbar-template",this.addReactToolbarPortals,this),this.toolbar.isStringTemplate=!0,n="viewContainerRef",this.parent[n]&&(this.toolbar.registeredTemplate={},this.toolbar[n]=this.parent[n]),this.element=this.parent.createElement("div",{id:this.gridID+"_toolbarItems"}),this.parent.toolbarTemplate)if(Object(r.isBlazor)()||"string"!=typeof this.parent.toolbarTemplate)if(Object(r.isBlazor)()){var f=this.parent.element.id+"toolbarTemplate",e=rt(this.element,et(this.parent.toolbarTemplate)({},this.parent,"toolbarTemplate",f)),o=this.getItem(e);this.toolbar.items.push(o);this.toolbar.appendTo(this.element);Object(r.updateBlazorTemplate)(this.parent.element.id+"toolbarTemplate","ToolbarTemplate",this.parent)}else t=this.parent.isReact&&"string"!=typeof this.parent.toolbarTemplate,i=this.parent.element.id+"toolbarTemplate",t?(et(this.parent.toolbarTemplate)({},this.parent,"toolbarTemplate",i,null,null,this.element),this.parent.renderTemplates()):rt(this.element,et(this.parent.toolbarTemplate)({},this.parent,"toolbarTemplate"));else this.toolbar.appendTo(this.parent.toolbarTemplate),this.element=this.toolbar.element;else this.toolbar.appendTo(this.element);this.parent.element.insertBefore(this.element,this.parent.getHeaderContent())},n.prototype.addReactToolbarPortals=function(n){this.parent.isReact&&n&&(this.parent.portals=this.parent.portals.concat(n),this.parent.renderTemplates())},n.prototype.refreshToolbarItems=function(){var r=this.parent,t=[],n=[],i=r.editSettings,u=r.currentViewData&&r.currentViewData.length;i.allowAdding?t.push(this.gridID+"_add"):n.push(this.gridID+"_add");i.allowEditing&&u?t.push(this.gridID+"_edit"):n.push(this.gridID+"_edit");i.allowDeleting&&u?t.push(this.gridID+"_delete"):n.push(this.gridID+"_delete");"Batch"===r.editSettings.mode?r.element.querySelectorAll(".e-updatedtd").length&&(i.allowAdding||i.allowEditing)?(t.push(this.gridID+"_update"),t.push(this.gridID+"_cancel")):(n.push(this.gridID+"_update"),n.push(this.gridID+"_cancel")):r.isEdit&&(i.allowAdding||i.allowEditing)?(t=[this.gridID+"_update",this.gridID+"_cancel"],n=[this.gridID+"_add",this.gridID+"_edit",this.gridID+"_delete"]):(n.push(this.gridID+"_update"),n.push(this.gridID+"_cancel"));this.enableItems(t,!0);this.enableItems(n,!1)},n.prototype.getItems=function(){var t=[],u=this.parent.toolbar||[],i,r,n;if("string"==typeof this.parent.toolbar)return[];for(i=0,r=u;i<r.length;i++){n=r[i];switch(typeof n){case"number":t.push(this.getItemObject(this.items[n]));break;case"string":t.push(this.getItemObject(n));break;default:t.push(this.getItem(n))}}return t},n.prototype.getItem=function(n){var t=this.predefinedItems[n.text];return t?Object(r.extend)(t,t,n):n},n.prototype.getItemObject=function(n){return this.predefinedItems[n]||{text:n,id:this.gridID+"_"+n}},n.prototype.enableItems=function(n,t){for(var e,f,i=0,u=n;i<u.length;i++)e=u[i],f=Object(r.select)("#"+e,this.element),f&&this.toolbar.enableItems(f.parentElement,t)},n.prototype.toolbarClickHandler=function(n){var u=this,t=this.parent,i=this.gridID,f,e;Object(r.extend)(n,{cancel:!1});f=!Object(r.isBlazor)()||this.parent.isJsComponent?n:{item:n.item,cancel:n.cancel,name:n.name};e=n.originalEvent;t.trigger(ey,f,function(n){if(n.originalEvent=n.originalEvent?n.originalEvent:e,!n.cancel)switch(!Object(r.isNullOrUndefined)(n.item)&&n.item.id){case i+"_print":t.print();break;case i+"_edit":t.startEdit();break;case i+"_update":t.endEdit();break;case i+"_cancel":t.closeEdit();break;case i+"_add":t.addRecord();break;case i+"_delete":t.deleteRecord();break;case i+"_search":n.originalEvent.target.id===i+"_searchbutton"&&u.search();break;case i+"_columnchooser":var f=u.parent.element.querySelector(".e-ccdiv"),o=f.getBoundingClientRect().top,s=f.getBoundingClientRect().left,h=n.originalEvent.target;o=f.getBoundingClientRect().top+f.offsetTop;t.createColumnchooser(s,o,h);break;case"copy":Object(r.isBlazor)()&&t.copy();break;case"copyheader":case"copyHeader":Object(r.isBlazor)()&&t.copy(!0)}})},n.prototype.modelChanged=function(n){"edit"===n.module&&this.refreshToolbarItems()},n.prototype.onPropertyChanged=function(n){n.module===this.getModuleName()&&this.parent.toolbar&&(this.element&&Object(r.remove)(this.element),this.render())},n.prototype.keyUpHandler=function(n){13===n.keyCode&&this.search()},n.prototype.search=function(){this.parent.search(this.searchElement.value)},n.prototype.updateSearchBox=function(){this.searchElement&&(this.searchElement.value=this.parent.searchSettings.key)},n.prototype.wireEvent=function(){this.searchElement&&(this.searchBoxObj=new rb(this.searchElement),r.EventHandler.add(this.searchElement,"keyup",this.keyUpHandler,this),this.searchBoxObj.wireEvent())},n.prototype.unWireEvent=function(){this.searchElement&&(r.EventHandler.remove(this.searchElement,"keyup",this.keyUpHandler),this.searchBoxObj.unWireEvent())},n.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(tt,this.render,this),this.parent.on(v,this.onPropertyChanged,this),this.parent.on(d,this.updateSearchBox.bind(this)),this.parent.on(p,this.refreshToolbarItems,this),this.parent.on(lt,this.refreshToolbarItems,this),this.parent.on(d,this.modelChanged,this),this.parent.on(ct,this.refreshToolbarItems,this))},n.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(tt,this.render),this.parent.off(v,this.onPropertyChanged),this.parent.off(d,this.updateSearchBox),this.parent.off(p,this.refreshToolbarItems),this.parent.off(lt,this.refreshToolbarItems),this.parent.off(d,this.modelChanged),this.parent.off(ct,this.refreshToolbarItems))},n.prototype.getModuleName=function(){return"toolbar"},n}(),lit=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),ait=function(n){function t(t,i){var r=n.call(this,t,i)||this;return r.aggregates={},r.parent=t,r.locator=i,r.modelGenerator=new pe(r.parent),r.addEventListener(),r}return lit(t,n),t.prototype.renderPanel=function(){var n=this.parent.createElement("div",{className:"e-gridfooter"}),t=this.parent.createElement("div",{className:"e-summarycontent"}),f=t,u,i;this.parent.getFrozenColumns()&&(u=this.parent.createElement("div",{className:"e-frozenfootercontent"}),i=this.parent.createElement("div",{className:"e-movablefootercontent"}),t.appendChild(u),t.appendChild(i),this.frozenContent=u,this.movableContent=i,f=i);r.Browser.isDevice&&(f.style.overflowX="scroll");n.appendChild(t);this.setPanel(n);null!=this.parent.getPager()?this.parent.element.insertBefore(n,this.parent.getPager()):this.parent.element.appendChild(n)},t.prototype.renderTable=function(){var n,u,t,i;this.getPanel();n=this.createContentTable("_footer_table").querySelector(".e-table");u=this.parent.createElement("tfoot");(n.appendChild(u),this.parent.getFrozenColumns())&&(t=n.cloneNode(!0),this.frozenContent.appendChild(t),this.freezeTable=t,this.movableContent.appendChild(n),Object(r.remove)(n.querySelector("colgroup")),i=this.parent.getHeaderContent().querySelector(".e-movableheader").querySelector("colgroup").cloneNode(!0),n.insertBefore(i,n.querySelector("tbody")),this.setColGroup(i));this.setTable(n)},t.prototype.renderSummaryContent=function(n,t,i,u){var o=this.parent.dataSource instanceof Array?this.parent.dataSource:this.parent.currentViewData,a=this.modelGenerator.getData(),v=Object(r.isNullOrUndefined)(i)?this.modelGenerator.getColumns():this.modelGenerator.getColumns(i,u),y=Object(r.isNullOrUndefined)(i)?this.modelGenerator.generateRows(o,n||this.aggregates):this.modelGenerator.generateRows(o,n||this.aggregates,i,u),s=document.createDocumentFragment(),h=new dt(this.locator,null,this.parent),f,c,e,l;for(h.element=this.parent.createElement("TR",{className:"e-summaryrow"}),f=0,c=a.length;f<c;f++)e=y[f],e&&(l=h.render(e,v),s.appendChild(l));t.tFoot.appendChild(s);this.aggregates=Object(r.isNullOrUndefined)(n)?this.aggregates:n},t.prototype.refresh=function(n){var u,f,o;if(this.parent.getFrozenColumns()&&(Object(r.remove)(this.getPanel()),this.renderPanel(),this.renderTable(),this.freezeTable.tFoot.innerHTML="",this.renderSummaryContent(n,this.freezeTable,0,this.parent.getFrozenColumns())),this.getTable().tFoot.innerHTML="",this.renderSummaryContent(n,this.getTable(),this.parent.getFrozenColumns()),this.parent.getFrozenColumns()){for(var i=[].slice.call(this.parent.element.querySelector(".e-frozenfootercontent").querySelectorAll(".e-summaryrow")),e=[].slice.call(this.parent.element.querySelector(".e-movablefootercontent").querySelectorAll(".e-summaryrow")),t=0;t<i.length;t++)u=i[t].getBoundingClientRect().height,f=e[t].getBoundingClientRect().height,u<f?(i[t].classList.remove("e-hide"),i[t].style.height=f+"px"):u>f&&(e[t].classList.remove("e-hide"),e[t].style.height=u+"px");o=this.frozenContent;o.offsetHeight||(o.style.height=this.getTable().offsetHeight+"px");this.parent.allowResizing&&this.updateFooterTableWidth(this.getTable())}this.onScroll()},t.prototype.refreshCol=function(){var n,t=n=this.parent.element.querySelector(".e-gridheader").querySelector("colgroup").cloneNode(!0);this.parent.getFrozenColumns()&&(this.parent.enableColumnVirtualization&&this.parent.contentModule.isXaxis()?n=this.parent.getMovableVirtualHeader().querySelector("colgroup").cloneNode(!0):(n=no(t,this.parent.getFrozenColumns(),this.parent),this.freezeTable.replaceChild(t,this.freezeTable.querySelector("colGroup"))));this.getTable().replaceChild(n,this.getColGroup());this.setColGroup(n)},t.prototype.onWidthChange=function(n){this.getColFromIndex(n.index).style.width=Object(r.formatUnit)(n.width);this.parent.allowResizing&&"resize"===n.module&&this.updateFooterTableWidth(this.getTable())},t.prototype.onScroll=function(n){void 0===n&&(n={left:this.parent.getFrozenColumns()?this.parent.getContent().querySelector(".e-movablecontent").scrollLeft:this.parent.getContent().firstChild.scrollLeft});this.getTable().parentElement.scrollLeft=n.left},t.prototype.getColFromIndex=function(n){var t=this.parent.getFrozenColumns();return(t=t&&this.parent.isRowDragable()?t+1:t)&&t>n?this.freezeTable.querySelector("colGroup").children[n]:this.getColGroup().children[n-t]},t.prototype.columnVisibilityChanged=function(){this.refresh()},t.prototype.addEventListener=function(){this.parent.on(gf,this.refreshCol,this);this.parent.on(nu,this.onWidthChange,this);this.parent.on(lo,this.onScroll,this);this.parent.on(ui,this.columnVisibilityChanged,this);this.parent.on(ai,this.refreshFooterRenderer,this)},t.prototype.removeEventListener=function(){this.parent.off(gf,this.refreshCol);this.parent.off(nu,this.onWidthChange);this.parent.off(lo,this.onScroll);this.parent.off(ui,this.columnVisibilityChanged);this.parent.off(ai,this.refreshFooterRenderer)},t.prototype.updateFooterTableWidth=function(n){var t=this.parent.getHeaderTable();t&&n&&(n.style.width=t.style.width)},t.prototype.refreshFooterRenderer=function(n){var t=this.onAggregates(n);this.refresh(t)},t.prototype.getIndexByKey=function(n,t){for(var r=this.parent.getPrimaryKeyFieldNames()[0],i=0;i<t.length;i++)if(t[i][r]===n[r])return i;return-1},t.prototype.onAggregates=function(n){var t,h,v,c,f,o,l;n=n instanceof Array?n:[];var a=this.parent.getPrimaryKeyFieldNames()[0],r=[],s=!1,i={},u=this.parent.dataSource instanceof Array?this.parent.dataSource:this.parent.dataSource.dataSource.json.length?this.parent.dataSource.dataSource.json:this.parent.getCurrentViewRecords();if(this.parent.editModule&&(i=this.parent.editModule.getBatchChanges()),Object.keys(i).length){for(t=0;t<u.length;t++)s=!1,i.changedRecords.length&&this.getIndexByKey(u[t],i.changedRecords)>-1&&(s=!0,r.push(i.changedRecords[this.getIndexByKey(u[t],i.changedRecords)])),i.deletedRecords.length&&this.getIndexByKey(u[t],i.deletedRecords)>-1?s=!0:s||r.push(u[t]);if(i.addedRecords.length)for(t=0;t<i.addedRecords.length;t++)r.push(i.addedRecords[t])}else r=n.length?ih(u).map(function(t){var i,r=e.DataUtil.getObject(a,t);return n.some(function(n){return i=n,r===e.DataUtil.getObject(a,n)})?i:t}):u;for(h=n,h.type&&"cancel"===h.type&&(r=u),c={},f=this.parent.aggregates,t=0;t<f.length;t++)for(o=0;o<f[t].columns.length;o++)l=f[t].columns[o].type.toString(),v=wa(l,r,f[t].columns[o],this.parent),c[f[t].columns[o].field+" - "+l.toLowerCase()]=v;return{result:r,count:r.length,aggregates:c}},t}(of),vit=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),yit=function(n){function t(){var t=null!==n&&n.apply(this,arguments)||this;return t.element=t.parent.createElement("TD",{className:"e-summarycell",attrs:{role:"gridcell",tabindex:"-1"}}),t}return vit(t,n),t.prototype.getValue=function(n,t,i){var u;return u=Object(r.isNullOrUndefined)(i.type)?i.columnName:i.field+" - "+("string"==typeof i.type?i.type.toLowerCase():""),t[i.columnName]?t[i.columnName][u]:""},t.prototype.evaluate=function(n,t,i){var u=t.column,s;if(this.parent.on(il,this.refreshWithAggregate(n,t),this),!(u.footerTemplate||u.groupFooterTemplate||u.groupCaptionTemplate))return!0;var e=u.getTemplate(t.cellType),o="",f=this.parent.getColumnByField(i[u.columnName].field);return!Object(r.isNullOrUndefined)(f)&&(i[u.columnName].headerText=f.headerText,f.isForeignColumn())&&(s=f.columnData.filter(function(n){return n[f.foreignKeyField]===i[u.columnName].key})[0],s&&(i[u.columnName].foreignKey=s[f.foreignKeyValue])),Object(r.isBlazor)()&&(o=this.parent.element.id+u.guid+e.property),this.parent.isReact&&(u.footerTemplate?"string"!=typeof u.footerTemplate:u.groupFooterTemplate?"string"!=typeof u.groupFooterTemplate:!!u.groupCaptionTemplate&&"string"!=typeof u.groupCaptionTemplate)?(e.fn(i[u.columnName],this.parent,e.property,o,null,null,n),this.parent.renderTemplates()):rt(n,e.fn(i[u.columnName],this.parent,e.property,o)),!1},t.prototype.refreshWithAggregate=function(n,t){var i=this,u=t;return function(t){var e=u,f=e.column.columnName?e.column.columnName:null,o=Object(r.isNullOrUndefined)(f)?null:t.cells.filter(function(n){return n.column.columnName===f})[0];n.parentElement&&n.parentElement.getAttribute("data-uid")===t.dataUid&&f&&f===o.column.columnName&&i.refreshTD(n,o,t.data)}},t}(ht),pit=function(){function n(n,t){this.parent=n;this.locator=t;this.addEventListener()}return n.prototype.getModuleName=function(){return"aggregate"},n.prototype.initiateRender=function(){for(var t,i,u=this,e=this.locator.getService("cellRendererFactory"),o=new yit(this.parent,this.locator),f=[h.Summary,h.CaptionSummary,h.GroupSummary],n=0;n<f.length;n++)e.addCellRenderer(f[n],o);this.footerRenderer=new ait(this.parent,this.locator);this.footerRenderer.renderPanel();this.footerRenderer.renderTable();t=this.footerRenderer.getPanel();this.parent.element.scrollHeight>=this.parent.getHeight(this.parent.height)&&t&&Object(r.addClass)([t],["e-footerpadding"]);this.locator.register("footerRenderer",this.footerRenderer);i=function(){u.prepareSummaryInfo();u.parent.off(at,i)};this.parent.on(at,i,this);this.parent.on(at,this.footerRenderer.refresh,this.footerRenderer)},n.prototype.prepareSummaryInfo=function(){var i=this,t,n;if(rd(this.parent.aggregates,function(n){var t,u;(i.parent.getColumnByField(n.field)||{}).type;(Object(r.isNullOrUndefined)(n.customFormat)||n.setPropertiesSilent({format:n.customFormat}),"object"==typeof n.format)?(t=new er,n.setFormatter(t.getFormatFunction(Object(r.extend)({},n.format)))):"string"==typeof n.format&&(u=i.locator.getService("valueFormatter"),n.setFormatter(u.getFormatFunction({format:n.format})));n.setPropertiesSilent({columnName:n.columnName||n.field})}),Object(r.isBlazor)()&&this.parent.isServerRendered)for(t=Object.keys(this.parent.bulkChanges),n=0;n<t.length;n++)t[n].startsWith("aggregates")&&delete this.parent.bulkChanges[t[n]]},n.prototype.onPropertyChanged=function(n){if(n.module===this.getModuleName()){Object(r.isNullOrUndefined)(this.footerRenderer)&&this.initiateRender();this.prepareSummaryInfo();this.footerRenderer.refresh();var t=new we(this.parent);0===new ef(this.parent).getData().length&&t.isEmpty()||this.parent.notify(p,{})}},n.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(tt,this.initiateRender,this),this.parent.on(v,this.onPropertyChanged,this),this.parent.on(rl,this.refresh,this))},n.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.footerRenderer.removeEventListener(),this.parent.off(tt,this.initiateRender),this.parent.off(at,this.footerRenderer.refresh),this.parent.off(v,this.onPropertyChanged),this.parent.off(rl,this.refresh))},n.prototype.destroy=function(){this.removeEventListener();Object(r.remove)(this.parent.element.querySelector(".e-gridfooter"))},n.prototype.refresh=function(n){var t=n instanceof Array?n:[n];this.parent.notify(ai,t);this.parent.groupSettings.columns.length>0&&this.parent.notify(pi,t)},n}();var ud=function(){function n(n,t){var i=this;this.fromWheel=!1;this.touchMove=!1;this.options={};this.sentinelInfo={up:{check:function(n,t){var r=n.top-i.containerRect.top;return t.entered=r>=0,r+i.options.pageHeight/2>=0},axis:"Y"},down:{check:function(n,t){i.options.container.clientHeight;var r=n.bottom;return t.entered=n.bottom<=i.containerRect.bottom,r-i.options.pageHeight/2<=i.options.pageHeight/2},axis:"Y"},right:{check:function(n,t){var r=n.right;return t.entered=r<i.containerRect.right,r-i.containerRect.width<=i.containerRect.right},axis:"X"},left:{check:function(n,t){var r=n.left;return t.entered=r>0,r+i.containerRect.width>=i.containerRect.left},axis:"X"}};this.element=n;this.options=t}return n.prototype.observe=function(n,t){var i=this;this.containerRect=this.options.container.getBoundingClientRect();r.EventHandler.add(this.options.container,"wheel",function(){return i.fromWheel=!0},this);r.EventHandler.add(this.options.container,"scroll",this.virtualScrollHandler(n,t),this)},n.prototype.check=function(n){var t=this.sentinelInfo[n];return t.check(this.element.getBoundingClientRect(),t)},n.prototype.virtualScrollHandler=function(n,t){var i=this,e="chrome"===r.Browser.info.name?200:100,f=0,u=0,o=Object(r.debounce)(n,e),s=Object(r.debounce)(n,50);return function(n){var c=n.target.scrollTop,h=n.target.scrollLeft,r=f<c?"down":"up",e,l,a;r=u===h?r:u<h?"right":"left";f=c;u=h;e=i.sentinelInfo[r];-1!==i.options.axes.indexOf(e.axis)&&(l=i.check(r),(e.entered&&t(i.element,e,r,{top:c,left:h},i.fromWheel,l),l)&&(a=o,"X"===e.axis&&(a=s),a({direction:r,sentinel:e,offset:{top:c,left:h},focusElement:document.activeElement})),i.fromWheel=!1)}},n.prototype.setPageHeight=function(n){this.options.pageHeight=n},n}(),hv=function(){function n(n){this.cOffsets={};this.cache={};this.rowCache={};this.data={};this.groups={};this.parent=n;this.model=this.parent.pageSettings;this.rowModelGenerator=this.parent.allowGrouping?new be(this.parent):new vi(this.parent)}return n.prototype.generateRows=function(n,t){var u=t.virtualInfo=t.virtualInfo||this.getData(),y=u.sentinelInfo&&"X"===u.sentinelInfo.axis,b=y||!u.loadNext||u.loadSelf?u.page:u.nextInfo.page,s=[],e=(this.model.pageSize,this.getBlockIndexes(b)),p=[],l,v,w,a,c,i,f,o,h;if(this.checkAndResetCache(t.requestType),nt(this.parent)&&this.parent.vcRows.length)return this.parent.vcRows;if(this.parent.enableColumnVirtualization)for(i=0;i<u.blockIndexes.length;i++)this.isBlockAvailable(u.blockIndexes[i])&&(this.cache[u.blockIndexes[i]]=this.rowModelGenerator.refreshRows(this.cache[u.blockIndexes[i]]));if(Object(r.isBlazor)()&&this.parent.isServerRendered){if(t.virtualStartIndex||0!==Object.keys(this.rowCache).length){if(t.virtualStartIndex){for(l=t.startIndex,v=[],i=0;i<Object.keys(this.rowCache).length;i++)v.push(Number(Object.keys(this.rowCache)[i]));for(i=0;i<n.length;i++)a=[],w=v.indexOf(l),a.push(n[i]),-1===w&&(this.rowCache[l]=this.rowModelGenerator.generateRows(a,{startIndex:l})[0]),l++}}else{for(i=0;i<n.length;i++)(a=[]).push(n[i]),this.rowCache[i]=this.rowModelGenerator.generateRows(a,{startIndex:i})[0];for(c=0,i=0;i<this.parent.pageSettings.pageSize;i++)s[c]=this.rowCache[i],c++}if(!Object(r.isNullOrUndefined)(t.virtualStartIndex))for(c=0,i=t.startIndex;i<t.endIndex;i++)s[c]=this.rowCache[i],c++}else{for(f=u.blockIndexes,i=0;i<f.length;i++)this.isBlockAvailable(f[i])||(o=this.rowModelGenerator.generateRows(n,{virtualInfo:u,startIndex:this.getStartIndex(f[i],n)}),nt(this.parent)&&!this.parent.vcRows.length&&(this.parent.vRows=o,this.parent.vcRows=o),h=void 0,nt(this.parent)?(h=this.model.pageSize/2,this.isBlockAvailable(e[0])||(this.cache[e[0]]=o.slice(0,h)),this.isBlockAvailable(e[1])||(this.cache[e[1]]=o.slice(h,this.model.pageSize))):(h=~~Math.max(o.length,this.model.pageSize)/2,this.isBlockAvailable(e[0])||(this.cache[e[0]]=o.slice(0,h)),this.isBlockAvailable(e[1])||(this.cache[e[1]]=o.slice(h)))),this.parent.groupSettings.columns.length&&!y&&this.cache[f[i]]&&(this.cache[f[i]]=this.updateGroupRow(this.cache[f[i]],f[i])),s.push.apply(s,this.cache[f[i]]),this.isBlockAvailable(f[i])&&p.push(f[i]);u.blockIndexes=p}return Object(r.isBlazor)()&&(!Object(r.isBlazor)()||this.parent.isServerRendered)||(this.parent.allowGrouping?this.parent.currentViewData.records=s.map(function(n){return n.data}):this.parent.currentViewData=s.map(function(n){return n.data})),s},n.prototype.getBlockIndexes=function(n){return[n+(n-1),2*n]},n.prototype.getPage=function(n){return n%2==0?n/2:(n+1)/2},n.prototype.isBlockAvailable=function(n){return n in this.cache},n.prototype.getData=function(){return{page:this.model.currentPage,blockIndexes:this.getBlockIndexes(this.model.currentPage),direction:"down",columnIndexes:this.parent.getColumnIndexesInView()}},n.prototype.getStartIndex=function(n,t,i){void 0===i&&(i=!0);var u=n%2==0,r=(this.getPage(n)-1)*this.model.pageSize;return i||!u?r:r+~~(this.model.pageSize/2)},n.prototype.getColumnIndexes=function(n){var s=this,u,e;void 0===n&&(n=this.parent.getHeaderContent().querySelector(".e-headercontent"));this.parent.getFrozenColumns()&&(n=n.querySelector(".e-movableheader"));var t=[],i=0|n.scrollLeft,o=Object.keys(this.cOffsets),f=n.getBoundingClientRect().width;return i=Math.min(this.cOffsets[o.length-1]-f,i),u=r.Browser.isDevice?2*f:f/2,e=i+f+(0===i?u:0),o.some(function(n){var f=Number(n),r=s.cOffsets[n];return i-u<=r&&e+u>=r&&t.push(f),e+u<r}),Object(r.isBlazor)()&&this.parent.isServerRendered&&(this.parent.contentModule.startColIndex=t[0],this.parent.contentModule.endColIndex=t[t.length-1]),this.addFrozenIndex(t),t},n.prototype.addFrozenIndex=function(n){if(this.parent.getFrozenColumns()&&this.parent.enableColumnVirtualization&&0===n[0])for(var t=0;t<this.parent.getFrozenColumns();t++)n.push(n[n.length-1]+1)},n.prototype.checkAndResetCache=function(n){var t=["paging","refresh","sorting","filtering","searching","grouping","ungrouping","reorder","save","delete"],i;return this.parent.getFrozenColumns()&&this.parent.frozenRows&&this.parent.enableColumnVirtualization&&"reorder"===n&&t.splice(t.indexOf(n),1),i=t.some(function(t){return n===t}),i&&(this.cache={},this.data={},this.groups={}),i},n.prototype.refreshColOffsets=function(){var f=this,e=0,u,t,n;this.cOffsets={};for(var o=this.parent.groupSettings.columns.length,r=this.parent.columns,s=r.length,h=this.parent.groupSettings.columns,i=0;i<h.length;i++)this.cOffsets[i]=30+(0|this.cOffsets[i-1]);for(t=Array.apply(null,Array(s)).map(function(){return e++}),n=0;n<t.length;n++)t[n]=t[n]+o,this.cOffsets[t[n]]=(0|this.cOffsets[t[n]-1])+((u=r[n]).visible&&(f.parent.groupSettings.showGroupedColumn?u.visible:f.parent.groupSettings.columns.indexOf(u.field)<0)?parseInt(r[n].width,10):0)},n.prototype.updateGroupRow=function(n,t){for(var f=n[0],r=[],u=Object.keys(this.cache),i=0;i<u.length;i++)Number(u[i])<t&&(r=r.concat(this.cache[u[i]]));return f&&f.isDataRow||t%2==0?n:this.iterateGroup(n,r)},n.prototype.iterateGroup=function(n,t){var i=n[0],r=0;return i&&i.isDataRow||n.some(function(n){return t.some(function(t,i){var u=t&&void 0!==t.data.field&&t.data.field===n.data.field&&t.data.key===n.data.key;return u&&(r=i),u})})&&(n.shift(),n=this.iterateGroup(n,t.slice(r))),n},n.prototype.getRows=function(){for(var n=[],u=!(!Object(r.isBlazor)()||!this.parent.isServerRendered),i=u?Object.keys(this.rowCache):Object.keys(this.cache),t=0;t<i.length;t++)n=u?n.concat(this.rowCache[i[t]]):n.concat(this.cache[i[t]]);return n},n}(),fd=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),cv=function(n){function t(t,i){var r=n.call(this,t,i)||this;return r.prevHeight=0,r.startIndex=0,r.preStartIndex=0,r.preventEvent=!1,r.actions=["filtering","searching","grouping","ungrouping"],r.offsets={},r.tmpOffsets={},r.virtualEle=new av,r.offsetKeys=[],r.isFocused=!1,r.isSelection=!1,r.isBottom=!1,r.rndrCount=0,r.empty=void 0,r.isCancel=!1,r.requestTypes=["beginEdit","cancel","delete","add","save"],r.isNormaledit="Normal"===r.parent.editSettings.mode,r.virtualData={},r.emptyRowData={},r.vfColIndex=[],r.locator=i,r.eventListener("on"),r.parent.on(ui,r.setVisible,r),r.vgenerator=r.generator,r}return fd(t,n),t.prototype.renderTable=function(){var t,i,r;this.header=this.locator.getService("rendererFactory").getRenderer(ut.Header);n.prototype.renderTable.call(this);this.virtualEle.table=this.getTable();this.virtualEle.content=this.content=this.getPanel().querySelector(".e-content");t=this.parent.height;this.parent.getFrozenColumns()&&this.parent.height.toString().indexOf("%")<0&&(t=parseInt(this.parent.height,10)-oi());this.virtualEle.renderWrapper(t);this.virtualEle.renderPlaceHolder();this.parent.getFrozenColumns()||(this.virtualEle.wrapper.style.position="absolute");i=this.parent.dataSource instanceof e.DataManager&&!this.parent.dataSource.dataSource.offline;r={container:this.parent.getFrozenColumns()?this.parent.getMovableVirtualContent():this.content,pageHeight:2*this.getBlockHeight(),debounceEvent:i,axes:this.parent.enableColumnVirtualization?["X","Y"]:["Y"]};this.observer=new ud(this.virtualEle.wrapper,r)},t.prototype.renderEmpty=function(n){this.getTable().appendChild(n);this.virtualEle.adjustTable(0,0)},t.prototype.refreshMvTbalTransform=function(){var n=this.parent.getMovableVirtualContent(),r=this.parent.getFrozenVirtualContent(),t=rv(n.firstElementChild),i=rv(r.firstElementChild);n.scrollTop>0&&t.height!==i.height&&(n.firstElementChild.style.transform="translate("+t.width+"px, "+i.height+"px)")},t.prototype.scrollListener=function(n){var e,o,i;if(this.scrollAfterEdit(),this.parent.enablePersistence&&(this.parent.scrollPosition=n.offset),this.preventEvent||this.parent.isDestroyed)this.preventEvent=!1;else{this.isFocused=Object(r.isNullOrUndefined)(document.activeElement)?!1:this.content===Object(r.closest)(document.activeElement,".e-content")||this.content===document.activeElement;this.parent.enableColumnVirtualization&&this.parent.getFrozenColumns()&&"X"===n.sentinel.axis&&this.refreshMvTbalTransform();var u=n.sentinel,f=this.preStartIndex,s=this.parent.getColumnIndexesInView(),t=this.currentInfo=this.getInfoFromView(n.direction,u,n.offset);if(Object(r.isBlazor)()&&this.parent.isServerRendered&&this.parent.enableColumnVirtualization&&JSON.stringify(s)!==JSON.stringify(t.columnIndexes)&&(this.parent.refreshHeader(),e=this.getColumnOffset(this.startColIndex-1),o=this.getColumnOffset(this.endColIndex-1)-e+"",this.parent.notify("refresh-virtual-indices",{requestType:"virtualscroll",startColumnIndex:t.columnIndexes[0],endColumnIndex:t.columnIndexes[t.columnIndexes.length-1],axis:"X",VTablewidth:o,translateX:this.getColumnOffset(t.columnIndexes[0]-1)}),this.parent.notify("setcolumnstyles",{})),nt(this.parent)&&!Object(r.isBlazor)())return"Y"===u.axis&&t.blockIndexes&&this.prevInfo.blockIndexes.toString()===t.blockIndexes.toString()&&"up"===n.direction&&2!==t.blockIndexes[t.blockIndexes.length-1]?void 0:(t.event="refresh-virtual-block",Object(r.isNullOrUndefined)(t.offsets)||(t.offsets.top=this.content.scrollTop),void this.parent.notify(t.event,{requestType:"virtualscroll",virtualInfo:t,focusElement:n.focusElement}));if((!Object(r.isBlazor)()||Object(r.isBlazor)()&&!this.parent.isServerRendered)&&this.prevInfo&&("Y"===u.axis&&this.prevInfo.blockIndexes.toString()===t.blockIndexes.toString()||"X"===u.axis&&this.prevInfo.columnIndexes.toString()===t.columnIndexes.toString()))return r.Browser.isIE&&this.parent.hideSpinner(),this.requestType="virtualscroll"===this.requestType?this.empty:this.requestType,void this.restoreEdit();if((this.parent.setColumnIndexesInView(this.parent.enableColumnVirtualization?t.columnIndexes:[]),!Object(r.isBlazor)()||Object(r.isBlazor)()&&!this.parent.isServerRendered?this.parent.pageSettings.currentPage=t.loadNext&&!t.loadSelf?t.nextInfo.page:t.page:Object(r.isBlazor)()&&this.parent.isServerRendered&&this.preStartIndex!==f&&this.parent.pageSettings.currentPage===t.currentPage&&this.parent.notify("refresh-virtual-indices",{requestType:"virtualscroll",virtualStartIndex:t.startIndex,virtualEndIndex:t.endIndex,axis:"Y",RHeight:this.parent.getRowHeight()}),this.parent.getFrozenColumns()&&this.parent.enableColumnVirtualization)&&(i=Math.ceil(this.getTotalBlocks()/2),this.parent.pageSettings.currentPage===i&&"Y"===n.sentinel.axis&&this.rndrCount++,"Y"===n.sentinel.axis)){if(this.parent.pageSettings.currentPage===i&&this.rndrCount>1)return void(this.rndrCount=0);this.parent.pageSettings.currentPage!==i&&this.parent.pageSettings.currentPage!==i-1&&(this.rndrCount=0)}!Object(r.isBlazor)()||Object(r.isBlazor)()&&!this.parent.isServerRendered?(this.requestType="virtualscroll",this.parent.notify(t.event,{requestType:"virtualscroll",virtualInfo:t,focusElement:n.focusElement})):this.preStartIndex!==f&&this.parent.pageSettings.currentPage!==t.currentPage&&(this.parent.pageSettings.currentPage=t.currentPage,this.parent.notify(t.event,{requestType:"virtualscroll",virtualStartIndex:t.startIndex,virtualEndIndex:t.endIndex,axis:"Y",RHeight:this.parent.getRowHeight()}))}},t.prototype.block=function(n){return this.vgenerator.isBlockAvailable(n)},t.prototype.getInfoFromView=function(n,t,i){var w=!1,y=[],u={direction:n,sentinelInfo:t,offsets:i,startIndex:this.preStartIndex,endIndex:this.preEndIndex},d=this.parent.height.toString().indexOf("%")<0?this.content.getBoundingClientRect().height:this.parent.element.getBoundingClientRect().height,o,b,s,e,f,k;if(u.page=this.getPageFromTop(i.top,u),u.blockIndexes=y=this.vgenerator.getBlockIndexes(u.page),u.loadSelf=!this.vgenerator.isBlockAvailable(y[u.block]),o=this.ensureBlocks(u),"upArrow"===this.activeKey&&u.blockIndexes.toString()!==o.toString()&&(b=o[o.length-1],-1===u.blockIndexes.indexOf(b)&&(w=!0)),(u.blockIndexes=o,u.loadNext=!o.filter(function(n){return-1===y.indexOf(n)}).every(this.block.bind(this)),u.event=u.loadNext||u.loadSelf?p:ku,u.nextInfo=u.loadNext?{page:Math.max(1,u.page+("down"===n?1:-1))}:{},w&&(u.blockIndexes=[u.blockIndexes[0]-1,u.blockIndexes[0],u.blockIndexes[0]+1]),"downArrow"===this.activeKey)&&(s=Math.ceil(this.rowIndex/this.getBlockSize()),1!==s&&(u.blockIndexes[1]!==s||u.blockIndexes.length<3)&&(u.blockIndexes=[s-1,s,s+1])),u.columnIndexes="X"===t.axis?this.vgenerator.getColumnIndexes():this.parent.getColumnIndexesInView(),this.parent.enableColumnVirtualization&&"X"===t.axis&&(u.event=ku),Object(r.isBlazor)()&&this.parent.isServerRendered){var h=this.parent.getRowHeight(),c=i.top/h,a=d/h,v=c+a,l=this.parent.pageSettings.pageSize/4;"down"===u.direction?(e=Math.round(v)-Math.round(l),(Object(r.isNullOrUndefined)(u.startIndex)||v>u.startIndex+Math.round(this.parent.pageSettings.pageSize/2+l)&&u.endIndex!==this.count)&&(u.startIndex=e>=0?Math.round(e):0,u.startIndex=u.startIndex>c?Math.floor(c):u.startIndex,f=u.startIndex+this.parent.pageSettings.pageSize,u.startIndex=f<v?Math.ceil(v)-this.parent.pageSettings.pageSize:u.startIndex,u.endIndex=f<this.count?f:this.count,u.startIndex=f>=this.count?u.endIndex-this.parent.pageSettings.pageSize:u.startIndex,u.currentPage=Math.ceil(u.endIndex/this.parent.pageSettings.pageSize),this.setKeyboardNavIndex())):"up"===u.direction&&u.startIndex&&u.endIndex&&c<Math.round((u.startIndex*h+l*h)/h)&&(k=l>a?l:a+a/4,f=Math.round(c+k),u.endIndex=f<this.count?f:this.count,e=u.endIndex-this.parent.pageSettings.pageSize,u.startIndex=e>0?e:0,u.endIndex=e<0?this.parent.pageSettings.pageSize:u.endIndex,u.currentPage=Math.ceil(u.startIndex/this.parent.pageSettings.pageSize),this.setKeyboardNavIndex());this.preStartIndex=this.startIndex=u.startIndex;this.preEndIndex=u.endIndex;u.event=u.currentPage!==this.parent.pageSettings.currentPage?p:ku}return u},t.prototype.setKeyboardNavIndex=function(){this.blazorDataLoad=!0;"downArrow"!==this.activeKey&&"upArrow"!==this.activeKey||(this.blzRowIndex="downArrow"===this.activeKey?this.rowIndex+1:this.rowIndex-1,document.activeElement.blur())},t.prototype.ensureBlocks=function(n){var r,u=this,i=n.blockIndexes[n.block],e=i,f=Math.max,t="down"===n.direction?[f(i,1),++i,++i]:[f(i-1,1),i,i+1];return this.parent.enableColumnVirtualization&&this.parent.getFrozenColumns()&&("X"===n.sentinelInfo.axis||"Y"===n.sentinelInfo.axis&&n.page===this.prevInfo.page)&&(t=this.prevInfo.blockIndexes),t=t.filter(function(n,i){return t.indexOf(n)===i}),this.prevInfo.blockIndexes.toString()===t.toString()||((n.loadSelf||"down"===n.direction&&this.isEndBlock(e))&&(t=this.vgenerator.getBlockIndexes(n.page)),t.some(function(n,t){var i=n===(nt(u.parent)?u.getGroupedTotalBlocks():u.getTotalBlocks());return i&&(r=t),i}),void 0!==r&&(t=t.slice(0,r+1),0===n.block&&1===t.length&&this.vgenerator.isBlockAvailable(t[0]-1)&&(t=[t[0]-1,t[0]]))),t},t.prototype.vfTblTransform=function(n,t,i,r,u,f){for(var h,o=Math.ceil(this.getTotalBlocks()/2),c=o===this.parent.pageSettings.currentPage&&this.parent.enableColumnVirtualization,s=[].slice.call(this.parent.getContent().querySelectorAll(".e-virtualtable")),e=0;e<s.length;e++)0===e&&"virtualscroll"===r.requestType&&"X"===n.sentinelInfo.axis||o!==this.parent.pageSettings.currentPage&&this.parent.enableColumnVirtualization&&(t>0||i>0&&0===t)||(h=c&&0===e?0:u,this.virtualEle.wrapper=s[e],this.virtualEle.adjustTable(h,f))},t.prototype.appendContent=function(n,t,i){var k=this,d=this.parent.enableColumnVirtualization&&0!==this.parent.getFrozenColumns(),u,h,c,o,f,y,l,e,s,v,p,w,b;if(this.checkFirstBlockColIndexes(i),u=i.virtualInfo.sentinelInfo&&"Y"===i.virtualInfo.sentinelInfo.axis&&this.currentInfo.page&&this.currentInfo.page!==i.virtualInfo.page?this.currentInfo:i.virtualInfo,this.prevInfo=this.prevInfo||i.virtualInfo,h=u.columnIndexes[0]-1,d&&u.columnIndexes[0]===this.parent.getFrozenColumns()&&(h=u.columnIndexes[0]-this.parent.getFrozenColumns()-1),o=this.getColumnOffset(h),f=u.blockIndexes,this.parent.groupSettings.columns.length&&this.refreshOffsets(),"100%"===this.parent.height&&(this.parent.element.style.height="100%"),l=this.parent.height.toString().indexOf("%")<0?this.content.getBoundingClientRect().height:this.parent.element.getBoundingClientRect().height,e=0,this.parent.getFrozenColumns()){var a=this.parent.getMovableVirtualContent(),g=a.scrollLeft,tt=a.scrollTop;e=this.getTranslateY(a.scrollTop,l,u);this.vfTblTransform(u,g,tt,i,o,e)}else this.requestTypes.some(function(n){return n===k.requestType})||(e=this.getTranslateY(this.content.scrollTop,l,u),this.virtualEle.adjustTable(o,e));if((this.parent.enableColumnVirtualization&&!this.parent.getFrozenColumns()&&this.header.virtualEle.adjustTable(o,0),this.parent.enableColumnVirtualization)&&(s=u.columnIndexes,c=this.getColumnOffset(s[s.length-1])-this.getColumnOffset(s[0]-1)+"",this.header.virtualEle.setWrapperWidth(c)),this.virtualEle.setWrapperWidth(c,r.Browser.isIE||"edge"===r.Browser.info.name),Object(r.isNullOrUndefined)(n.parentNode)||Object(r.remove)(n),(y=this.parent.getFrozenColumns()&&!i.renderMovableContent?this.parent.getFrozenVirtualContent().querySelector("tbody"):this.parent.getFrozenColumns()&&i.renderMovableContent?this.parent.getMovableVirtualContent().querySelector("tbody"):this.parent.element.querySelector(".e-content").querySelector("tbody"))&&(Object(r.remove)(y),n=null),this.parent.isReact&&!Object(r.isNullOrUndefined)(this.parent.rowTemplate)?n=t:(n=this.parent.createElement("tbody")).appendChild(t),this.parent.frozenRows&&"virtualscroll"===i.requestType&&1===this.parent.pageSettings.currentPage)for(v=0;v<this.parent.frozenRows;v++)n.children[0].remove();(this.parent.getFrozenColumns()?(i.renderMovableContent?(this.parent.getMovableVirtualContent().querySelector(".e-table").appendChild(n),this.requestType="virtualscroll"===this.requestType?this.empty:this.requestType):this.parent.getFrozenVirtualContent().querySelector(".e-table").appendChild(n),this.vfColIndex.length&&(i.virtualInfo.columnIndexes=u.columnIndexes=Object(r.extend)([],this.vfColIndex),this.vfColIndex=i.renderMovableContent?[]:this.vfColIndex)):(this.getTable().appendChild(n),this.requestType="virtualscroll"===this.requestType?this.empty:this.requestType),this.parent.groupSettings.columns.length)&&(nt(this.parent)||"up"!==u.direction||(p=this.offsets[this.getTotalBlocks()]-this.prevHeight,this.preventEvent=!0,w=this.content.scrollTop,this.content.scrollTop=w+p),this.setVirtualHeight(),this.observer.setPageHeight(this.getOffset(f[f.length-1])-this.getOffset(f[0]-1)));this.prevInfo=u;this.isFocused&&"downArrow"!==this.activeKey&&"upArrow"!==this.activeKey&&this.content.focus();b=Math.ceil(this.getTotalBlocks()/2);this.isBottom&&(this.isBottom=!1,this.parent.getContent().firstElementChild.scrollTop=this.offsets[this.offsetKeys.length-1]);this.parent.pageSettings.currentPage===b&&1===f.length&&(this.isBottom=!0,this.parent.getContent().firstElementChild.scrollTop=this.offsets[this.offsetKeys.length-2]);this.parent.enableColumnVirtualization&&this.parent.getFrozenColumns()&&"virtualscroll"===i.requestType&&"X"===i.virtualInfo.sentinelInfo.axis&&this.refreshMvTbalTransform();"virtualscroll"===i.requestType&&"X"===i.virtualInfo.sentinelInfo.axis&&this.parent.notify(wi,{});this.focusCell(i);this.restoreEdit();this.restoreAdd()},t.prototype.checkFirstBlockColIndexes=function(n){var i,t;if(this.parent.enableColumnVirtualization&&this.parent.getFrozenColumns()&&0===n.virtualInfo.columnIndexes[0])if(i=[],!n.renderMovableContent&&n.virtualInfo.columnIndexes.length>this.parent.getFrozenColumns()){for(this.vfColIndex=n.virtualInfo.columnIndexes,t=0;t<this.parent.getFrozenColumns();t++)i.push(t);n.virtualInfo.columnIndexes=i}else n.renderMovableContent&&(this.vfColIndex.length||(this.vfColIndex=Object(r.extend)([],n.virtualInfo.columnIndexes)),n.virtualInfo.columnIndexes=Object(r.extend)([],this.vfColIndex),n.virtualInfo.columnIndexes.splice(0,this.parent.getFrozenColumns()))},t.prototype.focusCell=function(){if("upArrow"===this.activeKey||"downArrow"===this.activeKey){var n=this.parent.getRowByIndex(this.rowIndex);n.cells[this.cellIndex].focus({preventScroll:!0});this.parent.selectRow(parseInt(n.getAttribute("aria-rowindex"),10));this.activeKey=this.empty}},t.prototype.restoreEdit=function(){var n,t,i;this.isNormaledit&&(this.parent.editSettings.allowEditing&&this.parent.editModule&&!Object(r.isNullOrUndefined)(this.editedRowIndex)&&(n=this.getRowByIndex(this.editedRowIndex),Object.keys(this.virtualData).length&&n&&!this.content.querySelector(".e-editedrow")&&(t=n.getBoundingClientRect().top,t<this.content.offsetHeight&&t>this.parent.getRowHeight()&&(this.parent.isEdit=!1,this.parent.editModule.startEdit(n))),n&&this.content.querySelector(".e-editedrow")&&!Object.keys(this.virtualData).length&&(i=Object(r.extend)({},this.getRowObjectByIndex(this.editedRowIndex)),this.virtualData=this.getVirtualEditedData(i))),this.restoreAdd())},t.prototype.getVirtualEditedData=function(n){var t=this.content.querySelector(".e-gridform");return this.parent.editModule.getCurrentEditedData(t,n)},t.prototype.restoreAdd=function(){if(this.isNormaledit&&this.isAdd&&!this.content.querySelector(".e-addedrow")){var n="Top"===this.parent.editSettings.newRowPosition&&this.content.scrollTop<this.parent.getRowHeight(),t="Bottom"===this.parent.editSettings.newRowPosition&&this.parent.pageSettings.currentPage===this.maxPage;(n||t)&&(this.parent.isEdit=!1,this.parent.addRecord())}},t.prototype.onDataReady=function(n){if(Object(r.isNullOrUndefined)(n.count)||(this.count=n.count,this.maxPage=Math.ceil(n.count/this.parent.pageSettings.pageSize)),this.vgenerator.checkAndResetCache(n.requestType),["refresh","filtering","searching","grouping","ungrouping","reorder",void 0].some(function(t){return n.requestType===t})&&this.refreshOffsets(),this.parent.getFrozenColumns()&&this.parent.enableColumnVirtualization){var t=[].slice.call(this.parent.getHeaderContent().querySelectorAll(".e-table"));this.header.virtualEle.table=t[1]}this.setVirtualHeight();this.resetScrollPosition(n.requestType)},t.prototype.setVirtualHeight=function(n){var i=this.parent.enableColumnVirtualization?this.getColumnOffset(this.parent.columns.length+this.parent.groupSettings.columns.length-1)+"px":"100%",t,u,f;this.parent.getFrozenColumns()?(t=1===this.parent.pageSettings.currentPage&&Object.keys(this.offsets).length<=2?this.offsets[1]:this.offsets[this.getTotalBlocks()-2],t=t>this.parent.getMovableVirtualContent().clientHeight?t:0,u=this.parent.enableColumnVirtualization?"auto":i,this.virtualEle.placeholder=this.parent.getFrozenVirtualContent().querySelector(".e-virtualtrack"),this.virtualEle.setVirtualHeight(t,u),this.virtualEle.placeholder=this.parent.getMovableVirtualContent().querySelector(".e-virtualtrack"),this.virtualEle.setVirtualHeight(t,i)):(f=Object(r.isBlazor)()&&this.parent.isServerRendered&&this.parent.groupSettings.columns.length&&n?n:this.offsets[nt(this.parent)?this.getGroupedTotalBlocks():this.getTotalBlocks()],this.virtualEle.setVirtualHeight(f,i));this.parent.enableColumnVirtualization&&this.header.virtualEle.setVirtualHeight(1,i)},t.prototype.getPageFromTop=function(n,t){var i=this,r=nt(this.parent)?this.getGroupedTotalBlocks():this.getTotalBlocks(),u=0;return this.offsets[r],this.prevHeight,this.offsetKeys.some(function(f){var e=Number(f),o=n<=i.offsets[f]||e===r&&n>i.offsets[f];return o&&(i.offsetKeys.length%2!=0&&e.toString()===i.offsetKeys[i.offsetKeys.length-2]&&n<=i.offsets[i.offsetKeys.length-1]&&(e+=1),t.block=e%2==0?1:0,u=Math.max(1,Math.min(i.vgenerator.getPage(e),i.maxPage))),o}),u},t.prototype.getTranslateY=function(n,t,i,r){var u,e;void 0===i&&((i={page:this.getPageFromTop(n,{})}).blockIndexes=this.vgenerator.getBlockIndexes(i.page));var f=(i.blockIndexes[0]||1)-1,o=this.getOffset(f),s=this.getOffset(i.blockIndexes[i.blockIndexes.length-1]);return r&&(i=this.prevInfo),u=o>n?this.getOffset(f-1):s<n+t?this.getOffset(f+1):o,e=this.offsets[i.blockIndexes[i.blockIndexes.length-1]]-this.tmpOffsets[i.blockIndexes[0]],u+e>this.offsets[nt(this.parent)?this.getGroupedTotalBlocks():this.getTotalBlocks()]&&(u-=u+e-this.offsets[this.getTotalBlocks()]),u},t.prototype.getOffset=function(n){return Math.min(0|this.offsets[n],0|this.offsets[this.maxBlock])},t.prototype.onEntered=function(){var n=this;return function(t,i,u,f,e,o){var l;r.Browser.isIE&&!e&&o&&!n.preventEvent&&n.parent.showSpinner();var s="X"===i.axis,a=n.prevInfo.offsets?n.prevInfo.offsets.top:null,v=n.content.getBoundingClientRect().height,c=n.getColumnOffset(s?n.vgenerator.getColumnIndexes()[0]-1:n.prevInfo.columnIndexes[0]-1),h=n.getTranslateY(f.top,v,s&&a===f.top?n.prevInfo:void 0,!0);(Object(r.isBlazor)()&&n.parent.isServerRendered&&n.currentInfo&&n.currentInfo.startIndex&&s&&(h=n.currentInfo.startIndex*n.parent.getRowHeight()),n.virtualEle.adjustTable(c,Math.min(h,n.offsets[n.maxBlock])),Object(r.isBlazor)()&&n.parent.isServerRendered&&s&&n.parent.notify("setcolumnstyles",{refresh:!0}),n.parent.getFrozenColumns()&&!s)&&(l=n.parent.getMovableVirtualContent().scrollLeft,n.parent.getFrozenVirtualContent().querySelector(".e-virtualtable").style.transform=n.parent.enableColumnVirtualization&&l>0?"translate(0px, "+Math.min(h,n.offsets[n.maxBlock])+"px)":"translate("+c+"px, "+Math.min(h,n.offsets[n.maxBlock])+"px)");n.parent.enableColumnVirtualization&&(!Object(r.isBlazor)()||Object(r.isBlazor)()&&!n.parent.isServerRendered)&&n.header.virtualEle.adjustTable(c,0)}},t.prototype.dataBound=function(){this.isSelection&&"upArrow"!==this.activeKey&&"downArrow"!==this.activeKey?this.parent.selectRow(this.selectedRowIndex):Object(r.isBlazor)()||(this.activeKey=this.empty)},t.prototype.rowSelected=function(){this.isSelection=!1},t.prototype.eventListener=function(n){var t=this,r,i,u;for(this.parent[n](at,this.onDataReady,this),this.parent.addEventListener(ct,this.dataBound.bind(this)),this.parent.addEventListener(l,this.actionBegin.bind(this)),this.parent.addEventListener(c,this.actionComplete.bind(this)),this.parent.addEventListener(wf,this.rowSelected.bind(this)),this.parent[n](ku,this.refreshContentRows,this),this.parent[n](pl,this.selectVirtualRow,this),this.parent[n](kl,this.virtualCellFocus,this),this.parent[n](se,this.editActionBegin,this),this.parent[n](le,this.addActionBegin,this),this.parent[n](gl,this.restoreEdit,this),this.parent[n](ff,this.editSuccess,this),this.parent[n](he,this.refreshCache,this),this.parent[n](ce,this.resetIsedit,this),this.parent[n](eu,this.getVirtualData,this),this.parent[n](dl,this.editCancel,this),r=this.actions,i=0;i<r.length;i++)this.parent[n](r[i]+"-begin",this.onActionBegin,this);u=function(){var n,i;t.observer.observe(function(n){return t.scrollListener(n)},t.onEntered());n=t.parent;n.enablePersistence&&n.scrollPosition&&(t.content.scrollTop=n.scrollPosition.top,i={direction:"down",sentinel:t.observer.sentinelInfo.down,offset:n.scrollPosition,focusElement:n.element},t.scrollListener(i),n.enableColumnVirtualization&&(t.content.scrollLeft=n.scrollPosition.left));t.parent.off(y,u)};this.parent.on(y,u,this)},t.prototype.getVirtualData=function(n){n.virtualData=this.virtualData;n.isAdd=this.isAdd;n.isCancel=this.isCancel},t.prototype.editCancel=function(n){var t=lh(this.parent,n.data);Object(r.isNullOrUndefined)(t)||(n.data=this.parent.getCurrentViewRecords()[t])},t.prototype.editSuccess=function(n){this.isNormaledit&&(!this.isAdd&&n.data&&this.updateCurrentViewData(n.data),this.isAdd=!1)},t.prototype.updateCurrentViewData=function(n){var t=lh(this.parent,n);Object(r.isNullOrUndefined)(t)||(this.parent.getCurrentViewRecords()[t]=n)},t.prototype.actionBegin=function(n){"virtualscroll"!==n.requestType&&(this.requestType=n.requestType)},t.prototype.virtualCellFocus=function(n){var i=document.activeElement,t,u;if(i.classList.contains("e-rowcell")&&n&&("upArrow"===n.action||"downArrow"===n.action)&&(t=parseInt(i.parentElement.getAttribute("aria-rowindex"),10),n&&("downArrow"===n.action||"upArrow"===n.action))){u=this.parent.getContent().firstElementChild;"downArrow"===n.action?t+=1:t-=1;this.rowIndex=t;this.cellIndex=parseInt(i.getAttribute("aria-colindex"),10);var f=this.parent.getRowByIndex(t),o=this.parent.pageSettings.currentPage,s=Math.floor(u.offsetHeight/this.parent.getRowHeight())-1,e=!1;Object(r.isNullOrUndefined)(f)&&(e=!0,("downArrow"===n.action&&o===this.maxPage-1||"upArrow"===n.action&&1===o)&&(e=!1));e||hh(f,this.parent)&&"downArrow"===n.action||ch(f,2*this.parent.getRowHeight())&&"upArrow"===n.action?(this.activeKey=n.action,u.scrollTop="downArrow"===n.action?(t-s)*this.parent.getRowHeight():t*this.parent.getRowHeight()):this.activeKey=this.empty;(!Object(r.isBlazor)()||Object(r.isBlazor)()&&!this.blazorDataLoad)&&this.parent.selectRow(t)}},t.prototype.editActionBegin=function(n){this.editedRowIndex=n.index;var t=Object(r.extend)({},this.getRowObjectByIndex(n.index));n.data=Object.keys(this.virtualData).length?this.virtualData:t},t.prototype.refreshCache=function(n){var t=Math.ceil((this.editedRowIndex+1)/this.getBlockSize()),i=this.editedRowIndex-(t-1)*this.getBlockSize();this.vgenerator.cache[t][i].data=n},t.prototype.actionComplete=function(n){"delete"!==n.requestType&&"save"!==n.requestType&&"cancel"!==n.requestType||(this.refreshOffsets(),this.refreshVirtualElement(),this.isNormaledit&&("cancel"===n.requestType&&(this.isCancel=!0),this.isAdd=!1,this.editedRowIndex=this.empty,this.virtualData={},this.parent.editModule.previousVirtualData={}));this.parent.enableColumnVirtualization&&"filterafteropen"===n.requestType&&this.currentInfo.columnIndexes&&this.currentInfo.columnIndexes[0]>0&&this.parent.resetFilterDlgPosition(n.columnName)},t.prototype.resetIsedit=function(){this.parent.enableVirtualization&&this.isNormaledit&&(this.parent.editSettings.allowEditing&&Object.keys(this.virtualData).length||this.parent.editSettings.allowAdding&&this.isAdd)&&(this.parent.isEdit=!0)},t.prototype.scrollAfterEdit=function(){var n,t,i;this.parent.editModule&&this.parent.editSettings.allowEditing&&this.isNormaledit&&this.content.querySelector(".e-gridform")&&(n=this.content.querySelector(".e-editedrow"),t=this.content.querySelector(".e-addedrow"),(n||t)&&(i=n?Object(r.extend)({},this.getRowObjectByIndex(this.editedRowIndex)):Object(r.extend)({},this.emptyRowData),this.virtualData=this.getVirtualEditedData(i)))},t.prototype.createEmptyRowdata=function(){var n=this;this.parent.getColumns().filter(function(t){n.emptyRowData[t.field]=n.empty})},t.prototype.addActionBegin=function(n){if(this.isNormaledit){Object.keys(this.emptyRowData).length||this.createEmptyRowdata();this.isAdd=!0;var t=this.parent.pageSettings.currentPage;t>1&&"Top"===this.parent.editSettings.newRowPosition&&(this.isAdd=!0,this.onActionBegin(),n.startEdit=!1,this.content.scrollTop=0);t<this.maxPage-1&&"Bottom"===this.parent.editSettings.newRowPosition&&(this.isAdd=!0,this.parent.setProperties({pageSettings:{currentPage:this.maxPage-1}},!0),n.startEdit=!1,this.content.scrollTop=this.offsets[this.offsetKeys.length])}},t.prototype.getRowObjectByIndex=function(n){return this.getRowCollection(n,!1,!0)},t.prototype.getBlockSize=function(){return this.parent.pageSettings.pageSize>>1},t.prototype.getBlockHeight=function(){return this.getBlockSize()*this.parent.getRowHeight()},t.prototype.isEndBlock=function(n){var t=this.getTotalBlocks();return n>=t||n===t-1},t.prototype.getGroupedTotalBlocks=function(){var n=this.parent.vcRows;return Math.floor(n.length/this.getBlockSize()<1?1:n.length/this.getBlockSize())},t.prototype.getTotalBlocks=function(){return Math.ceil(this.count/this.getBlockSize())},t.prototype.getColumnOffset=function(n){return 0|this.vgenerator.cOffsets[n]},t.prototype.getModelGenerator=function(){return new hv(this.parent)},t.prototype.resetScrollPosition=function(n){if(this.actions.some(function(t){return t===n})){var t=this.parent.getFrozenColumns()?this.parent.getMovableVirtualContent():this.content;this.preventEvent=0!==t.scrollTop;t.scrollTop=0}"virtualscroll"!==n&&(this.isAdd=!1)},t.prototype.onActionBegin=function(){this.parent.setProperties({pageSettings:{currentPage:1}},!0)},t.prototype.getRows=function(){return this.vgenerator.getRows()},t.prototype.getRowByIndex=function(n){return nt(this.parent)?this.parent.getDataRows()[n]:this.getRowCollection(n,!1)},t.prototype.getMovableVirtualRowByIndex=function(n){return this.getRowCollection(n,!0)},t.prototype.getRowCollection=function(n,t,i){var o=this.prevInfo.blockIndexes,f=!Object(r.isBlazor)()||Object(r.isBlazor)()&&!this.parent.isServerRendered?(o[0]-1)*this.getBlockSize():this.startIndex,u=t?this.parent.getMovableDataRows():this.parent.getDataRows(),e=(i?this.parent.getCurrentViewRecords():u)[n-f];return!i&&this.parent.frozenRows&&this.parent.pageSettings.currentPage>1&&(e=n<=this.parent.frozenRows?u[n]:u[n-f+this.parent.frozenRows]),e},t.prototype.getVirtualRowIndex=function(n){return(this.prevInfo.blockIndexes[0]-1)*this.getBlockSize()+n},t.prototype.refreshOffsets=function(){var f=this.parent,e=0,r=this.getBlockSize(),i=nt(this.parent)?this.getGroupedTotalBlocks():this.getTotalBlocks(),t,n;for(this.prevHeight=this.offsets[i],this.maxBlock=i%2==0?i-2:i-1,this.offsets={},t=Array.apply(null,Array(i)).map(function(){return++e}),n=0;n<t.length;n++){var o=(this.vgenerator.cache[t[n]]||[]).length,u=nt(this.parent)?f.vcRows.length%r:this.count%r,s=!nt(this.parent)&&t[n]in this.vgenerator.cache?o*this.parent.getRowHeight():u&&t[n]===i?u*this.parent.getRowHeight():this.getBlockHeight();this.offsets[t[n]]=(0|this.offsets[t[n]-1])+s;this.tmpOffsets[t[n]]=0|this.offsets[t[n]-1]}this.offsetKeys=Object.keys(this.offsets);nt(this.parent)&&(this.parent.vGroupOffsets=this.offsets);this.parent.enableColumnVirtualization&&this.vgenerator.refreshColOffsets()},t.prototype.refreshVirtualElement=function(){this.vgenerator.refreshColOffsets();this.setVirtualHeight()},t.prototype.setVisible=function(n){var a,v,e=this.parent,h=this.parent.getFrozenColumns(),c,o,u,s,i,p;h&&(a=[].slice.call(this.parent.getFrozenVirtualContent().querySelectorAll("col")),v=[].slice.call(this.parent.getMovableVirtualContent().querySelectorAll("col")));Object(r.isBlazor)()&&e.isServerRendered&&this.parent.notify("setvisibility",n);o=[];(o=this.getRows()).some(function(n){return n.isDataRow&&(c=n),n.isDataRow});u=!0;!e.groupSettings.columns.length&&c&&(u=!1);for(var w=e.getDataRows(),y=0,k=n.length;y<k;y++){var t=n[y],f=e.getNormalizedColumnIndex(t.uid),b=!0===t.visible?"":"none",l=void 0;(a&&v?f>=h?(l=v,w=this.parent.getMovableRows(),f-=h):l=a:l=this.getColGroup().children,-1!==f&&c&&f<c.cells.length&&Object(r.setStyleAttribute)(l[f],{display:b}),u)||(s=void 0,(s=t.visible?this.virtualEle.wrapper.offsetWidth+parseInt(t.width.toString(),10):this.virtualEle.wrapper.offsetWidth-parseInt(t.width.toString(),10))>e.width?(this.setDisplayNone(w,f,b,o),this.parent.enableColumnVirtualization&&this.virtualEle.setWrapperWidth(s+""),this.refreshVirtualElement()):u=!0);!this.parent.invokedFromMedia&&t.hideAtMedia&&this.parent.updateMediaColumns(t);this.parent.invokedFromMedia=!1}Object(r.isBlazor)()&&this.parent.isServerRendered&&u&&(i=this.parent.inViewIndexes,p=this.getColumnOffset(i[0]-1),s=this.getColumnOffset(i[i.length-1])-p+"",this.parent.notify("refresh-virtual-indices",{requestType:"virtualScrollRefresh",startColumnIndex:i[0],endColumnIndex:i[i.length-1],axis:"X",VTablewidth:s,translateX:p}),this.parent.notify("setcolumnstyles",{}));u||h?this.refreshContentRows({requestType:"refresh"}):this.parent.notify(uu,{rows:o,args:{isFrozen:!1,rows:o}})},t.prototype.selectVirtualRow=function(n){var e=this,i;if("upArrow"!==this.activeKey&&"downArrow"!==this.activeKey&&!this.requestTypes.some(function(n){return n===e.requestType})&&!this.parent.selectionModule.isInteracted){var t=this.parent.getFrozenColumns()?this.parent.getMovableVirtualContent():this.parent.getContent().firstElementChild,u=this.parent.getRowByIndex(n.selectedIndex),f=this.parent.getRowHeight(),o=t.offsetHeight;(!u||this.isRowInView(n.selectedIndex,u,t,o,f))&&(this.isSelection=!0,this.selectedRowIndex=n.selectedIndex,i=(n.selectedIndex+1)*f,Object(r.isNullOrUndefined)(i)||(t.scrollTop=i))}this.requestType=this.empty},t.prototype.isRowInView=function(n,t,i,u,f){var e,o;return Object(r.isBlazor)()?(e=i.scrollTop/f,n<e||n>e+u/f):this.parent.frozenRows&&n<this.parent.frozenRows?!1:(o=t?t.getBoundingClientRect().top:0,o<f||o>u)},t}(of),lv=function(n){function t(t,i){var r=n.call(this,t,i)||this;return r.virtualEle=new av,r.gen=new hv(r.parent),r.parent.on(ui,r.setVisible,r),r.parent.on(ku,function(n){return"X"===n.virtualInfo.sentinelInfo.axis?r.refreshUI():null},r),r}return fd(t,n),t.prototype.renderTable=function(){this.gen.refreshColOffsets();this.parent.setColumnIndexesInView(this.gen.getColumnIndexes(this.getPanel().querySelector(".e-headercontent")));Object(r.isBlazor)()&&this.parent.isServerRendered&&this.parent.notify("refresh-virtual-indices",{startColumnIndex:this.parent.contentModule.startColIndex,endColumnIndex:this.parent.contentModule.endColIndex,axis:"X"});n.prototype.renderTable.call(this);this.virtualEle.table=this.getTable();this.virtualEle.content=this.getPanel().querySelector(".e-headercontent");this.parent.getFrozenColumns()||(this.virtualEle.content.style.position="relative");this.virtualEle.renderWrapper();this.virtualEle.renderPlaceHolder("absolute")},t.prototype.appendContent=function(n){this.virtualEle.wrapper.appendChild(n)},t.prototype.refreshUI=function(){this.setFrozenTable(this.parent.getMovableVirtualContent());this.gen.refreshColOffsets();this.parent.setColumnIndexesInView(this.gen.getColumnIndexes(this.getPanel().querySelector(".e-headercontent")));n.prototype.refreshUI.call(this);this.setFrozenTable(this.parent.getFrozenVirtualContent())},t.prototype.setVisible=function(n){var s,f,h,c,l,e=this.parent,i=this.parent.getFrozenColumns(),o,v,t,u,a;for(i&&(c=[].slice.call(this.parent.getFrozenVirtualHeader().querySelectorAll("col")),l=[].slice.call(this.parent.getMovableVirtualHeader().querySelectorAll("col"))),o=0,v=n.length;o<v;o++)t=n[o],f=e.getNormalizedColumnIndex(t.uid),s=t.visible?"":"none",u=void 0,(c&&l?f>=i?(u=l,f-=i):u=c:u=this.getColGroup().children,Object(r.setStyleAttribute)(u[f],{display:s}),e.enableColumnVirtualization&&!e.groupSettings.columns.length)?(a=void 0,(a=t.visible?this.virtualEle.wrapper.offsetWidth+parseInt(t.width.toString(),10):this.virtualEle.wrapper.offsetWidth-parseInt(t.width.toString(),10))>e.width?(this.setDisplayNone(t,s),this.virtualEle.setWrapperWidth(a+""),this.gen.refreshColOffsets()):h=!0):h=!0,h&&!i&&this.refreshUI();i&&this.parent.notify(lr,{})},t.prototype.setFrozenTable=function(n){this.parent.getFrozenColumns()&&this.parent.enableColumnVirtualization&&this.parent.contentModule.isXaxis()&&this.parent.contentModule.setTable(n.querySelector(".e-table"))},t.prototype.setDisplayNone=function(n,t){var e=this.parent.getFrozenColumns(),o=this.getTable(),u,f,i;for(e&&n.index>=e&&(o=this.parent.getMovableVirtualHeader().querySelector(".e-table")),u=0,f=[].slice.apply(o.querySelectorAll("th.e-headercell"));u<f.length;u++)if(i=f[u],i.querySelector("[e-mappinguid]")&&i.querySelector("[e-mappinguid]").getAttribute("e-mappinguid")===n.uid){Object(r.setStyleAttribute)(i,{display:t});""===t&&Object(r.removeClass)([i],"e-hide");break}},t}(ds),av=function(){function n(){}return n.prototype.renderWrapper=function(n){Object(r.isBlazor)()?(this.wrapper=this.content.querySelector(".e-virtualtable")?this.content.querySelector(".e-virtualtable"):Object(r.createElement)("div",{className:"e-virtualtable"}),this.wrapper.setAttribute("styles","min-height:"+Object(r.formatUnit)(n))):this.wrapper=Object(r.createElement)("div",{className:"e-virtualtable",styles:"min-height:"+Object(r.formatUnit)(n)});this.wrapper.appendChild(this.table);this.content.appendChild(this.wrapper)},n.prototype.renderPlaceHolder=function(n){void 0===n&&(n="relative");Object(r.isBlazor)()?(this.placeholder=this.content.querySelector(".e-virtualtrack")?this.content.querySelector(".e-virtualtrack"):Object(r.createElement)("div",{className:"e-virtualtrack"}),this.placeholder.setAttribute("styles","position:"+n)):this.placeholder=Object(r.createElement)("div",{className:"e-virtualtrack",styles:"position:"+n});this.content.appendChild(this.placeholder)},n.prototype.adjustTable=function(n,t){this.wrapper.style.transform="translate("+n+"px, "+t+"px)"},n.prototype.setWrapperWidth=function(n,t){this.wrapper.style.width=n?n+"px":t?"100%":""},n.prototype.setVirtualHeight=function(n,t){this.placeholder.style.height=n+"px";this.placeholder.style.width=t},n.prototype.setFreezeWrapperWidth=function(n,t,i){n.style.width=t?t+"px":i?"100%":""},n}(),wit=function(){function n(n,t){this.parent=n;this.locator=t;this.addEventListener()}return n.prototype.getModuleName=function(){return"virtualscroll"},n.prototype.instantiateRenderer=function(){this.parent.log(["limitation","virtual_height"],"virtualization");var n=this.locator.getService("rendererFactory");this.parent.getFrozenColumns()||(this.parent.enableColumnVirtualization&&n.addRenderer(ut.Header,new lv(this.parent,this.locator)),n.addRenderer(ut.Content,new cv(this.parent,this.locator)));this.ensurePageSize()},n.prototype.ensurePageSize=function(){var i=this.parent.getRowHeight(),u=this.parent.height.toString().indexOf("%")<0?this.parent.height:this.parent.element.getBoundingClientRect().height,n,t;this.blockSize=~~(u/i);n=2*this.blockSize;t=this.parent.pageSettings.pageSize;this.parent.setProperties({pageSettings:{pageSize:t<n?n:t}},!0);Object(r.isBlazor)()&&this.parent.isServerRendered&&this.parent.notify("refresh-virtual-indices",{})},n.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(ii,this.instantiateRenderer,this),this.parent.on(nu,this.refreshVirtualElement,this))},n.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(ii,this.instantiateRenderer),this.parent.off(nu,this.refreshVirtualElement))},n.prototype.refreshVirtualElement=function(n){this.parent.enableColumnVirtualization&&"resize"===n.module&&this.locator.getService("rendererFactory").getRenderer(ut.Content).refreshVirtualElement()},n.prototype.destroy=function(){this.removeEventListener()},n}(),vv=function(){function n(n){this.parent=n}return n.prototype.addNew=function(n,t){var r,i,f,e,u;(this.isEdit=!1,i=this.parent.frozenRows&&"Top"===this.parent.editSettings.newRowPosition?this.parent.getHeaderContent().querySelector("tbody"):this.parent.getContentTable().querySelector("tbody"),t.row=this.parent.createElement("tr",{className:"e-row e-addedrow"}),i.querySelector(".e-emptyrow"))&&(f=i.querySelector(".e-emptyrow"),(f.parentNode.removeChild(f),this.parent.getFrozenColumns())&&(e=this.parent.getContent().querySelector(".e-movablecontent").querySelector("tbody"),e.firstElementChild.parentNode.removeChild(e.firstElementChild)));("Top"===this.parent.editSettings.newRowPosition?i.insertBefore(t.row,i.firstChild):i.appendChild(t.row),t.row.appendChild(this.getEditElement(n,!1,void 0,t,!0)),this.parent.editModule.checkLastRow(t.row,t),this.parent.getFrozenColumns())&&(u=this.renderMovableform(t.row,t),r=this.parent.frozenRows&&"Top"===this.parent.editSettings.newRowPosition?this.parent.getHeaderContent().querySelector(".e-movableheader").querySelector("tbody"):this.parent.getContent().querySelector(".e-movablecontent").querySelector("tbody"),"Top"===this.parent.editSettings.newRowPosition?r.insertBefore(u,r.firstChild):r.appendChild(u),t.row.querySelector(".e-normaledit").setAttribute("colspan",this.parent.getVisibleFrozenColumns()+""),u.setAttribute("colspan",""+(this.parent.getVisibleColumns().length-this.parent.getVisibleFrozenColumns())),"auto"===this.parent.height&&this.parent.notify(ru,{}))},n.prototype.renderMovableform=function(n,t){var i=n.cloneNode(!0),r=t.movableForm=i.querySelector("form");return this.parent.editSettings.template?(r.innerHTML="",this.appendChildren(r,t.rowData,!1),i):(this.renderMovable(n,i),i.querySelector("colgroup").innerHTML=this.parent.getHeaderContent().querySelector(".e-movableheader").querySelector("colgroup").innerHTML,i)},n.prototype.updateFreezeEdit=function(n,t){return t.concat([].slice.call(this.getFreezeRow(n).querySelectorAll("td.e-rowcell")))},n.prototype.getFreezeRow=function(n){if(this.parent.getFrozenColumns()){var t=parseInt(n.getAttribute("aria-rowindex"),10),i=this.parent.getContent().querySelector(".e-frozencontent").querySelector("tbody"),r=this.parent.getContent().querySelector(".e-movablecontent").querySelector("tbody"),u=this.parent.getHeaderContent().querySelector(".e-frozenheader").querySelector("tbody"),f=this.parent.getHeaderContent().querySelector(".e-movableheader").querySelector("tbody");if(this.parent.frozenRows&&t>=this.parent.frozenRows&&(t-=this.parent.frozenRows),i.contains(n))return this.parent.infiniteScrollSettings.enableCache?this.parent.getMovableRowByIndex(t):r.children[t];if(r.contains(n))return this.parent.infiniteScrollSettings.enableCache?this.parent.getRowByIndex(t):i.children[t];if(u.contains(n))return f.children[t];if(f.contains(n))return u.children[t]}return n},n.prototype.update=function(n,t){if(this.isEdit=!0,Object(r.closest)(t.row,".e-movablecontent")&&(t.row=this.getFreezeRow(t.row),Object(r.isBlazor)()&&this.parent.isServerRendered&&(t.cloneRow=t.row.cloneNode(!0))),Object(r.isBlazor)()&&this.parent.isServerRendered){t.row.parentNode.insertBefore(t.cloneRow,t.row);t.row.classList.add("e-hiddenrow");var i=[].slice.call(t.cloneRow.querySelectorAll("td.e-rowcell"));t.cloneRow.innerHTML="";i=this.updateFreezeEdit(t.cloneRow,i);t.cloneRow.appendChild(this.getEditElement(n,!0,i,t,!0));t.cloneRow.classList.add("e-editedrow");this.refreshFreezeEdit(t.cloneRow,t)}else i=[].slice.call(t.row.querySelectorAll("td.e-rowcell")),t.row.innerHTML="",i=this.updateFreezeEdit(t.row,i),t.row.appendChild(this.getEditElement(n,!0,i,t,!0)),t.row.classList.add("e-editedrow"),this.parent.editModule.checkLastRow(t.row,t),this.refreshFreezeEdit(t.row,t)},n.prototype.refreshFreezeEdit=function(n,t){var e,o,f=n.firstChild,s=parseInt(n.getAttribute("aria-rowindex"),10),u,h,i;this.parent.getFrozenColumns()&&(s<this.parent.frozenRows?(o=this.parent.getHeaderContent(),e=".e-frozenheader"):(o=this.parent.getContent(),e=".e-frozencontent"),u=f.cloneNode(!0),h=t.movableForm=u.querySelector("form"),this.parent.editSettings.template&&(h.innerHTML="",this.appendChildren(h,t.rowData,!1)),i=void 0,o.querySelector(e).contains(n)?(i=this.parent.getMovableRowByIndex(s),Object(r.isBlazor)()&&this.parent.isServerRendered?(t.frozen=i,t.cloneFrozen=i.cloneNode(!0),i.classList.add("e-hiddenrow"),i.parentNode.insertBefore(t.cloneFrozen,i),this.updateFrozenCont(t.cloneFrozen,f,u)):this.updateFrozenCont(i,f,u)):(i=this.parent.getRowByIndex(s),Object(r.isBlazor)()&&this.parent.isServerRendered?(t.frozen=i,t.cloneFrozen=i.cloneNode(!0),i.parentNode.insertBefore(t.cloneFrozen,i),i.classList.add("e-hiddenrow"),this.updateFrozenCont(t.cloneFrozen,u,f)):this.updateFrozenCont(i,u,f)),Object(r.isBlazor)()&&this.parent.isServerRendered?(t.cloneFrozen.appendChild(u),t.cloneFrozen.classList.add("e-editedrow")):(i.appendChild(u),i.classList.add("e-editedrow")),uv(t.movableForm.querySelector("td:not(.e-hide)"),t.form.querySelector("td:not(.e-hide)")))},n.prototype.updateFrozenCont=function(n,t,i){n.innerHTML="";this.parent.editSettings.template||(this.renderMovable(t,i),i.querySelector("colgroup").innerHTML=this.parent.getHeaderContent().querySelector(".e-movableheader").querySelector("colgroup").innerHTML);t.setAttribute("colspan",this.parent.getVisibleFrozenColumns()+"");i.setAttribute("colspan",this.parent.getVisibleColumns().length-this.parent.getVisibleFrozenColumns()+"")},n.prototype.renderMovable=function(n,t){var r=this.parent.getFrozenColumns(),i;for(t.querySelector("tr").innerHTML="",i=r;i<this.parent.getColumns().length;i++)t.querySelector("tr").appendChild(n.querySelector("tr").removeChild(n.querySelector("tr").children[r]))},n.prototype.getEditElement=function(n,t,i,u,f){var e=this.parent,w=0,k=Object(r.isNullOrUndefined)(e.detailTemplate)&&Object(r.isNullOrUndefined)(e.childGrid)?0:1,c,l,v,y;if(e.allowGrouping&&(w=e.groupSettings.columns.length),c=this.parent.createElement("td",{className:"e-editcell e-normaledit",attrs:{colspan:(e.getVisibleColumns().length-e.getVisibleFrozenColumns()+this.parent.getIndentCount()).toString()}}),l=u.form=this.parent.createElement("form",{id:e.element.id+"EditForm",className:"e-gridform"}),this.parent.editSettings.template)return this.appendChildren(l,u.rowData,f),c.appendChild(l),c;v=this.parent.createElement("table",{className:"e-table e-inline-edit",attrs:{cellspacing:"0.25"}});v.appendChild(e.getContentTable().querySelector("colgroup").cloneNode(!0));var b=this.parent.createElement("tbody"),h=this.parent.createElement("tr"),o=0;for(k&&h.insertBefore(this.parent.createElement("td",{className:"e-detailrowcollapse"}),h.firstChild),e.isRowDragable()&&h.appendChild(this.parent.createElement("td",{className:"e-dragindentcell"}));o<w;)h.appendChild(this.parent.createElement("td",{className:"e-indentcell"})),o++;for(y=0,o=0;t&&y<i.length&&o<e.getColumns().length||o<e.getColumns().length;){var p=t?i[y].getAttribute("colspan"):null,s=e.getColumns()[o],a=this.parent.createElement("td",{className:"e-rowcell",attrs:{style:"text-align:"+(s.textAlign?s.textAlign:""),colspan:p||""}});s.visible?(a.appendChild(n[s.uid]),"booleanedit"===s.editType?a.classList.add("e-boolcell"):(s.commands||s.commandsTemplate)&&Object(r.addClass)([a],"e-unboundcell")):a.classList.add("e-hide");h.appendChild(a);o=p?o+parseInt(p,10):o+1;y++}return b.appendChild(h),v.appendChild(b),l.appendChild(v),c.appendChild(l),c},n.prototype.removeEventListener=function(){},n.prototype.appendChildren=function(n,t,i){var f=this,e=Object(r.extend)({},t,{isAdd:!this.isEdit,isFrozen:i},!0),u=this.parent.element.id+"editSettingsTemplate";this.parent.isReact&&"string"!=typeof this.parent.editSettings.template?(this.parent.getEditTemplate()(e,this.parent,"editSettingsTemplate",u,null,null,n),this.parent.renderTemplates()):rt(n,this.parent.getEditTemplate()(e,this.parent,"editSettingsTemplate",u));Object(r.updateBlazorTemplate)(u,"Template",this.parent.editSettings,!0,function(){for(var t=f.parent.getColumns(),n=0;n<t.length;n++)t[n].validationRules&&(f.parent.editModule.formObj.rules[t[n].field]=t[n].validationRules)})},n}(),ed=function(){function n(n){this.parent=n}return n.prototype.update=function(n,t){Object(r.isBlazor)()&&this.parent.isServerRendered?(t.cloneCell.innerHTML="",t.cloneCell.appendChild(this.getEditElement(n,t)),t.cloneCell.classList.remove("e-ellipsistooltip"),t.cloneCell.classList.add("e-editedbatchcell"),Object(r.classList)(t.row,["e-editedrow","e-batchrow"],[])):(t.cell.innerHTML="",t.cell.appendChild(this.getEditElement(n,t)),t.cell.classList.remove("e-ellipsistooltip"),t.cell.classList.add("e-editedbatchcell"),Object(r.classList)(t.row,["e-editedrow","e-batchrow"],[]))},n.prototype.getEditElement=function(n,t){var r=this.parent,i=this.parent.createElement("form",{id:r.element.id+"EditForm",className:"e-gridform"});return i.appendChild(n[t.columnObject.uid]),"booleanedit"===t.columnObject.editType&&t.cell.classList.add("e-boolcell"),t.columnObject.editType||t.cell.classList.add("e-inputbox"),i},n.prototype.removeEventListener=function(){},n}(),od=function(){function n(n,t){this.parent=n;this.serviceLocator=t;this.parent.isDestroyed||(this.parent.on(te,this.destroy,this),this.parent.on(ri,this.destroy,this))}return n.prototype.setLocaleObj=function(){this.l10n=this.serviceLocator.getService("localization")},n.prototype.addNew=function(n,t){this.isEdit=!1;this.createDialog(n,t)},n.prototype.update=function(n,t){this.isEdit=!0;this.createDialog(n,t)},n.prototype.createDialog=function(n,t){var i=this.parent;this.dialog=this.parent.createElement("div",{id:i.element.id+"_dialogEdit_wrapper",styles:"width: auto"});this.dialog.setAttribute("aria-label","Dialog edit");i.element.appendChild(this.dialog);this.setLocaleObj();this.dialogObj=new ft.Dialog(Object(r.extend)({header:i.editSettings.headerTemplate?this.getDialogEditTemplateElement("HeaderTemplate",t):this.isEdit?this.l10n.getConstant("EditFormTitle")+t.primaryKeyValue[0]:this.l10n.getConstant("AddFormTitle"),isModal:!0,visible:!0,cssClass:"e-edit-dialog",content:this.getEditElement(n,t),showCloseIcon:!0,allowDragging:!0,close:this.dialogClose.bind(this),closeOnEscape:!0,width:i.editSettings.template?"auto":"330px",target:t.target?t.target:document.body,animationSettings:{effect:"None"},footerTemplate:i.editSettings.footerTemplate?this.getDialogEditTemplateElement("FooterTemplate",t):null,buttons:[{click:this.btnClick.bind(this),buttonModel:{content:this.l10n.getConstant("SaveButton"),cssClass:"e-primary",isPrimary:!0}},{click:this.btnClick.bind(this),buttonModel:{cssClass:"e-flat",content:this.l10n.getConstant("CancelButton")}}]},i.editSettings.dialog&&i.editSettings.dialog.params||{}));Object(r.isBlazor)()?this.dialogObj.locale=this.parent.locale:t.dialog=this.dialogObj;this.dialogObj.isStringTemplate=!0;this.dialogObj.appendTo(this.dialog);vf(this.parent.element,this.dialogObj.element.parentElement)},n.prototype.btnClick=function(n){this.l10n.getConstant("CancelButton").toLowerCase()===n.target.innerText.trim().toLowerCase()?this.dialogClose():this.parent.endEdit()},n.prototype.dialogClose=function(){this.parent.closeEdit()},n.prototype.destroy=function(){for(var i,u,t=["template","headerTemplate","footerTemplate"],n=0;n<t.length;n++)this.parent.editSettings[t[n]]&&(i=t[n].charAt(0).toUpperCase()+t[n].slice(1),u=this.parent.element.id+"editSettings"+i,Object(r.updateBlazorTemplate)(u,i,this.parent.editSettings));this.parent.notify(ie,{});this.parent.isEdit=!1;this.parent.notify(lt,{});this.dialog&&!this.dialogObj.isDestroyed&&(this.dialogObj.destroy(),Object(r.remove)(this.dialog))},n.prototype.getDialogEditTemplateElement=function(n,t){var i=this.parent.createElement("div",{className:"e-dialog"+n}),f=Object(r.extend)({},t.rowData,{isAdd:!this.isEdit},!0),u=this.parent.element.id+"editSettings"+n;return rt(i,("HeaderTemplate"===n?this.parent.getEditHeaderTemplate():this.parent.getEditFooterTemplate())(f,this.parent,"editSettings"+n,u)),Object(r.updateBlazorTemplate)(u,n,this.parent.editSettings),i},n.prototype.getEditElement=function(n,t){var l=this,a=this.parent,e=this.parent.createElement("div",{className:this.isEdit?"e-editedrow":"e-insertedrow"}),f=t.form=this.parent.createElement("form",{id:a.element.id+"EditForm",className:"e-gridform"}),o,s,h,c;if(this.parent.editSettings.template)return o=this.parent.element.id+"editSettingsTemplate",s=Object(r.extend)({},t.rowData,{isAdd:!this.isEdit},!0),this.parent.isReact&&"string"!=typeof this.parent.editSettings.template?(this.parent.getEditTemplate()(s,this.parent,"editSettingsTemplate",o,null,null,f),this.parent.renderTemplates()):rt(f,this.parent.getEditTemplate()(s,this.parent,"editSettingsTemplate",o)),Object(r.updateBlazorTemplate)(o,"Template",this.parent.editSettings,!0,function(){for(var t=l.parent.getColumns(),n=0;n<t.length;n++)t[n].validationRules&&(l.parent.editModule.formObj.rules[t[n].field]=t[n].validationRules)}),e.appendChild(f),e;for(var v=this.parent.createElement("table",{className:"e-table",attrs:{cellspacing:"6px"}}),y=this.parent.createElement("tbody"),u=a.getColumns(),i=0;i<u.length;i++)this.parent.editModule.checkColumnIsGrouped(u[i])||u[i].commands||u[i].commandsTemplate||"checkbox"===u[i].type||(h=this.parent.createElement("tr"),c=this.parent.createElement("td",{className:"e-rowcell",attrs:{style:"text-align:"+(this.parent.enableRtl?"right":"left")+";width:190px"}}),this.parent.createElement("label",{innerHTML:u[i].field}),n[u[i].uid].classList.remove("e-input"),c.appendChild(n[u[i].uid]),h.appendChild(c),y.appendChild(h));return v.appendChild(y),f.appendChild(v),e.appendChild(f),e},n.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(te,this.destroy),this.parent.off(ri,this.destroy))},n}(),sd=function(){function n(n,t){this.editType={Inline:vv,Normal:vv,Batch:ed,Dialog:od};this.parent=n;this.serviceLocator=t;this.renderer=new this.editType[this.parent.editSettings.mode](n,t);this.focus=t.getService("focus")}return n.prototype.addNew=function(n){this.renderer.addNew(this.getEditElements(n),n);this.convertWidget(n)},n.prototype.update=function(n){this.renderer.update(this.getEditElements(n),n);this.parent.notify(tw,n);this.convertWidget(n)},n.prototype.convertWidget=function(n){var v,u,e,i=this.parent,o=i.getFrozenColumns(),s="Dialog"===i.editSettings.mode?Object(r.select)("#"+i.element.id+"_dialogEdit_wrapper .e-gridform",document):i.element.querySelector(".e-gridform"),y,t,h,f,c,l;o&&"Normal"===i.editSettings.mode&&(y=parseInt(n.row.getAttribute("aria-rowindex"),10),e=i.frozenRows&&("add"===n.requestType&&"Top"===i.editSettings.newRowPosition||y<i.frozenRows)?i.element.querySelector(".e-movableheader").querySelector(".e-gridform"):i.element.querySelector(".e-movablecontent").querySelector(".e-gridform"));for(var p="Batch"!==i.editSettings.mode?i.getColumns():[i.getColumnByField(n.columnName)],a=0,w=p;a<w.length;a++)t=w[a],!this.parent.editSettings.template||Object(r.isNullOrUndefined)(t.field)?this.parent.editModule.checkColumnIsGrouped(t)||t.commands||(t.valueAccessor(t.field,n.rowData,t),u=o&&p.indexOf(t)>=o&&"Normal"===i.editSettings.mode?e.querySelector("[e-mappinguid="+t.uid+"]"):s.querySelector("[e-mappinguid="+t.uid+"]"),h=t.edit.write,Object(r.isNullOrUndefined)(u)||("string"==typeof h?(h=k(h,window))({rowData:n.rowData,element:u,column:t,requestType:n.requestType,row:n.row,foreignKeyData:t.isForeignColumn()&&k(t.field,n.foreignKeyData)}):t.edit.write({rowData:n.rowData,element:u,column:t,requestType:n.requestType,row:n.row,foreignKeyData:t.isForeignColumn()&&k(t.field,n.foreignKeyData)}),v||u.getAttribute("disabled")||(this.focusElement(u,n.type),v=!0))):(f=Object(r.extend)({},n),f.element=s.querySelector("[name="+b(t.field)+"]"),Object(r.isNullOrUndefined)(f.element)&&o&&(f.element=e.querySelector("[name="+b(t.field)+"]")),"string"==typeof t.edit.write?k(t.edit.write,window)(f):t.edit.write(f));0===o||this.parent.allowTextWrap||"add"!==n.requestType&&"beginEdit"!==n.requestType||"Dialog"===this.parent.editSettings.mode||Object(r.isNullOrUndefined)(s)||Object(r.isNullOrUndefined)(e)||(c=e.querySelector("tr").children[0],l=s.querySelector("tr").children[0],l.offsetHeight>c.offsetHeight?c.style.height=l.offsetHeight+"px":l.style.height=c.offsetHeight+"px")},n.prototype.focusElement=function(n){var t=this.parent.element.querySelector(".e-edit-checkselect");(Object(r.isNullOrUndefined)(t)||t.nextElementSibling.classList.add("e-focus"),"Batch"===this.parent.editSettings.mode)?this.focus.onClick({target:Object(r.closest)(n,"td")},!0):!this.parent.enableVirtualization||"Normal"!==this.parent.editSettings.mode||this.parent.enableVirtualization&&"Bottom"===this.parent.editSettings.newRowPosition&&o(n,"e-addedrow")?n.focus():n.focus({preventScroll:!0});n.classList.contains("e-defaultcell")&&n.setSelectionRange(n.value.length,n.value.length)},n.prototype.getEditElements=function(n){var g=this,f=this.parent,s={},v="Batch"!==f.editSettings.mode?f.getColumns():[f.getColumnByField(n.columnName)],u,y,t,e,l,o,d,a;if(this.parent.editSettings.template)return{};for(u=0,y=v.length;u<y;u++)if(t=v[u],!this.parent.editModule.checkColumnIsGrouped(t))if(t.commands||t.commandsTemplate){var nt=this.serviceLocator.getService("cellRendererFactory"),tt=new vi(this.parent),it=nt.getCellRenderer(h.CommandColumn),ut=tt.generateRows(n.rowData)[0].cells.filter(function(n){return n.rowID}),p=it.render(ut[u],n.rowData,{index:n.row?n.row.getAttribute("aria-rowindex"):0});(o=p.firstElementChild).setAttribute("textAlign",p.getAttribute("textAlign"));s[t.uid]=o}else{var ft=t.valueAccessor(t.field,n.rowData,t),w={column:t,value:ft,type:n.requestType,data:n.rowData},c=t.edit.create,i=void 0;t.editTemplate?(i=this.parent.createElement("span",{attrs:{"e-mappinguid":t.uid}}),e=this.parent.element.id+t.uid+"editTemplate",l=ro({},n.rowData,{column:t}),this.parent.isReact&&"string"!=typeof t.editTemplate?(t.getEditTemplate()(Object(r.extend)({index:n.rowIndex},l),this.parent,"editTemplate",e,null,null,i),this.parent.renderTemplates()):rt(i,t.getEditTemplate()(Object(r.extend)({index:n.rowIndex},l),this.parent,"editTemplate",e)),Object(r.isBlazor)()&&Object(r.updateBlazorTemplate)(e,"EditTemplate",t,!0,function(n){var t=n;return function(){g.parent.editModule.formObj.rules[t.field]=t.validationRules}}(t))):("string"==typeof(i="string"==typeof c?(c=k(c,window))(w):t.edit.create(w))&&((o=this.parent.createElement("div")).innerHTML=i,i=o.firstChild),d="input"!==i.tagName&&i.querySelectorAll("input").length,a=b(t.field),Object(r.attributes)(d?i.querySelector("input"):i,{name:a,"e-mappinguid":t.uid,id:f.element.id+a}),Object(r.classList)(i,["e-input","e-field"],[]),"Right"===t.textAlign&&i.classList.add("e-ralign"),((t.isPrimaryKey||t.isIdentity)&&"beginEdit"===n.requestType||t.isIdentity&&"add"===n.requestType)&&i.setAttribute("disabled",""));s[t.uid]=i}return s},n.prototype.destroy=function(){this.renderer.removeEventListener()},n}(),hd=function(){function n(n){this.activeClasses=["e-selectionbackground","e-active"];this.parent=n}return n.prototype.create=function(n){var i=n.column,r="e-field e-boolcell",t;return"checkbox"===i.type&&(r="e-field e-boolcell e-edit-checkselect"),t=b(n.column.field),this.parent.createElement("input",{className:r,attrs:{type:"checkbox",value:n.value,"e-mappinguid":i.uid,id:this.parent.element.id+t,name:t}})},n.prototype.read=function(n){return n.checked},n.prototype.write=function(n){var u,t,i;"add"===n.requestType||n.row.classList.contains("e-addedrow");(Object(r.isNullOrUndefined)(n.row)||(u=n.row.querySelector(".e-edit-checkselect")),k(n.column.field,n.rowData)&&(t=JSON.parse(k(n.column.field,n.rowData).toString().toLowerCase())),Object(r.isNullOrUndefined)(u)||"checkbox"!==n.column.type)||((this.editType=this.parent.editSettings.mode,this.editRow=n.row,"add"!==n.requestType)&&(i=this.parent.getRowObjectFromUID(n.row.getAttribute("data-uid")),t=!!i&&i.isSelected),yt.apply(void 0,[[].slice.call(n.row.querySelectorAll(".e-rowcell")),t].concat(this.activeClasses)));this.obj=new gt.CheckBox(Object(r.extend)({label:"Dialog"!==this.parent.editSettings.mode?" ":n.column.headerText,checked:t,disabled:!ci(n.column,n.requestType,n.element),enableRtl:this.parent.enableRtl,change:this.checkBoxChange.bind(this)},n.column.edit.params));Object(r.isBlazor)()&&(this.obj.locale=this.parent.locale);this.obj.appendTo(n.element)},n.prototype.checkBoxChange=function(n){if(this.editRow&&"Dialog"!==this.editType){var t=!1;n.checked?(t=!0,this.editRow.setAttribute("aria-selected",t.toString())):this.editRow.removeAttribute("aria-selected");yt.apply(void 0,[[].slice.call(this.editRow.querySelectorAll(".e-rowcell")),t].concat(this.activeClasses))}},n.prototype.destroy=function(){this.obj&&this.obj.destroy()},n}(),cd=function(){function n(n){this.parent=n;this.flag=!1}return n.prototype.create=function(n){var t=b(n.column.field);return this.parent.createElement("input",{className:"e-field",attrs:{id:this.parent.element.id+t,name:t,type:"text","e-mappinguid":n.column.uid}})},n.prototype.write=function(n){this.column=n.column;var t="Dialog"!==this.parent.editSettings.mode,i=new e.Predicate(n.column.field,"notequal",null,!0,!1);this.obj=new li.DropDownList(Object(r.extend)({dataSource:this.parent.dataSource instanceof e.DataManager?this.parent.dataSource:new e.DataManager(this.parent.dataSource),query:(new e.Query).where(i).select(n.column.field),enabled:ci(n.column,n.requestType,n.element),fields:{value:n.column.field},value:k(n.column.field,n.rowData),enableRtl:this.parent.enableRtl,actionComplete:this.ddActionComplete.bind(this),created:this.dropdownCreated.bind(this),placeholder:t?"":n.column.headerText,popupHeight:"200px",floatLabelType:t?"Never":"Always",open:this.dropDownOpen.bind(this),sortOrder:"Ascending"},n.column.edit.params));this.obj.query.params=this.parent.query.params;Object(r.isBlazor)()&&(this.obj.locale=this.parent.locale);this.obj.appendTo(n.element);n.element.setAttribute("name",b(n.column.field))},n.prototype.read=function(n){return n.ej2_instances[0].value},n.prototype.dropdownCreated=function(){this.flag=!0},n.prototype.ddActionComplete=function(n){n.result=e.DataUtil.distinct(n.result,this.obj.fields.value,!0);this.flag&&this.column.dataSource&&("result"in this.column.dataSource?this.column.dataSource.result=n.result:this.column.dataSource instanceof e.DataManager&&(this.column.dataSource.dataSource.json=n.result));this.flag=!1},n.prototype.dropDownOpen=function(n){var t=o(this.obj.element,"e-dialog"),i;"Dialog"!==this.parent.editSettings.mode||Object(r.isNullOrUndefined)(t)||(i=Object(r.select)("#"+t.id,document).ej2_instances[0],n.popup.element.style.zIndex=(i.zIndex+1).toString())},n.prototype.destroy=function(){this.obj&&this.obj.destroy()},n}(),ld=function(){function n(n){this.parent=n}return n.prototype.keyEventHandler=function(n){if(13===n.keyCode||9===n.keyCode){var t=document.createEvent("HTMLEvents");t.initEvent("change",!1,!0);this.dispatchEvent(t)}},n.prototype.create=function(n){var t=b(n.column.field);return this.instances=new r.Internationalization(this.parent.locale),this.parent.createElement("input",{className:"e-field",attrs:{id:this.parent.element.id+t,name:t,"e-mappinguid":n.column.uid}})},n.prototype.read=function(){return this.obj.value},n.prototype.write=function(n){var t=n.column,i="Dialog"!==this.parent.editSettings.mode;this.obj=new rr.NumericTextBox(Object(r.extend)({value:parseFloat(k(n.column.field,n.rowData)),enableRtl:this.parent.enableRtl,placeholder:i?"":n.column.headerText,enabled:ci(n.column,n.requestType,n.element),floatLabelType:"Dialog"!==this.parent.editSettings.mode?"Never":"Always",locale:this.parent.locale},t.edit.params));n.element.setAttribute("name",b(n.column.field));this.obj.appendTo(n.element);this.obj.element.addEventListener("keydown",this.keyEventHandler)},n.prototype.destroy=function(){this.obj&&!this.obj.isDestroyed&&(this.obj.element.removeEventListener("keydown",this.keyEventHandler),this.obj.destroy())},n}(),ad=function(){function n(n){this.parent=n}return n.prototype.create=function(n){var t=n.column;return this.parent.createElement("input",{className:"e-field e-input e-defaultcell",attrs:{type:"text",value:Object(r.isNullOrUndefined)(n.value)?"":n.value,"e-mappinguid":t.uid,id:this.parent.element.id+b(t.field),name:b(t.field),style:"text-align:"+t.textAlign}})},n.prototype.read=function(n){return n.value},n.prototype.write=function(n){var t=n.column,i="Dialog"!==this.parent.editSettings.mode;this.obj=new rr.TextBox(Object(r.extend)({element:n.element,floatLabelType:"Dialog"!==this.parent.editSettings.mode?"Never":"Always",enableRtl:this.parent.enableRtl,enabled:ci(n.column,n.requestType,n.element),placeholder:i?"":n.column.headerText},t.edit.params));this.obj.appendTo(n.element)},n.prototype.destroy=function(){this.obj&&this.obj.destroy()},n}(),yv=function(){function n(n,t,i){this.args={};this.currentVirtualData={};this.parent=n;this.renderer=i;this.serviceLocator=t;this.addEventListener()}return n.prototype.clickHandler=function(n){var t=n.target,i=this.parent;(o(t,"e-gridcontent")&&o(o(t,"e-gridcontent"),"e-grid").id===i.element.id||i.frozenRows&&o(t,"e-headercontent"))&&!o(t,"e-unboundcelldiv")&&(this.rowIndex=o(t,"e-rowcell")?parseInt(t.parentElement.getAttribute("aria-rowindex"),10):-1,i.isEdit&&i.editModule.endEdit())},n.prototype.dblClickHandler=function(n){o(n.target,"e-rowcell")&&this.parent.editSettings.allowEditOnDblClick&&this.parent.editModule.startEdit(o(n.target,"e-row"))},n.prototype.editComplete=function(n){this.parent.isEdit=!1;switch(Object(r.isBlazor)()&&!this.parent.isJsComponent&&(n.rows=null),n.requestType){case"save":(this.parent.isCheckBoxSelection||"Multiple"===this.parent.selectionSettings.type)&&this.parent.isPersistSelection||"edit"!==n.action&&this.parent.selectRow(0);this.parent.trigger(c,Object(r.extend)(n,{requestType:"save",type:c}));break;case"delete":if(Object(r.isBlazor)()&&!this.parent.isJsComponent){var t="data";n[t]=n[t][0]}this.parent.trigger(c,Object(r.extend)(n,{requestType:"delete",type:c}));this.parent.isCheckBoxSelection||this.parent.selectRow(this.editRowIndex)}},n.prototype.startEdit=function(n){var i=this,t=this.parent,f=t.getPrimaryKeyFieldNames(),v=[],y,e,u,o,p,s,h,a;if((this.rowIndex=this.editRowIndex=parseInt(n.getAttribute("aria-rowindex"),10),!t.enableVirtualization&&!t.enableInfiniteScrolling)||(y='.e-row[aria-rowindex="'+this.rowIndex+'"]',this.parent.element.querySelector(y))){if(Object(r.isBlazor)())for(e=this.parent.getColumns(),u=0;u<e.length;u++)o=e[u],o.template&&Object(r.resetBlazorTemplate)(t.element.id+o.uid,"Template",this.rowIndex);for(nt(t)?(p=t.getRowObjectFromUID(n.getAttribute("data-uid")),this.previousData=p.data):this.parent.enableVirtualization||this.parent.enableInfiniteScrolling?(s={data:this.previousData,index:this.rowIndex},this.parent.notify(se,s),this.previousData=s.data):this.previousData=t.getCurrentViewRecords()[this.rowIndex],u=0;u<f.length;u++)v.push(k(f[u],this.previousData));this.uid=n.getAttribute("data-uid");h=t.getRowObjectFromUID(this.uid);a={primaryKey:f,primaryKeyValue:v,requestType:"beginEdit",rowData:this.previousData,rowIndex:this.rowIndex,type:"edit",cancel:!1,foreignKeyData:h&&h.foreignKeyData,target:void 0};Object(r.isBlazor)()&&!this.parent.isJsComponent||(a.row=n);t.trigger(cy,a,function(u){u.type="actionBegin";t.trigger(l,u,function(u){u.cancel||(t.isEdit=!0,u.row=u.row?u.row:n,Object(r.isBlazor)()&&t.isServerRendered&&(i.originalRow=u.row,i.cloneRow=u.row.cloneNode(!0),u.cloneRow=i.cloneRow),"Dialog"!==t.editSettings.mode&&t.clearSelection(),"Dialog"===t.editSettings.mode&&t.selectionModule&&(t.selectionModule.preventFocus=!0,u.row.classList.add("e-dlgeditrow")),i.renderer.update(u),Object(r.isBlazor)()&&(u.form=null,i.cloneFrozen=u.cloneFrozen,i.frozen=u.frozen,i.cloneRow=u.cloneRow,i.originalRow=u.row),i.uid=n.getAttribute("data-uid"),t.editModule.applyFormValidation(),u.type="actionComplete",t.trigger(c,u),i.args=u,i.parent.allowTextWrap&&i.parent.notify(ki,{"case":"textwrap"}),Object(r.isBlazor)()&&(i.parent.notify(lt,{}),t.element.querySelector(".e-gridpopup").style.display="none",i.parent.notify("start-edit",{})))})})}},n.prototype.updateRow=function(n,t){var u=this,i=this.parent,r;this.editRowIndex=n;r={requestType:"save",action:"edit",type:l,data:t,cancel:!1,previousData:i.getCurrentViewRecords()[n],row:i.getRowByIndex(n)};i.showSpinner();i.notify(du,r);r.promise?r.promise.then(function(){return i.refresh()}).catch(function(n){return u.edFail(n)}):i.refresh()},n.prototype.editFormValidate=function(){var n=this.parent,t=n.editModule.formObj.validate(),i=!n.editModule.mFormObj||n.editModule.mFormObj.validate();return t&&i},n.prototype.endEdit=function(){var n=this.parent,e,o,u;if(this.parent.isEdit&&this.editFormValidate()){var i=Object(r.extend)({},{},this.previousData,!0),t=Object(r.extend)(this.args,{requestType:"save",type:l,data:i,cancel:!1,previousData:this.previousData,selectedRow:n.selectedRowIndex,foreignKeyData:{}}),s="Dialog"===n.editSettings.mode,h=Object(r.select)("#"+n.element.id+"_dialogEdit_wrapper",document),c=s?h.querySelector(".e-gridform"):n.element.querySelector(".e-gridform"),f={virtualData:{},isAdd:!1};if((this.parent.notify(eu,f),!this.parent.enableVirtualization&&!this.parent.enableInfiniteScrolling||"Normal"!==this.parent.editSettings.mode||c?i=n.editModule.getCurrentEditedData(c,i):this.parent.isEdit&&(this.currentVirtualData=i=t.data=f.virtualData),n.getFrozenColumns()&&"Normal"===n.editSettings.mode)&&(e=n.element.querySelector(".e-movableheader").querySelector(".e-gridform"),n.frozenRows&&e?i=n.editModule.getCurrentEditedData(e,i):(o=n.element.querySelector(".e-movablecontent").querySelector(".e-gridform"))&&(i=n.editModule.getCurrentEditedData(o,i))),Object(r.isBlazor)()&&(t[o="form"]=null,t.movableForm=null,t.row={}),u=[].slice.call(n.element.querySelectorAll(".e-editedrow")).length,f.isAdd||!Object.keys(this.currentVirtualData).length||u||(u=1),s?h.querySelectorAll(".e-editedrow").length:u)t.action="edit",n.trigger(l,t,function(t){t.cancel||(n.showSpinner(),n.notify(du,t))});else if(t.action="add",t.selectedRow=0,t.index=this.addedRowIndex,n.notify(ff,{}),n.notify(p,t),this.addedRowIndex=null,t.cancel)return}},n.prototype.destroyElements=function(){var n=this.parent;n.editModule.destroyWidgets();n.editModule.destroyForm();this.parent.notify(te,{})},n.prototype.editHandler=function(n){var t=this;n.promise?n.promise.then(function(i){return t.edSucc(i,n)}).catch(function(n){return t.edFail(n)}):this.editSuccess(n.data,n)},n.prototype.edSucc=function(n,t){this.editSuccess(n,t)},n.prototype.edFail=function(n){Object(r.isBlazor)()&&this.parent.isServerRendered&&(Object(r.isNullOrUndefined)(n.error)||Object(r.isNullOrUndefined)(n.error.message)||(n.error=n.error.message));this.editFailure(n)},n.prototype.updateCurrentViewData=function(n){this.parent.enableVirtualization||this.parent.enableInfiniteScrolling||(this.parent.getCurrentViewRecords()[this.editRowIndex]=n)},n.prototype.requestSuccess=function(n){this.parent.editModule.formObj&&!this.parent.editModule.formObj.isDestroyed&&(this.destroyElements(),this.stopEditStatus(),"Dialog"===this.parent.editSettings.mode&&"add"!==n.action&&this.parent.element.querySelector(".e-dlgeditrow").classList.remove("e-dlgeditrow"))},n.prototype.editSuccess=function(n,t){var i,u;Object(r.isNullOrUndefined)(n)||n instanceof Array||(t.data=Object(r.extend)({},Object(r.extend)({},t.rowData,t.data),n));(this.requestSuccess(t),this.parent.trigger(ac,t),t.type=c,this.parent.isEdit=!1,Object(r.isBlazor)()&&this.parent.isServerRendered)?(this.closeForm(),u="rowIndex",i={requestType:t.requestType,rowIndex:t[u],action:t.action,data:t.data},this.parent.notify("editsuccess",i)):this.refreshRow(t.data);(this.parent.notify(ff,t),this.parent.editModule.checkLastRow(t.row),this.parent.editModule.isLastRow=!1,this.updateCurrentViewData(t.data),this.blazorTemplate(),Object(r.isBlazor)()&&this.parent.isServerRendered||(this.editRowIndex=null,this.parent.trigger(c,t)),Object(r.isBlazor)()&&this.parent.notify(lt,{}),(this.parent.isCheckBoxSelection||"Multiple"===this.parent.selectionSettings.type)&&(this.parent.isPersistSelection||this.parent.selectionSettings.checkboxOnly))||"Dialog"!==this.parent.editSettings.mode&&(Object(r.isBlazor)()&&this.parent.isServerRendered?i[u="editRowIndex"]=this.rowIndex>-1?this.rowIndex:this.editRowIndex:this.parent.selectRow(this.rowIndex>-1?this.rowIndex:this.editRowIndex));this.parent.hideSpinner()},n.prototype.closeForm=function(){!this.cloneRow&&this.parent.isEdit&&this.stopEditStatus();this.cloneRow&&(this.cloneRow.remove(),this.cloneRow=null,this.originalRow.classList.remove("e-hiddenrow"));this.parent.getFrozenColumns()&&this.cloneFrozen&&(this.cloneFrozen.remove(),this.frozen.classList.remove("e-hiddenrow"))},n.prototype.blazorTemplate=function(){var i=this.parent.getColumns(),t,n;for(this.parent.editSettings.template&&"Normal"===this.parent.editSettings.mode&&Object(r.updateBlazorTemplate)(this.parent.element.id+"editSettingsTemplate","Template",this.parent.editSettings),t=0;t<i.length;t++)n=i[t],n.template&&Object(r.updateBlazorTemplate)(this.parent.element.id+n.uid,"Template",n,!1),n.editTemplate&&Object(r.updateBlazorTemplate)(this.parent.element.id+n.uid+"editTemplate","EditTemplate",n)},n.prototype.editFailure=function(n){this.parent.trigger(hi,Object(r.isBlazor)()&&n instanceof Array?n[0]:{error:n});this.parent.hideSpinner();this.parent.log("actionfailure",{error:n})},n.prototype.needRefresh=function(){var n=!0,t=this.parent.element.querySelector(".e-gridform");return!this.parent.enableVirtualization&&!this.parent.infiniteScrollSettings.enableCache||"Normal"!==this.parent.editSettings.mode||t||(n=!1),n},n.prototype.refreshRow=function(n){var f=this.parent.getFrozenColumns(),u=new dt(this.serviceLocator,null,this.parent),t=this.parent.getRowObjectFromUID(this.uid),r,i;t&&(t.changes=n,this.parent.notify(he,n),ge(t,this.parent.getForeignKeyColumns(),t.changes),this.needRefresh()&&u.refresh(t,this.parent.getColumns(),!0),f)&&(r=void 0,i=this.parent.element.querySelector("[data-uid="+t.uid+"]"),r=o(i,"e-frozencontent")||o(i,"e-frozenheader")?this.parent.infiniteScrollSettings.enableCache?this.parent.getMovableRowByIndex(t.index).getAttribute("data-uid"):this.parent.getMovableRows()[t.index].getAttribute("data-uid"):this.parent.infiniteScrollSettings.enableCache?this.parent.getRowByIndex(t.index).getAttribute("data-uid"):this.parent.getRows()[t.index].getAttribute("data-uid"),(t=this.parent.getRowObjectFromUID(r)).changes=n,u.refresh(t,this.parent.columns,!0),this.parent.editModule.checkLastRow(i))},n.prototype.closeEdit=function(){var t=this,n,i;this.parent.isEdit&&(n=this.parent,i=Object(r.extend)(this.args,{requestType:"cancel",type:l,cancel:!1,data:this.previousData,selectedRow:n.selectedRowIndex}),(n.notify(dl,i),this.blazorTemplate(),Object(r.isBlazor)())&&(i.form=null),n.trigger(l,i,function(i){if(!i.cancel){"Dialog"===t.parent.editSettings.mode&&t.parent.notify(te,{});n.isEdit=!1;t.stopEditStatus();i.type=c;"Dialog"!==n.editSettings.mode&&(Object(r.isBlazor)()&&n.isServerRendered?t.closeForm():t.refreshRow(i.data));var u=n.groupSettings.enableLazyLoading&&n.groupSettings.columns.length&&!n.getContentTable().querySelector("tr.e-emptyrow");n.getContentTable().querySelector("tr.e-emptyrow")||n.getContentTable().querySelector("tr.e-row")||u||n.renderModule.emptyRow();"Dialog"!==n.editSettings.mode&&n.selectRow(t.rowIndex);n.trigger(c,i);Object(r.isBlazor)()&&(t.parent.notify(lt,{}),t.parent.notify("close-edit",{}))}}))},n.prototype.addRecord=function(n,t){var s=this,i=this.parent,f,u,o,h;if(this.addedRowIndex=t=Object(r.isNullOrUndefined)(t)?0:t,n)i.notify(p,{requestType:"save",type:l,data:n,selectedRow:0,action:"add",index:t});else if(!i.isEdit){for(this.previousData={},this.uid="",f=i.columnModel,u=0;u<f.length;u++)f[u].field&&e.DataUtil.setValue(f[u].field,f[u].defaultValue,this.previousData);o={cancel:!1,foreignKeyData:{},requestType:"add",data:this.previousData,type:l,index:t,rowData:this.previousData,target:void 0};h={virtualData:{}};(this.parent.notify(eu,h),(this.parent.enableVirtualization||this.parent.infiniteScrollSettings.enableCache)&&Object.keys(h.virtualData).length&&(o.data=o.rowData=h.virtualData),Object(r.isBlazor)())&&(o.form=null);i.trigger(l,o,function(n){n.cancel||(i.isEdit=!0,"Dialog"!==i.editSettings.mode&&i.clearSelection(),s.renderer.addNew(n),i.editModule.applyFormValidation(),n.type=c,n.row=i.element.querySelector(".e-addedrow"),i.trigger(c,n),Object(r.isBlazor)()&&(s.parent.notify(lt,{}),s.parent.notify("start-add",{})),s.args=n)})}},n.prototype.deleteRecord=function(n,t){var f,e,o,u,i,s;if(this.editRowIndex=this.parent.selectedRowIndex,t)for(t=t instanceof Array?t:[t],f=this.parent,e=Object.keys(t).length,n=n||this.parent.getPrimaryKeyFieldNames()[0],o=function(i){var r,u,e=f.currentViewData.some(function(r){return u=r,t[i]===k(n,r)||t[i]===r});t[i]=e?u:((r={})[n]=t[i],r)},u=0;u<e;u++)o(u);i={requestType:"delete",type:l,foreignKeyData:{},data:t||this.parent.getSelectedRecords(),tr:this.parent.getSelectedRows(),cancel:!1};(Object(r.isNullOrUndefined)(this.parent.commandDelIndex)||(i.data[0]=this.parent.getRowObjectFromUID(this.parent.getRowByIndex(this.parent.commandDelIndex).getAttribute("data-uid")).data),this.parent.enableVirtualization&&i.data.length>1)&&(s=this.parent.getSelectedRows()[0].getAttribute("data-uid"),i.data=[this.parent.getRowObjectFromUID(s).data]);Object(r.isBlazor)()&&!this.parent.isJsComponent&&(i.data=i.data[0]);this.parent.notify(p,i)},n.prototype.stopEditStatus=function(){var i,u,n=this.parent,t=n.element.querySelector(".e-addedrow");n.getFrozenColumns()&&(i=n.element.querySelectorAll(".e-addedrow")[1],u=n.element.querySelectorAll(".e-editedrow")[1],i&&Object(r.remove)(i),u&&u.classList.remove("e-editedrow"));t&&Object(r.remove)(t);(t=n.element.querySelector(".e-editedrow"))&&t.classList.remove("e-editedrow")},n.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(wo,this.editHandler,this),this.parent.on(gu,this.dblClickHandler,this),this.parent.on(it,this.clickHandler,this),this.parent.on(ee,this.requestSuccess,this),this.parent.on(vr,this.dblClickHandler,this),this.parent.on(po,this.editComplete,this),this.parent.on(yo,this.editComplete,this),this.parent.on("closeinline",this.closeForm,this))},n.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(wo,this.editHandler),this.parent.off(gu,this.dblClickHandler),this.parent.off(it,this.clickHandler),this.parent.off(ee,this.requestSuccess),this.parent.off(vr,this.dblClickHandler),this.parent.off(po,this.editComplete),this.parent.off(yo,this.editComplete),this.parent.off("closeinline",this.closeForm))},n.prototype.destroy=function(){this.removeEventListener();this.renderer.destroy()},n}(),bit=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),pv=function(n){function t(t,i,r){var u=n.call(this,t,i)||this;return u.parent=t,u.serviceLocator=i,u.renderer=r,u}return bit(t,n),t.prototype.closeEdit=function(){n.prototype.closeEdit.call(this)},t.prototype.addRecord=function(t,i){n.prototype.addRecord.call(this,t,i)},t.prototype.endEdit=function(){n.prototype.endEdit.call(this)},t.prototype.updateRow=function(t,i){n.prototype.updateRow.call(this,t,i)},t.prototype.deleteRecord=function(t,i){n.prototype.deleteRecord.call(this,t,i)},t.prototype.startEdit=function(t){n.prototype.startEdit.call(this,t)},t}(yv),vd=function(){function n(n,t,i){this.cellDetails={};this.originalCell={};this.cloneCell={};this.editNext=!1;this.preventSaveCell=!1;this.parent=n;this.serviceLocator=t;this.renderer=i;this.focus=t.getService("focus");this.addEventListener()}return n.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(it,this.clickHandler,this),this.parent.on(vr,this.dblClickHandler,this),this.parent.on(hr,this.onBeforeCellFocused,this),this.parent.on(cr,this.onCellFocused,this),this.dataBoundFunction=this.dataBound.bind(this),this.batchCancelFunction=this.batchCancel.bind(this),this.parent.addEventListener(ct,this.dataBoundFunction),this.parent.addEventListener(gr,this.batchCancelFunction),this.parent.on(gu,this.dblClickHandler,this),this.parent.on(w,this.keyDownHandler,this),this.parent.on(rf,this.editNextValCell,this),this.parent.on("closebatch",this.closeForm,this))},n.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(it,this.clickHandler),this.parent.off(vr,this.dblClickHandler),this.parent.off(hr,this.onBeforeCellFocused),this.parent.off(cr,this.onCellFocused),this.parent.removeEventListener(ct,this.dataBoundFunction),this.parent.removeEventListener(gr,this.batchCancelFunction),this.parent.off(gu,this.dblClickHandler),this.parent.off(w,this.keyDownHandler),this.parent.off(rf,this.editNextValCell),this.parent.off("closebatch",this.closeForm))},n.prototype.batchCancel=function(){this.parent.focusModule.restoreFocus()},n.prototype.dataBound=function(){this.parent.notify(lt,{})},n.prototype.destroy=function(){this.removeEventListener()},n.prototype.clickHandler=function(n){o(n.target,this.parent.element.id+"_add",!0)||(this.parent.isEdit&&Object(r.closest)(this.form,"td")!==Object(r.closest)(n.target,"td")&&(this.saveCell(),this.editNextValCell()),o(n.target,"e-rowcell")&&!this.parent.isEdit&&this.setCellIdx(n.target))},n.prototype.dblClickHandler=function(n){var t=o(n.target,"e-rowcell"),i=o(n.target,"e-row");t&&i&&!isNaN(parseInt(t.getAttribute("aria-colindex"),10))&&!t.parentElement.classList.contains("e-editedrow")&&this.editCell(parseInt(i.getAttribute("aria-rowindex"),10),this.parent.getColumns()[parseInt(t.getAttribute("aria-colindex"),10)].field,this.isAddRow(parseInt(i.getAttribute("aria-rowindex"),10)))},n.prototype.onBeforeCellFocused=function(n){this.parent.isEdit&&this.validateFormObj()&&(n.byClick||["tab","shiftTab","enter","shiftEnter"].indexOf(n.keyArgs.action)>-1)&&(n.cancel=!0,n.byClick?n.clickArgs.preventDefault():n.keyArgs.preventDefault())},n.prototype.onCellFocused=function(n){var f=this.parent.getFrozenColumns(),s=this.parent.getContent().querySelector(".e-movablecontent"),h=this.parent.getHeaderContent().querySelector(".e-movableheader"),e=!(n.container.isContent&&n.container.isDataCell||this.parent.frozenRows&&n.container.isHeader),t,u;if(n.byKey&&!e){var o=n.container.indexes,i=o[0],r=o[1];if(f&&(s.contains(n.element)||this.parent.frozenRows&&h.contains(n.element))&&(r+=f),this.parent.frozenRows&&n.container.isContent&&(i+=this.parent.frozenRows),t=this.parent.isEdit,!this.parent.element.querySelectorAll(".e-popup-open").length)switch(t=t&&!this.validateFormObj(),n.keyArgs.action){case"tab":case"shiftTab":u=this.parent.getColumns()[n.indexes[1]];u&&!this.parent.isEdit&&this.editCell(n.indexes[0],u.field);(t||this.parent.isLastCellPrimaryKey)&&this.editCellFromIndex(i,r);break;case"enter":case"shiftEnter":n.keyArgs.preventDefault();t&&this.editCell(i,this.cellDetails.column.field);break;case"f2":this.editCellFromIndex(i,r);this.focus.focus()}}else this.parent.isEdit&&e&&this.saveCell()},n.prototype.isAddRow=function(n){return this.parent.getDataRows()[n].classList.contains("e-insertedrow")},n.prototype.editCellFromIndex=function(n,t){this.cellDetails.rowIndex=n;this.cellDetails.cellIndex=t;this.editCell(n,this.parent.getColumns()[t].field,this.isAddRow(n))},n.prototype.closeEdit=function(){var n=this.parent,i=this.parent.getRowsObject(),c={cancel:!1,batchChanges:this.getBatchChanges()},s,t,e,u,f,l,a,o,h;if(n.notify(iw,c),!c.cancel){if(n.frozenColumns&&i.length<2*this.parent.currentViewData.length&&(!Object(r.isBlazor)()||!n.isServerRendered)&&i.push.apply(i,this.parent.getMovableRowsObject()),s=this.parent.getColumns(),Object(r.isBlazor)())for(t=0;t<s.length;t++)e=s[t],e.template&&Object(r.updateBlazorTemplate)(this.parent.element.id+e.uid,"Template",e,!1);for(l=new dt(this.serviceLocator,null,this.parent),n.isEdit&&this.saveCell(!0),this.isAdded=!1,n.clearSelection(),t=0;t<i.length;t++)i[t].isDirty&&(n.frozenColumns&&(n.getMovableRowsObject()[i[t].index].isDirty=!0),u=n.getContentTable().querySelector("[data-uid="+i[t].uid+"]"),n.frozenRows&&!u&&(u=n.getHeaderContent().querySelector("[data-uid="+i[t].uid+"]")),n.frozenColumns&&(n.frozenRows&&(f=n.getHeaderContent().querySelector(".e-movableheader").querySelector("[data-uid="+i[t].uid+"]"))||(f=n.getContent().querySelector(".e-movablecontent").querySelector("[data-uid="+i[t].uid+"]"))),u||f)&&(u&&u.classList.contains("e-insertedrow")||f&&f.classList.contains("e-insertedrow")?(u&&Object(r.remove)(u),f&&(n.frozenColumns||n.frozenRows)&&Object(r.remove)(f),this.removeRowObjectFromUID(i[t].uid),t--):(ge(i[t],this.parent.getForeignKeyColumns(),i[t].data),delete i[t].changes,delete i[t].edit,i[t].isDirty=!1,a=f||u,Object(r.isBlazor)()&&n.isServerRendered?(n.getFrozenColumns()&&this.removeHideAndSelection(f),this.removeHideAndSelection(u),this.closeForm()):(Object(r.classList)(a,[],["e-hiddenrow","e-updatedtd"]),l.refresh(i[t],n.getColumns(),!1))),this.parent.aggregates.length>0&&(o=[],o.type="cancel",this.parent.notify(ai,o),this.parent.groupSettings.columns.length>0&&this.parent.notify(pi,o)));Object(r.isBlazor)()&&n.isServerRendered&&n.selectRow(n.selectionModule.prevRowIndex);n.getContentTable().querySelector("tr.e-row")||n.renderModule.renderEmptyRow();h=this.parent.getRowsObject();n.notify(gr,{rows:this.parent.getRowsObject().length?this.parent.getRowsObject():[new kt({isDataRow:!0,cells:[new st({isDataCell:!0,visible:!0})]})]});n.selectRow(this.cellDetails.rowIndex);this.refreshRowIdx();n.notify(lt,{});this.parent.notify(bi,{});h={requestType:"batchCancel",rows:this.parent.getRowsObject()};n.trigger(gr,h);n.frozenColumns&&i.splice(this.parent.getMovableRowsObject().length,i.length)}},n.prototype.removeHideAndSelection=function(n){if(n.classList.contains("e-hiddenrow")){n.removeAttribute("aria-selected");for(var i=[].slice.call(n.querySelectorAll(".e-selectionbackground")),t=0;t<i.length;t++)Object(r.removeClass)([i[t]],["e-selectionbackground","e-active"])}Object(r.classList)(n,[],["e-hiddenrow","e-updatedtd"])},n.prototype.deleteRecord=function(n,t){this.saveCell();this.validateFormObj()&&this.saveCell(!0);this.isAdded=!1;this.bulkDelete(n,t);this.parent.aggregates.length>0&&(this.parent.notify(ai,{}),this.parent.groupSettings.columns.length>0&&this.parent.notify(pi,{}))},n.prototype.addRecord=function(n){this.bulkAddRow(n)},n.prototype.endEdit=function(){this.parent.isEdit&&this.validateFormObj()||this.batchSave()},n.prototype.closeForm=function(){for(var t,n=0;n<Object.keys(this.originalCell).length;n++)for(t=0;t<Object.keys(this.cloneCell).length;t++)Object.keys(this.originalCell)[n]===Object.keys(this.cloneCell)[t]&&(this.cloneCell[Object.keys(this.cloneCell)[t]].replaceWith(this.originalCell[Object.keys(this.originalCell)[n]]),this.originalCell[Object.keys(this.originalCell)[n]].classList.contains("e-selectionbackground")&&this.originalCell[Object.keys(this.originalCell)[n]].classList.remove("e-selectionbackground","e-cellselectionbackground","e-active"));this.cloneCell={};this.originalCell={}},n.prototype.validateFormObj=function(){return this.parent.editModule.formObj&&!this.parent.editModule.formObj.validate()},n.prototype.batchSave=function(){var i=this,n=this.parent,e,o,u,f,t,s,h;if(n.isCheckBoxSelection&&(e=n.element.querySelector(".e-checkselectall").parentElement,e.classList.contains("e-checkbox-disabled")&&n.pageSettings.totalRecordsCount>n.currentViewData.length&&Object(r.removeClass)([e],["e-checkbox-disabled"])),o=this.parent.getColumns(),Object(r.isBlazor)())for(u=0;u<o.length;u++)f=o[u],f.template&&(r.blazorTemplates[this.parent.element.id+f.uid]=[],Object(r.resetBlazorTemplate)(this.parent.element.id+f.uid,"Template"));(this.saveCell(),n.isEdit||this.editNextValCell()||n.isEdit)||(t=this.getBatchChanges(),"Multiple"===this.parent.selectionSettings.type&&t.deletedRecords.length&&this.parent.selectionSettings.persistSelection&&(t.deletedRecords=this.removeSelectedData,this.removeSelectedData=[]),s={changedRecords:this.parent.getRowsObject().filter(function(n){return n.isDirty&&-1===["add","delete"].indexOf(n.edit)}).map(function(n){return n.data})},h={batchChanges:t,cancel:!1},n.trigger(hy,h,function(u){var f,o,e;if(!u.cancel){if(Object(r.isBlazor)()&&i.parent.isServerRendered){if(f=i.parent.getContent(),i.closeForm(),Object(r.removeClass)(f.querySelectorAll(".e-updatedtd"),["e-updatedtd"]),f.querySelector(".e-insertedrow, .e-hiddenrow"))for(Object(r.removeClass)(f.querySelectorAll(".e-hiddenrow"),["e-hiddenrow"]),o=[].slice.call(f.querySelectorAll(".e-insertedrow")),e=0;e<o.length;e++)o[e].remove();i.refreshRowIdx()}n.showSpinner();n.notify(el,{changes:t,original:s})}}))},n.prototype.getBatchChanges=function(){for(var n,t={addedRecords:[],deletedRecords:[],changedRecords:[]},i=0,r=this.parent.getRowsObject();i<r.length;i++)if(n=r[i],n.isDirty)switch(n.edit){case"add":t.addedRecords.push(n.changes);break;case"delete":t.deletedRecords.push(n.data);break;default:t.changedRecords.push(n.changes)}return t},n.prototype.removeRowObjectFromUID=function(n){for(var i=this.parent.getRowsObject(),t=0,r=i.length;t<r&&i[t].uid!==n;t++);i.splice(t,1)},n.prototype.addRowObject=function(n){var u="Top"===this.parent.editSettings.newRowPosition,i=this.parent.getFrozenColumns(),r,t;i&&(r=this.parent.getMovableRowsObject(),t=n.clone(),t.cells=t.cells.slice(i),n.cells=n.cells.slice(0,i),u?r.unshift(t):r.push(t));u?this.parent.getRowsObject().unshift(n):this.parent.getRowsObject().push(n)},n.prototype.bulkDelete=function(n,t){var f=this;this.removeSelectedData=[];var i=this.parent,e=i.selectedRowIndex,u=i.getSelectedRows(),s={primaryKey:this.parent.getPrimaryKeyFieldNames(),rowIndex:e,rowData:t||i.getSelectedRecords()[0],cancel:!1};(Object(r.isBlazor)()&&!this.parent.isJsComponent||(s.row=t?i.editModule.deleteRowUid?i.getRowElementByUID(i.editModule.deleteRowUid):i.getRows()[i.getCurrentViewRecords().indexOf(t)]:t?i.getRows()[e]:u[0],s.row))&&i.trigger(sy,s,function(n){var s,h,v,y,l,a,c;if(!n.cancel){if(f.removeSelectedData=i.getSelectedRecords(),i.clearSelection(),n.row=n.row?n.row:t?i.getRows()[e]:u[0],f.parent.getFrozenColumns()){for(t&&(e=parseInt(n.row.getAttribute("aria-rowindex"),10),u=[n.row],o(n.row,"e-frozencontent")||o(n.row,"e-frozenheader")?u=u.concat(i.getMovableRowByIndex(e)):(o(n.row,"e-movablecontent")||o(n.row,"e-movableheader"))&&(u=u.concat(i.getFrozenRowByIndex(e)))),s=0;s<u.length;s++)h=u[s].getAttribute("data-uid"),u[s].classList.contains("e-insertedrow")?(f.removeRowObjectFromUID(h),Object(r.remove)(u[s])):((c=i.getRowObjectFromUID(h)).isDirty=!0,c.edit="delete",Object(r.classList)(u[s],["e-hiddenrow","e-updatedtd"],[]),i.frozenRows&&e<i.frozenRows&&i.getMovableDataRows().length>=i.frozenRows&&(i.getHeaderContent().querySelector(".e-movableheader").querySelector("tbody").appendChild(i.getMovableRowByIndex(i.frozenRows-1)),i.getHeaderContent().querySelector(".e-frozenheader").querySelector("tbody").appendChild(i.getRowByIndex(i.frozenRows-1))),i.frozenRows&&e<i.frozenRows&&i.getDataRows().length>=i.frozenRows&&i.getHeaderContent().querySelector("tbody").appendChild(i.getRowByIndex(i.frozenRows-1))),delete u[s];v=i.getContent().querySelector(".e-frozencontent");y=i.getContent().querySelector(".e-movablecontent");v.style.height=y.offsetHeight-oi()+"px"}else if(f.parent.getFrozenColumns()||1!==u.length&&!t)for(s=0;s<u.length;s++)l=u[s].getAttribute("data-uid"),u[s].classList.contains("e-insertedrow")?(f.removeRowObjectFromUID(l),Object(r.remove)(u[s])):(Object(r.classList)(u[s],["e-hiddenrow","e-updatedtd"],[]),a=i.getRowObjectFromUID(l),a.isDirty=!0,a.edit="delete",delete u[s]);else h=n.row.getAttribute("data-uid"),(h=t&&f.parent.editModule.deleteRowUid?h=f.parent.editModule.deleteRowUid:h,n.row.classList.contains("e-insertedrow"))?(f.removeRowObjectFromUID(h),Object(r.remove)(n.row)):((c=i.getRowObjectFromUID(h)).isDirty=!0,c.edit="delete",Object(r.classList)(n.row,["e-hiddenrow","e-updatedtd"],[])),delete n.row;f.refreshRowIdx();t&&(i.editModule.deleteRowUid=void 0,i.getSelectedRows().length&&(e=parseInt(i.getSelectedRows()[0].getAttribute("aria-rowindex"),10)));i.isCheckBoxSelection||i.selectRow(e);i.trigger(df,n);i.notify(df,{rows:f.parent.getRowsObject()});i.notify(lt,{})}})},n.prototype.refreshRowIdx=function(){var t=[],i=[],r=[],f=this.parent.getFrozenColumns(),n,u,e;if(this.parent.frozenRows&&(t=[].slice.call(this.parent.getHeaderTable().querySelector("tbody").children),f))for(i=[].slice.call(this.parent.getHeaderContent().querySelector(".e-movableheader").querySelector("tbody").children),n=0;n<i.length;n++)r[n]=this.parent.createElement("tr",{className:"emptynonmv"});for(f&&(i=i.concat([].slice.call(this.parent.getContentTable().querySelector("tbody").children)),r=r.concat([].slice.call(this.parent.element.querySelector(".e-movablecontent").querySelector("tbody").children))),n=0,u=0,e=(t=t.concat([].slice.call(this.parent.getContentTable().querySelector("tbody").children))).length;n<e;n++)t[n].classList.contains("e-row")&&!t[n].classList.contains("e-hiddenrow")?(t[n].setAttribute("aria-rowindex",u.toString()),f&&(i[n].setAttribute("aria-rowindex",u.toString()),r[n].classList.contains("e-row")&&r[n].setAttribute("aria-rowindex",u.toString())),u++):(t[n].removeAttribute("aria-rowindex"),f&&i[n].removeAttribute("aria-rowindex"))},n.prototype.getIndexFromData=function(n){return cf(n,this.parent.getCurrentViewRecords())},n.prototype.bulkAddRow=function(n){var t=this,i=this.parent,u;i.editSettings.allowAdding&&(i.isEdit&&(this.saveCell(),this.parent.notify(rf,{})),!i.isEdit)&&(this.parent.element.classList.add("e-editing"),u={defaultData:n||this.getDefaultData(),primaryKey:i.getPrimaryKeyFieldNames(),cancel:!1},i.trigger(oy,u,function(u){var s,c,o,y,p,v,w,k;if(!u.cancel){t.isAdded=!0;i.clearSelection();for(var l,a,d=new dt(t.serviceLocator,null,t.parent),e=new vi(t.parent).generateRows([u.defaultData]),f=d.render(e[0],i.getColumns()),b=0;b<t.parent.groupSettings.columns.length;b++)f.insertBefore(t.parent.createElement("td",{className:"e-indentcell"}),f.firstChild),e[0].cells.unshift(new st({cellType:h.Indent}));o=i.getContentTable().querySelector("tbody");(f.classList.add("e-insertedrow"),o.querySelector(".e-emptyrow"))&&(y=o.querySelector(".e-emptyrow"),(y.parentNode.removeChild(y),t.parent.getFrozenColumns())&&(p=t.parent.getContent().querySelector(".e-movablecontent").querySelector("tbody"),p.firstElementChild.parentNode.removeChild(p.firstElementChild)));i.getFrozenColumns()&&(s=t.renderMovable(f),c=i.frozenRows&&"Top"===i.editSettings.newRowPosition?i.getHeaderContent().querySelector(".e-movableheader").querySelector("tbody"):i.getContent().querySelector(".e-movablecontent").querySelector("tbody"),"Top"===t.parent.editSettings.newRowPosition?c.insertBefore(s,c.firstChild):c.appendChild(s),Object(r.addClass)(s.querySelectorAll(".e-rowcell"),["e-updatedtd"]),"auto"===t.parent.height&&t.parent.notify(ru,{}));o=i.frozenRows&&"Top"===i.editSettings.newRowPosition?i.getHeaderContent().querySelector("tbody"):i.getContent().querySelector("tbody");"Top"===t.parent.editSettings.newRowPosition?o.insertBefore(f,o.firstChild):o.appendChild(f);Object(r.addClass)(f.querySelectorAll(".e-rowcell"),["e-updatedtd"]);e[0].isDirty=!0;e[0].changes=Object(r.extend)({},{},e[0].data,!0);e[0].edit="add";t.addRowObject(e[0]);t.refreshRowIdx();t.focus.forgetPrevious();i.notify(kf,{rows:t.parent.getRowsObject(),args:{isFrozen:t.parent.getFrozenColumns()}});v=t.getBatchChanges();w=t.parent.getCurrentViewRecords().length+v.addedRecords.length-v.deletedRecords.length-1;"Top"===t.parent.editSettings.newRowPosition?i.selectRow(0):i.selectRow(w);n||(a=t.findNextEditableCell(0,!0),l=i.getColumns()[a],"Top"===t.parent.editSettings.newRowPosition?t.editCell(0,l.field,!0):t.editCell(w,l.field,!0));t.parent.aggregates.length>0&&(n||v.addedRecords.length)&&t.parent.notify(ai,{});k={defaultData:u.defaultData,row:f,columnObject:l,columnIndex:a,primaryKey:u.primaryKey,cell:f.cells[a]};i.trigger(kf,k);i.getFrozenColumns()&&uv(s.querySelector("td:not(.e-hide)"),f.querySelector("td:not(.e-hide)"));Object(r.isBlazor)()&&(t.parent.notify(lt,{}),t.parent.notify("start-add",{}))}}))},n.prototype.renderMovable=function(n){for(var r,i=n.cloneNode(!0),t=0;t<this.parent.getFrozenColumns();t++)i.removeChild(i.children[0]);for(t=this.parent.getFrozenColumns(),r=n.childElementCount;t<r;t++)n.removeChild(n.children[n.childElementCount-1]);return i},n.prototype.findNextEditableCell=function(n,t,i){for(var e,f=this.parent.getColumns(),o=f.length,u=n;u<o;u++)if((e=!!i&&Object(r.isNullOrUndefined)(f[u].validationRules),!t&&this.checkNPCell(f[u]))||t&&!f[u].template&&f[u].visible&&f[u].allowEditing&&(!f[u].isIdentity||!f[u].isPrimaryKey)&&!e)return u;return-1},n.prototype.checkNPCell=function(n){return!n.template&&n.visible&&!n.isPrimaryKey&&!n.isIdentity&&n.allowEditing},n.prototype.getDefaultData=function(){for(var n,i={},f={number:0,string:null,boolean:!1,date:null,datetime:null},t=0,u=this.parent.columnModel;t<u.length;t++)n=u[t],n.field&&Object(r.setValue)(n.field,n.defaultValue?n.defaultValue:f[n.type],i);return i},n.prototype.setCellIdx=function(n){var t=0;this.parent.allowGrouping&&(t=this.parent.groupSettings.columns.length);this.cellDetails.cellIndex=n.cellIndex-t;this.cellDetails.rowIndex=parseInt(n.getAttribute("index"),10)},n.prototype.editCell=function(n,t,i){var u=this.parent,f=u.getColumnByField(t),e;this.index=n;this.field=t;this.isAdd=i;e=u.isEdit&&!(this.cellDetails.column.field===t&&this.cellDetails.rowIndex===n&&this.parent.getDataRows().length-1!==n);Object(r.isBlazor)()&&f.template&&!i&&Object(r.resetBlazorTemplate)(this.parent.element.id+f.uid,"Template",n);u.editSettings.allowEditing&&(!e&&f.allowEditing?this.editCellExtend(n,t,i):e&&(this.editNext=!0,this.saveCell()))},n.prototype.editCellExtend=function(n,t,i){var f=this,u=this.parent,e=u.getColumnByField(t),y=u.getPrimaryKeyFieldNames(),s,h,a,p,v;if(!u.isEdit)if(p=u.getColumnIndexByField(t),v=u.getFrozenColumns(),v&&p>=v?(s=u.getMovableDataRows()[n],a=this.parent.getRowObjectFromUID(this.parent.getMovableDataRows()[n].getAttribute("data-uid")),h=a.changes?Object(r.extend)({},{},a.changes,!0):Object(r.extend)({},{},this.getDataByIndex(n),!0)):(s=u.getDataRows()[n],h=Object(r.extend)({},{},this.getDataByIndex(n),!0)),y[0]===e.field&&!s.classList.contains("e-insertedrow")||e.columns||e.isPrimaryKey&&e.isIdentity)this.parent.isLastCellPrimaryKey=!0;else{this.parent.isLastCellPrimaryKey=!1;this.parent.element.classList.add("e-editing");var w=u.getRowObjectFromUID(s.getAttribute("data-uid")),l=[].slice.apply(s.cells),c={columnName:e.field,isForeignKey:!Object(r.isNullOrUndefined)(e.foreignKeyValue),primaryKey:y,rowData:h,validationRules:Object(r.extend)({},e.validationRules?e.validationRules:{}),value:k(e.field,h),type:i?"add":"edit",cancel:!1,foreignKeyData:w&&w.foreignKeyData};(Object(r.isBlazor)()&&!this.parent.isJsComponent||(c.cell=l[this.getColIndex(l,this.getCellIdx(e.uid))],c.row=s,c.columnObject=e,c.cell))&&u.trigger(ly,c,function(t){if(!t.cancel){if(t.cell=t.cell?t.cell:l[f.getColIndex(l,f.getCellIdx(e.uid))],t.row=t.row?t.row:s,t.columnObject=t.columnObject?t.columnObject:e,t.columnObject.index=Object(r.isNullOrUndefined)(t.columnObject.index)?0:t.columnObject.index,f.cellDetails={rowData:h,column:e,value:t.value,isForeignKey:t.isForeignKey,rowIndex:n,cellIndex:parseInt(t.cell.getAttribute("aria-colindex"),10),foreignKeyData:t.foreignKeyData},t.cell.classList.contains("e-updatedtd")&&(f.isColored=!0,t.cell.classList.remove("e-updatedtd")),Object(r.isBlazor)()&&u.isServerRendered){var i=t.row.querySelectorAll(".e-indentcell, .e-detailrowcollapse, .e-detailrowexpand, .e-rowdragdrop").length;f.cloneCell[""+f.cellDetails.rowIndex+t.columnObject.index]=t.cloneCell=t.cell.cloneNode(!0);o(t.cell,"e-movableheader")||o(t.cell,"e-movablecontent")?(t.row.insertCell(t.columnObject.index-u.getFrozenColumns()),t.row.replaceChild(t.cloneCell,t.row.cells[t.columnObject.index-u.getFrozenColumns()])):(t.row.insertCell(t.columnObject.index+i),t.row.replaceChild(t.cloneCell,t.row.cells[t.columnObject.index+i]));f.originalCell[""+f.cellDetails.rowIndex+t.columnObject.index]=t.cell.parentElement.removeChild(t.cell);Object(r.removeClass)([f.cloneCell[""+f.cellDetails.rowIndex+t.columnObject.index]],["e-focus","e-focused"])}u.isEdit=!0;u.clearSelection();u.isCheckBoxSelection&&u.isPersistSelection||u.selectRow(f.cellDetails.rowIndex,!0);f.renderer.update(t);f.parent.notify(rw,t);f.form=Object(r.select)("#"+u.element.id+"EditForm",u.element);u.editModule.applyFormValidation([e]);f.parent.element.querySelector(".e-gridpopup").style.display="none"}})}},n.prototype.updateCell=function(n,t,i){var u=this.parent.getColumnByField(t),e=this.parent.getColumnIndexByField(t),r,f;u&&!u.isPrimaryKey&&(r=this.parent.getDataRows()[n].querySelectorAll(".e-rowcell")[e],this.parent.getFrozenColumns()&&(r=[].slice.call(this.parent.getDataRows()[n].querySelectorAll(".e-rowcell")).concat([].slice.call(this.parent.getMovableDataRows()[n].querySelectorAll(".e-rowcell")))[e]),f=o(r,"e-movablecontent")?this.parent.getMovableRowsObject()[n]:this.parent.getRowObjectFromUID(r.parentElement.getAttribute("data-uid")),this.refreshTD(r,u,f,i),this.parent.trigger(eo,{cell:r,column:u,data:f.changes}))},n.prototype.setChanges=function(n,t,i,u){var f,c,h,s,l,a;this.parent.getFrozenColumns()?(c=this.parent.getRowElementByUID(n.uid),h=parseInt(c.getAttribute("aria-rowindex"),10),(f=this.parent.getRowsObject()[h]).changes||(f.changes=Object(r.extend)({},{},n.data,!0)),Object(r.isNullOrUndefined)(t)||Object(r.setValue)(t,i,f.changes),s=void 0,Object(r.isBlazor)()&&this.parent.isServerRendered&&(o(u,"e-movableheader")||o(u,"e-movablecontent"))?(l=this.parent.getMovableRowByIndex(this.cellDetails.rowIndex),a=parseInt(l.getAttribute("aria-rowindex"),10),s=this.parent.getMovableRowsObject()[a]):s=this.parent.getMovableRowsObject()[h],s.changes=Object(r.extend)({},{},f.changes,!0),n.data[t]!==i&&(s.isDirty=!0,f.isDirty=!0)):(n.changes||(n.changes=Object(r.extend)({},{},n.data,!0)),Object(r.isNullOrUndefined)(t)||e.DataUtil.setValue(t,i,n.changes),n.data[t]!==i&&(n.isDirty=!0))},n.prototype.updateRow=function(n,t){for(var u,i=0,r=Object.keys(t);i<r.length;i++)u=r[i],this.updateCell(n,u,t[u])},n.prototype.getCellIdx=function(n){var t=this.parent.getColumnIndexByUid(n)+this.parent.groupSettings.columns.length;return Object(r.isNullOrUndefined)(this.parent.detailTemplate)&&Object(r.isNullOrUndefined)(this.parent.childGrid)||t++,this.parent.isRowDragable()&&t++,t},n.prototype.refreshTD=function(n,t,i,u){var s,h=new ht(this.parent,this.serviceLocator),e,o,f;u="number"!==t.type||Object(r.isNullOrUndefined)(u)?u:parseFloat(u);this.setChanges(i,t.field,u,n);f=this.parent.getFrozenColumns();f=f&&this.parent.isRowDragable()?f+1:f;ge(i,this.parent.getForeignKeyColumns(),i.changes);s=f&&this.getCellIdx(t.uid)>=f&&this.parent.getColumns().length===i.cells.length?i.cells.slice(f,i.cells.length):i.cells;this.parent.isReact&&(e=n.parentElement,o=n.cellIndex);h.refreshTD(n,s[this.getCellIdx(t.uid)-(this.getCellIdx(t.uid)>=f?f:0)],i.changes,{index:this.getCellIdx(t.uid)});this.parent.isReact?(this.newReactTd=e.cells[o],e.cells[o].classList.add("e-updatedtd")):n.classList.add("e-updatedtd");n.classList.add("e-updatedtd");this.parent.notify(lt,{})},n.prototype.getColIndex=function(n,t){var u=0,i;for(this.parent.allowGrouping&&this.parent.groupSettings.columns&&(u=this.parent.groupSettings.columns.length),Object(r.isNullOrUndefined)(this.parent.detailTemplate)&&Object(r.isNullOrUndefined)(this.parent.childGrid)||u++,this.parent.isRowDragable()&&u++,i=0;i<n.length;i++)if(parseInt(n[i].getAttribute("aria-colindex"),10)===t-u)return i;return-1},n.prototype.editNextValCell=function(){var n=this.parent,r=this.getBatchChanges(),f=this.parent.getCurrentViewRecords().length+r.addedRecords.length-r.deletedRecords.length-1,i,u,t;if(this.isAdded&&!n.isEdit){for(i=this.cellDetails.cellIndex;i<n.getColumns().length;i++){if(n.isEdit)return;u=this.findNextEditableCell(this.cellDetails.cellIndex+1,!0,!0);t=n.getColumns()[u];t&&("Bottom"===this.parent.editSettings.newRowPosition?this.editCell(f,t.field,!0):this.editCell(0,t.field,!0),this.saveCell())}n.isEdit||(this.isAdded=!1)}},n.prototype.escapeCellEdit=function(){var n=this.generateCellArgs();n.value=n.previousValue;this.successCallBack(n,n.cell.parentElement,n.column,!0)(n)},n.prototype.generateCellArgs=function(){var o=this.parent,n,u,t,e,f,i;return this.parent.element.classList.remove("e-editing"),n=this.cellDetails.column,u={},u[n.field]=k(n.field,this.cellDetails.rowData),t=o.editModule.getCurrentEditedData(this.form,u),e=Object(r.extend)({},t),t=Object(r.extend)({},t,this.cellDetails.rowData),f=k(n.field,e),Object(r.isNullOrUndefined)(n.field)||Object(r.isUndefined)(f)||Object(r.setValue)(n.field,f,t),i={columnName:n.field,value:k(n.field,t),rowData:this.cellDetails.rowData,column:n,previousValue:this.cellDetails.value,isForeignKey:this.cellDetails.isForeignKey,cancel:!1},Object(r.isBlazor)()&&!this.parent.isJsComponent||(i.cell=this.form.parentElement,i.columnObject=n),i},n.prototype.saveCell=function(n){var i;if(!this.preventSaveCell&&(i=this.parent,n||i.isEdit&&!this.validateFormObj())){this.preventSaveCell=!0;var t=this.generateCellArgs(),u=Object(r.isBlazor)()?o(this.form,"e-row"):t.cell.parentElement,f=Object(r.isBlazor)()?this.cellDetails.column:t.column;Object(r.isBlazor)()&&delete t.column;n?this.successCallBack(t,u,f)(t):(i.trigger(ay,t,this.successCallBack(t,u,f)),i.notify(nw,{formObj:this.form}))}},n.prototype.successCallBack=function(n,t,i,u){var f=this;return function(n){var e=f.parent,h,s;if(n.cell=n.cell?n.cell:f.form.parentElement,n.columnObject=n.columnObject?n.columnObject:i,n.columnObject.index=Object(r.isNullOrUndefined)(n.columnObject.index)?0:n.columnObject.index,n.cancel){if(f.preventSaveCell=!1,f.editNext){if(f.editNext=!1,f.cellDetails.rowIndex===f.index&&f.cellDetails.column.field===f.field)return;f.editCellExtend(f.index,f.field,f.isAdd)}}else{if((e.editModule.destroyWidgets([i]),e.isEdit=!1,e.editModule.destroyForm(),Object(r.isBlazor)()&&i.template&&!n.cell.parentElement.classList.contains("e-insertedrow")&&Object(r.updateBlazorTemplate)(e.element.id+i.uid,"Template",i,!1),f.parent.notify(bi,{}),Object(r.isBlazor)()&&e.isServerRendered&&(o(n.cell,"e-movableheader")||o(n.cell,"e-movablecontent")))?f.refreshTD(n.cell,i,e.getMovableRowsObject()[f.cellDetails.rowIndex],n.value):(h=o(n.cell,"e-movablecontent")?e.getMovableRowsObject()[f.cellDetails.rowIndex]:e.getRowObjectFromUID(t.getAttribute("data-uid")),f.refreshTD(n.cell,i,h,n.value),f.parent.isReact&&(n.cell=f.newReactTd)),Object(r.removeClass)([t],["e-editedrow","e-batchrow"]),Object(r.removeClass)([n.cell],["e-editedbatchcell","e-boolcell"]),(!Object(r.isNullOrUndefined)(n.value)&&n.value.toString()===(Object(r.isNullOrUndefined)(f.cellDetails.value)?"":f.cellDetails.value).toString()&&!f.isColored||Object(r.isNullOrUndefined)(n.value)&&Object(r.isNullOrUndefined)(f.cellDetails.value)&&!n.cell.parentElement.classList.contains("e-insertedrow"))&&(n.cell.classList.remove("e-updatedtd"),Object(r.isBlazor)()&&e.isServerRendered&&(Object(r.isNullOrUndefined)(n.value)?"":n.value).toString()===(Object(r.isNullOrUndefined)(f.cellDetails.value)?"":f.cellDetails.value).toString()&&(f.cloneCell[""+parseInt(t.getAttribute("aria-rowindex"),10)+n.columnObject.index].classList.contains("e-selectionbackground")?f.originalCell[""+parseInt(t.getAttribute("aria-rowindex"),10)+n.columnObject.index].classList.add("e-selectionbackground","e-active"):f.originalCell[""+parseInt(t.getAttribute("aria-rowindex"),10)+n.columnObject.index].classList.remove("e-selectionbackground","e-active"),f.cloneCell[""+parseInt(t.getAttribute("aria-rowindex"),10)+n.columnObject.index].replaceWith(f.originalCell[""+parseInt(t.getAttribute("aria-rowindex"),10)+n.columnObject.index]))),Object(r.isNullOrUndefined)(u)&&e.trigger(vy,n),e.notify(lt,{}),f.isColored=!1,f.parent.aggregates.length>0&&(f.parent.notify(ai,{}),f.parent.groupSettings.columns.length>0&&!f.isAddRow(f.cellDetails.rowIndex)&&f.parent.notify(pi,{})),f.preventSaveCell=!1,f.editNext){if(f.editNext=!1,f.cellDetails.rowIndex===f.index&&f.cellDetails.column.field===f.field)return;s=e.getColumnByField(f.field);s&&s.allowEditing&&f.editCellExtend(f.index,f.field,f.isAdd)}u&&e.notify(fu,{})}}},n.prototype.getDataByIndex=function(n){var t=this.parent.getRowObjectFromUID(this.parent.getDataRows()[n].getAttribute("data-uid"));return t.changes?t.changes:t.data},n.prototype.keyDownHandler=function(n){var i,r;if(("tab"===n.action||"shiftTab"===n.action)&&this.parent.isEdit){var t=this.parent,u=this.getBatchChanges(),e=this.parent.getCurrentViewRecords().length+u.addedRecords.length-u.deletedRecords.length-1,f=o(n.target,"e-rowcell");f&&(i=f.querySelector(".e-field"),i&&(r=this.parent.getVisibleColumns(),r["tab"===n.action?r.length-1:0].field===i.getAttribute("id").slice(this.parent.element.id.length)&&(this.cellDetails.rowIndex===e&&"tab"===n.action?"Top"===t.editSettings.newRowPosition?(t.editSettings.newRowPosition="Bottom",this.addRecord(),t.editSettings.newRowPosition="Top"):this.addRecord():this.saveCell())))}},n.prototype.addCancelWhilePaging=function(){this.validateFormObj()&&(this.parent.notify(ie,{}),this.parent.isEdit=!1,this.isColored=!1)},n}(),kit=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),yd=function(n){function t(t,i,r){var u=n.call(this,t,i)||this;return u.parent=t,u.serviceLocator=i,u.renderer=r,u}return kit(t,n),t.prototype.closeEdit=function(){n.prototype.closeEdit.call(this)},t.prototype.addRecord=function(t,i){n.prototype.addRecord.call(this,t,i)},t.prototype.endEdit=function(){n.prototype.endEdit.call(this)},t.prototype.updateRow=function(t,i){n.prototype.updateRow.call(this,t,i)},t.prototype.deleteRecord=function(t,i){n.prototype.deleteRecord.call(this,t,i)},t.prototype.startEdit=function(t){n.prototype.startEdit.call(this,t)},t}(yv),wv=function(){function n(n){this.parent=n}return n.prototype.create=function(n){var t=b(n.column.field);return this.parent.createElement("input",{className:"e-field",attrs:{id:this.parent.element.id+t,name:t,type:"text","e-mappinguid":n.column.uid}})},n.prototype.read=function(n){return n.ej2_instances[0].value},n.prototype.write=function(n){"datepickeredit"===n.column.editType?this.obj=new vu.DatePicker(Object(r.extend)(pd(n,this.parent.editSettings.mode,this.parent.enableRtl),n.column.edit.params)):"datetimepickeredit"===n.column.editType&&(this.obj=new vu.DateTimePicker(Object(r.extend)(pd(n,this.parent.editSettings.mode,this.parent.enableRtl),n.column.edit.params)));Object(r.isBlazor)()&&(this.obj.locale=this.parent.locale);this.obj.appendTo(n.element)},n.prototype.destroy=function(){this.obj&&this.obj.destroy()},n}();var dit=function(){function n(n){this.parent=n}return n.prototype.read=function(n,t){return t},n.prototype.write=function(){},n.prototype.destroy=function(){},n}(),git=function(){function n(n,t){this.editType={Inline:pv,Normal:pv,Batch:vd,Dialog:yd};this.parent=n;this.serviceLocator=t;this.l10n=this.serviceLocator.getService("localization");this.addEventListener();this.updateEditObj();this.createAlertDlg();this.createConfirmDlg()}return n.prototype.updateColTypeObj=function(){for(var i=this.parent.columnModel,t=0;t<i.length;t++)i[t].edit=this.parent.editSettings.template||i[t].editTemplate?Object(r.extend)(new n.editCellType.templateedit(this.parent),i[t].edit||{}):Object(r.extend)(new n.editCellType[i[t].editType&&n.editCellType[i[t].editType]?i[t].editType:"defaultedit"](this.parent,this.serviceLocator),i[t].edit||{});this.parent.log("primary_column_missing")},n.prototype.getModuleName=function(){return"edit"},n.prototype.onPropertyChanged=function(n){if(n.module===this.getModuleName())for(var t=this.parent,i=(n.properties,0),r=Object.keys(n.properties);i<r.length;i++)switch(r[i]){case"allowAdding":case"allowDeleting":case"allowEditing":(t.editSettings.allowAdding||t.editSettings.allowEditing||t.editSettings.allowDeleting)&&this.initialEnd();break;case"mode":this.updateEditObj();t.isEdit=!1;t.refresh()}},n.prototype.updateEditObj=function(){this.editModule&&this.editModule.destroy();this.renderer=new sd(this.parent,this.serviceLocator);this.editModule=new this.editType[this.parent.editSettings.mode](this.parent,this.serviceLocator,this.renderer)},n.prototype.initialEnd=function(){this.updateColTypeObj()},n.prototype.startEdit=function(n){var t=this.parent;if(t.editSettings.allowEditing&&!t.isEdit&&"Batch"!==t.editSettings.mode){if(this.parent.element.classList.add("e-editing"),t.getSelectedRows().length)n||(n=t.getSelectedRows()[0]);else if(!n)return void this.showDialog("EditOperationAlert",this.alertDObj);this.isLastRow=n.rowIndex===this.parent.getContent().querySelector("tr:last-child").rowIndex;"none"!==n.style.display&&(this.editModule.startEdit(n),Object(r.isBlazor)()||(this.refreshToolbar(),t.element.querySelector(".e-gridpopup").style.display="none",this.parent.notify("start-edit",{})))}},n.prototype.checkLastRow=function(n,t){var i=this.isLastRow;"auto"!==this.parent.height&&"Bottom"===this.parent.editSettings.newRowPosition&&t&&"add"===t.requestType&&this.parent.height>this.parent.getContentTable().scrollHeight?Object(r.addClass)(n.querySelectorAll(".e-rowcell"),"e-lastrowadded"):i&&n&&n.classList&&Object(r.addClass)(n.querySelectorAll(".e-rowcell"),"e-lastrowcell")},n.prototype.closeEdit=function(){"Batch"===this.parent.editSettings.mode&&this.parent.editSettings.showConfirmDialog&&this.parent.element.querySelectorAll(".e-updatedtd").length?this.showDialog("CancelEdit",this.dialogObj):(this.parent.element.classList.remove("e-editing"),this.editModule.closeEdit(),Object(r.isBlazor)()||(this.refreshToolbar(),this.parent.notify("close-edit",{})))},n.prototype.refreshToolbar=function(){this.parent.notify(lt,{})},n.prototype.addRecord=function(n,t){if(this.parent.editSettings.allowAdding){var i={startEdit:!0};n||this.parent.notify(le,i);i.startEdit&&(this.parent.element.classList.add("e-editing"),this.editModule.addRecord(n,t),Object(r.isBlazor)()||(this.refreshToolbar(),this.parent.notify("start-add",{})))}},n.prototype.deleteRecord=function(n,t){var i=this.parent;i.editSettings.allowDeleting&&(t||i.getSelectedRecords().length||!Object(r.isNullOrUndefined)(i.commandDelIndex)?i.editSettings.showDeleteConfirmDialog?this.showDialog("ConfirmDelete",this.dialogObj):this.editModule.deleteRecord(n,t):this.showDialog("DeleteOperationAlert",this.alertDObj))},n.prototype.deleteRow=function(n){this.deleteRowUid=n.getAttribute("data-uid");var t=this.parent.getRowObjectFromUID(this.deleteRowUid);Object(r.isNullOrUndefined)(t)||this.deleteRecord(null,t.data)},n.prototype.endEdit=function(){"Batch"===this.parent.editSettings.mode&&this.parent.editSettings.showConfirmDialog&&(Object(r.isNullOrUndefined)(this.formObj)||this.formObj.validate())&&(this.parent.editModule.saveCell(),this.parent.notify(rf,{}),Object(r.isNullOrUndefined)(this.formObj)||this.formObj.validate())?this.showDialog("BatchSaveConfirm",this.dialogObj):this.endEditing()},n.prototype.updateCell=function(n,t,i){this.editModule.updateCell(n,t,i)},n.prototype.updateRow=function(n,t){this.editModule.updateRow(n,t)},n.prototype.batchCancel=function(){this.closeEdit()},n.prototype.batchSave=function(){this.endEdit()},n.prototype.editCell=function(n,t){this.editModule.editCell(n,t)},n.prototype.editFormValidate=function(){return!!this.formObj&&this.formObj.validate()},n.prototype.getBatchChanges=function(){return this.editModule.getBatchChanges?this.editModule.getBatchChanges():{}},n.prototype.getCurrentEditCellData=function(){var n=this.getCurrentEditedData(this.formObj.element,{});return n[Object.keys(n)[0]]},n.prototype.saveCell=function(){this.editModule.saveCell()},n.prototype.endEditing=function(){this.parent.element.classList.remove("e-editing");this.editModule.endEdit();this.refreshToolbar()},n.prototype.showDialog=function(n,t){t.content="<div>"+this.l10n.getConstant(n)+"<\/div>";t.dataBind();t.show()},n.prototype.getValueFromType=function(n,t){var i=t;switch(n.type){case"number":i=isNaN(parseFloat(t))?null:parseFloat(t);break;case"boolean":"booleanedit"!==n.editType&&(i=t===this.l10n.getConstant("True")||!0===t);break;case"date":case"datetime":"datepickeredit"!==n.editType&&"datetimepickeredit"!==n.editType&&t&&t.length?i=new Date(t):""===t&&(i=null)}return i},n.prototype.destroyToolTip=function(){for(var i,n=0,t=[].slice.call(this.parent.element.querySelectorAll(".e-griderror"));n<t.length;n++)i=t[n],Object(r.remove)(i);this.parent.getContent().firstElementChild.style.position="relative"},n.prototype.createConfirmDlg=function(){this.dialogObj=this.dlgWidget([{click:this.dlgOk.bind(this),buttonModel:{content:this.l10n.getConstant("OKButton"),cssClass:"e-primary",isPrimary:!0}},{click:this.dlgCancel.bind(this),buttonModel:{cssClass:"e-flat",content:this.l10n.getConstant("CancelButton")}}],"EditConfirm")},n.prototype.createAlertDlg=function(){this.alertDObj=this.dlgWidget([{click:this.alertClick.bind(this),buttonModel:{content:this.l10n.getConstant("OKButton"),cssClass:"e-flat",isPrimary:!0}}],"EditAlert")},n.prototype.alertClick=function(){this.alertDObj.hide()},n.prototype.dlgWidget=function(n,t){var u=this.parent.createElement("div",{id:this.parent.element.id+t}),r,i;return this.parent.element.appendChild(u),r={showCloseIcon:!1,isModal:!0,visible:!1,closeOnEscape:!0,target:this.parent.element,width:"320px",animationSettings:{effect:"None"}},r.buttons=n,i=new ft.Dialog(r),i.isStringTemplate=!0,i.appendTo(u),i},n.prototype.dlgCancel=function(){this.parent.focusModule.clearIndicator();this.parent.focusModule.restoreFocus();this.dialogObj.hide()},n.prototype.dlgOk=function(){switch(this.dialogObj.element.querySelector(".e-dlg-content").firstElementChild.innerText){case this.l10n.getConstant("ConfirmDelete"):this.editModule.deleteRecord();break;case this.l10n.getConstant("CancelEdit"):this.editModule.closeEdit();break;case this.l10n.getConstant("BatchSaveConfirm"):this.endEditing();break;case this.l10n.getConstant("BatchSaveLostChanges"):"Batch"===this.parent.editSettings.mode&&(this.editModule.addCancelWhilePaging(),Object(r.isBlazor)()&&this.parent.isServerRendered&&this.editModule.closeEdit());this.executeAction()}this.dlgCancel()},n.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(d,this.onPropertyChanged,this),this.parent.on(tt,this.initialEnd,this),this.parent.on(w,this.keyPressHandler,this),this.parent.on(wi,this.updateColTypeObj,this),this.parent.on(bi,this.destroyToolTip,this),this.parent.on(ot,this.preventBatch,this),this.parent.on(ie,this.destroyForm,this),this.actionBeginFunction=this.onActionBegin.bind(this),this.actionCompleteFunction=this.actionComplete.bind(this),this.parent.addEventListener(l,this.actionBeginFunction),this.parent.addEventListener(c,this.actionCompleteFunction))},n.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(d,this.onPropertyChanged),this.parent.off(tt,this.initialEnd),this.parent.off(w,this.keyPressHandler),this.parent.off(wi,this.updateColTypeObj),this.parent.off(bi,this.destroyToolTip),this.parent.off(ot,this.preventBatch),this.parent.off(ie,this.destroyForm),this.parent.removeEventListener(c,this.actionCompleteFunction),this.parent.removeEventListener(l,this.actionBeginFunction))},n.prototype.actionComplete=function(n){["add","beginEdit","save","delete","cancel"].indexOf(n.requestType)<0&&(this.parent.isEdit=!1);"batchsave"===n.requestType&&this.parent.focusModule.restoreFocus();this.refreshToolbar()},n.prototype.getCurrentEditedData=function(n,t){var c=this.parent,u,i,h,s,l,a,v;if(c.editSettings.template){for(u=[].slice.call(n.elements),i=0;i<u.length;i++)if(u[i].hasAttribute("name")&&"e-multi-hidden"!==u[i].className||u[i].classList.contains("e-multiselect")){var w=u[i].hasAttribute("name")?ka(u[i].getAttribute("name")):ka(u[i].getAttribute("id")),o=c.getColumnByField(w)||{field:w,type:u[i].getAttribute("type")},f=void 0;"checkbox"===o.type||"boolean"===o.type?f=u[i].checked:u[i].value?(f=u[i].value,u[i].ej2_instances&&u[i].ej2_instances.length&&!Object(r.isNullOrUndefined)(u[i].ej2_instances[0].value)&&(u[i].blur(),f=u[i].ej2_instances[0].value,"date"!==o.type&&"dateTime"!==o.type&&"datetime"!==o.type||!u[i].ej2_instances[0].isServerRendered||(f=u[i].value))):u[i].ej2_instances&&(f=u[i].ej2_instances[0].value);o.edit&&"string"==typeof o.edit.read?f=Object(r.getValue)(o.edit.read,window)(u[i],f):o.edit&&o.edit.read&&(f=o.edit.read(u[i],f));f=c.editModule.getValueFromType(o,f);"radio"===u[i].type?u[i].checked&&e.DataUtil.setValue(o.field,f,t):e.DataUtil.setValue(o.field,f,t)}return t}for(h=c.columnModel.filter(function(n){return n.editTemplate}),s=0;s<h.length;s++)if(n[b(h[s].field)])for(l=[].slice.call(n[b(h[s].field)]),a=(l=l.length?l:[n[b(h[s].field)]]).filter(function(n){return!Object(r.isNullOrUndefined)(n.ej2_instances)}),0===a.length&&(a=l.filter(function(n){return n.hasAttribute("name")})),i=0;i<a.length;i++)f=this.getValue(h[s],a[i],t),e.DataUtil.setValue(h[s].field,f,t);for(var p=[].slice.call(n.querySelectorAll(".e-field")),y=0,k=p.length;y<k;y++)v=c.getColumnByUid(p[y].getAttribute("e-mappinguid")),v&&v.field&&(f=this.getValue(v,p[y],t),e.DataUtil.setValue(v.field,f,t));return t},n.prototype.getValue=function(n,t,i){var u=!t.ej2_instances||Object(r.isBlazor)()&&t.ej2_instances[0].isServerRendered&&("date"===n.type||"datetime"===n.type)?t.value:t.ej2_instances[0].value,e=this.parent,f=n.edit.read;return"checkbox"!==n.type&&"boolean"!==n.type||(u=t.checked),"string"==typeof f?(f=Object(r.getValue)(f,window),u=e.editModule.getValueFromType(n,f(t,u))):u=e.editModule.getValueFromType(n,n.edit.read(t,u)),Object(r.isNullOrUndefined)(i[n.field])&&""===u&&(u=i[n.field]),u},n.prototype.onActionBegin=function(n){"columnstate"===n.requestType&&this.parent.isEdit&&"Batch"!==this.parent.editSettings.mode?this.closeEdit():"Batch"===this.parent.editSettings.mode||!this.formObj||this.formObj.isDestroyed||-1!==["filterafteropen","filterbeforeopen","filterchoicerequest","save","infiniteScroll"].indexOf(n.requestType)||n.cancel||(this.destroyWidgets(),this.destroyForm())},n.prototype.destroyWidgets=function(n){var f,o,t,e,u,i;for(this.parent.editSettings.template&&(this.parent.destroyTemplate(["editSettingsTemplate"]),this.parent.isReact&&this.parent.renderTemplates()),(n=n||this.parent.getVisibleColumns()).some(function(n){return!Object(r.isNullOrUndefined)(n.editTemplate)})&&(this.parent.destroyTemplate(["editTemplate"]),this.parent.isReact&&this.parent.renderTemplates()),f=0,o=n;f<o.length;f++)t=o[f],e=t.edit.destroy,Object(r.isBlazor)()&&t.editTemplate&&(Object(r.resetBlazorTemplate)(this.parent.element.id+t.uid+"editTemplate","EditTemplate"),Object(r.updateBlazorTemplate)(this.parent.element.id+t.uid+"editTemplate","EditTemplate",t,!1)),t.edit.destroy&&("string"==typeof e?(e=Object(r.getValue)(e,window))():t.edit.destroy());for(u=[].slice.call(this.formObj.element.elements),i=0;i<u.length;i++)u[i].hasAttribute("name")&&u[i].ej2_instances&&u[i].ej2_instances.length&&!u[i].ej2_instances[0].isDestroyed&&u[i].ej2_instances[0].destroy()},n.prototype.destroyForm=function(){this.destroyToolTip();this.formObj&&!this.formObj.isDestroyed&&this.formObj.destroy();this.destroyToolTip()},n.prototype.destroy=function(){var t=this.parent.element,i,n;t&&(i=!(!t.querySelector(".e-gridheader")||!t.querySelector(".e-gridcontent")),i&&this.destroyForm(),this.removeEventListener(),n=this.dialogObj.element,n.childElementCount>0&&(this.dialogObj.destroy(),Object(r.remove)(n)),(n=this.alertDObj.element).childElementCount>0&&(this.alertDObj.destroy(),Object(r.remove)(n)),i&&this.editModule&&this.editModule.destroy())},n.prototype.keyPressHandler=function(n){switch(n.action){case"insert":this.addRecord();break;case"delete":"INPUT"===n.target.tagName&&!n.target.classList.contains("e-checkselect")||document.querySelector(".e-popup-open")||this.deleteRecord();break;case"f2":this.startEdit();break;case"enter":!o(n.target,"e-unboundcelldiv")&&"Batch"!==this.parent.editSettings.mode&&(o(n.target,"e-gridcontent")||this.parent.frozenRows&&o(n.target,"e-headercontent"))&&!document.querySelectorAll(".e-popup-open").length&&(n.preventDefault(),this.endEdit());break;case"escape":this.parent.isEdit&&("Batch"===this.parent.editSettings.mode?this.editModule.escapeCellEdit():this.closeEdit())}},n.prototype.preventBatch=function(n){this.preventObj=n;this.showDialog("BatchSaveLostChanges",this.dialogObj)},n.prototype.executeAction=function(){this.preventObj.handler.call(this.preventObj.instance,this.preventObj.arg1,this.preventObj.arg2,this.preventObj.arg3,this.preventObj.arg4,this.preventObj.arg5,this.preventObj.arg6,this.preventObj.arg7,this.preventObj.arg8)},n.prototype.applyFormValidation=function(n){var i=this.parent,f=i.getFrozenColumns(),o="Dialog"!==this.parent.editSettings.mode?i.element.querySelector(".e-gridform"):Object(r.select)("#"+i.element.id+"_dialogEdit_wrapper .e-gridform",document),s=i.element.querySelectorAll(".e-gridform")[1],u={},e={},t;for(n=n||i.getColumns(),t=0;t<n.length;t++)n[t].visible&&(Object(r.isBlazor)()&&n[t].editTemplate||(t<f&&n[t].validationRules?u[b(n[t].field)]=n[t].validationRules:t>=f&&n[t].validationRules&&(e[b(n[t].field)]=n[t].validationRules)));f&&"Dialog"!==this.parent.editSettings.mode?this.parent.editModule.mFormObj=this.createFormObj(s,e):u=Object(r.extend)(u,e);this.parent.editModule.formObj=Object(r.isBlazor)()&&this.parent.editSettings.template?this.createFormObj(o,{}):this.createFormObj(o,u)},n.prototype.createFormObj=function(n,t){var i=this;return new rr.FormValidator(n,{rules:t,locale:this.parent.locale,validationComplete:function(n){i.validationComplete(n)},customPlacement:function(n,t){var r=n.getAttribute("e-mappinguid"),u={column:i.parent.getColumnByUid(r),error:t,inputElement:n,value:n.value};i.valErrorPlacement(n,t);i.parent.notify(ew,u)}})},n.prototype.valErrorPlacement=function(n,t){if(this.parent.isEdit){var i=t.getAttribute("for"),r=this.getElemTable(n).querySelector("#"+i+"_Error");r?r.querySelector(".e-tip-content").innerHTML=t.outerHTML:this.createTooltip(n,t,i,"")}},n.prototype.getElemTable=function(n){var t;return"Dialog"!==this.parent.editSettings.mode&&(t=this.parent.frozenRows&&this.parent.frozenRows>(parseInt(Object(r.closest)(n,".e-row").getAttribute("aria-rowindex"),10)||0)),"Dialog"!==this.parent.editSettings.mode?t?this.parent.getHeaderTable():this.parent.getContentTable():Object(r.select)("#"+this.parent.element.id+"_dialogEdit_wrapper",document)},n.prototype.validationComplete=function(n){if(this.parent.isEdit){var t=this.getElemTable(n.element).querySelector("#"+n.inputName+"_Error");t&&(t.style.display="failure"===n.status?"":"none")}},n.prototype.createTooltip=function(n,t,i,u){var e=this.parent.getContent().firstElementChild,b,c,g,ut,et,ot,st,ht;this.parent.getFrozenColumns()&&(e=this.parent.getMovableVirtualContent());var w,v,nt=e.scrollHeight>e.clientHeight||e.scrollWidth>e.clientWidth,h="Dialog"!==this.parent.editSettings.mode,ct=Object(r.closest)(n,".e-rowcell"),y=Object(r.closest)(n,".e-row"),tt=this.parent.getContent().querySelector(".e-frozencontent"),it=!1,rt=!1,l=Math.round(this.parent.getContent().clientHeight/this.parent.getRowHeight())-1,s=tt?[].slice.call(this.parent.getFrozenVirtualContent().querySelectorAll(".e-row")):[].slice.call(this.parent.getContent().querySelectorAll(".e-row"));("Batch"===this.parent.editSettings.mode&&l>1&&s.length>=l&&s[s.length-1].getAttribute("aria-rowindex")===y.getAttribute("aria-rowindex")&&(rt=!0),h)&&(this.parent.frozenRows&&(b=this.parent.getFrozenColumns()?this.parent.getFrozenVirtualHeader().querySelector("tbody").children:this.parent.getHeaderTable().querySelector("tbody").children,it=(w=b.length>(parseInt(y.getAttribute("aria-rowindex"),10)||0))&&parseInt(y.getAttribute("aria-rowindex"),10)===b.length-1),(it||l>1&&s.length>=l&&("Bottom"===this.parent.editSettings.newRowPosition&&this.editModule.args&&"add"===this.editModule.args.requestType||ct.classList.contains("e-lastrowcell")&&!y.classList.contains("e-addedrow"))||rt)&&(v=!0));var k=h?w?this.parent.getHeaderTable():this.parent.getContentTable():Object(r.select)("#"+this.parent.element.id+"_dialogEdit_wrapper .e-dlg-content",document),p=k.getBoundingClientRect(),d=h?this.parent.element.getBoundingClientRect().left:p.left,a=Object(r.closest)(n,"td"),o=a?a.getBoundingClientRect():n.parentElement.getBoundingClientRect(),f=this.parent.createElement("div",{className:"e-tooltip-wrap e-lib e-control e-popup e-griderror",id:i+"_Error",styles:"display:"+u+";top:"+((w?o.top+o.height:o.bottom-p.top-(this.parent.getFrozenColumns()?tt.scrollTop:0))+k.scrollTop+9)+"px;left:"+(o.left-d+k.scrollLeft+o.width/2)+"px;max-width:"+o.width+"px;text-align:center;"});h&&p.left<d&&(f.style.left=parseInt(f.style.left,10)-p.left+d+"px");g=this.parent.createElement("div",{className:"e-tip-content"});(g.appendChild(t),v?((c=this.parent.createElement("div",{className:"e-arrow-tip e-tip-bottom"})).appendChild(this.parent.createElement("div",{className:"e-arrow-tip-outer e-tip-bottom"})),c.appendChild(this.parent.createElement("div",{className:"e-arrow-tip-inner e-tip-bottom"}))):((c=this.parent.createElement("div",{className:"e-arrow-tip e-tip-top"})).appendChild(this.parent.createElement("div",{className:"e-arrow-tip-outer e-tip-top"})),c.appendChild(this.parent.createElement("div",{className:"e-arrow-tip-inner e-tip-top"}))),f.appendChild(g),f.appendChild(c),(this.parent.getFrozenColumns()||this.parent.frozenRows)&&"Dialog"!==this.parent.editSettings.mode)?(("Normal"===this.parent.editSettings.mode?Object(r.closest)(n,".e-editcell"):Object(r.closest)(n,".e-table")).style.position="relative",f.style.position="absolute","Batch"===this.parent.editSettings.mode||Object(r.closest)(n,".e-frozencontent")||Object(r.closest)(n,".e-frozenheader")||this.parent.frozenRows&&!this.parent.getFrozenColumns()?this.formObj.element.appendChild(f):this.mFormObj.element.appendChild(f)):this.formObj.element.appendChild(f);!v&&h&&e.getBoundingClientRect().bottom<o.bottom+o.height&&(e.scrollTop=e.scrollTop+f.offsetHeight+c.scrollHeight);ut=parseInt(document.defaultView.getComputedStyle(f,null).getPropertyValue("font-size"),10);(f.getBoundingClientRect().width<o.width&&f.querySelector("label").getBoundingClientRect().height/(1.2*ut)>=2&&(f.style.width=f.style.maxWidth),f.style.left=!this.parent.getFrozenColumns()&&!this.parent.frozenRows||"Normal"!==this.parent.editSettings.mode&&"Batch"!==this.parent.editSettings.mode?parseInt(f.style.left,10)-f.offsetWidth/2+"px":a.offsetLeft+(a.offsetWidth/2-f.offsetWidth/2)+"px",h&&!nt&&!this.parent.allowPaging||this.parent.getFrozenColumns()||this.parent.frozenRows)&&(e.style.position="static",et=Object(ft.calculateRelativeBasedPosition)(a,f),f.style.top=et.top+o.height+9+"px");v&&(!nt||this.parent.getFrozenColumns()||"auto"===this.parent.height||this.parent.frozenRows||this.parent.enableVirtualization?f.style.bottom=o.height+9+"px":(ot=e.scrollWidth>e.offsetWidth?oi():0,f.style.bottom=this.parent.height-e.querySelector("table").offsetHeight-ot+o.height+9+"px"),s.length<l&&"Bottom"===this.parent.editSettings.newRowPosition&&this.editModule.args&&"add"===this.editModule.args.requestType&&(st=(this.parent.frozenRows?this.parent.frozenRows+(s.length-1):s.length-1)*this.parent.getRowHeight(),ht=this.parent.getContent().clientHeight-st,f.style.bottom=ht+9+"px"),f.style.top=null)},n.prototype.checkColumnIsGrouped=function(n){return!(n.visible||this.parent.groupSettings.columns.indexOf(n.field)>-1)},n.AddEditors=function(t){n.editCellType=Object(r.extend)(n.editCellType,t)},n.editCellType={dropdownedit:cd,numericedit:ld,datepickeredit:wv,datetimepickeredit:wv,booleanedit:hd,defaultedit:ad,templateedit:dit},n}(),nrt=function(){function n(n,t){this.showColumn=[];this.hideColumn=[];this.changedColumns=[];this.unchangedColumns=[];this.isDlgOpen=!1;this.dlghide=!1;this.initialOpenDlg=!0;this.stateChangeColumns=[];this.changedStateColumns=[];this.isInitialOpen=!1;this.isCustomizeOpenCC=!1;this.searchOperator="startswith";this.prevShowedCols=[];this.parent=n;this.serviceLocator=t;this.addEventListener();this.cBoxTrue=Object(gt.createCheckBox)(this.parent.createElement,!0,{checked:!0,label:" "});this.cBoxFalse=Object(gt.createCheckBox)(this.parent.createElement,!0,{checked:!1,label:" "});this.cBoxTrue.insertBefore(this.parent.createElement("input",{className:"e-chk-hidden e-cc e-cc-chbox",attrs:{type:"checkbox"}}),this.cBoxTrue.firstChild);this.cBoxFalse.insertBefore(this.parent.createElement("input",{className:"e-chk-hidden e-cc e-cc-chbox",attrs:{type:"checkbox"}}),this.cBoxFalse.firstChild);this.cBoxFalse.querySelector(".e-frame").classList.add("e-uncheck");this.parent.enableRtl&&Object(r.addClass)([this.cBoxTrue,this.cBoxFalse],["e-rtl"])}return n.prototype.destroy=function(){var n=this.parent.element;n&&(n.querySelector(".e-gridheader")||n.querySelector(".e-gridcontent"))&&(this.removeEventListener(),this.unWireEvents(),Object(r.isNullOrUndefined)(this.dlgObj)||!this.dlgObj.element||this.dlgObj.isDestroyed||this.dlgObj.destroy())},n.prototype.rtlUpdate=function(){this.parent.enableRtl?Object(r.addClass)(this.innerDiv.querySelectorAll(".e-checkbox-wrapper"),["e-rtl"]):Object(r.removeClass)(this.innerDiv.querySelectorAll(".e-checkbox-wrapper"),["e-rtl"])},n.prototype.addEventListener=function(){this.parent.isDestroyed||(r.EventHandler.add(document,"click",this.clickHandler,this),this.parent.on(v,this.enableAfterRenderEle,this),this.parent.on(tt,this.render,this),this.parent.addEventListener(ct,this.hideDialog.bind(this)),this.parent.on(ri,this.destroy,this),this.parent.on(ns,this.rtlUpdate,this),this.parent.on(w,this.keyUpHandler,this),this.parent.on(ws,this.onResetColumns,this))},n.prototype.removeEventListener=function(){this.parent.isDestroyed||(r.EventHandler.remove(document,"click",this.clickHandler),this.parent.off(tt,this.render),this.parent.off(ri,this.destroy),this.parent.off(v,this.enableAfterRenderEle),this.parent.off(ns,this.rtlUpdate),this.parent.on(w,this.keyUpHandler,this),this.parent.off(ws,this.onResetColumns))},n.prototype.render=function(){this.l10n=this.serviceLocator.getService("localization");this.renderDlgContent();this.getShowHideService=this.serviceLocator.getService("showHideService")},n.prototype.clickHandler=function(n){var t=n.target;if(!this.isCustomizeOpenCC){if(Object(r.isNullOrUndefined)(Object(r.closest)(t,".e-cc"))&&Object(r.isNullOrUndefined)(Object(r.closest)(t,".e-cc-toolbar")))Object(r.isNullOrUndefined)(this.dlgObj)||!this.dlgObj.visible||t.classList.contains("e-toolbar-items")||(this.dlgObj.hide(),this.clearActions(),this.refreshCheckboxState(),this.isDlgOpen=!1);else if(t.classList.contains("e-columnchooser-btn")||t.classList.contains("e-cc-toolbar")){if(this.initialOpenDlg&&this.dlgObj.visible||!this.isDlgOpen)return void(this.isDlgOpen=!0)}else t.classList.contains("e-cc-cancel")&&(t.parentElement.querySelector(".e-ccsearch").value="",this.columnChooserSearch(""),this.removeCancelIcon(),this.refreshCheckboxButton());(this.parent.detailTemplate||this.parent.childGrid)&&(this.targetdlg=n.target)}this.isCustomizeOpenCC&&n.target.classList.contains("e-cc-cancel")&&this.refreshCheckboxState();this.rtlUpdate()},n.prototype.hideDialog=function(){!Object(r.isNullOrUndefined)(this.dlgObj)&&this.dlgObj.visible&&(this.dlgObj.hide(),this.isDlgOpen=!1)},n.prototype.renderColumnChooser=function(n,t,i){var f,u;if(this.dlgObj.visible||!this.parent.detailTemplate&&!this.parent.childGrid||this.hideOpenedDialog(),this.dlgObj.visible)this.hideDialog(),this.addcancelIcon(),this.clearActions(),this.refreshCheckboxState();else{if(this.beforeOpenColumnChooserEvent().cancel)return;i&&(this.targetdlg=i);this.refreshCheckboxState();this.dlgObj.dataBind();this.dlgObj.element.style.maxHeight="430px";f=this.dlgObj.element.style.display;this.dlgObj.element.style.display="block";u=Object(ft.calculateRelativeBasedPosition)(Object(r.closest)(i,".e-toolbar-item"),this.dlgObj.element);this.dlgObj.element.style.display=f;this.dlgObj.element.style.top=u.top+Object(r.closest)(i,".e-cc-toolbar").getBoundingClientRect().height+"px";Object(r.isNullOrUndefined)(Object(r.closest)(i,".e-bigger"))||(this.dlgObj.width=258);r.Browser.isDevice?(this.dlgObj.target=document.body,this.dlgObj.position={X:"center",Y:"center"},this.dlgObj.refreshPosition(),this.dlgObj.open=this.mOpenDlg.bind(this)):this.dlgObj.element.style.left=this.parent.enableRtl?i.offsetLeft+"px":u.left-250+Object(r.closest)(i,".e-cc-toolbar").clientWidth+2+"px";this.removeCancelIcon();this.dlgObj.show();this.parent.notify(gp,{dialog:this.dlgObj})}this.rtlUpdate()},n.prototype.openColumnChooser=function(n,t){(this.isCustomizeOpenCC=!0,this.dlgObj.visible)?this.hideDialog():this.beforeOpenColumnChooserEvent().cancel||(this.isInitialOpen?this.refreshCheckboxState():(this.dlgObj.content=this.renderChooserList(),this.updateIntermediateBtn()),this.dlgObj.dataBind(),this.dlgObj.position={X:"center",Y:"center"},Object(r.isNullOrUndefined)(n)?(this.dlgObj.position={X:"center",Y:"center"},this.dlgObj.refreshPosition()):(this.dlgObj.element.style.top="",this.dlgObj.element.style.left="",this.dlgObj.element.style.top=t+"px",this.dlgObj.element.style.left=n+"px"),this.dlgObj.beforeOpen=this.customDialogOpen.bind(this),this.dlgObj.show(),this.isInitialOpen=!0,this.dlgObj.beforeClose=this.customDialogClose.bind(this))},n.prototype.enableAfterRenderEle=function(n){n.module===this.getModuleName()&&n.enable&&this.render()},n.prototype.keyUpHandler=function(n){"escape"===n.action&&this.hideDialog()},n.prototype.customDialogOpen=function(){var n=this.dlgObj.content.querySelector("input.e-ccsearch");r.EventHandler.add(n,"keyup",this.columnChooserManualSearch,this)},n.prototype.customDialogClose=function(){var n=this.dlgObj.content.querySelector("input.e-ccsearch");r.EventHandler.remove(n,"keyup",this.columnChooserManualSearch)},n.prototype.getColumns=function(){return this.parent.getColumns().filter(function(n){return"checkbox"!==n.type&&!0===n.showInColumnChooser||"checkbox"===n.type&&void 0!==n.field})},n.prototype.renderDlgContent=function(){this.dlgDiv=this.parent.createElement("div",{className:"e-ccdlg e-cc",id:this.parent.element.id+"_ccdlg"});this.dlgDiv.setAttribute("aria-label",this.l10n.getConstant("ColumnChooserDialogARIA"));this.parent.element.appendChild(this.dlgDiv);this.parent.element.getBoundingClientRect().width;this.parent.enableRtl;var n=this.parent.element.querySelector(".e-ccdiv");Object(r.isNullOrUndefined)(n)||n.getBoundingClientRect().top;this.dlgObj=new ft.Dialog({header:this.l10n.getConstant("ChooseColumns"),showCloseIcon:!1,closeOnEscape:!1,locale:this.parent.locale,visible:!1,enableRtl:this.parent.enableRtl,target:document.getElementById(this.parent.element.id),buttons:[{click:this.confirmDlgBtnClick.bind(this),buttonModel:{content:this.l10n.getConstant("OKButton"),isPrimary:!0,cssClass:"e-cc e-cc_okbtn"}},{click:this.clearBtnClick.bind(this),buttonModel:{cssClass:"e-flat e-cc e-cc-cnbtn",content:this.l10n.getConstant("CancelButton")}}],content:this.renderChooserList(),width:250,cssClass:"e-cc",animationSettings:{effect:"None"}});this.dlgObj.isStringTemplate=!0;this.dlgObj.appendTo(this.dlgDiv);this.wireEvents()},n.prototype.renderChooserList=function(){var r;this.mainDiv=this.parent.createElement("div",{className:"e-main-div e-cc"});var n=this.parent.createElement("div",{className:"e-cc-searchdiv e-cc e-input-group"}),t=this.parent.createElement("input",{className:"e-ccsearch e-cc e-input",attrs:{placeholder:this.l10n.getConstant("Search")}}),u=this.parent.createElement("span",{className:"e-ccsearch-icon e-icons e-cc e-input-group-icon",attrs:{title:this.l10n.getConstant("Search")}}),i=this.parent.createElement("div",{className:"e-cc-contentdiv"});return this.innerDiv=this.parent.createElement("div",{className:"e-innerdiv e-cc"}),n.appendChild(t),n.appendChild(u),this.searchBoxObj=new rb(t),r=this.refreshCheckboxList(this.parent.getColumns()),this.innerDiv.appendChild(r),i.appendChild(this.innerDiv),this.mainDiv.appendChild(n),this.mainDiv.appendChild(i),this.mainDiv},n.prototype.confirmDlgBtnClick=function(n){this.stateChangeColumns=[];this.changedStateColumns=[];this.changedColumns=this.changedColumns.length>0?this.changedColumns:this.unchangedColumns;this.changedColumnState(this.changedColumns);var t=this.ulElement.querySelector(".e-uncheck")&&this.ulElement.querySelectorAll(".e-uncheck:not(.e-selectall)").length;Object(r.isNullOrUndefined)(n)||t<this.parent.getColumns().length&&(this.hideColumn.length&&this.columnStateChange(this.hideColumn,!1),this.showColumn.length&&this.columnStateChange(this.showColumn,!0),this.getShowHideService.setVisible(this.stateChangeColumns,this.changedStateColumns),this.clearActions(),this.parent.notify(bi,{module:"edit"}),0===this.parent.getCurrentViewRecords().length&&this.parent.element.querySelector(".e-emptyrow").querySelector("td").setAttribute("colSpan",this.parent.getVisibleColumns().length.toString()))},n.prototype.onResetColumns=function(n){if("columnstate"===n.requestType)return this.showColumn=[],this.hideColumn=[],void this.hideDialog()},n.prototype.resetColumnState=function(){this.showColumn=[];this.hideColumn=[];this.hideDialog()},n.prototype.changedColumnState=function(n){for(var u,i,t=0;t<n.length;t++)u=n[t],i=this.parent.getColumnByUid(u),Object(r.isBlazor)()?this.changedStateColumns.push(JSON.parse(JSON.stringify(i))):this.changedStateColumns.push(i)},n.prototype.columnStateChange=function(n,t){for(var f,i,u=0;u<n.length;u++)f=n[u],i=this.parent.getColumnByUid(f),"checkbox"!==i.type&&(i.visible=t),Object(r.isBlazor)()?this.stateChangeColumns.push(JSON.parse(JSON.stringify(i))):this.stateChangeColumns.push(i)},n.prototype.clearActions=function(){this.hideColumn=[];this.showColumn=[];this.hideDialog();this.addcancelIcon()},n.prototype.clearBtnClick=function(){this.clearActions();this.parent.notify(hw,{dialog:this.dlgObj})},n.prototype.checkstatecolumn=function(n,t,i){void 0===i&&(i=!1);n?(-1!==this.hideColumn.indexOf(t)&&this.hideColumn.splice(this.hideColumn.indexOf(t),1),-1===this.showColumn.indexOf(t)&&this.showColumn.push(t)):(-1!==this.showColumn.indexOf(t)&&this.showColumn.splice(this.showColumn.indexOf(t),1),-1===this.hideColumn.indexOf(t)&&this.hideColumn.push(t));i?n?this.unchangedColumns.push(t):this.changedColumns.push(t):-1!==this.changedColumns.indexOf(t)?this.changedColumns.splice(this.changedColumns.indexOf(t),1):this.changedColumns.push(t)},n.prototype.columnChooserSearch=function(n){var i,t,u=!1,f=this.dlgDiv.querySelector(".e-footer-content"),o=this.ulElement.querySelector(".e-check")&&this.ulElement.querySelectorAll(".e-check:not(.e-selectall)").length,r;(this.isInitialOpen=!0,f&&(t=f.querySelector(".e-btn").ej2_instances[0]),""===n?(this.removeCancelIcon(),i=this.getColumns(),u=!0):i=new e.DataManager(this.getColumns()).executeLocal((new e.Query).where("headerText",this.searchOperator,n,!0)),i.length)?(this.innerDiv.innerHTML=" ",this.innerDiv.classList.remove("e-ccnmdiv"),this.innerDiv.appendChild(this.refreshCheckboxList(i,n)),u?t&&o&&(t.disabled=!1):(this.addcancelIcon(),this.refreshCheckboxButton())):(r=this.parent.createElement("span",{className:"e-cc e-nmatch"}),r.innerHTML=this.l10n.getConstant("Matchs"),this.innerDiv.innerHTML=" ",this.innerDiv.appendChild(r),this.innerDiv.classList.add("e-ccnmdiv"),t&&(t.disabled=!0));this.flag=!0;this.stopTimer()},n.prototype.wireEvents=function(){r.EventHandler.add(this.dlgObj.element,"click",this.checkBoxClickHandler,this);r.EventHandler.add(this.searchBoxObj.searchBox,"keyup",this.columnChooserManualSearch,this);this.searchBoxObj.wireEvent()},n.prototype.unWireEvents=function(){this.parent.isDestroyed||(this.dlgObj.element&&r.EventHandler.remove(this.dlgObj.element,"click",this.checkBoxClickHandler),r.EventHandler.remove(this.searchBoxObj.searchBox,"keyup",this.columnChooserManualSearch),this.searchBoxObj.unWireEvent())},n.prototype.checkBoxClickHandler=function(n){var r,t=o(n.target,"e-checkbox-wrapper"),f,u,i;if(t){if(t.querySelector(".e-selectall")?this.updateSelectAll(!t.querySelector(".e-check")):tv(t.parentElement),t.querySelector(".e-chk-hidden").focus(),t.querySelector(".e-check"))r=!0;else{if(!t.querySelector(".e-uncheck"))return;r=!1}if(this.updateIntermediateBtn(),f=o(t,"e-ccheck").getAttribute("uid"),u=this.parent.getColumns(),"grid-selectAll"===f)for(this.changedColumns=[],this.unchangedColumns=[],i=0;i<u.length;i++)u[i].showInColumnChooser&&this.checkstatecolumn(r,u[i].uid,!0);else this.checkstatecolumn(r,f);this.refreshCheckboxButton()}},n.prototype.updateIntermediateBtn=function(){var f=this.ulElement.children.length-1,n=[],i=this.ulElement.children[0].querySelector(".e-frame"),u=this.ulElement.querySelectorAll(".e-check:not(.e-selectall)").length,t=this.dlgObj.btnObj[0];t.disabled=!1;f===u?n=["e-check"]:u?n=["e-stop"]:(n=["e-uncheck"],t.disabled=!0);t.dataBind();Object(r.removeClass)([i],["e-check","e-stop","e-uncheck"]);Object(r.addClass)([i],n)},n.prototype.updateSelectAll=function(n){for(var t=0,i=[].slice.call(this.ulElement.querySelectorAll(".e-frame"));t<i.length;t++)lf(i[t],n)},n.prototype.refreshCheckboxButton=function(){var f,r,n,t,u,i,h;for(this.dlgObj.element.querySelector(".e-cc.e-input").value,r=this.parent.getVisibleColumns(),n=0;n<r.length;n++)t=r[n].uid,-1===this.prevShowedCols.indexOf(t)&&this.prevShowedCols.push(t);for(n=0;n<this.hideColumn.length;n++)u=this.prevShowedCols.indexOf(this.hideColumn[n]),-1!==u&&this.prevShowedCols.splice(u,1);f=0!==this.showColumn.length?1:this.prevShowedCols.length;i=this.dlgDiv.querySelector(".e-footer-content").querySelector(".e-btn").ej2_instances[0];i.disabled=!1;for(var e=[],s=this.parent.element.querySelectorAll(".e-cc-chbox"),c=(n=0,s.length);n<c;n++)t=o(s[n],"e-ccheck").getAttribute("uid"),e.push(t);h=this.showColumn.filter(function(n){return-1!==e.indexOf(n)});0===f&&0===h.length&&(i.disabled=!0);i.dataBind()},n.prototype.refreshCheckboxList=function(n){var i,u;this.ulElement=this.parent.createElement("ul",{className:"e-ccul-ele e-cc"});var f=this.l10n.getConstant("SelectAll"),r=this.parent.createElement("li",{className:"e-cclist e-cc e-cc-selectall"}),t=this.createCheckBox(f,!1,"grid-selectAll");for(n.length&&(t.querySelector(".e-checkbox-wrapper").firstElementChild.classList.add("e-selectall"),t.querySelector(".e-frame").classList.add("e-selectall"),this.checkState(t.querySelector(".e-icons"),!0),r.appendChild(t),this.ulElement.appendChild(r)),i=0;i<n.length;i++)u=n[i],this.renderCheckbox(u);return this.ulElement},n.prototype.refreshCheckboxState=function(){var n,i,u,f;this.dlgObj.element.querySelector(".e-cc.e-input").value="";this.columnChooserSearch("");for(var e=this.parent,r=this.dlgObj.element.querySelectorAll(".e-cc-chbox:not(.e-selectall)"),t=0,s=r.length;t<s;t++)n=r[t],i=void 0,i=this.parent.childGrid||this.parent.detailTemplate?o(this.dlgObj.element.querySelectorAll(".e-cc-chbox:not(.e-selectall)")[t],"e-ccheck").getAttribute("uid"):o(n,"e-ccheck").getAttribute("uid"),u=e.getColumnByUid(i),f=n.parentElement.querySelectorAll(".e-uncheck"),u.visible&&!f.length?(n.checked=!0,this.checkState(n.parentElement.querySelector(".e-icons"),!0)):(n.checked=!1,this.checkState(n.parentElement.querySelector(".e-icons"),!1))},n.prototype.checkState=function(n,t){t?Object(r.classList)(n,["e-check"],["e-uncheck"]):Object(r.classList)(n,["e-uncheck"],["e-check"])},n.prototype.createCheckBox=function(n,t,i){var r=t?this.cBoxTrue.cloneNode(!0):this.cBoxFalse.cloneNode(!0);return r.querySelector(".e-label").innerHTML=n,oh(i,r,"e-ccheck")},n.prototype.renderCheckbox=function(n){var t,i,r,u;n.showInColumnChooser&&(t=this.parent.createElement("li",{className:"e-cclist e-cc",styles:"list-style:None",id:"e-ccli_"+n.uid}),i=-1!==this.hideColumn.indexOf(n.uid),r=-1!==this.showColumn.indexOf(n.uid),u=this.createCheckBox(n.headerText,n.visible&&!i||r,n.uid),t.appendChild(u),this.ulElement.appendChild(t));this.isInitialOpen&&this.updateIntermediateBtn()},n.prototype.columnChooserManualSearch=function(n){this.addcancelIcon();this.searchValue=n.target.value;this.stopTimer();this.startTimer(n)},n.prototype.startTimer=function(n){var t=this,i=t.flag||13===n.keyCode?0:500;this.timer=window.setInterval(function(){t.columnChooserSearch(t.searchValue)},i)},n.prototype.stopTimer=function(){window.clearInterval(this.timer)},n.prototype.addcancelIcon=function(){this.dlgDiv.querySelector(".e-cc.e-ccsearch-icon").classList.add("e-cc-cancel")},n.prototype.removeCancelIcon=function(){this.dlgDiv.querySelector(".e-cc.e-ccsearch-icon").classList.remove("e-cc-cancel")},n.prototype.mOpenDlg=function(){r.Browser.isDevice&&(this.dlgObj.element.querySelector(".e-cc-searchdiv").classList.remove("e-input-focus"),this.dlgObj.element.querySelectorAll(".e-cc-chbox")[0].focus())},n.prototype.getModuleName=function(){return"columnChooser"},n.prototype.hideOpenedDialog=function(){for(var t=[].slice.call(document.getElementsByClassName("e-ccdlg")).filter(function(n){return n.classList.contains("e-popup-open")}),n=0,i=t.length;n<i;n++)(t[n].classList.contains("e-dialog")||this.parent.element.id+"_ccdlg"!==t[n].id)&&t[n].ej2_instances[0].hide()},n.prototype.beforeOpenColumnChooserEvent=function(){Object(r.isBlazor)()&&this.parent.isServerRendered&&"none"===this.parent.columnChooserSettings.operator&&(this.parent.columnChooserSettings.operator="startsWith");var n={requestType:"beforeOpenColumnChooser",element:this.parent.element,columns:this.getColumns(),cancel:!1,searchOperator:this.parent.columnChooserSettings.operator};return Object(r.isBlazor)()&&!this.parent.isJsComponent&&(n={requestType:"beforeOpenColumnChooser",cancel:!1,searchOperator:this.parent.columnChooserSettings.operator}),this.parent.trigger(wy,n),this.searchOperator=n.searchOperator,n},n}(),wd=i(10),yu=function(){function n(n){this.hideColumnInclude=!1;this.foreignKeyData={};this.parent=n}return n.getQuery=function(n,t){var i=t.generateQuery(!0).requiresCount();return t.isRemote()&&(n.groupSettings.enableLazyLoading&&n.groupSettings.columns.length?i.lazyLoad=[]:i.take(n.pageSettings.totalRecordsCount)),i},n.prototype.getFData=function(n,t){return tr(t,{},n,this.foreignKeyData[t.field])[0]},n.prototype.getGridRowModel=function(n,t,i,r){var f,o,e,u,s;if(void 0===r&&(r=0),f=[],o=t.length,o){for(e=0;e<o;e++,r++)u={isExpand:!1},u.data=t[e],u.index=r,i.childGrid&&("All"===i.hierarchyPrintMode?u.isExpand=!0:"Expanded"===i.hierarchyPrintMode&&this.parent.expandedRows&&this.parent.expandedRows[r]&&(u.isExpand=i.expandedRows[r].isExpand)),s=new kt(u),s.cells=this.generateCells(n,i),f.push(s);this.processColumns(f)}return f},n.prototype.generateCells=function(n,t){var r=[],e,u,i,f,o;if(t.childGridLevel)for(e=t.childGridLevel,u=0;e>u;u++)r.push(this.generateCell({},h.Indent));for(i=0,f=n;i<f.length;i++)o=f[i],r.push(this.generateCell(o,h.Data));return r},n.prototype.getColumnData=function(n){var r,o=this,u=[],t=n.getForeignKeyColumns(),i,f;if(t.length){for(i=0;i<t.length;i++)f="result"in t[i].dataSource?new e.DataManager(t[i].dataSource.result):t[i].dataSource,u.push(f.executeQuery(new e.Query));r=Promise.all(u).then(function(n){for(var i=0;i<t.length;i++)o.foreignKeyData[t[i].field]=n[i].result})}return r},n.prototype.getHeaders=function(n,t){this.hideColumnInclude=!!t;this.colDepth=sh(n);for(var i=[],r=0;r<this.colDepth;r++)i[r]=new kt({}),i[r].cells=[];return i=this.processColumns(i),{rows:i=this.processHeaderCells(i,n),columns:this.generateActualColumns(n)}},n.prototype.getConvertedWidth=function(n){var t=parseFloat(n);return-1!==n.indexOf("%")?this.parent.element.getBoundingClientRect().width*t/100:t},n.prototype.generateActualColumns=function(n,t){var r,u,i;for(void 0===t&&(t=[]),r=0,u=n;r<u.length;r++)i=u[r],i.commands||(i.columns?(i.visible||this.hideColumnInclude)&&0!==this.getCellCount(i,0)&&this.generateActualColumns(i.columns,t):(i.visible||this.hideColumnInclude)&&t.push(i));return t},n.prototype.processHeaderCells=function(n,t){for(var r=t,i=0;i<r.length;i++)r[i].commands||(n=this.appendGridCells(r[i],n,0));return n},n.prototype.appendGridCells=function(n,t,i){var u;if(n.columns||!1===n.visible&&!this.hideColumnInclude||n.commands){if(n.columns){u=this.getCellCount(n,0);u&&t[i].cells.push(new st({cellType:h.StackedHeader,column:n,colSpan:u}));for(var f=void 0,r=0,e=n.columns.length;r<e;r++)n.columns[r].visible&&!f&&(f=!0),t=this.appendGridCells(n.columns[r],t,i+1)}}else t[i].cells.push(this.generateCell(n,h.Header,this.colDepth-i,i));return t},n.prototype.generateCell=function(n,t,i,r){var u={visible:n.visible,isDataCell:t===h.Data,column:n,cellType:t,rowSpan:i,index:r};return(!u.rowSpan||u.rowSpan<2)&&delete u.rowSpan,new st(u)},n.prototype.processColumns=function(n){var t=this.parent,u=[],i,f,r,e;for(t.enableColumnVirtualization&&(u=t.getColumnIndexesInView()),i=0,f=n.length;i<f;i++)if(t.allowGrouping)for(r=0,e=t.groupSettings.columns.length;r<e;r++)t.enableColumnVirtualization&&-1===u.indexOf(r)||n[i].cells.splice(0,0,this.generateCell({},h.HeaderIndent));return n},n.prototype.getCellCount=function(n,t){if(n.columns)for(var i=0;i<n.columns.length;i++)t=this.getCellCount(n.columns[i],t);else(n.visible||this.hideColumnInclude)&&t++;return t},n.prototype.checkAndExport=function(n,t){Object.keys(n).some(function(t){return!n[t]})||t()},n.prototype.failureHandler=function(n,t,i){var r=this;return function(){n[t.id]=!0;r.checkAndExport(n,i)}},n.prototype.createChildGrid=function(n,t,i,u){var f=new nh(this.parent.detailRowModule.getGridModel(n,t,i)),e,o;return n.isPrinting=!1,f.parentDetails={parentID:n.element.id,parentPrimaryKeys:n.getPrimaryKeyFieldNames(),parentKeyField:n.childGrid.queryString,parentKeyFieldValue:Object(r.getValue)(f.queryString,t.data),parentRowData:t.data},e=ei("child-grid"),o=Object(r.createElement)("div",{id:e,styles:"display: none"}),document.body.appendChild(o),f.id=e,u[e]=!1,{childGrid:f,element:o}},n.prototype.getGridExportColumns=function(n){for(var r=[],t=0,i=n;t<i.length;t++)"checkbox"!==i[t].type&&r.push(i[t]);return r},n}(),bv=function(){function n(n){this.valueFormatter=new er(n);this.internationalization=new r.Internationalization(n)}return n.prototype.returnFormattedValue=function(n,t){return!Object(r.isNullOrUndefined)(n.value)&&n.value?this.valueFormatter.getFormatFunction(t)(n.value):""},n.prototype.formatCellValue=function(n,t){var u,i,f;return(n.isForeignKey&&(n.value=Object(r.getValue)(n.column.foreignKeyValue,tr(n.column,{},n.value)[0])),"number"===n.column.type&&void 0!==n.column.format&&""!==n.column.format)?n.value||0===n.value?this.internationalization.getNumberFormat({format:n.column.format})(n.value):"":"boolean"===n.column.type&&""!==n.value?n.value?"true":"false":"date"!==n.column.type&&"datetime"!==n.column.type&&"time"!==n.column.type||void 0===n.column.format?(Object(r.isNullOrUndefined)(n.column.type)||Object(r.isNullOrUndefined)(n.value))&&Object(r.isNullOrUndefined)(n.value)?"":n.value.toString():("string"==typeof n.value&&(n.value=new Date(n.value)),"string"==typeof n.column.format)?(u=void 0,i=n.column.format,u="date"===n.column.type?t?{type:"date",format:i}:{type:"date",skeleton:i}:"time"===n.column.type?t?{type:"time",format:i}:{type:"time",skeleton:i}:t?{type:"dateTime",format:i}:{type:"dateTime",skeleton:i},this.returnFormattedValue(n,u)):n.column.format instanceof Object&&void 0===n.column.format.type?n.value.toString():(f=void 0,f="date"===n.column.type?{type:n.column.format.type,format:n.column.format.format,skeleton:n.column.format.skeleton}:"time"===n.column.type?{type:"time",format:n.column.format.format,skeleton:n.column.format.skeleton}:{type:"dateTime",format:n.column.format.format,skeleton:n.column.format.skeleton},this.returnFormattedValue(n,f))},n}(),kv=function(){function n(n,t){this.book={};this.workSheet=[];this.rows=[];this.columns=[];this.styles=[];this.rowLength=1;this.expType="AppendToSheet";this.includeHiddenColumn=!1;this.isCsvExport=!1;this.isElementIdChanged=!1;this.foreignKeyData={};this.gridPool={};this.parent=n;this.helper=new yu(n);this.locator=t;this.l10n=this.locator.getService("localization")}return n.prototype.getModuleName=function(){return"ExcelExport"},n.prototype.init=function(n){null!==n.element&&""===n.element.id&&(n.element.id=(new Date).toISOString(),this.isElementIdChanged=!0);this.parent=n;this.parent.isDestroyed||(this.isExporting=void 0,this.book={},this.workSheet=[],this.rows=[],this.columns=[],this.styles=[],this.rowLength=1,this.footer=void 0,this.expType="AppendToSheet",this.includeHiddenColumn=!1,this.exportValueFormatter=new bv(n.locale),n.id=ei("main-grid"),this.gridPool[n.id]=!1)},n.prototype.Map=function(n,t,i,u,f,e){var s=n,o;return this.gridPool={},n.childGrid&&(Object(r.isNullOrUndefined)(t)||"None"!==t.hierarchyExportMode)&&(n.expandedRows=io(n).expandedRows),o={requestType:"beforeExcelExport",gridObject:s,cancel:!1,isMultipleExport:i,workbook:u,isCsv:f,isBlob:e},s.trigger(op,o),o.cancel?new Promise(function(n){return n()}):(this.parent.log("exporting_begin",this.getModuleName()),this.data=new ye(s),this.isExporting=!0,this.isBlob=o.isBlob,this.isCsvExport=!!o.isCsv&&o.isCsv,ke(t)&&va(t,s),this.processRecords(s,t,o.isMultipleExport,o.workbook))},n.prototype.exportingSuccess=function(n){this.isExporting=!1;this.parent.trigger(sp,this.isBlob?{promise:this.blobPromise}:{});this.parent.log("exporting_complete",this.getModuleName());n(this.book)},n.prototype.processRecords=function(n,t,i,u){var f=this,o,s;return Object(r.isNullOrUndefined)(t)||Object(r.isNullOrUndefined)(t.dataSource)?Object(r.isNullOrUndefined)(t)||"CurrentPage"!==t.exportType?(o=[],o.push(this.data.getData({},yu.getQuery(n,this.data))),o.push(this.helper.getColumnData(n)),new Promise(function(r,e){Promise.all(o).then(function(e){f.init(n);f.processInnerRecords(n,t,i,u,e[0]).then(function(){f.exportingSuccess(r)})}).catch(function(n){e(f.book);f.parent.trigger(hi,n)})})):new Promise(function(r){f.init(n);f.processInnerRecords(n,t,i,u,f.parent.getCurrentViewRecords());f.exportingSuccess(r)}):(t.dataSource instanceof e.DataManager||(t.dataSource=new e.DataManager(t.dataSource)),s=t.query?t.query:new e.Query,(Object(r.isNullOrUndefined)(s.isCountRequired)||n.aggregates)&&(s.isCountRequired=!0),new Promise(function(r){t.dataSource.executeQuery(s).then(function(e){f.init(n);f.processInnerRecords(n,t,i,u,e).then(function(){f.exportingSuccess(r)})})}))},n.prototype.processInnerRecords=function(n,t,i,u,f){var e=this;this.groupedColLength=n.groupSettings.columns.length;var h,c=5,s=[],o=!Object(r.isNullOrUndefined)(t);return o&&!Object(r.isNullOrUndefined)(t.multipleExport)&&(this.expType=Object(r.isNullOrUndefined)(t.multipleExport.type)?"AppendToSheet":t.multipleExport.type,Object(r.isNullOrUndefined)(t.multipleExport.blankRows)||(c=t.multipleExport.blankRows)),Object(r.isNullOrUndefined)(u)?(this.workSheet=[],this.rows=[],this.columns=[],this.styles=[]):"NewSheet"===this.expType?(this.workSheet=u.worksheets,this.rows=[],this.columns=[],this.styles=u.styles):(this.workSheet=[],this.rows=u.worksheets[0].rows,this.columns=u.worksheets[0].columns,this.styles=u.styles,this.rowLength=this.rows[this.rows.length-1].index+c,this.rowLength++),o&&(Object(r.isNullOrUndefined)(i)?(Object(r.isNullOrUndefined)(t.header)||this.processExcelHeader(JSON.parse(JSON.stringify(t.header))),Object(r.isNullOrUndefined)(t.footer)||(this.footer=JSON.parse(JSON.stringify(t.footer)))):(Object(r.isNullOrUndefined)(t.header)||!i&&"NewSheet"!==this.expType||this.processExcelHeader(JSON.parse(JSON.stringify(t.header))),Object(r.isNullOrUndefined)(t.footer)||"AppendToSheet"===this.expType&&i||(this.footer=JSON.parse(JSON.stringify(t.footer))))),this.includeHiddenColumn=!!o&&t.includeHiddenColumn,new Promise(function(i){n.childGridLevel=0;s=e.processGridExport(n,t,f);e.globalResolve=i;e.gridPool[n.id]=!0;e.helper.checkAndExport(e.gridPool,e.globalResolve)}).then(function(){var l=[],c,f;return e.organiseRows(s,s[0].index,l),e.rows=e.rows.concat(l),Object(r.isNullOrUndefined)(e.footer)||("AppendToSheet"===e.expType&&!i||"NewSheet"===e.expType)&&e.processExcelFooter(e.footer),c={},(e.columns.length>0&&(c.columns=e.columns),c.rows=e.rows,c.enableRtl=e.parent.enableRtl,e.workSheet.push(c),e.book.worksheets=e.workSheet,e.book.styles=e.styles,n.notify("finalPageSetup",e.book),i)||(e.isCsvExport?(Object(r.isBlazor)()&&n.isServerRendered&&(e.book.isServerRendered=n.isServerRendered),o&&!Object(r.isNullOrUndefined)(t.separator)&&","!==t.separator&&(h=t.separator),f=new wd.Workbook(e.book,"csv",n.locale,n.currencyCode,h),e.isBlob?e.blobPromise=f.saveAsBlob("text/csv"):o&&t.fileName?f.save(t.fileName):f.save("Export.csv")):(f=new wd.Workbook(e.book,"xlsx",n.locale,n.currencyCode),e.isBlob?e.blobPromise=f.saveAsBlob("application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"):o&&t.fileName?f.save(t.fileName):f.save("Export.xlsx")),e.isElementIdChanged&&(n.element.id=""),delete n.expandedRows),u})},n.prototype.organiseRows=function(n,t,i){var u,r,f;if(!n.length)return t;for(u=0;u<n.length;u++)r=n[u],f=r.childRows,f?(r.index=t++,delete r.childRows,i.push(r),t=this.organiseRows(f,t,i)):(r.index=t++,i.push(r));return t},n.prototype.processGridExport=function(n,t,i){var u=[];Object(r.isNullOrUndefined)(t)||Object(r.isNullOrUndefined)(t.theme)||(this.theme=t.theme);n.childGrid&&!Object(r.isNullOrUndefined)(t)&&(n.hierarchyPrintMode=t.hierarchyExportMode||"Expanded");var f=new yu(n),s=ke(t)?lu(t.columns,n.enableColumnVirtualization):f.getGridExportColumns(n.columns),o=f.getHeaders(s,this.includeHiddenColumn),h=n.groupSettings.columns.length;return u=this.processHeaderContent(n,o,h,u),u=Object(r.isNullOrUndefined)(t)||Object(r.isNullOrUndefined)(t.dataSource)||t.dataSource instanceof e.DataManager?Object(r.isNullOrUndefined)(t)||"CurrentPage"!==t.exportType?this.processRecordContent(n,i,o,t,void 0,u,f):this.processRecordContent(n,i,o,t,n.currentViewData,u,f):this.processRecordContent(n,i,o,t,t.dataSource,u,f),n.notify(dp,{excelRows:u,type:"excel"}),u},n.prototype.processRecordContent=function(n,t,i,u,f,e,o){var s,h;return(s=!Object(r.isNullOrUndefined)(f)&&f.length?f:t.result,Object(r.isNullOrUndefined)(s.level)?this.processRecordRows(n,s,i,0,0,u,e,o):this.processGroupedRows(n,s,i,s.level,0,u,e,o),Object(r.isNullOrUndefined)(t.aggregates))||(Object(r.isNullOrUndefined)(f)?(h=t.result.GroupGuid?t.result.records:t.result,this.processAggregates(n,h,e,null,null,null,i.columns)):this.processAggregates(n,t.result,e,f)),e},n.prototype.processGroupedRows=function(n,t,i,u,f,e,o,s){for(var d,g,l,w,et,y=0,b=t;y<b.length;y++){var h=b[y],a=[],c={};c.index=1+u;var k=n.getColumnByField(h.field),ot={value:h.key,column:k,style:void 0,isForeignKey:k.isForeignColumn()},it=n.getColumnByField(h.field).headerText+": "+(k.enableGroupByFormat?h.key:this.exportValueFormatter.formatCellValue(ot))+" - ";if(it+=h.count>1?h.count+" items":h.count+" item",d={captionText:it,type:this.isCsvExport?"CSV":"Excel"},this.parent.trigger(bc,d),c.value=d.captionText,c.style=this.getCaptionThemeStyle(this.theme),g=new we(n).generateRows(h),this.fillAggregates(n,g,t.level+t.childLevels,o,this.rowLength),a.push(c),o[o.length-1].cells.length>0){for(var p=t.level+t.childLevels+g[0].cells.length,v=0,nt=0,rt=o[o.length-1].cells;nt<rt.length;nt++)l=rt[nt],l.index<p&&(p=l.index),l.index>v&&(v=l.index),a[a.length-1].index!==l.index&&a.push(l);for(p-c.index>1&&(c.colSpan=p-c.index);v<i.columns.length+u+t.childLevels;)w={},w.index=v+1,w.style=this.getCaptionThemeStyle(this.theme),a.push(w),v++}else{for(var ut=0,tt=0,ft=i.columns;tt<ft.length;tt++)ft[tt].visible&&ut++;c.colSpan=t.childLevels+ut}(o[o.length-1].cells=a,this.rowLength++,this.groupedColLength<8&&u>1)&&(et={outlineLevel:u-1,isCollapsed:!0},o[o.length-1].grouping=et);!Object(r.isNullOrUndefined)(t.childLevels)&&t.childLevels>0?this.processGroupedRows(n,h.items,i,h.items.level,f,e,o,s):(f=this.processRecordRows(n,h.items,i,u,f,e,o,s),this.processAggregates(n,h,o,void 0,u,!0))}},n.prototype.processRecordRows=function(n,t,i,u,f,e,o,s){for(var a,b,rt,nt,c,l,et,ot,w,ht,p=1,d=[],ct=i.columns,g=0,it=s.getGridRowModel(ct,t,n,f);g<it.length;g++){for(a=it[g],d=[],f++,p=1,b=0,rt=a.cells.length;b<rt;b++)if(nt=a.cells[b],nt.cellType===h.Data){var v=nt.column,ut=v.field,ft=Object(r.isNullOrUndefined)(ut)?"":v.valueAccessor(ut,a.data,v),k=Object(r.isNullOrUndefined)(ft)?"":ft,tt=void 0;(v.isForeignColumn&&v.isForeignColumn()&&(tt=s.getFData(k,v),k=Object(r.getValue)(v.foreignKeyValue,tt)),Object(r.isNullOrUndefined)(k))||(c={},l={data:a.data,column:v,foreignKeyData:tt,value:k,style:void 0,colSpan:1,cell:c},(n.trigger(hp,l),(c=l.cell).index=p+u+n.childGridLevel,c.value=l.value,""===l.data&&n.childGridLevel&&1===p)&&(et={hAlign:"left"},l={style:et},c.colSpan=n.getVisibleColumns().length,c.value=this.l10n.getConstant("EmptyRecord")),(l.colSpan>1&&(c.colSpan=l.colSpan),Object(r.isNullOrUndefined)(l.style))?c.style={name:n.element.id+"column"+(p+u)}:(ot=this.getColumnStyle(n,p+u),c.style=this.mergeOptions(this.styles[ot],l.style)),d.push(c));p++}if(w={index:this.rowLength++,cells:d},this.groupedColLength<8&&u>0?(w.grouping={outlineLevel:u,isCollapsed:!0},o.push(w)):o.push(w),!Object(r.isNullOrUndefined)(n.childGrid)){n.isPrinting=!0;var lt=!Object(r.isNullOrUndefined)(e)&&e.exportType?e.exportType:"AllPages",st=this.helper.createChildGrid(n,a,lt,this.gridPool),y=st.childGrid,at=st.element;y.actionFailure=s.failureHandler(this.gridPool,y,this.globalResolve);y.childGridLevel=n.childGridLevel+1;ht={childGrid:y,row:a,exportProperties:e};this.parent.trigger(ol,ht);y.beforeDataBound=this.childGridCell(w,y,e,a);y.appendTo(at)}n.notify(vl,{rowObj:a,type:"excel",excelRows:o})}return f},n.prototype.childGridCell=function(n,t,i,u){var f=this;return function(e){t.beforeDataBound=null;e.cancel=!0;0===e.result.length&&(e.result=[""]);n.childRows=f.processGridExport(t,i,e);for(var h=f.parent.groupSettings.columns.length,s=n.childRows,o=0;o<s.length;o++)s[o].grouping={outlineLevel:h+t.childGridLevel,isCollapsed:!u.isExpand,isHidden:!u.isExpand};return t.destroy(),Object(r.detach)(t.element),f.gridPool[t.id]=!0,f.helper.checkAndExport(f.gridPool,f.globalResolve),n}},n.prototype.processAggregates=function(n,t,i,u,f,e,o){var l=new pe(n),s,h,c;return n.aggregates.length&&this.parent!==n&&n.aggregateModule.prepareSummaryInfo(),s=void 0,(s=Object(r.isNullOrUndefined)(u)?t:u,void 0===f&&(f=0),n.groupSettings.columns.length>0&&e)?(h=new ef(n).generateRows(s,{level:s.level}),h.length>0&&(i=this.fillAggregates(n,h,f,i))):(f=n.groupSettings.columns.length>0&&!e?n.groupSettings.columns.length:f,c=l.generateRows(s,t.aggregates,null,null,o),c.length>0&&!e&&(i=this.fillAggregates(n,c,f,i))),i},n.prototype.fillAggregates=function(n,t,i,u,f){for(var e,s,a,b,k,tt,v,it,l=0,y=t;l<y.length;l++){for(var o=y[l],c=[],p=0,w=0,d=o.cells;w<d.length;w++)if(e=d[w],s={},e.cellType!==h.DetailFooterIntent&&(e.visible||this.includeHiddenColumn))if(p++,e.isDataCell){var g=!Object(r.isNullOrUndefined)(e.column.footerTemplate),nt=!Object(r.isNullOrUndefined)(e.column.groupFooterTemplate),rt=!Object(r.isNullOrUndefined)(e.column.groupCaptionTemplate);if(s.index=p+i+n.childGridLevel,g)s.value=this.getAggreateValue(h.Summary,e.column.footerTemplate,e,o);else if(nt)s.value=this.getAggreateValue(h.GroupSummary,e.column.groupFooterTemplate,e,o);else if(rt)s.value=this.getAggreateValue(h.CaptionSummary,e.column.groupCaptionTemplate,e,o);else for(a=0,b=Object.keys(o.data[e.column.field]);a<b.length;a++)b[a]===e.column.type&&(Object(r.isNullOrUndefined)(o.data[e.column.field].Sum)?Object(r.isNullOrUndefined)(o.data[e.column.field].Average)?Object(r.isNullOrUndefined)(o.data[e.column.field].Max)?Object(r.isNullOrUndefined)(o.data[e.column.field].Min)?Object(r.isNullOrUndefined)(o.data[e.column.field].Count)?Object(r.isNullOrUndefined)(o.data[e.column.field].TrueCount)?Object(r.isNullOrUndefined)(o.data[e.column.field].FalseCount)?Object(r.isNullOrUndefined)(o.data[e.column.field].Custom)||(s.value=o.data[e.column.field].Custom):s.value=o.data[e.column.field][e.column.field+" - falsecount"]:s.value=o.data[e.column.field][e.column.field+" - truecount"]:s.value=o.data[e.column.field][e.column.field+" - count"]:s.value=o.data[e.column.field][e.column.field+" - min"]:s.value=o.data[e.column.field][e.column.field+" - max"]:s.value=o.data[e.column.field][e.column.field+" - average"]:s.value=o.data[e.column.field][e.column.field+" - sum"]);s.style=this.getCaptionThemeStyle(this.theme);this.aggregateStyle(e.column,s.style,e.column.field);k=e.attributes.style;k.textAlign&&(s.style.hAlign=k.textAlign.toLowerCase());tt={row:o,type:g?"Footer":nt?"GroupFooter":"GroupCaption",style:s};this.parent.trigger(lw,tt);c.push(s)}else void 0===f&&(s.index=p+i+n.childGridLevel,s.style=this.getCaptionThemeStyle(this.theme),c.push(s));Object(r.isNullOrUndefined)(f)?(v={},this.groupedColLength<8&&this.groupedColLength>0?(it={outlineLevel:u[u.length-1].grouping.outlineLevel,isCollapsed:!0},v={index:this.rowLength++,cells:c,grouping:it}):v={index:this.rowLength++,cells:c},u.push(v)):u.push({index:f,cells:c})}return u},n.prototype.aggregateStyle=function(n,t,i){var f=this.parent.getColumnByField(i),u;"object"==typeof n.format?(u=n.format,t.numberFormat=Object(r.isNullOrUndefined)(u.format)?u.skeleton:u.format,Object(r.isNullOrUndefined)(u.type)||(t.type=u.type.toLowerCase())):t.numberFormat=n.format;!Object(r.isNullOrUndefined)(f)&&Object(r.isNullOrUndefined)(t.type)&&(t.type=f.type.toLowerCase())},n.prototype.getAggreateValue=function(n,t,i,u){var f,e={},o;return e[Object(r.getEnumValue)(h,i.cellType)]=Object(r.compile)(t),o=u.data[i.column.field?i.column.field:i.column.columnName],this.parent.isReact||this.parent.isVue?(f=e[Object(r.getEnumValue)(h,i.cellType)](o,this.parent),this.parent.isReact&&this.parent.renderTemplates()):f=e[Object(r.getEnumValue)(h,i.cellType)](o),f[0].textContent},n.prototype.mergeOptions=function(n,t){for(var u={},r=Object.keys(n),i=0;i<r.length;i++)"name"!==r[i]&&(u[r[i]]=n[r[i]]);for(r=Object.keys(t),i=0;i<r.length;i++)"name"!==r[i]&&(u[r[i]]=t[r[i]]);return u},n.prototype.getColumnStyle=function(n,t){for(var r=0,i=0,u=this.styles;i<u.length;i++){if(u[i].name===n.element.id+"column"+t)return r;r++}},n.prototype.processHeaderContent=function(n,t,i,u){var w=t.rows,d=t.columns,g=[],a,s,c,y,p,k,l;if(i>0)for(a=0;a!==i;)this.columns.push({index:a+1,width:30}),a++;for(s=0;s<w.length;s++){for(var o=1+i,nt=[],b=0;b<w[s].cells.length;b++){var v={},e={},f=w[s].cells[b];if(f.cellType!==h.HeaderIndent&&f.cellType!==h.DetailHeader){for(c={contains:!0,index:1};c.contains;)if(o=(c=this.getIndex(g,1,o)).index,!c.contains){e.index=c.index+n.childGridLevel;break}if(!Object(r.isNullOrUndefined)(f.rowSpan)&&1!==f.rowSpan)for(e.rowSpan=f.rowSpan,y=1;y<f.rowSpan+1;y++)p={rowIndex:0,columnIndex:0},p.rowIndex=y,p.columnIndex=o,g.push(p);Object(r.isNullOrUndefined)(f.colSpan)||1===f.colSpan||(e.colSpan=f.colSpan,o=o+e.colSpan-1);e.value=f.column.headerText;v=this.getHeaderThemeStyle(this.theme);Object(r.isNullOrUndefined)(f.column.textAlign)||(v.hAlign=f.column.textAlign.toLowerCase());Object(r.isNullOrUndefined)(f.column.headerTextAlign)||(v.hAlign=f.column.headerTextAlign.toLowerCase());k={cell:e,gridCell:f,style:v};n.trigger(cp,k);e.style=k.style;nt.push(e);o++}}u.push({index:this.rowLength++,cells:nt})}for(l=0;l<d.length;l++)this.parseStyles(n,d[l],this.getRecordThemeStyle(this.theme),i+l+1);return u},n.prototype.getHeaderThemeStyle=function(n){var t={fontSize:12,borders:{color:"#E0E0E0"},bold:!0};return Object(r.isNullOrUndefined)(n)||Object(r.isNullOrUndefined)(n.header)||(t=this.updateThemeStyle(n.header,t)),t},n.prototype.updateThemeStyle=function(n,t){return Object(r.extend)(t,n)},n.prototype.getCaptionThemeStyle=function(n){var t={fontSize:13,backColor:"#F6F6F6"};return Object(r.isNullOrUndefined)(n)||Object(r.isNullOrUndefined)(n.caption)||(t=this.updateThemeStyle(n.caption,t)),t},n.prototype.getRecordThemeStyle=function(n){var t={fontSize:13,borders:{color:"#E0E0E0"}};return Object(r.isNullOrUndefined)(n)||Object(r.isNullOrUndefined)(n.record)||(t=this.updateThemeStyle(n.record,t)),t},n.prototype.processExcelHeader=function(n){var u,t,i;if(!Object(r.isNullOrUndefined)(n.rows)&&("NewSheet"===this.expType||1===this.rowLength))for(u=void 0,this.rowLength=void 0===n.headerRows?n.rows.length:n.headerRows,u=this.rowLength<n.rows.length?this.rowLength:n.rows.length,this.rowLength++,t=0;t<u;t++)i=n.rows[t],(null===i.index||Object(r.isNullOrUndefined)(i.index))&&(i.index=t+1),this.updatedCellIndex(i)},n.prototype.updatedCellIndex=function(n){for(var i,u=n.cells.length,t=0;t<u;t++)i=n.cells[t],(null===i.index||Object(r.isNullOrUndefined)(i.index))&&(i.index=t+1);this.rows.push(n)},n.prototype.processExcelFooter=function(n){var i,u,t;if(!Object(r.isNullOrUndefined)(n.rows))for(i=void 0,void 0===n.footerRows?this.rowLength+=n.rows.length:n.footerRows>n.rows.length?(this.rowLength+=n.footerRows-n.rows.length,i=n.rows.length):i=n.footerRows,u=0;u<i;u++)t=n.rows[u],null===t.index||void 0===t.index?t.index=this.rowLength++:t.index+=this.rowLength,this.updatedCellIndex(t)},n.prototype.getIndex=function(n,t,i){for(var f,r=0,u=n;r<u.length;r++)if(f=u[r],f.rowIndex===t&&f.columnIndex===i)return{contains:!0,index:i+=1};return{contains:!1,index:i}},n.prototype.parseStyles=function(n,t,i,u){if(!Object(r.isNullOrUndefined)(t.format))if("object"==typeof t.format){var f=t.format;i.numberFormat=Object(r.isNullOrUndefined)(f.format)?f.skeleton:f.format;Object(r.isNullOrUndefined)(f.type)||(i.type=f.type.toLowerCase())}else i.numberFormat=t.format,i.type=t.type;Object(r.isNullOrUndefined)(t.textAlign)||(i.hAlign=t.textAlign.toLowerCase());Object.keys(i).length>0&&(i.name=n.element.id+"column"+u,this.styles.push(i));Object(r.isNullOrUndefined)(t.width)||this.columns.push({index:u+n.childGridLevel,width:"number"==typeof t.width?t.width:this.helper.getConvertedWidth(t.width)})},n.prototype.destroy=function(){},n}(),s=i(2),dv=function(){function n(n){this.hideColumnInclude=!1;this.currentViewData=!1;this.customDataSource=!1;this.isGrouping=!1;this.headerOnPages=[];this.drawPosition={xPosition:0,yPosition:0};this.parent=n;this.helper=new yu(n);this.gridPool={}}return n.prototype.getModuleName=function(){return"PdfExport"},n.prototype.init=function(n){this.exportValueFormatter=new bv(n.locale);this.pdfDocument=void 0;this.hideColumnInclude=!1;this.currentViewData=!1;this.parent=n;this.isGrouping=!1;this.isExporting=!0;n.id=ei("main-grid");this.gridPool[n.id]=!1;this.pdfPageSettings=new s.PdfPageSettings},n.prototype.exportWithData=function(n,t,i,u,f,e,o){var h=this;this.init(n);this.pdfDocument=Object(r.isNullOrUndefined)(t)?new s.PdfDocument:t;this.processExport(n,u,f,e).then(function(){h.isExporting=!1;n.trigger(sl,h.isBlob?{promise:h.blobPromise}:{});h.parent.log("exporting_complete",h.getModuleName());i(h.pdfDocument)}).catch(function(n){o(h.pdfDocument);h.parent.trigger(hi,n)})},n.prototype.Map=function(n,t,i,u,f){var o=this,h,c;return(this.data=new ye(this.parent),this.isBlob=f,this.gridPool={},n.childGrid&&(Object(r.isNullOrUndefined)(t)||"None"!==t.hierarchyExportMode)&&(n.expandedRows=io(n).expandedRows),h={requestType:"beforePdfExport",cancel:!1,headerPageNumbers:[],gridDrawPosition:{xPosition:0,yPosition:0}},Object(r.isBlazor)()||(h.gridObject=n),n.trigger(lp,h),!0===h.cancel)?new Promise(function(n){return n()}):(ke(t)&&va(t,n),this.headerOnPages=h.headerPageNumbers,this.drawPosition=h.gridDrawPosition,this.parent.log("exporting_begin",this.getModuleName()),Object(r.isNullOrUndefined)(t)||Object(r.isNullOrUndefined)(t.dataSource))?Object(r.isNullOrUndefined)(t)||"CurrentPage"!==t.exportType?(c=[],c.push(this.data.getData({},yu.getQuery(n,this.data))),c.push(this.helper.getColumnData(n)),new Promise(function(f,e){Promise.all(c).then(function(h){o.init(n);o.pdfDocument=Object(r.isNullOrUndefined)(u)?new s.PdfDocument:u;o.processExport(n,h[0],t,i).then(function(){o.isExporting=!1;n.trigger(sl,o.isBlob?{promise:o.blobPromise}:{});o.parent.log("exporting_complete",o.getModuleName());f(o.pdfDocument)}).catch(function(n){e(o.pdfDocument);o.parent.trigger(hi,n)})})})):new Promise(function(r,f){o.exportWithData(n,u,r,o.parent.getCurrentViewRecords(),t,i,f)}):(t.dataSource instanceof e.DataManager||(t.dataSource=new e.DataManager(t.dataSource)),new Promise(function(r,f){t.dataSource.executeQuery(new e.Query).then(function(e){o.exportWithData(n,u,r,e,t,i,f)})}))},n.prototype.processExport=function(n,t,i,u){var e,f=this,o=this.pdfDocument.sections.add(),s;return this.processSectionExportProperties(o,i),s=o.pages.add(),new Promise(function(r){e=f.processGridExport(n,t,i);f.globalResolve=r;f.gridPool[n.id]=!0;f.helper.checkAndExport(f.gridPool,f.globalResolve)}).then(function(){return e.draw(s,f.drawPosition.xPosition,f.drawPosition.yPosition),f.drawHeader(i),u||(f.isBlob?f.blobPromise=f.pdfDocument.save():!Object(r.isNullOrUndefined)(i)&&i.fileName?f.pdfDocument.save(i.fileName):f.pdfDocument.save("Export.pdf"),f.pdfDocument.destroy(),delete n.expandedRows),f.pdfDocument})},n.prototype.processSectionExportProperties=function(n,t){return Object(r.isNullOrUndefined)(t)||Object(r.isNullOrUndefined)(t.pageOrientation)&&Object(r.isNullOrUndefined)(t.pageSize)||(this.pdfPageSettings.orientation="Landscape"===t.pageOrientation?s.PdfPageOrientation.Landscape:s.PdfPageOrientation.Portrait,this.pdfPageSettings.size=this.getPageSize(t.pageSize),n.setPageSettings(this.pdfPageSettings)),n},n.prototype.processGridExport=function(n,t,i){var y=!0,a,u,l,w;Object(r.isNullOrUndefined)(i)||(this.gridTheme=i.theme,Object(r.isBlazor)()&&!Object(r.isNullOrUndefined)(this.gridTheme)&&this.getGridPdfFont(this.gridTheme),y=!!Object(r.isNullOrUndefined)(i.allowHorizontalOverflow)||i.allowHorizontalOverflow);var h=new yu(n),e=this.processExportProperties(i,t.result),c=ke(i)?lu(i.columns,n.enableColumnVirtualization):h.getGridExportColumns(n.columns);c=c.filter(function(n){return Object(r.isNullOrUndefined)(n.commands)});a=!1;n.groupSettings.columns.length&&(a=!0);n.childGrid&&!Object(r.isNullOrUndefined)(i)&&(n.hierarchyPrintMode=i.hierarchyExportMode||"Expanded");var f=new s.PdfGrid,p=this.getHeaderThemeStyle(),o=p.border,k=p.font,d=p.brush,b=h.getHeaders(c,this.hideColumnInclude),v=b.columns;return f=this.processGridHeaders(n.groupSettings.columns.length,f,b.rows,v,o,k,d,n,y,c),this.setColumnProperties(v,f,h,n,y),u=this.getSummaryCaptionThemeStyle(),!Object(r.isNullOrUndefined)(e)&&e.length?(a?(Object(r.isNullOrUndefined)(u.border)||(o=u.border),this.processGroupedRecords(f,e,v,n,o,0,u.font,u.brush,u.backgroundBrush,t,i,h,0)):this.processRecord(o,v,n,e,f,0,i,h,0),Object(r.isNullOrUndefined)(t.aggregates))||(l=new pe(n),w=void 0,n.aggregates.length&&this.parent!==n&&n.aggregateModule.prepareSummaryInfo(),w=this.customDataSource?l.generateRows(e,t.aggregates):this.currentViewData?l.generateRows(this.parent.getCurrentViewRecords(),t.aggregates):a?l.generateRows(e.records,t.aggregates):l.generateRows(t.result,t.aggregates,null,null,c),this.processAggregates(w,f,o,u.font,u.brush,u.backgroundBrush,!1)):f.rows.addRow().style.setBorder(o),f},n.prototype.getSummaryCaptionThemeStyle=function(){var n,u,t;if(Object(r.isNullOrUndefined)(this.gridTheme)||Object(r.isNullOrUndefined)(this.gridTheme.caption))return{font:new s.PdfStandardFont(s.PdfFontFamily.Helvetica,9.75),brush:new s.PdfSolidBrush(new s.PdfColor(0,0,0)),backgroundBrush:new s.PdfSolidBrush(new s.PdfColor(246,246,246))};var f=Object(r.isNullOrUndefined)(this.gridTheme.caption.fontSize)?9.75:this.gridTheme.caption.fontSize,e=Object(r.isNullOrUndefined)(this.gridTheme.caption.fontName)?s.PdfFontFamily.Helvetica:this.getFontFamily(this.gridTheme.caption.fontName),o=this.getFontStyle(this.gridTheme.caption),i=new s.PdfColor(0,0,0);return Object(r.isNullOrUndefined)(this.gridTheme.caption.fontColor)||(n=this.hexToRgb(this.gridTheme.caption.fontColor),i=new s.PdfColor(n.r,n.g,n.b)),u=this.gridTheme.caption.border?this.getBorderStyle(this.gridTheme.caption.border):null,t=new s.PdfStandardFont(e,f,o),Object(r.isNullOrUndefined)(this.gridTheme.caption.font)||(t=this.gridTheme.caption.font),{font:t,brush:new s.PdfSolidBrush(i),backgroundBrush:new s.PdfSolidBrush(new s.PdfColor(246,246,246)),border:u}},n.prototype.getGridPdfFont=function(n){var t=0,h,a,p;if(n.header&&n.header.font){var i=n.header.font.fontFamily,e=n.header.font.fontSize,o=n.header.font.fontStyle;(t=Object(r.isNullOrUndefined)(s.PdfFontStyle[o])?0:s.PdfFontStyle[o],n.header.font.isTrueType)?n.header.font=new s.PdfTrueTypeFont(i,e,t):(h=Object(r.isNullOrUndefined)(i)?s.PdfFontFamily.Helvetica:this.getFontFamily(i),n.header.font=new s.PdfStandardFont(h,e,t))}if(n.caption&&n.caption.font){var u=n.caption.font.fontFamily,c=n.caption.font.fontSize,l=n.caption.font.fontStyle;(t=Object(r.isNullOrUndefined)(s.PdfFontStyle[l])?0:s.PdfFontStyle[l],n.caption.font.isTrueType)?n.caption.font=new s.PdfTrueTypeFont(u,c,t):(a=Object(r.isNullOrUndefined)(u)?s.PdfFontFamily.Helvetica:this.getFontFamily(u),n.caption.font=new s.PdfStandardFont(a,c,t))}if(n.record&&n.record.font){var f=n.record.font.fontFamily,v=n.record.font.fontSize,y=n.record.font.fontStyle;(t=Object(r.isNullOrUndefined)(s.PdfFontStyle[y])?0:s.PdfFontStyle[y],n.record.font.isTrueType)?n.record.font=new s.PdfTrueTypeFont(f,v,t):(p=Object(r.isNullOrUndefined)(f)?s.PdfFontFamily.Helvetica:this.getFontFamily(f),n.record.font=new s.PdfStandardFont(p,v,t))}},n.prototype.getHeaderThemeStyle=function(){var i=new s.PdfBorders,n,t;if(Object(r.isNullOrUndefined)(this.gridTheme)||Object(r.isNullOrUndefined)(this.gridTheme.header))return i.all=new s.PdfPen(new s.PdfColor(234,234,234)),{border:i,font:new s.PdfStandardFont(s.PdfFontFamily.Helvetica,10.5),brush:new s.PdfSolidBrush(new s.PdfColor(102,102,102))};var f=Object(r.isNullOrUndefined)(this.gridTheme.header.fontName)?s.PdfFontFamily.Helvetica:this.getFontFamily(this.gridTheme.header.fontName),e=this.getFontStyle(this.gridTheme.header),o=Object(r.isNullOrUndefined)(this.gridTheme.header.fontSize)?10.5:this.gridTheme.header.fontSize,u=new s.PdfColor;return Object(r.isNullOrUndefined)(this.gridTheme.header.fontColor)||(n=this.hexToRgb(this.gridTheme.header.fontColor),u=new s.PdfColor(n.r,n.g,n.b)),t=new s.PdfStandardFont(f,o,e),Object(r.isNullOrUndefined)(this.gridTheme.header.font)||(t=this.gridTheme.header.font),{border:this.getBorderStyle(this.gridTheme.header.border),font:t,brush:new s.PdfSolidBrush(u)}},n.prototype.processGroupedRecords=function(n,t,i,u,f,e,o,h,c,l,a,v,y){for(var w=this,p=e,g=function(e){var k=n.rows.addRow(),d=u.getColumnByField(e.field),g={value:e.key,column:d,style:void 0,isForeignKey:d.isForeignColumn()},nt={captionText:b.parent.getColumnByField(e.field).headerText+": "+(d.enableGroupByFormat?e.key:b.exportValueFormatter.formatCellValue(g))+" - "+e.count+(t.count>1?" items":" item"),type:"PDF"};b.parent.trigger(bc,nt,function(b){var d,g;k.cells.getCell(p).value=b.captionText;k.cells.getCell(p+1).style.stringFormat=new s.PdfStringFormat(s.PdfTextAlignment.Left);k.style.setBorder(f);k.style.setFont(o);k.style.setTextBrush(h);k.style.setBackgroundBrush(c);g=new we(u);(d=Object(r.isNullOrUndefined)(e.items.records)?g.generateRows(e.items,e):g.generateRows(e.items.records,e),Object(r.isNullOrUndefined)(d)||0!==d.length||(k.cells.getCell(p+1).columnSpan=n.columns.count-(p+1)),!Object(r.isNullOrUndefined)(t.childLevels)&&t.childLevels>0)?(w.processAggregates(d,n,f,o,h,c,!0,k,p),w.processGroupedRecords(n,e.items,i,u,f,p+1,o,h,c,l,a,v,y),d=new ef(u).generateRows(e.items.records,e),w.processAggregates(d,n,f,o,h,c,!1)):(w.processAggregates(d,n,f,o,h,c,!0,k,p),y=w.processRecord(f,i,u,e.items,n,p+1,a,v,y),d=new ef(u).generateRows(e.items,e),w.processAggregates(d,n,f,o,h,c,!1,null,null,!0))})},b=this,k=0,d=t;k<d.length;k++)g(d[k])},n.prototype.processGridHeaders=function(n,t,i,u,f,e,o,s,c,l){var a=this,w=u.length+n,b=sh(l),k=l,p=0,v,y;return this.parent.allowGrouping&&(p=this.parent.groupSettings.columns.length),t.columns.add(w),t.headers.add(i.length),v=function(n,u,s,c,l){var y=t.headers.getHeader(n),v=y.cells.getCell(u),p=i[n].cells[u],w;Object(r.isNullOrUndefined)(s.headerTextAlign)||(v.style.stringFormat=a.getHorizontalAlignment(s.headerTextAlign));c>0&&(v.rowSpan=c,v.style.stringFormat=a.getVerticalAlignment("Bottom",v.style.stringFormat,s.textAlign));l>0&&(v.columnSpan=l);y.style.setBorder(f);y.style.setFont(e);y.style.setTextBrush(o);v.value=s.headerText;Object(r.isNullOrUndefined)(p)||p.cellType!==h.HeaderIndent&&p.cellType!==h.DetailHeader||(v.value="",v.width=20);w={cell:v,gridCell:p,style:v.style};a.parent.trigger(vp,w)},y=function(n,t,i,r,u,f){for(var o,s=0,e=0;e<n.length;e++)(f&&(r=s=s+i+(0===e?0:-1),i=0),n[e].columns&&n[e].columns.length)?(o=y(n[e].columns,t-1,0,e+r,u+1,!1),v(u,e+r,n[e],0,o),i+=o,r=r+o-1):(n[e].visible||a.hideColumnInclude)&&(i++,v(u,e+r+p,n[e],t,0));return i},y(k,b,0,0,0,!0),t.columns.count>=6&&c&&(t.style.allowHorizontalOverflow=!0),t},n.prototype.processExportProperties=function(n,t){var i;if(Object(r.isNullOrUndefined)(n))this.currentViewData=!1,this.customDataSource=!1;else{if(Object(r.isNullOrUndefined)(n.theme)||(this.gridTheme=n.theme),i=this.pdfPageSettings.size,this.drawHeader(n),!Object(r.isNullOrUndefined)(n.footer)){var u=n.footer,f=new s.PointF(0,i.width-80-.75*u.fromBottom),o=new s.SizeF(i.width-80,.75*u.height),h=new s.RectangleF(f,o);this.pdfDocument.template.bottom=this.drawPageTemplate(new s.PdfPageTemplateElement(h),u)}Object(r.isNullOrUndefined)(n.includeHiddenColumn)||this.isGrouping||(this.hideColumnInclude=n.includeHiddenColumn);Object(r.isNullOrUndefined)(n.dataSource)?Object(r.isNullOrUndefined)(n.exportType)?(this.currentViewData=!1,this.customDataSource=!1):"CurrentPage"===n.exportType?(t=this.parent.currentViewData,this.currentViewData=!0,this.customDataSource=!1):(this.currentViewData=!1,this.customDataSource=!1):(n.dataSource instanceof e.DataManager||(t=n.dataSource),this.customDataSource=!0,this.currentViewData=!1)}return t},n.prototype.drawHeader=function(n){var i=this,e=this.pdfPageSettings.size,f;if(!Object(r.isNullOrUndefined)(n)&&!Object(r.isNullOrUndefined)(n.header)){var t=n.header,o=new s.PointF(0,t.fromTop),h=new s.SizeF(e.width-80,.75*t.height),u=new s.RectangleF(o,h);this.headerOnPages.length?(f=this.drawPageTemplate(new s.PdfPageTemplateElement(u),t),this.headerOnPages.filter(function(n){n-1>=0&&n-1<i.pdfDocument.pages.count-1&&i.pdfDocument.pages.getPageByIndex(n-1).graphics.drawPdfTemplate(f.template,new s.PointF(0,0))})):this.pdfDocument.template.top=this.drawPageTemplate(new s.PdfPageTemplateElement(u),t)}},n.prototype.drawPageTemplate=function(n,t){for(var i,r=0,u=t.contents;r<u.length;r++){i=u[r];switch(this.processContentValidation(i),i.type){case"Text":if(""===i.value||void 0===i.value||null===i.value||"string"!=typeof i.value)throw new Error("please enter the valid input value in text content...");this.drawText(n,i);break;case"PageNumber":this.drawPageNumber(n,i);break;case"Image":if(void 0===i.src||null===i.src||""===i.src)throw new Error("please enter the valid base64 string in image content...");this.drawImage(n,i);break;case"Line":this.drawLine(n,i);break;default:throw new Error("Please set valid content type...");}}return n},n.prototype.processContentValidation=function(n){if(void 0===n.type||null===n.type)throw new Error("please set valid content type...");if("Line"===n.type){if(void 0===n.points||null===n.points)throw new Error("please enter valid points in "+n.type+" content...");if(void 0===n.points.x1||null===n.points.x1||"number"!=typeof n.points.x1)throw new Error("please enter valid x1 co-ordinate in "+n.type+" points...");if(void 0===n.points.y1||null===n.points.y1||"number"!=typeof n.points.y1)throw new Error("please enter valid y1 co-ordinate in "+n.type+" points...");if(void 0===n.points.x2||null===n.points.x2||"number"!=typeof n.points.x2)throw new Error("please enter valid x2 co-ordinate in "+n.type+" points...");if(void 0===n.points.y2||null===n.points.y2||"number"!=typeof n.points.y2)throw new Error("please enter valid y2 co-ordinate in "+n.type+" points...");}else{if(void 0===n.position||null===n.position)throw new Error("please enter valid position in "+n.type+" content...");if(void 0===n.position.x||null===n.position.x||"number"!=typeof n.position.x)throw new Error("please enter valid x co-ordinate in "+n.type+" position...");if(void 0===n.position.y||null===n.position.y||"number"!=typeof n.position.y)throw new Error("please enter valid y co-ordinate in "+n.type+" position...");}},n.prototype.drawText=function(n,t){var o=this.getFont(t),u=this.getBrushFromContent(t),f=null,e;Object(r.isNullOrUndefined)(t.style.textPenColor)||(e=this.hexToRgb(t.style.textPenColor),f=new s.PdfPen(new s.PdfColor(e.r,e.g,e.b)));null==u&&null==f&&(u=new s.PdfSolidBrush(new s.PdfColor(0,0,0)));var h=t.value.toString(),c=.75*t.position.x,l=.75*t.position.y,a=new s.PdfStringFormat,i=this.setContentFormat(t,a);null===i||Object(r.isNullOrUndefined)(i.format)||Object(r.isNullOrUndefined)(i.size)?n.graphics.drawString(h,o,f,u,c,l,a):n.graphics.drawString(h,o,f,u,c,l,i.size.width,i.size.height,i.format)},n.prototype.drawPageNumber=function(n,t){var f=this.getFont(t),e=null,c,u,i,h,l;Object(r.isNullOrUndefined)(t.style.textBrushColor)?e=new s.PdfSolidBrush(new s.PdfColor(0,0,0)):(c=this.hexToRgb(t.style.textBrushColor),e=new s.PdfSolidBrush(new s.PdfColor(c.r,c.g,c.b)));h=new s.PdfPageNumberField(f,e);(h.numberStyle=this.getPageNumberStyle(t.pageNumberType),Object(r.isNullOrUndefined)(t.format))?(i="{0}",u=new s.PdfCompositeField(f,e,i,h)):-1!==t.format.indexOf("$total")&&-1!==t.format.indexOf("$current")?((l=new s.PdfPageCountField(f)).numberStyle=this.getPageNumberStyle(t.pageNumberType),i=t.format.indexOf("$total")>t.format.indexOf("$current")?(i=t.format.replace("$current","0")).replace("$total","1"):(i=t.format.replace("$current","1")).replace("$total","0"),u=new s.PdfCompositeField(f,e,i,h,l)):-1!==t.format.indexOf("$current")&&-1===t.format.indexOf("$total")?(i=t.format.replace("$current","0"),u=new s.PdfCompositeField(f,e,i,h)):(l=new s.PdfPageCountField(f),i=t.format.replace("$total","0"),u=new s.PdfCompositeField(f,e,i,l));var a=.75*t.position.x,v=.75*t.position.y,o=this.setContentFormat(t,u.stringFormat);null===o||Object(r.isNullOrUndefined)(o.format)||Object(r.isNullOrUndefined)(o.size)||(u.stringFormat=o.format,u.bounds=new s.RectangleF(a,v,o.size.width,o.size.height));u.draw(n.graphics,a,v)},n.prototype.drawImage=function(n,t){var i=.75*t.position.x,u=.75*t.position.y,f=Object(r.isNullOrUndefined)(t.size)?void 0:.75*t.size.width,o=Object(r.isNullOrUndefined)(t.size)?void 0:.75*t.size.height,e=new s.PdfBitmap(t.src);Object(r.isNullOrUndefined)(f)?n.graphics.drawImage(e,i,u):n.graphics.drawImage(e,i,u,f,o)},n.prototype.drawLine=function(n,t){var u=.75*t.points.x1,f=.75*t.points.y1,e=.75*t.points.x2,o=.75*t.points.y2,i=this.getPenFromContent(t);Object(r.isNullOrUndefined)(t.style)||null===t.style||(Object(r.isNullOrUndefined)(t.style.penSize)||null===t.style.penSize||"number"!=typeof t.style.penSize||(i.width=.75*t.style.penSize),i.dashStyle=this.getDashStyle(t.style.dashStyle));n.graphics.drawLine(i,u,f,e,o)},n.prototype.processAggregates=function(n,t,i,u,f,e,o,s,c,l){for(var v,it,g,nt,rt,ft,b,a,tt=0,ut=n;tt<ut.length;tt++){for(var p=ut[tt],k=-1,w=0,d=!0,y=[],a=0;a<t.columns.count;a++)if(v=p.cells[w],v.cellType!==h.DetailFooterIntent){if(!this.hideColumnInclude){for(;void 0===v.visible;)v.cellType!==h.DetailFooterIntent&&(Object(r.isNullOrUndefined)(s)?y.push(""):Object(r.isNullOrUndefined)(s.cells.getCell(a).value)?y.push(""):(it={row:p,type:"GroupCaption",style:s.cells},this.parent.trigger(ta,it),y.push(""),y.push(s.cells.getCell(a).value),d=!1,o||(a+=1)),a+=1,w+=1,v=p.cells[w]);for(;!Object(r.isNullOrUndefined)(v.visible)&&!v.visible;)w+=1,v=p.cells[w]}v.isDataCell?(g={},Object(r.isNullOrUndefined)(v.column.footerTemplate)&&Object(r.isNullOrUndefined)(v.column.groupCaptionTemplate)&&Object(r.isNullOrUndefined)(v.column.groupFooterTemplate)?(nt=this.getSummaryWithoutTemplate(p.data[v.column.field]),Object(r.isNullOrUndefined)(nt)||y.push(nt)):(g=(nt=this.getTemplateFunction(g,a,k,v)).templateFunction,k=nt.leastCaptionSummaryIndex,rt=void 0,ft=p.data[v.column.field?v.column.field:v.column.columnName],this.parent.isReact||this.parent.isVue?(rt=g[Object(r.getEnumValue)(h,v.cellType)](ft,this.parent),this.parent.isReact&&this.parent.renderTemplates()):rt=g[Object(r.getEnumValue)(h,v.cellType)](ft),y.push(rt[0].textContent),d=!1)):y.push("");d&&""!==y[a]&&!Object(r.isNullOrUndefined)(y[a])&&null!==y[a]&&(d=!1);w+=1}else a--,w++;if(o)for(a=this.parent.groupSettings.columns.length+1;a<y.length-1;a++)y[a]=y[a+1];if(!d)if(o)for(a=0;a<t.columns.count;a++)s.cells.getCell(a).value=y[a].toString(),a===c+1&&-1!==k&&1!==k?s.cells.getCell(a).columnSpan=k-(c+1):a===c+1&&-1===k&&(s.cells.getCell(a).columnSpan=t.columns.count-(c+1));else for(b=t.rows.addRow(),b.style.setBorder(i),b.style.setFont(u),b.style.setTextBrush(f),b.style.setBackgroundBrush(e),it={row:p,type:l?"GroupFooter":"Footer",style:b.cells},this.parent.trigger(ta,it),a=0;a<t.columns.count;a++)b.cells.getCell(a).value=y[a].toString()}},n.prototype.getTemplateFunction=function(n,t,i,u){return Object(r.isNullOrUndefined)(u.column.footerTemplate)||u.cellType!==h.Summary?Object(r.isNullOrUndefined)(u.column.groupCaptionTemplate)?n[Object(r.getEnumValue)(h,h.GroupSummary)]=Object(r.compile)(u.column.groupFooterTemplate):(-1===i&&(i=t),n[Object(r.getEnumValue)(h,h.CaptionSummary)]=Object(r.compile)(u.column.groupCaptionTemplate)):n[Object(r.getEnumValue)(h,h.Summary)]=Object(r.compile)(u.column.footerTemplate),{templateFunction:n,leastCaptionSummaryIndex:i}},n.prototype.getSummaryWithoutTemplate=function(n){return Object(r.isNullOrUndefined)(n.Sum)?Object(r.isNullOrUndefined)(n.Average)?Object(r.isNullOrUndefined)(n.Max)?Object(r.isNullOrUndefined)(n.Min)?Object(r.isNullOrUndefined)(n.Count)?Object(r.isNullOrUndefined)(n.TrueCount)?Object(r.isNullOrUndefined)(n.FalseCount)?Object(r.isNullOrUndefined)(n.Custom)?void 0:n.Custom:n.FalseCount:n.TrueCount:n.Count:n.Min:n.Max:n.Average:n.Sum},n.prototype.setColumnProperties=function(n,t,i,u,f){for(var o=u.groupSettings.columns.length,e=0;e<o;e++)t.columns.getColumn(e).width=20;for(e=0;e<n.length;e++)Object(r.isNullOrUndefined)(n[e].textAlign)||(t.columns.getColumn(e+o).format=this.getHorizontalAlignment(n[e].textAlign)),t.style.allowHorizontalOverflow&&!Object(r.isNullOrUndefined)(n[e].width)&&f&&(t.columns.getColumn(e+o).width="number"==typeof n[e].width?.75*n[e].width:.75*i.getConvertedWidth(n[e].width))},n.prototype.setRecordThemeStyle=function(n,t){var u,i,e;if(Object(r.isNullOrUndefined)(this.gridTheme)||Object(r.isNullOrUndefined)(this.gridTheme.record))n.style.setTextBrush(new s.PdfSolidBrush(new s.PdfColor(0,0,0)));else{var o=Object(r.isNullOrUndefined)(this.gridTheme.record.fontName)?s.PdfFontFamily.Helvetica:this.getFontFamily(this.gridTheme.record.fontName),h=Object(r.isNullOrUndefined)(this.gridTheme.record.fontSize)?9.75:this.gridTheme.record.fontSize,c=this.getFontStyle(this.gridTheme.record),f=new s.PdfStandardFont(o,h,c);Object(r.isNullOrUndefined)(this.gridTheme.record.font)||(f=this.gridTheme.record.font);n.style.setFont(f);u=new s.PdfColor;Object(r.isNullOrUndefined)(this.gridTheme.record.fontColor)||(i=this.hexToRgb(this.gridTheme.record.fontColor),u=new s.PdfColor(i.r,i.g,i.b));n.style.setTextBrush(new s.PdfSolidBrush(u))}return e=this.gridTheme&&this.gridTheme.record&&this.gridTheme.record.border?this.getBorderStyle(this.gridTheme.record.border):t,n.style.setBorder(e),n},n.prototype.processRecord=function(n,t,i,u,f,e,o,c,l){for(var v,tt,g,y,rt,a,k=0,nt=c.getGridRowModel(t,u,i,l);k<nt.length;k++){v=nt[k];l++;for(var d=this.setRecordThemeStyle(f.rows.addRow(),n),st=v.cells.length,p=0;p<st;p++)if(tt=v.cells[p],tt.cellType===h.Data){var w=tt.column,ut=w.field,ft=Object(r.isNullOrUndefined)(ut)?"":w.valueAccessor(ut,v.data,w),it=Object(r.isNullOrUndefined)(ft)?"":ft,et=void 0;if(w.isForeignColumn&&w.isForeignColumn()&&(et=c.getFData(it,w),it=Object(r.getValue)(w.foreignKeyValue,et)),(a={data:v.data,value:it,column:w,style:void 0,colSpan:1,cell:y=d.cells.getCell(p)}).value=this.exportValueFormatter.formatCellValue(a,i.isServerRendered),this.parent.trigger(ap,a),y.value=a.value,Object(r.isNullOrUndefined)(a.style)||this.processCellStyle(y,a),a.colSpan>1){for(p+1+a.colSpan>d.cells.count&&(a.colSpan=d.cells.count-(p+1)),y.columnSpan=a.colSpan,g=1;g<y.columnSpan;g++)d.cells.getCell(p+g).value="";p+=a.colSpan-1}}if(v.isExpand){rt=this.setRecordThemeStyle(f.rows.addRow(),n);(y=rt.cells.getCell(e)).columnSpan=rt.cells.count-e;y.style.cellPadding=new s.PdfPaddings(10,10,10,10);i.isPrinting=!0;var ht=!Object(r.isNullOrUndefined)(o)&&o.exportType?o.exportType:"AllPages",ot=this.helper.createChildGrid(i,v,ht,this.gridPool),b=ot.childGrid,ct=ot.element;b.actionFailure=c.failureHandler(this.gridPool,b,this.globalResolve);a={childGrid:b,row:v,cell:y,exportProperties:o};this.parent.trigger(ol,a);b.beforeDataBound=this.childGridCell(y,b,o);b.appendTo(ct)}this.parent.notify(vl,{type:"pdf",rowObj:v})}return l},n.prototype.childGridCell=function(n,t,i){var u=this;return function(f){return t.beforeDataBound=null,f.cancel=!0,n.value=u.processGridExport(t,f,i),t.destroy(),Object(r.detach)(t.element),u.gridPool[t.id]=!0,u.helper.checkAndExport(u.gridPool,u.globalResolve),n}},n.prototype.processCellStyle=function(n,t){var i,u,f,e,h;if(Object(r.isNullOrUndefined)(t.style.backgroundColor)||(i=this.hexToRgb(t.style.backgroundColor),n.style.backgroundBrush=new s.PdfSolidBrush(new s.PdfColor(i.r,i.g,i.b))),(Object(r.isNullOrUndefined)(t.style.textAlignment)||(n.style.stringFormat=this.getHorizontalAlignment(t.style.textAlignment)),Object(r.isNullOrUndefined)(t.style.cellPadding)||(n.style.cellPadding=t.style.cellPadding),Object(r.isNullOrUndefined)(t.style.verticalAlignment)||(n.style.stringFormat=this.getVerticalAlignment(t.style.verticalAlignment,n.style.stringFormat)),Object(r.isNullOrUndefined)(t.style.textBrushColor))||(u=this.hexToRgb(t.style.textBrushColor),n.style.textBrush=new s.PdfSolidBrush(new s.PdfColor(u.r,u.g,u.b))),Object(r.isNullOrUndefined)(t.style.textPenColor)||(f=this.hexToRgb(t.style.textPenColor),n.style.textPen=new s.PdfPen(new s.PdfColor(f.r,f.g,f.b))),Object(r.isNullOrUndefined)(t.style.fontFamily)&&Object(r.isNullOrUndefined)(t.style.fontSize)&&Object(r.isNullOrUndefined)(t.style.bold)&&Object(r.isNullOrUndefined)(t.style.italic)&&Object(r.isNullOrUndefined)(t.style.underline)&&Object(r.isNullOrUndefined)(t.style.strikeout)||(n.style.font=this.getFont(t)),!Object(r.isNullOrUndefined)(t.style.border)){var c=new s.PdfBorders,o=t.style.border.width,a=Object(r.isNullOrUndefined)(o)||"number"!=typeof o?void 0:.75*o,l=new s.PdfColor(196,196,196);Object(r.isNullOrUndefined)(t.style.border.color)||(e=this.hexToRgb(t.style.border.color),l=new s.PdfColor(e.r,e.g,e.b));h=new s.PdfPen(l,a);Object(r.isNullOrUndefined)(t.style.border.dashStyle)||(h.dashStyle=this.getDashStyle(t.style.border.dashStyle));c.all=h;n.style.borders=c}Object(r.isNullOrUndefined)(t.style.paragraphIndent)||(n.style.stringFormat=new s.PdfStringFormat,n.style.stringFormat.paragraphIndent=t.style.paragraphIndent)},n.prototype.getHorizontalAlignment=function(n,t){switch(void 0===t&&(t=new s.PdfStringFormat),n){case"Right":t.alignment=s.PdfTextAlignment.Right;break;case"Center":t.alignment=s.PdfTextAlignment.Center;break;case"Justify":t.alignment=s.PdfTextAlignment.Justify;break;case"Left":t.alignment=s.PdfTextAlignment.Left}return t},n.prototype.getVerticalAlignment=function(n,t,i){switch(void 0===t&&(t=new s.PdfStringFormat,t=this.getHorizontalAlignment(i,t)),n){case"Bottom":t.lineAlignment=s.PdfVerticalAlignment.Bottom;break;case"Middle":t.lineAlignment=s.PdfVerticalAlignment.Middle;break;case"Top":t.lineAlignment=s.PdfVerticalAlignment.Top}return t},n.prototype.getFontFamily=function(n){switch(n){case"TimesRoman":return 2;case"Courier":return 1;case"Symbol":return 3;case"ZapfDingbats":return 4;default:return 0}},n.prototype.getFont=function(n){if(n.font)return n.font;var i=Object(r.isNullOrUndefined)(n.style.fontSize)?9.75:.75*n.style.fontSize,u=Object(r.isNullOrUndefined)(n.style.fontFamily)?s.PdfFontFamily.TimesRoman:this.getFontFamily(n.style.fontFamily),t=s.PdfFontStyle.Regular;return!Object(r.isNullOrUndefined)(n.style.bold)&&n.style.bold&&(t|=s.PdfFontStyle.Bold),!Object(r.isNullOrUndefined)(n.style.italic)&&n.style.italic&&(t|=s.PdfFontStyle.Italic),!Object(r.isNullOrUndefined)(n.style.underline)&&n.style.underline&&(t|=s.PdfFontStyle.Underline),!Object(r.isNullOrUndefined)(n.style.strikeout)&&n.style.strikeout&&(t|=s.PdfFontStyle.Strikeout),new s.PdfStandardFont(u,i,t)},n.prototype.getPageNumberStyle=function(n){switch(n){case"LowerLatin":return 2;case"LowerRoman":return 3;case"UpperLatin":return 4;case"UpperRoman":return 5;default:return 1}},n.prototype.setContentFormat=function(n,t){if(!Object(r.isNullOrUndefined)(n.size)){var i=.75*n.size.width,u=.75*n.size.height;if(t=new s.PdfStringFormat(s.PdfTextAlignment.Left,s.PdfVerticalAlignment.Middle),!Object(r.isNullOrUndefined)(n.style.hAlign))switch(n.style.hAlign){case"Right":t.alignment=s.PdfTextAlignment.Right;break;case"Center":t.alignment=s.PdfTextAlignment.Center;break;case"Justify":t.alignment=s.PdfTextAlignment.Justify;break;default:t.alignment=s.PdfTextAlignment.Left}return Object(r.isNullOrUndefined)(n.style.vAlign)||(t=this.getVerticalAlignment(n.style.vAlign,t)),{format:t,size:new s.SizeF(i,u)}}return null},n.prototype.getPageSize=function(n){switch(n){case"Letter":return new s.SizeF(612,792);case"Note":return new s.SizeF(540,720);case"Legal":return new s.SizeF(612,1008);case"A0":return new s.SizeF(2380,3368);case"A1":return new s.SizeF(1684,2380);case"A2":return new s.SizeF(1190,1684);case"A3":return new s.SizeF(842,1190);case"A5":return new s.SizeF(421,595);case"A6":return new s.SizeF(297,421);case"A7":return new s.SizeF(210,297);case"A8":return new s.SizeF(148,210);case"A9":return new s.SizeF(105,148);case"B0":return new s.SizeF(2836,4008);case"B1":return new s.SizeF(2004,2836);case"B2":return new s.SizeF(1418,2004);case"B3":return new s.SizeF(1002,1418);case"B4":return new s.SizeF(709,1002);case"B5":return new s.SizeF(501,709);case"Archa":return new s.SizeF(648,864);case"Archb":return new s.SizeF(864,1296);case"Archc":return new s.SizeF(1296,1728);case"Archd":return new s.SizeF(1728,2592);case"Arche":return new s.SizeF(2592,3456);case"Flsa":return new s.SizeF(612,936);case"HalfLetter":return new s.SizeF(396,612);case"Letter11x17":return new s.SizeF(792,1224);case"Ledger":return new s.SizeF(1224,792);default:return new s.SizeF(595,842)}},n.prototype.getDashStyle=function(n){switch(n){case"Dash":return 1;case"Dot":return 2;case"DashDot":return 3;case"DashDotDot":return 4;default:return 0}},n.prototype.getPenFromContent=function(n){var i=new s.PdfPen(new s.PdfColor(0,0,0)),t;return Object(r.isNullOrUndefined)(n.style)||null===n.style||Object(r.isNullOrUndefined)(n.style.penColor)||(t=this.hexToRgb(n.style.penColor),i=new s.PdfPen(new s.PdfColor(t.r,t.g,t.b))),i},n.prototype.getBrushFromContent=function(n){var i=null,t;return Object(r.isNullOrUndefined)(n.style.textBrushColor)||(t=this.hexToRgb(n.style.textBrushColor),i=new s.PdfSolidBrush(new s.PdfColor(t.r,t.g,t.b))),i},n.prototype.hexToRgb=function(n){if(null===n||""===n||7!==n.length)throw new Error("please set valid hex value for color...");n=n.substring(1);var t=parseInt(n,16);return{r:t>>16&255,g:t>>8&255,b:255&t}},n.prototype.getFontStyle=function(n){var t=s.PdfFontStyle.Regular;return!Object(r.isNullOrUndefined)(n)&&n.bold&&(t|=s.PdfFontStyle.Bold),!Object(r.isNullOrUndefined)(n)&&n.italic&&(t|=s.PdfFontStyle.Italic),!Object(r.isNullOrUndefined)(n)&&n.underline&&(t|=s.PdfFontStyle.Underline),!Object(r.isNullOrUndefined)(n)&&n.strikeout&&(t|=s.PdfFontStyle.Strikeout),t},n.prototype.getBorderStyle=function(n){var i=new s.PdfBorders,t,f;if(Object(r.isNullOrUndefined)(n))i.all=new s.PdfPen(new s.PdfColor(234,234,234));else{var u=n.width,o=Object(r.isNullOrUndefined)(u)||"number"!=typeof u?void 0:.75*u,e=new s.PdfColor(196,196,196);Object(r.isNullOrUndefined)(n.color)||(t=this.hexToRgb(n.color),e=new s.PdfColor(t.r,t.g,t.b));f=new s.PdfPen(e,o);Object(r.isNullOrUndefined)(n.dashStyle)||(f.dashStyle=this.getDashStyle(n.dashStyle));i.all=f}return i},n.prototype.destroy=function(){},n}(),trt=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),bd=function(n){function t(t,i){var r=n.call(this,t,i)||this;return r.buttonElement=r.parent.createElement("button",{}),r.unbounDiv=r.parent.createElement("div",{className:"e-unboundcelldiv",styles:"display: inline-block"}),r.element=r.parent.createElement("TD",{className:"e-rowcell e-unboundcell",attrs:{role:"gridcell",tabindex:"-1"}}),r}return trt(t,n),t.prototype.render=function(n,t,i){var u=this.element.cloneNode(),s,f,e,o;if(u.appendChild(this.unbounDiv.cloneNode()),u.setAttribute("aria-label","is Command column column header "+n.column.headerText),n.column.commandsTemplate)this.parent.isReact&&"string"!=typeof n.column.commandsTemplate?(s=this.parent+"commandsTemplate",n.column.getColumnTemplate()(t,this.parent,"commandsTemplate",s,null,null,u.firstElementChild),this.parent.renderTemplates()):rt(u.firstElementChild,n.column.getColumnTemplate()(t));else for(f=0,e=n.commands;f<e.length;f++)o=e[f],u=this.renderButton(u,o,i.index,o.uid);return this.setAttributes(u,n,i),this.parent.isEdit?(Object(r.addClass)(u.querySelectorAll(".e-edit-delete"),"e-hide"),Object(r.removeClass)(u.querySelectorAll(".e-save-cancel"),"e-hide")):(Object(r.addClass)(u.querySelectorAll(".e-save-cancel"),"e-hide"),Object(r.removeClass)(u.querySelectorAll(".e-edit-delete"),"e-hide")),u},t.prototype.renderButton=function(n,t,i,u){var f=this.buttonElement.cloneNode(),e;Object(r.attributes)(f,{id:this.parent.element.id+(t.type||"")+"_"+i+"_"+u,type:"button",title:Object(r.isNullOrUndefined)(t.title)?t.buttonOption.content||this.localizer.getConstant(t.type)||t.type:t.title,"data-uid":u});f.onclick=t.buttonOption.click;e=new gt.Button(t.buttonOption,f);switch(e.commandType=t.type,n.firstElementChild.appendChild(e.element),t.type){case"Edit":case"Delete":Object(r.addClass)([f],["e-edit-delete","e-"+t.type.toLowerCase()+"button"]);break;case"Cancel":case"Save":Object(r.addClass)([f],["e-save-cancel","e-"+t.type.toLowerCase()+"button"])}return n},t}(ht),irt=function(){function n(n,t){this.parent=n;this.locator=t;this.initiateRender();this.addEventListener()}return n.prototype.initiateRender=function(){this.locator.getService("cellRendererFactory").addCellRenderer(h.CommandColumn,new bd(this.parent,this.locator))},n.prototype.commandClickHandler=function(n){var t=this.parent,f=(t.element.id,Object(r.closest)(n.target,"button")),u,i,v;if(f&&Object(r.closest)(n.target,".e-unboundcell")){for(var o,c=f.ej2_instances[0],s=c.commandType,l=f.getAttribute("data-uid"),a=t.getRowObjectFromUID(Object(r.closest)(f,".e-row").getAttribute("data-uid")),h=this.parent.columnModel,e=0;e<h.length;e++)if(h[e].commands)for(u=h[e].commands,i=0;i<u.length;i++)Object(r.isBlazor)()&&!t.isJsComponent&&u[i].uid===l?(o=u[i],s=u[i].type):u[i].uid===l&&u[i].type===s&&(o=u[i]);v={cancel:!1,target:f,commandColumn:o,rowData:Object(r.isNullOrUndefined)(a)?void 0:a.data};this.parent.trigger(rp,v,function(n){if(!c.disabled&&t.editModule&&!n.cancel)switch(s){case"Edit":t.editModule.endEdit();t.editModule.startEdit(Object(r.closest)(f,"tr"));break;case"Cancel":t.editModule.closeEdit();break;case"Save":t.editModule.endEdit();break;case"Delete":"Batch"!==t.editSettings.mode&&t.editModule.endEdit();t.commandDelIndex=parseInt(Object(r.closest)(f,"tr").getAttribute("aria-rowindex"),10);t.clearSelection();t.selectRow(t.commandDelIndex,!1);t.editModule.deleteRecord();t.commandDelIndex=void 0}})}},n.prototype.getModuleName=function(){return"commandColumn"},n.prototype.destroy=function(){this.parent.isDestroyed||this.removeEventListener()},n.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(it,this.commandClickHandler),this.parent.off(w,this.keyPressHandler),this.parent.off(tt,this.load))},n.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(it,this.commandClickHandler,this),this.parent.on(w,this.keyPressHandler,this),this.parent.on(tt,this.load,this))},n.prototype.keyPressHandler=function(n){"enter"===n.action&&Object(r.closest)(n.target,".e-unboundcelldiv")&&(this.commandClickHandler(n),n.preventDefault())},n.prototype.load=function(){var t,n,u,i;if(!Object(r.isBlazor)()||this.parent.isJsComponent)for(t=this.parent.columnModel,n=0;n<t.length;n++)if(t[n].commands)for(u=t[n].commands,i=0;i<u.length;i++)u[i].uid=ei("gridcommand")},n}(),a={header:".e-gridheader",content:".e-gridcontent",edit:".e-inline-edit",batchEdit:".e-editedbatchcell",editIcon:"e-edit",pager:".e-gridpager","delete":"e-delete",save:"e-save",cancel:"e-cancel",copy:"e-copy",pdf:"e-pdfexport",group:"e-icon-group",ungroup:"e-icon-ungroup",csv:"e-csvexport",excel:"e-excelexport",fPage:"e-icon-first",nPage:"e-icon-next",lPage:"e-icon-last",pPage:"e-icon-prev",ascending:"e-icon-ascending",descending:"e-icon-descending",groupHeader:"e-groupdroparea",touchPop:"e-gridpopup"},rrt=function(){function n(n,t){this.defaultItems={};this.disableItems=[];this.hiddenItems=[];this.localeText=this.setLocaleKey();this.parent=n;this.gridID=n.element.id;this.serviceLocator=t;this.addEventListener()}return n.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(v,this.enableAfterRenderMenu,this),this.parent.on(ii,this.render,this))},n.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(ii,this.render),this.parent.off(v,this.enableAfterRenderMenu),r.EventHandler.remove(this.element,"keydown",this.keyDownHandler.bind(this)))},n.prototype.keyDownHandler=function(n){"Tab"!==n.code&&9!==n.which||this.contextMenu.close();"Escape"===n.code&&(this.contextMenu.close(),this.parent.notify(fu,{}))},n.prototype.render=function(){this.parent.element.classList.add("e-noselect");this.l10n=this.serviceLocator.getService("localization");this.element=this.parent.createElement("ul",{id:this.gridID+"_cmenu"});r.EventHandler.add(this.element,"keydown",this.keyDownHandler.bind(this));this.parent.element.appendChild(this.element);var n="#"+this.gridID;this.contextMenu=new yf.ContextMenu({items:this.getMenuItems(),enableRtl:this.parent.enableRtl,enablePersistence:this.parent.enablePersistence,locale:this.parent.locale,target:n,select:this.contextMenuItemClick.bind(this),beforeOpen:this.contextMenuBeforeOpen.bind(this),onOpen:this.contextMenuOpen.bind(this),onClose:this.contextMenuOnClose.bind(this),cssClass:"e-grid-menu"});this.contextMenu.appendTo(this.element)},n.prototype.enableAfterRenderMenu=function(n){n.module===this.getModuleName()&&n.enable&&(this.contextMenu&&(this.contextMenu.destroy(),Object(r.remove)(this.element),this.parent.element.classList.remove("e-noselect")),this.render())},n.prototype.getMenuItems=function(){for(var n,u,t=[],i=[],r=0,f=this.parent.contextMenuItems;r<f.length;r++)n=f[r],"string"==typeof n&&-1!==this.getDefaultItems().indexOf(n)?-1!==n.toLocaleLowerCase().indexOf("export")?i.push(this.buildDefaultItems(n)):t.push(this.buildDefaultItems(n)):"string"!=typeof n&&t.push(n);return i.length>0&&(u=this.buildDefaultItems("export"),u.items=i,t.push(u)),t},n.prototype.getLastPage=function(){var n=Math.floor(this.parent.pageSettings.totalRecordsCount/this.parent.pageSettings.pageSize);return this.parent.pageSettings.totalRecordsCount%this.parent.pageSettings.pageSize&&(n+=1),n},n.prototype.contextMenuOpen=function(){this.isOpen=!0},n.prototype.contextMenuItemClick=function(n){switch(this.getKeyFromId(n.item.id)){case"AutoFitAll":this.parent.autoFitColumns([]);break;case"AutoFit":this.parent.autoFitColumns(this.targetColumn.field);break;case"Group":this.parent.groupColumn(this.targetColumn.field);break;case"Ungroup":this.parent.ungroupColumn(this.targetColumn.field);break;case"Edit":this.parent.editModule&&("Batch"===this.parent.editSettings.mode?this.row&&this.cell&&!isNaN(parseInt(this.cell.getAttribute("aria-colindex"),10))&&this.parent.editModule.editCell(parseInt(this.row.getAttribute("aria-rowindex"),10),this.parent.getColumns()[parseInt(this.cell.getAttribute("aria-colindex"),10)].field):(this.parent.editModule.endEdit(),this.parent.editModule.startEdit(this.row)));break;case"Delete":this.parent.editModule&&("Batch"!==this.parent.editSettings.mode&&this.parent.editModule.endEdit(),1===this.parent.getSelectedRecords().length?this.parent.editModule.deleteRow(this.row):this.parent.deleteRecord());break;case"Save":this.parent.editModule&&this.parent.editModule.endEdit();break;case"Cancel":this.parent.editModule&&this.parent.editModule.closeEdit();break;case"Copy":this.parent.copy();break;case"PdfExport":this.parent.pdfExport();break;case"ExcelExport":this.parent.excelExport();break;case"CsvExport":this.parent.csvExport();break;case"SortAscending":this.isOpen=!1;this.parent.sortColumn(this.targetColumn.field,"Ascending");break;case"SortDescending":this.isOpen=!1;this.parent.sortColumn(this.targetColumn.field,"Descending");break;case"FirstPage":this.parent.goToPage(1);break;case"PrevPage":this.parent.goToPage(this.parent.pageSettings.currentPage-1);break;case"LastPage":this.parent.goToPage(this.getLastPage());break;case"NextPage":this.parent.goToPage(this.parent.pageSettings.currentPage+1)}if(n.column=this.targetColumn,n.rowInfo=this.targetRowdata,Object(r.isBlazor)()){var t=n.rowInfo.row?{element:n.element,item:n.item,event:n.event,column:this.targetColumn,rowInfo:{rowData:this.targetRowdata.rowData,rowIndex:this.targetRowdata.rowIndex,cellIndex:this.targetRowdata.cellIndex}}:this.targetColumn?{element:n.element,item:n.item,event:n.event,column:this.targetColumn}:{element:n.element,item:n.item,event:n.event};this.parent.trigger(hl,t)}else this.parent.trigger(hl,n)},n.prototype.contextMenuOnClose=function(n){n.items.length>0&&n.items[0].parentObj instanceof yf.ContextMenu&&this.updateItemStatus()},n.prototype.getLocaleText=function(n){return this.l10n.getConstant(this.localeText[n])},n.prototype.updateItemStatus=function(){this.contextMenu.showItems(this.hiddenItems);this.contextMenu.enableItems(this.disableItems);this.hiddenItems=[];this.disableItems=[];this.isOpen=!1},n.prototype.contextMenuBeforeOpen=function(n){var o=Object(r.closest)(n.event.target,".e-grid");if(n.event&&o&&o!==this.parent.element)n.cancel=!0;else if(n.event&&(Object(r.closest)(n.event.target,"."+a.groupHeader)||Object(r.closest)(n.event.target,"."+a.touchPop)||Object(r.closest)(n.event.target,".e-summarycell")||Object(r.closest)(n.event.target,".e-groupcaption")||Object(r.closest)(n.event.target,".e-filterbarcell")))n.cancel=!0;else{this.targetColumn=this.getColumn(n.event);this.targetRowdata=this.parent.getRowInfo(n.event.target);Object(r.isNullOrUndefined)(n.parentItem)&&this.targetColumn&&this.targetRowdata.cell&&this.selectRow(n.event,!this.targetRowdata.cell.classList.contains("e-selectionbackground")||"Multiple"!==this.parent.selectionSettings.type);for(var u=[],f=[],e=0,s=n.items;e<s.length;e++){var t=s[e],i=this.getKeyFromId(t.id),h=this.defaultItems[i];if(-1!==this.getDefaultItems().indexOf(i))if(this.ensureDisabledStatus(i)&&this.disableItems.push(t.text),n.event&&(this.ensureTarget(n.event.target,a.edit)||this.ensureTarget(n.event.target,a.batchEdit)))"Save"!==i&&"Cancel"!==i&&this.hiddenItems.push(t.text);else{if(this.parent.editModule&&"Batch"===this.parent.editSettings.mode&&(Object(r.closest)(n.event.target,".e-gridform")||this.parent.editModule.getBatchChanges().changedRecords.length||this.parent.editModule.getBatchChanges().addedRecords.length||this.parent.editModule.getBatchChanges().deletedRecords.length)&&("Save"===i||"Cancel"===i))continue;Object(r.isNullOrUndefined)(n.parentItem)&&n.event&&!this.ensureTarget(n.event.target,h.target)&&this.hiddenItems.push(t.text)}else t.target&&n.event&&!this.ensureTarget(n.event.target,t.target)?t.separator?u.push(t.id):this.hiddenItems.push(t.text):this.ensureTarget(n.event.target,t.target)&&t.separator&&f.push(t.id)}f.length>0&&this.contextMenu.showItems(f,!0);this.contextMenu.enableItems(this.disableItems,!1);this.contextMenu.hideItems(this.hiddenItems);u.length>0&&this.contextMenu.hideItems(u,!0);this.eventArgs=n.event;n.column=this.targetColumn;n.rowInfo=this.targetRowdata;this.parent.trigger(yp,n);(n.cancel||this.hiddenItems.length===n.items.length&&!n.parentItem)&&(this.updateItemStatus(),n.cancel=!0)}vf(this.parent.element,this.contextMenu.element.parentElement)},n.prototype.ensureTarget=function(n,t){var i=n;return(i=!this.ensureFrozenHeader(n)||t!==a.header&&t!==a.content?t===a.content||t===a.header?o(Object(r.closest)(n,".e-table"),t.substr(1,t.length)):Object(r.closest)(n,t):Object(r.closest)(n,t===a.header?"thead":"tbody"))&&o(i,"e-grid")===this.parent.element},n.prototype.ensureFrozenHeader=function(n){return!(!this.parent.getFrozenColumns()&&!this.parent.frozenRows||!Object(r.closest)(n,a.header))},n.prototype.ensureDisabledStatus=function(n){var t=!1,r,i;switch(n){case"AutoFitAll":case"AutoFit":t=!(this.parent.ensureModuleInjected(ph)&&!this.parent.isEdit)||this.targetColumn&&!this.targetColumn.field&&"AutoFit"===n;break;case"Group":(!this.parent.allowGrouping||this.parent.ensureModuleInjected(br)&&this.targetColumn&&this.parent.groupSettings.columns.indexOf(this.targetColumn.field)>=0||this.targetColumn&&!this.targetColumn.field)&&(t=!0);break;case"Ungroup":(!this.parent.allowGrouping||!this.parent.ensureModuleInjected(br)||this.parent.ensureModuleInjected(br)&&this.targetColumn&&this.parent.groupSettings.columns.indexOf(this.targetColumn.field)<0)&&(t=!0);break;case"Edit":case"Delete":case"Save":case"Cancel":this.parent.editModule&&0!==this.parent.getDataRows().length||(t=!0);break;case"Copy":0!==this.parent.getSelectedRowIndexes().length&&0!==this.parent.getCurrentViewRecords().length||(t=!0);break;case"export":this.parent.allowExcelExport&&this.parent.excelExport&&(this.parent.ensureModuleInjected(dv)||this.parent.ensureModuleInjected(kv))||(t=!0);break;case"PdfExport":this.parent.allowPdfExport&&this.parent.ensureModuleInjected(dv)||(t=!0);break;case"ExcelExport":case"CsvExport":this.parent.allowExcelExport&&this.parent.ensureModuleInjected(kv)||(t=!0);break;case"SortAscending":case"SortDescending":if(this.parent.allowSorting&&this.parent.ensureModuleInjected(pf)&&(!this.targetColumn||this.targetColumn.field)){if(this.parent.ensureModuleInjected(pf)&&this.parent.sortSettings.columns.length>0&&this.targetColumn)for(r=this.parent.sortSettings.columns,i=0;i<r.length;i++)r[i].field===this.targetColumn.field&&r[i].direction.toLowerCase()===n.toLowerCase().replace("sort","").toLocaleLowerCase()&&(t=!0)}else t=!0;break;case"FirstPage":case"PrevPage":this.parent.allowPaging&&this.parent.ensureModuleInjected(fo)&&0!==this.parent.getCurrentViewRecords().length&&(!this.parent.ensureModuleInjected(fo)||1!==this.parent.pageSettings.currentPage)||(t=!0);break;case"LastPage":case"NextPage":this.parent.allowPaging&&this.parent.ensureModuleInjected(fo)&&0!==this.parent.getCurrentViewRecords().length&&(!this.parent.ensureModuleInjected(fo)||this.parent.pageSettings.currentPage!==this.getLastPage())||(t=!0)}return t},n.prototype.getContextMenu=function(){return this.element},n.prototype.destroy=function(){var n=this.parent.element;n&&(n.querySelector(".e-gridheader")||n.querySelector(".e-gridcontent"))&&(this.contextMenu.destroy(),Object(r.remove)(this.element),this.removeEventListener(),this.parent.element.classList.remove("e-noselect"))},n.prototype.getModuleName=function(){return"contextMenu"},n.prototype.generateID=function(n){return this.gridID+"_cmenu_"+n},n.prototype.getKeyFromId=function(n){return n.replace(this.gridID+"_cmenu_","")},n.prototype.buildDefaultItems=function(n){var t;switch(n){case"AutoFitAll":case"AutoFit":t={target:a.header};break;case"Group":t={target:a.header,iconCss:a.group};break;case"Ungroup":t={target:a.header,iconCss:a.ungroup};break;case"Edit":t={target:a.content,iconCss:a.editIcon};break;case"Delete":t={target:a.content,iconCss:a.delete};break;case"Save":t={target:a.edit,iconCss:a.save};break;case"Cancel":t={target:a.edit,iconCss:a.cancel};break;case"Copy":t={target:a.content,iconCss:a.copy};break;case"export":t={target:a.content};break;case"PdfExport":t={target:a.content,iconCss:a.pdf};break;case"ExcelExport":t={target:a.content,iconCss:a.excel};break;case"CsvExport":t={target:a.content,iconCss:a.csv};break;case"SortAscending":t={target:a.header,iconCss:a.ascending};break;case"SortDescending":t={target:a.header,iconCss:a.descending};break;case"FirstPage":t={target:a.pager,iconCss:a.fPage};break;case"PrevPage":t={target:a.pager,iconCss:a.pPage};break;case"LastPage":t={target:a.pager,iconCss:a.lPage};break;case"NextPage":t={target:a.pager,iconCss:a.nPage}}return this.defaultItems[n]={text:this.getLocaleText(n),id:this.generateID(n),target:t.target,iconCss:t.iconCss?"e-icons "+t.iconCss:""},this.defaultItems[n]},n.prototype.getDefaultItems=function(){return["AutoFitAll","AutoFit","Group","Ungroup","Edit","Delete","Save","Cancel","Copy","export","PdfExport","ExcelExport","CsvExport","SortAscending","SortDescending","FirstPage","PrevPage","LastPage","NextPage"]},n.prototype.setLocaleKey=function(){var n={AutoFitAll:"autoFitAll",AutoFit:"autoFit",Copy:"Copy",Group:"Group",Ungroup:"Ungroup",Edit:"EditRecord",Delete:"DeleteRecord",Save:"Save",Cancel:"CancelButton",PdfExport:"Pdfexport",ExcelExport:"Excelexport",CsvExport:"Csvexport","export":"Export",SortAscending:"SortAscending",SortDescending:"SortDescending",FirstPage:"FirstPage",LastPage:"LastPage",PrevPage:"PreviousPage",NextPage:"NextPage"};return Object(r.isBlazor)()&&(n.AutoFitAll="AutoFitAll",n.AutoFit="AutoFit"),n},n.prototype.getColumn=function(n){var t=Object(r.closest)(n.target,"th.e-headercell"),i;return t?(i=t.querySelector(".e-headercelldiv, .e-stackedheadercelldiv").getAttribute("e-mappinguid"),this.parent.getColumnByUid(i)):this.parent.getRowInfo(n.target).column||null},n.prototype.selectRow=function(n,t){this.cell=n.target;this.row=Object(r.closest)(n.target,"tr.e-row")||this.row;this.row&&t&&!o(n.target,"e-gridpager")&&this.parent.selectRow(parseInt(this.row.getAttribute("aria-rowindex"),10))},n}(),wh=function(){function n(n){this.isFrzLoad=1;this.parent=n;this.rowModelGenerator=new vi(this.parent)}return n.prototype.generateRows=function(n,t,i){var e=this.parent.getFrozenColumns(),u,f,o;if(e=e&&this.parent.isRowDragable()?e+1:e,this.isFrzLoad%2!=0&&"virtualscroll"===t.requestType&&"X"===t.virtualInfo.sentinelInfo.axis)return this.isFrzLoad++,null;if(u=this.parent.enableVirtualization?i:this.rowModelGenerator.generateRows(n,t),Object(r.isBlazor)()&&!this.parent.isJsComponent)return u;for(f=0,o=u.length;f<o;f++)this.isFrzLoad%2==0?u[f].cells=u[f].cells.slice(e,u[f].cells.length):(u[f].isFreezeRow=!0,u[f].cells=u[f].cells.slice(0,e));return this.isFrzLoad++,u},n}(),kd=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),gv=function(n){function t(t,i){return n.call(this,t,i)||this}return kd(t,n),t.prototype.renderPanel=function(){n.prototype.renderPanel.call(this);var t=this.parent.element.querySelector(".e-frozencontent"),i=this.parent.element.querySelector(".e-movablecontent");Object(r.isNullOrUndefined)(t)&&(t=this.parent.createElement("div",{className:"e-frozencontent"}),i=this.parent.createElement("div",{className:"e-movablecontent"}),this.getPanel().querySelector(".e-content").appendChild(t),this.getPanel().querySelector(".e-content").appendChild(i));this.setFrozenContent(t);this.setMovableContent(i)},t.prototype.renderEmpty=function(t){Object(r.isBlazor)()&&!this.parent.isJsComponent||(n.prototype.renderEmpty.call(this,t),this.getMovableContent().querySelector("tbody").innerHTML="<tr><td><\/td><\/tr>",this.parent.getContent().querySelector(".e-frozencontent").style.height=this.parent.getContent().querySelector(".e-movablecontent").offsetHeight-oi()+"px",Object(r.addClass)([this.getMovableContent().querySelector("tbody").querySelector("tr")],["e-emptyrow"]),this.getFrozenContent().querySelector(".e-emptyrow").querySelector("td").colSpan=this.parent.getFrozenColumns(),this.getFrozenContent().style.borderRightWidth="0px",this.parent.frozenRows&&(this.parent.getHeaderContent().querySelector(".e-frozenheader").querySelector("tbody").innerHTML="",this.parent.getHeaderContent().querySelector(".e-movableheader").querySelector("tbody").innerHTML=""))},t.prototype.setFrozenContent=function(n){this.frozenContent=n},t.prototype.setMovableContent=function(n){this.movableContent=n},t.prototype.getFrozenContent=function(){return this.frozenContent},t.prototype.getMovableContent=function(){return this.movableContent},t.prototype.getModelGenerator=function(){return new wh(this.parent)},t.prototype.renderTable=function(){var t,i;null==this.getFrozenContent().querySelector(".e-table")?(n.prototype.renderTable.call(this),this.getFrozenContent().appendChild(this.getTable()),t=this.getTable().cloneNode(!0),this.getMovableContent().appendChild(t)):(this.setTable(this.getFrozenContent().querySelector(".e-table")),this.setColGroup(this.parent.element.querySelector(".e-gridheader").querySelector("colgroup").cloneNode(!0)),this.getFrozenContent().querySelector(".e-table").appendChild(this.getColGroup()),t=this.getMovableContent().querySelector(".e-table"),this.parent.frozenRows&&this.parent.getHeaderContent().classList.add("e-frozenhdrcont"));this.getMovableContent().querySelector("colgroup")&&Object(r.remove)(this.getMovableContent().querySelector("colgroup"));i=this.parent.getHeaderContent().querySelector(".e-movableheader").querySelector("colgroup").cloneNode(!0);t.insertBefore(i,t.querySelector("tbody"))},t}(of),ny=function(n){function t(t,i){var r=n.call(this,t,i)||this;return r.addEventListener(),r}return kd(t,n),t.prototype.addEventListener=function(){this.parent.on(ki,this.refreshFreeze,this);this.parent.on(ru,this.setFrozenHeight,this);this.parent.on(v,this.enableAfterRender,this)},t.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(ru,this.setFrozenHeight),this.parent.off(v,this.enableAfterRender))},t.prototype.renderTable=function(){Object(r.isBlazor)()?(this.setTable(this.createTable(this.getFrozenHeader().querySelector(".e-table"))),this.parent.notify(g,{rows:this.rows,args:{isFrozen:!0}}),this.createTable(this.getMovableHeader().querySelector(".e-table"))):n.prototype.renderTable.call(this);this.rfshMovable();this.updateColgroup();this.initializeHeaderDrag();this.initializeHeaderDrop();this.parent.notify(g,{rows:this.rows,args:{isFrozen:!1}})},t.prototype.renderPanel=function(){var t=this.parent.element.querySelector(".e-frozenheader"),i=this.parent.element.querySelector(".e-movableheader");n.prototype.renderPanel.call(this);Object(r.isNullOrUndefined)(t)&&(t=this.parent.createElement("div",{className:"e-frozenheader"}),i=this.parent.createElement("div",{className:"e-movableheader"}),this.getPanel().querySelector(".e-headercontent").appendChild(t),this.getPanel().querySelector(".e-headercontent").appendChild(i));this.setFrozenHeader(t);this.setMovableHeader(i)},t.prototype.refreshUI=function(){if(Object(r.isBlazor)()&&this.parent.isServerRendered&&0!==this.parent.frozenRows)this.parent.getFrozenColumns()&&this.freezeReorder&&(n.prototype.refreshUI.call(this),this.freezeReorder=!1,n.prototype.refreshUI.call(this)),this.rfshMovable();else{var t=this.getMovableHeader().querySelector("tbody");Object(r.remove)(this.getMovableHeader().querySelector("table"));n.prototype.refreshUI.call(this);this.rfshMovable();this.getMovableHeader().querySelector("tbody").innerHTML=t.innerHTML}Object(r.isBlazor)()&&0!==this.parent.frozenRows||this.updateColgroup();this.parent.enableVirtualization||this.widthService.setWidthToTable();this.parent.allowTextWrap&&"Header"===this.parent.textWrapSettings.wrapMode&&vt([].slice.call(this.movableHeader.querySelectorAll("tr.e-columnheader")),!0);this.parent.updateDefaultCursor();Object(r.isBlazor)()&&0!==this.parent.frozenRows||no(this.parent.getContentTable().querySelector("colgroup"),this.parent.getFrozenColumns(),this.parent);this.initializeHeaderDrag();this.parent.notify(g,{rows:this.rows,args:{isFrozen:!1}})},t.prototype.rfshMovable=function(){this.parent.enableColumnVirtualization?(this.parent.getFrozenVirtualHeader().querySelector(".e-virtualtable").appendChild(this.getTable()),this.parent.getMovableVirtualHeader().querySelector(".e-virtualtable").appendChild(this.createTable())):Object(r.isBlazor)()&&0!==this.parent.frozenRows||(this.getFrozenHeader().appendChild(this.getTable()),this.getMovableHeader().appendChild(this.createTable()));this.refreshStackedHdrHgt();this.addMovableFirstCls()},t.prototype.addMovableFirstCls=function(){var i;if(this.parent.getVisibleFrozenColumns())for(var t=this.parent.element.querySelector(".e-movableheader").querySelector("thead").querySelectorAll(".e-columnheader"),u=this.parent.element.querySelector(".e-movableheader").querySelector("thead").querySelectorAll(".e-columnheader").length,n=0;n<u;n++)i=t[n].cells[0],i&&(Object(r.addClass)([i],["e-movablefirst"]),t[n].cells[0].rowSpan>1&&(n+=t[n].cells[0].rowSpan-1))},t.prototype.refreshFreeze=function(n){var e,u,o,c;if("filter"===n.case){if(e=this.getTable().querySelector(".e-filterbar"),this.parent.allowFiltering&&e&&this.getMovableHeader().querySelector("thead"))for(this.getMovableHeader().querySelector("thead").appendChild(this.filterRenderer(e,this.parent.getFrozenColumns())),u=0,o=[].slice.call(this.getMovableHeader().querySelectorAll("thead .e-filterbarcell .e-input"));u<o.length;u++)c={element:o[u],floatLabelType:"Never",properties:{enableRtl:this.parent.enableRtl,showClearButton:!0}},rr.Input.bindInitialEvent(c)}else if("textwrap"===n.case||"refreshHeight"===n.case){var t=void 0,i=void 0,s=this.getFrozenHeader(),h=this.getMovableHeader(),f=this.parent.getContent(),r=this.parent.textWrapSettings.wrapMode,l=this.parent.getHeaderContent().querySelector(".e-headercontent").classList;"textwrap"===n.case?(("Header"!==r||n.isModeChg)&&(t=f.querySelector(".e-frozencontent").querySelectorAll("tr"),i=f.querySelector(".e-movablecontent").querySelectorAll("tr"),this.setWrapHeight(t,i,n.isModeChg,!0)),"Content"===r&&this.parent.allowTextWrap?l.add("e-wrap"):l.remove("e-wrap"),"Both"===r||n.isModeChg?(t=s.querySelectorAll("tr"),i=h.querySelectorAll("tr")):(t=s.querySelector("Content"===r?"tbody":"thead").querySelectorAll("tr"),i=h.querySelector("Content"===r?"tbody":"thead").querySelectorAll("tr")),this.parent.getHeaderContent().querySelectorAll(".e-stackedheadercell").length||this.setWrapHeight(t,i,n.isModeChg,!1,this.colDepth>1),this.refreshStackedHdrHgt()):"refreshHeight"===n.case&&(this.setWrapHeight(f.querySelector(".e-frozencontent").querySelectorAll("tr"),f.querySelector(".e-movablecontent").querySelectorAll("tr"),n.isModeChg),this.parent.getHeaderContent().querySelectorAll(".e-stackedheadercell").length||this.setWrapHeight(s.querySelectorAll("tr"),h.querySelectorAll("tr"),n.isModeChg))}},t.prototype.enableAfterRender=function(n){"scroll"===n.module&&this.setFrozenHeight()},t.prototype.updateResizeHandler=function(){for(var t=[].slice.call(this.parent.getHeaderContent().querySelectorAll(".e-rhandler")),n=0;n<t.length;n++)t[n].style.height=t[n].parentElement.offsetHeight+"px"},t.prototype.setWrapHeight=function(n,t,i,u,f){for(var o,s,h=this.parent.allowTextWrap,c=this.parent.textWrapSettings.wrapMode,y=this.parent.getHeaderContent().querySelector("thead"),p=this.parent.getHeaderContent().querySelector("tbody"),a=[],v=[],e=0,l=n.length;e<l;e++)Object(r.isNullOrUndefined)(n[e])||Object(r.isNullOrUndefined)(t[e])||(a[e]=n[e].getBoundingClientRect().height,v[e]=t[e].getBoundingClientRect().height);for(e=0,l=n.length;e<l;e++)(i&&("Header"===c&&u||"Content"===c&&y.contains(n[e])||"Header"===c&&p.contains(n[e]))||f)&&(n[e].style.height=null,t[e].style.height=null),o=a[e],s=v[e],!Object(r.isNullOrUndefined)(n[e])&&n[e].childElementCount&&(h&&o<s||!h&&o<s||this.parent.allowResizing&&this.parent.resizeModule&&!1===this.parent.resizeModule.isFrozenColResized)&&(n[e].style.height=s+"px"),t&&!Object(r.isNullOrUndefined)(t[e])&&t[e].childElementCount&&(h&&o>s||!h&&o>s||this.parent.allowResizing&&this.parent.resizeModule&&!0===this.parent.resizeModule.isFrozenColResized)&&(t[e].style.height=o+"px");h&&this.setFrozenHeight()},t.prototype.setFrozenHeight=function(n){void 0===n&&(n=oi());var r=this.parent.element.querySelector(".e-movablecontent").getBoundingClientRect().height,i=this.parent.element.querySelector(".e-movablecontent"),t=this.parent.element.querySelector(".e-frozencontent"),u=this.parent.getContent().scrollWidth,f=this.parent.element.querySelector(".e-movablecontent table").scrollWidth+this.parent.getContentTable().scrollWidth;i.scrollWidth-i.clientWidth?(t.style.height=r-n+"px",t.style.borderBottom=""):(t.style.height=r+"px",(t.scrollHeight<=t.clientHeight||i.scrollHeight<=i.clientHeight)&&u===f&&this.parent.scrollModule.removePadding(),t.style.borderBottom="0px")},t.prototype.refreshStackedHdrHgt=function(){for(var i,r,t=this.getFrozenHeader().querySelectorAll(".e-columnheader"),u=this.getMovableHeader().querySelectorAll(".e-columnheader"),n=0,f=t.length;n<f;n++)i=this.getRowSpan(t[n]),r=this.getRowSpan(u[n]),i.min>1?this.updateStackedHdrRowHgt(n,i.max,t[n],u):r.min>1&&this.updateStackedHdrRowHgt(n,r.max,u[n],t);this.parent.allowResizing&&this.updateResizeHandler()},t.prototype.getRowSpan=function(n){for(var r,t,u,i=0,f=n.childElementCount;i<f;i++)0===i&&(t=n.children[0].rowSpan),r=n.children[i].rowSpan,t=Math.min(r,t),u=Math.max(r,t);return{min:t,max:u}},t.prototype.updateStackedHdrRowHgt=function(n,t,i,r){for(var f=0,u=0;u<t;u++)f+=r[n+u].style.height?parseInt(r[n+u].style.height,10):r[n+u].offsetHeight;i.style.height=f+"px"},t.prototype.setFrozenHeader=function(n){this.frozenHeader=n},t.prototype.setMovableHeader=function(n){this.movableHeader=n},t.prototype.getFrozenHeader=function(){return this.frozenHeader},t.prototype.getMovableHeader=function(){return this.movableHeader},t.prototype.updateColgroup=function(){var n=this.getMovableHeader().querySelector("table");Object(r.remove)(this.getMovableHeader().querySelector("colgroup"));n.insertBefore(no(this.getFrozenHeader().querySelector("colgroup"),this.parent.getFrozenColumns(),this.parent),n.querySelector("thead"))},t.prototype.filterRenderer=function(n,t){var i=n.cloneNode(!0),r;for(i.innerHTML="",r=t;r<this.parent.getColumns().length;r++)i.appendChild(n.removeChild(n.children[t]));return i},t}(ds),dd=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),urt=function(n){function t(t,i){var r=n.call(this,t,i)||this;return r.frzeeLoad=1,r.serviceLoc=i,r}return dd(t,n),t.prototype.renderTable=function(){var i,n,t,u,f;this.freezeRowGenerator=new wh(this.parent);this.virtualRenderer=new cv(this.parent,this.serviceLoc);this.virtualRenderer.setPanel(this.parent.getContent());this.virtualRenderer.renderTable();i=this.parent.getContent().querySelector(".e-virtualtable");n=this.parent.getContent().querySelector(".e-virtualtrack");n.style.position="";this.getFrozenContent().appendChild(i);this.getFrozenContent().appendChild(n);t=i.cloneNode(!0);u=n.cloneNode(!0);this.getMovableContent().appendChild(t);this.getMovableContent().appendChild(u);Object(r.remove)(this.getMovableContent().querySelector("colgroup"));f=this.parent.getMovableVirtualHeader().querySelector("colgroup").cloneNode(!0);t.firstElementChild.insertBefore(f,t.firstElementChild.querySelector("tbody"));this.setTable(this.parent.element.querySelector(".e-frozencontent").querySelector(".e-table"))},t.prototype.appendContent=function(n,t,i){this.virtualRenderer.appendContent(n,t,i)},t.prototype.generateRows=function(n,t){var i;return i=this.virtualRenderer.vgenerator.generateRows(n,t).map(function(n){return Object(r.extend)({},n)}),this.firstPageRecords||(this.firstPageRecords=n),this.freezeRowGenerator.generateRows(n,t,i)},t.prototype.getRowByIndex=function(n){return this.virtualRenderer.getRowByIndex(n)},t.prototype.getMovableRowByIndex=function(n){return this.virtualRenderer.getMovableVirtualRowByIndex(n)},t.prototype.getMovableRows=function(){return this.virtualRenderer.vgenerator.getRows()},t.prototype.getRows=function(){return this.getMovableRows()},t.prototype.getColGroup=function(){var n=this.parent.getMovableVirtualContent().querySelector("colgroup"),t=this.parent.getFrozenVirtualContent().querySelector("colgroup");return this.isXaxis()?n:t},t.prototype.getReorderedFrozenRows=function(n){var t,r=n.virtualInfo.blockIndexes,u=n.virtualInfo.columnIndexes,f=n.virtualInfo.page,i;return n.virtualInfo.blockIndexes=[1,2],n.virtualInfo.page=1,n.renderMovableContent||(n.virtualInfo.columnIndexes=[]),i=this.virtualRenderer.vgenerator.generateRows(this.firstPageRecords,n),t=this.splitReorderedRows(i),n.virtualInfo.blockIndexes=r,n.virtualInfo.columnIndexes=u,n.virtualInfo.page=f,t.splice(0,this.parent.frozenRows)},t.prototype.splitReorderedRows=function(n){for(var i=this.parent.getFrozenColumns(),t=0,r=n.length;t<r;t++)this.frzeeLoad%2==0?n[t].cells=n[t].cells.slice(i,n[t].cells.length):(n[t].isFreezeRow=!0,n[t].cells=n[t].cells.slice(0,i));return this.frzeeLoad++,n},t.prototype.isXaxis=function(){var n=!1;return this.virtualRenderer&&(n="virtualscroll"===this.virtualRenderer.requestType&&"X"===this.virtualRenderer.currentInfo.sentinelInfo.axis),n},t.prototype.getHeaderCells=function(){var n=this.isXaxis()?this.parent.getMovableVirtualHeader():this.parent.getHeaderContent();return n?[].slice.call(n.querySelectorAll(".e-headercell:not(.e-stackedheadercell)")):[]},t.prototype.getVirtualFreezeHeader=function(){return this.isXaxis()?this.parent.getMovableVirtualHeader().querySelector(".e-table"):this.parent.getFrozenVirtualHeader().querySelector(".e-table")},t.prototype.ensureFrozenCols=function(n){return this.parent.columns.slice(0,this.parent.getFrozenColumns()).concat(n)},t.prototype.getRowObjectByIndex=function(n){return this.virtualRenderer.getRowObjectByIndex(n)},t}(gv),frt=function(n){function t(t,i){var r=n.call(this,t,i)||this;return r.serviceLoc=i,r}return dd(t,n),t.prototype.renderTable=function(){this.virtualHdrRenderer=new lv(this.parent,this.serviceLoc);this.virtualEle=this.virtualHdrRenderer.virtualEle;this.virtualHdrRenderer.setPanel(this.parent.getHeaderContent());this.virtualHdrRenderer.renderTable();this.rfhMovable();this.updateColgroup();this.initializeHeaderDrag();this.initializeHeaderDrop();this.setTable(this.parent.element.querySelector(".e-frozenheader").querySelector(".e-table"));this.parent.notify(g,{rows:this.rows,args:{isFrozen:!1}})},t.prototype.rfhMovable=function(){var i=this.parent.getHeaderContent().querySelector(".e-virtualtable"),r=this.parent.getHeaderContent().querySelector(".e-virtualtrack"),n,t;this.getFrozenHeader().appendChild(i);this.getFrozenHeader().appendChild(r);this.virtualHdrRenderer.virtualEle.table=this.createTable();this.virtualHdrRenderer.virtualEle.renderWrapper();this.virtualHdrRenderer.virtualEle.renderPlaceHolder();n=[].slice.call(this.parent.getHeaderContent().querySelectorAll(".e-virtualtable"));t=[].slice.call(this.parent.getHeaderContent().querySelectorAll(".e-virtualtrack"));this.getMovableHeader().appendChild(n[1]);this.getMovableHeader().appendChild(t[1])},t.prototype.getTable=function(){return this.virtualHdrRenderer.getTable()},t}(ny),ert=function(){function n(n,t){this.parent=n;this.locator=t;this.addEventListener()}return n.prototype.getModuleName=function(){return"freeze"},n.prototype.addEventListener=function(){this.parent.isDestroyed||this.parent.on(ii,this.instantiateRenderer,this)},n.prototype.instantiateRenderer=function(){this.parent.log("limitation",this.getModuleName());var n=this.locator.getService("rendererFactory");this.parent.getFrozenColumns()&&(this.parent.enableColumnVirtualization?n.addRenderer(ut.Header,new frt(this.parent,this.locator)):n.addRenderer(ut.Header,new ny(this.parent,this.locator)),this.parent.enableVirtualization?n.addRenderer(ut.Content,new urt(this.parent,this.locator)):n.addRenderer(ut.Content,new gv(this.parent,this.locator)))},n.prototype.removeEventListener=function(){this.parent.isDestroyed||this.parent.off(ii,this.instantiateRenderer)},n.prototype.destroy=function(){this.removeEventListener()},n}(),ort=function(){function n(n,t){this.defaultItems={};this.localeText=this.setLocaleKey();this.disableItems=[];this.hiddenItems=[];this.isOpen=!1;this.GROUP="e-icon-group";this.UNGROUP="e-icon-ungroup";this.ASCENDING="e-icon-ascending";this.DESCENDING="e-icon-descending";this.ROOT="e-columnmenu";this.FILTER="e-icon-filter";this.POP="e-filter-popup";this.WRAP="e-col-menu";this.CHOOSER="_chooser_";this.parent=n;this.gridID=n.element.id;this.serviceLocator=t;this.addEventListener()}return n.prototype.wireEvents=function(){for(var t=this.getColumnMenuHandlers(),n=0;n<t.length;n++)r.EventHandler.add(t[n],"mousedown",this.columnMenuHandlerDown,this)},n.prototype.unwireEvents=function(){for(var t=this.getColumnMenuHandlers(),n=0;n<t.length;n++)r.EventHandler.remove(t[n],"mousedown",this.columnMenuHandlerDown)},n.prototype.destroy=function(){var n=this.parent.element;n&&(n.querySelector(".e-gridheader")||n.querySelector(".e-gridcontent"))&&(this.columnMenu.destroy(),this.removeEventListener(),this.unwireFilterEvents(),this.unwireEvents(),Object(r.remove)(this.element))},n.prototype.columnMenuHandlerClick=function(n){n.target.classList.contains("e-columnmenu")&&(this.columnMenu.items=this.getItems(),this.columnMenu.dataBind(),this.isOpen&&this.headerCell!==this.getHeaderCell(n)||document.querySelector(".e-grid-menu .e-menu-parent.e-ul")?(this.columnMenu.close(),this.openColumnMenu(n)):this.isOpen?this.columnMenu.close():this.openColumnMenu(n))},n.prototype.openColumnMenuByField=function(n){this.openColumnMenu({target:this.parent.getColumnHeaderByField(n).querySelector(".e-columnmenu")})},n.prototype.openColumnMenu=function(n){var t={top:0,left:0},i;this.element.style.cssText="display:block;visibility:hidden";i=this.element.getBoundingClientRect();this.element.style.cssText="display:none;visibility:visible";this.headerCell=this.getHeaderCell(n);r.Browser.isDevice?(t.top=window.innerHeight/2-i.height/2,t.left=window.innerWidth/2-i.width/2):this.parent.enableRtl?t=Object(ft.calculatePosition)(this.headerCell,"left","bottom"):(t=Object(ft.calculatePosition)(this.headerCell,"right","bottom")).left-=i.width;this.columnMenu.open(t.top,t.left);n.preventDefault&&n.preventDefault();vf(this.parent.element,this.columnMenu.element.parentElement)},n.prototype.columnMenuHandlerDown=function(){this.isOpen=!("none"===this.element.style.display||""===this.element.style.display)},n.prototype.getColumnMenuHandlers=function(){return[].slice.call(this.parent.getHeaderTable().querySelectorAll("."+this.ROOT))},n.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(g,this.wireEvents,this),this.parent.on(v,this.enableAfterRenderMenu,this),this.parent.on(tt,this.render,this),this.isFilterItemAdded()&&this.parent.on(re,this.filterPosition,this),this.parent.on(it,this.columnMenuHandlerClick,this),this.parent.on(w,this.keyPressHandler,this))},n.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(g,this.unwireEvents),this.parent.off(v,this.enableAfterRenderMenu),this.parent.off(tt,this.render),this.isFilterItemAdded()&&this.parent.off(re,this.filterPosition),this.parent.off(it,this.columnMenuHandlerClick),this.parent.off(w,this.keyPressHandler))},n.prototype.keyPressHandler=function(n){var i=this.parent,t,r;"altDownArrow"===n.action&&(t=i.focusModule.currentInfo.element,t&&t.classList.contains("e-headercell")&&(r=i.getColumnByUid(t.firstElementChild.getAttribute("e-mappinguid")),this.openColumnMenuByField(r.field)))},n.prototype.enableAfterRenderMenu=function(n){n.module===this.getModuleName()&&n.enable&&(this.columnMenu&&(this.columnMenu.destroy(),Object(r.remove)(this.element)),this.render())},n.prototype.render=function(){this.l10n=this.serviceLocator.getService("localization");this.element=this.parent.createElement("ul",{id:this.gridID+"_columnmenu",className:"e-colmenu"});this.element.setAttribute("aria-label",this.l10n.getConstant("ColumnMenuDialogARIA"));this.parent.element.appendChild(this.element);this.columnMenu=new yf.ContextMenu({cssClass:"e-grid-menu",enableRtl:this.parent.enableRtl,enablePersistence:this.parent.enablePersistence,locale:this.parent.locale,items:this.getItems(),select:this.columnMenuItemClick.bind(this),beforeOpen:this.columnMenuBeforeOpen.bind(this),onOpen:this.columnMenuOnOpen.bind(this),onClose:this.columnMenuOnClose.bind(this),beforeItemRender:this.beforeMenuItemRender.bind(this),beforeClose:this.columnMenuBeforeClose.bind(this)});this.columnMenu.appendTo(this.element);this.wireFilterEvents()},n.prototype.wireFilterEvents=function(){!r.Browser.isDevice&&this.isFilterItemAdded()&&r.EventHandler.add(this.element,"mouseover",this.appendFilter,this)},n.prototype.unwireFilterEvents=function(){!r.Browser.isDevice&&this.isFilterItemAdded()&&r.EventHandler.remove(this.element,"mouseover",this.appendFilter)},n.prototype.beforeMenuItemRender=function(n){if(this.isChooserItem(n.item)){var i=this.getKeyFromId(n.item.id,this.CHOOSER),r=this.parent.columnModel.filter(function(n){return n.field===i}),t=Object(gt.createCheckBox)(this.parent.createElement,!1,{label:n.item.text,checked:r[0].visible});this.parent.enableRtl&&t.classList.add("e-rtl");n.element.innerHTML="";n.element.appendChild(t)}else n.item.id&&"Filter"===this.getKeyFromId(n.item.id)&&(n.element.appendChild(this.parent.createElement("span",{className:"e-icons e-caret"})),n.element.className+="e-filter-item e-menu-caret-icon")},n.prototype.columnMenuBeforeClose=function(n){var t=n.event?Object(r.closest)(n.event.target,".e-menu-item"):null;(!Object(r.isNullOrUndefined)(n.parentItem)&&"ColumnChooser"===this.getKeyFromId(n.parentItem.id)&&t&&this.isChooserItem(t)||n.event&&(Object(r.closest)(n.event.target,"."+this.POP)||n.event.currentTarget&&n.event.currentTarget.activeElement&&o(n.event.currentTarget.activeElement,"e-filter-popup")||o(n.event.target,"e-popup")||o(n.event.target,"e-popup-wrapper"))&&!r.Browser.isDevice)&&(n.cancel=!0)},n.prototype.isChooserItem=function(n){return n.id&&n.id.indexOf("_colmenu_")>=0&&-1===this.getKeyFromId(n.id,this.CHOOSER).indexOf("_colmenu_")},n.prototype.columnMenuBeforeOpen=function(n){var t,r;for(n.column=this.targetColumn=this.getColumn(),this.parent.trigger(wp,n),t=0,r=n.items;t<r.length;t++){var i=r[t],u=this.getKeyFromId(i.id),f=this.defaultItems[u];-1!==this.getDefaultItems().indexOf(u)&&this.ensureDisabledStatus(u)&&!f.hide&&this.disableItems.push(i.text);i.hide&&this.hiddenItems.push(i.text)}this.columnMenu.enableItems(this.disableItems,!1);this.columnMenu.hideItems(this.hiddenItems)},n.prototype.columnMenuOnOpen=function(n){"e-menu-parent e-ul "===n.element.className&&(n.element.offsetHeight>window.innerHeight||this.parent.element.offsetHeight>window.innerHeight)&&(n.element.style.maxHeight=.8*window.innerHeight+"px",n.element.style.overflowY="auto")},n.prototype.ensureDisabledStatus=function(n){var t=!1,r,i;switch(n){case"Group":(!this.parent.allowGrouping||this.parent.ensureModuleInjected(br)&&this.targetColumn&&this.parent.groupSettings.columns.indexOf(this.targetColumn.field)>=0||this.targetColumn&&!this.targetColumn.allowGrouping)&&(t=!0);break;case"AutoFitAll":case"AutoFit":t=!this.parent.ensureModuleInjected(ph);break;case"Ungroup":(!this.parent.ensureModuleInjected(br)||this.parent.ensureModuleInjected(br)&&this.targetColumn&&this.parent.groupSettings.columns.indexOf(this.targetColumn.field)<0)&&(t=!0);break;case"SortDescending":case"SortAscending":if(this.parent.allowSorting&&this.parent.ensureModuleInjected(pf)&&this.parent.sortSettings.columns.length>0&&this.targetColumn&&this.targetColumn.allowSorting)for(r=this.parent.sortSettings.columns,i=0;i<r.length;i++)r[i].field===this.targetColumn.field&&r[i].direction.toLocaleLowerCase()===n.toLocaleLowerCase().replace("sort","")&&(t=!0);else this.parent.allowSorting&&this.parent.ensureModuleInjected(pf)&&(!this.parent.allowSorting||!this.targetColumn||this.targetColumn.allowSorting)||(t=!0);break;case"Filter":this.parent.allowFiltering&&"FilterBar"!==this.parent.filterSettings.type&&this.parent.ensureModuleInjected(yh)&&this.targetColumn&&this.targetColumn.allowFiltering?t=!1:this.parent.ensureModuleInjected(yh)&&this.parent.allowFiltering&&this.targetColumn&&(!this.targetColumn.allowFiltering||"FilterBar"===this.parent.filterSettings.type)&&(t=!0)}return t},n.prototype.columnMenuItemClick=function(n){switch(this.isChooserItem(n.item)?"ColumnChooser":this.getKeyFromId(n.item.id)){case"AutoFit":this.parent.autoFitColumns(this.targetColumn.field);break;case"AutoFitAll":this.parent.autoFitColumns([]);break;case"Ungroup":this.parent.ungroupColumn(this.targetColumn.field);break;case"Group":this.parent.groupColumn(this.targetColumn.field);break;case"SortAscending":this.parent.sortColumn(this.targetColumn.field,"Ascending");break;case"SortDescending":this.parent.sortColumn(this.targetColumn.field,"Descending");break;case"ColumnChooser":var i=this.getKeyFromId(n.item.id,this.CHOOSER),t=n.element.querySelector(".e-checkbox-wrapper .e-frame");t&&t.classList.contains("e-check")?(t.classList.remove("e-check"),this.parent.hideColumns(i,"field")):t&&(this.parent.showColumns(i,"field"),t.classList.add("e-check"));break;case"Filter":this.getFilter(n.element,n.item.id)}n.column=this.targetColumn;this.parent.trigger(pp,n)},n.prototype.columnMenuOnClose=function(n){n.items.length>0&&n.items[0].parentObj instanceof yf.ContextMenu&&(this.columnMenu.enableItems(this.disableItems,!1),this.disableItems=[],this.columnMenu.showItems(this.hiddenItems),this.hiddenItems=[],this.isFilterPopupOpen()&&this.getFilter(n.element,n.element.id,!0));this.parent.getFrozenColumns()||this.parent.notify(fu,{})},n.prototype.getDefaultItems=function(){return["AutoFitAll","AutoFit","SortAscending","SortDescending","Group","Ungroup","ColumnChooser","Filter"]},n.prototype.getItems=function(){for(var n,r,t=[],i=0,u=this.parent.columnMenuItems?this.parent.columnMenuItems:this.getDefault();i<u.length;i++)n=u[i],"string"==typeof n?"ColumnChooser"===n?(r=this.getDefaultItem(n),r.items=this.createChooserItems(),t.push(r)):t.push(this.getDefaultItem(n)):t.push(n);return t},n.prototype.getDefaultItem=function(n){var t={};switch(n){case"SortAscending":t={iconCss:this.ASCENDING};break;case"SortDescending":t={iconCss:this.DESCENDING};break;case"Group":t={iconCss:this.GROUP};break;case"Ungroup":t={iconCss:this.UNGROUP};break;case"Filter":t={iconCss:this.FILTER}}return this.defaultItems[n]={text:this.getLocaleText(n),id:this.generateID(n),iconCss:t.iconCss?"e-icons "+t.iconCss:null},this.defaultItems[n]},n.prototype.getLocaleText=function(n){return this.l10n.getConstant(this.localeText[n])},n.prototype.generateID=function(n,t){return this.gridID+"_colmenu_"+(t?t+n:n)},n.prototype.getKeyFromId=function(n,t){return n.indexOf("_colmenu_")>0&&n.replace(this.gridID+"_colmenu_"+(t||""),"")},n.prototype.getColumnMenu=function(){return this.element},n.prototype.getModuleName=function(){return"columnMenu"},n.prototype.setLocaleKey=function(){var n={AutoFitAll:"autoFitAll",AutoFit:"autoFit",Group:"Group",Ungroup:"Ungroup",SortAscending:"SortAscending",SortDescending:"SortDescending",ColumnChooser:"Columnchooser",Filter:"FilterMenu"};return Object(r.isBlazor)()&&(n.AutoFitAll="AutoFitAll",n.AutoFit="AutoFit"),n},n.prototype.getHeaderCell=function(n){return Object(r.closest)(n.target,"th.e-headercell")},n.prototype.getColumn=function(){if(this.headerCell){var n=this.headerCell.querySelector(".e-headercelldiv").getAttribute("e-mappinguid");return this.parent.getColumnByUid(n)}return null},n.prototype.createChooserItems=function(){for(var n,i=[],t=0,r=this.parent.columnModel;t<r.length;t++)n=r[t],n.showInColumnChooser&&n.field&&i.push({id:this.generateID(n.field,this.CHOOSER),text:n.headerText?n.headerText:n.field});return i},n.prototype.appendFilter=function(n){if(this.defaultItems.Filter){var t=this.defaultItems.Filter.id;Object(r.closest)(n.target,"#"+t)&&!this.isFilterPopupOpen()?this.getFilter(n.target,t):!Object(r.closest)(n.target,"#"+t)&&this.isFilterPopupOpen()&&this.getFilter(n.target,t,!0)}},n.prototype.getFilter=function(n,t,i){var u=this.getFilterPop();u?u.style.display=!r.Browser.isDevice&&i?"none":"block":this.parent.notify(ko,{col:this.targetColumn,target:n,isClose:i,id:t})},n.prototype.setPosition=function(n,t){var i=this.parent.element.getBoundingClientRect(),u=n.getBoundingClientRect(),f=u.left-i.left,r=u.top-i.top;i.height<r?r=r-t.offsetHeight+u.height:i.height<r+t.offsetHeight&&(r=i.height-t.offsetHeight);window.innerHeight<t.offsetHeight+r+i.top&&(r=window.innerHeight-t.offsetHeight-i.top);f+=this.parent.enableRtl?-t.offsetWidth:u.width;i.width<=f+t.offsetWidth?f-=u.width+t.offsetWidth:f<0&&(f+=t.offsetWidth+u.width);t.style.top=r+"px";t.style.left=f+"px"},n.prototype.filterPosition=function(){var n=this.getFilterPop(),i,t;(n.classList.add(this.WRAP),r.Browser.isDevice)||(i=n.style.display,n.style.cssText+="display:block;visibility:hidden",t=this.element.querySelector("."+this.FILTER),t&&(this.setPosition(t.parentElement,n),n.style.cssText+="display:"+i+";visibility:visible"))},n.prototype.getDefault=function(){var n=[];return this.parent.ensureModuleInjected(ph)&&(n.push("AutoFitAll"),n.push("AutoFit")),this.parent.allowGrouping&&this.parent.ensureModuleInjected(br)&&(n.push("Group"),n.push("Ungroup")),this.parent.allowSorting&&this.parent.ensureModuleInjected(pf)&&(n.push("SortAscending"),n.push("SortDescending")),n.push("ColumnChooser"),this.parent.allowFiltering&&"FilterBar"!==this.parent.filterSettings.type&&this.parent.ensureModuleInjected(yh)&&n.push("Filter"),n},n.prototype.isFilterPopupOpen=function(){var n=this.getFilterPop();return n&&"none"!==n.style.display},n.prototype.getFilterPop=function(){return r.Browser.isDevice&&null!==this.targetColumn&&"Menu"===this.parent.filterSettings.type?document.getElementById(this.targetColumn.uid+"-flmdlg"):this.parent.element.querySelector("."+this.POP)},n.prototype.isFilterItemAdded=function(){return this.parent.columnMenuItems&&this.parent.columnMenuItems.indexOf("Filter")>=0||!this.parent.columnMenuItems},n}(),srt=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),hrt=function(n){function t(t,i){var r=n.call(this,t,i)||this;return r.parent=t,r.serviceLocator=i,r.initEvent(),r}return srt(t,n),t.prototype.initEvent=function(){this.parent.isDestroyed||(this.parent.on(go,this.initForeignKeyColumns,this),this.parent.on(fe,this.getForeignKeyData,this),this.parent.on(iu,this.generateQueryFormData,this))},t.prototype.initForeignKeyColumns=function(n){for(var t=0;t<n.length;t++)n[t].dataSource=n[t].dataSource instanceof e.DataManager?n[t].dataSource:Object(r.isNullOrUndefined)(n[t].dataSource)?new e.DataManager:"result"in n[t].dataSource?n[t].dataSource:new e.DataManager(n[t].dataSource)},t.prototype.eventfPromise=function(n,t,i,u){var o=this.getStateEventArgument(t),s=new e.Deferred,h=new e.Deferred,f;return o.action=n.action,f=this.parent.getDataModule(),!Object(r.isNullOrUndefined)(n.action)&&n.action.requestType&&!1!==f.foreignKeyDataState.isDataChanged?(f.setForeignKeyDataState({isPending:!0,resolver:h.resolve}),h.promise.then(function(){s.resolve(u.dataSource)}),o.setColumnData=this.parent.setForeignKeyData.bind(this.parent),this.parent.trigger(bp,o)):(f.setForeignKeyDataState({}),s.resolve(i)),s},t.prototype.getForeignKeyData=function(n){for(var o=this,t=n.column?[n.column]:this.parent.getForeignKeyColumns(),f=[],s=function(r){var o=void 0,e=n.isComplex?i.genarateColumnQuery(t[r]):i.genarateQuery(t[r],n.result.result,!1,!0),u;e.params=i.parent.query.params;u=t[r].dataSource;o=u&&"result"in u?i.eventfPromise(n,e,u,t[r]).promise:!u.ready||u.dataSource.offline?u.executeQuery(e):u.ready.then(function(){return u.executeQuery(e)});f.push(o)},i=this,u=0;u<t.length;u++)s(u);Promise.all(f).then(function(i){for(var u=0;u<i.length;u++)t[u].columnData=i[u].result,"dropdownedit"===t[u].editType&&"result"in t[u].dataSource&&(t[u].edit.params=Object(r.extend)(t[u].edit.params,{dataSource:i[u].result,query:new e.Query,fields:{value:t[u].foreignKeyField||t[u].field,text:t[u].foreignKeyValue}}));n.promise.resolve(n.result)}).catch(function(t){return o.parent.log(["actionfailure","foreign_key_failure"]),n.promise&&n.promise.reject&&n.promise.reject(t),t})},t.prototype.generateQueryFormData=function(n){n.predicate.predicate=this.genarateQuery(n.column,n.column.columnData,!0)},t.prototype.genarateQuery=function(n,t,i,r){var h=this.parent,f=[],c=new e.Query,s=i?n.foreignKeyField:n.field,o,u;if(h.allowPaging||h.enableVirtualization||i)for(t=new e.DataManager(h.allowGrouping&&h.groupSettings.columns.length&&!i?t.records:t).executeLocal((new e.Query).select(s)),o=e.DataUtil.distinct(t,s,!1),s=i?n.field:n.foreignKeyField,u=0;u<o.length;u++)o[u]&&o[u].getDay?f.push(ir({field:s,operator:"equal",value:o[u],matchCase:!1})):f.push(new e.Predicate(s,"equal",o[u],!1));return r?f.length?c.where(e.Predicate.or(f)):c:f.length?e.Predicate.or(f):{predicates:[]}},t.prototype.genarateColumnQuery=function(n){var r=this.parent,t=new e.Query,u=this.isFiltered(n),i;return(u.isTrue&&(t=this.filterQuery(t,u.column,!0)),r.searchSettings.key.length)&&(i=r.searchSettings,n.dataSource instanceof e.DataManager&&n.dataSource.adaptor.getModuleName&&"ODataV4Adaptor"===n.dataSource.adaptor.getModuleName()?t=this.searchQuery(t,n,!0):t.search(i.key,n.foreignKeyValue,i.operator,i.ignoreCase)),t},t.prototype.isFiltered=function(n){var t=this.parent.filterSettings.columns.filter(function(t){return t.field===n.foreignKeyValue&&t.uid===n.uid});return{column:t,isTrue:!!t.length}},t.prototype.getModuleName=function(){return"foreignKey"},t.prototype.destroy=function(){this.destroyEvent()},t.prototype.destroyEvent=function(){this.parent.isDestroyed||(this.parent.off(go,this.initForeignKeyColumns),this.parent.off(fe,this.getForeignKeyData),this.parent.off(iu,this.generateQueryFormData))},t}(ye),ur="https://ej2.syncfusion.com/documentation/grid",bh="https://ej2.syncfusion.com/documentation/",fr="[EJ2Grid.Warning]",pu="[EJ2Grid.Error]",kh="[EJ2Grid.Info]",crt=function(){function n(n){this.parent=n;this.parent.on("initial-end",this.patchadaptor,this)}return n.prototype.getModuleName=function(){return"logger"},n.prototype.log=function(n,t){var u,i,r,f;for(n instanceof Array||(n=[n]),u=n,i=0;i<u.length;i++)r=gd[u[i]],f=r.check(t,this.parent),f.success&&console[r.logType](r.generateMessage(t,this.parent,f.options))},n.prototype.patchadaptor=function(){var n=this.parent.getDataModule().dataManager.adaptor,t=n.beforeSend;t&&(n.beforeSend=function(i,r,u){t.call(n,i,r,u)})},n.prototype.destroy=function(){this.parent.isDestroyed||this.parent.off("initial-end",this.patchadaptor)},n}(),gd={module_missing:{type:"module_missing",logType:"warn",check:function(n,t){var r=t.getInjectedModules().map(function(n){return n.prototype.getModuleName()}),i=t.requiredModules().map(function(n){return n.member}).filter(function(n){return-1===r.indexOf(n)});return{success:i.filter(function(n){return"resize"!==n}).length>0,options:i}},generateMessage:function(n,t,i){return i=i.filter(function(n){return"resize"!==n}).reduce(function(n,t){return n+"* "+t+"\n"},""),fr+": MODULES MISSING\nThe following modules are not injected:.\n"+i+"Refer to "+ur+"/module.html for documentation on importing feature modules."}},promise_enabled:{type:"promise_enabled",logType:"error",check:function(){return{success:"undefined"==typeof Promise}},generateMessage:function(){return pu+": PROMISE UNDEFINED\nPromise object is not present in the global environment,please use polyfil to support Promise object in your environment.\nRefer to "+bh+"/base/browser.html?#required-polyfills for more information."}},primary_column_missing:{type:"primary_column_missing",logType:"warn",check:function(n,t){return{success:0===t.getColumns().filter(function(n){return n.isPrimaryKey}).length}},generateMessage:function(){return fr+": PRIMARY KEY MISSING\nEditing is enabled but primary key column is not specified.\nRefer to "+ur+"/api-column.html?#isprimarykey for documentation on providing primary key columns."}},selection_key_missing:{type:"selection_key_missing",logType:"warn",check:function(n,t){return{success:t.selectionSettings.persistSelection&&0===t.getColumns().filter(function(n){return n.isPrimaryKey}).length}},generateMessage:function(){return fr+": PRIMARY KEY MISSING\nselectionSettings.persistSelection property is enabled. It requires one primary key column to persist selection.\nRefer to "+ur+"/api-column.html?#isprimarykey for documentation on providing primary key columns."}},actionfailure:{type:"actionfailure",logType:"error",check:function(){return{success:!0}},generateMessage:function(n,t){var i="",r=lrt(n,t),u=art(n,t);return i=""!==u?u:""!==r?r:n.error,fr+": "+i}},locale_missing:{type:"locale_missing",logType:"warn",check:function(n,t){var i=e.DataUtil.getObject("locale."+t.locale+".grid",r.L10n);return{success:"en-US"!==t.locale&&Object(r.isNullOrUndefined)(i)}},generateMessage:function(n,t){return fr+": LOCALE CONFIG MISSING\nLocale configuration for '"+t.locale+"' is not provided.\nRefer to "+ur+"/globalization-and-localization.html?#localization \n             for documentation on setting locale configuration."}},limitation:{type:"limitation",logType:"warn",check:function(n,t){var i;switch(n){case"freeze":i={success:t.allowGrouping||!Object(r.isUndefined)(t.detailTemplate)||!Object(r.isUndefined)(t.childGrid)||!Object(r.isUndefined)(t.rowTemplate)||t.enableVirtualization,options:{name:"freeze"}};break;case"virtualization":i={success:!Object(r.isUndefined)(t.detailTemplate)||!Object(r.isUndefined)(t.childGrid)||0!==t.frozenRows||0!==t.frozenColumns,options:{name:"virtualization"}};break;default:i={success:!1}}return i},generateMessage:function(n,t,i){var r,u=i.name;switch(u){case"freeze":r="Frozen rows and columns do not support the following features:\n* Virtualization\n* Row Template\n* Details Template\n* Hierarchy Grid\n* Grouping";break;case"virtualization":r="Virtualization does not support the following features.\n* Freeze rows and columns.\n* Details Template.\n* Hierarchy Grid.\n";break;default:r=""}return fr+": "+u.toUpperCase()+" LIMITATIONS\n"+r}},check_datasource_columns:{type:"check_datasource_columns",logType:"warn",check:function(n,t){return{success:!(t.columns.length||t.dataSource instanceof e.DataManager||t.dataSource.length)}},generateMessage:function(){return fr+": GRID CONFIG MISSING\ndataSource and columns are not provided in the grid. At least one of either must be provided for grid configuration.\nRefer to "+ur+"/columns.html for documentation on configuring the grid data and columns."}},virtual_height:{type:"virtual_height",logType:"error",check:function(n,t){return{success:Object(r.isNullOrUndefined)(t.height)||"auto"===t.height}},generateMessage:function(){return pu+": GRID HEIGHT MISSING \nheight property is required to use virtualization.\nRefer to "+ur+"/virtual.html for documentation on configuring the virtual grid."}},grid_remote_edit:{type:"grid_remote_edit",logType:"error",check:function(n){return{success:Array.isArray(n)||Array.isArray(n.result)}},generateMessage:function(){return pu+": RETRUN VALUE MISSING  \nRemote service returns invalid data. \nRefer to "+ur+"/edit.html for documentation on configuring editing with remote data."}},grid_sort_comparer:{type:"grid_sort_comparer",logType:"warn",check:function(n,t){return{success:t.getDataModule().isRemote()}},generateMessage:function(){return fr+": SORT COMPARER NOT WORKING  \nSort comparer will not work with remote data.Refer to "+ur+"/sorting/#custom-sort-comparer for documentation on using the sort comparer."}},resize_min_max:{type:"resize_min_max",logType:"info",check:function(n){return{success:n.column.minWidth&&n.column.minWidth>=n.width||n.column.maxWidth&&n.column.maxWidth<=n.width}},generateMessage:function(){return kh+": RESIZING COLUMN REACHED MIN OR MAX  \nThe column resizing width is at its min or max."}},action_disabled_column:{type:"action_disabled_column",logType:"info",check:function(n){var t;switch(n.moduleName){case"reorder":t=Object(r.isNullOrUndefined)(n.destColumn)?"reordering action is disabled for the "+n.column.headerText+" column":"reordering action is disabled for the "+(n.column.allowReordering?n.destColumn.headerText:n.column.headerText)+" column";break;case"group":t="grouping action is disabled for the "+n.columnName+" column.";break;case"filter":t="filtering action is disabled for the "+n.columnName+" column.";break;case"sort":t="sorting action is disabled for the "+n.columnName+" column."}return{success:!0,options:{fn:t}}},generateMessage:function(n,t,i){return kh+": ACTION DISABLED \n "+i.fn}},exporting_begin:{type:"exporting_begin",logType:"info",check:function(n){return{success:!0,options:{args:n}}},generateMessage:function(n,t,i){return kh+": EXPORTNIG INPROGRESS \n Grid "+i.args+"ing is in progress"}},exporting_complete:{type:"exporting_complete",logType:"info",check:function(n){return{success:!0,options:{args:n}}},generateMessage:function(n,t,i){return kh+": EXPORTNIG COMPLETED \n Grid "+i.args+"ing is complete"}},foreign_key_failure:{type:"foreign_key_failure",logType:"error",check:function(){return{success:!0}},generateMessage:function(){return pu+": FOREIGNKEY CONFIG \n  Grid foreign key column needs a valid data source/service.Refer to "+ur+"/columns/#foreign-key-column for documentation on configuring foreign key columns."}},initial_action:{type:"initial_action",logType:"error",check:function(n){var t;switch(n.moduleName){case"group":t="The "+n.columnName+" column is not available in the grid's column model.Please provide a valid field name to group the column";break;case"filter":t="The "+n.columnName+" column is not available in the grid's column model.Please provide a valid field name to filter the column.";break;case"sort":t="The "+n.columnName+" column is not available in the grid's column model.Please provide a valid field name to sort the column."}return{success:!0,options:{fn:t}}},generateMessage:function(n,t,i){return pu+": INITIAL ACTION FAILURE \n "+i.fn}},frozen_rows_columns:{type:"frozen_rows_columns",logType:"error",check:function(n,t){return{success:t.getColumns().length<=t.frozenColumns||t.frozenRows>=t.currentViewData.length}},generateMessage:function(n,t){return pu+": OUT OF RANGE ERROR-\n "+(t.getColumns().length<=t.frozenColumns?"FROZEN COLUMNS,":"")+(t.frozenRows>=t.currentViewData.length?"FROZEN ROWS":"")+" invalid"}},column_type_missing:{type:"column_type_missing",logType:"error",check:function(n){return{success:Object(r.isNullOrUndefined)(n.column.type),options:n.column.headerText}},generateMessage:function(n,t,i){return pu+": COLUMN TYPE MISSING-\n  "+i+" column type was invalid or not defined.Please go through below help link: "+bh+"/grid/columns/#column-type"}},datasource_syntax_mismatch:{type:"datasource_syntax_mismatch",logType:"warn",check:function(n){return{success:(n.dataState.dataSource instanceof e.DataManager||n.dataState.dataSource instanceof Array)&&!Object(r.isNullOrUndefined)(n.dataState.dataStateChange)}},generateMessage:function(){return fr+": DATASOURCE SYNTAX WARNING\nDataSource should be in the form of {result: Object[], count: number}when dataStateChangeEvent used"}}},lrt=function(n){var t=n.error;return t.indexOf&&0!==t.indexOf("Format options")?"":"INVALID FORMAT\nFor more information, refer to the following documentation links:\nNumber format: "+bh+"/base/intl.html?#supported-format-string.\nDate format: "+bh+"/base/intl.html?#manipulating-datetime.\nMessage: "+t},art=function(n){var t=e.DataUtil.getObject("error.error",n),i;if(Object(r.isNullOrUndefined)(t))return"";i="";try{i=JSON.parse(t.responseText)}catch(n){i=""}return"XMLHTTPREQUEST FAILED\nUrl: "+t.responseURL+"\nStatus: "+t.status+" - "+t.statusText+"\n"+(""!==i?"Message: "+i:"")},vrt=function(){function n(n,t){this.infiniteCache={};this.infiniteFrozenCache={};this.isDownScroll=!1;this.isUpScroll=!1;this.isScroll=!0;this.enableContinuousScroll=!1;this.initialRender=!0;this.isRemove=!1;this.isInitialCollapse=!1;this.prevScrollTop=0;this.actions=["filtering","searching","grouping","ungrouping","reorder","sorting"];this.keys=["downArrow","upArrow","PageUp","PageDown"];this.rowTop=0;this.isInitialMovableRender=!0;this.virtualInfiniteData={};this.isCancel=!1;this.emptyRowData={};this.isNormaledit=!1;this.isInfiniteScroll=!1;this.isLastPage=!1;this.parent=n;this.serviceLocator=t;this.isNormaledit="Normal"===this.parent.editSettings.mode;this.addEventListener();this.rowModelGenerator=this.parent.getFrozenColumns()?new wh(this.parent):new vi(this.parent)}return n.prototype.getModuleName=function(){return"infiniteScroll"},n.prototype.addEventListener=function(){this.parent.on(at,this.onDataReady,this);this.parent.on(ar,this.dataSourceModified,this);this.parent.on(hs,this.infinitePageQuery,this);this.parent.on(ss,this.infiniteScrollHandler,this);this.parent.on(hr,this.infiniteCellFocus,this);this.parent.on(ls,this.appendInfiniteRows,this);this.parent.on(as,this.removeInfiniteCacheRows,this);this.parent.on(os,this.resetInfiniteBlocks,this);this.parent.on(vs,this.setCache,this);this.parent.on(ys,this.ensureIntialCollapse,this);this.parent.on(w,this.infiniteCellFocus,this);this.parent.on(cs,this.setDisplayNone,this);this.parent.on(se,this.editActionBegin,this);this.parent.on(eu,this.getVirtualInfiniteData,this);this.parent.on(ce,this.resetInfiniteEdit,this);this.parent.on(ff,this.infiniteEditSuccess,this);this.parent.on(he,this.refreshInfiniteCache,this);this.parent.on(ae,this.infiniteEditHandler,this);this.parent.on(le,this.infiniteAddActionBegin,this);this.parent.on(p,this.modelChanged,this);this.parent.addEventListener(l,this.actionBegin.bind(this));this.parent.addEventListener(c,this.actionComplete.bind(this))},n.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(at,this.onDataReady),this.parent.off(ar,this.dataSourceModified),this.parent.off(hs,this.infinitePageQuery),this.parent.off(ss,this.infiniteScrollHandler),this.parent.off(hr,this.infiniteCellFocus),this.parent.off(ls,this.appendInfiniteRows),this.parent.off(as,this.removeInfiniteCacheRows),this.parent.off(os,this.resetInfiniteBlocks),this.parent.off(vs,this.setCache),this.parent.off(ys,this.ensureIntialCollapse),this.parent.off(w,this.infiniteCellFocus),this.parent.off(cs,this.setDisplayNone),this.parent.off(se,this.editActionBegin),this.parent.off(eu,this.getVirtualInfiniteData),this.parent.off(ce,this.resetInfiniteEdit),this.parent.off(ff,this.infiniteEditSuccess),this.parent.off(he,this.refreshInfiniteCache),this.parent.off(ae,this.infiniteEditHandler),this.parent.off(le,this.infiniteAddActionBegin),this.parent.off(p,this.modelChanged),this.parent.removeEventListener(l,this.actionBegin.bind(this)),this.parent.removeEventListener(c,this.actionComplete.bind(this)))},n.prototype.modelChanged=function(n){var t,i;"infiniteScroll"!==n.requestType&&("delete"===n.requestType||"add"===this.requestType)&&(t=this.parent.getRows(),(this.firstIndex=parseInt(t[0].getAttribute("aria-rowindex"),10),this.firstBlock=Math.ceil((this.firstIndex+1)/this.parent.pageSettings.pageSize),this.lastIndex=parseInt(t[t.length-1].getAttribute("aria-rowindex"),10),"delete"===n.requestType)?(i=this.parent.getRowsObject(),n.startIndex=this.parent.infiniteScrollSettings.enableCache?(this.firstBlock-1)*this.parent.pageSettings.pageSize:i[i.length-1].index):n.startIndex=this.firstIndex,this.parent.infiniteScrollSettings.enableCache||this.parent.pageSettings.currentPage!==this.maxPage||"delete"!==n.requestType||(this.isLastPage=!0,this.lastIndex=this.lastIndex-1))},n.prototype.infiniteAddActionBegin=function(n){this.isNormaledit&&(this.isAdd=!0,this.parent.infiniteScrollSettings.enableCache&&(Object.keys(this.emptyRowData).length||this.createEmptyRowdata(),this.parent.pageSettings.currentPage>1&&(n.startEdit=!1,this.resetInfiniteBlocks({},!0),this.makeRequest({currentPage:1}))))},n.prototype.infiniteEditHandler=function(n){var f,e;if(!this.parent.infiniteScrollSettings.enableCache&&("delete"===n.e.requestType||"save"===n.e.requestType&&"add"===this.requestType)){var i=this.parent.getFrozenColumns(),u=this.parent.getRows(),t=this.parent.getRowsObject();this.ensureRowAvailability(t,n.result[0])&&((this.resetRowIndex(t,n.e,u,"add"===this.requestType),i)&&(f=this.parent.getMovableRowsObject(),this.resetRowIndex(f,n.e,this.parent.getMovableDataRows(),"add"===this.requestType)),this.isLastPage?(this.isLastPage=!1,this.parent.pageSettings.currentPage=this.maxPage,this.parent.selectionModule.index<this.parent.frozenRows)&&((Object(r.remove)(u[this.parent.frozenRows-1]),this.createRow([t[this.parent.frozenRows-1]],n,!1,!0),i)&&(e=this.parent.getMovableDataRows(),Object(r.remove)(e[this.parent.frozenRows]),this.createRow([this.parent.getMovableRowsObject()[this.parent.frozenRows-1]],n,!0,!0)),uo(this.parent)):this.createRow(t,n));this.parent.hideSpinner();"delete"===this.requestType?this.parent.notify(po,n.e):this.parent.notify(yo,n.e)}},n.prototype.createRow=function(n,t,i,u){var f=u?n:this.generateRows(t.result,t.e),s=new dt(this.serviceLocator,null,this.parent),e=this.parent.getFrozenColumns()?i?this.parent.getMovableVirtualContent().querySelector("tbody"):this.parent.getFrozenVirtualContent().querySelector("tbody"):this.parent.getContent().querySelector("tbody"),o,h,c;for(this.parent.frozenRows&&(e=u&&"add"!==this.requestType||!u&&"add"===this.requestType?this.parent.getFrozenColumns()?i?this.parent.getMovableVirtualHeader().querySelector("tbody"):this.parent.getFrozenVirtualHeader().querySelector("tbody"):this.parent.getHeaderContent().querySelector("tbody"):e),o=f.length-1;o>=0;o--)"delete"===this.requestType?e.appendChild(s.render(f[o],this.parent.getColumns())):e.insertBefore(s.render(f[o],this.parent.getColumns()),e.firstElementChild);!u&&this.parent.frozenRows&&(this.parent.selectionModule.index<this.parent.frozenRows||"add"===this.requestType)&&(h=i?this.parent.getMovableDataRows():this.parent.getRows(),c=i&&"add"===this.requestType?this.parent.frozenRows:this.parent.frozenRows-1,Object(r.remove)(h[c]),this.createRow([n[this.parent.frozenRows-1]],t,i,!0));this.parent.infiniteScrollSettings.enableCache||u||(!this.parent.getFrozenColumns()||i?(uo(this.parent),this.parent.contentModule.visibleRows="add"===this.requestType?f.concat(n):n.concat(f)):(this.parent.contentModule.visibleFrozenRows="add"===this.requestType?f.concat(n):n.concat(f),this.createRow(this.parent.getMovableRowsObject(),t,!0)))},n.prototype.ensureRowAvailability=function(n,t){var u=!0,r,i;if(this.parent.frozenRows&&!this.parent.infiniteScrollSettings.enableCache&&this.parent.sortSettings.columns&&"add"===this.requestType)for(r=this.parent.getPrimaryKeyFieldNames()[0],i=0;i<n.length;i++)if(n[i].data[r]===t[r]){u=!1;break}return u},n.prototype.generateRows=function(n,t){return this.rowModelGenerator.generateRows(n,t)},n.prototype.resetRowIndex=function(n,t,i,u){var f=this.parent.getPrimaryKeyFieldNames()[0],o=!(i.length%this.parent.pageSettings.pageSize),e;u?o&&(Object(r.remove)(i[n.length-1]),i.splice(n.length-1,1),n.splice(n.length-1,1)):n.filter(function(u,e){u.data[f]===t.data[0][f]&&(n.splice(e,1),Object(r.remove)(i[e]),i.splice(e,1))});e=u?1:0;fv(this.parent,n,i,e)},n.prototype.setDisplayNone=function(n){if(this.parent.infiniteScrollSettings.enableCache){for(var i=this.parent.getFrozenColumns(),r=i?Object.keys(this.infiniteFrozenCache):Object.keys(this.infiniteCache),t=1;t<=r.length;t++)(i?n.isFreeze?this.infiniteFrozenCache[t][0]:this.infiniteFrozenCache[t][1]:this.infiniteCache[t]).filter(function(t){t.cells[n.index].visible=""===n.visible});this.resetContentModuleCache(i?this.infiniteFrozenCache:this.infiniteCache)}},n.prototype.refreshInfiniteCache=function(n){this.getEditedRowObject().data=n},n.prototype.getEditedRowObject=function(){for(var i,t=this.parent.getRowsObject(),n=0;n<t.length;n++)t[n].index===this.editRowIndex&&(i=t[n]);return i},n.prototype.infiniteEditSuccess=function(n){this.isNormaledit&&(!this.isAdd&&n.data&&this.updateCurrentViewRecords(n.data),this.isAdd=!1)},n.prototype.updateCurrentViewRecords=function(n){var t=lh(this.parent,n);Object(r.isNullOrUndefined)(t)||(this.parent.getCurrentViewRecords()[t]=n)},n.prototype.actionBegin=function(n){"add"!==n.requestType&&"delete"!==n.requestType||(this.requestType=n.requestType)},n.prototype.actionComplete=function(n){"delete"!==n.requestType&&"save"!==n.requestType&&"cancel"!==n.requestType||(this.requestType=this.empty,this.isCancel="cancel"===n.requestType||"save"===n.requestType,this.isAdd=this.isEdit=!1,this.isNormaledit&&(this.editRowIndex=this.empty,this.virtualInfiniteData={},this.parent.editModule.previousVirtualData={}))},n.prototype.resetInfiniteEdit=function(){this.parent.enableInfiniteScrolling&&this.isNormaledit&&(this.parent.editSettings.allowEditing&&this.isEdit||this.parent.editSettings.allowAdding&&this.isAdd)&&(this.parent.isEdit=!0)},n.prototype.getVirtualInfiniteData=function(n){n.virtualData=this.virtualInfiniteData;n.isAdd=this.isAdd;n.isCancel=this.isCancel},n.prototype.editActionBegin=function(n){this.isEdit=!0;this.editRowIndex=n.index;var t=Object(r.extend)({},this.getEditedRowObject().data);n.data=Object.keys(this.virtualInfiniteData).length?this.virtualInfiniteData:t},n.prototype.dataSourceModified=function(){this.resetInfiniteBlocks({requestType:this.empty},!0)},n.prototype.onDataReady=function(n){Object(r.isNullOrUndefined)(n.count)||(this.maxPage=Math.ceil(n.count/this.parent.pageSettings.pageSize))},n.prototype.ensureIntialCollapse=function(n){this.isInitialCollapse=!n},n.prototype.infiniteScrollHandler=function(n){var s=this,t,i,a;if(this.restoreInfiniteEdit(),this.restoreInfiniteAdd(),t=n.target,(t.classList.contains("e-content")||t.classList.contains("e-movablecontent"))&&this.parent.enableInfiniteScrolling){i=this.parent.getFrozenColumns()?this.parent.getMovableVirtualContent():this.parent.getContent().firstElementChild;this.prevScrollTop=i.scrollTop;var h=this.parent.getRows(),v=parseInt(h[h.length-1].getAttribute("aria-rowindex"),10)+1,c=this.parent.pageSettings.currentPage,u=void 0,e=t.scrollHeight-t.scrollTop,y=Math.round(t.scrollHeight-t.scrollTop),p=(e<t.clientHeight?Math.ceil(e):Math.floor(e))===t.clientHeight||y===t.clientHeight;if(this.isScroll&&p&&(this.parent.pageSettings.currentPage<=this.maxPage-1||this.enableContinuousScroll)){this.parent.infiniteScrollSettings.enableCache&&(this.isUpScroll=!1,this.isDownScroll=!0,setTimeout(function(){s.isScroll=!0},600));var l=[].slice.call(i.querySelectorAll(".e-row:not(.e-addedrow)")),f=l[l.length-1],o=parseInt(f.getAttribute("aria-rowindex"),10);this.parent.pageSettings.currentPage=Math.ceil(o/this.parent.pageSettings.pageSize)+1;u={requestType:"infiniteScroll",currentPage:this.parent.pageSettings.currentPage,prevPage:c,startIndex:v,direction:"down"};this.makeRequest(u)}this.isScroll&&this.parent.infiniteScrollSettings.enableCache&&0===t.scrollTop&&1!==this.parent.pageSettings.currentPage&&(this.parent.infiniteScrollSettings.enableCache&&(this.isDownScroll=!1,this.isUpScroll=!0,setTimeout(function(){s.isScroll=!0},600)),f=[].slice.call(i.querySelectorAll(".e-row")),o=parseInt(f[this.parent.pageSettings.pageSize-1].getAttribute("aria-rowindex"),10),a=parseInt(f[0].getAttribute("aria-rowindex"),10)-this.parent.pageSettings.pageSize,this.parent.pageSettings.currentPage=Math.ceil(o/this.parent.pageSettings.pageSize)-1,this.parent.pageSettings.currentPage&&(u={requestType:"infiniteScroll",currentPage:this.parent.pageSettings.currentPage,prevPage:c,startIndex:a,direction:"up"},this.makeRequest(u)));this.parent.infiniteScrollSettings.enableCache&&!this.isScroll&&Object(r.isNullOrUndefined)(u)&&(this.isDownScroll||this.isUpScroll)&&(i.scrollTop=this.top)}},n.prototype.makeRequest=function(n){var t=this;this.parent.pageSettings.currentPage!==n.prevPage&&(this.parent.pageSettings.currentPage<=this.maxPage?(this.isInfiniteScroll=!0,Object(r.isNullOrUndefined)(this.infiniteCache[n.currentPage])?setTimeout(function(){t.getVirtualInfiniteEditedData();t.parent.notify("model-changed",n)},100):setTimeout(function(){t.getVirtualInfiniteEditedData();t.parent.notify(na,n)},100)):this.parent.pageSettings.currentPage=this.maxPage)},n.prototype.infinitePageQuery=function(n){this.initialRender?(this.initialRender=!1,this.intialPageQuery(n)):this.isInfiniteScroll||"delete"!==this.requestType&&"add"!==this.requestType?n.page(this.parent.pageSettings.currentPage,this.parent.pageSettings.pageSize):this.editPageQuery(n)},n.prototype.editPageQuery=function(n){var i=this.parent.infiniteScrollSettings.initialBlocks,t;this.parent.infiniteScrollSettings.enableCache?(this.infiniteCache={},this.infiniteFrozenCache={},n.skip(this.firstIndex),n.take(i*this.parent.pageSettings.pageSize)):("Dialog"===this.parent.editSettings.mode&&this.parent.clearSelection(),t="delete"===this.requestType?this.lastIndex:this.firstIndex,n.skip(t),n.take(1))},n.prototype.intialPageQuery=function(n){this.parent.infiniteScrollSettings.enableCache&&this.parent.infiniteScrollSettings.initialBlocks>this.parent.infiniteScrollSettings.maxBlocks&&(this.parent.infiniteScrollSettings.initialBlocks=this.parent.infiniteScrollSettings.maxBlocks);var t=this.parent.pageSettings.pageSize*this.parent.infiniteScrollSettings.initialBlocks;n.page(1,t)},n.prototype.infiniteCellFocus=function(n){var t,s,u,f,e;if(n.byKey&&("upArrow"===n.keyArgs.action||"downArrow"===n.keyArgs.action)){this.pressedKey=n.keyArgs.action;var o=document.activeElement,r=parseInt(o.parentElement.getAttribute("aria-rowindex"),10),i=this.parent.getContent().firstElementChild;this.rowIndex="downArrow"===n.keyArgs.action?r+1:r-1;this.cellIndex=parseInt(o.getAttribute("aria-colindex"),10);t=this.parent.getRowByIndex(r);s=Math.floor(i.offsetHeight/this.parent.getRowHeight());!t||hh(t,this.parent)||ch(t,this.rowTop)?(u=t?t.getBoundingClientRect().height:this.parent.getRowHeight(),this.parent.infiniteScrollSettings.enableCache||("downArrow"===n.keyArgs.action&&(hh(t,this.parent)||!t)&&(f=(this.rowIndex-s)*u,e=i.scrollTop+this.parent.getRowHeight(),i.scrollTop=f<e?e:f),"upArrow"===n.keyArgs.action&&ch(t,this.rowTop)&&(i.scrollTop=this.rowIndex*u))):this.pressedKey=this.empty}else"PageDown"!==n.key&&"PageUp"!==n.key||(this.pressedKey=n.key)},n.prototype.createEmptyRowdata=function(){var n=this;this.parent.getColumns().filter(function(t){n.emptyRowData[t.field]=n.empty})},n.prototype.getVirtualInfiniteEditedData=function(){var t=this.parent.element.querySelector(".e-editedrow"),i=this.parent.element.querySelector(".e-addedrow"),u=this.parent.element.querySelector(".e-gridform"),n;this.parent.infiniteScrollSettings.enableCache&&(t||i)&&(n=t?Object(r.extend)({},this.getEditedRowObject().data):Object(r.extend)({},this.emptyRowData),this.virtualInfiniteData=this.parent.editModule.getCurrentEditedData(u,n),this.parent.getFrozenColumns()&&(this.virtualInfiniteData=this.parent.editModule.getCurrentEditedData(this.parent.getMovableVirtualContent().querySelector(".e-gridform"),n)))},n.prototype.restoreInfiniteEdit=function(){var i=this.parent.getFrozenColumns()?this.parent.getMovableVirtualContent():this.parent.getContent().firstElementChild,u=!this.parent.frozenRows||this.editRowIndex>=this.parent.frozenRows,n,t;this.isNormaledit&&this.parent.infiniteScrollSettings.enableCache&&u&&this.parent.editSettings.allowEditing&&!Object(r.isNullOrUndefined)(this.editRowIndex)&&(n=this.parent.getRowByIndex(this.editRowIndex),Object.keys(this.virtualInfiniteData).length&&n&&!this.parent.getContent().querySelector(".e-editedrow")&&(t=n.getBoundingClientRect().top,t<i.offsetHeight&&t>this.parent.getRowHeight()&&(this.parent.isEdit=!1,this.parent.editModule.startEdit(n))))},n.prototype.restoreInfiniteAdd=function(){var n=this.parent.getFrozenColumns()?this.parent.getMovableVirtualContent():this.parent.getContent().firstElementChild;this.parent.getRowByIndex(0)&&this.isNormaledit&&this.parent.infiniteScrollSettings.enableCache&&this.isAdd&&!n.querySelector(".e-addedrow")&&n.scrollTop<this.parent.getRowHeight()&&(this.parent.isEdit=!1,this.parent.addRecord())},n.prototype.appendInfiniteRows=function(n){var i;document.activeElement;var r=this.parent.getFrozenColumns(),u=r?this.parent.getMovableVirtualContent():this.parent.getContent().firstElementChild,t=this.parent.enableInfiniteScrolling&&"infiniteScroll"===n.args.requestType;((t&&!n.args.isFrozen||!t)&&(t&&"up"===n.args.direction?n.tbody.insertBefore(n.frag,n.tbody.firstElementChild):n.tbody.appendChild(n.frag)),r)?t?n.args.isFrozen?this.frozenFrag=n.frag:(i=this.parent.getFrozenVirtualContent().querySelector("tbody"),"up"===n.args.direction?i.insertBefore(this.frozenFrag,i.firstElementChild):i.appendChild(this.frozenFrag),this.parent.getMovableVirtualContent().querySelector(".e-table").appendChild(n.tbody)):(n.args.isFrozen?this.parent.getFrozenVirtualContent().querySelector(".e-table"):this.parent.getMovableVirtualContent().querySelector(".e-table")).appendChild(n.tbody):this.parent.contentModule.getTable().appendChild(n.tbody);n.args.isFrozen||(this.rowTop=this.rowTop?this.rowTop:this.parent.getRows()[0].getBoundingClientRect().top,t&&(this.parent.infiniteScrollSettings.enableCache&&this.isRemove&&(u.scrollTop=this.top,r&&(this.parent.getFrozenVirtualContent().scrollTop=this.top)),uo(this.parent),this.selectNewRow(n.tbody,n.args.startIndex),this.pressedKey=void 0),this.restoreInfiniteAdd());this.isInfiniteScroll=!1},n.prototype.setRowElements=function(){this.parent.getFrozenColumns()?(this.parent.contentModule.rowElements=[].slice.call(this.parent.element.querySelectorAll(".e-movableheader .e-row, .e-movablecontent .e-row")),this.parent.contentModule.freezeRowElements=[].slice.call(this.parent.element.querySelectorAll(".e-frozenheader .e-row, .e-frozencontent .e-row"))):this.parent.contentModule.rowElements=[].slice.call(this.parent.element.querySelectorAll(".e-row:not(.e-addedrow)"))},n.prototype.selectNewRow=function(n,t){var i=this,u=this.parent.getRowByIndex(this.rowIndex),r;this.keys.some(function(n){return n===i.pressedKey})&&((("downArrow"===this.pressedKey||this.parent.infiniteScrollSettings.enableCache&&"upArrow"===this.pressedKey)&&setTimeout(function(){u.cells[0].focus({preventScroll:!0});i.parent.selectRow(i.rowIndex);i.parent.getContent().firstElementChild.scrollTop+=i.parent.getRowHeight()},0),"PageDown"===this.pressedKey)&&(r=this.parent.getRowByIndex(t),r&&r.cells[0].focus()),"PageUp"===this.pressedKey&&n.querySelector(".e-row").cells[0].focus())},n.prototype.removeInfiniteCacheRows=function(n){var u=this.parent.enableInfiniteScrolling&&"infiniteScroll"===n.args.requestType,t,i,r;!n.args.isFrozen&&u&&this.parent.infiniteScrollSettings.enableCache&&this.isRemove&&(t=[].slice.call(this.parent.getContentTable().querySelectorAll(".e-row")),"down"===n.args.direction&&(this.parent.allowGrouping&&this.parent.groupSettings.columns.length&&(i=[].slice.call(this.parent.getContentTable().querySelectorAll("tr")),this.removeCaptionRows(i,n.args)),r=this.parent.element.querySelector(".e-addedrow")?0:1,this.removeTopRows(t,this.parent.pageSettings.pageSize-r)),"up"===n.args.direction&&(this.parent.allowGrouping&&this.parent.groupSettings.columns.length?(i=[].slice.call(this.parent.getContentTable().querySelectorAll("tr")),this.removeCaptionRows(i,n.args)):this.removeBottomRows(t,t.length-1,n.args)),this.isScroll=!1,this.top=this.calculateScrollTop(n.args))},n.prototype.calculateScrollTop=function(n){var t=0,h=this.parent.getFrozenColumns()?this.parent.getMovableVirtualContent():this.parent.getContent().firstElementChild,u,f,e,o;if("down"===n.direction){this.parent.allowGrouping&&this.parent.groupSettings.columns.length&&!this.isInitialCollapse&&(t=this.captionRowHeight());u=[].slice.call(this.parent.getContent().firstElementChild.querySelectorAll("tr:not(.e-row)"));f=0;this.isInitialCollapse&&!Object(r.isNullOrUndefined)(u)&&(f=Math.round((u.length-1)/this.parent.groupSettings.columns.length));for(var c=f||this.parent.pageSettings.pageSize*(this.parent.infiniteScrollSettings.maxBlocks-1),s=0,i=0;s<h.clientHeight;)s=++i*this.parent.getRowHeight();t+=(c-(i-=1))*this.parent.getRowHeight()}if("up"===n.direction)if(this.parent.allowGrouping&&this.parent.groupSettings.columns.length&&!this.isInitialCollapse)t=this.infiniteCache[this.parent.pageSettings.currentPage].length*this.parent.getRowHeight();else if(this.isInitialCollapse){for(e=this.infiniteCache[this.parent.pageSettings.currentPage],o=0,i=0;i<e.length;i++)e[i].isCaptionRow&&o++;t+=Math.round(o/this.parent.groupSettings.columns.length)*this.parent.getRowHeight()}else t+=this.parent.pageSettings.pageSize*this.parent.getRowHeight()+oi();return t},n.prototype.captionRowHeight=function(){return[].slice.call(this.parent.getContent().querySelectorAll("tr:not(.e-row)")).length*this.parent.getRowHeight()},n.prototype.removeTopRows=function(n,t){for(var u=this.parent.getFrozenColumns()?[].slice.call(this.parent.getMovableVirtualContent().querySelectorAll(".e-row")):null,i=0;i<=t;i++)this.parent.frozenRows&&this.parent.pageSettings.currentPage===this.parent.infiniteScrollSettings.maxBlocks+1&&i>t-this.parent.frozenRows||(Object(r.remove)(n[i]),u&&Object(r.remove)(u[i]))},n.prototype.removeBottomRows=function(n,t,i){var u=0,e=this.parent.getFrozenColumns(),s=e?[].slice.call(this.parent.getMovableVirtualContent().querySelectorAll(".e-row")):null,o=this.parent.pageSettings.pageSize,f;for(!e&&this.infiniteCache[i.prevPage].length<o&&(u=this.parent.pageSettings.pageSize-this.infiniteCache[i.prevPage].length),e&&this.infiniteFrozenCache[i.prevPage][1].length<o&&(u=this.parent.pageSettings.pageSize-this.infiniteFrozenCache[i.prevPage][1].length),f=t;u<o;f--)u++,Object(r.remove)(n[f]),s&&Object(r.remove)(s[f])},n.prototype.removeCaptionRows=function(n,t){if("down"===t.direction)for(var o=this.parent.getRows()[this.parent.pageSettings.pageSize],s=parseInt(o.getAttribute("aria-rowindex"),10)-1,u=0,i=0;u<s;i++)n[i].classList.contains("e-row")?u=parseInt(n[i].getAttribute("aria-rowindex"),10):Object(r.remove)(n[i]);if("up"===t.direction){var f=[].slice.call(this.parent.getContent().querySelectorAll(".e-row")),h=parseInt(f[f.length-1].getAttribute("aria-rowindex"),10),c=Math.ceil(h/this.parent.pageSettings.pageSize),e=0;for(i=this.parent.pageSettings.currentPage+1;i<c;i++)e+=this.infiniteCache[i].length;for(i=e;i<n.length;i++)Object(r.remove)(n[i])}},n.prototype.resetInfiniteBlocks=function(n,t){var u=this.parent.enableInfiniteScrolling&&"infiniteScroll"!==n.requestType,i;!this.initialRender&&!Object(r.isNullOrUndefined)(this.parent.infiniteScrollModule)&&u&&(this.actions.some(function(t){return t===n.requestType})||t)&&(i=this.parent.getFrozenColumns()?this.parent.getMovableVirtualContent():this.parent.getContent().firstElementChild,this.initialRender=!0,i.scrollTop=0,this.parent.pageSettings.currentPage=1,this.infiniteCache=this.infiniteFrozenCache={},this.resetContentModuleCache({}),this.isRemove=!1,this.top=0,this.isInitialMovableRender=!0,this.isInitialCollapse=!1,this.parent.contentModule.isRemove=this.isRemove,this.parent.contentModule.isAddRows=this.isRemove,this.parent.contentModule.visibleRows=[],this.parent.contentModule.visibleFrozenRows=[])},n.prototype.setCache=function(n){if(this.parent.enableInfiniteScrolling&&this.parent.infiniteScrollSettings.enableCache){var i=this.parent.getFrozenColumns(),u=n.args.isFrozen?1:0,f="infiniteScroll"!==n.args.requestType&&("delete"===this.requestType||"add"===this.requestType),t=this.parent.pageSettings.currentPage;(i&&this.isInitialMovableRender||!i&&!Object.keys(this.infiniteCache).length||f)&&(this.isInitialMovableRender=!n.args.isFrozen,this.setInitialCache(n.modelData,n.args,f));!i&&Object(r.isNullOrUndefined)(this.infiniteCache[this.parent.pageSettings.currentPage])&&(this.infiniteCache[this.parent.pageSettings.currentPage]=n.modelData,this.resetContentModuleCache(this.infiniteCache));i&&(0===u&&Object(r.isNullOrUndefined)(this.infiniteFrozenCache[t])||!this.infiniteFrozenCache[t][u].length)&&(this.createFrozenCache(t),this.infiniteFrozenCache[t][u]=n.modelData,1===u&&this.resetContentModuleCache(this.infiniteFrozenCache));n.isInfiniteScroll&&!this.isRemove&&(this.isRemove=(t-1)%this.parent.infiniteScrollSettings.maxBlocks==0,this.parent.contentModule.isRemove=this.isRemove)}},n.prototype.setInitialCache=function(n,t,i){for(var f,e,o=this.parent.getFrozenColumns(),s=t.isFrozen?1:0,r=i?this.firstBlock:1,u=1;u<=this.parent.infiniteScrollSettings.initialBlocks;u++)f=(u-1)*this.parent.pageSettings.pageSize,e=u*this.parent.pageSettings.pageSize,this.parent.allowGrouping&&this.parent.groupSettings.columns.length?this.setInitialGroupCache(n,r,f,e):o?(this.createFrozenCache(r),this.infiniteFrozenCache[r][s]=n.slice(f,e),this.resetContentModuleCache(this.infiniteFrozenCache)):(this.infiniteCache[r]=n.slice(f,e),this.resetContentModuleCache(this.infiniteCache)),r++},n.prototype.createFrozenCache=function(n){this.infiniteFrozenCache[n]||(this.infiniteFrozenCache[n]=[[],[]])},n.prototype.setInitialGroupCache=function(n,t,i,r){for(var f,e=[],o=0,u=1;u<=Object.keys(this.infiniteCache).length;u++)o+=this.infiniteCache[u].length;for(f=i,u=o;u<n.length&&f<r&&((n[u].index<r||n[u].isCaptionRow)&&(f=n[u].isCaptionRow?f:n[u].index,e.push(n[u])),!(n[u].index>=r||n[u].index===r-1));u++);this.infiniteCache[t]=e;this.resetContentModuleCache(this.infiniteCache)},n.prototype.resetContentModuleCache=function(n){this.parent.contentModule.infiniteCache=n},n.prototype.destroy=function(){this.removeEventListener()},n}(),yrt=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),ng=function(n){function t(t,i){var r=n.call(this,t,i)||this;return r.childCount=0,r.scrollData=[],r.isFirstChildRow=!1,r.groupCache={},r.startIndexes={},r.captionCounts={},r.rowsByUid={},r.objIdxByUid={},r.initialGroupCaptions={},r.requestType=["paging","columnstate","reorder","cancel","save","beginEdit","add","delete"],r.cacheMode=!1,r.cacheBlockSize=5,r.ignoreAccent=!!r.parent.allowFiltering&&r.parent.filterSettings.ignoreAccent,r.allowCaseSensitive=!1,r.locator=i,r.groupGenerator=new be(r.parent),r.summaryModelGen=new ef(r.parent),r.captionModelGen=new we(r.parent),r.rowRenderer=new dt(r.locator,null,r.parent),r.eventListener(),r}return yrt(t,n),t.prototype.eventListener=function(){this.parent.addEventListener(l,this.actionBegin.bind(this));this.parent.addEventListener(c,this.actionComplete.bind(this));this.parent.on(tt,this.setLazyLoadPageSize,this);this.parent.on(ia,this.setCache,this);this.parent.on(ra,this.scrollHandler,this);this.parent.on(ui,this.setVisible,this);this.parent.on(bs,this.collapseShortcut,this)},t.prototype.captionExpand=function(n){var r=this,f=this.parent.pageSettings.currentPage,t=this.groupCache[f],e=n.getAttribute("data-uid"),i=this.getRowObjectIndexByUid(e),o=!!t[i+1]&&t[i].indent<t[i+1].indent,u=t[i],s=this.getGroupKeysAndFields(i,t),h={captionRowElement:n,groupInfo:u,enableCaching:!0,cancel:!1};this.parent.trigger(up,h,function(t){t.cancel||(t.keys=s.keys,t.fields=s.fields,t.rowIndex=n.rowIndex,t.makeRequest=!t.enableCaching||!o,!t.enableCaching&&o&&r.clearCache([e]),t.skip=0,t.take=r.pageSize,u.isExpand=r.rowsByUid[f][u.uid].isExpand=!0,r.captionRowExpand(t))})},t.prototype.captionCollapse=function(n){var i=this,r=this.groupCache[this.parent.pageSettings.currentPage],u=n.rowIndex,f=n.getAttribute("data-uid"),t=this.getRowObjectIndexByUid(f),e={captionRowElement:n,groupInfo:r[t],cancel:!1};this.parent.trigger(fp,e,function(n){n.cancel||(n.isExpand=!1,i.removeRows(t,u))})},t.prototype.setLazyLoadPageSize=function(){var n=this.parent.getContent().firstElementChild,t=Math.floor(n.offsetHeight/this.parent.getRowHeight())-1;this.pageSize=this.pageSize?this.pageSize:3*t;this.blockSize=Math.ceil(this.pageSize/2)},t.prototype.clearLazyGroupCache=function(){this.clearCache()},t.prototype.clearCache=function(n){var t,e,o,r,u,s,i,f,h,c;if(n=n||this.getInitialCaptionIndexes(),t=this.groupCache[this.parent.pageSettings.currentPage],n.length)for(e=0;e<n.length;e++)if(o=this.getRowObjectIndexByUid(n[e]),r=t[o],r){if(this.captionCounts[this.parent.pageSettings.currentPage][r.uid])for(u=o+1;u<t.length;u++){if(t[u].indent===r.indent||t[u].indent<r.indent){delete this.captionCounts[this.parent.pageSettings.currentPage][r.uid];break}t[u].isCaptionRow&&delete this.captionCounts[this.parent.pageSettings.currentPage][t[u].uid]}if(r.isExpand){if(s=this.parent.getRowElementByUID(r.uid),!s)return;this.parent.groupModule.expandCollapseRows(s.querySelector(".e-recordplusexpand"))}i=this.getNextChilds(o);i.length&&(f=[],i[i.length-1].isCaptionRow&&(f=this.getChildRowsByParentIndex(t.indexOf(i[i.length-1]),!1,!1,null,!0,!0)),h=t.indexOf(i[0]),c=f.length?t.indexOf(f[f.length-1]):t.indexOf(i[i.length-1]),t.splice(h,c-(h-1)),this.refreshCaches())}},t.prototype.refreshCaches=function(){var i=this.parent.pageSettings.currentPage,t=this.groupCache[i],n;for(this.rowsByUid={},this.objIdxByUid={},n=0;n<t.length;n++)this.maintainRows(t[n],n)},t.prototype.getInitialCaptionIndexes=function(){for(var t=this.parent.pageSettings.currentPage,i=[],n=0;n<this.initialGroupCaptions[t].length;n++)i.push(this.initialGroupCaptions[t][n].uid);return i},t.prototype.getRowObjectIndexByUid=function(n){return this.objIdxByUid[this.parent.pageSettings.currentPage][n]},t.prototype.collapseShortcut=function(n){var i,r,u,t;if(this.parent.groupSettings.columns.length&&n.target&&o(n.target,"e-content")&&"TR"===n.target.parentElement.tagName){if(!n.collapse&&o(n.target,"e-row"))return;i=n.target.parentElement.getAttribute("data-uid");n.collapse?(r=this.getRowByUid(i),(t=this.getRowByUid(r.parentUid)).isCaptionRow&&t.isExpand&&(u=this.getRowElementByUid(r.parentUid),this.parent.groupModule.expandCollapseRows(u.cells[r.indent-1]))):(t=this.getRowByUid(i)).isCaptionRow&&!t.isExpand&&(u=this.getRowElementByUid(i),this.parent.groupModule.expandCollapseRows(u.cells[t.indent]))}},t.prototype.getRowByUid=function(n){return this.rowsByUid[this.parent.pageSettings.currentPage][n]},t.prototype.actionBegin=function(n){var u,r,i,t,f,e;if(!n.cancel){if(this.requestType.some(function(t){return t===n.requestType})||(this.groupCache={},this.resetRowMaintenance()),"reorder"===n.requestType&&this.parent.groupSettings.columns.length)for(u=Object.keys(this.groupCache),r=0;r<u.length;r++)for(i=this.groupCache[u[r]],t=0;t<i.length;t++)(i[t].isCaptionRow&&!this.captionModelGen.isEmpty()&&this.changeCaptionRow(i[t],null,u[r]),i[t].isDataRow)&&(f=n.fromIndex+i[t].indent,e=n.toIndex+i[t].indent,this.moveCells(i[t].cells,f,e));("delete"===n.requestType||"add"===n.action&&"save"===n.requestType)&&(this.groupCache={},this.resetRowMaintenance())}},t.prototype.actionComplete=function(n){n.cancel||"columnstate"===n.requestType||"beginEdit"===n.requestType||"delete"===n.requestType||"save"===n.requestType||"reorder"===n.requestType||this.scrollReset()},t.prototype.resetRowMaintenance=function(){this.startIndexes={};this.captionCounts={};this.rowsByUid={};this.objIdxByUid={};this.initialGroupCaptions={}},t.prototype.moveCells=function(n,t,i){if(t>=n.length)for(var r=t-n.length;1+r--;)n.push(void 0);n.splice(t,0,n.splice(i,1)[0])},t.prototype.removeRows=function(n,t){var s,h=this.parent.pageSettings.currentPage,u=this.groupCache[h],f=[].slice.call(this.parent.getContent().querySelectorAll("tr")),e,c,o,i;for(this.parent.aggregates.length&&(e=this.getAggregateByCaptionIndex(n),s=e.length?e[e.length-1].uid:void 0),o=u[n].indent,this.addClass(this.getNextChilds(n)),u[n].isExpand=this.rowsByUid[h][u[n].uid].isExpand=!1,i=n+1;i<u.length;i++){if(u[i].indent===o||u[i].indent<o){c=u[i].uid;break}u[i].isCaptionRow&&u[i].isExpand&&this.addClass(this.getNextChilds(i))}for(i=t+1;i<f.length&&f[i].getAttribute("data-uid")!==c;i++){if(f[i].getAttribute("data-uid")===s){Object(r.remove)(f[i]);break}Object(r.remove)(f[i])}},t.prototype.addClass=function(n){var t=n[this.blockSize];t&&(t.lazyLoadCssClass="e-lazyload-middle-down")},t.prototype.getNextChilds=function(n,t){for(var u=this.groupCache[this.parent.pageSettings.currentPage],r=t||u,f=u[n].indent+1,e=[],i=t?0:n+1;i<r.length&&!(r[i].indent<f);i++)r[i].indent===f&&e.push(r[i]);return e},t.prototype.lazyLoadHandler=function(n){var u,e,s;this.setStartIndexes();var h=this.parent.getContent().querySelectorAll("tr")[n.index].getAttribute("data-uid"),t=this.getRowObjectIndexByUid(h),r=this.groupCache[this.parent.pageSettings.currentPage][t],i=n.isRowExist?n.isScroll?this.scrollData:this.getChildRowsByParentIndex(t,!0,!0,null,!0):[];if(this.scrollData=[],!n.isRowExist)if(this.setRowIndexes(t,r),this.refreshCaptionRowCount(this.groupCache[this.parent.pageSettings.currentPage][t],n.count),-1!==Object.keys(n.data).indexOf("GroupGuid"))for(u=0;u<n.data.length;u++)e=this.groupGenerator.generateCaptionRow(n.data[u],n.level,r.parentGid,void 0,0,r.uid),i.push(e),this.parent.aggregates.length&&(i=i.concat(this.summaryModelGen.generateRows(n.data[u],{level:n.level+1,parentUid:e.uid})));else this.groupGenerator.index=this.getStartIndex(t,n.isScroll),i=this.groupGenerator.generateDataRows(n.data,n.level,r.parentGid,0,r.uid);var c=n.isScroll?this.rowIndex:n.index,f=this.getNextChilds(t,i),o=!!n.up||this.hasLastChildRow(n.isScroll,n.count,f.length);n.isRowExist||o||(f[this.blockSize].lazyLoadCssClass="e-lazyload-middle-down");o||(f[f.length-1].lazyLoadCssClass="e-not-lazyload-end");s=n.isScroll||n.isRowExist?[]:this.getAggregateByCaptionIndex(t);n.up||n.isRowExist||this.refreshRowObjects(i,n.isScroll?this.rowObjectIndex:t);this.render(c,i,o,s);this.isFirstChildRow&&!n.up&&(this.parent.getContent().firstElementChild.scrollTop=i.length*this.parent.getRowHeight());this.isFirstChildRow=!1;this.rowIndex=void 0;this.rowObjectIndex=void 0;this.childCount=0},t.prototype.setRowIndexes=function(n,t){this.captionCounts[this.parent.pageSettings.currentPage]||(this.captionCounts[this.parent.pageSettings.currentPage]={});t.isCaptionRow&&(this.captionCounts[this.parent.pageSettings.currentPage][t.uid]=t.data.count)},t.prototype.getStartIndex=function(n,t){var u=this.parent.pageSettings.currentPage,i=this.groupCache[u],r;if(t)return i[this.rowObjectIndex].index+1;var f=0,e=0,o=this.getRowByUid(i[n].parentUid);if(o&&(e=this.prevCaptionCount(o)),i[n].indent>0)for(r=n-1;r>=0&&!(i[r].indent<i[n].indent);r--)i[r].isCaptionRow&&i[r].indent===i[n].indent&&(f+=i[r].data.count);return f+e+this.startIndexes[u][i[n].parentGid]},t.prototype.prevCaptionCount=function(n){for(var e,u,f=this.parent.pageSettings.currentPage,i=this.groupCache[f],r=0,t=i.indexOf(n)-1;t>=0&&0!==i[t].indent&&!(i[t].indent<n.indent);t--)i[t].isCaptionRow&&i[t].indent===n.indent&&(e=this.captionCounts[f][i[t].uid],r+=e||i[t].data.count);return u=this.getRowByUid(n.parentUid),u&&(r+=this.prevCaptionCount(u)),r},t.prototype.setStartIndexes=function(){var i=this.groupCache[this.parent.pageSettings.currentPage];if(!this.startIndexes[this.parent.pageSettings.currentPage]){for(var n=[],r=void 0,t=0;t<i.length;t++)i[t].isCaptionRow&&(n.length?n.push(i[r].data.count+n[n.length-1]):n.push(0),r=t);this.startIndexes[this.parent.pageSettings.currentPage]=n}},t.prototype.hasLastChildRow=function(n,t,i){return n?t===this.childCount+i:t===i},t.prototype.refreshCaptionRowCount=function(n,t){n.data.count=t},t.prototype.render=function(n,t,i,r){var f=this.parent.getContent().querySelectorAll("tr")[n],u;if(f&&r.length)for(u=r.length-1;u>=0;u--)f.insertAdjacentElement("afterend",this.rowRenderer.render(r[u],this.parent.getColumns()));if(f&&t.length)for(u=t.length-1;u>=0;u--)this.confirmRowRendering(t[u])&&f.insertAdjacentElement("afterend",this.rowRenderer.render(t[u],this.parent.getColumns()))},t.prototype.maintainRows=function(n,t){var i=this.parent.pageSettings.currentPage;this.rowsByUid[i]||(this.rowsByUid[i]={},this.objIdxByUid[i]={});n.uid&&(this.rowsByUid[i][n.uid]=n);this.objIdxByUid[i][n.uid]=t},t.prototype.confirmRowRendering=function(n){var i=!0,t;return!Object(r.isNullOrUndefined)(n.indent)||n.isDataRow||n.isCaptionRow||(t=this.getRowByUid(n.parentUid),t.isCaptionRow&&!t.isExpand&&(i=!1)),i},t.prototype.refreshRowObjects=function(n,t){var s=this.parent.pageSettings.currentPage,f=this.groupCache[s],e;this.rowsByUid[s]={};this.objIdxByUid[s]={};for(var o=[],u=0,i=0;i<f.length;i++)if(i===t)for(this.maintainRows(f[i],u),o.push(f[i]),u++,e=0;e<n.length;e++)this.maintainRows(n[e],u),o.push(n[e]),u++;else this.maintainRows(f[i],u),o.push(f[i]),u++;this.groupCache[this.parent.pageSettings.currentPage]=Object(r.extend)([],o);this.updateCurrentViewData()},t.prototype.getAggregateByCaptionIndex=function(n){for(var t=this.groupCache[this.parent.pageSettings.currentPage],u=t[n],e=u.indent,o=u.uid,f=[],i=n+1;i<t.length&&t[i].indent!==e;i++)Object(r.isNullOrUndefined)(t[i].indent)&&t[i].parentUid===o&&f.push(t[i]);return f},t.prototype.getChildRowsByParentIndex=function(n,t,i,u,f,e){var s=u||this.groupCache[this.parent.pageSettings.currentPage],h=s[n],l=[];if(!h.isCaptionRow||h.isCaptionRow&&!h.isExpand&&!e)return[];f&&this.parent.aggregates.length&&(l=this.getAggregateByCaptionIndex(n));for(var v=h.indent,y=h.uid,c=[],a=0,o=n+1;o<s.length;o++){if(s[o].parentUid===y){if(Object(r.isNullOrUndefined)(s[o].indent))continue;if(a++,c.push(s[o]),t&&s[o].isCaptionRow&&(c=c.concat(this.getChildRowsByParentIndex(o,t,i,u,f))),i&&a===this.pageSize)break}if(s[o].indent===v)break}return c.concat(l)},t.prototype.initialGroupRows=function(n){var i=[],r=this.groupCache[this.parent.pageSettings.currentPage],t;if(n)return this.getRenderedRowsObject();for(t=0;t<r.length;t++)0===r[t].indent&&(i.push(r[t]),i=i.concat(this.getChildRowsByParentIndex(t,!0,!0,r,!0)));return i},t.prototype.getRenderedRowsObject=function(){for(var t=[],i=[].slice.call(this.parent.getContent().querySelectorAll("tr")),n=0;n<i.length;n++)t.push(this.getRowByUid(i[n].getAttribute("data-uid")));return t},t.prototype.getCacheRowsOnDownScroll=function(n){for(var u=[],t=this.groupCache[this.parent.pageSettings.currentPage],i=n,f=0;f<this.pageSize&&t[i]&&!(t[i].indent<t[n].indent);f++)t[i].indent===t[n].indent&&(u.push(t[i]),t[i].isCaptionRow&&t[i].isExpand&&(u=u.concat(this.getChildRowsByParentIndex(i,!0,!0,null,!0)))),(t[i].indent>t[n].indent||Object(r.isNullOrUndefined)(t[i].indent))&&f--,i++;return u},t.prototype.getCacheRowsOnUpScroll=function(n,t,i){for(var f=[],r=this.groupCache[this.parent.pageSettings.currentPage],e=!1,u=0;u<r.length&&(!e||r[u]&&!(r[u].indent<r[i].indent)&&r[u].uid!==t);u++)e||r[u].uid!==n||(e=!0),e&&r[u].indent===r[i].indent&&(f.push(r[u]),r[u].isCaptionRow&&r[u].isExpand&&(f=f.concat(this.getChildRowsByParentIndex(u,!0,!0,null,!0))));return f},t.prototype.scrollHandler=function(n){var i,o,l;if(!this.parent.isDestroyed&&!this.childCount){var t,r,s=[].slice.call(this.parent.getContent().querySelectorAll(".e-lazyload-middle-down")),h=[].slice.call(this.parent.getContent().querySelectorAll(".e-lazyload-middle-up")),u=[].slice.call(this.parent.getContent().querySelectorAll(".e-not-lazyload-end")),e=!1,c=!1,f=!1;if(n.scrollDown&&s.length&&(t=(r=this.findRowElements(s)).tr,e=r.entered),!n.scrollDown&&u)for(i=0;i<u.length;i++)if(o=u[i].getBoundingClientRect().top,l=this.parent.getContent().scrollHeight,o>0&&o<l){t=u[i];f=!0;this.rowIndex=t.rowIndex;break}n.scrollDown||!h.length||f||(t=(r=this.findRowElements(h)).tr,c=r.entered);t&&(e&&n.scrollDown&&e&&t&&this.scrollDownHandler(t),!n.scrollDown&&f&&t&&this.scrollUpEndRowHandler(t),this.cacheMode&&!n.scrollDown&&!f&&c&&t&&this.scrollUpHandler(t))}},t.prototype.scrollUpEndRowHandler=function(n){var v=this.parent.pageSettings.currentPage,i=this.groupCache[v],l=n.getAttribute("data-uid"),t=this.rowObjectIndex=this.getRowObjectIndexByUid(l),y=t,r=i[t],u=this.getRowByUid(r.parentUid),e=this.getRowObjectIndexByUid(u.uid),p=this.parent.getContent().querySelector("tr[data-uid="+u.uid+"]").rowIndex,w=this.getChildRowsByParentIndex(e).indexOf(r),a=Math.ceil(w/this.pageSize),f,o,s,h,c;1!==a&&((this.childCount=a*this.pageSize,t=this.getCurrentBlockEndIndex(r,t),this.childCount<u.data.count)?(n.classList.remove("e-not-lazyload-end"),r.lazyLoadCssClass="",f=!!i[t+1]&&r.indent===i[t+1].indent,this.scrollData=f?this.getCacheRowsOnDownScroll(t+1):[],o=this.getGroupKeysAndFields(e,i),s={rowIndex:p,makeRequest:!f,groupInfo:u,fields:o.fields,keys:o.keys,skip:this.childCount,take:this.pageSize,isScroll:!0},this.cacheMode&&this.childCount>=this.pageSize*this.cacheBlockSize&&(h=this.getChildRowsByParentIndex(e),c=Math.ceil(h.indexOf(i[y])/this.pageSize)-(this.cacheBlockSize-1),this.removeBlock(l,f,c,h),s.cachedRowIndex=c*this.pageSize),this.captionRowExpand(s)):this.childCount=0)},t.prototype.scrollDownHandler=function(n){var b=this.parent.pageSettings.currentPage,i=this.groupCache[b],y=n.getAttribute("data-uid"),t=this.getRowObjectIndexByUid(y),k=t,o=i[t],e=this.getRowByUid(o.parentUid),s=this.getRowObjectIndexByUid(e.uid),d=this.getRowElementByUid(e.uid).rowIndex,p=this.getChildRowsByParentIndex(s),g=p.indexOf(o),w=Math.ceil(g/this.pageSize),u,h,f,c,l,a,v;if(this.childCount=w*this.pageSize,u=i[t=this.rowObjectIndex=this.getRowObjectIndexByUid(p[this.childCount-1].uid)],h=this.getRowElementByUid(u.uid),this.rowIndex=h.rowIndex,t=this.getCurrentBlockEndIndex(u,t),this.childCount<e.data.count){if(f=!!i[t+1]&&o.indent===i[t+1].indent,f&&!Object(r.isNullOrUndefined)(this.getRowElementByUid(i[t+1].uid)))return void(this.childCount=0);(w>1||!this.cacheMode)&&(n.classList.remove("e-lazyload-middle-down"),h.classList.remove("e-not-lazyload-end"),u.lazyLoadCssClass="");this.scrollData=f?this.getCacheRowsOnDownScroll(this.rowObjectIndex+1):[];c=this.getGroupKeysAndFields(s,i);l={rowIndex:d,makeRequest:!f,groupInfo:e,fields:c.fields,keys:c.keys,skip:this.childCount,take:this.pageSize,isScroll:!0};this.cacheMode&&this.childCount-this.pageSize>=this.pageSize*this.cacheBlockSize&&(a=this.getChildRowsByParentIndex(s),v=Math.ceil(a.indexOf(i[k])/this.pageSize)-1-(this.cacheBlockSize-1)+1,this.removeBlock(y,f,v,a,u),l.cachedRowIndex=v*this.pageSize);this.captionRowExpand(l)}else this.childCount=0},t.prototype.getCurrentBlockEndIndex=function(n,t){var o=this.parent.pageSettings.currentPage,i=this.groupCache[o],f,e,u,r;if(n.isCaptionRow)for(n.isExpand&&(f=this.getChildRowsByParentIndex(t,!0).length,this.rowIndex=this.rowIndex+f),e=this.getAggregateByCaptionIndex(t),this.rowObjectIndex=this.rowObjectIndex+e.length,u=t,r=u+1;r<i.length;r++){if(i[r].indent===i[t].indent||i[r].indent<i[t].indent){t=u;break}u++}return t},t.prototype.removeBlock=function(n,t,i,r,u){var s=this.parent.pageSettings.currentPage,h=this.groupCache[s],o=r[(i+1)*this.pageSize-1-this.blockSize].uid,e=r[i*this.pageSize-this.pageSize].uid,f=r[i*this.pageSize].uid;h[this.getRowObjectIndexByUid(o)].lazyLoadCssClass="e-lazyload-middle-up";this.getRowElementByUid(o).classList.add("e-lazyload-middle-up");u&&(this.getRowElementByUid(f).classList.add("e-not-lazyload-first"),this.getRowByUid(f).lazyLoadCssClass="e-not-lazyload-first",this.getRowByUid(e).lazyLoadCssClass="");t?this.removeTopRows(u?u.uid:n,e,f):(this.uid1=e,this.uid2=f,this.uid3=u?u.uid:n)},t.prototype.scrollUpHandler=function(n){var p=this.parent.pageSettings.currentPage,e=this.groupCache[p],w=n.getAttribute("data-uid"),rt=this.getRowByUid(w),b=this.rowObjectIndex=this.getRowObjectIndexByUid(w),t=this.getRowByUid(rt.parentUid),ut=this.rowIndex=this.getRowObjectIndexByUid(t.uid),ft=this.parent.getRowElementByUID(t.uid).rowIndex,i=this.getChildRowsByParentIndex(ut),h=i.indexOf(e[b]),k=Math.floor(h/this.pageSize),u=this.blockSize,c,o,f,v,y,it;if(2*this.blockSize>this.pageSize&&(u=2*this.blockSize-this.pageSize,u=this.blockSize-u),c=i[h-(u-1)-this.pageSize].uid,o=i[h-(u-1)].uid,this.scrollData=this.getCacheRowsOnUpScroll(c,o,b-(u-1)),this.isFirstChildRow=k>1,this.isFirstChildRow&&(this.scrollData[0].lazyLoadCssClass="e-not-lazyload-first"),this.getRowByUid(o).lazyLoadCssClass="",this.getRowElementByUid(o).classList.remove("e-not-lazyload-first"),f=k+this.cacheBlockSize,i.length!==t.data.count&&f*this.pageSize>i.length)return this.isFirstChildRow=!1,this.scrollData[0].lazyLoadCssClass="",void this.getRowElementByUid(o).classList.add("e-not-lazyload-first");var s=f*this.pageSize>t.data.count?t.data.count:f*this.pageSize,d=f*this.pageSize>t.data.count?this.pageSize-(this.pageSize*f-t.data.count):this.pageSize,l=this.getChildRowsByParentIndex(e.indexOf(i[s-1]),!0,!1,null,!0),g=l.length?l[l.length-1].uid:i[s-1].uid,nt=i[s-d].uid,a=i[s-d-1].uid,tt=this.objIdxByUid[p][nt]-u;if("e-lazyload-middle-down"===e[tt].lazyLoadCssClass&&(v=this.getRowElementByUid(e[tt].uid),v&&v.classList.add("e-lazyload-middle-down")),this.getRowByUid(g).lazyLoadCssClass="",this.getRowByUid(a).lazyLoadCssClass="e-not-lazyload-end",this.getRowElementByUid(a).classList.add("e-not-lazyload-end"),this.removeBottomRows(g,nt,a),this.rowIndex=n.rowIndex-u,n.classList.length>1?n.classList.remove("e-lazyload-middle-up"):n.removeAttribute("class"),!Object(r.isNullOrUndefined)(this.getRowElementByUid(c)))return this.childCount=0,void(this.scrollData=[]);y=this.getGroupKeysAndFields(this.getRowObjectIndexByUid(t.uid),e);it={rowIndex:ft,makeRequest:!1,groupInfo:t,fields:y.fields,keys:y.keys,skip:this.childCount,take:this.pageSize,isScroll:!0,scrollUp:!0};this.captionRowExpand(it)},t.prototype.findRowElements=function(n){for(var u,r,i=!1,t=0;t<n.length;t++)if(r=n[t].rowIndex,hk(r,this.parent)){i=!0;this.rowIndex=r;u=n[t];break}return{entered:i,tr:u}},t.prototype.getRowElementByUid=function(n){return this.parent.getContent().querySelector("tr[data-uid="+n+"]")},t.prototype.removeTopRows=function(n,t,i){for(var e,f=[].slice.call(this.parent.getContent().querySelectorAll("tr")),o=(this.parent.pageSettings.currentPage,!1),u=0;u<f.length;u++){if(f[u].getAttribute("data-uid")===i){e=this.parent.getContent().querySelector("tr[data-uid="+n+"]");e&&(this.rowIndex=e.rowIndex);break}f[u].getAttribute("data-uid")===t&&(o=!0);o&&Object(r.remove)(f[u])}},t.prototype.removeBottomRows=function(n,t){for(var u=[].slice.call(this.parent.getContent().querySelectorAll("tr")),f=!1,i=0;i<u.length&&(u[i].getAttribute("data-uid")===t&&(f=!0),!f||(Object(r.remove)(u[i]),u[i].getAttribute("data-uid")!==n));i++);},t.prototype.setCache=function(n){var t=this.parent.pageSettings.currentPage;this.groupCache[t]=this.initialGroupCaptions[t]=Object(r.extend)([],n.data)},t.prototype.getGroupKeysAndFields=function(n,t){for(var r=[],u=[],i=n;i>=0&&(!t[i].isCaptionRow||-1!==r.indexOf(t[i].data.field)||!(t[i].indent<t[n].indent||i===n)||(r.push(t[i].data.field),u.push(t[i].data.key),0!==t[i].indent));i--);return{fields:r,keys:u}},t.prototype.generateExpandPredicates=function(n,t){for(var u=[],i=0;i<n.length;i++){var e=this.parent.getColumnByField(n[i]),f="null"===t[i]?null:t[i],o={field:n[i],predicate:"or",uid:e.uid,operator:"equal",type:e.type,matchCase:this.allowCaseSensitive,ignoreAccent:this.ignoreAccent};""===f||Object(r.isNullOrUndefined)(f)?u=u.concat(au.generateNullValuePredicates(o)):u.push(Object(r.extend)({},{value:f},o))}return au.getPredicate(u)},t.prototype.getPredicates=function(n){for(var u,i=[],t=0,r=Object.keys(n);t<r.length;t++)u=r[t],i.push(n[u]);return i},t.prototype.captionRowExpand=function(n){var t=this,u=n.groupInfo,r=this.parent.groupSettings.columns.indexOf(u.data.field)+1,f=this.generateExpandPredicates(n.fields,n.keys),e=this.getPredicates(f),o={level:r,skip:n.skip,take:n.take,where:e},i;n.makeRequest?(i=this.parent.renderModule.data.generateQuery(!0),i.isCountRequired||(i.isCountRequired=!0),i.lazyLoad.push({key:"onDemandGroupInfo",value:o}),this.parent.showSpinner(),this.parent.renderModule.data.getData({},i).then(function(i){t.parent.hideSpinner();0!==i.result.length&&(t.cacheMode&&t.uid1&&t.uid2&&(t.removeTopRows(t.uid3,t.uid1,t.uid2),t.uid1=t.uid2=t.uid3=void 0),t.lazyLoadHandler({data:i.result,count:i.count,level:r,index:n.rowIndex,isRowExist:!1,isScroll:n.isScroll,up:!1,rowIndex:n.cachedRowIndex}))}).catch(function(n){return t.parent.renderModule.dataManagerFailure(n,{requestType:"grouping"})})):this.lazyLoadHandler({data:null,count:n.groupInfo.data.count,level:r,index:n.rowIndex,isRowExist:!0,isScroll:n.isScroll,up:n.scrollUp,rowIndex:n.cachedRowIndex})},t.prototype.scrollReset=function(n){this.parent.getContent().firstElementChild.scrollTop=n?this.parent.getContent().firstElementChild.scrollTop+n:0},t.prototype.updateCurrentViewData=function(){var n=[];this.getRows().filter(function(t){t.isDataRow&&(n[t.index]=t.data)});this.parent.currentViewData=n.length?n:this.parent.currentViewData},t.prototype.getGroupCache=function(){return this.groupCache},t.prototype.getRows=function(){return this.groupCache[this.parent.pageSettings.currentPage]||[]},t.prototype.getRowElements=function(){return[].slice.call(this.parent.getContent().querySelectorAll(".e-row"))},t.prototype.getRowByIndex=function(n){for(var u,i=[].slice.call(this.parent.getContent().querySelectorAll(".e-row")),t=0;!Object(r.isNullOrUndefined)(n)&&t<i.length;t++)if(i[t].getAttribute("aria-rowindex")===n.toString()){u=i[t];break}return u},t.prototype.setVisible=function(n){var f,s=this.parent,e,i;for(this.getRows().some(function(n){return n.isDataRow&&(f=n),n.isDataRow}),e=this.getRows().filter(function(n){return!n.isDetailRow}),i=0;i<n.length;i++){var t=n[i],u=this.parent.getNormalizedColumnIndex(t.uid),h=this.parent.getColumnIndexByUid(t.uid),o=!0===t.visible?"":"none";-1!==u&&f&&u<f.cells.length&&Object(r.setStyleAttribute)(this.getColGroup().childNodes[u],{display:o});this.setDisplayNone(s.getDataRows(),h,o,e,u);!this.parent.invokedFromMedia&&t.hideAtMedia&&this.parent.updateMediaColumns(t);this.parent.invokedFromMedia=!1}},t.prototype.setDisplayNone=function(n,t,i,u,f){var s=Object.keys(n),l,c,v,a,h,e,o,y;if(this.parent.groupSettings.columns.length)for(l=Object.keys(this.groupCache),c=0;c<l.length;c++)for(v=this.rowsByUid[l[c]],a=Object.keys(v),o=0;o<a.length;o++)h=this.parent.getContent().querySelector("tr[data-uid="+a[o]+"]"),e=v[a[o]],e.isCaptionRow&&(this.captionModelGen.isEmpty()?(e.cells[e.indent+1].colSpan=""===i?e.cells[e.indent+1].colSpan+1:e.cells[e.indent+1].colSpan-1,h&&(h.cells[e.indent+1].colSpan=e.cells[e.indent+1].colSpan)):this.changeCaptionRow(e,h,l[c])),e.isDataRow&&(this.showAndHideCells(h,t,i,!1),e.cells[f].visible=""===i),e.isCaptionRow||e.isDataRow||!Object(r.isNullOrUndefined)(e.indent)||(e.cells[f].visible=""===i,e.visible=e.cells.some(function(n){return n.isDataCell&&n.visible}),this.showAndHideCells(h,t,i,!0,e));else for(o=0;o<s.length;o++)y=n[s[o]].querySelectorAll("td.e-rowcell")[t],n[s[o]].querySelectorAll("td.e-rowcell").length&&y&&(Object(r.setStyleAttribute)(n[s[o]].querySelectorAll("td.e-rowcell")[t],{display:i}),n[s[o]].querySelectorAll("td.e-rowcell")[t].classList.contains("e-hide")&&Object(r.removeClass)([n[s[o]].querySelectorAll("td.e-rowcell")[t]],["e-hide"]),u[s[o]].cells[t].visible=""===i)},t.prototype.changeCaptionRow=function(n,t,i){var u=n,f=n.data,r=this.groupGenerator.generateCaptionRow(f,u.indent,u.parentGid,void 0,u.tIndex,u.parentUid);(r.uid=n.uid,r.isExpand=n.isExpand,r.lazyLoadCssClass=n.lazyLoadCssClass,this.rowsByUid[i][n.uid]=r,this.groupCache[i][this.objIdxByUid[i][n.uid]]=r,t)&&this.parent.getContentTable().querySelector("tbody").replaceChild(this.rowRenderer.render(r,this.parent.getColumns()),t)},t.prototype.showAndHideCells=function(n,t,i,u,f){if(n){var e=u?"td.e-summarycell":"td.e-rowcell";Object(r.setStyleAttribute)(n.querySelectorAll(e)[t],{display:i});n.querySelectorAll(e)[t].classList.contains("e-hide")&&Object(r.removeClass)([n.querySelectorAll(e)[t]],["e-hide"]);u&&(f.visible&&n.classList.contains("e-hide")?Object(r.removeClass)([n],["e-hide"]):f.visible||Object(r.addClass)([n],["e-hide"]))}},t}(of),prt=function(){function n(n,t){this.parent=n;this.serviceLocator=t;this.addEventListener()}return n.prototype.getModuleName=function(){return"lazyLoadGroup"},n.prototype.addEventListener=function(){this.parent.isDestroyed||this.parent.on(ii,this.instantiateRenderer,this)},n.prototype.removeEventListener=function(){this.parent.isDestroyed||this.parent.off(ii,this.instantiateRenderer)},n.prototype.instantiateRenderer=function(){"auto"===this.parent.height&&(this.parent.height=this.parent.pageSettings.pageSize*this.parent.getRowHeight());var n=this.serviceLocator.getService("rendererFactory");this.parent.groupSettings.enableLazyLoading&&n.addRenderer(ut.Content,new ng(this.parent,this.serviceLocator))},n.prototype.destroy=function(){this.removeEventListener()},n}(),wrt=function(){function n(n){this.parentObj=n}return n.prototype.create=function(n){var t=b(n.column.field);return this.parentObj.createElement("input",{className:"e-field",attrs:{id:this.parentObj.element.id+t,name:t,type:"text","e-mappinguid":n.column.uid}})},n.prototype.write=function(n){this.column=n.column;var t="Dialog"!==this.parentObj.editSettings.mode;this.object=new li.AutoComplete(Object(r.extend)({dataSource:this.parentObj.dataSource instanceof e.DataManager?this.parentObj.dataSource:new e.DataManager(this.parentObj.dataSource),query:(new e.Query).select(n.column.field),enabled:ci(n.column,n.requestType,n.element),fields:{value:n.column.field},value:k(n.column.field,n.rowData),actionComplete:this.selectedValues.bind(this),placeholder:t?"":n.column.headerText,floatLabelType:t?"Never":"Always"},n.column.edit.params));Object(r.isBlazor)()&&(this.object.locale=this.parentObj.locale);this.object.appendTo(n.element);n.element.setAttribute("name",b(n.column.field))},n.prototype.read=function(n){return n.ej2_instances[0].value},n.prototype.selectedValues=function(n){n.result=e.DataUtil.distinct(n.result,this.object.fields.value,!0);this.column.dataSource&&(this.column.dataSource.dataSource.json=n.result)},n.prototype.destroy=function(){this.object&&this.object.destroy()},n}(),brt=function(){function n(n){this.parent=n}return n.prototype.create=function(n){var t=b(n.column.field);return this.parent.createElement("input",{className:"e-field",attrs:{id:this.parent.element.id+t,name:t,type:"text","e-mappinguid":n.column.uid}})},n.prototype.write=function(n){this.column=n.column;var t="Dialog"!==this.parent.editSettings.mode;this.obj=new li.ComboBox(Object(r.extend)({dataSource:this.parent.dataSource instanceof e.DataManager?this.parent.dataSource:new e.DataManager(this.parent.dataSource),query:(new e.Query).select(n.column.field),fields:{value:n.column.field},value:k(n.column.field,n.rowData),enableRtl:this.parent.enableRtl,actionComplete:this.finalValue.bind(this),placeholder:t?"":n.column.headerText,floatLabelType:t?"Never":"Always",enabled:ci(n.column,n.requestType,n.element)},n.column.edit.params));this.obj.appendTo(n.element)},n.prototype.read=function(n){return n.ej2_instances[0].value},n.prototype.finalValue=function(n){n.result=e.DataUtil.distinct(n.result,this.obj.fields.value,!0);this.column.dataSource&&(this.column.dataSource.dataSource.json=n.result)},n.prototype.destroy=function(){this.obj&&this.obj.destroy()},n}(),krt=function(){function n(n){this.parent=n}return n.prototype.create=function(n){var t=b(n.column.field);return this.parent.createElement("input",{className:"e-field",attrs:{id:this.parent.element.id+t,name:t,type:"text","e-mappinguid":n.column.uid}})},n.prototype.read=function(n){return n.ej2_instances[0].value},n.prototype.write=function(n){this.column=n.column;var t="Dialog"!==this.parent.editSettings.mode;this.obj=new li.MultiSelect(Object(r.extend)({fields:{text:n.column.field,value:n.column.field},value:Object(r.getValue)(n.column.field,n.rowData),enableRtl:this.parent.enableRtl,placeholder:t?"":n.column.headerText,popupHeight:"200px",floatLabelType:t?"Never":"Always"},n.column.edit.params));this.obj.appendTo(n.element);n.element.setAttribute("name",b(n.column.field))},n.prototype.destroy=function(){this.obj&&this.obj.destroy()},n}(),drt=function(){function n(n){this.parent=n}return n.prototype.create=function(n){var t=b(n.column.field);return this.parent.createElement("input",{className:"e-field",attrs:{id:this.parent.element.id+t,name:t,type:"text","e-mappinguid":n.column.uid}})},n.prototype.read=function(n){return n.ej2_instances[0].value},n.prototype.write=function(n){var i="Dialog"!==this.parent.editSettings.mode,t=k(n.column.field,n.rowData);t=t?new Date(t):null;this.obj=new vu.TimePicker(Object(r.extend)({floatLabelType:i?"Never":"Always",value:t,placeholder:i?"":n.column.headerText,enableRtl:this.parent.enableRtl,enabled:ci(n.column,n.requestType,n.element)},n.column.edit.params));this.obj.appendTo(n.element)},n.prototype.destroy=function(){this.obj&&this.obj.destroy()},n}(),grt=function(){function n(n){this.activeClasses=["e-selectionbackground","e-active"];this.parent=n}return n.prototype.create=function(n){var i=n.column,r="e-field e-boolcell",t;return"checkbox"===i.type&&(r="e-field e-boolcell e-edit-checkselect"),t=b(n.column.field),this.parent.createElement("input",{className:r,attrs:{type:"checkbox",value:n.value,"e-mappinguid":i.uid,id:this.parent.element.id+t,name:t}})},n.prototype.read=function(n){return n.checked},n.prototype.write=function(n){var u,t,i;(Object(r.isNullOrUndefined)(n.row)||(u=n.row.querySelector(".e-edit-checkselect")),k(n.column.field,n.rowData)&&(t=JSON.parse(k(n.column.field,n.rowData).toString().toLowerCase())),Object(r.isNullOrUndefined)(u))||((this.editType=this.parent.editSettings.mode,this.editRow=n.row,"add"!==n.requestType)&&(i=this.parent.getRowObjectFromUID(n.row.getAttribute("data-uid")),t=!!i&&i.isSelected),yt.apply(void 0,[[].slice.call(n.row.querySelectorAll(".e-rowcell")),t].concat(this.activeClasses)));this.obj=new gt.Switch(Object(r.extend)({label:"Dialog"!==this.parent.editSettings.mode?" ":n.column.headerText,checked:t,disabled:!ci(n.column,n.requestType,n.element),enableRtl:this.parent.enableRtl,change:this.switchModeChange.bind(this)},n.column.edit.params));this.obj.appendTo(n.element)},n.prototype.switchModeChange=function(n){if(this.editRow&&"Dialog"!==this.editType){var t=!1;n.checked?(t=!0,this.editRow.setAttribute("aria-selected",t.toString())):this.editRow.removeAttribute("aria-selected");yt.apply(void 0,[[].slice.call(this.editRow.querySelectorAll(".e-rowcell")),t].concat(this.activeClasses))}},n.prototype.destroy=function(){this.obj&&this.obj.destroy()},n}(),nut=function(){function n(n){this.parent=n}return n.prototype.create=function(n){var t=b(n.column.field);return this.parent.createElement("input",{className:"e-field",attrs:{id:this.parent.element.id+t,name:t,type:"text","e-mappinguid":n.column.uid}})},n.prototype.write=function(n){this.column=n.column;var t="Dialog"!==this.parent.editSettings.mode;this.obj=new rr.MaskedTextBox(Object(r.extend)({fields:{value:n.column.field},value:k(n.column.field,n.rowData),floatLabelType:t?"Never":"Always",mask:"000-000-0000",enabled:ci(n.column,n.requestType,n.element)},n.column.edit.params));this.obj.appendTo(n.element)},n.prototype.read=function(n){return n.ej2_instances[0].value},n.prototype.destroy=function(){this.obj&&this.obj.destroy()},n}(),ty={};Object(gh.copy)(ty,u);tg={grids:ty=Object(gh.copy)(window.ejs?window.ejs.grids:{},ty)};window.ejs=Object(gh.copy)(window.ejs||{},tg);window.ejdashboard=window.ejs}]);!function(n){function t(r){if(i[r])return i[r].exports;var u=i[r]={i:r,l:!1,exports:{}};return n[r].call(u.exports,u,u.exports,t),u.l=!0,u.exports}var i={};t.m=n;t.c=i;t.d=function(n,i,r){t.o(n,i)||Object.defineProperty(n,i,{enumerable:!0,get:r})};t.r=function(n){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"});Object.defineProperty(n,"__esModule",{value:!0})};t.t=function(n,i){var r,u;if((1&i&&(n=t(n)),8&i)||4&i&&"object"==typeof n&&n&&n.__esModule)return n;if(r=Object.create(null),t.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:n}),2&i&&"string"!=typeof n)for(u in n)t.d(r,u,function(t){return n[t]}.bind(null,u));return r};t.n=function(n){var i=n&&n.__esModule?function(){return n.default}:function(){return n};return t.d(i,"a",i),i};t.o=function(n,t){return Object.prototype.hasOwnProperty.call(n,t)};t.p="";t(t.s=14)}([function(n){n.exports=ejs.base},function(n){n.exports=ejs.pdfexport},function(n){n.exports=ejs.dropdowns},function(n){n.exports=ejs.grids},function(n){n.exports=ejs.popups},function(n){n.exports=ejs.charts},function(n){n.exports=ejs.inputs},function(n){n.exports=ejs.buttons},function(n){n.exports=ejs.navigations},function(n){n.exports=ejs.data},function(n){n.exports=ejs.calendars},function(n,t){t.copy=function(n,t,i,r){var u=n||{},e=arguments.length;r&&(e-=1);for(var s=function(n){if(!o[n])return"continue";var t=o[n];Object.keys(t).forEach(function(n){var f,e=u[n],i=t[n];r&&(isObject(i)||Array.isArray(i))?isObject(i)?(f=e||{},u[n]=i({},f,i,r)):(f=e||[],u[n]=i([],f,i,r)):u[n]=i})},o=arguments,f=1;f<e;f++)s(f);return u}},function(n){n.exports=ejs.splitbuttons},function(n){n.exports=ejs.excelexport},function(n,t,i){"use strict";var fi,or;i.r(t);var ei,ht,hi=i(11),r=i(0),tt=i(9),e=function(){function n(){}return n.getType=function(n){return n&&n.getDay?n.getHours()>0||n.getMinutes()>0||n.getSeconds()>0||n.getMilliseconds()>0?"datetime":"date":typeof n},n.resetTime=function(n){return n.setHours(0,0,0,0),n},n.getClonedData=function(n){var f=[],t,r;if(n)for(t=0,r=n;t<r.length;t++){for(var e=r[t],u=Object.keys(e),i=0,o={};i<u.length;)o[u[i]]=e[u[i]],i++;f.push(o)}return f},n.getClonedPivotValues=function(n){for(var i,r=[],t=0;t<n.length;t++)if(n[t])for(r[t]=[],i=0;i<n[t].length;i++)n[t][i]&&(r[t][i]=this.getClonedPivotValueObj(n[t][i]));return r},n.getClonedPivotValueObj=function(n){var t=0,r={},i;if(null!=n)for(i=Object.keys(n);t<i.length;)r[i[t]]=n[i[t]],t++;else r=n;return r},n.getDefinedObj=function(n){var t=0,r={},i;if(null!=n)for(i=Object.keys(n);t<i.length;)null!==n[i[t]]&&void 0!==n[i[t]]&&(r[i[t]]=n[i[t]]),t++;else r=n;return r},n.inArray=function(n,t){if(t)for(var i=0,r=t.length;i<r;i++)if(t[i]===n)return i;return-1},n.isContainCommonElements=function(n,t){for(var r,f,i=0,u=n.length;i<u;i++)for(r=0,f=t.length;r<f;r++)if(t[r]===n[i])return!0;return!1},n.setPivotProperties=function(n,t){n.allowServerDataBinding=!1;n.pivotGridModule&&(n.pivotGridModule.allowServerDataBinding=!1);n.setProperties(t,!0);n.allowServerDataBinding=!0;n.pivotGridModule&&(n.pivotGridModule.allowServerDataBinding=!0)},n.getClonedDataSourceSettings=function(n){return this.getDefinedObj({catalog:n.catalog,cube:n.cube,providerType:n.providerType,url:n.url,localeIdentifier:n.localeIdentifier,excludeFields:Object(r.isNullOrUndefined)(n.excludeFields)?[]:n.excludeFields.slice(),expandAll:n.expandAll,allowLabelFilter:n.allowLabelFilter,allowValueFilter:n.allowValueFilter,allowMemberFilter:n.allowMemberFilter,enableSorting:!!n.enableSorting,rows:this.cloneFieldSettings(n.rows),columns:this.cloneFieldSettings(n.columns),filters:this.cloneFieldSettings(n.filters),values:this.cloneFieldSettings(n.values),filterSettings:this.cloneFilterSettings(n.filterSettings),sortSettings:this.cloneSortSettings(n.sortSettings),drilledMembers:this.cloneDrillMemberSettings(n.drilledMembers),valueSortSettings:this.CloneValueSortObject(n.valueSortSettings),valueAxis:n.valueAxis,formatSettings:this.cloneFormatSettings(n.formatSettings),calculatedFieldSettings:this.cloneCalculatedFieldSettings(n.calculatedFieldSettings),showSubTotals:n.showSubTotals,showRowSubTotals:n.showRowSubTotals,showColumnSubTotals:n.showColumnSubTotals,showGrandTotals:n.showGrandTotals,showRowGrandTotals:n.showRowGrandTotals,showColumnGrandTotals:n.showColumnGrandTotals,showHeaderWhenEmpty:n.showHeaderWhenEmpty,alwaysShowValueHeader:n.alwaysShowValueHeader,conditionalFormatSettings:this.cloneConditionalFormattingSettings(n.conditionalFormatSettings),emptyCellsTextContent:n.emptyCellsTextContent,groupSettings:this.cloneGroupSettings(n.groupSettings)})},n.updateDataSourceSettings=function(n,t){n&&this.setPivotProperties(n,{dataSourceSettings:this.getDefinedObj({catalog:t.catalog,cube:t.cube,providerType:t.providerType,url:t.url,localeIdentifier:t.localeIdentifier,excludeFields:Object(r.isNullOrUndefined)(t.excludeFields)?[]:t.excludeFields,expandAll:t.expandAll,allowLabelFilter:t.allowLabelFilter,allowValueFilter:t.allowValueFilter,allowMemberFilter:t.allowMemberFilter,enableSorting:!!t.enableSorting,rows:t.rows,columns:t.columns,filters:t.filters,values:t.values,filterSettings:t.filterSettings,sortSettings:t.sortSettings,drilledMembers:t.drilledMembers,valueSortSettings:t.valueSortSettings,valueAxis:t.valueAxis,formatSettings:t.formatSettings,calculatedFieldSettings:t.calculatedFieldSettings,showSubTotals:t.showSubTotals,showRowSubTotals:t.showRowSubTotals,showColumnSubTotals:t.showColumnSubTotals,showGrandTotals:t.showGrandTotals,showRowGrandTotals:t.showRowGrandTotals,showColumnGrandTotals:t.showColumnGrandTotals,showHeaderWhenEmpty:t.showHeaderWhenEmpty,alwaysShowValueHeader:t.alwaysShowValueHeader,conditionalFormatSettings:t.conditionalFormatSettings,emptyCellsTextContent:t.emptyCellsTextContent,groupSettings:t.groupSettings})})},n.cloneFieldSettings=function(n){var t;if(n){for(var r=[],i=0,u=n;i<u.length;i++)t=u[i],r.push(this.getDefinedObj({name:t.name,caption:t.caption,axis:t.axis,baseField:t.baseField,baseItem:t.baseItem,isCalculatedField:t.isCalculatedField,isNamedSet:t.isNamedSet,showNoDataItems:t.showNoDataItems,showSubTotals:t.showSubTotals,type:t.type,showFilterIcon:t.showFilterIcon,showSortIcon:t.showSortIcon,showRemoveIcon:t.showRemoveIcon,showValueTypeIcon:t.showValueTypeIcon,showEditIcon:t.showEditIcon,allowDragAndDrop:t.allowDragAndDrop}));return r}return n},n.cloneFilterSettings=function(n){var t;if(n){for(var r=[],i=0,u=n;i<u.length;i++)t=u[i],r.push(this.getDefinedObj({name:t.name,type:t.type,condition:t.condition,items:t.items?t.items.slice():t.items,levelCount:t.levelCount,measure:t.measure,selectedField:t.selectedField,showDateFilter:t.showDateFilter,showLabelFilter:t.showLabelFilter,showNumberFilter:t.showNumberFilter,value1:t.value1,value2:t.value2}));return r}return n},n.cloneSortSettings=function(n){var i;if(n){for(var r=[],t=0,u=n;t<u.length;t++)i=u[t],r.push(this.getDefinedObj({name:i.name,order:i.order}));return r}return n},n.cloneDrillMemberSettings=function(n){var t;if(n){for(var r=[],i=0,u=n;i<u.length;i++)t=u[i],r.push(this.getDefinedObj({name:t.name,delimiter:t.delimiter,items:t.items?t.items.slice():t.items}));return r}return n},n.cloneFormatSettings=function(n){var t;if(n){for(var r=[],i=0,u=n;i<u.length;i++)t=u[i],r.push(this.getDefinedObj({name:t.name,calendar:t.calendar,currency:t.currency,format:t.format,maximumFractionDigits:t.maximumFractionDigits,maximumSignificantDigits:t.maximumSignificantDigits,minimumFractionDigits:t.minimumFractionDigits,minimumIntegerDigits:t.minimumIntegerDigits,minimumSignificantDigits:t.minimumSignificantDigits,skeleton:t.skeleton,type:t.type,useGrouping:t.useGrouping}));return r}return n},n.CloneValueSortObject=function(n){return n?{columnIndex:n.columnIndex,headerDelimiter:n.headerDelimiter,headerText:n.headerText,measure:n.measure,sortOrder:n.sortOrder}:n},n.cloneCalculatedFieldSettings=function(n){var t;if(n){for(var r=[],i=0,u=n;i<u.length;i++)t=u[i],r.push(this.getDefinedObj({name:t.name,formatString:t.formatString,formula:t.formula,hierarchyUniqueName:t.hierarchyUniqueName}));return r}return n},n.cloneConditionalFormattingSettings=function(n){var t;if(n){for(var r=[],i=0,u=n;i<u.length;i++)t=u[i],r.push(this.getDefinedObj({applyGrandTotals:t.applyGrandTotals,conditions:t.conditions,label:t.label,measure:t.measure,style:t.style?{backgroundColor:t.style.backgroundColor,color:t.style.color,fontFamily:t.style.fontFamily,fontSize:t.style.fontSize}:t.style,value1:t.value1,value2:t.value2}));return r}return n},n.cloneGroupSettings=function(n){var t;if(n){for(var r=[],i=0,u=n;i<u.length;i++)t=u[i],r.push(this.getDefinedObj({name:t.name,caption:t.caption,customGroups:this.cloneCustomGroups(t.customGroups),endingAt:t.endingAt,startingAt:t.startingAt,groupInterval:t.groupInterval,rangeInterval:t.rangeInterval,type:t.type}));return r}return n},n.cloneCustomGroups=function(n){var t;if(n){for(var r=[],i=0,u=n;i<u.length;i++)t=u[i],r.push(this.getDefinedObj({groupName:t.groupName,items:t.items?t.items.slice():t.items}));return r}return n},n.getFilterItemByName=function(n,t){var i=new tt.DataManager({json:t}).executeLocal((new tt.Query).where("name","equal",n));if(i&&i.length>0)return i[i.length-1]},n.getFieldByName=function(n,t){return new tt.DataManager({json:t}).executeLocal((new tt.Query).where("name","equal",n))[0]},n.getFieldInfo=function(n,t){for(var u,e,i,f=[this.cloneFieldSettings(t.dataSourceSettings.rows),this.cloneFieldSettings(t.dataSourceSettings.columns),this.cloneFieldSettings(t.dataSourceSettings.values),this.cloneFieldSettings(t.dataSourceSettings.filters)],r=0,o=f.length;r<o;r++)for(u=0,e=f[r]?f[r].length:0;u<e;u++)if(f[r][u]&&f[r][u].name===n)return{fieldName:n,fieldItem:f[r][u],axis:0===r?"rows":1===r?"columns":2===r?"values":"filters",position:u};return i="olap"===t.dataType?t.olapEngineModule.fieldList[n]:t.engineModule.fieldList[n],{fieldName:n,fieldItem:i?{name:n,caption:i.caption,baseField:i.baseField,baseItem:i.baseItem,isCalculatedField:i.isCalculatedField,isNamedSet:i.isNamedSets,showNoDataItems:i.showNoDataItems,showSubTotals:i.showSubTotals,type:i.aggregateType,showFilterIcon:i.showFilterIcon,showSortIcon:i.showSortIcon,showRemoveIcon:i.showRemoveIcon,showValueTypeIcon:i.showValueTypeIcon,showEditIcon:i.showEditIcon,allowDragAndDrop:i.allowDragAndDrop}:void 0,axis:"fieldlist",position:-1}},n.isButtonIconRefesh=function(n,t,i){var c=!1,a,r,v,f,y,o,h;try{if("dataSourceSettings"===n&&t.dataSourceSettings&&i.dataSourceSettings){var e=["notAvail","notAvail","notAvail","notAvail"],l=Object.keys(t.dataSourceSettings),u=Object.keys(i.dataSourceSettings);if(l&&u&&u.length>0&&l.length===u.length)for(a=["rows","columns","values","filters"],r=0;r<u.length;r++){if(v=Object.keys(t.dataSourceSettings[u[r]]),f=Object.keys(i.dataSourceSettings[u[r]]),-1!==a.indexOf(u[r])&&-1!==a.indexOf(l[r])&&v&&f&&f.length>0&&v.length===f.length)for(y=["showFilterIcon","showSortIcon","showRemoveIcon","showValueTypeIcon","showEditIcon","allowDragAndDrop"],o=0;o<f.length;o++){for(var nt=Object.keys(t.dataSourceSettings[u[r]][f[o]]),k=Object.keys(i.dataSourceSettings[u[r]][f[o]]),s=0;s<k.length;s++){if(-1===y.indexOf(k[s])||-1===y.indexOf(nt[s])){e[r]="break";break}e[r]="update"}if("break"===e[r])break}else e[r]="break";if("break"===e[r])break}for(var p=0,w=0,d=0,b=0,g=e;b<g.length;b++)h=g[b],"break"===h&&p++,"notAvail"===h&&w++,"update"===h&&d++;c=!(p>0||4===w)&&0===p&&w<4&&d>0}}catch(n){c=!1}return c},n}(),ci=function(){return(ci=Object.assign||function(n){for(var r,i,t=1,u=arguments.length;t<u;t++)for(i in r=arguments[t])Object.prototype.hasOwnProperty.call(r,i)&&(n[i]=r[i]);return n}).apply(this,arguments)},li=function(){function n(){this.aggregatedValueMatrix=[];this.valueContent=[];this.formatFields={};this.dateFormatFunction={};this.calculatedFields={};this.calculatedFormulas={};this.valueAxis=0;this.saveDataHeaders={};this.columnCount=0;this.rowCount=0;this.colFirstLvl=0;this.rowFirstLvl=0;this.rowStartPos=0;this.colStartPos=0;this.enableValueSorting=!1;this.headerCollection={rowHeaders:[],columnHeaders:[],rowHeadersCount:0,columnHeadersCount:0};this.rMembers=[];this.cMembers=[];this.groupingFields={};this.valueMatrix=[];this.indexMatrix=[];this.memberCnt=-1;this.pageInLimit=!1;this.endPos=0;this.removeCount=0;this.colHdrBufferCalculated=!1;this.colValuesLength=1;this.rowValuesLength=1;this.slicedHeaders=[];this.fieldFilterMem={};this.filterPosObj={};this.selectedHeaders={selectedHeader:[],values:[]};this.rowGrandTotal=null;this.columnGrandTotal=null;this.removeRowGrandTotal=!1;this.removeColumnGrandTotal=!1;this.isValueHasAdvancedAggregate=!1;this.rawIndexObject={};this.isEditing=!1;this.data=[];this.actualData=[];this.groupRawIndex={};this.allowDataCompression=!1;this.dataSourceSettings={};this.frameHeaderObjectsCollection=!1;this.headerObjectsCollection={};this.columnKeys={};this.fieldDrillCollection={};this.customRegex=/^(('[^']+'|''|[^*#@0,.])*)(\*.)?((([0#,]*[0,]*[0#]*)(\.[0#]*)?)|([#,]*@+#*))(E\+?0+)?(('[^']+'|''|[^*#@0,.E])*)$/;this.formatRegex=/(^[ncpae]{1})([0-1]?[0-9]|20)?$/i}return n.prototype.renderEngine=function(n,t,i){var f,u;if(this.getValueCellInfo=i,this.formatFields={},this.dateFormatFunction={},this.calculatedFields={},this.calculatedFormulas={},this.valueAxis=0,this.saveDataHeaders={},this.columnCount=0,this.rowCount=0,this.colFirstLvl=0,this.rowFirstLvl=0,this.rowStartPos=0,this.colStartPos=0,this.excludeFields=Object(r.isNullOrUndefined)(n.excludeFields)?[]:n.excludeFields,this.enableValueSorting=!1,this.headerCollection={rowHeaders:[],columnHeaders:[],rowHeadersCount:0,columnHeadersCount:0},this.valueMatrix=[],this.indexMatrix=[],this.aggregatedValueMatrix=[],this.rMembers=[],this.cMembers=[],this.memberCnt=-1,this.pageInLimit=!1,this.endPos=0,this.removeCount=0,this.colHdrBufferCalculated=!1,this.colValuesLength=1,this.rowValuesLength=1,this.slicedHeaders=[],this.fieldFilterMem={},this.filterPosObj={},this.selectedHeaders={selectedHeader:[],values:[]},this.rowGrandTotal=null,this.columnGrandTotal=null,this.removeRowGrandTotal=!1,this.removeColumnGrandTotal=!1,this.isValueHasAdvancedAggregate=!1,this.rawIndexObject={},this.isEditing=!1,this.globalize=new r.Internationalization,this.localeObj=t?t.localeObj:void 0,this.fieldsType=t?t.fieldsType:{},this.enableSort=n.enableSorting,this.alwaysShowValueHeader=n.alwaysShowValueHeader,this.showHeaderWhenEmpty=!!Object(r.isNullOrUndefined)(n.showHeaderWhenEmpty)||n.showHeaderWhenEmpty,this.showSubTotals=!!Object(r.isNullOrUndefined)(n.showSubTotals)||n.showSubTotals,this.showRowSubTotals=!!Object(r.isNullOrUndefined)(n.showRowSubTotals)||n.showRowSubTotals,this.showColumnSubTotals=!!Object(r.isNullOrUndefined)(n.showColumnSubTotals)||n.showColumnSubTotals,this.showGrandTotals=!!Object(r.isNullOrUndefined)(n.showGrandTotals)||n.showGrandTotals,this.showRowGrandTotals=!!Object(r.isNullOrUndefined)(n.showRowGrandTotals)||n.showRowGrandTotals,this.showColumnGrandTotals=!!Object(r.isNullOrUndefined)(n.showColumnGrandTotals)||n.showColumnGrandTotals,this.allowValueFilter=n.allowValueFilter,this.isValueFilterEnabled=!1,this.enableValueSorting=!!t&&t.enableValueSorting,this.isDrillThrough=!!t&&!!t.isDrillThrough&&t.isDrillThrough,this.valueContent=[],this.dataSourceSettings=n,n.dataSource instanceof tt.DataManager||(this.data=Object(r.isBlazor)()&&!n.dataSource&&this.data&&this.data.length>0?this.data:n.dataSource),t&&t.pageSettings&&t.pageSettings.allowDataCompression&&(this.actualData=this.data,this.data=this.getGroupedRawData(n)),this.data&&this.data[0]){for(this.fields=Object.keys(this.data[0]),this.rows=n.rows?n.rows:[],this.columns=n.columns?n.columns:[],this.filters=n.filters?n.filters:[],this.values=n.values?n.values:[],this.formats=n.formatSettings?n.formatSettings:[],this.groups=n.groupSettings?n.groupSettings:[],this.calculatedFieldSettings=n.calculatedFieldSettings?n.calculatedFieldSettings:[],this.enableSort=void 0===n.enableSorting||n.enableSorting,f=this.getGroupData(this.data),this.validateFilters(n),this.isExpandAll=!(!this.isValueFiltersAvail||!n.allowValueFilter)||n.expandAll,this.drilledMembers=n.drilledMembers?this.isValueFiltersAvail&&n.allowValueFilter?[]:n.drilledMembers:[],this.isMutiMeasures=this.values.length>1,this.valueAxis="row"===n.valueAxis?1:0,this.emptyCellTextContent=n.emptyCellsTextContent?n.emptyCellsTextContent:"",this.rowValuesLength=1===this.valueAxis?this.values.length:1,this.colValuesLength=0===this.valueAxis?this.values.length:1,this.valueSortSettings=n.valueSortSettings||{sortOrder:"None",headerDelimiter:".",headerText:"",columnIndex:void 0},this.valueSortData=[],this.pageSettings=t?t.pageSettings?t.pageSettings:this.pageSettings:void 0,this.allowDataCompression=this.pageSettings&&this.pageSettings.allowDataCompression,this.savedFieldList=t?t.savedFieldList:void 0,this.getFieldList(f,this.enableSort,n.allowValueFilter),this.removeIrrelevantFields(n,Object.keys(this.fieldList)),this.fillFieldMembers(this.data,this.indexMatrix),this.updateSortSettings(n.sortSettings,this.enableSort),this.valueMatrix=this.generateValueMatrix(this.data),this.filterMembers=[],u=this.columns.length-1,this.columnKeys={};u>-1;)this.columnKeys[this.columns[u].name]=this.columns[u],u--;this.updateFilterMembers(n);this.generateGridData(n)}},n.prototype.removeIrrelevantFields=function(n,t){var i={},u,f;for(i[0]=n.rows,i[1]=n.columns,i[2]=n.values,i[3]=n.filters,u=0;u<4;){if(i[u])for(f=0;f<i[u].length;f++)(this.excludeFields.indexOf(i[u][f].name)>-1||!Object(r.isNullOrUndefined)(t)&&-1===t.indexOf(i[u][f].name))&&(i[u].splice(f,1),f--);u++}},n.prototype.getGroupedRawData=function(n){var l,v,b,e,w,u,a,s;for(this.data=[],l=0,v=this.actualData;l<v.length;l++)b=v[l],this.data[this.data.length]=this.frameHeaderWithKeys(b);var h=n.values.filter(function(n){return"Count"===n.type||"DistinctCount"===n.type}).map(function(n){return n.name}),tt=h.length>0,k=this.data,d=n.rows.concat(n.columns.concat(n.filters)).map(function(n){return n.name}),y={},g=[];this.groupRawIndex={};for(var nt={},p=0,c=0;c<k.length;c++){if(e=k[c],w=[],tt)for(u=0;u<h.length;u++)e[h[u]]=Object(r.isNullOrUndefined)(e[h[u]])?e[h[u]]:1;for(a=0;a<d.length;a++)w.push(e[d[a]]);if(s=w.join("-"),y[s]){for(u=0;u<n.values.length;u++){var t=n.values[u].name,o=e[t],i=y[s],f=n.values[u].type;Object(r.isNullOrUndefined)(o)||("number"==typeof o&&"DistinctCount"!==f||(f="Count"),Object(r.isNullOrUndefined)(i[t])?i[t]="Product"===f?1:"Min"===f||"Max"===f?void 0:0:"number"!=typeof i[t]&&(i[t]=1),"Count"===f?i[t]+=1:"Min"===f?Object(r.isNullOrUndefined)(i[t])||(i[t]=i[t]>o?o:i[t]):"Max"===f?Object(r.isNullOrUndefined)(i[t])||(i[t]=i[t]<o?o:i[t]):"Product"===f?i[t]*=o:i[t]+=o)}this.isDrillThrough&&this.groupRawIndex[nt[s]].push(c)}else y[s]=e,g.push(e),this.isDrillThrough&&(this.groupRawIndex[p]=[c],nt[s]=p,p++)}return g},n.prototype.getGroupData=function(n){for(var f,i=n[0],s=function(u){var f=u.name,tt=u.caption,y,vt,ri,s,p,o,pi,yt,ft,bi,wt,a,c,h,st,gi,nr,rt,tr,si,hi,gt,ni,ci,ti,li,ir,ct,rr,ot,lt,ai,ii;if(!(t.fields.indexOf(f)>-1))return{value:i};if(y={},vt=void 0,"Date"===u.type&&t.groupingFields[f])return{value:i};if("Number"===u.type){if("number"!==e.getType(i[f])&&t.groupingFields[f])return{value:i};u.rangeInterval&&n.sort(function(n,t){return n[f]>t[f]?1:t[f]>n[f]?-1:0})}else if("Custom"===u.type&&t.fields.indexOf(f+"_custom_group")>-1)return{value:i};for(ri=n.length;ri--;){if(s=n[ri],s[f]&&"Date"===u.type){if(p=new Date(s[f].toString()),!Object(r.isNullOrUndefined)(p)&&u.groupInterval.length>0)for(o=0,pi=u.groupInterval.length;o<pi;o++){var g=u.groupInterval[o],k=t.getRange(u,p.getTime()),ut=e.resetTime(new Date);switch(g){case"Years":y[l=o===u.groupInterval.length-1?f:f+"_date_group_years"]=g;s[l]=k?void 0:new Date(ut.setFullYear(p.getFullYear())).toString();break;case"Quarters":y[l=o===u.groupInterval.length-1?f:f+"_date_group_quarters"]=g;yt=Math.ceil((p.getMonth()+1)/3);s[l]=k?void 0:(t.localeObj?t.localeObj.getConstant("qtr"):"Qtr")+yt.toString();break;case"QuarterYear":y[l=o===u.groupInterval.length-1?f:f+"_date_group_quarterYear"]=g;yt=Math.ceil((p.getMonth()+1)/3);s[l]=k?void 0:(t.localeObj?t.localeObj.getConstant("qtr"):"Qtr")+yt.toString()+" "+(t.localeObj?t.localeObj.getConstant("of"):"of")+" "+p.getFullYear().toString();break;case"Months":y[l=o===u.groupInterval.length-1?f:f+"_date_group_months"]=g;s[l]=k?void 0:new Date(ut.setMonth(p.getMonth(),ut.getDate())).toString();break;case"Days":y[l=o===u.groupInterval.length-1?f:f+"_date_group_days"]=g;s[l]=k?void 0:new Date(ut.setMonth(p.getMonth(),p.getDate())).toString();break;case"Hours":y[l=o===u.groupInterval.length-1?f:f+"_date_group_hours"]=g;s[l]=k?void 0:new Date(ut.setHours(p.getHours())).toString();break;case"Minutes":y[l=o===u.groupInterval.length-1?f:f+"_date_group_minutes"]=g;s[l]=k?void 0:new Date(ut.setMinutes(p.getMinutes())).toString();break;case"Seconds":y[l=o===u.groupInterval.length-1?f:f+"_date_group_seconds"]=g;s[l]=k?void 0:new Date(ut.setSeconds(p.getSeconds())).toString()}}}else if(s[f]&&"Number"===u.type)k=t.getRange(u,s[f]),s[f]=k?void 0:s[f];else if(s[f]&&"Custom"===u.type&&u.customGroups&&u.customGroups.length>0)for(var l=f+"_custom_group",wi=u.customGroups,pt=void 0,fr=(o=0,wi.length);o<fr;o++)ft=wi[o],ft.items&&ft.items.length>1&&(vt=l,bi=-1!==e.inArray(s[f].toString(),ft.items),s[l]=bi?ft.groupName&&""!==ft.groupName?ft.groupName:t.localeObj.getConstant("group")+" "+o:pt&&pt!==s[f].toString()?pt:s[f].toString(),pt=s[l]);for(var at=[],ui=0,ki=gt=Object.keys(s);ui<ki.length;ui++)wt=ki[ui],at.push(!!s[wt]);i=-1===at.indexOf(!1)&&gt.length===Object.keys(n[0]).length?s:i;t.fields=Object.keys(i)}if("Date"===u.type){for(var et=!1,bt=[t.rows,t.columns,t.values,t.filters],it=Object.keys(y),nt=Object.keys(it).length,w=void 0,fi=0,di=bt;fi<di.length;fi++)if(a=di[fi],!et&&a){for(c=a.length,o=0;o<c;){if(a[o].name===f){for(et=!0,h=a[o],a.splice(o,1),ot=(ot=t.rows).concat(t.columns,t.values,t.filters);nt--;)e.getFieldByName(it[nt],ot)||(w=y[it[nt]],st={name:it[nt],caption:(t.localeObj?t.localeObj.getConstant(w):w)+" ("+(h.caption?h.caption:h.name)+")",type:"Count",showNoDataItems:h.showNoDataItems,baseField:h.baseField,baseItem:h.baseItem,showFilterIcon:h.showFilterIcon,showSortIcon:h.showSortIcon,showEditIcon:h.showEditIcon,showRemoveIcon:h.showRemoveIcon,showSubTotals:h.showValueTypeIcon,allowDragAndDrop:h.allowDragAndDrop},a.splice(o,0,st));break}o++}if(et)break}for(nt=Object.keys(it).length;nt--;){for(w=y[it[nt]],o=0,gi=t.formats.length;o<gi;o++)if(t.formats[o].name===it[nt]){t.formats.splice(o,1);break}"Quarters"!==w&&"QuarterYear"!==w&&(nr={name:it[nt],type:["Years","Months","Days"].indexOf(w)>-1?"date":"time",format:"Years"===w?"yyyy":"Months"===w?"MMM":"Days"===w?"d-MMM":"Hours"===w?"hh a":"Minutes"===w?":mm":"Seconds"===w?":ss":void 0},t.formats.push(nr))}}else if("Number"===u.type&&u.rangeInterval){var d=void 0,b=void 0,ht=void 0,ei=void 0,kt=[],dt=[],oi=n.length;for(c=0,t.groupingFields[f]=f;c<oi;)dt.push(n[c][f]),n[c][f]&&-1===kt.indexOf(n[c][f])&&kt.push(n[c][f]),c++;for(rt=Math.max.apply(Math,kt),tr=(o=kt[0],rt);o<tr;o++)dt.indexOf(o)<0&&(si=t.frameData(n[0]),si[f]=o,hi=dt.lastIndexOf(o-1),dt.splice(hi+1,0,o),n.splice(hi+1,0,si));for(oi=n.length,c=0;c<oi;){if(n[c]&&n[c][f]){for(ei=(ht=n[c][f])+(u.rangeInterval-1),b=b?b>rt?rt:b:ei>rt?rt:ei,ht>=(d=d||ht)&&ht<=b?n[c][f]=d===b?d.toString():d.toString()+"-"+b.toString():ht>b&&ht===b+1&&(b=(d=b+1)+(u.rangeInterval-1)>rt?rt:d+(u.rangeInterval-1),n[c][f]=d===b?d.toString():d.toString()+"-"+b.toString()),at=[],ni=0,ci=gt=Object.keys(n[c]);ni<ci.length;ni++)wt=ci[ni],at.push(!!n[c][wt]);i=-1===at.indexOf(!1)&&gt.length===Object.keys(n[0]).length?n[c]:i}c++}for(ti=0,li=bt=[t.rows,t.columns,t.values,t.filters];ti<li.length;ti++)ir=li[ti],ct=e.getFieldByName(f,ir),ct&&((ct=ct.properties?ct.properties:ct).type="Count");for(o=0,rr=t.formats.length;o<rr;o++)if(t.formats[o].name===f){t.formats.splice(o,1);break}}else if("Custom"===u.type&&vt){lt=vt;et=!1;bt=[t.rows,t.columns,t.values,t.filters];ot=(ot=t.rows).concat(t.columns,t.values,t.filters);ai=[];tt&&""!==tt||(ai=lt.match(/_custom_group/g));for(var vi=e.getFieldByName(f.replace(/_custom_group/g,""),ot),v=e.getFieldByName(lt,ot),yi=0,ur=bt;yi<ur.length;yi++)if(a=ur[yi],!et&&a){for(c=a.length,o=0;o<c;){if(a[o].name===u.name&&!v){et=!0;h=a[o];st={name:lt,caption:tt&&""!==tt?tt:(vi.caption?vi.caption:vi.name)+(ai.length+1),type:"Count",showNoDataItems:h.showNoDataItems,baseField:h.baseField,baseItem:h.baseItem,showSubTotals:h.showValueTypeIcon,allowDragAndDrop:h.allowDragAndDrop,showFilterIcon:h.showFilterIcon,showSortIcon:h.showSortIcon,showRemoveIcon:h.showRemoveIcon,showEditIcon:h.showEditIcon};a.splice(o,0,st);break}if(a[o].name===lt&&v){st={name:v.name,caption:tt&&""!==tt?tt:v.caption,type:v.type,showNoDataItems:v.showNoDataItems,baseField:v.baseField,baseItem:v.baseItem,showRemoveIcon:v.showRemoveIcon,showSubTotals:v.showValueTypeIcon,allowDragAndDrop:v.allowDragAndDrop,showFilterIcon:v.showFilterIcon,showSortIcon:v.showSortIcon,showEditIcon:v.showEditIcon};a.splice(o,1,st);break}o++}if(et)break}ii=e.getFieldByName(f,e.cloneFormatSettings(t.formats));ii&&(ii.name=lt,t.formats.push(ii))}t.groupingFields=Object(r.extend)(t.groupingFields,y)},t=this,u=0,o=this.groups;u<o.length;u++)if(f=s(o[u]),"object"==typeof f)return f.value;return this.fields=Object.keys(i),i},n.prototype.frameData=function(n){for(var i=Object.keys(n),t=0,r={};t<i.length;)r[i[t]]=void 0,t++;return r},n.prototype.getRange=function(n,t){var i,r,u;if("Date"===n.type){var f=new Date(t),e="string"==typeof n.startingAt?new Date(n.startingAt):n.startingAt,o="string"==typeof n.endingAt?new Date(n.endingAt):n.endingAt;i=!!(e&&f.getTime()<e.getTime()||o&&f.getTime()>o.getTime())}else r="string"==typeof n.startingAt?parseInt(n.startingAt,10):n.startingAt,u="string"==typeof n.endingAt?parseInt(n.endingAt,10):n.endingAt,i=!!(r&&t<r||u&&t>u);return i},n.prototype.getFormattedFields=function(){for(var n=this.formats.length;n--;)this.formatFields[this.formats[n].name]=this.formats[n],this.formats[n].type&&(this.dateFormatFunction[this.formats[n].name]={exactFormat:this.globalize.getDateFormat(this.formats[n]),fullFormat:this.globalize.getDateFormat({format:"yyyy/MM/dd/HH/mm/ss",type:this.formats[n].type})})},n.prototype.getFieldList=function(n,t,i){var o,h=this.fields,c=Object(r.extend)([],this.rows,null,!0),s,l,f,u;for(c=c.concat(this.columns,this.values,this.filters),this.getFormattedFields(c),this.getCalculatedField(h),h=this.fields,s=this.excludeFields.length,s-=1;s>-1;)l=this.fields.indexOf(this.excludeFields[s]),this.fields.splice(l,1),this.fieldList&&delete this.fieldList[this.excludeFields[s]],s--;if(f=h.length,this.savedFieldList)for(this.fieldList=this.savedFieldList;f--;)u=h[f],this.fieldList[u]?(this.fieldList[u].isSelected=!1,this.fieldList[u].index=f,this.fieldList[u].filter=[],this.fieldList[u].sort=t?"Ascending":"None",this.fieldList[u].isExcelFilter=!1,this.fieldList[u].filterType="",this.fieldList[u].showFilterIcon=!0,this.fieldList[u].showRemoveIcon=!0,this.fieldList[u].showSortIcon=!0,this.fieldList[u].showEditIcon=!0,this.fieldList[u].showValueTypeIcon=!0,this.fieldList[u].allowDragAndDrop=!0,this.fieldList[u].isCalculatedField=!1,this.fieldList[u].showNoDataItems=!1,this.fieldList[u].showSubTotals=!0,this.isValueFiltersAvail&&i&&(this.fieldList[u].dateMember=[],this.fieldList[u].formattedMembers={},this.fieldList[u].members={})):this.fieldList[u]={id:u,caption:u,type:-1!==u.indexOf("_custom_group")||-1!==u.indexOf("_date_group")?"string":void 0===o||"undefined"===o?"number":o,sort:t?"Ascending":"None",isSelected:!1,filterType:"",index:f,filter:[],isCustomField:-1!==u.indexOf("_custom_group")||-1!==u.indexOf("_date_group"),showFilterIcon:!0,showRemoveIcon:!0,showSortIcon:!0,showEditIcon:!0,showValueTypeIcon:!0,allowDragAndDrop:!0,showSubTotals:!0,showNoDataItems:!1,isCalculatedField:!1};else for(this.fieldList={};f--;)u=h[f],o=this.fieldsType&&this.fieldsType[u]?this.fieldsType[u]:e.getType(n[u]),this.fieldList[u]={id:u,caption:u,type:-1!==u.indexOf("_custom_group")||-1!==u.indexOf("_date_group")?"string":void 0===o||"undefined"===o?"number":o,filterType:"",index:f,filter:[],sort:t?"Ascending":"None",isSelected:!1,isCustomField:-1!==u.indexOf("_custom_group")||-1!==u.indexOf("_date_group"),showFilterIcon:!0,showRemoveIcon:!0,showSortIcon:!0,showValueTypeIcon:!0,showEditIcon:!0,allowDragAndDrop:!0,showSubTotals:!0,showNoDataItems:!1,isCalculatedField:!1};this.updateTreeViewData(c)},n.prototype.updateFieldList=function(n){for(var t=this.fields,i=t.length;i--;)this.fieldList[t[i]].isExcelFilter=n[t[i]].isExcelFilter},n.prototype.updateTreeViewData=function(n){for(var i,t=n.length,r=this.calculatedFieldSettings.length;t--;)this.fieldList[n[t].name]&&(i=this.fieldList[n[t].name],i.caption=n[t].caption?n[t].caption:n[t].name,i.isSelected=!0,i.showNoDataItems=n[t].showNoDataItems,i.aggregateType=n[t].type,i.baseField=n[t].baseField,i.baseItem=n[t].baseItem,i.allowDragAndDrop=n[t].allowDragAndDrop,i.showFilterIcon=n[t].showFilterIcon,i.showSortIcon=n[t].showSortIcon,i.showRemoveIcon=n[t].showRemoveIcon,i.showValueTypeIcon=n[t].showValueTypeIcon,i.showEditIcon=n[t].showEditIcon,i.showSubTotals=n[t].showSubTotals);for(;r--;)this.fieldList[this.calculatedFieldSettings[r].name]&&(this.fieldList[this.calculatedFieldSettings[r].name].aggregateType="CalculatedField",this.fieldList[this.calculatedFieldSettings[r].name].isCalculatedField=!0,this.fieldList[this.calculatedFieldSettings[r].name].formula=this.calculatedFieldSettings[r].formula)},n.prototype.getCalculatedField=function(n){for(var t,u=0,f=this.calculatedFieldSettings;u<f.length;u++)t=f[u],this.calculatedFields[t.name]=Object(r.extend)({},t,null,!0),this.calculatedFields[t.name].actualFormula=t.formula;for(var o=Object.keys(this.calculatedFields),s=function(t){var r=i.calculatedFields[o[t]],f=r.properties,a=(f?f.formula:r.formula).replace(/ +/g,""),e=a.replace(/"/g,""),l;r.formula=e.indexOf("^")>-1?i.powerFunction(e):e;-1===r.formula.indexOf("Math.min(")&&r.formula.indexOf("min(")>-1&&(r.formula=r.formula.replace(/min\(/g,"Math.min("));-1===r.formula.indexOf("Math.max(")&&r.formula.indexOf("max(")>-1&&(r.formula=r.formula.replace(/max\(/g,"Math.max("));-1===r.formula.indexOf("Math.abs(")&&r.formula.indexOf("abs(")>-1&&(r.formula=r.formula.replace(/abs\(/g,"Math.abs("));r.name=f?f.name:r.name;(n=n.filter(function(n){return n!==r.name})).push(r.name);for(var v=a.split('"'),s=0,y=v.length;s<y;s++){var h=v[s],u=h.split(/[ .:;?!~,`"&|()<>{}\[\]\r\n/\\]+/),c="DistinctCount"===u[0]?"DistinctCount":"PopulationStDev"===u[0]?"PopulationStDev":"SampleStDev"===u[0]?"SampleStDev":"PopulationVar"===u[0]?"PopulationVar":"SampleVar"===u[0]?"SampleVar":u[0];-1!==["Sum","Count","Min","Max","Avg","Product","DistinctCount","PopulationStDev","SampleStDev","PopulationVar","SampleVar"].indexOf(c)&&(l=n.indexOf(u[1]),i.calculatedFormulas[r.name]?i.calculatedFormulas[r.name].push({index:l,type:c,formula:h}):i.calculatedFormulas[r.name]=[{index:l,type:c,formula:h}])}},i=this,e=0,h=o.length;e<h;e++)s(e);this.fields=n},n.prototype.validateFilters=function(n){var e,t,i,u,h;for(this.isValueFiltersAvail=!1,e=n.filterSettings?n.filterSettings:[],t=Object(r.extend)([],this.rows,null,!0),t=t.concat(this.columns),i=0,u=e;i<u.length;i++){for(var o=u[i],f=0,s=t;f<s.length;f++)if(h=s[f],o.name===h.name&&"Value"===o.type){this.isValueFiltersAvail=!0;break}if(this.isValueFiltersAvail)break}},n.prototype.validateValueFields=function(){var n,t,i;for(this.isValueHasAdvancedAggregate=!1,n=0,t=this.values;n<t.length;n++)if(i=t[n],-1!==["DifferenceFrom","PercentageOfDifferenceFrom","PercentageOfParentRowTotal","PercentageOfParentColumnTotal","PercentageOfParentTotal","RunningTotals"].indexOf(i.type)){this.isValueHasAdvancedAggregate=!0;break}},n.prototype.fillFieldMembers=function(n,t){for(var r,i,s,e,l=this.fields,y=n.length,f=this.fieldList,p=l.length,h=0;h<p;h++){r=l[h];f[r].members&&!this.allowDataCompression||(f[r].members={});f[r].formattedMembers&&!this.allowDataCompression||(f[r].formattedMembers={});f[r].dateMember&&!this.allowDataCompression||(f[r].dateMember=[]);for(var o=f[r].members,w=Object.keys(o).length>0,c=f[r].formattedMembers,b=f[r].dateMember,a=0,v=0,u=0;u<y;u++)i=n[u][r],w||(s=i,e=!this.pageSettings||this.formatFields[r]&&["date","dateTime","time"].indexOf(this.formatFields[r].type)>-1?this.getFormattedValue(i,r):{formattedText:null===i?this.localeObj?this.localeObj.getConstant("null"):String(i):void 0===i?this.localeObj?r in this.groupingFields?this.localeObj.getConstant("groupOutOfRange"):this.localeObj.getConstant("undefined"):String(i):i.toString(),actualText:null===i?this.localeObj?this.localeObj.getConstant("null"):String(i):void 0===i?this.localeObj?r in this.groupingFields?this.localeObj.getConstant("groupOutOfRange"):this.localeObj.getConstant("undefined"):String(i):i},e.formattedText&&(s=e.formattedText),o.hasOwnProperty(i)?o[i].index.push(u):(a++,o[i]={index:[u],ordinal:a,isDrilled:!!this.isExpandAll},b.push({formattedText:e.formattedText,actualText:e.dateText?e.dateText:e.actualText})),c.hasOwnProperty(s)?c[s].index.push(u):(v++,c[s]={index:[u],ordinal:v,isDrilled:!!this.isExpandAll})),t[u]||(t[u]=[]),t[u][h]=o[i].ordinal}},n.prototype.generateValueMatrix=function(n){for(var i,u,e=this.fields,t=n.length,f=[],o=e.length,s=this.fieldList;t--;)for(n[t],i=o,f[t]=[];i--;)u=e[i],f[t][i]="number"===s[u].type||Object(r.isNullOrUndefined)(n[t][u])?n[t][u]:1;return f},n.prototype.updateSortSettings=function(n,t){for(var i=0,r=n?n.length:0;i<r&&t;i++)this.fieldList[n[i].name]&&(this.fieldList[n[i].name].sort=n[i].order)},n.prototype.updateFilterMembers=function(n){var u=this.filterMembers,i={},f=this.getFilters(n,i),e=this.indexMatrix.length,r,t;if(f)for(r=i.include.index,t=0;t<r.length;t++)void 0!==i.exclude&&void 0!==i.exclude.indexObject[r[t]]||u.push(r[t]);else for(t=0;t<e;t++)void 0!==i.exclude&&void 0!==i.exclude.indexObject[t]||u.push(t)},n.prototype.getFilters=function(n,t){for(var i,u=n.filterSettings?n.filterSettings:[],f=(this.filters,!1),e=[],r=0,o=u.length;r<o;r++)i=u[r].properties?u[r].properties:u[r],this.fieldList[i.name]&&this.fieldList[i.name].isSelected&&this.isValidFilterField(i,n.allowMemberFilter,n.allowLabelFilter)&&(this.applyLabelFilter(i),i&&(e=i.items),i.type&&"Include"===i.type?(this.frameFilterList(e,i.name,t,"include",i.showLabelFilter,f),f=!0):this.frameFilterList(e,i.name,t,"exclude",i.showLabelFilter),i.showLabelFilter&&(i.items=[],i.type=i.showDateFilter?"Date":i.showNumberFilter?"Number":"Label"));return f},n.prototype.isValidFilterField=function(n,t,i){var u=n.name,f=!1,h=Object(r.extend)([],this.rows,null,!0),e,o,c,s,l;if(h=h.concat(this.columns),this.fieldList[u].isSelected&&t&&["Include","Exclude"].indexOf(n.type)>=0){for(e=this.fieldList[u],this.formatFields[u]&&["date","dateTime","time"].indexOf(this.formatFields[u].type)>-1?e.formattedMembers:e.members,f=!0,o=0,c=this.values;o<c.length;o++)if(u===c[o].name){f=!1;break}}else if(i)for(s=0,l=h;s<l.length;s++)if(u===(e=l[s]).name&&["Label","Date","Number"].indexOf(n.type)>=0){f=!0;break}return f},n.prototype.applyLabelFilter=function(n){var t,u,f,i,r;if(["Label","Date","Number"].indexOf(n.type)>=0){if(t=Object.keys(this.fieldList[n.name].members),n.showLabelFilter=!0,"Label"===n.type)n.items=this.getLabelFilterMembers(t,n.condition,n.value1,n.value2);else if("Date"===n.type)n.showDateFilter=!0,u="string"==typeof n.value1?new Date(n.value1):n.value1,f="string"==typeof n.value2?new Date(n.value2):n.value2,n.items=this.getDateFilterMembers(t,n.name,n.condition,u,f);else for(n.showNumberFilter=!0,n.items=[],i=0,r=t;i<r.length;i++){var e=r[i],o=this.getParsedValue(n.name,n.value1),s=this.getParsedValue(n.name,n.value2),h=this.getParsedValue(n.name,e);this.validateFilterValue(h,n.condition,o,s)&&n.items.push(e)}n.type=n.condition?["DoesNotBeginWith","DoesNotContains","DoesNotEndsWith","DoesNotEquals","NotBetween"].indexOf(n.condition)>-1&&!n.showNumberFilter?"Exclude":"Include":"Exclude"}else n.showLabelFilter=!1},n.prototype.getLabelFilterMembers=function(n,t,i,r){for(var u,f,e=[],o=0,s=n;o<s.length;o++)if(u=s[o],f=u.toLowerCase(),i.toString())switch(t){case"Equals":case"DoesNotEquals":f===i.toLowerCase()&&e.push(u);break;case"BeginWith":case"DoesNotBeginWith":0===f.indexOf(i.toLowerCase())&&e.push(u);break;case"EndsWith":case"DoesNotEndsWith":null!==f.match(i.toLowerCase()+"$")&&e.push(u);break;case"Contains":case"DoesNotContains":f.indexOf(i.toLowerCase())>-1&&e.push(u);break;case"GreaterThan":f>i.toLowerCase()&&e.push(u);break;case"GreaterThanOrEqualTo":f>=i.toLowerCase()&&e.push(u);break;case"LessThan":f<i.toLowerCase()&&e.push(u);break;case"LessThanOrEqualTo":f<=i.toLowerCase()&&e.push(u);break;case"Between":case"NotBetween":f>=i.toLowerCase()&&f<=r.toLowerCase()&&e.push(u);break;default:f===i.toLowerCase()&&e.push(u)}return e},n.prototype.getDateFilterMembers=function(n,t,i,r,u){for(var f,e,o=[],s=0,h=n;s<h.length;s++)if(f=h[s],e=new Date(f),r)switch(i){case"Equals":case"DoesNotEquals":this.getFormattedValue(e.toString(),t).formattedText===this.getFormattedValue(r.toString(),t).formattedText&&o.push(this.getFormattedValue(f,t).formattedText);break;case"After":e.getTime()>r.getTime()&&o.push(this.getFormattedValue(f,t).formattedText);break;case"AfterOrEqualTo":e.getTime()>=r.getTime()&&o.push(this.getFormattedValue(f,t).formattedText);break;case"Before":e.getTime()<r.getTime()&&o.push(this.getFormattedValue(f,t).formattedText);break;case"BeforeOrEqualTo":e.getTime()<=r.getTime()&&o.push(this.getFormattedValue(f,t).formattedText);break;case"Between":case"NotBetween":e.getTime()>=r.getTime()&&e.getTime()<=u.getTime()&&o.push(this.getFormattedValue(f,t).formattedText);break;default:this.getFormattedValue(e.toString(),t).formattedText===this.getFormattedValue(r.toString(),t).formattedText&&o.push(this.getFormattedValue(f,t).formattedText)}return o},n.prototype.validateFilterValue=function(n,t,i,r){var u=!1;if("number"==typeof i)switch(t){case"Equals":n===i&&(u=!0);break;case"DoesNotEquals":n!==i&&(u=!0);break;case"GreaterThan":n>i&&(u=!0);break;case"GreaterThanOrEqualTo":n>=i&&(u=!0);break;case"LessThan":n<i&&(u=!0);break;case"LessThanOrEqualTo":n<=i&&(u=!0);break;case"Between":n>=i&&n<=r&&(u=!0);break;case"NotBetween":n>=i&&n<=r||(u=!0);break;default:n!==i&&(u=!0)}return u},n.prototype.frameFilterList=function(n,t,i,r,u,f){i[r]||(i[r]={indexObject:{},index:[]});this.updateFilter(n,t,i,r,u,f)},n.prototype.updateFilter=function(n,t,i,r,u,f){var s=0,c=this.fieldList[t],o,e,h,l;c.filter=n;c.filterType=r;c.isExcelFilter=u;var a=this.formatFields[t]&&["date","dateTime","time"].indexOf(this.formatFields[t].type)>-1?c.formattedMembers:c.members,p=f,v={},y={};for(v[r]={indexObject:{},index:[]},this.fieldFilterMem[t]={memberObj:{}};n[s];){if(a[n[s]])if(o=a[n[s]].index,"include"===r)for(e=0,h=o.length;e<h;e++)p&&void 0===i[r].indexObject[o[e]]||(v[r].indexObject[o[e]]=o[e],v[r].index.push(o[e]));else{for(e=0,h=o.length;e<h;e++)void 0===i[r].indexObject[o[e]]&&(i[r].indexObject[o[e]]=o[e],i[r].index.push(o[e]));this.fieldFilterMem[t].memberObj[n[s]]=n[s]}s++}if("include"===r){for(i[r]=v[r],e=0;e<n.length;e++)a[n[e]]&&(y[n[e]]=n[e]);for(l=Object.keys(a),e=0,h=l.length;e<h;e++)void 0===y[l[e]]&&(this.fieldFilterMem[t].memberObj[l[e]]=l[e])}},n.prototype.applyValueFiltering=function(n,t,i,u,f,e,o){this.isValueFiltered=!1;var s=Object(r.extend)({},"row"===o&&this.rowGrandTotal?this.rowGrandTotal:"column"===o&&this.columnGrandTotal?this.columnGrandTotal:i[i.length-1],null,!0);return this.getFilteredData(i,u,f,e,t,n.name,s,o),this.isValueFiltered&&(("row"===o&&null===this.rowGrandTotal||"column"===o&&null===this.columnGrandTotal)&&e.push(s),i=e),i},n.prototype.getFilteredData=function(n,t,i,u,f,e,o,s){for(var v,w,b,k,d,y=n.length,h=0;h<y;h++)if(i[e])if(n[h].level===f){this.isValueFiltered=!0;this.fieldList[e].isExcelFilter=!0;var l=0,c=i[e].measure,p=this.fieldList[c].index,a=this.fieldList[c].aggregateType;this.rawIndexObject={};l="row"===s?this.getAggregateValue(n[h].index,t.indexObject,p,a):this.getAggregateValue(t.index,n[h].indexObject,p,a);v={fieldName:c,row:n[h],column:t,value:l,cellSets:this.getCellSet(this.rawIndexObject),rowCellType:n[h].hasChild&&n[h].isDrilled?"subTotal":"grand sum"===n[h].type?"grandTotal":"value",columnCellType:t.hasChild&&t.isDrilled?"subTotal":"grand sum"===t.type?"grandTotal":"value",aggregateType:a,skipFormatting:!1};this.getValueCellInfo&&this.getValueCellInfo(v);l=v.value;this.rawIndexObject={};w=this.getParsedValue(c,i[e].value1);b=this.getParsedValue(c,i[e].value2);this.validateFilterValue(l,i[e].condition,w,b)||"grand sum"===n[h].type?"grand sum"!==n[h].type&&(u.push(Object(r.extend)({},n[h],null,!0)),u[u.length-1].isLevelFiltered=!0):(k=this.removefilteredData(n[h],this.valueFilteredData),d=k||n[h],this.validateFilteredParentData(d,this.valueFilteredData,o,0,f,s))}else n[h].hasChild&&n[h].members.length>0&&"grand sum"!==n[h].type&&(u.push(Object(r.extend)({},n[h],null,!0)),u[u.length-1].members=[],u[u.length-1].isLevelFiltered=!0,this.getFilteredData(n[h].members,t,i,u[u.length-1].members,f,e,o,s))},n.prototype.getParsedValue=function(n,t){var u=t?t.toString():"",i;return this.formatFields[n]&&t?(i=Object(r.extend)({},this.formatFields[n],null,!0),delete i.name,this.globalize.parseNumber(u,i)):this.globalize.parseNumber(u,{format:"N"})},n.prototype.removefilteredData=function(n,t){for(var f,u=Object(r.extend)([],t,null,!0),i=0;i<u.length;i++){if(n.isLevelFiltered&&n.axis===u[i].axis&&n.valueSort.levelName===u[i].valueSort.levelName&&n.actualText===u[i].actualText&&n.axis===u[i].axis&&n.level===u[i].level&&n.ordinal===u[i].ordinal){f=u[i];t.splice(i,1);break}t[i].hasChild&&t[i].members.length>0&&this.removefilteredData(n,t[i].members)}return f},n.prototype.validateFilteredParentData=function(n,t,i,r,u,f){var h,v,e,c,y,o,l,w,a,b;if(t.length>0){for(h=0,v=t;h<v.length;h++)if(e=v[h],e.level===r){if("row"===f)for(c=0,y=s=n.index;c<y.length;c++)o=y[c],i.index.indexOf(o)>=0&&i.index.splice(i.index.indexOf(o),1),n.valueSort.levelName.toString().indexOf(e.valueSort.levelName.toString())>=0&&e.level!==u&&e.index.indexOf(o)>=0&&e.index.splice(e.index.indexOf(o),1);else for(var s=n.indexObject,p=0,k=Object.keys(s);p<k.length;p++)o=k[p],s.hasOwnProperty(o)&&(delete i.indexObject[o],n.valueSort.levelName.toString().indexOf(e.valueSort.levelName.toString())>=0&&e.level!==u&&delete e.indexObject[o]);e&&e.members.length>0&&e.members[0].level===r+1&&e.members[0].level!==u&&this.validateFilteredParentData(n,e.members,i,r+1,u,f)}}else if("row"===f)for(l=0,w=s=n.index;l<w.length;l++)o=w[l],i.index.indexOf(o)>=0&&i.index.splice(i.index.indexOf(o),1);else for(s=n.indexObject,a=0,b=Object.keys(s);a<b.length;a++)o=b[a],s.hasOwnProperty(o)&&delete i.indexObject[o]},n.prototype.updateFramedHeaders=function(n,t,i,u,f){for(var e,o=0,s=n;o<s.length;o++)e=s[o],this.isHeaderAvail=!1,(this.validateFilteredHeaders(e,i,f)||"grand sum"===e.type)&&("row"===f?this.rowCount+=this.rowValuesLength:this.columnCount+=this.colValuesLength,u.push(Object(r.extend)({},e,null,!0)),u[u.length-1].members=[],e.hasChild&&e.isDrilled&&e.members.length>0&&this.updateFramedHeaders(e.members,t,i,u[u.length-1].members,f));return this.filterFramedHeaders},n.prototype.validateFilteredHeaders=function(n,t,i){for(var r,u=0,f=t;u<f.length;u++)if(r=f[u],!this.isHeaderAvail){if(n.actualText===r.actualText&&n.level===r.level&&n.valueSort.levelName===r.valueSort.levelName)return"row"===i?r.index.length>0?(this.isHeaderAvail=!0,n.index=r.index,!0):(this.isHeaderAvail=!1,n.index=r.index,!1):Object.keys(r.indexObject).length>0?(this.isHeaderAvail=!0,n.indexObject=r.indexObject,!0):(this.isHeaderAvail=!1,n.indexObject=r.indexObject,!1);r.hasChild&&r.members.length>0&&"grand sum"!==r.type&&this.validateFilteredHeaders(n,r.members,i)}return this.isHeaderAvail},n.prototype.isEmptyDataAvail=function(n,t){this.isEmptyData=!1;n.length>0&&"grand sum"===n[n.length-1].type&&0===n[n.length-1].index.length&&(this.isEmptyData=!0);t.length>0&&"grand sum"===t[t.length-1].type&&0===Object.keys(t[t.length-1].indexObject).length&&(this.isEmptyData=!0);0!==n.length&&0!==t.length||(this.isEmptyData=!0)},n.prototype.updateGridData=function(n){var t,r,i;for(this.data=n.dataSource,this.pageSettings&&this.pageSettings.allowDataCompression&&(this.actualData=this.data,this.data=this.getGroupedRawData(n)),this.indexMatrix=[],t=0,r=this.fields;t<r.length;t++)i=r[t],this.fieldList[i].members={},this.fieldList[i].formattedMembers={},this.fieldList[i].dateMember=[];this.fillFieldMembers(this.data,this.indexMatrix);this.valueMatrix=this.generateValueMatrix(this.data);this.filterMembers=[];this.cMembers=[];this.rMembers=[];this.updateFilterMembers(n);this.isEditing=!0;this.isDrillThrough=!0;this.generateGridData(n);this.isEditing=!1},n.prototype.generateGridData=function(n,t){var f,h,c,tt,w,it,s,l,a,ht,ct;this.fields;var i=n.columns?n.columns:[],p=this.data,u=n.rows?n.rows:[],rt=n.filterSettings,ut=n.values?n.values:[];this.removeCount=0;this.isExpandAll=n.expandAll;this.drilledMembers=n.drilledMembers?n.drilledMembers:[];this.isEmptyData=!1;var v=[],lt=u[0]&&u[0].showNoDataItems||i[0]&&i[0].showNoDataItems,ft=Object(r.extend)([],this.rows,null,!0);if(ft=ft.concat(this.columns,this.values,this.filters),lt)for(f=0;f<this.indexMatrix.length;f++)v.push(f);for(f=0;f<this.filterMembers.length;f++)this.filterPosObj[this.filterMembers[f]]=this.filterMembers[f];this.valueSortSettings.columnIndex=void 0;(new Date).getTime();this.validateValueFields();this.frameDrillObject();this.isValueFilterEnabled&&!this.isEditing||t||(this.columnCount=0,this.rowCount=0,this.cMembers=[],this.rMembers=[],0!==u.length&&(this.rMembers=this.getIndexedHeaders(u,p,0,u[0].showNoDataItems?v:this.filterMembers,"row","",this.allowValueFilter)),0!==i.length&&(this.cMembers=this.getIndexedHeaders(i,p,0,i[0].showNoDataItems?v:this.filterMembers,"column","",this.allowValueFilter)),this.insertAllMembersCommon(),this.saveDataHeaders=this.isValueFiltersAvail&&n.allowValueFilter?{rowHeaders:Object(r.extend)([],this.rMembers,null,!0),columnHeaders:Object(r.extend)([],this.cMembers,null,!0)}:{});this.pivotValues=[];this.headerContent=[];this.valueContent=[];this.valueFilteredData=[];this.filterFramedHeaders=[];var et=[],k=[],e=[],o=[],ot=this.values.length;if(this.isValueFiltersAvail&&n.allowValueFilter&&!t){if(this.valueFilteredData=[],h=this.saveDataHeaders.rowHeaders,c=this.saveDataHeaders.columnHeaders,rt.length>0){for(var d={},g={},nt=0,st=ut;nt<st.length;nt++)tt=st[nt],g[tt.name]=tt;for(w=0,it=rt;w<it.length;w++)if(s=it[w],h=e.length>0?e:h,c=o.length>0?o:c,this.valueFilteredData=[],l=s.properties?s.properties:s,"Value"===l.type&&this.fieldList[s.name]&&this.fieldList[s.name].isSelected){d[s.name]=s;l.items=[];for(var b=!1,at=u.length,vt=i.length,y=0;y<at;y++)if(l.name===u[y].name&&g[l.measure]&&!b){b=!0;e=this.applyValueFiltering(u[y],y,h,this.columnGrandTotal?this.columnGrandTotal:c[c.length-1],d,this.valueFilteredData,"row");break}for(a=0;a<vt;a++)if(l.name===i[a].name&&g[l.measure]&&!b){b=!0;o=this.applyValueFiltering(i[a],a,c,this.rowGrandTotal?this.rowGrandTotal:h[h.length-1],d,this.valueFilteredData,"column");break}}}e=e.length>0?e:h;o=o.length>0?o:c;this.isEmptyDataAvail(e,o);ht=Object(r.extend)({},this.fieldList,null,!0);this.indexMatrix=[];ct=this.data[0];this.getFieldList(ct,this.enableSort,n.allowValueFilter);this.fillFieldMembers(this.data,this.indexMatrix);this.updateSortSettings(n.sortSettings,this.enableSort);this.valueMatrix=this.generateValueMatrix(this.data);this.filterMembers=[];this.updateFilterMembers(n);this.rMembers=0!==u.length?this.getIndexedHeaders(u,p,0,u[0].showNoDataItems?v:this.filterMembers,"row",""):[];this.cMembers=0!==i.length?this.getIndexedHeaders(i,p,0,i[0].showNoDataItems?v:this.filterMembers,"column",""):[];this.insertAllMembersCommon();this.updateFieldList(ht);this.rowCount=0;this.columnCount=0;this.rMembers=this.updateFramedHeaders(this.rMembers,this.rMembers,e,this.filterFramedHeaders,"row");this.filterFramedHeaders=[];this.cMembers=this.updateFramedHeaders(this.cMembers,this.cMembers,o,this.filterFramedHeaders,"column");this.isValueFilterEnabled=!0}t||this.applyValueSorting();this.pageSettings&&(t?(this.rMembers=t.rowHeaders,this.cMembers=t.columnHeaders,this.rowCount=t.rowHeadersCount,this.columnCount=t.columnHeadersCount):(this.headerCollection.rowHeaders=this.rMembers,this.headerCollection.columnHeaders=this.cMembers,this.headerCollection.rowHeadersCount=this.rowCount,this.headerCollection.columnHeadersCount=this.columnCount),this.calculatePagingValues());this.getAggregatedHeaders(u,i,this.rMembers,this.cMembers,ut);this.getHeaderData(this.cMembers,k,this.pivotValues,0,this.valueAxis?1:ot);this.insertSubTotals();this.getTableData(this.rMembers,et,k,0,this.pivotValues,ot,this.rowGrandTotal?this.rowGrandTotal:this.rMembers[this.rMembers.length-1],this.columnGrandTotal?this.columnGrandTotal:this.cMembers[this.cMembers.length-1]);this.applyAdvancedAggregate(et,k,this.pivotValues);this.isEngineUpdated=!0;(new Date).getTime();this.isEmptyDataAvail(this.rMembers,this.cMembers)},n.prototype.updateHeaders=function(n,t){n=Object(r.isNullOrUndefined)(n)?!(!this.showGrandTotals||!this.showRowGrandTotals)||!(this.rows.length>0):n;(this.pageSettings&&this.removeRowGrandTotal||!n&&!this.rowGrandTotal)&&"grand sum"===this.rMembers[this.rMembers.length-1].type&&(this.rMembers=this.rMembers.slice(0,this.rMembers.length-1));t=Object(r.isNullOrUndefined)(t)?!(!this.showGrandTotals||!this.showColumnGrandTotals)||!(this.columns.length>0):t;(this.pageSettings&&this.removeColumnGrandTotal||!t&&!this.columnGrandTotal)&&"grand sum"===this.cMembers[this.cMembers.length-1].type&&(this.cMembers=this.cMembers.slice(0,this.cMembers.length-1))},n.prototype.updatePivotValues=function(n){var u=!(!this.showGrandTotals||!this.showRowGrandTotals)||!(this.rows.length>0),f=!(!this.showGrandTotals||!this.showColumnGrandTotals)||!(this.columns.length>0),t,i,r;if((n&&this.updateHeaders(u,f),(this.pageSettings&&this.removeRowGrandTotal||!u&&!this.rowGrandTotal)&&this.valueContent.length>0)&&(t=1,this.valueAxis&&this.values.length>0&&(t=1+this.values.length),this.pivotValues[this.pivotValues.length-t]&&"grand sum"===this.pivotValues[this.pivotValues.length-t][0].type&&(this.pivotValues=this.pivotValues.slice(0,this.pivotValues.length-t),this.valueContent=this.valueContent.slice(0,this.valueContent.length-t))),(this.pageSettings&&this.removeColumnGrandTotal||!f&&!this.columnGrandTotal)&&this.headerContent.length>0&&(t=this.values.length,this.valueAxis&&this.values.length>0&&(t=1),this.pivotValues[0][this.pivotValues[0].length-t]&&"grand sum"===this.pivotValues[0][this.pivotValues[0].length-t].type))for(i=0;i<this.pivotValues.length;i++)if(this.pivotValues[i]&&(this.pivotValues[i]=this.pivotValues[i].slice(0,this.pivotValues[i].length-t)),this.headerContent[i])for(r=this.pivotValues[i].length;r<this.pivotValues[i].length+t;r++)delete this.headerContent[i][r];this.removeRowGrandTotal=this.removeColumnGrandTotal=!1},n.prototype.onDrill=function(n){this.frameDrillObject();var t=this.getHeadersInfo(n.fieldName,n.axis);this.performDrillOperation(t.headers,n,t.fields,t.position,0);this.headerCollection.rowHeadersCount=this.rowCount;this.headerCollection.columnHeadersCount=this.columnCount;"row"===t.axis?this.headerCollection.rowHeaders=t.headers:this.headerCollection.columnHeaders=t.headers;this.updateEngine()},n.prototype.onSort=function(n){var t=this.getHeadersInfo(n.name,"");this.fieldList[n.name].sort=n.order;this.performSortOperation(t.headers,n,t,0);this.updateEngine()},n.prototype.onFilter=function(n,t){var a=this.getHeadersInfo(n.name,""),f,o,s,i;"Include"===n.type&&n.items.length===this.fieldList[n.name].dateMember.length?(this.fieldList[n.name].filter=[],this.fieldList[n.name].filterType=""):(this.fieldList[n.name].filter=n.items,this.fieldList[n.name].filterType=n.type);for(var h={},u=0,c=this.filterMembers;u<c.length;u++)f=c[u],h[f]=f;this.filterMembers=[];this.fieldFilterMem={};this.updateFilterMembers(t);for(var r=this.filterMembers.filter(function(n){return void 0===h[n]}),v={},e=0,l=n.items;e<l.length;e++)o=l[e],v[o]=o;if(this.rows[0]&&this.rows[0].showNoDataItems||this.columns[0]&&this.columns[0].showNoDataItems){for(s=[],this.filterPosObj={},i=0;i<r.length;i++)this.filterPosObj[r[i]]=r[i];for(i=0;i<this.indexMatrix.length;i++)s.push(i);r=s}this.performFilterCommonUpdate(n,a,r);this.frameHeaderObjectsCollection=!1;this.headerObjectsCollection={};this.updateEngine()},n.prototype.onAggregation=function(n){this.fieldList[n.name].aggregateType=n.type;this.rMembers=this.headerCollection.rowHeaders;this.cMembers=this.headerCollection.columnHeaders;this.allowDataCompression&&(this.data=this.getGroupedRawData(this.dataSourceSettings),this.valueMatrix=this.generateValueMatrix(this.data));this.updateEngine()},n.prototype.onCalcOperation=function(n){this.rMembers=this.headerCollection.rowHeaders;this.cMembers=this.headerCollection.columnHeaders;this.getCalculatedField(this.fields);this.fieldList[n.name]?this.fieldList[n.name].formula=n.formula:(this.fieldList[n.name]={id:n.name,caption:n.name,type:"number",aggregateType:"CalculatedField",filterType:"",index:this.fields.length-1,filter:[],sort:this.enableSort?"Ascending":"None",isSelected:!0,isExcelFilter:!1,formula:n.formula},1===this.valueAxis?this.headerCollection.rowHeadersCount=this.rowCount=this.rowCount/(this.values.length-1)*this.values.length:this.headerCollection.columnHeadersCount=this.columnCount=this.columnCount/(this.values.length-1)*this.values.length);this.updateEngine()},n.prototype.performDrillOperation=function(n,t,i,r,u){for(var e,o,f=0;f<n.length;){if(r===u){if(t.memberName===n[f].valueSort.levelName.split(this.valueSortSettings.headerDelimiter).join(t.delimiter?t.delimiter:"**")){"down"===t.action?(n[f].isDrilled=!0,n[f].members=this.getIndexedHeaders(i,this.data,r+1,n[f].index,t.axis,t.memberName.split(t.delimiter?t.delimiter:"**").join(this.valueSortSettings.headerDelimiter)),e=void 0,"row"===t.axis?(e=this.applyValueSorting(n[f].members,this.cMembers),n[f].members=e.rMembers):(o=this.showSubTotals&&this.showColumnSubTotals&&i[r].showSubTotals,this.columnCount-=o?0:this.colValuesLength,e=this.applyValueSorting(this.rMembers,n[f].members),n[f].members=e.cMembers)):(n[f].isDrilled=!1,this.updateHeadersCount(n[f].members,t.axis,r,i,"minus",!0),n[f].members=[]);break}}else n[f].members.length>0&&(n[f].members=this.performDrillOperation(n[f].members,t,i,r,u+1));f++}return n},n.prototype.performSortOperation=function(n,t,i,r){for(var u=0;u<n.length;){if(i.position===r){n=this.getSortedHeaders(n,t.order.toString());break}n[u].members.length>0&&(n[u].members=this.performSortOperation(n[u].members,t,i,r+1));u++}return n},n.prototype.performFilterDeletion=function(n,t,i,r,u){for(var s,f=0,e=!0,h=function(){if(i.position===u){var s=o;n=n.filter(function(n){return!s.fieldFilterMem[t.name].memberObj[n.formattedText]||"grand sum"===n.type});e=!1}else n[f].members.length>0&&(n[f].members=o.performFilterDeletion(n[f].members,t,i,r,u+1));f++},o=this;f<n.length&&e;)h();return s=this,n.filter(function(n){return n.members.length>0?n.members.length>0:s.matchIndexes(n.indexObject,r)})},n.prototype.matchIndexes=function(n,t){var r=Object.keys(n),i=r.length;if(0===i)return!0;for(;i>-1;){if(void 0!==t[n[r[i]]])return!0;i--}return!1},n.prototype.performFilterAddition=function(n,t,i){for(var r=0,f=function(){var f=n[r].valueSort.levelName,o,c;if(u.headerObjectsCollection[f]){for(var s={},e=0,h=n[r].members;e<h.length;e++)o=h[e],s[o.valueSort.levelName.toString()]=o.valueSort.levelName.toString();c=u.headerObjectsCollection[f].filter(function(n){return!s[n.valueSort.levelName.toString()]});n[r].members=n[r].members.concat(c);n[r].members=u.getSortedHeaders(n[r].members,u.fieldList[i.fields[n[r].members[0].level].name].sort);delete u.headerObjectsCollection[f]}n[r].members.length>0&&(n[r].members=u.performFilterAddition(n[r].members,t,i));r++},u=this;r<n.length;)f();return n},n.prototype.performFilterCommonUpdate=function(n,t,i){for(var f,o,v,s,r="row"===t.axis?this.rMembers:this.cMembers,h={},u=0,c=this.filterMembers;u<c.length;u++)f=c[u],h[f]=f;if(this.fieldFilterMem[n.name]&&(r=this.performFilterDeletion(t.headers,n,t,h,0)),i.length>0){this.frameHeaderObjectsCollection=!0;t.fields.filter(function(n){return n.showNoDataItems}).length>0&&(i=this.data.map(function(n,t){return t}));this.headerObjectsCollection.parent=this.getIndexedHeaders(t.fields,this.data,0,i,t.axis,"");r=this.performFilterAddition(r,t.fields,t);for(var l={},e=0,a=r;e<a.length;e++)o=a[e],l[o.valueSort.levelName.toString()]=o.valueSort.levelName.toString();v=this.headerObjectsCollection.parent.filter(function(n){return!l[n.valueSort.levelName.toString()]});s=r.filter(function(n){return"grand sum"===n.type});s.length>0&&r.pop();r=this.getSortedHeaders(r.concat(v),this.fieldList[t.fields[0].name].sort).concat(s)}"row"===t.axis?this.rowCount=0:this.columnCount=0;this.updateHeadersCount(r,t.axis,0,t.fields,"plus",!1);"row"===t.axis?(t.position>0&&this.insertPosition(this.rows,this.data,0,this.filterMembers,"row","",r),this.insertTotalPosition(r),this.rMembers=this.headerCollection.rowHeaders=r,this.headerCollection.rowHeadersCount=this.rowCount):(t.position>0&&this.insertPosition(this.columns,this.data,0,this.filterMembers,"column","",r),this.insertTotalPosition(r),this.cMembers=this.headerCollection.columnHeaders=r,this.headerCollection.columnHeadersCount=this.columnCount);this.applyValueSorting()},n.prototype.getHeadersInfo=function(n,t){this.rMembers=this.headerCollection.rowHeaders;this.cMembers=this.headerCollection.columnHeaders;for(var e="row"===(t=""===t?this.getAxisByFieldName(n):t)?this.rMembers:this.cMembers,r="row"===t?this.rows:this.columns,u=0,i=0,f=r;i<f.length;i++){if(f[i].name===n)break;u++}return{axis:t,fields:r,headers:e,position:u}},n.prototype.updateEngine=function(){this.removeCount=0;this.validateValueFields();this.calculatePagingValues();this.pivotValues=[];this.headerContent=[];this.valueContent=[];var t=[],n=[],i=this.values.length;this.getAggregatedHeaders(this.rows,this.columns,this.rMembers,this.cMembers,this.values);this.getHeaderData(this.cMembers,n,this.pivotValues,0,this.valueAxis?1:i);this.insertSubTotals();this.getTableData(this.rMembers,t,n,0,this.pivotValues,i,this.rowGrandTotal?this.rowGrandTotal:this.rMembers[this.rMembers.length-1],this.columnGrandTotal?this.columnGrandTotal:this.cMembers[this.cMembers.length-1]);this.applyAdvancedAggregate(t,n,this.pivotValues);this.isEngineUpdated=!0;this.isEmptyDataAvail(this.rMembers,this.cMembers)},n.prototype.getAxisByFieldName=function(n){for(var i=0,t="";i<4&&""===t;){switch(i){case 0:t=this.getFieldByName(n,this.rows)?"row":"";break;case 1:t=this.getFieldByName(n,this.columns)?"column":""}i++}return t},n.prototype.getFieldByName=function(n,t){return new tt.DataManager({json:t}).executeLocal((new tt.Query).where("name","equal",n))[0]},n.prototype.updateHeadersCount=function(n,t,i,r,u,f){for(var e=0,o=r[i],s=!0,s="column"===t?this.showSubTotals&&this.showColumnSubTotals&&o.showSubTotals:this.showSubTotals&&this.showRowSubTotals&&o.showSubTotals;e<n.length;)"row"===t?this.rowCount=this.rowCount-("plus"===u?-(1===this.valueAxis?this.values.length:1):1===this.valueAxis?this.values.length:1):this.columnCount=this.columnCount-("plus"===u?-(1===this.valueAxis?1:this.values.length):1===this.valueAxis?1:this.values.length),n[e].members.length>0&&this.updateHeadersCount(n[e].members,t,i+1,r,u,!0),e++;"column"===t&&!s&&f&&(this.columnCount+="plus"===u?-this.colValuesLength:this.colValuesLength)},n.prototype.frameHeaderWithKeys=function(n){for(var i=Object.keys(n),t=0,r={};t<i.length;)r[i[t]]=n[i[t]],t++;return r},n.prototype.getSortedHeaders=function(n,t){return(this.formatFields&&this.formatFields[n[0].valueSort.axis]&&this.formatFields[n[0].valueSort.axis].type)?"Ascending"===t?n.sort(function(n,t){return n.dateText>t.dateText?1:t.dateText>n.dateText?-1:0}):"Descending"===t?n.sort(function(n,t){return n.dateText<t.dateText?1:t.dateText<n.dateText?-1:0}):n:"Ascending"===t?n.sort(function(n,t){return n.actualText>t.actualText?1:t.actualText>n.actualText?-1:0}):"Descending"===t?n.sort(function(n,t){return n.actualText<t.actualText?1:t.actualText<n.actualText?-1:0}):n},n.prototype.applyValueSorting=function(n,t){var h=!1,e;if(void 0!==n&&void 0!==t||(n=this.rMembers,t=this.cMembers,h=!0),this.enableValueSorting&&this.valueSortSettings.headerText&&""!==this.valueSortSettings.headerText&&this.values.length>0){for(var r=this.valueSortSettings.headerText.split(this.valueSortSettings.headerDelimiter),u="",o=void 0,s=void 0,f=void 0,i=0;i<this.values.length;i++){if(this.values[i].caption===r[r.length-1]){f=this.values[i].name;break}f=r[r.length-1]}if((1===this.values.length&&0===this.columns.length||this.values.length>1)&&f&&this.fieldList[f]){for(i=0;i<r.length-1;i++)u=""===u?r[i]:u+this.valueSortSettings.headerDelimiter+r[i];o=this.fieldList[f].index;s=this.fieldList[f].aggregateType}else{if(this.alwaysShowValueHeader&&1!==r.length)for(i=0;i<r.length-1;i++)u=""===u?r[i]:u+this.valueSortSettings.headerDelimiter+r[i];else u=this.valueSortSettings.headerText;o=this.fieldList[this.values[0].name].index;s=this.fieldList[this.values[0].name].aggregateType}e=void 0;0===this.valueAxis?(e=this.getMember(t,u))&&(n=this.sortByValueRow(n,e,this.valueSortSettings.sortOrder,o,s)):(e=this.getMember(n,u))&&(t=this.sortByValueRow(t,e,this.valueSortSettings.sortOrder,o,s));h&&(this.rMembers=n,this.cMembers=t,this.pageSettings&&(this.headerCollection.rowHeaders=this.rMembers,this.headerCollection.columnHeaders=this.cMembers))}return{rMembers:n,cMembers:t}},n.prototype.getMember=function(n,t){for(var r,u=n.length,i=0;i<u;i++){if(n[i].valueSort.levelName===t){r=n[i];break}if(n[i].members.length>0&&(r=this.getMember(n[i].members,t)),r)return r}return r},n.prototype.sortByValueRow=function(n,t,i,r,u){for(var o,c,s,l,f,e=[],h=0,a=n;h<a.length;h++)"grand sum"===(f=a[h]).type?e.push({header:f}):(this.rawIndexObject={},o=this.getAggregateValue(f.index,t.indexObject,r,u),c={fieldName:this.fields[r],row:f,column:t,value:o,cellSets:this.getCellSet(this.rawIndexObject),rowCellType:f.hasChild&&f.isDrilled?"subTotal":"grand sum"===f.type?"grandTotal":"value",columnCellType:t.hasChild&&t.isDrilled?"subTotal":"grand sum"===t.type?"grandTotal":"value",aggregateType:u,skipFormatting:!1},this.getValueCellInfo&&this.getValueCellInfo(c),o=c.value,this.rawIndexObject={},e.push({header:f,value:o}));for(e.sort(function(n,t){return"Descending"===i?(t.value||"grand sum"===t.header.type?t.value:0)-(n.value||"grand sum"===n.header.type?n.value:0):(n.value||"grand sum"===n.header.type?n.value:0)-(t.value||"grand sum"===t.header.type?t.value:0)}),s=0,l=n=e.map(function(n){return n.header});s<l.length;s++)(f=l[s]).members.length>0&&(f.members=this.sortByValueRow(f.members,t,i,r,u));return n},n.prototype.insertAllMembersCommon=function(){this.rowGrandTotal=this.columnGrandTotal=null;var n=!(!this.showGrandTotals||!this.showRowGrandTotals)||!(this.rows.length>0),t=!(!this.showGrandTotals||!this.showColumnGrandTotals)||!(this.columns.length>0);this.isValueHasAdvancedAggregate?(this.insertAllMember(this.rMembers,this.filterMembers,"","row"),n&&(this.rowCount+=this.rowValuesLength),this.insertAllMember(this.cMembers,this.filterMembers,"","column"),t&&(this.columnCount+=this.colValuesLength)):(n?(this.insertAllMember(this.rMembers,this.filterMembers,"","row"),this.rowCount+=this.rowValuesLength):this.rowGrandTotal=this.insertAllMember([],this.filterMembers,"","row")[0],t?(this.insertAllMember(this.cMembers,this.filterMembers,"","column"),this.columnCount+=this.colValuesLength):this.columnGrandTotal=this.insertAllMember([],this.filterMembers,"","column")[0])},n.prototype.insertSubTotals=function(){for(var e,i,u,h,c,l=this.pivotValues.length,t=0;t<l;t++)if(e=this.pivotValues[t],e)for(var f=void 0,o=1,s=void 0,n=e.length-1;n>0;n--){if(i=e[n],i){for(f&&(f.colSpan=o,f.colIndex=f.colIndex-(o-1)),s={index:i.index,indexObject:i.indexObject},i.index=[],i.indexObject={},f=Object(r.extend)({},i,null,!0),i.index=s.index,i.indexObject=s.indexObject,u=t+1;this.pivotValues[u]&&!this.pivotValues[u][n];)this.pivotValues[t][n].isDrilled||(this.pivotValues[t][n].rowSpan=u-t+1,f.rowSpan=u-t+1),h="sum"===i.type||"grand sum"===i.type?i.type:"sum",this.pivotValues[u][n]=this.headerContent[u][n]={type:h,formattedText:"sum"===i.type||"grand sum"===i.type?i.formattedText:i.formattedText+" Total",axis:"column",level:-1,colIndex:n,rowIndex:u,valueSort:i.valueSort},i.valueSort&&i.valueSort[this.valueSortSettings.headerText]&&(this.valueSortSettings.columnIndex=n),c=!1,"grand sum"===h?(this.pivotValues[t][n].rowSpan=u-t+1,f.rowSpan=u-t+1):"sum"!==this.pivotValues[t][n].type&&this.pivotValues[t][n].isDrilled?(this.pivotValues[t+1][n].rowSpan=u-t,c=!0):this.pivotValues[u][n].rowSpan=-1,u>t+1&&("sum"===this.pivotValues[t][n].type||c)&&(this.pivotValues[u][n].rowSpan=-1),u++;o=1}else e[n]=this.headerContent[t][n]=Object(r.extend)({},f,null,!0),e[n].index=this.headerContent[t][n].index=s.index,e[n].indexObject=this.headerContent[t][n].indexObject=s.indexObject,o++,e[n].colSpan=o,e[n].colIndex=e[n].colIndex-(o-1);1===n&&f&&(f.colSpan=o,f.colIndex=f.colIndex-(o-1))}},n.prototype.frameDrillObject=function(){var t,n,i,r;for(this.fieldDrillCollection={},t=0;t<this.drilledMembers.length;t++)for(n=this.drilledMembers[t],i=0;i<n.items.length;i++)r=n.name+this.valueSortSettings.headerDelimiter+n.items[i].split(n.delimiter).join(this.valueSortSettings.headerDelimiter),this.fieldDrillCollection[r]=r},n.prototype.getIndexedHeaders=function(n,t,i,u,f,e,o){var h=[],s,v,l,tt,ut,st,a,ht,ft,ct,et;if(n){var it=n.length,y={},w=n[i].name,ot=n[i],p=this.fieldList[w],b=!1,rt=this.formatFields[w]&&["date","dateTime","time"].indexOf(this.formatFields[w].type)>-1,d=u.length<1&&i>0||ot.showNoDataItems,k={};if(d){for(var g=Object.keys(p.members),c=0,nt=g.length;c<nt;c++)(this.showHeaderWhenEmpty||this.localeObj&&g[c]!==this.localeObj.getConstant("undefined"))&&(k[g[c]]=g[c]);u.length<1&&(b=!0,u.length=g.length)}for(c=0,nt=u.length;c<nt;c++)s={},Object(r.isNullOrUndefined)(n[i].showSubTotals)||n[i].showSubTotals||(s.showSubTotals=!1),s.hasChild=i<it-1,s.level=i,s.axis=f,s.colSpan=1,v=b?p.members[Object.keys(k)[0]].ordinal:this.indexMatrix[u[c]][p.index],l=b?Object.keys(k)[0]:t[u[c]][w],(Object(r.isNullOrUndefined)(l)||this.localeObj&&l===this.localeObj.getConstant("undefined"))&&!this.showHeaderWhenEmpty?d&&!b&&i>0&&c+1===u.length&&Object.keys(k).length>0&&(nt=Object.keys(k).length,b=!0,c=-1):(delete k[l],d&&this.fieldFilterMem[w]&&this.fieldFilterMem[w].memberObj[l]===l)||(tt=rt?{actualText:l,formattedText:p.dateMember[v-1].formattedText,dateText:p.dateMember[v-1].actualText}:{formattedText:null===l?this.localeObj?this.localeObj.getConstant("null"):String(l):void 0===l&&this.localeObj?w in this.groupingFields?this.localeObj.getConstant("groupOutOfRange"):this.localeObj.getConstant("undefined"):String(l),actualText:null===l?this.localeObj?this.localeObj.getConstant("null"):String(l):void 0===l?this.localeObj?w in this.groupingFields?this.localeObj.getConstant("groupOutOfRange"):this.localeObj.getConstant("undefined"):String(l):l},s.actualText=tt.actualText,s.formattedText=tt.formattedText,rt&&(s.dateText=tt.dateText),ut=!d||void 0!==this.filterPosObj[u[c]]&&!b,y&&y[v]?ut&&(y[v].index.push(u[c]),y[v].indexObject[u[c]]=u[c]):(y[v]={index:[],indexObject:{}},s.index=y[v].index,s.indexObject=y[v].indexObject,ut&&(s.index=y[v].index=[u[c]],y[v].indexObject[u[c]]=u[c],s.indexObject=y[v].indexObject),s.ordinal=v,s.valueSort={},s.valueSort.axis=w,0!==i?(s.valueSort.levelName=e+this.valueSortSettings.headerDelimiter+s.formattedText,s.valueSort[e+this.valueSortSettings.headerDelimiter+s.formattedText]=1):(s.valueSort[s.formattedText]=1,s.valueSort.levelName=s.formattedText),st=s.valueSort.axis+this.valueSortSettings.headerDelimiter+s.valueSort.levelName,s.isDrilled=!(!o||!this.isValueFiltersAvail)||(s.hasChild&&this.fieldDrillCollection[st]?!this.isExpandAll:p.members[l].isDrilled),s.members=[],h.push(s)),d&&!b&&i>0&&c+1===u.length&&Object.keys(k).length>0&&(b=!0,nt=Object.keys(k).length,c=-1));for(a=0,ht=h.length;a<ht;a++)this.frameHeaderObjectsCollection||("row"===f?this.rowCount+=this.rowValuesLength:this.columnCount+=this.colValuesLength),ft=null,(h[a].valueSort&&h[a].valueSort.levelName&&(ft=h[a].valueSort.levelName),e=ft||h[a].formattedText,!this.showHeaderWhenEmpty&&it-1>i&&h[a].index&&h[a].index.length>0&&!d)?(l=t[h[a].index[0]][n[i+1].name],ct=!(Object(r.isNullOrUndefined)(l)||this.localeObj&&l===this.localeObj.getConstant("undefined"))||1!==h[a].index.length,h[a].hasChild=ct):!this.showHeaderWhenEmpty&&d&&n[i+1]&&n[i+1].name&&Object.keys(this.fieldList[n[i+1].name].members).length&&(h[a].hasChild=!0),it-1>i&&h[a].isDrilled&&(this.columnCount-=this.showSubTotals&&this.showColumnSubTotals&&ot.showSubTotals||"column"!==f?0:this.colValuesLength,et=h[a].index,h[a].members=this.getIndexedHeaders(n,t,i+1,void 0===et?[]:et,f,e),this.frameHeaderObjectsCollection&&(this.headerObjectsCollection[e]=h[a].members));return this.enableSort?rt?"Ascending"===p.sort?h.sort(function(n,t){return n.dateText>t.dateText?1:t.dateText>n.dateText?-1:0}):"Descending"===p.sort?h.sort(function(n,t){return n.dateText<t.dateText?1:t.dateText<n.dateText?-1:0}):h:"Ascending"===p.sort?h.sort(function(n,t){return n.actualText>t.actualText?1:t.actualText>n.actualText?-1:0}):"Descending"===p.sort?h.sort(function(n,t){return n.actualText<t.actualText?1:t.actualText<n.actualText?-1:0}):h:h}return h},n.prototype.getOrderedIndex=function(n){for(var i={},t=0;t<n.length;t++)"grand sum"!==n[t].type&&(i[n[t].ordinal]=t);return i},n.prototype.insertPosition=function(n,t,i,r,u,f,e){var v=[],k=this.getOrderedIndex(e),y,h,b,p;if(n){for(var c={},l=n[i].name,d=this.fieldList[l],s=0,g=r.length;s<g;s++){var w={},a=this.indexMatrix[r[s]][d.index],o=e[k[a]],nt=this.formatFields[l]&&["date","dateTime","time"].indexOf(this.formatFields[l].type)>-1?this.getFormattedValue(t[r[s]][l],l):{formattedText:t[r[s]][l].toString(),actualText:t[r[s]][l].toString()};o&&o.formattedText===nt.formattedText&&(c&&c[a]?(c[a].index.push(r[s]),c[a].indexObject[r[s]]=r[s]):(c[a]={index:[],indexObject:{}},o.index=c[a].index=[r[s]],c[a].indexObject[r[s]]=r[s],o.indexObject=c[a].indexObject,o.valueSort={},o.valueSort.axis=l,0!==i?(o.valueSort.levelName=f+this.valueSortSettings.headerDelimiter+o.formattedText,o.valueSort[f+this.valueSortSettings.headerDelimiter+o.formattedText]=1):(o.valueSort[o.formattedText]=1,o.valueSort.levelName=o.formattedText),w.members=[],v.push(w)))}for(y=e.length-v.length;y>0;)v.push({members:[]}),y--;for(h=0,b=v.length;h<b;h++)e[h].members.length>0&&(p=null,e[h].valueSort&&e[h].valueSort.levelName&&(p=e[h].valueSort.levelName),f=p||e[h].formattedText,v[h].members=this.insertPosition(n,t,i+1,e[h].index,u,f,e[h].members));return v}return v},n.prototype.insertTotalPosition=function(n){var i=n[n.length-1],t,r;if(i&&"grand sum"===i.type)for(i.index=this.filterMembers,t=0,r=this.filterMembers.length;t<r;t++)i.indexObject[this.filterMembers[t]]=this.filterMembers[t];return n},n.prototype.calculatePagingValues=function(){if(this.pageSettings){1===this.valueAxis?this.rowValuesLength=this.values.length:this.colValuesLength=this.values.length;this.memberCnt=-this.rowValuesLength;this.rowStartPos=(this.pageSettings.rowCurrentPage*this.pageSettings.rowSize-this.pageSettings.rowSize)*this.rowValuesLength;var n=this.rowStartPos+3*this.pageSettings.rowSize*this.rowValuesLength>this.rowCount?this.rowCount-3*this.pageSettings.rowSize*this.rowValuesLength:this.rowStartPos;n<0&&(n=this.rowStartPos=0,this.pageSettings.rowCurrentPage=1);this.rowFirstLvl=(this.rowStartPos-n)%this.pageSettings.rowSize;this.rowStartPos=n;this.endPos=this.rowStartPos+3*this.pageSettings.rowSize*this.rowValuesLength;this.endPos=this.endPos>this.rowCount?this.rowCount:this.endPos;this.rMembers=this.performSlicing(this.rMembers,[],this.rowStartPos,"row");this.memberCnt=-this.colValuesLength;this.pageInLimit=!1;this.colHdrBufferCalculated=!1;this.colStartPos=(this.pageSettings.columnCurrentPage*this.pageSettings.columnSize-this.pageSettings.columnSize)*this.colValuesLength;(n=this.colStartPos+3*this.pageSettings.columnSize*this.colValuesLength>this.columnCount?this.columnCount-3*this.pageSettings.columnSize*this.colValuesLength:this.colStartPos)<0&&(n=this.colStartPos=0,this.pageSettings.columnCurrentPage=1);this.colFirstLvl=(this.colStartPos-n)%this.pageSettings.columnSize;this.colStartPos=n;this.endPos=this.colStartPos+3*this.pageSettings.columnSize*this.colValuesLength;this.endPos=this.endPos>this.columnCount?this.columnCount:this.endPos;this.cMembers=this.performSlicing(this.cMembers,[],this.colStartPos,"column");this.memberCnt=-1;this.pageInLimit=!1;this.isValueHasAdvancedAggregate?("grand sum"!==this.rMembers[this.rMembers.length-1].type&&"grand sum"===this.headerCollection.rowHeaders[this.headerCollection.rowHeaders.length-1].type&&(this.rMembers.push(this.headerCollection.rowHeaders[this.headerCollection.rowHeaders.length-1]),this.removeRowGrandTotal=!0),"grand sum"!==this.cMembers[this.cMembers.length-1].type&&"grand sum"===this.headerCollection.columnHeaders[this.headerCollection.columnHeaders.length-1].type&&(this.cMembers.push(this.headerCollection.columnHeaders[this.headerCollection.columnHeaders.length-1]),this.removeColumnGrandTotal=!0)):(this.rowGrandTotal=this.rowGrandTotal?this.rowGrandTotal:this.headerCollection.rowHeaders[this.headerCollection.rowHeaders.length-1],this.columnGrandTotal=this.columnGrandTotal?this.columnGrandTotal:this.headerCollection.columnHeaders[this.headerCollection.columnHeaders.length-1])}},n.prototype.performSlicing=function(n,t,i,r){for(var u=0;n[u];){if(this.memberCnt+="column"===r?this.colValuesLength:this.rowValuesLength,i<=this.memberCnt&&this.endPos>=this.memberCnt&&!this.pageInLimit&&("column"===r?this.colFirstLvl=this.colFirstLvl+n[u].level:this.rowFirstLvl=this.rowFirstLvl+n[u].level,this.pageInLimit=!0),this.pageInLimit&&this.endPos<=this.memberCnt){if("column"!==r)break;if(0===n[u].members.length){if(this.colHdrBufferCalculated)break;this.colHdrBufferCalculated=!0;this.endPos+=n[u].level*this.colValuesLength}else if(this.colHdrBufferCalculated)break}if(t.push(n[u].members.length>0?this.removeChildMembers(n[u]):n[u]),n[u].members.length>0&&("column"===r&&(this.memberCnt-=this.showSubTotals&&this.showColumnSubTotals&&this.columnKeys[n[u].valueSort.axis].showSubTotals?0:this.colValuesLength),t[t.length-1].members=this.performSlicing(n[u].members,[],i,r)),this.pageInLimit||t.pop(),0===n[u].level&&this.pageInLimit&&this.endPos<=this.memberCnt)break;u++}return t},n.prototype.removeChildMembers=function(n){for(var i=Object.keys(n),t=0,r={};t<i.length;)r[i[t]]=n[i[t]],"members"===i[t]&&(r.members=[]),t++;return r},n.prototype.insertAllMember=function(n,t,i,r){var u=n.length,f,e;for(n[u]={hasChild:!1,index:t,level:0,axis:r,isDrilled:!1,indexObject:{},members:[],formattedText:"Grand Total",ordinal:u,type:"grand sum",valueSort:{}},n[u].valueSort[n[u].formattedText]=1,n[u].valueSort.levelName=n[u].formattedText,f=0,e=t.length;f<e;f++)n[u].indexObject[t[f]]=t[f];return n},n.prototype.getTableData=function(n,t,i,u,f,e,o,s){for(var v,w,c,p,tt,k,d=n.length,h=0;h<d;h++)if(t[u=f.length]=n[h],v=u-Number(Object.keys(t)[0]),w=!t[u].members.length,n[h].colIndex=0,n[h].rowIndex=u,f[u]||(f[u]=[],this.valueContent[v]={}),f[u][0]=this.valueContent[v][0]=this.frameHeaderWithKeys(n[h]),this.valueAxis&&(this.isMutiMeasures||this.alwaysShowValueHeader)){var g=u,nt=v,b=u;if(!n[h].hasChild||(Object(r.isNullOrUndefined)(n[h].showSubTotals)||n[h].showSubTotals)&&this.showSubTotals&&this.showRowSubTotals){for(c=0;c<e;c++){u++;v++;p=this.values[c].caption?this.values[c].caption:this.values[c].name;tt={axis:"row",actualText:this.values[c].name,formattedText:p,level:0,valueSort:{},colIndex:0,rowIndex:u,type:"value"};f[u]||(f[u]=[],this.valueContent[v]={},f[u][0]=this.valueContent[v][0]=tt);k=f[u][0].valueSort;k[f[u-c-1][0].valueSort.levelName+this.valueSortSettings.headerDelimiter+p]=1;k.levelName=f[u-c-1][0].valueSort.levelName+this.valueSortSettings.headerDelimiter+p;for(var a=0,l=1,y=i.length;a<y;++a)this.updateRowData(n,i,u,f,c,h,a,l,v,o,s),l=f[u].length,f[g][l-1]=this.valueContent[nt][l-1]={axis:"value",actualText:"",colSpan:1,colIndex:l,formattedText:"",hasChild:!1}}b=u}else{for(a=0,l=1,y=i.length;a<y;++a)l=f[u].length,f[g][l]=this.valueContent[nt][l]={axis:"value",actualText:"",colSpan:1,colIndex:l,formattedText:"",hasChild:!1};b=u+e}this.recursiveRowData(n,t,i,b,f,e,w,h,e,o,s)}else{for(a=0,l=1,y=i.length;a<y;++a)for(c=0;c<e;c++)this.updateRowData(n,i,u,f,c,h,a,l,v,o,s),l=f[u].length;this.recursiveRowData(n,t,i,u,f,e,w,h,0,o,s)}},n.prototype.getAggregatedHeaders=function(n,t,i,r,u){var y,f,e,s,c,v,l,o;for(this.selectedHeaders={selectedHeader:[],values:[]},y=u.length,f=0;f<y;f++)switch(u[f].type){case"DifferenceFrom":case"PercentageOfDifferenceFrom":e=void 0;s=void 0;this.selectedHeaders.values.push(u[f].name);u[f].baseField&&u[f].baseItem?(e=u[f].baseField,s=u[f].baseItem):this.valueAxis&&(this.isMutiMeasures||this.alwaysShowValueHeader)&&t.length>0?(e=t[0].name,s=Object.keys(this.fieldList[t[0].name].members)[0]):n.length>0&&(e=n[0].name,s=Object.keys(this.fieldList[n[0].name].members)[0]);for(var h=!1,a=0,p=n;a<p.length;a++)if(p[a].name===e){this.getAggregatedHeaderData(i,u[f].name,s,!1,"row",u[f].type,this.selectedHeaders.selectedHeader,f);h=!0;break}if(!h)for(c=0,v=t;c<v.length;c++)if(v[c].name===e){this.getAggregatedHeaderData(r,u[f].name,s,!1,"column",u[f].type,this.selectedHeaders.selectedHeader,f);break}break;case"PercentageOfParentRowTotal":case"PercentageOfParentColumnTotal":this.selectedHeaders.values.push(u[f].name);this.getAggregatedHeaderData("PercentageOfParentRowTotal"===u[f].type?i:r,u[f].name,void 0,!1,"PercentageOfParentRowTotal"===u[f].type?"row":"column",u[f].type,this.selectedHeaders.selectedHeader,f);break;case"RunningTotals":this.selectedHeaders.values.push(u[f].name);this.getAggregatedHeaderData(this.valueAxis&&(this.isMutiMeasures||this.alwaysShowValueHeader)?r:i,u[f].name,void 0,!1,this.valueAxis&&(this.isMutiMeasures||this.alwaysShowValueHeader)?"column":"row",u[f].type,this.selectedHeaders.selectedHeader,f);break;case"PercentageOfParentTotal":for(e=void 0,this.selectedHeaders.values.push(u[f].name),u[f].baseField?e=u[f].baseField:this.valueAxis&&(this.isMutiMeasures||this.alwaysShowValueHeader)&&t.length>0?e=t[0].name:n.length>0&&(e=n[0].name),h=!1,l=n.length,o=0;o<l;o++)if(n[o].name===e){this.getAggregatedHeaderData(i,u[f].name,void 0,!1,"row",u[f].type,this.selectedHeaders.selectedHeader,f,o);h=!0;break}if(!h)for(l=t.length,o=0;o<l;o++)if(t[o].name===e){this.getAggregatedHeaderData(r,u[f].name,void 0,!1,"column",u[f].type,this.selectedHeaders.selectedHeader,f,o);break}}},n.prototype.getAggregatedHeaderData=function(n,t,i,u,f,e,o,s,h){for(var c,w,b,l=0,a=n;l<a.length;l++){c=a[l];switch(e){case"DifferenceFrom":case"PercentageOfDifferenceFrom":-1!==c.valueSort.levelName.toString().split(this.valueSortSettings.headerDelimiter).indexOf(i)?(o.push(this.updateSelectedHeaders(i,c.level,f,u,t,e,c.valueSort.levelName,u?[c]:n,s+1)),c.members.length>0&&this.getAggregatedHeaderData(c.members,t,i,!0,f,e,o[o.length-1].childMembers,s)):c.members.length>0&&this.getAggregatedHeaderData(c.members,t,i,!1,f,e,o,s);break;case"RunningTotals":case"PercentageOfParentRowTotal":case"PercentageOfParentColumnTotal":"grand sum"===c.type?o.push(this.updateSelectedHeaders(void 0,c.level,f,!1,t,e,c.valueSort.levelName,n,s+1)):c.members.length>0&&(o.push(this.updateSelectedHeaders(void 0,c.level,f,!1,t,e,c.valueSort.levelName,c.members,s+1)),this.getAggregatedHeaderData(c.members,t,void 0,!1,f,e,o,s));break;case"PercentageOfParentTotal":if("grand sum"!==c.type)if(c.level===h)if(c.members.length>0){if(u)for(var y=o[o.length-1].aggregateHeaders,v=0,p=c.members;v<p.length;v++)w=p[v],y.push(w);else b=Object(r.extend)([],c.members,null,!0),o.push(this.updateSelectedHeaders(void 0,c.level,f,!1,t,e,c.valueSort.levelName,b,s+1)),(y=o[o.length-1].aggregateHeaders).push(c);this.getAggregatedHeaderData(c.members,t,void 0,!0,f,e,o,s,h+1)}else u||o.push(this.updateSelectedHeaders(void 0,c.level,f,!1,t,e,c.valueSort.levelName,[c],s+1));else c.members.length>0&&this.getAggregatedHeaderData(c.members,t,void 0,!1,f,e,o,s,h)}}},n.prototype.updateSelectedHeaders=function(n,t,i,r,u,f,e,o,s){return{name:n,level:t,axis:i,isChild:r,value:u,type:f,uniqueName:e,aggregateHeaders:o,childMembers:[],valueCount:s}},n.prototype.applyAdvancedAggregate=function(n,t,i){var v,o,s,c,h,l,f;if(this.aggregatedValueMatrix=[],this.selectedHeaders.values.length>0){for(var u={},e=[],a=!1,y=i.length,r=0;r<y;r++)if(void 0!==i[r]&&void 0!==i[r][0]){if(!a)for(v=i[r].length,o=0;o<v;o++)"value"===i[r][o].axis&&-1!==this.selectedHeaders.values.indexOf(i[r][o].actualText)&&(e.push(o),a=!0);if(e.length>0&&"value"===i[r][e[0]].axis&&-1!==this.selectedHeaders.values.indexOf(i[r][e[0]].actualText))for(s=0,c=e;s<c.length;s++)u[r+","+(f=c[s])]=[r,f]}for(this.updateAggregates(n,t,i,this.selectedHeaders.selectedHeader,e,u),h=0,l=Object.keys(u);h<l.length;h++)i[u[f=l[h]][0]][u[f][1]].formattedText=this.selectedHeaders.selectedHeader.length>0?this.emptyCellTextContent:"#N/A",this.aggregatedValueMatrix[u[f][0]]||(this.aggregatedValueMatrix[u[f][0]]=[]),this.aggregatedValueMatrix[u[f][0]][u[f][1]]=0;this.updatePivotValues(!0)}},n.prototype.updateAggregates=function(n,t,i,r,u,f){for(var l,br,c,at,kr,h,dr,gr,k,rt,wi,ct,y,wt,bi,bt,ki,d,g,kt,di,e,dt,gi,o,ut,gt,nr,ni,tr,nt,b,ti,ir,rr,ii,ur,s,ri,ui,fi,fr,ei,er,oi,or,sr,si,hr,hi,cr,lr,ci,ar,li,ot,ai,vr,vi,yr,yi,pr,vt=0,pi=r;vt<pi.length;vt++){var p=pi[vt],st=p.aggregateHeaders,w=p.value,a=this.valueAxis&&(this.isMutiMeasures||this.alwaysShowValueHeader)?p.valueCount:0,wr=p.type,lt=p.uniqueName,yt="row"===p.axis,ft=void 0,tt=[],v=[],pt=[],ht=[],et=[],it=[];if(-1!==["DifferenceFrom","PercentageOfDifferenceFrom","PercentageOfParentRowTotal","PercentageOfParentColumnTotal","PercentageOfParentTotal","RunningTotals"].indexOf(p.type))if(yt){if("RunningTotals"!==p.type)for(g=n.length,l=0;l<g;l++)if(void 0!==n[l]&&n[l].valueSort[lt]){ft=n[l];et=0===this.valueAxis||this.valueAxis&&i[l+a]&&i[l+a][0].actualText===w?i[l+a]:[];break}}else{for(br=i.length,c=0;c<br&&void 0!==i[c]&&void 0===i[c][0];c++)pt.push(i[c]);for(at=pt.length;at--;)kr=(rt=pt[at][u[0]]).actualText,-1===this.selectedHeaders.values.indexOf(kr)&&(v=pt[at],at=0);if("RunningTotals"!==p.type){for(nt=v.length,h=0;h<nt;h++)if(b=!1,void 0!==v[h]&&v[h].valueSort[lt]){for(ft=v[h],dr=i.length,c=0;c<dr;c++)void 0!==(rt=i[c])&&void 0!==rt[0]&&"value"===rt[h].axis&&-1!==this.selectedHeaders.values.indexOf(rt[h].actualText)&&(b=!0,it[c]=rt[h],ht.push(c));if(b)break}if(0===it.length&&0===ht.length)for(nt=v.length,h=0;h<nt;h++)if(b=!1,void 0!==v[h]&&0===v[h].valueSort.levelName.indexOf(lt)){for(ft=v[h],gr=i.length,k=0;k<gr;k++)void 0!==(rt=i[k])&&void 0!==rt[0]&&"value"===rt[h].axis&&-1!==this.selectedHeaders.values.indexOf(rt[h].actualText)&&(b=!0,ht.push(k));if(b)break}}}switch(p.type){case"DifferenceFrom":case"PercentageOfDifferenceFrom":if(wi=p.isChild,yt){if(wi){for(ct=lt.split(this.valueSortSettings.headerDelimiter),y=(g=n.length,0);y<g;y++)if(void 0!==n[y]&&-1!==n[y].valueSort.levelName.split(this.valueSortSettings.headerDelimiter).indexOf(ct[ct.length-1])&&n[y].level===ft.level)for(wt=0,bi=u;wt<bi.length;wt++)e=bi[wt],"value"===(s=i[y+a][e]).axis&&s.actualText===w&&(tt.push([y+a,e]),f[y+a+","+e]&&delete f[y+a+","+e])}else for(bt=0,ki=st;bt<ki.length;bt++)for(d=ki[bt],g=n.length,l=0;l<g;l++)if(void 0!==n[l]&&n[l].valueSort[d.valueSort.levelName]&&n[l].level===ft.level&&"grand sum"!==n[l].type)for(kt=0,di=u;kt<di.length;kt++)e=di[kt],"value"===(s=i[l+a][e]).axis&&s.actualText===w&&(tt.push([l+a,e]),f[l+a+","+e]&&delete f[l+a+","+e]);for(dt=0,gi=tt;dt<gi.length;dt++)o=(s=i[(e=gi[dt])[0]][e[1]]).actualValue-et[e[1]].actualValue,o=isNaN(o)||0===s.value&&0===et[e[1]].value?0:o,this.aggregatedValueMatrix[e[0]]||(this.aggregatedValueMatrix[e[0]]=[]),"DifferenceFrom"===wr?(this.aggregatedValueMatrix[e[0]][e[1]]=o,s.formattedText=0===o?this.emptyCellTextContent:this.getFormattedValue(o,w).formattedText):(o=0===et[e[1]].actualValue?0:o/et[e[1]].actualValue,this.aggregatedValueMatrix[e[0]][e[1]]=o,s.formattedText=0!==o?this.globalize.formatNumber(o,{format:"P",maximumFractionDigits:2}):this.emptyCellTextContent)}else{if(wi){for(ct=lt.split(this.valueSortSettings.headerDelimiter),nt=v.length,ut=0;ut<nt;ut++)if(b=!1,void 0!==v[ut]&&-1!==v[ut].valueSort.levelName.split(this.valueSortSettings.headerDelimiter).indexOf(ct[ct.length-1])&&v[ut].level===ft.level){for(gt=0,nr=ht;gt<nr.length;gt++)"value"===(s=i[e=nr[gt]][ut]).axis&&s.actualText===w&&(b=!0,tt.push([e,ut]),f[e+","+ut]&&delete f[e+","+ut]);if(b)break}}else for(ni=0,tr=st;ni<tr.length;ni++)for(d=tr[ni],nt=v.length,h=0;h<nt;h++)if(b=!1,void 0!==v[h]&&v[h].valueSort[d.valueSort.levelName]&&v[h].level===ft.level&&"grand sum"!==v[h].type){for(ti=0,ir=ht;ti<ir.length;ti++)"value"===(s=i[e=ir[ti]][h]).axis&&s.actualText===w&&(b=!0,tt.push([e,h]),f[e+","+h]&&delete f[e+","+h]);if(b)break}for(rr=void 0,0===it.length&&(rr=this.getSelectedColumn(p.uniqueName,t)),ii=0,ur=tt;ii<ur.length;ii++)s=i[(e=ur[ii])[0]][e[1]],ri=0,0===it.length?(ui=this.getSelectedRow(s.rowHeaders,n),ri=this.getAggregateValue(ui.index,rr.indexObject,this.fieldList[w].index,p.type)):ri=it[e[0]].value,o=s.value-ri,o=isNaN(o)?0:o,this.aggregatedValueMatrix[e[0]]||(this.aggregatedValueMatrix[e[0]]=[]),"DifferenceFrom"===wr?(s.formattedText=0===o?this.emptyCellTextContent:this.getFormattedValue(o,w).formattedText,this.aggregatedValueMatrix[e[0]][e[1]]=o):(o=0===it[e[0]].value?0:o/it[e[0]].value,s.formattedText=0!==o?this.globalize.formatNumber(o,{format:"P",maximumFractionDigits:2}):this.emptyCellTextContent,this.aggregatedValueMatrix[e[0]][e[1]]=o)}p.childMembers.length>0&&this.updateAggregates(n,t,i,p.childMembers,u,f);break;case"PercentageOfParentRowTotal":case"PercentageOfParentColumnTotal":case"PercentageOfParentTotal":if(yt){for(fi=0,fr=st;fi<fr.length;fi++)for(d=fr[fi],g=n.length,c=0;c<g;c++)if(void 0!==n[c]&&n[c].valueSort[d.valueSort.levelName]&&n[c].level===d.level)for(ei=0,er=u;ei<er.length;ei++)e=er[ei],"value"===(s=i[c+a][e]).axis&&s.actualText===w&&(tt.push([c+a,e]),f[c+a+","+e]&&delete f[c+a+","+e]);for(oi=0,or=tt;oi<or.length;oi++)s=i[(c=or[oi])[0]][c[1]],sr=0,sr=0===et.length&&ft?this.getAggregateValue(ft.index,t[c[1]-1].indexObject,this.fieldList[w].index,p.type):et[c[1]].actualValue,o=s.value/sr,o=isNaN(o)?0:o,s.formattedText=0!==o?this.globalize.formatNumber(o,{format:"P",maximumFractionDigits:2}):this.emptyCellTextContent,this.aggregatedValueMatrix[c[0]]||(this.aggregatedValueMatrix[c[0]]=[]),this.aggregatedValueMatrix[c[0]][c[1]]=o}else{for(si=0,hr=st;si<hr.length;si++)for(d=hr[si],nt=v.length,k=0;k<nt;k++)if(b=!1,void 0!==v[k]&&v[k].valueSort[d.valueSort.levelName]){for(hi=0,cr=ht;hi<cr.length;hi++)"value"===(s=i[e=cr[hi]][k]).axis&&s.actualText===w&&(b=!0,tt.push([e,k]),f[e+","+k]&&delete f[e+","+k]);if(b)break}for(lr=void 0,0===it.length&&(lr=this.getSelectedColumn(p.uniqueName,t)),ci=0,ar=tt;ci<ar.length;ci++)s=i[(c=ar[ci])[0]][c[1]],li=0,0===it.length?(ui=this.getSelectedRow(s.rowHeaders,n),li=this.getAggregateValue(ui.index,lr.indexObject,this.fieldList[w].index,p.type)):li=it[c[0]].value,ot=s.value/li,ot=isNaN(ot)?0:ot,s.formattedText=0!==ot?this.globalize.formatNumber(ot,{format:"P",maximumFractionDigits:2}):this.emptyCellTextContent,this.aggregatedValueMatrix[c[0]]||(this.aggregatedValueMatrix[c[0]]=[]),this.aggregatedValueMatrix[c[0]][c[1]]=ot}break;case"RunningTotals":if(yt){for(ai=0,vr=u;ai<vr.length;ai++)for(e=vr[ai],o=0,vi=0,yr=st;vi<yr.length;vi++)for(d=yr[vi],g=n.length,y=0;y<g;y++)if(void 0!==n[y]&&(s=i[y+a][e],void 0!==n[y]&&n[y].valueSort[d.valueSort.levelName]&&n[y].level===d.level&&"value"===s.axis&&s.actualText===w)){"grand sum"!==n[y].type&&(o+=s.value,s.formattedText=0===o&&s.actualValue&&0!==s.actualValue?"":this.getFormattedValue(o,w).formattedText,this.aggregatedValueMatrix[y+a]||(this.aggregatedValueMatrix[y+a]=[]),this.aggregatedValueMatrix[y+a][e]=o);f[y+a+","+e]&&delete f[y+a+","+e];break}}else for(g=n.length,l=0;l<g;l++)if(void 0!==n[l])for(o=0,yi=0,pr=st;yi<pr.length;yi++)for(d=pr[yi],nt=v.length,h=0;h<nt;h++)if(s=i[l+a][h],void 0!==v[h]&&v[h].valueSort[d.valueSort.levelName]&&"value"===s.axis&&s.actualText===w){"grand sum"!==v[h].type&&(o+=s.value,s.formattedText=this.getFormattedValue(o,w).formattedText,this.aggregatedValueMatrix[l+a]||(this.aggregatedValueMatrix[l+a]=[]),this.aggregatedValueMatrix[l+a][h]=o);f[l+a+","+h]&&delete f[l+a+","+h];break}}}},n.prototype.getSelectedColumn=function(n,t){for(var i,r={axis:"column",index:[],indexObject:{}},u=0,f=t;u<f.length;u++)i=f[u],i&&i.valueSort&&0===i.valueSort.levelName.indexOf(n)&&(r.index=r.index.concat(i.index).sort(function(n,t){return n-t}),r.indexObject=ci({},r.indexObject,i.indexObject));return r},n.prototype.getSelectedRow=function(n,t){for(var i,r=0,u=t;r<u.length;r++)if(i=u[r],i&&(i.valueSort&&i.valueSort.levelName===n||""===n&&"grand sum"===i.type))return i;return null},n.prototype.recursiveRowData=function(n,t,i,r,u,f,e,o,s,h,c){e||this.getTableData(t[r-s].members,t,i,r,u,f,h,c);this.pageSettings||(t[r-s].members=[])},n.prototype.updateRowData=function(n,t,i,u,f,e,o,s,h,c,l){var it=this.fieldList[this.values[f].name].index,y=this.fieldList[this.values[f].name].aggregateType,st=this.values[f].name,rt=[],v={},a=0,w=0,p,k,nt,et,d,ot,tt;switch(y){case"Index":for(var ut=["cVal","rTotalVal","cTotalVal","gTotalVal"],b=0,ft=0,ht=rt=[[n[e],t[o]],[n[e],l],[c,t[o]],[c,l]];ft<ht.length;ft++)p=ht[ft],v[ut[b]]=this.getAggregateValue(p[0].index,p[1].indexObject,it,y),b++;k=v.cVal*v.gTotalVal/(v.rTotalVal*v.cTotalVal);a=!(n[e].members.length>0)||(Object(r.isNullOrUndefined)(n[e].showSubTotals)||n[e].showSubTotals)&&this.showRowSubTotals&&this.showSubTotals?Object(r.isNullOrUndefined)(v.cVal)?v.cVal:isNaN(k)?0:k:void 0;w=Object(r.isNullOrUndefined)(v.cVal)?v.cVal:isNaN(k)?0:k;break;case"PercentageOfGrandTotal":case"PercentageOfColumnTotal":case"PercentageOfRowTotal":for((rt=[[n[e],t[o]]]).push("PercentageOfGrandTotal"===y?[c,l]:"PercentageOfColumnTotal"===y?[c,t[o]]:[n[e],l]),ut=["cVal","gTotalVal"],b=0,nt=0,et=rt;nt<et.length;nt++)p=et[nt],v[ut[b]]=this.getAggregateValue(p[0].index,p[1].indexObject,it,y),b++;d=v.cVal/v.gTotalVal;a=!(n[e].members.length>0)||(Object(r.isNullOrUndefined)(n[e].showSubTotals)||n[e].showSubTotals)&&this.showSubTotals&&this.showRowSubTotals?Object(r.isNullOrUndefined)(v.cVal)?v.cVal:isNaN(d)?0:d:void 0;w=Object(r.isNullOrUndefined)(v.cVal)?v.cVal:isNaN(d)?0:d;break;default:ot=this.getAggregateValue(n[e].index,t[o].indexObject,it,y);a=!(n[e].members.length>0)||(Object(r.isNullOrUndefined)(n[e].showSubTotals)||n[e].showSubTotals)&&this.showSubTotals&&this.showRowSubTotals?ot:void 0;w=ot}tt={fieldName:this.values[f].name,row:n[e],column:t[o],value:a,cellSets:this.getCellSet(this.rawIndexObject),rowCellType:n[e].hasChild&&n[e].isDrilled?"subTotal":"grand sum"===n[e].type?"grandTotal":"value",columnCellType:t[o].hasChild&&t[o].isDrilled?"subTotal":"grand sum"===t[o].type?"grandTotal":"value",aggregateType:y,skipFormatting:!1};this.getValueCellInfo&&this.getValueCellInfo(tt);a=tt.value;var lt=n[e].hasChild||t[o].hasChild||"grand sum"===n[e].type||"grand sum"===t[o].type,at="grand sum"===n[e].type||"grand sum"===t[o].type,ct=n[e].members.length>0&&(!Object(r.isNullOrUndefined)(n[e].showSubTotals)&&!n[e].showSubTotals||!this.showSubTotals||!this.showRowSubTotals),g=ct?"":void 0===a?this.emptyCellTextContent:"Count"===y||"DistinctCount"===y?a.toLocaleString():this.getFormattedValue(a,st).formattedText;!isNaN(a)&&!Object(r.isNullOrUndefined)(a)&&["PercentageOfGrandTotal","PercentageOfColumnTotal","PercentageOfRowTotal"].indexOf(y)>=0?g=this.globalize.formatNumber(a,{format:"P",maximumFractionDigits:2}):ct||!isNaN(a)||Object(r.isNullOrUndefined)(a)||-1===["PopulationStDev","SampleStDev","PopulationVar","SampleVar"].indexOf(y)||(g="#DIV/0!");g=tt.skipFormatting?Object(r.isNullOrUndefined)(a)?this.emptyCellTextContent:a.toString():g;u[i][s]=this.valueContent[h][s]={axis:"value",actualText:st,indexObject:this.isDrillThrough?this.rawIndexObject:{},rowHeaders:"grand sum"===n[e].type?"":n[e].valueSort.levelName,columnHeaders:"grand sum"===t[o].type?"":t[o].valueSort.levelName,formattedText:g,value:Object(r.isNullOrUndefined)(a)?0:a,actualValue:Object(r.isNullOrUndefined)(w)?0:w,rowIndex:i,colIndex:s,isSum:lt,isGrandSum:at};this.rawIndexObject={}},n.prototype.getCellSet=function(n){for(var i,r=[],t=0,u=Object.keys(n);t<u.length;t++)i=u[t],this.data[parseInt(i,10)]&&r.push(this.data[parseInt(i,10)]);return r},n.prototype.getHeaderData=function(n,t,i,u,f){for(var a,h,y,o,l,p,c,w=n.length,s=this.columns.length,v=this.valueSortSettings.headerText,e=0;e<w;e++){if(n[e].members.length&&this.getHeaderData(n[e].members,t,i,u,f),a=!0,(Object(r.isNullOrUndefined)(n[e].showSubTotals)||n[e].showSubTotals)&&this.showSubTotals&&this.showColumnSubTotals?t[u=t.length]=this.frameHeaderWithKeys(n[e]):(n[e].members.length>0?(this.removeCount++,a=!1):t[t.length]=this.frameHeaderWithKeys(n[e]),u=t.length-1),h=n[e].level,n[e].rowIndex=h,n[e].colIndex=u*f+f,i[h]||(i[h]=[],this.headerContent[h]={}),i[h][u*f+f]=this.headerContent[h][u*f+f]=this.frameHeaderWithKeys(n[e]),y=0===this.columns.length&&1===this.values.length,(this.isMutiMeasures||this.alwaysShowValueHeader||y)&&!this.valueAxis&&a)for(o=0;o<f;o++)l=this.values[o].caption?this.values[o].caption:this.values[o].name,p={axis:"column",actualText:this.values[o].name,formattedText:l,level:0,valueSort:{},colIndex:u*f+1+o,rowIndex:s},i[s]||(i[s]=[],this.headerContent[s]={}),i[s][u*f+1+o]=this.headerContent[s][u*f+1+o]=p,c=i[s][u*f+1+o].valueSort,c[n[e].valueSort.levelName+this.valueSortSettings.headerDelimiter+l]=1,c.levelName=n[e].valueSort.levelName+this.valueSortSettings.headerDelimiter+l,c&&c[v]&&(this.valueSortSettings.columnIndex=u*f+1+o);else n[e].valueSort&&n[e].valueSort[v]&&(this.valueSortSettings.columnIndex=u*f+1);this.pageSettings||(t[u].members=[])}},n.prototype.getAggregateValue=function(n,t,i,u){var a,h,o,y,b,et,k,d,l,v,ht;n.length;var f=0,e=0,it=0,p=!0,s=!1;if(u&&"count"===u.toLowerCase())for(;void 0!==n[f];)void 0!==t[n[f]]&&(s=!0,this.rawIndexObject[n[f]]=n[f],e+=Object(r.isNullOrUndefined)(this.valueMatrix[n[f]][i])?0:this.allowDataCompression?this.valueMatrix[n[f]][i]:1),f++;else if(u&&"distinctcount"===u.toLowerCase())for(a=[];void 0!==n[f];)void 0!==t[n[f]]&&(this.rawIndexObject[n[f]]=n[f],s=!0,h=this.data[n[f]][this.fields[i]],o=void 0,Object(r.isNullOrUndefined)(h)||(o=h.toString(),(0===a.length||a.length>0&&-1===a.indexOf(o))&&(e+=this.allowDataCompression&&"number"==typeof h?h:1,a.push(o)))),f++;else if(u&&"product"===u.toLowerCase())for(;void 0!==n[f];)void 0!==t[n[f]]&&(this.rawIndexObject[n[f]]=n[f],s=!0,o=this.valueMatrix[n[f]][i],Object(r.isNullOrUndefined)(o)?p&&(e=o):(e=p||Object(r.isNullOrUndefined)(e)?1:e,e*=o),p=!1),f++;else if(u&&-1!==["populationstdev","samplestdev","populationvar","samplevar"].indexOf(u.toLowerCase())){for(var c=0,rt=(h=0,[]),ut=0,ft=0,w=0;void 0!==n[f];)void 0!==t[n[f]]&&(s=!0,this.rawIndexObject[n[f]]=n[f],o=this.valueMatrix[n[f]][i],Object(r.isNullOrUndefined)(o)||(h+=o,rt.push(o),c++)),f++;if(c>0){for(ut=h/c,y=0,b=rt;y<b.length;y++)et=b[y],w+=Math.pow(et-ut,2);e=0===(ft=-1!==["populationstdev","samplestdev"].indexOf(u.toLowerCase())?Math.sqrt(w/("populationstdev"===u.toLowerCase()?c:c-1)):w/("populationvar"===u.toLowerCase()?c:c-1))?NaN:ft}else e=h}else if(u&&"min"===u.toLowerCase())for(k=!0,e=void 0;void 0!==n[f];)void 0!==t[n[f]]&&void 0!==this.valueMatrix[n[f]][i]&&(s=!0,this.rawIndexObject[n[f]]=n[f],Object(r.isNullOrUndefined)(e)&&Object(r.isNullOrUndefined)(this.valueMatrix[n[f]][i])?e=this.valueMatrix[n[f]][i]:k?(e=this.valueMatrix[n[f]][i],k=!1):e=this.valueMatrix[n[f]][i]<e?this.valueMatrix[n[f]][i]:e),f++;else if(u&&"max"===u.toLowerCase())for(d=!0;void 0!==n[f];)void 0!==t[n[f]]&&void 0!==this.valueMatrix[n[f]][i]&&(s=!0,this.rawIndexObject[n[f]]=n[f],d?(e=this.valueMatrix[n[f]][i],d=!1):e=this.valueMatrix[n[f]][i]>e?this.valueMatrix[n[f]][i]:e),f++;else if(u&&"calculatedfield"===u.toLowerCase())for(;void 0!==n[f];){if(void 0!==t[n[f]]){s=!0;this.rawIndexObject[n[f]]=n[f];var g=this.calculatedFields[this.fields[i]],nt=g.formula,ot={};if(this.calculatedFormulas[g.name])for(var st=this.calculatedFormulas[g.name],tt=0,ct=st.length;tt<ct;tt++)l=st[tt],v=ot[l.formula],void 0===v&&(ht=l.type,v=this.getAggregateValue(n,t,l.index,ht),ot[l.formula]=v),nt=nt.replace(l.formula,String(v));(e=this.evaluate(nt))===1/0||void 0===e||isNaN(e)||JSON.parse(String(e))}f++}else for(e=void 0;void 0!==n[f];)void 0!==t[n[f]]&&(s=!0,this.rawIndexObject[n[f]]=n[f],o=this.valueMatrix[n[f]][i],Object(r.isNullOrUndefined)(e)&&Object(r.isNullOrUndefined)(o)?e=o:(Object(r.isNullOrUndefined)(e)&&(e=0),e+=Object(r.isNullOrUndefined)(o)?0:o),Object(r.isNullOrUndefined)(o)||it++),f++;return u&&"avg"===u.toLowerCase()&&0!==e&&!Object(r.isNullOrUndefined)(e)?e/it:s?e:void 0},n.prototype.evaluate=function(n){return Function('"use strict";return ('+n+")")()},n.prototype.getFormattedValue=function(n,t){var f=null===n?this.localeObj?this.localeObj.getConstant("null"):String(n):void 0===n?this.localeObj?t in this.groupingFields?this.localeObj.getConstant("groupOutOfRange"):this.localeObj.getConstant("undefined"):String(n):n,i={formattedText:f.toString(),actualText:f,dateText:f},e,u,o;if(this.formatFields[t]&&n)try{e=this.formatFields[t].properties?this.formatFields[t].properties:this.formatFields[t];u=Object(r.extend)({},e,null,!0);(delete u.name,!u.minimumSignificantDigits&&u.minimumSignificantDigits<1&&delete u.minimumSignificantDigits,!u.maximumSignificantDigits&&u.maximumSignificantDigits<1&&delete u.maximumSignificantDigits,u.type)?i.formattedText=this.dateFormatFunction[t].exactFormat(new Date(n)):((delete u.type,u.format&&!this.formatRegex.test(u.format))&&(o=u.format.match(this.customRegex)[6],u.useGrouping=-1!==o.indexOf(",")),i.formattedText=this.globalize.formatNumber(n,u));i.actualText=n;"None"!==this.fieldList[t].sort&&u.type&&["date","dateTime","time"].indexOf(this.formatFields[t].type)>-1&&(i.dateText=this.dateFormatFunction[t].fullFormat(new Date(n)));this.fieldList[t].isCustomField&&(i.formattedText="NaN"===i.formattedText?f.toString():i.formattedText,i.dateText="NaN"===i.dateText?f.toString():i.dateText)}catch(n){if(!this.fieldList[t].isCustomField)throw n;}finally{this.fieldList[t].isCustomField&&(i.formattedText=Object(r.isNullOrUndefined)(i.formattedText)||"NaN"===i.formattedText?f.toString():i.formattedText,i.dateText=Object(r.isNullOrUndefined)(i.dateText)||"NaN"===i.dateText?f.toString():i.dateText)}return i},n.prototype.powerFunction=function(n){if(n.indexOf("^")>-1){for(var t=[];n.indexOf("(")>-1;)n=n.replace(/(\([^\(\)]*\))/g,function(n,i){return t.push(i),"~"+(t.length-1)});for(t.push(n),n="~"+(t.length-1);n.indexOf("~")>-1;)n=n.replace(new RegExp("~(\\d+)","g"),function(n,i){return t[i].replace(/(\w*)\^(\w*)/g,"Math.pow($1,$2)")})}return n},n}(),p=i(4),ft="ui-update",st="content-ready",ct="data-ready",oi="e-pivotfieldlist",et="e-rtl",vt="e-device",h="e-icons",pt="e-collapse",wt="e-expand",bt="e-table",ti="e-pivot-calc-input",ii="e-flat",lt="e-format",kt="e-pivot-formula",ut="e-menu-hide",si="e-input",d="e-cellselectionbackground",k="e-selectionbackground",it="e-pivotchart",c=i(3),rt=i(8),b=i(6),a=i(2),ai=function(){function n(n){this.menuInfo=[];this.parent=n}return n.prototype.render=function(n,t){this.parentElement=t;this.openContextMenu(n)},n.prototype.openContextMenu=function(n){var t=this,r=n.target.parentElement.id,i="number"!==this.parent.engineModule.fieldList[r].type?1:0,u;this.summaryTypes=this.getMenuItem(i).slice();u={cancel:!1,fieldName:r,aggregateTypes:this.summaryTypes};("pivotfieldlist"===this.parent.getModuleName()&&this.parent.isPopupView?this.parent.pivotGridModule:this.parent).trigger("aggregateMenuOpen",u,function(r){if(!r.cancel){t.summaryTypes=r.aggregateTypes;t.createContextMenu(i);t.currentMenu=n.currentTarget;var u=t.currentMenu.getBoundingClientRect();t.parent.enableRtl?t.menuInfo[i].open(u.top+(window.scrollY||document.documentElement.scrollTop),u.left-105):t.menuInfo[i].open(u.top+(window.scrollY||document.documentElement.scrollTop),u.left)}})},n.prototype.createContextMenu=function(n){var i=[],o,f,e,t,u;for(i[n]=[],this.menuInfo[n]&&!this.menuInfo[n].isDestroyed&&this.menuInfo[n].destroy(),f=[],e=0;e<this.summaryTypes.length;e++)t=this.summaryTypes[e],n?["Count","DistinctCount"].indexOf(t)>-1&&f.indexOf(t)<0&&(i[n].push({text:this.parent.localeObj.getConstant(t),id:this.parent.element.id+"StringMenu_"+t}),f.push(t)):this.parent.getAllSummaryType().indexOf(t)>-1&&f.indexOf(t)<0&&(i[n].push({text:this.parent.localeObj.getConstant(t),id:this.parent.element.id+"_"+t}),f.push(t));i[n].length>=7&&(i[n].splice(7),i[n].push({text:this.parent.localeObj.getConstant("MoreOption"),id:this.parent.element.id+"_MoreOption"}));o={items:i[n],enableRtl:this.parent.enableRtl,beforeOpen:this.beforeMenuOpen.bind(this,n),select:this.selectOptionInContextMenu.bind(this)};u=document.getElementById(this.parent.element.id+(n?"valueFieldStringContextMenu":"valueFieldContextMenu"));null!==u?u.innerHTML="":u=Object(r.createElement)("ul",{id:this.parent.element.id+(n?"valueFieldStringContextMenu":"valueFieldContextMenu")});this.parent.element.appendChild(u);this.menuInfo[n]=new rt.ContextMenu(o);this.menuInfo[n].isStringTemplate=!0;this.menuInfo[n].appendTo(u)},n.prototype.getMenuItem=function(n){for(var t,i=[],r=0;r<this.parent.aggregateTypes.length;r++)t=this.parent.aggregateTypes[r],n?["Count","DistinctCount"].indexOf(t)>-1&&-1===i.indexOf(t)&&i.push(t):this.parent.getAllSummaryType().indexOf(t)>-1&&-1===i.indexOf(t)&&i.push(t);return i},n.prototype.beforeMenuOpen=function(n,t){t.element.style.zIndex=(this.menuInfo[n].element.style.zIndex+3).toString();t.element.style.display="inline"},n.prototype.createValueSettingsDialog=function(n,t,i){var f=this,u;this.parentElement=t;u=Object(r.createElement)("div",{id:this.parentElement.id+"_ValueDialog",className:"e-value-field-settings",attrs:{"data-field":n.id}});this.parentElement.appendChild(u);this.valueDialog=new p.Dialog({animationSettings:{effect:"Fade"},allowDragging:!0,header:this.parent.localeObj.getConstant("valueFieldSettings"),content:this.createFieldOptions(n,i),isModal:!0,visible:!0,showCloseIcon:!0,enableRtl:this.parent.enableRtl,width:"auto",height:"auto",position:{X:"center",Y:"center"},buttons:[{click:this.updateValueSettings.bind(this),buttonModel:{cssClass:"e-ok-btn",content:this.parent.localeObj.getConstant("ok"),isPrimary:!0}},{click:function(){f.valueDialog.hide()},buttonModel:{cssClass:"e-cancel-btn",content:this.parent.localeObj.getConstant("cancel")}}],closeOnEscape:!0,target:this.parentElement,overlayClick:function(){f.removeDialog()},close:this.removeDialog.bind(this)});this.valueDialog.isStringTemplate=!0;this.valueDialog.appendTo(u)},n.prototype.createFieldOptions=function(n,t){var ft=n.getAttribute("data-caption"),e=t&&"MoreOption"!==t?t:n.getAttribute("data-type"),u=n.getAttribute("data-basefield"),c=n.getAttribute("data-baseitem"),it,rt,y,i,ut;e="undefined"!==e.toString()?e:"Sum";for(var et=[],s=this.parent.aggregateTypes,ot=[],o=0;o<s.length;o++)this.parent.getAllSummaryType().indexOf(s[o])>-1&&ot.indexOf(s[o])<0&&(et.push({value:s[o],text:this.parent.localeObj.getConstant(s[o])}),ot.push(s[o]));var st=["DifferenceFrom","PercentageOfDifferenceFrom"],ht=["DifferenceFrom","PercentageOfDifferenceFrom","PercentageOfParentTotal"],p=Object(r.extend)([],this.parent.dataSourceSettings.rows,null,!0);p=p.concat(this.parent.dataSourceSettings.columns);for(var l=[],f=[],w=0,ct=p;w<ct.length;w++){var v=ct[w],wt=v.name,bt=v.caption?v.caption:v.name;l.push({value:wt,text:bt})}u=u&&"undefined"!==u.toString()&&"null"!==u.toString()?u:l[0].value;f=Object.keys(this.parent.engineModule.fieldList["undefined"!==u.toString()?u:l[0].value].formattedMembers);c="undefined"!==c.toString()?c:f[0];var lt=Object(r.createElement)("div",{className:"e-value-field-div-content",id:this.parentElement.id+"_field_div_content",attrs:{"data-type":e,"data-caption":ft,"data-basefield":u,"data-baseitem":c}}),k=Object(r.createElement)("div",{className:"e-field-name-text-wrapper"}),h=Object(r.createElement)("div",{className:"e-field-option-wrapper"}),d=Object(r.createElement)("div",{className:"e-type-option-wrapper"}),g=Object(r.createElement)("div",{className:"e-base-field-option-wrapper"}),nt=Object(r.createElement)("div",{className:"e-base-item-option-wrapper"}),kt=Object(r.createElement)("div",{className:"e-field-name-title",innerHTML:this.parent.localeObj.getConstant("sourceName")+"&nbsp;"}),dt=Object(r.createElement)("div",{className:"e-field-name-content",innerHTML:n.id.toString()}),gt=Object(r.createElement)("div",{className:"e-type-option-text",innerHTML:this.parent.localeObj.getConstant("sourceCaption")}),ni=Object(r.createElement)("div",{className:"e-base-field-option-text",innerHTML:this.parent.localeObj.getConstant("summarizeValuesBy")}),ti=Object(r.createElement)("div",{className:"e-base-item-option-text",innerHTML:this.parent.localeObj.getConstant("baseField")}),ii=Object(r.createElement)("div",{className:"e-type-option-text",innerHTML:this.parent.localeObj.getConstant("baseItem")}),tt=Object(r.createElement)("div",{className:"e-caption-input-wrapper"}),at=Object(r.createElement)("div",{id:this.parentElement.id+"_type_option"}),vt=Object(r.createElement)("div",{id:this.parentElement.id+"_base_field_option"}),yt=Object(r.createElement)("div",{id:this.parentElement.id+"_base_item_option"}),pt=Object(r.createElement)("input",{id:this.parentElement.id+"type_input_option",className:"e-caption-input-text",attrs:{type:"text"}});return k.appendChild(kt),k.appendChild(dt),tt.appendChild(gt),tt.appendChild(pt),d.appendChild(ni),g.appendChild(ti),nt.appendChild(ii),d.appendChild(at),g.appendChild(vt),nt.appendChild(yt),h.appendChild(k),h.appendChild(tt),h.appendChild(d),h.appendChild(g),h.appendChild(nt),lt.appendChild(h),it=this,rt=new a.DropDownList({dataSource:et,enableRtl:this.parent.enableRtl,fields:{value:"value",text:"text"},value:e,cssClass:"e-value-options",width:"100%",change:function(n){y.enabled=-1!==ht.indexOf(n.value);i.enabled=-1!==st.indexOf(n.value);i.enabled&&1===i.dataSource.length&&(i.dataSource=f,i.refresh())}}),rt.isStringTemplate=!0,rt.appendTo(at),y=new a.DropDownList({dataSource:l,enableRtl:this.parent.enableRtl,fields:{value:"value",text:"text"},value:u,enabled:-1!==ht.indexOf(e),cssClass:"e-value-options",width:"100%",change:function(n){f=Object.keys(it.parent.engineModule.fieldList[n.value].formattedMembers);i.dataSource=f;i.value=f[0];i.filterBarPlaceholder=it.parent.localeObj.getConstant("example")+" "+f[0];i.refresh()}}),y.isStringTemplate=!0,y.appendTo(vt),i=new a.DropDownList({dataSource:[f[0]],enableRtl:this.parent.enableRtl,value:c,allowFiltering:!0,filterBarPlaceholder:this.parent.localeObj.getConstant("example")+" "+f[0],enabled:-1!==st.indexOf(e),cssClass:"e-filter-operator",width:"100%"}),i.isStringTemplate=!0,i.appendTo(yt),ut=new b.MaskedTextBox({placeholder:"Enter field caption",enableRtl:this.parent.enableRtl,value:ft,width:"100%"}),ut.isStringTemplate=!0,ut.appendTo(pt),lt},n.prototype.selectOptionInContextMenu=function(n){var u,t,i,e;if(null!==n.item.text)if(u=this.currentMenu.parentElement,t=n.item.id.split("_").pop(),"MoreOption"===t||"PercentageOfDifferenceFrom"===t||"PercentageOfParentTotal"===t||"DifferenceFrom"===t)this.createValueSettingsDialog(u,this.parentElement,t);else{var o=u.getAttribute("data-uid"),f=this.parent.dataSourceSettings.values,s=u.querySelector(".e-content"),h=n.item.text+" "+this.parent.localeObj.getConstant("of")+" "+this.parent.engineModule.fieldList[o].caption;for(s.innerHTML=h,s.setAttribute("title",h),u.setAttribute("data-type",t),i=0;i<this.parent.dataSourceSettings.values.length;i++)this.parent.dataSourceSettings.values[i].name===o&&(e=Object(r.extend)({},f[i].properties?f[i].properties:f[i],null,!0),e.type=t,this.parent.engineModule.fieldList[o].aggregateType=t,f.splice(i,1,e),this.parent.lastAggregationInfo=e);this.updateDataSource()}},n.prototype.updateDataSource=function(n){this.parent.allowDeferLayoutUpdate&&"pivotview"!==this.parent.getModuleName()?"pivotfieldlist"===this.parent.getModuleName()&&"Popup"===this.parent.renderMode?(this.parent.pivotGridModule.setProperties({dataSourceSettings:this.parent.dataSourceSettings.properties},!0),this.parent.pivotGridModule.notify(ft,this),this.parent.pivotGridModule.engineModule=this.parent.engineModule):this.parent.triggerPopulateEvent():this.parent.updateDataSource(n)},n.prototype.updateValueSettings=function(){var t,l=this.valueDialog.element,i=Object(r.getInstance)("#"+this.parentElement.id+"type_input_option",b.MaskedTextBox),u=Object(r.getInstance)("#"+this.parentElement.id+"_type_option",a.DropDownList),s=Object(r.getInstance)("#"+this.parentElement.id+"_base_field_option",a.DropDownList),h=Object(r.getInstance)("#"+this.parentElement.id+"_base_item_option",a.DropDownList),c=l.getAttribute("data-field"),f,o,n;(this.parentElement.querySelector(".e-pivot-button")&&(t=this.parentElement.querySelector(".e-pivot-button."+c.replace(/[^A-Z0-9]/gi,""))),t)&&(f=t.querySelector(".e-content"),o=this.parent.localeObj.getConstant(u.value)+" "+this.parent.localeObj.getConstant("of")+" "+i.value,f.innerHTML=o,f.setAttribute("title",o),t.setAttribute("data-type",u.value),t.setAttribute("data-caption",i.value),t.setAttribute("data-basefield",s.value),t.setAttribute("data-baseitem",h.value));n=e.getFieldByName(c,this.parent.dataSourceSettings.values);(n=n.properties?n.properties:n).caption=i.value;n.type=u.value;n.baseField=s.value;n.baseItem=h.value;this.valueDialog.close();this.parent.lastAggregationInfo=n;this.updateDataSource(!0)},n.prototype.removeDialog=function(){this.valueDialog&&!this.valueDialog.isDestroyed&&this.valueDialog.destroy();document.getElementById(this.parentElement.id+"_ValueDialog")&&Object(r.remove)(document.getElementById(this.parentElement.id+"_ValueDialog"))},n.prototype.destroy=function(){this.parent.isDestroyed||this.menuInfo&&(void 0===this.menuInfo[1]||this.menuInfo[1].isDestroyed||this.menuInfo[1].destroy(),void 0===this.menuInfo[0]||this.menuInfo[0].isDestroyed||this.menuInfo[0].destroy())},n}(),vi=function(){function n(n){this.indentCollection={};this.colPos=0;this.lastSpan=0;this.lvlCollection={};this.hierarchyCollection={};this.lvlPosCollection={};this.hierarchyPosCollection={};this.position=0;this.measurePos=0;this.maxMeasurePos=0;this.hierarchyCount=0;this.actualText="";this.parent=n;this.resColWidth=this.parent.showGroupingBar&&this.parent.groupingBarModule?this.parent.isAdaptive?180:250:this.parent.isAdaptive?140:200;this.engine="olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule;this.gridSettings=n.gridSettings;this.formatList=this.getFormatList();this.aggMenu=new ai(this.parent)}return n.prototype.render=function(){var t=this.parent,n="olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule;(this.parent.gridHeaderCellInfo=[],this.parent.gridCellCollection={},this.injectGridModules(t),this.rowStartPos=this.getRowStartPos(),this.parent.grid&&this.parent.grid.element&&this.parent.element.querySelector(".e-grid"))?(n.isEngineUpdated?(this.parent.enableValueSorting&&(n.valueContent=this.frameDataSource("value")),n.isEngineUpdated=!1):(n.headerContent=this.frameDataSource("header"),n.valueContent=this.frameDataSource("value")),this.parent.grid.setProperties({columns:this.frameStackedHeaders(),dataSource:("olap"===this.parent.dataType||t.dataSourceSettings.values.length>0)&&!this.engine.isEmptyData?n.valueContent:this.frameDataSource("value")},!0),this.parent.grid.notify("datasource-modified",{}),this.parent.isScrolling&&(this.parent.resizeInfo={}),this.parent.grid.refreshColumns(),this.parent.showGroupingBar&&this.parent.groupingBarModule&&this.parent.element.querySelector(".e-grouping-bar")&&this.parent.groupingBarModule.setGridRowWidth(),this.parent.element.querySelector(".e-movablecontent").querySelector("colGroup").innerHTML=this.parent.grid.getHeaderContent().querySelector(".e-movableheader").querySelector("colgroup").innerHTML,this.parent.grid.width=this.calculateGridWidth(),this.parent.isScrolling||this.calculateGridHeight(!0)):(this.parent.element.innerHTML="",this.bindGrid(this.parent,!!this.engine.isEmptyData),this.parent.element.appendChild(Object(r.createElement)("div",{id:this.parent.element.id+"_grid"})),this.parent.grid.isStringTemplate=!0,this.parent.grid.appendTo("#"+this.parent.element.id+"_grid"));this.parent.grid.on(c.headerRefreshed,this.refreshHeader,this)},n.prototype.refreshHeader=function(){if(this.parent.enableVirtualization){var n=this.parent.element.querySelector(".e-movableheader"),t=this.parent.element.querySelector(".e-movablecontent"),i=t.querySelector(".e-virtualtrack");this.parent.virtualHeaderDiv=n.querySelector(".e-virtualtrack");n.querySelector(".e-virtualtrack")?Object(r.remove)(n.querySelector(".e-virtualtrack")):this.parent.virtualHeaderDiv=Object(r.createElement)("div",{className:"e-virtualtrack"});n.appendChild(this.parent.virtualHeaderDiv);i&&Object(r.setStyleAttribute)(this.parent.virtualHeaderDiv,{height:0,width:i.style.width});Object(r.setStyleAttribute)(n.querySelector(".e-table"),{transform:t.querySelector(".e-table").style.transform.split(",")[0]+",0px)"});n.scrollLeft=t.scrollLeft}},n.prototype.bindGrid=function(n,t){(this.injectGridModules(n),this.parent.grid=new c.Grid({frozenColumns:1,frozenRows:0,enableHover:!1,dataSource:t?this.frameEmptyData():this.frameDataSource("value"),columns:t?this.frameEmptyColumns():this.frameStackedHeaders(),height:t?"auto":this.calculateGridHeight(),width:t?this.parent.width:this.calculateGridWidth(),locale:n.locale,enableRtl:n.enableRtl,allowExcelExport:n.allowExcelExport,allowPdfExport:n.allowPdfExport,allowResizing:this.gridSettings.allowResizing,allowTextWrap:this.gridSettings.allowTextWrap,allowReordering:!this.parent.showGroupingBar&&this.gridSettings.allowReordering,allowSelection:this.gridSettings.allowSelection,contextMenuItems:this.gridSettings.contextMenuItems,selectedRowIndex:this.gridSettings.selectedRowIndex,selectionSettings:this.gridSettings.selectionSettings,textWrapSettings:this.gridSettings.textWrapSettings,printMode:this.gridSettings.printMode,rowHeight:this.gridSettings.rowHeight,gridLines:this.gridSettings.gridLines,contextMenuClick:this.contextMenuClick.bind(this),contextMenuOpen:this.contextMenuOpen.bind(this),beforeCopy:this.gridSettings.beforeCopy?this.gridSettings.beforeCopy.bind(this.parent):void 0,beforePrint:this.gridSettings.beforePrint?this.gridSettings.beforePrint.bind(this.parent):void 0,printComplete:this.gridSettings.printComplete?this.gridSettings.printComplete.bind(this.parent):void 0,rowSelecting:this.gridSettings.rowSelecting?this.gridSettings.rowSelecting.bind(this.parent):void 0,rowSelected:this.rowSelected.bind(this),rowDeselecting:this.gridSettings.rowDeselecting?this.gridSettings.rowDeselecting.bind(this.parent):void 0,rowDeselected:this.rowDeselected.bind(this),cellSelecting:this.gridSettings.cellSelecting?this.gridSettings.cellSelecting.bind(this.parent):void 0,cellSelected:this.cellSelected.bind(this),cellDeselecting:this.gridSettings.cellDeselecting?this.gridSettings.cellDeselecting.bind(this.parent):void 0,cellDeselected:this.cellDeselected.bind(this),resizeStart:this.gridSettings.resizeStart?this.gridSettings.resizeStart.bind(this.parent):void 0,columnDragStart:this.gridSettings.columnDragStart?this.gridSettings.columnDragStart.bind(this):void 0,columnDrag:this.gridSettings.columnDrag?this.gridSettings.columnDrag.bind(this):void 0,columnDrop:this.gridSettings.columnDrop?this.gridSettings.columnDrop.bind(this):void 0,beforeExcelExport:this.beforeExcelExport.bind(this),resizing:this.setGroupWidth.bind(this),resizeStop:this.onResizeStop.bind(this),queryCellInfo:this.queryCellInfo.bind(this),dataBound:this.dataBound.bind(this),headerCellInfo:this.headerCellInfo.bind(this),excelHeaderQueryCellInfo:this.excelHeaderQueryCellInfo.bind(this),pdfHeaderQueryCellInfo:this.pdfHeaderQueryCellInfo.bind(this),excelQueryCellInfo:this.excelQueryCellInfo.bind(this),pdfQueryCellInfo:this.pdfQueryCellInfo.bind(this),beforePdfExport:this.gridSettings.beforePdfExport?this.gridSettings.beforePdfExport.bind(this):void 0}),Object(r.isBlazor)())&&(this.parent.grid.isJsComponent=!0);this.parent.grid.on("header-refreshed",this.headerRefreshed.bind(this))},n.prototype.headerRefreshed=function(){this.parent.lastGridSettings&&Object.keys(this.parent.lastGridSettings).indexOf("allowResizing")>-1&&(this.parent.lastGridSettings=void 0,this.parent.showGroupingBar&&this.parent.groupingBarModule&&this.parent.element.querySelector(".e-grouping-bar")&&this.parent.groupingBarModule.setGridRowWidth())},n.prototype.beforeExcelExport=function(n){Object(r.isNullOrUndefined)(n.gridObject.columns)||Object(r.isNullOrUndefined)(this.parent.pivotColumns)||(n.gridObject.columns[n.gridObject.columns.length-1].width=this.parent.pivotColumns[this.parent.pivotColumns.length-1].width);this.parent.trigger("beforeExcelExport",n)},n.prototype.rowSelected=function(n){this.parent.renderModule.selected();this.parent.trigger("rowSelected",n)},n.prototype.rowDeselected=function(n){this.parent.renderModule.selected();this.parent.trigger("rowDeselected",n)},n.prototype.cellSelected=function(n){this.parent.rowRangeSelection.enable?(this.parent.grid.selectionModule.selectRowsByRange(this.parent.rowRangeSelection.startIndex,this.parent.rowRangeSelection.endIndex),this.parent.rowRangeSelection.enable=!1):(this.parent.renderModule.selected(),this.parent.trigger("selected",n))},n.prototype.cellSelecting=function(n){this.parent.trigger("cellSelecting",n)},n.prototype.cellDeselected=function(n){this.parent.renderModule.selected();this.parent.trigger("cellDeselected",n)},n.prototype.queryCellInfo=function(n){this.parent.renderModule.rowCellBoundEvent(n)},n.prototype.headerCellInfo=function(n){this.parent.renderModule.columnCellBoundEvent(n)},n.prototype.excelHeaderQueryCellInfo=function(n){this.parent.renderModule.excelColumnEvent(n)},n.prototype.pdfQueryCellInfo=function(n){this.parent.renderModule.pdfRowEvent(n)},n.prototype.excelQueryCellInfo=function(n){this.parent.renderModule.excelRowEvent(n)},n.prototype.pdfHeaderQueryCellInfo=function(n){this.parent.renderModule.pdfColumnEvent(n)},n.prototype.dataBound=function(){var t,u,i,n;if(this.parent.cellTemplate&&!Object(r.isBlazor)()){for(t=0,u=this.parent.gridHeaderCellInfo;t<u.length;t++)i=u[t],this.parent.cellTemplate&&(n=this.parent.getCellTemplate()(i,this.parent,"cellTemplate",this.parent.element.id+"_cellTemplate"),n&&""!==n&&n.length>0&&(this.parent.enableHtmlSanitizer?this.parent.appendHtml(i.targetCell,r.SanitizeHtmlHelper.sanitize(n[0].outerHTML)):this.parent.appendHtml(i.targetCell,n[0].outerHTML)));this.parent.gridHeaderCellInfo=[]}this.parent.element.querySelector(".e-firstcell")&&(this.parent.enableRtl?this.parent.element.querySelector(".e-firstcell").style.borderRight="none":this.parent.element.querySelector(".e-firstcell").style.borderLeft="none");this.parent.grid&&this.parent.grid.widthService&&this.parent.grid.widthService.setWidthToTable();this.parent.isEmptyGrid||this.calculateGridHeight(!0);"Chart"!==this.parent.currentView&&this.parent.grid.hideScroll();this.parent.isScrolling=!1;this.parent.notify(st,{})},n.prototype.contextMenuOpen=function(n){for(var f,i=this,s=function(u){var o=t.parent.lastCellClicked,f=null,a=void 0,l=void 0,c,y,d,w,g;if(o.classList.contains("e-stackedheadercelldiv")||o.classList.contains("e-cellvalue")||o.classList.contains("e-headercelldiv")||o.classList.contains("e-icons")||o.classList.contains("e-rhandler")?f=o.parentElement:o.classList.contains("e-headercell")||o.classList.contains("e-rowcell")||o.classList.contains("e-columnsheader")||o.classList.contains("e-rowsheader")||o.classList.contains("e-valuescontent")||o.classList.contains("e-valuesheader")?f=o:o.classList.contains("e-headertext")&&(f=o.parentElement.parentElement),!f)return n.cancel=!0,{value:void 0};(f.classList.contains("e-valuesheader")||f.classList.contains("e-stot"))&&(a=!0);t.parent.allowGrouping&&t.parent.groupingModule&&!t.validateField(f)&&(l=!0);var nt=Number(f.getAttribute("index")),tt=Number(f.getAttribute("aria-colindex")),b=t.parent.pivotValues[nt][tt];switch(u.id){case t.parent.element.id+"_expand":f.querySelectorAll("."+wt).length>0?(n.element.querySelectorAll("#"+t.parent.element.id+"_expand")&&n.element.querySelector("#"+t.parent.element.id+"_expand").classList.add("e-disabled"),n.element.querySelector("#"+t.parent.element.id+"_expand").classList.contains("e-disabled")&&n.element.querySelector("#"+t.parent.element.id+"_expand").classList.remove("e-disabled"),n.element.querySelector("#"+t.parent.element.id+"_expand").classList.contains(ut)&&(n.element.querySelector("#"+t.parent.element.id+"_expand").classList.remove(ut),n.element.querySelector("#"+t.parent.element.id+"_collapse").classList.remove(ut))):a?n.element.querySelector("#"+t.parent.element.id+"_expand").classList.add(ut):n.element.querySelector("#"+t.parent.element.id+"_expand").classList.add("e-disabled");break;case t.parent.element.id+"_collapse":f.querySelectorAll("."+pt).length>0?(n.element.querySelector("#"+t.parent.element.id+"_expand")&&n.element.querySelector("#"+t.parent.element.id+"_expand").classList.add("e-disabled"),n.element.querySelector("#"+t.parent.element.id+"_collapse").classList.contains("e-disabled")&&n.element.querySelector("#"+t.parent.element.id+"_collapse").classList.remove("e-disabled"),n.element.querySelector("#"+t.parent.element.id+"_collapse").classList.contains(ut)&&(n.element.querySelector("#"+t.parent.element.id+"_collapse").classList.remove(ut),n.element.querySelector("#"+t.parent.element.id+"_expand").classList.remove(ut))):a?n.element.querySelector("#"+t.parent.element.id+"_collapse").classList.add(ut):n.element.querySelector("#"+t.parent.element.id+"_collapse").classList.add("e-disabled");break;case t.parent.element.id+"_custom_group":l||2!==n.items.length||(n.cancel=!0);n.element.querySelectorAll("#"+t.parent.element.id+"_custom_group")&&Object(r.addClass)([n.element.querySelector("#"+t.parent.element.id+"_custom_group")],ut);l&&n.element.querySelectorAll("#"+t.parent.element.id+"_custom_group")&&Object(r.removeClass)([n.element.querySelector("#"+t.parent.element.id+"_custom_group")],ut);break;case t.parent.element.id+"_custom_ungroup":if(n.element.querySelectorAll("#"+t.parent.element.id+"_custom_ungroup")&&Object(r.addClass)([n.element.querySelector("#"+t.parent.element.id+"_custom_ungroup")],ut),l){var v=!1,s=f.getAttribute("fieldname"),h=e.getFieldByName(s,t.parent.dataSourceSettings.groupSettings);if(h&&"Custom"===h.type||t.parent.engineModule.fieldList[s].isCustomField&&s.indexOf("_custom_group")>-1){if(h=e.getFieldByName(s.replace("_custom_group",""),t.parent.dataSourceSettings.groupSettings)){c=t.parent.engineModule.pivotValues[Number(f.getAttribute("index"))][Number(f.getAttribute("aria-colindex"))];y=t.parent.groupingModule.getSelectedCells(c.axis,s,c.actualText.toString());y.push({axis:c.axis,fieldName:s,name:c.actualText.toString(),cellInfo:c});for(var it=t.parent.groupingModule.getSelectedOptions(y),p=0,k=h.customGroups;p<k.length;p++)if(d=k[p],it.indexOf(d.groupName)>-1){v=!0;break}}}else(h&&("Date"===h.type||"Number"===h.type)||t.parent.engineModule.fieldList[s].isCustomField&&s.indexOf("_date_group")>-1)&&(v=!0);n.element.querySelectorAll("#"+t.parent.element.id+"_custom_ungroup")&&v&&Object(r.removeClass)([n.element.querySelector("#"+t.parent.element.id+"_custom_ungroup")],ut)}break;case t.parent.element.id+"_drillthrough":t.parent.allowDrillThrough?f.classList.contains("e-summary")?n.element.querySelector("#"+t.parent.element.id+"_drillthrough").classList.contains("e-disabled")&&n.element.querySelector("#"+t.parent.element.id+"_drillthrough").classList.remove("e-disabled"):""===f.innerText&&n.element.querySelector("#"+t.parent.element.id+"_drillthrough")&&n.element.querySelector("#"+t.parent.element.id+"_drillthrough").classList.add("e-disabled"):n.element.querySelector("#"+t.parent.element.id+"_drillthrough")&&n.element.querySelector("#"+t.parent.element.id+"_drillthrough").classList.add("e-disabled");break;case t.parent.element.id+"_sortasc":t.parent.enableValueSorting?f.querySelectorAll(".e-icon-descending").length>0?(n.element.querySelector("#"+t.parent.element.id+"_sortdesc")?n.element.querySelector("#"+t.parent.element.id+"_sortdesc").classList.add("e-disabled"):n.element.querySelector("#"+t.parent.element.id+"_sortdesc").classList.remove("e-disabled"),n.element.querySelector("#"+t.parent.element.id+"_sortasc").classList.contains("e-disabled")&&n.element.querySelector("#"+t.parent.element.id+"_sortasc").classList.remove("e-disabled")):n.element.querySelector("#"+t.parent.element.id+"_sortdesc").classList.contains("e-disabled")&&n.element.querySelector("#"+t.parent.element.id+"_sortdesc").classList.remove("e-disabled"):n.element.querySelector("#"+t.parent.element.id+"_sortasc")&&n.element.querySelector("#"+t.parent.element.id+"_sortasc").classList.add("e-disabled");break;case t.parent.element.id+"_sortdesc":t.parent.enableValueSorting?f.querySelectorAll(".e-icon-ascending").length>0?(n.element.querySelector("#"+t.parent.element.id+"_sortasc")?n.element.querySelector("#"+t.parent.element.id+"_sortasc").classList.add("e-disabled"):n.element.querySelector("#"+t.parent.element.id+"_sortasc").classList.remove("e-disabled"),n.element.querySelector("#"+t.parent.element.id+"_sortdesc").classList.contains("e-disabled")&&n.element.querySelector("#"+t.parent.element.id+"_sortdesc").classList.remove("e-disabled")):n.element.querySelector("#"+t.parent.element.id+"_sortasc").classList.contains("e-disabled")&&n.element.querySelector("#"+t.parent.element.id+"_sortasc").classList.remove("e-disabled"):n.element.querySelector("#"+t.parent.element.id+"_sortdesc")&&n.element.querySelector("#"+t.parent.element.id+"_sortdesc").classList.add("e-disabled");break;case t.parent.element.id+"_CalculatedField":t.parent.allowCalculatedField||n.element.querySelector("#"+t.parent.element.id+"_CalculatedField").classList.add("e-disabled");break;case t.parent.element.id+"_pdf":t.parent.allowPdfExport||n.element.querySelector("#"+t.parent.element.id+"_pdf").classList.add("e-disabled");break;case t.parent.element.id+"_excel":t.parent.allowExcelExport||n.element.querySelector("#"+t.parent.element.id+"_excel").classList.add("e-disabled");break;case t.parent.element.id+"_csv":t.parent.allowExcelExport||n.element.querySelector("#"+t.parent.element.id+"_csv").classList.add("e-disabled");break;case t.parent.element.id+"_exporting":t.parent.allowExcelExport||t.parent.allowPdfExport||n.element.querySelector("#"+t.parent.element.id+"_exporting").classList.add("e-disabled");break;case t.parent.element.id+"_aggregate":(n.element.querySelector("#"+t.parent.element.id+"_aggregate")&&!n.element.querySelector("#"+t.parent.element.id+"_aggregate").classList.contains("e-disabled")&&n.element.querySelector("#"+t.parent.element.id+"_aggregate").classList.add("e-disabled"),(f.classList.contains("e-valuesheader")||f.classList.contains("e-valuescontent")||f.classList.contains("e-stot")&&f.classList.contains("e-rowsheader"))&&"olap"!==t.parent.dataType)&&(""!==f.innerText&&(w=t.parent.engineModule.fieldList[b.actualText.toString()].type),g={cancel:!1,fieldName:b.actualText.toString(),aggregateTypes:t.getMenuItem(w).slice()},t.parent.trigger("aggregateMenuOpen",g,function(t){var r;if(!t.cancel&&""!==f.innerText){for(var e=[],o=[],s=0;s<t.aggregateTypes.length;s++)r=t.aggregateTypes[s],"number"!==w?["Count","DistinctCount"].indexOf(r)>-1&&o.indexOf(r)<0&&(e.push({text:i.parent.localeObj.getConstant(r),id:i.parent.element.id+"_Agg"+r}),o.push(r)):i.parent.getAllSummaryType().indexOf(r)>-1&&o.indexOf(r)<0&&(e.push({text:i.parent.localeObj.getConstant(r),id:i.parent.element.id+"_Agg"+r}),o.push(r));e.length>=7&&(e.splice(7),e.push({text:i.parent.localeObj.getConstant("MoreOption"),id:i.parent.element.id+"_AggMoreOption"}));e&&e.length>=1&&(u.items=e,n.element.querySelector("#"+i.parent.element.id+"_aggregate").classList.remove("e-disabled"))}}))}},t=this,u=0,o=n.items;u<o.length;u++)if(f=s(o[u]),"object"==typeof f)return f.value;this.parent.trigger("contextMenuOpen",n)},n.prototype.getMenuItem=function(n){for(var t,i=[],r=0;r<this.parent.aggregateTypes.length;r++)t=this.parent.aggregateTypes[r],"string"!==n?this.parent.getAllSummaryType().indexOf(t)>-1&&-1===i.indexOf(t)&&i.push(t):["Count","DistinctCount"].indexOf(t)>-1&&-1===i.indexOf(t)&&i.push(t);return i},n.prototype.contextMenuClick=function(n){var r=this.parent.lastCellClicked,e=n.item.id,c=new MouseEvent("dblclick",{view:window,bubbles:!0,cancelable:!0}),t={},i=null,o,s,h;r.classList.contains("e-stackedheadercelldiv")||r.classList.contains("e-cellvalue")||r.classList.contains("e-headercelldiv")||r.classList.contains("e-icons")||r.classList.contains("e-rhandler")?i=r.parentElement:r.classList.contains("e-headercell")||r.classList.contains("e-rowcell")?i=r:r.classList.contains("e-headertext")&&(i=r.parentElement.parentElement);var f,l=Number(i.getAttribute("index")),a=Number(i.getAttribute("aria-colindex")),u=this.parent.pivotValues[l][a];switch(n.item.id.indexOf(this.parent.element.id+"_Agg")>-1&&(this.field=this.parent.engineModule.fieldList[u.actualText.toString()].id,this.fieldCaption=this.parent.engineModule.fieldList[u.actualText.toString()].caption,f=n.item.id.split("_Agg")[1]),e){case this.parent.element.id+"_pdf":t={pdfDoc:void 0,isBlob:!1,isMultipleExport:!1,pdfExportProperties:{fileName:"Export.pdf"}};this.parent.trigger("beforeExport",t);this.parent.pdfExport(t.pdfExportProperties,t.isMultipleExport,t.pdfDoc,t.isBlob);break;case this.parent.element.id+"_excel":t={isBlob:!1,isMultipleExport:!1,workbook:void 0,excelExportProperties:{fileName:"Export.xlsx"}};this.parent.trigger("beforeExport",t);this.parent.excelExport(t.excelExportProperties,t.isMultipleExport,t.workbook,t.isBlob);break;case this.parent.element.id+"_csv":t={isBlob:!1,workbook:void 0,isMultipleExport:!1,excelExportProperties:{fileName:"Export.csv"}};this.parent.trigger("beforeExport",t);this.parent.csvExport(t.excelExportProperties,t.isMultipleExport,t.workbook,t.isBlob);break;case this.parent.element.id+"_drillthrough_menu":i.dispatchEvent(c);break;case this.parent.element.id+"_sortasc":this.parent.setProperties({dataSourceSettings:{valueSortSettings:{headerText:u.valueSort.levelName,headerDelimiter:this.parent.dataSourceSettings.valueSortSettings.headerDelimiter}}});this.parent.dataSourceSettings.valueSortSettings.sortOrder="Ascending";break;case this.parent.element.id+"_sortdesc":this.parent.setProperties({dataSourceSettings:{valueSortSettings:{headerText:u.valueSort.levelName,headerDelimiter:this.parent.dataSourceSettings.valueSortSettings.headerDelimiter}}});this.parent.dataSourceSettings.valueSortSettings.sortOrder="Descending";break;case this.parent.element.id+"_expand":if(i.querySelectorAll("."+wt)){o=i.querySelectorAll("."+wt)[0];this.parent.onDrill(o)}break;case this.parent.element.id+"_collapse":if(i.querySelectorAll("."+pt)){s=i.querySelectorAll("."+pt)[0];this.parent.onDrill(s)}break;case this.parent.element.id+"_CalculatedField":this.parent.calculatedFieldModule.createCalculatedFieldDialog();break;case this.parent.element.id+"_AggMoreOption":case this.parent.element.id+"_AggDifferenceFrom":case this.parent.element.id+"_AggPercentageOfDifferenceFrom":case this.parent.element.id+"_AggPercentageOfParentTotal":i.setAttribute("id",this.field);i.setAttribute("data-caption",this.fieldCaption);i.setAttribute("data-field",this.field);i.setAttribute("data-type",this.engine.fieldList[u.actualText.toString()].aggregateType);i.setAttribute("data-basefield",this.engine.fieldList[u.actualText.toString()].baseField);i.setAttribute("data-baseItem",this.engine.fieldList[u.actualText.toString()].baseItem);this.aggMenu.createValueSettingsDialog(i,this.parent.element,f);break;case this.parent.element.id+"_Agg"+f:this.updateAggregate(f);break;case this.parent.element.id+"_custom_group":case this.parent.element.id+"_custom_ungroup":this.parent.groupingModule&&(h={target:i,option:e,parentElement:this.parent.element},this.parent.notify("init-grouping",h),this.parent.grid.contextMenuModule.contextMenu.close())}this.parent.trigger("contextMenuClick",n)},n.prototype.validateField=function(n){var r=!1,t,u,f,e,i;if(n.classList.contains("e-stot")||n.classList.contains("e-gtot")||n.classList.contains("e-valuescontent")||n.classList.contains("e-valuesheader"))r=!0;else for(t=n.getAttribute("fieldName"),t&&""!=t||(u=Number(n.getAttribute("index")),f=Number(n.getAttribute("aria-colindex")),t=this.engine.pivotValues[u][f].actualText),e=this.parent.dataSourceSettings.values,i=0;i<e.length;i++)if(this.parent.dataSourceSettings.values[i].name===t){r=!0;break}return r},n.prototype.updateAggregate=function(n){if(this.parent.getAllSummaryType().indexOf(n)>-1)for(var i=this.parent.dataSourceSettings.values,t=0;t<this.parent.dataSourceSettings.values.length;t++)this.parent.dataSourceSettings.values[t].name===this.field&&(i[t].type=n)},n.prototype.injectGridModules=function(n){c.Grid.Inject(c.Freeze);n.allowExcelExport&&c.Grid.Inject(c.ExcelExport);n.allowPdfExport&&c.Grid.Inject(c.PdfExport);c.Grid.Inject(c.Selection,c.Reorder,c.Resize);this.gridSettings.contextMenuItems&&c.Grid.Inject(c.ContextMenu)},n.prototype.updateGridSettings=function(){if(this.injectGridModules(this.parent),this.parent.grid.allowResizing=this.gridSettings.allowResizing,this.parent.grid.allowTextWrap=this.gridSettings.allowTextWrap,this.parent.grid.allowReordering=!this.parent.showGroupingBar&&this.gridSettings.allowReordering,this.parent.grid.allowSelection=this.gridSettings.allowSelection,this.parent.grid.contextMenuItems=this.gridSettings.contextMenuItems,this.parent.grid.selectedRowIndex=this.gridSettings.selectedRowIndex,this.parent.grid.selectionSettings=this.gridSettings.selectionSettings,this.parent.grid.textWrapSettings=this.gridSettings.textWrapSettings,this.parent.grid.printMode=this.gridSettings.printMode,this.parent.grid.rowHeight=this.gridSettings.rowHeight,this.parent.grid.gridLines=this.gridSettings.gridLines,this.parent.lastGridSettings){var n=Object.keys(this.parent.lastGridSettings);n.indexOf("height")>-1&&(this.parent.grid.height=this.gridSettings.height);n.indexOf("width")>-1&&(this.parent.grid.width=this.gridSettings.width);this.updatePivotColumns();n.indexOf("allowTextWrap")>-1&&this.parent.layoutRefresh()}this.clearColumnSelection()},n.prototype.updatePivotColumns=function(){for(var f,t,i,u=Object.keys(this.parent.lastGridSettings),n=0;n<this.parent.pivotColumns.length;n++)for(f=this.parent.pivotColumns[n],t=0;t<u.length;t++)i=u[t],Object(r.isNullOrUndefined)(this.parent.pivotColumns[n][i])||(f[i]=this.parent.lastGridSettings[i]);this.parent.fillGridColumns(this.parent.grid.columns)},n.prototype.clearColumnSelection=function(){Object(r.removeClass)(this.parent.element.querySelectorAll(".e-active"),["e-active",k])},n.prototype.appendValueSortIcon=function(n,t,i,u){var e;if(this.parent.enableValueSorting&&"pivot"===this.parent.dataType){var f=this.parent.dataSourceSettings.valueSortSettings,o="grand sum"!==n.type||1!==this.parent.dataSourceSettings.values.length||this.parent.dataSourceSettings.alwaysShowValueHeader?this.parent.dataSourceSettings.values.length>1||this.parent.dataSourceSettings.alwaysShowValueHeader?this.parent.engineModule.headerContent.length-1:0===this.parent.dataSourceSettings.columns.length?0:this.parent.engineModule.headerContent.length-1:0,s=f&&f.headerText?n.valueSort.levelName===f.headerText:u===f.columnIndex;void 0!==f&&s&&i===o&&"column"===this.parent.dataSourceSettings.valueAxis&&(t.querySelector(".e-sortfilterdiv")?(t.querySelector(".e-sortfilterdiv").classList.add("Descending"===f.sortOrder?"e-descending":"e-ascending"),t.querySelector(".e-sortfilterdiv").classList.add("Descending"===f.sortOrder?"e-icon-descending":"e-icon-ascending")):t.appendChild(Object(r.createElement)("div",{className:"Descending"===f.sortOrder?"e-icon-descending e-icons e-descending e-sortfilterdiv":"e-icon-ascending e-icons e-ascending e-sortfilterdiv"})),!Object(r.isNullOrUndefined)(n.hasChild)&&"grand sum"!==n.type&&t.querySelector(".e-expand")&&(t.querySelector(".e-icon-descending")||t.querySelector(".e-icon-ascending")))&&(e=t.querySelector(".e-icon-descending")||t.querySelector(".e-icon-ascending"),Object(r.setStyleAttribute)(e,{"padding-top":"12px"}))}return t},n.prototype.onResizeStop=function(n){var t="0.formattedText"===n.column.field?"0.formattedText":n.column.customAttributes.cell.valueSort.levelName;this.parent.resizeInfo[t]=Number(n.column.width.toString().split("px")[0]);this.setGroupWidth(n);this.calculateGridHeight(!0);this.parent.grid.hideScroll()},n.prototype.setGroupWidth=function(n){var t,i;this.parent.showGroupingBar&&this.parent.groupingBarModule&&this.parent.element.querySelector(".e-grouping-bar")&&((this.parent.groupingBarModule.refreshUI(),this.parent.element.querySelector(".e-group-row").offsetWidth<245&&!this.parent.firstColWidth)&&(n.cancel=!0,t=this.parent.grid.columns,t&&t.length>0&&(t[0].width=this.resColWidth),this.parent.element.querySelector(".e-frozenheader").querySelector("col").style.width=this.resColWidth+"px",this.parent.element.querySelector(".e-frozencontent").querySelector("col").style.width=this.resColWidth+"px"),this.parent.element.querySelector(".e-group-rows").style.height="auto",this.parent.element.querySelector(".e-group-values").style.width=this.parent.element.querySelector(".e-group-row").offsetWidth+"px",i=this.parent.element.querySelector(".e-headercontent").offsetHeight,this.parent.element.querySelector(".e-group-rows").style.height=i+"px");this.parent.trigger("touchend"===n.e.type||"mouseup"===n.e.type?"resizeStop":"resizing",n)},n.prototype.selected=function(){clearTimeout(this.timeOutObj);this.timeOutObj=setTimeout(this.onSelect.bind(this),300)},n.prototype.onSelect=function(){for(var t={selectedCellsInfo:[],pivotValues:this.parent.pivotValues,currentCell:null},i=0,r=this.parent.element.querySelectorAll("."+d+",."+k);i<r.length;i++){var u=r[i],f=Number(u.getAttribute("aria-colindex")),e=Number(u.getAttribute("index")),n=this.engine.pivotValues[e][f];n&&("value"===n.axis?t.selectedCellsInfo.push({currentCell:n,value:n.value,columnHeaders:n.columnHeaders,rowHeaders:n.rowHeaders,measure:n.actualText.toString()}):"column"===n.axis?t.selectedCellsInfo.push({currentCell:n,value:n.formattedText,columnHeaders:n.valueSort.levelName,rowHeaders:"",measure:""}):t.selectedCellsInfo.push({currentCell:n,value:n.formattedText,columnHeaders:"",rowHeaders:n.valueSort.levelName,measure:""}))}this.parent.trigger("cellSelected",t)},n.prototype.rowCellBoundEvent=function(n){var t=n.cell,c,i,l,u,a,e,o,v,s,f;if(t&&!this.parent.isEmptyGrid){if(c=this.parent.hyperlinkSettings.cssClass,t.setAttribute("index",(Number(t.getAttribute("index"))+this.engine.headerContent.length).toString()),i=n.data[0],"0"===t.getAttribute("aria-colindex")){if("pivot"===this.parent.dataType){l=i.type&&"value"===i.type;t.innerText="";u=i.level?i.level:l?this.lastSpan+1:0;do u>0&&t.appendChild(Object(r.createElement)("span",{className:0===u?"":"e-nextspan"})),u--;while(u>-1);u=i.level?i.level:0;this.lastSpan=l?this.lastSpan:u;!i.hasChild&&u>0&&t.appendChild(Object(r.createElement)("span",{className:"e-lastspan"}));a=void 0;this.parent.dataSourceSettings.rows.length>0&&(!i.valueSort||Object.keys(i.valueSort).length>0)&&(a=u>-1?this.parent.dataSourceSettings.rows[u].name:"",t.setAttribute("fieldname",a))}else t=this.onOlapRowCellBoundEvent(t,i);e=i.formattedText;i.type&&("grand sum"===i.type?(t.classList.add("e-gtot"),e=this.parent.localeObj.getConstant("grandTotal")):this.parent.enableValueSorting?i.valueSort.levelName===this.parent.localeObj.getConstant("grandTotal")+this.parent.dataSourceSettings.valueSortSettings.headerDelimiter+i.formattedText&&t.classList.add("e-gtot"):i.valueSort.levelName===this.parent.localeObj.getConstant("grandTotal")+"."+i.formattedText?t.classList.add("e-gtot"):t.classList.add("e-stot"));t.classList.add("e-rowsheader");!0!==i.hasChild||i.isNamedSet||t.appendChild(Object(r.createElement)("div",{className:(!0===i.isDrilled?pt:wt)+" "+h,attrs:{title:!0===i.isDrilled?this.parent.localeObj.getConstant("collapse"):this.parent.localeObj.getConstant("expand")}}));t.appendChild(Object(r.createElement)("span",{className:"e-cellvalue",innerHTML:this.parent.isRowCellHyperlink||i.enableHyperlink?'<a  data-url="'+e+'" class="e-hyperlinkcell '+c+'">'+e+"<\/a>":e}));o=this.parent.pivotView.dataSourceSettings.valueSortSettings;this.parent.enableValueSorting&&o&&o.headerText&&"row"===this.parent.dataSourceSettings.valueAxis&&this.parent.pivotValues[Number(t.getAttribute("index"))][0].valueSort.levelName&&this.parent.pivotValues[Number(t.getAttribute("index"))][0].valueSort.levelName===o.headerText&&(v=t.querySelector(".e-expand")||t.querySelector(".e-collapse")?"padding-top: 18px":"padding-top: 12px",t.appendChild(Object(r.createElement)("div",{className:"Descending"===o.sortOrder?"e-icon-descending e-icons e-descending e-sortfilterdiv":"e-icon-ascending e-icons e-ascending e-sortfilterdiv",styles:v})))}else s=t.innerText,t.innerText="",t.classList.add("e-valuescontent"),(i=n.data[Number(t.getAttribute("aria-colindex"))]).isSum&&t.classList.add("e-summary"),i.isGrandSum&&t.classList.add("e-gtot"),i.cssClass&&t.classList.add(i.cssClass),t.appendChild(Object(r.createElement)("span",{className:"e-cellvalue",innerHTML:-1!==t.className.indexOf("e-summary")&&this.parent.isSummaryCellHyperlink||-1===t.className.indexOf("e-summary")&&this.parent.isValueCellHyperlink||i.enableHyperlink?'<a data-url="'+s+'" class="e-hyperlinkcell '+c+'">'+s+"<\/a>":s})),this.parent.gridSettings.allowReordering&&!this.parent.showGroupingBar&&t.setAttribute("aria-colindex",n.column.customAttributes.cell.colIndex.toString());if(this.parent.cellTemplate){var y=t.getAttribute("index"),p=t.getAttribute("aria-colindex"),w=y+"_"+p;window&&Object(r.isBlazor)()?y&&p&&(this.parent.gridCellCollection[w]=t):(f=this.parent.getCellTemplate()({targetCell:t},this.parent,"cellTemplate",this.parent.element.id+"_cellTemplate"),f&&""!==f&&f.length>0&&(this.parent.enableHtmlSanitizer?this.parent.appendHtml(t,r.SanitizeHtmlHelper.sanitize(f[0].outerHTML)):this.parent.appendHtml(t,f[0].outerHTML)))}this.unWireEvents(t);this.wireEvents(t)}n.pivotview=this.parent;this.parent.trigger("queryCellInfo",n)},n.prototype.onOlapRowCellBoundEvent=function(n,t){var l,c,u,s,e,i,v,f,y,g,p,o,nt;if(n.innerText="",l=this.engine.rowMeasurePos,this.parent.enableVirtualization){if(t.ordinal>-1&&this.parent.olapEngineModule.tupRowInfo.length>0){var w=this.parent.olapEngineModule.tupRowInfo[t.ordinal],tt=w.uNameCollection.indexOf(t.actualText.toString()),a=(w.uNameCollection.substring(0,tt)+(3===t.memberType?"":t.actualText.toString())).split("::[").map(function(n){return"["===n[0]?n:"["+n});3===t.memberType&&l===a.length&&a.push(t.actualText.toString());for(var b=-1,d=0,k=!1,h=0;h<a.length;h++)b+=a[h].split("~~").length,c=Number(w.members[h].querySelector("CHILDREN_CARDINALITY").textContent)>0,d+=h>0&&k&&!c?1:0,k=c;for(u=0,s=0;s<b;s++)n.appendChild(Object(r.createElement)("span",{className:"e-nextspan"})),u++;for(s=0;s<d&&b>0;s++)n.appendChild(Object(r.createElement)("span",{className:"e-lastspan"}));this.indentCollection[t.rowIndex]=u;this.maxIndent=this.maxIndent>u?this.maxIndent:u}}else{if(e=t.hierarchy,i=3===t.memberType?this.measurePos+"."+t.levelUniqueName:t.levelUniqueName,c=t.hasChild,!this.lvlCollection[i]&&i)this.lvlPosCollection[this.position]=i,this.lvlCollection[i]={position:this.position,hasChild:c},this.position++;else if(i){for(v=this.lvlCollection[i].position,f=v+1;f<this.position;f++)delete this.lvlCollection[this.lvlPosCollection[f]],delete this.lvlPosCollection[f];this.position=this.position>v+1?v+1:this.position}if(!this.hierarchyCollection[e]&&e)this.hierarchyPosCollection[this.hierarchyCount]=e,this.hierarchyCollection[e]={lvlPosition:this.position-1,hierarchyPOs:this.hierarchyCount},this.hierarchyCount++;else if(e){for(y=this.hierarchyCollection[e].hierarchyPOs,f=y+1;f<this.hierarchyCount;f++)delete this.hierarchyCollection[this.hierarchyPosCollection[f]],delete this.hierarchyPosCollection[f];this.hierarchyCount=this.hierarchyCount>y+1?y+1:this.hierarchyCount}for(3!==t.memberType&&i&&this.lvlCollection[i]&&(g=this.hierarchyCollection[e]?this.hierarchyCollection[e].hierarchyPOs:-1,this.measurePos=l<=g&&this.hierarchyPosCollection[l+1]?this.measurePos:this.lvlCollection[i].position),p=this.lvlCollection[i]?this.lvlCollection[i].position:-1,o=0,u=0;o<=p&&p>0&&t.level>-1;)nt=this.lvlCollection[this.lvlPosCollection[o]].hasChild,(k=o>0&&this.lvlCollection[this.lvlPosCollection[o-1]].hasChild)&&!nt&&n.appendChild(Object(r.createElement)("span",{className:"e-lastspan"})),o!==p&&(n.appendChild(Object(r.createElement)("span",{className:"e-nextspan"})),u++),o++;3===t.memberType&&-1===t.level&&Object.keys(this.lvlCollection).length>1&&(n.appendChild(Object(r.createElement)("span",{className:"e-nextspan"})),u++);this.indentCollection[t.rowIndex]=u;this.maxIndent=this.maxIndent>u?this.maxIndent:u}return n.setAttribute("fieldname",t.hierarchy),!!this.parent.olapEngineModule.tupRowInfo[t.ordinal]&&(0===this.parent.olapEngineModule.tupRowInfo[t.ordinal].measurePosition?1===this.parent.olapEngineModule.tupRowInfo[t.ordinal].allStartPos:0===this.parent.olapEngineModule.tupRowInfo[t.ordinal].allStartPos)&&n.classList.add("e-gtot"),n},n.prototype.columnCellBoundEvent=function(n){var t,i,s,f,c,l,u,e,a,p,o;if(n.cell.column&&n.cell.column.customAttributes&&(t=n.cell.column.customAttributes.cell,i=n.node,t)){if(s=this.parent.hyperlinkSettings.cssClass,f=t.level?t.level:0,-1===t.level&&!t.rowSpan||-1===t.rowSpan?n.node.style.display="none":t.rowSpan>1&&(n.node.setAttribute("rowspan",t.rowSpan.toString()),n.node.setAttribute("aria-rowspan",t.rowSpan.toString()),t.rowIndex+t.rowSpan===this.engine.headerContent.length&&(n.node.style.borderBottomWidth="0px")),n.node.setAttribute("aria-colindex",t.colIndex.toString()),n.node.setAttribute("index",t.rowIndex.toString()),c=void 0,("pivot"===this.parent.dataType?!(this.parent.dataSourceSettings.values&&"column"===this.parent.dataSourceSettings.valueAxis&&this.parent.dataSourceSettings.values.length>1&&t.rowIndex===this.engine.headerContent.length-1)&&this.parent.dataSourceSettings.columns&&this.parent.dataSourceSettings.columns.length>0&&(c=f>-1&&this.parent.dataSourceSettings.columns[f]?this.parent.dataSourceSettings.columns[f].name:"",i.setAttribute("fieldname",c)):i=this.onOlapColumnCellBoundEvent(i,t),t.type)&&(i.classList.add("grand sum"===t.type?"e-gtot":"e-stot"),l="grand sum"===t.type?this.parent.localeObj.getConstant("grandTotal"):t.formattedText.split("Total")[0]+this.parent.localeObj.getConstant("total"),null!==i.querySelector(".e-headertext")?i.querySelector(".e-headertext").innerText=l:i.querySelector(".e-stackedheadercelldiv").innerText=l),(i.classList.add("e-columnsheader"),this.parent.isColumnCellHyperlink||t.enableHyperlink)&&(i.querySelector(".e-stackedheadercelldiv")?(u=i.querySelector(".e-stackedheadercelldiv").innerText,i.querySelector(".e-stackedheadercelldiv").innerHTML='<a data-url="'+u+'" class="e-hyperlinkcell '+s+'">'+u+"<\/a>"):i.querySelector(".e-headertext")&&(u=i.querySelector(".e-headertext").innerText,i.querySelector(".e-headertext").innerHTML='<a data-url="'+u+'" class="e-hyperlinkcell '+s+'">'+u+"<\/a>")),!0!==t.hasChild||t.isNamedSet||(e=i.querySelector(".e-headercelldiv"),e&&(e.style.height="auto",e.style.lineHeight="normal"),a=Object(r.createElement)("div",{className:(!0===t.isDrilled?pt:wt)+" "+h,attrs:{title:!0===t.isDrilled?this.parent.localeObj.getConstant("collapse"):this.parent.localeObj.getConstant("expand")}}),i.children[0].classList.add("e-cellvalue"),i.children[0].style.display=window.navigator.userAgent.indexOf("Edge")>-1||window.navigator.userAgent.indexOf("Trident")>-1?"table":"block",i.insertBefore(a,i.children[0])),i=this.appendValueSortIcon(t,i,t.rowIndex,t.colIndex),this.parent.cellTemplate){var v=i.getAttribute("index"),y=i.getAttribute("aria-colindex"),w=v+"_"+y;window&&Object(r.isBlazor)()?v&&y&&(this.parent.gridCellCollection[w]=i):this.parent.gridHeaderCellInfo.push({targetCell:i})}for(p=this.parent.dataSourceSettings.values.length,o=0;o<p;o++)this.parent.dataSourceSettings.values[o].name===t.actualText&&("olap"===this.parent.dataType&&(!this.parent.olapEngineModule.tupColumnInfo[t.ordinal]||(0===this.parent.olapEngineModule.tupColumnInfo[t.ordinal].measurePosition?1!==this.parent.olapEngineModule.tupColumnInfo[t.ordinal].allStartPos:0!==this.parent.olapEngineModule.tupColumnInfo[t.ordinal].allStartPos)||i.classList.add("e-gtot")),this.parent.enableValueSorting?t.valueSort.levelName===this.parent.localeObj.getConstant("grandTotal")+this.parent.dataSourceSettings.valueSortSettings.headerDelimiter+t.formattedText&&i.classList.add("e-gtot"):t.valueSort.levelName===this.parent.localeObj.getConstant("grandTotal")+"."+t.formattedText?(i.classList.add("e-valuesheader"),i.classList.add("e-gtot")):i.classList.add("e-valuesheader"));this.unWireEvents(i);this.wireEvents(i)}this.parent.trigger("headerCellInfo",n)},n.prototype.onOlapColumnCellBoundEvent=function(n,t){n.setAttribute("fieldname",3===t.memberType?t.actualText.toString():t.hierarchy);var i=this.engine.headerContent[t.rowIndex]?this.engine.headerContent[t.rowIndex][t.colIndex-1]:void 0;return i&&i.actualText===t.actualText&&i.type===t.type&&i.colSpan>1?n.style.display="none":(n.setAttribute("colspan",t.colSpan.toString()),n.setAttribute("aria-colspan",t.colSpan.toString())),t.rowIndex===this.engine.headerContent.length-1&&2===t.memberType&&(n.style.display=this.isSpannedCell(this.engine.headerContent.length,t)?"none":n.style.display),n},n.prototype.isSpannedCell=function(n,t){for(var r,u,i=this.engine.headerContent[t.rowIndex-1]?this.engine.headerContent[t.rowIndex-1][t.colIndex]:void 0;i&&(i.memberType===t.memberType||i.type&&t.type);)i.rowSpan>0&&(r=i.rowSpan,u=i.rowIndex),i=this.engine.headerContent[i.rowIndex-1]?this.engine.headerContent[i.rowIndex-1][t.colIndex]:void 0;return u+r>=n},n.prototype.onHyperCellClick=function(n){var t=n.target.parentElement.parentElement,i={currentCell:t=t.className.indexOf("e-headercelldiv")>-1?t.parentElement:t,data:this.engine.pivotValues[Number(t.getAttribute("index"))][Number(t.getAttribute("aria-colindex"))],cancel:!0};this.parent.trigger("hyperlinkCellClick",i,function(n){if(!n.cancel){i.currentCell=Object(r.getElement)(i.currentCell);var t=i.currentCell.getAttribute("data-url")?i.currentCell.getAttribute("data-url"):i.currentCell.querySelector("a").getAttribute("data-url");window.open(t)}})},n.prototype.getRowStartPos=function(){for(var i,t=this.parent.pivotValues,n=0;n<t.length;n++)if(t[n]&&t[n][0]&&"row"===t[n][0].axis){i=n;break}return i},n.prototype.frameDataSource=function(n){var r=[],i;if(this.parent.dataSourceSettings.values.length>0&&!this.engine.isEmptyData)if(this.parent.enableValueSorting||!this.engine.isEngineUpdated){for(var f=0,u=this.parent.pivotValues,e="value"===n?this.rowStartPos:0,o="value"===n?u.length:this.rowStartPos,t=e;t<o;t++)if(u[t]){for(r[f="header"===n?t:f]={},i=0;i<u[t].length;i++)u[t][i]&&(r[f][i]=u[t][i]);f++}}else r="value"===n?this.engine.valueContent:this.engine.headerContent;else r=this.frameEmptyData();return r},n.prototype.frameEmptyData=function(){return[{0:{formattedText:this.parent.localeObj.getConstant("grandTotal")},1:{formattedText:this.parent.localeObj.getConstant("emptyData")}}]},n.prototype.calculateColWidth=function(n){var t=isNaN(this.parent.width)?this.parent.width.toString().indexOf("%")>-1?parseFloat(this.parent.width.toString())/100*this.parent.element.offsetWidth:this.parent.element.offsetWidth:Number(this.parent.width),i;return t=t-(this.gridSettings.columnWidth>this.resColWidth?this.gridSettings.columnWidth:this.resColWidth)-2,i=(n-=1)*this.gridSettings.columnWidth<t?t/n:this.gridSettings.columnWidth,Math.floor(i)},n.prototype.resizeColWidth=function(n){var t=isNaN(this.parent.width)?this.parent.width.toString().indexOf("%")>-1?parseFloat(this.parent.width.toString())/100*this.parent.element.offsetWidth:this.parent.element.offsetWidth:Number(this.parent.width),i;return n-=1,t=t-(this.gridSettings.columnWidth>this.resColWidth?this.gridSettings.columnWidth:this.resColWidth)-2,i=n*this.gridSettings.columnWidth<t?t/n:this.gridSettings.columnWidth,Math.floor(i)},n.prototype.calculateGridWidth=function(){var n=this.parent.width,t=this.parent.element.getBoundingClientRect().width?this.parent.element.getBoundingClientRect().width:this.parent.element.offsetWidth;return"auto"===this.gridSettings.width?"auto"===this.parent.width?n=t:this.parent.width.toString().indexOf("%")>-1&&(n=parseFloat(this.parent.width.toString())/100*t):n=this.gridSettings.width,n},n.prototype.calculateGridHeight=function(n){var t=this.parent.height,i=this.parent.getHeightAsNumber();if(isNaN(i)&&(i=this.parent.element.offsetHeight>0?this.parent.element.offsetHeight:1),"Chart"!==this.parent.currentView)if("auto"===this.gridSettings.height&&i&&this.parent.element.querySelector(".e-gridheader"))if(t=i-(this.parent.element.querySelector(".e-gridheader").offsetHeight+(this.parent.element.querySelector(".e-grouping-bar")?this.parent.element.querySelector(".e-grouping-bar").offsetHeight:0)+(this.parent.element.querySelector(".e-pivot-toolbar")?42:0))-1,n){var r=this.parent.element.querySelector(".e-frozencontent ."+bt).offsetHeight,u=this.parent.element.querySelector(".e-movablecontent").offsetHeight,e=this.parent.element.querySelector(".e-movablecontent ."+bt).offsetWidth,f=this.parent.element.querySelector(".e-movablecontent").offsetWidth<e;t>=r&&(!f||t>=u)&&!(u<r)&&!!!(f&&t-r<18)?this.parent.grid.height="auto":(this.parent.grid.height=t,this.parent.grid.dataBind())}else t>this.engine.valueContent.length*this.gridSettings.rowHeight&&(t="auto");else t=this.gridSettings.height;return t<this.parent.gridSettings.rowHeight?this.parent.gridSettings.rowHeight:t},n.prototype.frameStackedHeaders=function(){var i=[],r,u,t,n,f,c;if(("olap"===this.parent.dataType||this.parent.dataSourceSettings.values.length>0)&&!this.engine.isEmptyData){var o=this.engine.headerContent.length,s=[],h=[],a=this.calculateColWidth(this.engine.pivotValues[0].length);do{if(r=[],u=0,o--,t=this.engine.headerContent[o],t)for(n=0;n<Object.keys(t).length+(t[0]?0:1);n++){if(f=t[n]&&t[n].colSpan?3!==t[n].memberType||0===o?t[n].colSpan:s[n]:1,f="olap"===this.parent.dataType?1:f,t[n]&&t[n].rowSpan&&t[n].rowSpan,c=t[n]?"grand sum"===t[n].type?this.parent.localeObj.getConstant("grandTotal"):"sum"===t[n].type?t[n].formattedText.split("Total")[0]+this.parent.localeObj.getConstant("total"):t[n].formattedText:"",o===this.engine.headerContent.length-1)f=1,r[u]={field:n+".formattedText",headerText:c,customAttributes:{cell:t[n]},width:t[n]?this.setSavedWidth(t[n].valueSort.levelName,a):this.resColWidth,minWidth:30,format:0===n?"":this.formatList[t[n].actualText],allowReordering:!this.parent.showGroupingBar&&this.parent.gridSettings.allowReordering,allowResizing:this.parent.gridSettings.allowResizing,visible:!0};else if(s[n]){for(var v=f=t[n]&&"grand sum"===t[n].type&&2===t[n].memberType?1:f,l=[],e=n;v>0;){if(r[u]){if(!i[h[e]])break;l.push(i[h[e]])}else r[u]={headerText:c,field:t[n]?t[n].valueSort.levelName:"",customAttributes:{cell:t[n]},width:t[n]?this.setSavedWidth(t[n].valueSort.levelName,a):this.resColWidth,minWidth:30,allowReordering:!this.parent.showGroupingBar&&this.parent.gridSettings.allowReordering,allowResizing:this.parent.gridSettings.allowResizing,visible:!0},l=[i[h[e]]];v-=s[e];e+=s[e]}r[u].columns=l}r[u]&&(r[u].clipMode=this.gridSettings.clipMode);s[n]=f;h[n]=u;u++;n=n+f-1}i=r.length>0?r:i}while(o>0);i[0]={field:"0.formattedText",width:this.resColWidth,minWidth:30,headerText:"",allowReordering:!1,allowResizing:this.parent.gridSettings.allowResizing,visible:!0}}else i=this.frameEmptyColumns();return i.length>1&&(i[i.length-1].minWidth=i[i.length-1].width,i[i.length-1].width="auto"),this.parent.triggerColumnRenderEvent(i),i},n.prototype.setSavedWidth=function(n,t){return this.parent.resizeInfo[n]?this.parent.resizeInfo[n]:t},n.prototype.frameEmptyColumns=function(){var n=[],t=this.calculateColWidth(2);return n.push({field:"0.formattedText",headerText:"",minWidth:30,width:this.resColWidth}),n.push({field:"1.formattedText",headerText:this.parent.localeObj.getConstant("grandTotal"),minWidth:30,width:t}),n},n.prototype.getFormatList=function(){for(var n,i,r,u,e,f={},t=0;t<this.parent.dataSourceSettings.values.length;t++){if(n=this.parent.dataSourceSettings.values[t],i="N","olap"===this.parent.dataType)this.parent.olapEngineModule.fieldList[n.name]&&(r=this.parent.olapEngineModule.fieldList[n.name].formatString,i=r.indexOf("#")>-1?r:r[0]+"2");else if(this.parent.dataSourceSettings.formatSettings.length>0)for(u=0;u<this.parent.dataSourceSettings.formatSettings.length;u++)if(e=this.parent.dataSourceSettings.formatSettings[u],n.name===e.name){i=e.format;break}f[n.name]=i}return f},n.prototype.excelColumnEvent=function(n){n=this.exportHeaderEvent(n);this.parent.trigger("excelHeaderQueryCellInfo",n)},n.prototype.pdfColumnEvent=function(n){this.parent.trigger("pdfHeaderQueryCellInfo",n)},n.prototype.excelRowEvent=function(n){if("0.formattedText"===n.column.field){var i="value"===n.data[0].type,t=0;t="olap"===this.parent.dataType?this.indentCollection[n.data[0].rowIndex]:i?this.lastSpan+1:n.data[0].level;this.colPos=0;n.style={hAlign:"Left",indent:2*t};this.lastSpan=i?this.lastSpan:t}else this.colPos++,n.value=Object(r.isNullOrUndefined)(n.data[this.colPos].value)||Object(r.isNullOrUndefined)(n.data[this.colPos].formattedText)?"":n.data[this.colPos].value||n.data[this.colPos].formattedText;n=this.exportContentEvent(n);this.parent.trigger("excelQueryCellInfo",n)},n.prototype.pdfRowEvent=function(n){if("0.formattedText"===(n=this.exportContentEvent(n)).column.field){var t=0,i="value"===n.data[0].type;t="olap"===this.parent.dataType?this.indentCollection[n.data[0].rowIndex]:i?this.lastSpan+1:-1!==n.data[0].level?n.data[0].level:0;n.style={paragraphIndent:10*t};this.lastSpan=i?this.lastSpan:t}this.parent.trigger("pdfQueryCellInfo",n)},n.prototype.exportHeaderEvent=function(n){var i=1,t;return n.gridCell.column.customAttributes?(t=n.gridCell.column.customAttributes.cell,this.actualText!==t.actualText&&t.colSpan>1&&t.level>-1&&(n.gridCell.colSpan=n.cell.colSpan=t.colSpan>-1?t.colSpan:1),i=t.rowSpan>-1?t.rowSpan:1,this.actualText=t.actualText):i=Object.keys(this.engine.headerContent).length,n.cell.rowSpan!==i&&i>-1&&(n.cell.rowSpan=i),n},n.prototype.exportContentEvent=function(n){return n.value="grand sum"===n.data[Number(n.column.field.split(".formattedText")[0])].type?this.parent.localeObj.getConstant("grandTotal"):n.value,n},n.prototype.unWireEvents=function(n){n.querySelector(".e-hyperlinkcell")&&r.EventHandler.remove(n.querySelector(".e-hyperlinkcell"),this.parent.isAdaptive?"touchend":"click",this.onHyperCellClick)},n.prototype.wireEvents=function(n){n.querySelector(".e-hyperlinkcell")&&r.EventHandler.add(n.querySelector(".e-hyperlinkcell"),this.parent.isAdaptive?"touchend":"click",this.onHyperCellClick,this)},n}(),sr=function(){function n(n){this.keyConfigs={shiftF:"shift+F",shiftS:"shift+S",shiftE:"shift+E","delete":"delete",enter:"enter"};this.parent=n;this.parent.element.tabIndex=-1===this.parent.element.tabIndex?0:this.parent.element.tabIndex;this.keyboardModule=new r.KeyboardEvents(this.parent.element,{keyAction:this.keyActionHandler.bind(this),keyConfigs:this.keyConfigs,eventName:"keydown"})}return n.prototype.keyActionHandler=function(n){switch(n.action){case"shiftF":this.processFilter(n);break;case"shiftS":this.processSort(n);break;case"shiftE":this.processEdit(n);break;case"delete":this.processDelete(n);break;case"enter":this.processOpenContextMenu(n)}},n.prototype.processOpenContextMenu=function(n){var t=n.target;if(t&&Object(r.closest)(t,".e-pivot-button")&&Object(r.closest)(t,".e-values"))return t.querySelector(".e-dropdown-icon").click(),void n.preventDefault()},n.prototype.processSort=function(n){var t=n.target;if(t&&Object(r.closest)(t,".e-pivot-button")&&!Object(r.closest)(t,".e-values")&&!Object(r.closest)(t,".e-axis-filter"))return t.querySelector(".e-sort").click(),void n.preventDefault()},n.prototype.processEdit=function(n){var t=n.target;if(t&&Object(r.closest)(t,".e-pivot-button")&&t.querySelector(".e-edit"))return t.querySelector(".e-edit").click(),void n.preventDefault()},n.prototype.processFilter=function(n){var t=n.target;if(t&&Object(r.closest)(t,".e-pivot-button")&&!Object(r.closest)(t,".e-values"))return t.querySelector(".e-btn-filter").click(),void n.preventDefault()},n.prototype.processDelete=function(n){var t=n.target;if(t&&Object(r.closest)(t,".e-pivot-button"))return t.querySelector(".e-remove").click(),void n.preventDefault()},n.prototype.destroy=function(){this.keyboardModule&&this.keyboardModule.destroy()},n}(),hr=function(){function n(n){this.parent=n}return n.prototype.updateSorting=function(n){var h,u,o;if(!n.target.classList.contains("e-btn-filter")&&!n.target.classList.contains("e-remove")){this.parent.filterDialog.dialogPopUp&&this.parent.filterDialog.dialogPopUp.close();var t=n.target,i=void 0,s=void 0,f=void 0;if(t.id?(i=t.id,s=[].slice.call(t.querySelectorAll(".e-descend"))):(i=t.parentElement.id,s=[].slice.call(t.parentElement.querySelectorAll(".e-descend"))),f=0!==s.length,h=e.getFieldByName(i,this.parent.dataSourceSettings.sortSettings),Object(r.isNullOrUndefined)(h))o={name:i,order:f?"Ascending":"Descending"},this.parent.dataSourceSettings.sortSettings.push(o);else{for(u=0;u<this.parent.dataSourceSettings.sortSettings.length;u++)if(this.parent.dataSourceSettings.sortSettings[u].name===i){this.parent.dataSourceSettings.sortSettings.splice(u,1);break}o={name:i,order:f?"Ascending":"Descending"};this.parent.dataSourceSettings.sortSettings.push(o)}this.parent.control.lastSortInfo=this.parent.dataSourceSettings.sortSettings[this.parent.dataSourceSettings.sortSettings.length-1];f?Object(r.removeClass)([t],"e-descend"):Object(r.addClass)([t],"e-descend")}},n.prototype.updateFiltering=function(n){var f,h=n.target,t=h.parentElement.id,l=h.parentElement.textContent,o=!1,c=[],s=[],i,u;this.parent.dataSourceSettings.allowMemberFilter&&("olap"===this.parent.dataType?s=this.getOlapData(t,o):(i=e.getClonedData(this.parent.engineModule.fieldList[t].dateMember),i="Ascending"===this.parent.engineModule.fieldList[t].sort?i.sort(function(n,t){return n.actualText>t.actualText?1:t.actualText>n.actualText?-1:0}):"Descending"===this.parent.engineModule.fieldList[t].sort?i.sort(function(n,t){return n.actualText<t.actualText?1:t.actualText<n.actualText?-1:0}):i,u=e.getFilterItemByName(t,this.parent.dataSourceSettings.filterSettings),Object(r.isNullOrUndefined)(u)||(o=!(!this.isValidFilterItemsAvail(t,u)||"Include"!==u.type),c=u.items?u.items:[]),s=this.getTreeData(o,i,c,t)));this.parent.filterDialog.dialogPopUp&&this.parent.filterDialog.dialogPopUp.close();f=f="pivotfieldlist"!==this.parent.moduleName?this.parent.element:document.getElementById(this.parent.parentID+"_Wrapper");this.parent.filterDialog.createFilterDialog(s,t,l,f)},n.prototype.isValidFilterItemsAvail=function(n,t){var u=!1;if(t&&["Include","Exclude"].indexOf(t.type)>=0)for(var i=this.parent.engineModule,f=i.fieldList[n],o=i.formatFields[n]&&["date","dateTime","time"].indexOf(i.formatFields[n].type)>-1?f.formattedMembers:f.members,r=0,e=t.items;r<e.length;r++)if(o[e[r]]){u=!0;break}return u},n.prototype.getOlapData=function(n,t){var f=[],l=[],i,u,h,o;this.parent.filterDialog.isSearchEnabled=!1;i=this.parent.engineModule;u=e.getFilterItemByName(n,this.parent.dataSourceSettings.filterSettings);0===i.fieldList[n].filterMembers.length?this.parent.control.loadOnDemandInMemberEditor?u&&u.levelCount>1&&i.fieldList[n].levels.length>1?i.getFilterMembers(this.parent.dataSourceSettings,n,u.levelCount):(i.fieldList[n].levelCount=1,i.getMembers(this.parent.dataSourceSettings,n)):i.getMembers(this.parent.dataSourceSettings,n,!0):(i.fieldList[n].currrentMembers={},i.fieldList[n].searchMembers=[]);h=i.fieldList[n].isHierarchy;f=i.fieldList[n].filterMembers;Object(r.isNullOrUndefined)(u)||(t=!u.type||"Include"===u.type,l=u.items?u.items:[]);for(var a={},s={},y=i.fieldList[n].members,c=0,v=l;c<v.length;c++)o=v[c],a[o]=o,s[o]=o,y[o]&&(s=this.getParentNode(n,o,s));return f=this.getFilteredTreeNodes(n,f,s,[],h),f=this.getOlapTreeData(t,e.getClonedData(f),a,n,h),f=this.sortOlapFilterData(f,i.fieldList[n].sort)},n.prototype.sortOlapFilterData=function(n,t){return n.length>0&&(n="Ascending"===t?n.sort(function(n,t){return n.caption>t.caption?1:t.caption>n.caption?-1:0}):"Descending"===t?n.sort(function(n,t){return n.caption<t.caption?1:t.caption<n.caption?-1:0}):n),n},n.prototype.getParentIDs=function(n,t,i){for(var r,e,u=0,f=n.fields.dataSource;u<f.length;u++)if(e=f[u],e.id===t){r=e.pid;break}return r&&(i.push(r),this.getParentIDs(n,r,i)),i},n.prototype.getChildIDs=function(n,t,i){for(var r,e,u=0,f=n.fields.dataSource;u<f.length;u++)if(e=f[u],e.pid===t){r=e.id;break}return r&&(i.push(r),this.getParentIDs(n,r,i)),i},n.prototype.searchTreeNodes=function(n,t,i,u){var c,l,k,v,d,h,y,g,o,p,nt,w;if(i){for(var f=[],s=[],b=0,tt=[].slice.call(t.element.querySelectorAll("li"));b<tt.length;b++)c=tt[b],c.querySelector(".e-list-text").textContent.toLowerCase().indexOf(n.value.toLowerCase())>-1?f.push(c):s.push(c);if(t.enableNodes(f),Object(r.removeClass)(f,"e-disable"),t.disableNodes(s),Object(r.addClass)(s,"e-disable"),f.length>0&&s.length>0)for(l=0,k=f;l<k.length;l++){var it=k[l].getAttribute("data-uid"),rt=this.getParentIDs(t,it,[]),ut=this.getChildIDs(t,it,[]),a=[];if(rt.length>0)for(v=0,d=s;v<d.length;v++)h=d[v],-1!==e.inArray(h.getAttribute("data-uid"),rt)&&a.push(h);if(ut.length>0)for(y=0,g=s;y<g.length;y++)h=g[y],-1!==e.inArray(h.getAttribute("data-uid"),ut)&&a.push(h);t.enableNodes(a);Object(r.removeClass)(a,"e-disable")}0===[].slice.call(t.element.querySelectorAll("li.e-disable")).length?t.collapseAll():t.expandAll(void 0,void 0,!0)}else if(this.parent.searchTreeItems=[],"olap"!==this.parent.dataType||u){for(f=[],o=0,o=1,p=0,nt=this.parent.currentTreeItems;p<nt.length;p++)w=nt[p],w.name.toLowerCase().indexOf(n.value.toLowerCase())>-1&&(this.parent.searchTreeItems.push(w),o<=this.parent.control.maxNodeLimitInMemberEditor&&f.push(w),o++);--o>this.parent.control.maxNodeLimitInMemberEditor?(this.parent.editorLabelElement.innerText=o-this.parent.control.maxNodeLimitInMemberEditor+this.parent.control.localeObj.getConstant("editorDataLimitMsg"),this.parent.filterDialog.dialogPopUp.height=this.parent.filterDialog.allowExcelLikeFilter?"440px":"400px",this.parent.isDataOverflow=!0):(this.parent.editorLabelElement.innerText="",this.parent.filterDialog.dialogPopUp.height=this.parent.filterDialog.allowExcelLikeFilter?"400px":"350px",this.parent.isDataOverflow=!1);this.parent.isDataOverflow=o>this.parent.control.maxNodeLimitInMemberEditor;this.parent.editorLabelElement.parentElement.style.display=this.parent.isDataOverflow?"block":"none";t.fields={dataSource:f,id:"id",text:"name",isChecked:"isSelected",parentID:"pid"};t.dataBind()}else this.updateOlapSearchTree(n,t,u)},n.prototype.updateOlapSearchTree=function(n,t,i){var f=[],u=this.parent.filterDialog.dialogPopUp.element.getAttribute("data-fieldname"),h,a,r,c;if(""===n.value.toLowerCase()){this.parent.filterDialog.isSearchEnabled=!1;this.parent.engineModule.fieldList[u].searchMembers=[];for(var v={},s={},o=this.parent.engineModule.fieldList[u].members,y=[],l=0,p=Object.keys(o);l<p.length;l++)o[r=p[l]].isSelected&&(o[r].parent&&o[o[r].parent].isSelected||y.push(r));for(h=0,a=y;h<a.length;h++)v[r=a[h]]=r,s[r]=r,o[r]&&(s=this.getParentNode(u,r,s));c=this.parent.engineModule.fieldList[u].filterMembers;f=this.getFilteredTreeNodes(u,c,s,[],i);f=this.getOlapTreeData(!0,e.getClonedData(f),v,u,i,!0)}else this.parent.filterDialog.isSearchEnabled=!0,c=this.parent.engineModule.fieldList[u].searchMembers,f=e.getClonedData(c),f=this.getOlapSearchTreeData(!0,f,u);t.fields={dataSource:f,id:"id",text:"name",isChecked:"isSelected",parentID:"pid"};t.dataBind()},n.prototype.getTreeData=function(n,t,i,r){var s,c,o,l;this.parent.currentTreeItems=[];this.parent.searchTreeItems=[];this.parent.currentTreeItemsPos={};this.parent.savedTreeFilterPos={};s=this.parent.engineModule;this.parent.isDateField=s.formatFields[r]&&["date","dateTime","time"].indexOf(s.formatFields[r].type)>-1;for(var v=[],f=1,y={},h=0,p=i;h<p.length;h++)c=p[h],y[c]=c;for(o=0,l=t;o<l.length;o++){var e=l[o],a=this.parent.isDateField?e.formattedText:e.actualText.toString(),u={id:e.actualText.toString(),actualText:e.actualText,name:a,isSelected:!n};void 0!==y[a]&&(u.isSelected=!!n);f<=this.parent.control.maxNodeLimitInMemberEditor&&v.push(u);u.isSelected||(this.parent.savedTreeFilterPos[f-1]=a);this.parent.currentTreeItems.push(u);this.parent.searchTreeItems.push(u);this.parent.currentTreeItemsPos[e.actualText]={index:f-1,isSelected:u.isSelected};f++}return this.parent.isDataOverflow=f-1>this.parent.control.maxNodeLimitInMemberEditor,v},n.prototype.getOlapTreeData=function(n,t,i,r,u,f){var o=this.parent.engineModule.fieldList[r];this.parent.currentTreeItems=[];this.parent.searchTreeItems=[];this.parent.currentTreeItemsPos={};for(var a=[],h=1,l=0,v=t;l<v.length;l++){var c=v[l],e=c,s=c.id.toString();f||(e.isSelected=!n);void 0!==i[s]&&(e.isSelected=!!n);!f&&c.hasChildren&&this.updateChildNodeStates(o.filterMembers,r,c.id,e.isSelected);o.members[s].isSelected=e.isSelected;o.currrentMembers&&o.currrentMembers[s]&&(o.currrentMembers[s].isSelected=e.isSelected);h<=this.parent.control.maxNodeLimitInMemberEditor&&u&&a.push(e);this.parent.currentTreeItems.push(e);this.parent.searchTreeItems.push(e);this.parent.currentTreeItemsPos[s]={index:h-1,isSelected:e.isSelected};h++}return this.parent.isDataOverflow=!!u&&h-1>this.parent.control.maxNodeLimitInMemberEditor,u?a:t},n.prototype.getOlapSearchTreeData=function(n,t,i){for(var r,f,e=this.parent.engineModule.fieldList[i].members,u=0,o=t;u<o.length;u++)r=o[u],f=r.id.toString(),e[f]&&(r.isSelected=e[f].isSelected),this.parent.searchTreeItems.push(r);return t},n.prototype.updateChildNodeStates=function(n,t,i,r){for(var u,s=this.parent.engineModule.fieldList[t].members,f=this.parent.engineModule.fieldList[t].currrentMembers,e=0,o=n;e<o.length;e++)u=o[e],u.pid&&u.pid.toString()===i&&(s[u.id].isSelected=r,f&&f[u.id]&&(f[u.id].isSelected=r),u.hasChildren&&this.updateChildNodeStates(n,t,u.id,r))},n.prototype.getParentNode=function(n,t,i){var u=this.parent.engineModule.fieldList[n].members,r;return u[t].parent&&t!==u[t].parent&&(r=u[t].parent,i[r]=r,this.getParentNode(n,r,i)),i},n.prototype.getFilteredTreeNodes=function(n,t,i,u){for(var h,c,a,f,s=[],o=this.parent.engineModule.fieldList[n].members,l=0,v=i?Object.keys(i):[];l<v.length;l++)h=o[v[l]].parent,void 0!==h&&-1===e.inArray(h,s)&&s.push(h);for(c=0,a=t;c<a.length;c++)f=a[c],Object(r.isNullOrUndefined)(f.pid)||-1!==e.inArray(f.pid,s)?(u.push(f),Object(r.isNullOrUndefined)(f.pid)&&-1!==e.inArray(f.id,s)?o[f.id].isNodeExpand=!0:Object(r.isNullOrUndefined)(f.pid)||-1===e.inArray(f.pid,s)?o[f.id].isNodeExpand=!1:(o[f.id].isNodeExpand=!1,o[f.pid].isNodeExpand=!0)):o[f.id].isNodeExpand=!1;return u},n}(),cr=function(){function n(n){this.parent=n}return n.prototype.onStateModified=function(n,t){var i="",s=!0,o=Object(r.closest)(n.target,".e-droppable"),h=-1,u,f,e;if(this.parent.dataSourceUpdate.btnElement=n.element?n.element.parentElement:void 0,o&&(i="e-rows"===o.classList[1]?"rows":"e-columns"===o.classList[1]?"columns":"e-values"===o.classList[1]?"values":"e-filters"===o.classList[1]?"filters":""),"olap"===this.parent.dataType){if(u=this.parent.engineModule.fieldList[t]&&this.parent.engineModule.fieldList[t].isCalculatedField?this.parent.engineModule.fieldList[t].tag:t,n.cancel&&""===i)return!1;if(this.parent.dataSourceUpdate.btnElement&&"true"===this.parent.dataSourceUpdate.btnElement.getAttribute("isValue")&&("filters"===i||"values"===i)||this.parent.dataSourceUpdate.btnElement&&"false"===this.parent.dataSourceUpdate.btnElement.getAttribute("isValue")&&u.toLowerCase().indexOf("[measures].")>-1&&("filters"===i||"rows"===i||"columns"===i)||this.parent.dataSourceUpdate.btnElement&&"false"===this.parent.dataSourceUpdate.btnElement.getAttribute("isValue")&&-1===u.toLowerCase().indexOf("[measures].")&&this.parent.engineModule.fieldList[t]&&this.parent.engineModule.fieldList[t].isNamedSets&&("filters"===i||"values"===i)||this.parent.dataSourceUpdate.btnElement&&"false"===this.parent.dataSourceUpdate.btnElement.getAttribute("isValue")&&-1===u.toLowerCase().indexOf("[measures].")&&"values"===i)return f=this.parent.localeObj.getConstant("warning"),e=this.parent.localeObj.getConstant("fieldDropErrorAction"),this.parent.errorDialog.createErrorDialog(f,e),s=!1}else if(n.cancel&&""===i||this.parent.dataSourceUpdate.btnElement&&"true"===this.parent.dataSourceUpdate.btnElement.getAttribute("isValue")&&("filters"===i||"values"===i||i.indexOf(this.parent.dataSourceSettings.valueAxis)>-1))return!1;if(""!==i){if("olap"===this.parent.dataType&&((u=this.parent.engineModule.fieldList[t]&&this.parent.engineModule.fieldList[t].isCalculatedField?this.parent.engineModule.fieldList[t].tag:t).toLowerCase().indexOf("[measures].")>-1&&("filters"===i||"rows"===i||"columns"===i)||this.parent.engineModule.fieldList[t]&&this.parent.engineModule.fieldList[t].isNamedSets&&"filters"===i||-1===u.toLowerCase().indexOf("[measures].")&&"values"===i))return f=this.parent.localeObj.getConstant("warning"),e=this.parent.localeObj.getConstant("fieldDropErrorAction"),this.parent.errorDialog.createErrorDialog(f,e),s=!1;if("pivot"===this.parent.dataType&&this.parent.engineModule.fieldList[t]&&"CalculatedField"===this.parent.engineModule.fieldList[t].aggregateType&&"values"!==i)return f=this.parent.localeObj.getConstant("warning"),e=this.parent.localeObj.getConstant("dropAction"),this.parent.errorDialog.createErrorDialog(f,e),s=!1;h=this.getButtonPosition(n.target,i)}else this.parent.engineModule.fieldList[t]&&(this.parent.engineModule.fieldList[t].isSelected=!1,"olap"===this.parent.dataType&&this.parent.engineModule.updateFieldlistData(t));return this.parent.dataSourceUpdate.updateDataSource(t,i,h),!Object(r.isBlazor)()&&s},n.prototype.getButtonPosition=function(n,t){var f=-1,i=Object(r.closest)(n,".e-pvt-btn-div");if(!Object(r.isNullOrUndefined)(i)){i=i.querySelector(".e-pivot-button");for(var o=this.parent.element.querySelector(".e-"+t),e=[].slice.call(o.querySelectorAll(".e-pivot-button")),u=0,s=e.length;u<s;u++)if(e[u].id===i.id){f=u;break}}return f},n}(),lr=function(){function n(n){this.parent=n}return n.prototype.updateDataSource=function(n,t,i){for(var h,a,v,l,f,c,u=this,s=[this.parent.dataSourceSettings.rows,this.parent.dataSourceSettings.columns,this.parent.dataSourceSettings.values,this.parent.dataSourceSettings.filters],o=0,y=s.length;o<y;o++)if(s[o])for(h=0,a=s[o].length;h<a;h++)(s[o][h].name===n||"olap"===this.parent.dataType&&"[measures]"===s[o][h].name.toLowerCase()&&s[o][h].name.toLowerCase()===n)&&(c=0===o?"rows":1===o?"columns":2===o?"values":"filters"),c||(c="fieldList");v={fieldName:n,dropField:e.getFieldInfo(n,this.control).fieldItem,dataSourceSettings:e.getClonedDataSourceSettings(this.parent.dataSourceSettings),dropAxis:t,dropPosition:i,draggedAxis:c,cancel:!1};l="pivotfieldlist"===this.control.getModuleName()&&this.control.isPopupView?this.control.pivotGridModule:this.control;l.trigger("fieldDrop",v,function(o){if(!o.cancel){if(t=o.dropAxis,i=o.dropPosition,n=o.dropField?o.dropField.name:o.fieldName,f=o.dropField,u.control&&u.btnElement&&"true"===u.btnElement.getAttribute("isvalue"))switch(t){case"":u.control.setProperties({dataSourceSettings:{values:[]}},!0);break;case"rows":u.control.setProperties({dataSourceSettings:{valueAxis:"row"}},!0);break;case"columns":u.control.setProperties({dataSourceSettings:{valueAxis:"column"}},!0)}else u.removeFieldFromReport(n.toString()),"CalculatedField"===(f=u.getNewField(n.toString(),o.dropField)).type&&""!==t&&(t="values");if("olap"===u.parent.dataType&&(u.removeFieldFromReport(n.toString()),f=u.getNewField(n.toString(),o.dropField),0===u.parent.dataSourceSettings.values.length&&u.removeFieldFromReport("[measures]"),"CalculatedField"===f.type&&""!==t&&(t="values")),u.control){var h={fieldName:n,droppedField:f,dataSourceSettings:e.getClonedDataSourceSettings(u.parent.dataSourceSettings),droppedAxis:t,droppedPosition:i},s=u;l.trigger("onFieldDropped",h,function(n){if(f=n.droppedField){switch(i=n.droppedPosition,t=n.droppedAxis){case"filters":-1!==i?Object(r.isBlazor)()?s.parent.dataSourceSettings.filters.splice(i,0,f):u.parent.dataSourceSettings.filters.splice(i,0,f):Object(r.isBlazor)()?s.parent.dataSourceSettings.filters.push(f):u.parent.dataSourceSettings.filters.push(f);break;case"rows":-1!==i?Object(r.isBlazor)()?s.parent.dataSourceSettings.rows.splice(i,0,f):u.parent.dataSourceSettings.rows.splice(i,0,f):Object(r.isBlazor)()?s.parent.dataSourceSettings.rows.push(f):u.parent.dataSourceSettings.rows.push(f);break;case"columns":-1!==i?Object(r.isBlazor)()?s.parent.dataSourceSettings.columns.splice(i,0,f):u.parent.dataSourceSettings.columns.splice(i,0,f):Object(r.isBlazor)()?s.parent.dataSourceSettings.columns.push(f):u.parent.dataSourceSettings.columns.push(f);break;case"values":if(-1!==i?Object(r.isBlazor)()?s.parent.dataSourceSettings.values.splice(i,0,f):u.parent.dataSourceSettings.values.splice(i,0,f):Object(r.isBlazor)()?s.parent.dataSourceSettings.values.push(f):u.parent.dataSourceSettings.values.push(f),Object(r.isBlazor)()){if("olap"===s.parent.dataType&&!s.parent.engineModule.isMeasureAvail){var e={name:"[Measures]",caption:"Measures",showRemoveIcon:!0,allowDragAndDrop:!0};("row"===s.parent.dataSourceSettings.valueAxis?s.parent.dataSourceSettings.rows:s.parent.dataSourceSettings.columns).push(e)}}else"olap"!==u.parent.dataType||u.parent.engineModule.isMeasureAvail||(e={name:"[Measures]",caption:"Measures",showRemoveIcon:!0,allowDragAndDrop:!0},("row"===u.parent.dataSourceSettings.valueAxis?u.parent.dataSourceSettings.rows:u.parent.dataSourceSettings.columns).push(e))}Object(r.isBlazor)()&&(s.parent.control.pivotButtonModule.updateDataSource(),s.parent.control.axisFieldModule.render())}})}}})},n.prototype.removeFieldFromReport=function(n){for(var r,s,u,f,e=!1,i=[this.parent.dataSourceSettings.rows,this.parent.dataSourceSettings.columns,this.parent.dataSourceSettings.values,this.parent.dataSourceSettings.filters],o=this.parent.engineModule.fieldList[n],t=0,h=i.length;t<h;t++)if(!e&&i[t])for(r=0,s=i[t].length;r<s;r++)if(i[t][r].name===n||"olap"===this.parent.dataType&&"[measures]"===i[t][r].name.toLowerCase()&&i[t][r].name.toLowerCase()===n){((f=i[t][r].properties?i[t][r].properties:i[t][r]).type=o&&"number"===o.type?f.type:"Count",i[t].splice(r,1),"olap"===this.parent.dataType)&&(u=this.parent.engineModule,u&&u.fieldList[n]&&(u.fieldList[n].currrentMembers={},u.fieldList[n].searchMembers=[]));e=!0;break}return f},n.prototype.getNewField=function(n,t){var r,i;return"olap"===this.parent.dataType?(i=this.parent.engineModule.fieldList[n],r={name:t?t.name:n,caption:t?t.caption:i.caption,isNamedSet:t?t.isNamedSet:i.isNamedSets,isCalculatedField:t?t.isCalculatedField:i.isCalculatedField,type:t?void 0===t.type?"number"===i.type?"Sum":"Count":t.type:void 0===i.aggregateType?"number"===i.type?"Sum":"Count":i.aggregateType,showFilterIcon:t?t.showFilterIcon:i.showFilterIcon,showSortIcon:t?t.showSortIcon:i.showSortIcon,showEditIcon:t?t.showEditIcon:i.showEditIcon,showRemoveIcon:t?t.showRemoveIcon:i.showRemoveIcon,showValueTypeIcon:t?t.showValueTypeIcon:i.showValueTypeIcon,allowDragAndDrop:t?t.allowDragAndDrop:i.allowDragAndDrop,showSubTotals:t?t.showSubTotals:i.showSubTotals}):(i=this.parent.engineModule.fieldList[n],r={name:t?t.name:n,caption:t?t.caption:i.caption,type:t?void 0===t.type||null===t.type?"number"===i.type?"Sum":"Count":t.type:void 0===i.aggregateType||null===i.aggregateType?"number"===i.type?"Sum":"Count":i.aggregateType,showNoDataItems:t?t.showNoDataItems:i.showNoDataItems,baseField:t?t.baseField:i.baseField,baseItem:t?t.baseItem:i.baseItem,allowDragAndDrop:t?t.allowDragAndDrop:i.allowDragAndDrop,showSubTotals:t?t.showSubTotals:i.showSubTotals,showFilterIcon:t?t.showFilterIcon:i.showFilterIcon,showSortIcon:t?t.showSortIcon:i.showSortIcon,showEditIcon:t?t.showEditIcon:i.showEditIcon,showRemoveIcon:t?t.showRemoveIcon:i.showRemoveIcon,showValueTypeIcon:t?t.showValueTypeIcon:i.showValueTypeIcon}),r},n}(),ar=function(){function n(n){this.parent=n}return n.prototype.createErrorDialog=function(n,t,i){var u=Object(r.createElement)("div",{id:this.parent.parentID+"_ErrorDialog",className:"e-pivot-error-dialog"}),f;this.parent.element.appendChild(u);f=i?Number(i.style.zIndex)+1:"pivotfieldlist"===this.parent.moduleName&&"Popup"===this.parent.renderMode&&this.parent.control?this.parent.control.dialogRenderer.fieldListDialog.zIndex+1:1000001;this.errorPopUp=new p.Dialog({animationSettings:{effect:"Fade"},allowDragging:!1,header:n,content:t,isModal:!0,visible:!0,showCloseIcon:!0,enableRtl:this.parent.enableRtl,width:"auto",height:"auto",zIndex:f,position:{X:"center",Y:"center"},buttons:[{click:this.closeErrorDialog.bind(this),buttonModel:{cssClass:"e-ok-btn",content:this.parent.localeObj.getConstant("ok"),isPrimary:!0}}],closeOnEscape:!0,target:document.body,close:this.removeErrorDialog.bind(this)});this.errorPopUp.isStringTemplate=!0;this.errorPopUp.appendTo(u)},n.prototype.closeErrorDialog=function(){this.errorPopUp.close()},n.prototype.removeErrorDialog=function(){this.errorPopUp&&!this.errorPopUp.isDestroyed&&this.errorPopUp.destroy();document.getElementById(this.parent.parentID+"_ErrorDialog")&&Object(r.remove)(document.getElementById(this.parent.parentID+"_ErrorDialog"))},n}(),yi=i(10),vr=i(12),g=i(7),yr=function(){function n(n){this.parent=n}return n.prototype.createFilterDialog=function(n,t,i,u){var f=this,e=Object(r.createElement)("div",{id:this.parent.parentID+"_EditorTreeView",className:"e-member-editor-dialog "+("olap"===this.parent.dataType?"e-olap-editor-dialog":""),attrs:{"data-fieldName":t,"aria-label":i}}),s=this.parent.engineModule.fieldList[t].caption,h=this.parent.localeObj.getConstant("filter")+' "'+i+'" '+this.parent.localeObj.getConstant("by"),o;this.filterObject=this.getFilterObject(t);this.isSearchEnabled=!1;this.allowExcelLikeFilter=this.isExcelFilter(t);this.parent.element.appendChild(e);this.dialogPopUp=new p.Dialog({animationSettings:{effect:this.allowExcelLikeFilter?"None":"Fade"},allowDragging:!1,header:this.allowExcelLikeFilter?h:s,content:"",isModal:"Popup"===this.parent.renderMode||!!this.parent.isAdaptive,visible:!0,showCloseIcon:!!this.allowExcelLikeFilter,enableRtl:this.parent.enableRtl,width:"auto",height:this.parent.isDataOverflow?this.allowExcelLikeFilter?"440px":"400px":this.allowExcelLikeFilter?"400px":"350px",position:{X:"center",Y:"center"},buttons:[{buttonModel:{cssClass:"e-ok-btn",content:this.parent.localeObj.getConstant("ok"),isPrimary:!0}},{buttonModel:{cssClass:"e-clear-filter-button"+(this.allowExcelLikeFilter?"":" e-disable"),iconCss:"e-icons e-clear-filter-icon",enableRtl:this.parent.enableRtl,content:this.parent.localeObj.getConstant("clearFilter"),disabled:!this.filterObject}},{click:this.closeFilterDialog.bind(this),buttonModel:{cssClass:"e-cancel-btn",content:this.parent.localeObj.getConstant("cancel")}}],closeOnEscape:!0,target:u,close:this.removeFilterDialog.bind(this)});this.dialogPopUp.isStringTemplate=!0;this.dialogPopUp.appendTo(e);o={cancel:!1,fieldName:t,fieldMembers:this.parent.dataSourceSettings.allowMemberFilter?n:[],filterSetting:this.filterObject};("pivotfieldlist"===this.parent.moduleName&&this.parent.control.isPopupView?this.parent.control.pivotGridModule:this.parent.control).trigger("memberEditorOpen",o,function(u){u.cancel?(f.dialogPopUp.close(),f.dialogPopUp=void 0):(n=u.fieldMembers,f.allowExcelLikeFilter?(f.createTabMenu(n,i,t),Object(r.addClass)([f.dialogPopUp.element],"e-excel-filter"),f.updateCheckedState(i)):(f.dialogPopUp.content=f.createTreeView(n,i,t),f.updateCheckedState(i)),Object(r.setStyleAttribute)(f.dialogPopUp.element,{visibility:"visible"}),f.allowExcelLikeFilter&&f.dialogPopUp.element.querySelector(".e-dlg-closeicon-btn").focus(),f.parent.control.pivotButtonModule.memberTreeView=f.parent.filterDialog.memberTreeView,f.memberTreeView.nodeChecked=f.parent.control.pivotButtonModule.nodeStateModified.bind(f.parent.control.pivotButtonModule),f.allMemberSelect.nodeChecked=f.parent.control.pivotButtonModule.nodeStateModified.bind(f.parent.control.pivotButtonModule))})},n.prototype.createTreeView=function(n,t,i){var u=this,f=Object(r.createElement)("div",{id:this.parent.parentID+"EditorDiv",className:"e-member-editor-wrapper"+(this.allowExcelLikeFilter?" e-excelfilter":"")}),h=Object(r.createElement)("button",{id:this.parent.parentID+"_LevelDiv",className:"e-level-wrapper-class"}),e=Object(r.createElement)("div",{id:this.parent.parentID+"_SearchDiv",attrs:{tabindex:"-1"},className:"e-editor-search-wrapper"}),d=this.parent.engineModule.fieldList[i].caption,c=Object(r.createElement)("input",{attrs:{type:"text",className:"e-editor-search-input"}}),l=this.parent.isDataOverflow?this.parent.currentTreeItems.length-this.parent.control.maxNodeLimitInMemberEditor+this.parent.control.localeObj.getConstant("editorDataLimitMsg"):"",s=Object(r.createElement)("div",{id:this.parent.parentID+"_LabelDiv",attrs:{tabindex:"-1",title:l},className:"e-editor-label-wrapper"}),w,k;this.parent.editorLabelElement=Object(r.createElement)("label",{className:"e-editor-label"});this.parent.editorLabelElement.innerText=l;s.style.display=this.parent.isDataOverflow?"block":"none";s.appendChild(this.parent.editorLabelElement);e.appendChild(c);this.createSortOptions(i,e,n);var a=Object(r.createElement)("div",{id:this.parent.parentID+"_AllDiv",attrs:{tabindex:"-1"},className:"e-select-all-wrapper"}),v=Object(r.createElement)("div",{className:"e-select-all"}),y=Object(r.createElement)("div",{className:"e-member-editor-container-outer-div"}),p=Object(r.createElement)("div",{className:"e-member-editor-container"}),o=Object(r.createElement)("div",{className:"e-member-prompt e-disable",innerHTML:this.parent.localeObj.getConstant("noMatches")});return"olap"!==this.parent.dataType||!this.parent.control.loadOnDemandInMemberEditor||this.parent.engineModule.fieldList[i].isHierarchy||this.parent.engineModule.fieldList[i].isNamedSets||(e.appendChild(h),this.createLevelWrapper(h,i)),a.appendChild(v),f.appendChild(e),f.appendChild(a),f.appendChild(o),this.editorSearch=new b.MaskedTextBox({placeholder:this.parent.localeObj.getConstant("search")+' "'+d+'"',enableRtl:this.parent.enableRtl,cssClass:"e-editor-search",showClearButton:!0,change:function(n){if("olap"===u.parent.dataType)u.searchOlapTreeView(n,o,t);else{u.parent.eventBase.searchTreeNodes(n,u.memberTreeView,!1);var i=u.dialogPopUp.element;0===[].slice.call(u.memberTreeView.element.querySelectorAll("li")).length?(u.allMemberSelect.disableNodes([u.allMemberSelect.element.querySelector("li")]),i.querySelector(".e-ok-btn").setAttribute("disabled","disabled"),Object(r.removeClass)([o],"e-disable")):(u.allMemberSelect.enableNodes([u.allMemberSelect.element.querySelector("li")]),i.querySelector(".e-ok-btn").removeAttribute("disabled"),Object(r.addClass)([o],"e-disable"));u.updateCheckedState(t)}}}),this.editorSearch.isStringTemplate=!0,this.editorSearch.appendTo(c),w={"data-fieldName":i},k=[{id:"all",name:this.parent.localeObj.getConstant("all"),isSelected:!0,htmlAttributes:w}],this.allMemberSelect=new rt.TreeView({fields:{dataSource:k,id:"id",text:"name",isChecked:"isSelected"},showCheckBox:!0,expandOn:"None",enableRtl:this.parent.enableRtl,nodeClicked:this.nodeCheck.bind(this,!0),keyPress:this.nodeCheck.bind(this,!0),nodeSelected:function(n){Object(r.removeClass)([n.node],"e-active");n.cancel=!0}}),this.allMemberSelect.isStringTemplate=!0,this.allMemberSelect.appendTo(v),y.appendChild(p),f.appendChild(y),this.memberTreeView=new rt.TreeView({fields:{dataSource:n,id:"id",text:"name",isChecked:"isSelected",parentID:"pid"},showCheckBox:!0,enableRtl:this.parent.enableRtl,nodeChecking:this.validateTreeNode.bind(this),nodeClicked:this.nodeCheck.bind(this,!1),keyPress:this.nodeCheck.bind(this,!1),nodeExpanding:this.updateChildNodes.bind(this),nodeSelected:function(n){Object(r.removeClass)([n.node],"e-active");n.cancel=!0},expandOn:"None"}),this.memberTreeView.isStringTemplate=!0,this.memberTreeView.appendTo(p),f.appendChild(s),f},n.prototype.createSortOptions=function(n,t,i){var o,u;if("pivot"===this.parent.dataType&&i&&i.length>0){o=this.parent.engineModule.fieldList[n].sort;u=Object(r.createElement)("div",{className:"e-filter-sort e-btn-group"+(this.parent.enableRtl?" "+et:""),id:this.parent.element.id+"_Member_Sort"});this.parent.element.appendChild(u);var f=Object(r.createElement)("button",{className:("Ascending"===o?"e-active ":"")+"e-member-sort",id:this.parent.element.id+"_Sort_Ascend"}),e=Object(r.createElement)("button",{className:("Descending"===o?"e-active ":"")+"e-member-sort",id:this.parent.element.id+"_Sort_Descend"}),s=new g.Button({iconCss:h+" e-sort-ascend-icon",enableRtl:this.parent.enableRtl});s.appendTo(f);(s=new g.Button({iconCss:h+" e-sort-descend-icon",enableRtl:this.parent.enableRtl})).appendTo(e);u.appendChild(f);u.appendChild(e);t.appendChild(u);this.unWireEvent(f,n);this.unWireEvent(e,n);this.wireEvent(f,n);this.wireEvent(e,n)}},n.prototype.createLevelWrapper=function(n,t){for(var i=this,o=this.parent.engineModule,u=o.fieldList[t].levels,s=o.fieldList[t].levelCount,f=[],e=0,h=u.length;e<h;e++)f.push({id:u[e].id,text:u[e].name});this.dropMenu=new vr.DropDownButton({cssClass:"e-level-drop",items:f,iconCss:"e-icons e-dropdown-icon",disabled:s===u.length,beforeOpen:function(n){var f=[].slice.call(n.element.querySelectorAll("li")),o=i.parent.engineModule.fieldList[t].levelCount,u,e;for(Object(r.removeClass)(f,"e-disabled"),u=0,e=f.length;u<e;u++)u<o&&Object(r.addClass)([f[u]],"e-disabled")},select:function(n){for(var r,u=i.dialogPopUp.element.getAttribute("data-fieldname"),e=i.parent.engineModule,t=0,o=f.length;t<o;t++)f[t].id===n.item.id&&(r=t);e.getFilterMembers(i.parent.dataSourceSettings,u,r+1,!1,!0)},close:function(){var n=i.parent.engineModule,r=n.fieldList[t].levels;n.fieldList[t].levelCount===r.length?(i.dropMenu.disabled=!0,i.dropMenu.dataBind()):i.dropMenu.disabled=!1}});this.dropMenu.appendTo(n)},n.prototype.searchOlapTreeView=function(n,t,i){var u=this;clearTimeout(this.timeOutObj);this.timeOutObj=setTimeout(function(){var f=u.parent.engineModule,o=u.dialogPopUp.element,e=o.getAttribute("data-fieldname"),s=u.parent.control.maxNodeLimitInMemberEditor?u.parent.control.maxNodeLimitInMemberEditor:5e3,h;f.fieldList[e].isHierarchy?u.parent.eventBase.searchTreeNodes(n,u.memberTreeView,!1,!0):((u.dropMenu.disabled=u.dropMenu&&""!==n.value?!0:!1,u.parent.control.loadOnDemandInMemberEditor)?(h=f.fieldList[e].levelCount?f.fieldList[e].levelCount:1,f.getSearchMembers(u.parent.dataSourceSettings,e,n.value.toLowerCase(),s,!1,h)):f.getSearchMembers(u.parent.dataSourceSettings,e,n.value.toLowerCase(),s,!0),u.parent.eventBase.searchTreeNodes(n,u.memberTreeView,!1,!1));0===[].slice.call(u.memberTreeView.element.querySelectorAll("li")).length?(u.allMemberSelect.disableNodes([u.allMemberSelect.element.querySelector("li")]),o.querySelector(".e-ok-btn").setAttribute("disabled","disabled"),Object(r.removeClass)([t],"e-disable")):(u.allMemberSelect.enableNodes([u.allMemberSelect.element.querySelector("li")]),o.querySelector(".e-ok-btn").removeAttribute("disabled"),Object(r.addClass)([t],"e-disable"));u.updateCheckedState(i)},500)},n.prototype.nodeCheck=function(n,t){var r=[t.node],i;(t.event.target.classList.contains("e-fullrow")||"Enter"===t.event.key)&&(i=n?this.allMemberSelect:this.memberTreeView,"true"===i.getNode(t.node).isChecked?i.uncheckAll(r):i.checkAll(r))},n.prototype.applySorting=function(n,t){var i=Object(r.closest)(t.target,".e-member-sort"),u;i&&(u=[].slice.call(Object(r.closest)(i,".e-filter-sort").querySelectorAll(".e-member-sort")),i.querySelector(".e-sort-ascend-icon")&&!i.classList.contains("e-active")?(this.updateFilterMembers("Ascending",n),Object(r.addClass)([i],"e-active"),Object(r.removeClass)([u[1]],"e-active")):i.querySelector(".e-sort-descend-icon")&&!i.classList.contains("e-active")?(this.updateFilterMembers("Descending",n),Object(r.addClass)([i],"e-active"),Object(r.removeClass)([u[0]],"e-active")):(this.updateFilterMembers("None",n),Object(r.removeClass)(u,"e-active")))},n.prototype.updateFilterMembers=function(n,t){var i="None"===n?e.getClonedData(this.parent.engineModule.fieldList[t].dateMember):this.parent.currentTreeItems.slice(),o,u,s;this.parent.currentTreeItems=[];this.parent.searchTreeItems=[];for(var f=[],r=0,h=(i="Ascending"===n?i.sort(function(n,t){return n.actualText>t.actualText?1:t.actualText>n.actualText?-1:0}):"Descending"===n?i.sort(function(n,t){return n.actualText<t.actualText?1:t.actualText<n.actualText?-1:0}):i).length;r<h;r++)"None"===n?(o=(this.parent.isDateField?i[r].formattedText:i[r].actualText).toString(),u={id:i[r].actualText.toString(),actualText:i[r].actualText,name:o,isSelected:this.parent.currentTreeItemsPos[i[r].actualText].isSelected},this.parent.currentTreeItems.push(u),""!==this.editorSearch.value?u.name.toLowerCase().indexOf(this.editorSearch.value.toLowerCase())>-1&&(this.parent.searchTreeItems.push(u),f.push(u)):(this.parent.searchTreeItems.push(u),f.push(u))):(this.parent.currentTreeItems.push(i[r]),""!==this.editorSearch.value?i[r].name.toLowerCase().indexOf(this.editorSearch.value.toLowerCase())>-1&&(this.parent.searchTreeItems.push(i[r]),f.push(i[r])):(this.parent.searchTreeItems.push(i[r]),f.push(i[r]))),this.parent.currentTreeItemsPos[i[r].actualText].index=r;s=this.memberTreeView.fields.dataSource.length;this.memberTreeView.fields={dataSource:f.slice(0,s),id:"id",text:"name",isChecked:"isSelected",parentID:"pid"};this.memberTreeView.dataBind()},n.prototype.updateChildNodes=function(n){var c,o,l,p;if("olap"===this.parent.dataType){var s=this.parent.engineModule,u=n.node.getAttribute("data-fieldname"),t=s.fieldList[u],a=[];if(t&&t.filterMembers.length>0&&!this.isSearchEnabled&&!t.members[n.nodeData.id].isNodeExpand){for(var f=[],h=0,v=t.filterMembers;h<v.length;h++)c=v[h],c.pid===n.nodeData.id.toString()&&f.push(c);0===f.length&&(t.childMembers=[],s.getChildMembers(this.parent.dataSourceSettings,n.nodeData.id.toString(),u),f=t.childMembers,t.childMembers=[]);var i=e.getClonedData(f),w=this.memberTreeView.fields.dataSource,y=!1;for(Object(r.isNullOrUndefined)(this.filterObject)||(y="Include"===this.filterObject.type,a=this.filterObject.items?this.filterObject.items:[]),i=this.updateChildData(y,i,a,u,n.nodeData),o=0,l=i=this.parent.eventBase.sortOlapFilterData(i,s.fieldList[u].sort);o<l.length;o++)p=l[o],w.push(p);t.members[n.nodeData.id].isNodeExpand=!0;this.memberTreeView.addNodes(i,n.node)}}},n.prototype.updateChildData=function(n,t,i,r,u){for(var s=Object.keys(this.parent.currentTreeItemsPos).length,v=this.parent.engineModule.fieldList[r],h=[],c=1,e=0,l=t;e<l.length;e++){var o=l[e],f=o,a=o.id.toString();v.members[a].isNodeExpand=!1;o.isSelected="true"===u.isChecked;c<=this.parent.control.maxNodeLimitInMemberEditor&&h.push(f);this.parent.currentTreeItems.push(f);this.parent.searchTreeItems.push(f);this.parent.currentTreeItemsPos[a]={index:s,isSelected:f.isSelected};s++;c++}return this.parent.isDataOverflow=!1,h},n.prototype.createTabMenu=function(n,t,i){var c=Object(r.createElement)("div",{className:"e-filter-tab-wrapper"}),o,s,w,u;this.dialogPopUp.content=c;this.dialogPopUp.dataBind();for(var l=["Label","Value","Include","Exclude"],a="((-|\\+)?[0-9]+(\\.[0-9]+)?)+",f=Object.keys(this.parent.engineModule.fieldList[i].members)[0],b=this.parent.engineModule.fieldList[i].type,v=e.getFieldByName(i,this.parent.dataSourceSettings.formatSettings),y=[{header:{text:this.parent.localeObj.getConstant("member"),iconCss:this.filterObject&&l.indexOf(this.filterObject.type)>1?"e-selected-option-icon":""},content:this.createTreeView(n,t,i)}],h=0,p=l;h<p.length;h++)o=p[h],("Label"===o&&this.parent.dataSourceSettings.allowLabelFilter||"Value"===o&&this.parent.dataSourceSettings.allowValueFilter)&&(s="Label"===o&&f&&f.match(a)&&f.match(a)[0].length===f.length&&"number"===b?"Number":"Label"===o&&f&&"Invalid Date"!==new Date(f).toString()&&(v&&v.type||this.filterObject&&"Date"===this.filterObject.type)?"Date":o,w={header:{text:"Number"===s?this.parent.localeObj.getConstant("label"):this.parent.localeObj.getConstant(s.toLowerCase()),iconCss:this.filterObject&&this.filterObject.type===s?"e-selected-option-icon":""},content:this.createCustomFilter(i,this.filterObject&&this.filterObject.type===s?this.filterObject:void 0,s.toLowerCase())},y.push(w));u=this.filterObject?["Label","Date","Number"].indexOf(this.filterObject.type)>=0?1:"Value"===this.filterObject.type?this.parent.dataSourceSettings.allowLabelFilter&&this.parent.dataSourceSettings.allowValueFilter?2:1:0:0;u=this.parent.dataSourceSettings.allowMemberFilter||0!==u?u:1;this.tabObj=new rt.Tab({heightAdjustMode:"Auto",items:y,height:"100%",selectedItem:u,enableRtl:this.parent.enableRtl});this.tabObj.isStringTemplate=!0;this.tabObj.appendTo(c);this.parent.dataSourceSettings.allowMemberFilter||this.tabObj.hideTab(0);u>0&&Object(r.addClass)([this.dialogPopUp.element.querySelector(".e-filter-div-content."+(1===u&&this.parent.dataSourceSettings.allowLabelFilter?"e-label-filter":"e-value-filter"))],"e-selected-tab")},n.prototype.createCustomFilter=function(n,t,i){for(var y,e,ut,c,p,o,vt,w,et,b,ht=[],ct=[],u=[],s=this.parent.dataSourceSettings.values,f="DoesNotEquals",v=0,l=0,nt={label:["Equals","DoesNotEquals","BeginWith","DoesNotBeginWith","EndsWith","DoesNotEndsWith","Contains","DoesNotContains","GreaterThan","GreaterThanOrEqualTo","LessThan","LessThanOrEqualTo","Between","NotBetween"],date:["Equals","DoesNotEquals","Before","BeforeOrEqualTo","After","AfterOrEqualTo","Between","NotBetween"],value:["Equals","DoesNotEquals","GreaterThan","GreaterThanOrEqualTo","LessThan","LessThanOrEqualTo","Between","NotBetween"]},tt=["Between","NotBetween"],it="label"===i?nt.label:"date"===i?nt.date:nt.value,rt=0,lt=it;rt<lt.length;rt++)y=lt[rt],f=t&&y===t.condition?it.indexOf(t.condition)>=0?t.condition:it[0]:f,ht.push({value:y,text:this.parent.localeObj.getConstant(y)});for(e=s.length;e--;)ct.unshift({value:s[e].name,text:s[e].caption?s[e].caption:s[e].name}),v=t&&"Value"===t.type&&t.measure===s[e].name&&t.condition===f?e:v;if("olap"===this.parent.dataType)if(ut=this.parent.engineModule,c=ut.fieldList[n].levels,this.parent.engineModule.fieldList[n].isHierarchy){for(var a=void 0,ft=0,at=this.parent.engineModule.fieldListData;ft<at.length;ft++)if(p=at[ft],p&&p.pid===n){a=p;break}u.push({value:a?a.id:n,text:a?a.caption:ut.fieldList[n].name});l=0;t&&t.name===n&&t.type.toLowerCase()===i&&(u[u.length-1].iconClass=h+" e-selected-level-icon")}else for(o=0,vt=c.length;o<vt;o++)for(l=t&&t.selectedField===c[o].id?o:l,u.push({value:c[o].id,text:c[o].name}),w=0,et=this.parent.dataSourceSettings.filterSettings;w<et.length;w++)if(b=et[w],b.name===n&&b.selectedField===c[o].id&&b.type.toLowerCase()===i){u[u.length-1].iconClass=h+" e-selected-level-icon";break}var k=Object(r.createElement)("div",{className:"e-filter-div-content e-"+(["date","number"].indexOf(i)>=0?"label":i)+"-filter",id:this.parent.parentID+"_"+i+"_filter_div_content",attrs:{"data-type":i,"data-fieldName":n,"data-operator":f,"data-selectedField":"olap"===this.parent.dataType&&u.length>0?u[l].value.toString():"","data-measure":this.parent.dataSourceSettings.values.length>0?this.parent.dataSourceSettings.values[v].name:"","data-value1":t&&f===t.condition&&t.value1?t.value1.toString():"","data-value2":t&&f===t.condition&&t.value2?t.value2.toString():""}}),ii=Object(r.createElement)("div",{className:"e-filter-text-div",innerHTML:this.parent.localeObj.getConstant(i+"TextContent")}),ri=Object(r.createElement)("div",{className:"e-between-text-div "+(-1===tt.indexOf(f)?"e-disable":""),innerHTML:this.parent.localeObj.getConstant("And")}),yt=Object(r.createElement)("div",{className:"e-separator-div"}),d=Object(r.createElement)("div",{className:"e-filter-option-wrapper-1"}),ot=Object(r.createElement)("div",{className:"e-level-option-wrapper "+("olap"===this.parent.dataType?"":"e-disable")}),st=Object(r.createElement)("div",{className:"e-measure-option-wrapper "+(["label","date","number"].indexOf(i)>=0?"e-disable":"")}),pt=Object(r.createElement)("div",{className:"e-condition-option-wrapper"}),g=Object(r.createElement)("div",{className:"e-filter-option-wrapper-2"}),wt=Object(r.createElement)("div",{id:this.parent.parentID+"_"+i+"_level_option_wrapper"}),bt=Object(r.createElement)("div",{id:this.parent.parentID+"_"+i+"_measure_option_wrapper"}),kt=Object(r.createElement)("div",{id:this.parent.parentID+"_"+i+"_contition_option_wrapper"}),dt=Object(r.createElement)("div",{className:"e-filter-input-div-1"}),gt=Object(r.createElement)("div",{className:"e-filter-input-div-2 "+(-1===tt.indexOf(f)?"e-disable":"")}),ni=Object(r.createElement)("input",{id:this.parent.parentID+"_"+i+"_input_option_1",attrs:{type:"text"}}),ti=Object(r.createElement)("input",{id:this.parent.parentID+"_"+i+"_input_option_2",attrs:{type:"text"}});return dt.appendChild(ni),gt.appendChild(ti),ot.appendChild(wt),ot.appendChild(yt.cloneNode(!0)),st.appendChild(bt),st.appendChild(yt),pt.appendChild(kt),d.appendChild(ot),d.appendChild(st),d.appendChild(pt),g.appendChild(dt),g.appendChild(ri),g.appendChild(gt),this.createElements(t,tt,bt,kt,ni,ti,ct,ht,v,f,i,wt,u,l),k.appendChild(ii),k.appendChild(d),k.appendChild(g),k},n.prototype.createElements=function(n,t,i,u,f,e,o,s,h,l,v,y,p,w){var k=this,et,tt,d,it,rt,g,nt,ut,ft;"olap"===this.parent.dataType&&(et=new a.DropDownList({dataSource:p,enableRtl:this.parent.enableRtl,fields:{value:"value",text:"text",iconCss:"iconClass"},index:w,cssClass:"e-level-options",width:"100%",change:function(n){var s=k.dialogPopUp.element.querySelector(".e-selected-tab"),y=s.getAttribute("data-fieldName"),h=s.getAttribute("data-type"),t,l,v,a,i,u;if(!Object(r.isNullOrUndefined)(s)){for(k.updateInputValues(s,h,f,e),Object(c.setStyleAndAttributes)(s,{"data-selectedField":n.value}),l=0,v=k.parent.dataSourceSettings.filterSettings;l<v.length;l++)if(a=v[l],a.name===y&&a.selectedField===n.value){t=a;break}t&&("value"===h&&t.measure&&""!==t.measure&&(tt.value=t.measure?t.measure:o[0].value),d.value=t.condition?t.condition?t.condition:"DoesNotEquals":"DoesNotEquals",i=void 0,u=void 0,"value"===h?(i=f.ej2_instances[0],u=e.ej2_instances[0],i&&(i.value=t.value1?parseInt(t.value1,10):void 0),u&&(u.value=t.value2?parseInt(t.value2,10):void 0)):(i=f.ej2_instances[0],u=e.ej2_instances[0],i&&(i.value=t.value1?t.value1:""),u&&(u.value=t.value2?t.value2:"")));k.updateInputValues(s,h,f,e)}}}),et.isStringTemplate=!0,et.appendTo(y));tt=new a.DropDownList({dataSource:o,enableRtl:this.parent.enableRtl,fields:{value:"value",text:"text"},index:h,cssClass:"e-value-options",width:"100%",change:function(n){var t=k.dialogPopUp.element.querySelector(".e-selected-tab");Object(r.isNullOrUndefined)(t)||(k.updateInputValues(t,v,f,e),Object(c.setStyleAndAttributes)(t,{"data-measure":n.value}))}});tt.isStringTemplate=!0;tt.appendTo(i);d=new a.DropDownList({dataSource:s,enableRtl:this.parent.enableRtl,fields:{value:"value",text:"text"},value:l,cssClass:"e-filter-operator",width:"100%",change:function(n){var i=k.dialogPopUp.element.querySelector(".e-selected-tab"),u,o,s;if(!Object(r.isNullOrUndefined)(i)){for(k.updateInputValues(i,v,f,e),u=0,o=["e-between-text-div","e-filter-input-div-2"];u<o.length;u++)s=o[u],t.indexOf(n.value)>=0?Object(r.removeClass)([i.querySelector("."+s)],"e-disable"):Object(r.addClass)([i.querySelector("."+s)],"e-disable");Object(c.setStyleAndAttributes)(i,{"data-operator":n.value})}}});(d.isStringTemplate=!0,d.appendTo(u),"date"===v)?(it=new yi.DateTimePicker({placeholder:this.parent.localeObj.getConstant("chooseDate"),enableRtl:this.parent.enableRtl,format:"dd/MM/yyyy hh:mm:ss a",showClearButton:!0,value:n&&l===n.condition?"string"==typeof n.value1?new Date(n.value1):n.value1:null,change:function(n){var t=k.dialogPopUp.element.querySelector(".e-selected-tab");Object(r.isNullOrUndefined)(t)||Object(c.setStyleAndAttributes)(t,{"data-value1":n.value,"data-value2":rt.value})},width:"100%"}),rt=new yi.DateTimePicker({placeholder:this.parent.localeObj.getConstant("chooseDate"),enableRtl:this.parent.enableRtl,format:"dd/MM/yyyy hh:mm:ss a",showClearButton:!0,value:n&&l===n.condition?"string"==typeof n.value2?new Date(n.value2):n.value2:null,change:function(n){var t=k.dialogPopUp.element.querySelector(".e-selected-tab");Object(r.isNullOrUndefined)(t)||Object(c.setStyleAndAttributes)(t,{"data-value1":it.value,"data-value2":n.value})},width:"100%"}),it.isStringTemplate=!0,it.appendTo(f),rt.isStringTemplate=!0,rt.appendTo(e)):"value"===v?(g=new b.NumericTextBox({placeholder:this.parent.localeObj.getConstant("enterValue"),enableRtl:this.parent.enableRtl,showClearButton:!0,format:"###.##",value:n&&l===n.condition?parseInt(n.value1,10):void 0,change:function(n){var t=k.dialogPopUp.element.querySelector(".e-selected-tab");Object(r.isNullOrUndefined)(t)||Object(c.setStyleAndAttributes)(t,{"data-value1":n.value?n.value.toString():"0","data-value2":nt.value?nt.value.toString():"0"})},width:"100%"}),nt=new b.NumericTextBox({placeholder:this.parent.localeObj.getConstant("enterValue"),enableRtl:this.parent.enableRtl,showClearButton:!0,format:"###.##",value:n&&l===n.condition?parseInt(n.value2,10):void 0,change:function(n){var t=k.dialogPopUp.element.querySelector(".e-selected-tab");Object(r.isNullOrUndefined)(t)||Object(c.setStyleAndAttributes)(t,{"data-value1":g.value?g.value.toString():"0","data-value2":n.value?n.value.toString():"0"})},width:"100%"}),g.isStringTemplate=!0,g.appendTo(f),nt.isStringTemplate=!0,nt.appendTo(e)):(ut=new b.MaskedTextBox({placeholder:this.parent.localeObj.getConstant("enterValue"),enableRtl:this.parent.enableRtl,showClearButton:!0,value:n&&l===n.condition?n.value1:"",change:function(n){var t=k.dialogPopUp.element.querySelector(".e-selected-tab");Object(r.isNullOrUndefined)(t)||Object(c.setStyleAndAttributes)(t,{"data-value1":n.value,"data-value2":ft.value})},width:"100%"}),ft=new b.MaskedTextBox({placeholder:this.parent.localeObj.getConstant("enterValue"),enableRtl:this.parent.enableRtl,showClearButton:!0,value:n&&l===n.condition?n.value2:"",change:function(n){var t=k.dialogPopUp.element.querySelector(".e-selected-tab");Object(r.isNullOrUndefined)(t)||Object(c.setStyleAndAttributes)(t,{"data-value1":ut.value,"data-value2":n.value})},width:"100%"}),ut.isStringTemplate=!0,ut.appendTo(f),ft.isStringTemplate=!0,ft.appendTo(e))},n.prototype.updateInputValues=function(n,t,i,u){var o,s,f,e;"date"===t?(f=i.ej2_instances[0],e=u.ej2_instances[0],o=Object(r.isNullOrUndefined)(f.value)?"":f.value.toString(),s=Object(r.isNullOrUndefined)(e.value)?"":e.value.toString()):(f=i.ej2_instances[0],e=u.ej2_instances[0],o=f.value,s=e.value);Object(c.setStyleAndAttributes)(n,{"data-value1":o,"data-value2":s})},n.prototype.validateTreeNode=function(n){n.node.classList.contains("e-disable")&&(n.cancel=!0)},n.prototype.updateCheckedState=function(){var n=this.dialogPopUp.element;Object(c.setStyleAndAttributes)(n,{role:"menu","aria-haspopup":"true"});var e=[].slice.call(this.memberTreeView.element.querySelectorAll("li")),i=n.getAttribute("data-fieldname"),u=this.getUnCheckedNodes(i),f=this.getCheckedNodes(i),t=this.allMemberSelect.element.querySelector("li").querySelector("span.e-frame");e.length>0?f>0?(u>0?(Object(r.removeClass)([t],"e-check"),Object(r.addClass)([t],"e-stop")):0===u&&(Object(r.removeClass)([t],"e-stop"),Object(r.addClass)([t],"e-check")),this.dialogPopUp.buttons[0].buttonModel.disabled=!1,n.querySelector(".e-ok-btn").removeAttribute("disabled")):u>0&&0===f&&(Object(r.removeClass)([t],["e-check","e-stop"]),this.getCheckedNodes(i)===f&&(this.dialogPopUp.buttons[0].buttonModel.disabled=!0,n.querySelector(".e-ok-btn").setAttribute("disabled","disabled"))):(this.dialogPopUp.buttons[0].buttonModel.disabled=!0,n.querySelector(".e-ok-btn").setAttribute("disabled","disabled"))},n.prototype.getCheckedNodes=function(n){var u=this.parent.engineModule,f=[],t,i,r;if("olap"===this.parent.dataType&&u&&!u.fieldList[n].isHierarchy)return this.memberTreeView.getAllCheckedNodes().length;for(t=0,i=this.parent.searchTreeItems;t<i.length;t++)r=i[t],r.isSelected&&f.push(r);return f.length},n.prototype.getUnCheckedNodes=function(n){var u=[],f=[],e=this.parent.engineModule,t,i,r;if("olap"===this.parent.dataType&&e&&!e.fieldList[n].isHierarchy)return f=this.memberTreeView.getAllCheckedNodes(),this.memberTreeView.fields.dataSource.length-f.length;for(t=0,i=this.parent.searchTreeItems;t<i.length;t++)r=i[t],r.isSelected||u.push(r);return u.length},n.prototype.isExcelFilter=function(n){for(var i=!1,t=0,r=this.parent.dataSourceSettings.filters;t<r.length;t++)if(r[t].name===n){i=!0;break}return!(i||!this.parent.dataSourceSettings.allowLabelFilter&&!this.parent.dataSourceSettings.allowValueFilter)},n.prototype.getFilterObject=function(n){var t=e.getFilterItemByName(n,e.cloneFilterSettings(this.parent.dataSourceSettings.filterSettings));if(t&&(["Label","Date","Number"].indexOf(t.type)>=0&&this.parent.dataSourceSettings.allowLabelFilter||"Value"===t.type&&this.parent.dataSourceSettings.allowValueFilter||["Include","Exclude"].indexOf(t.type)>=0&&this.parent.eventBase.isValidFilterItemsAvail(n,t)))return t},n.prototype.wireEvent=function(n,t){r.EventHandler.add(n,"click",this.applySorting.bind(this,t),this)},n.prototype.unWireEvent=function(n){r.EventHandler.remove(n,"click",this.applySorting)},n.prototype.closeFilterDialog=function(){this.allowExcelLikeFilter&&this.tabObj&&!this.tabObj.isDestroyed&&this.tabObj.destroy();this.dropMenu&&!this.dropMenu.isDestroyed&&this.dropMenu.destroy();document.getElementById(this.parent.parentID+"_LevelDiv-popup")&&Object(r.remove)(document.getElementById(this.parent.parentID+"_LevelDiv-popup"));this.dialogPopUp.close()},n.prototype.removeFilterDialog=function(){this.dialogPopUp&&document.getElementById(this.dialogPopUp.element.id)&&!this.dialogPopUp.isDestroyed&&this.dialogPopUp.destroy();document.getElementById(this.parent.parentID+"_EditorTreeView")&&Object(r.remove)(document.getElementById(this.parent.parentID+"_EditorTreeView"))},n}(),pi=function(){function n(n){return this.currentTreeItems=[],this.savedTreeFilterPos={},this.currentTreeItemsPos={},this.searchTreeItems=[],this.isDataOverflow=!1,this.isDateField=!1,this.element=n.element,this.moduleName=n.moduleName,this.dataSourceSettings=n.dataSourceSettings,this.engineModule=n.pivotEngine,this.enableRtl=n.enableRtl,this.isAdaptive=n.isAdaptive,this.renderMode=n.renderMode,this.parentID=n.id,this.localeObj=n.localeObj,this.dataType=n.dataType,this.nodeStateModified=new cr(this),this.dataSourceUpdate=new lr(this),this.eventBase=new hr(this),this.filterDialog=new yr(this),this.errorDialog=new ar(this),this.keyboardModule=new sr(this),this}return n.prototype.destroy=function(){this.keyboardModule&&this.keyboardModule.destroy()},n}(),pr=function(){function n(n){this.parent=n;this.parent.commonModule=this;this.addEventListener()}return n.prototype.getModuleName=function(){return"common"},n.prototype.initiateCommonModule=function(){if(this.parent.pivotCommon)this.parent.pivotCommon.element=this.parent.element,this.parent.pivotCommon.engineModule="olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule,this.parent.pivotCommon.parentID=this.parent.element.id,this.parent.pivotCommon.dataSourceSettings=this.parent.dataSourceSettings.properties?this.parent.dataSourceSettings.properties:this.parent.dataSourceSettings,this.parent.pivotCommon.moduleName=this.parent.getModuleName(),this.parent.pivotCommon.enableRtl=this.parent.enableRtl,this.parent.pivotCommon.isAdaptive=r.Browser.isDevice,this.parent.pivotCommon.renderMode="Popup",this.parent.pivotCommon.localeObj=this.parent.localeObj,this.parent.pivotCommon.dataType=this.parent.dataType;else{var n={pivotEngine:"olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule,dataSourceSettings:this.parent.dataSourceSettings.properties?this.parent.dataSourceSettings.properties:this.parent.dataSourceSettings,id:this.parent.element.id,element:this.parent.element,moduleName:this.parent.getModuleName(),enableRtl:this.parent.enableRtl,isAdaptive:r.Browser.isDevice,renderMode:"Popup",localeObj:this.parent.localeObj,dataType:this.parent.dataType};this.parent.pivotCommon=new pi(n)}this.parent.pivotCommon.control=this.parent},n.prototype.addEventListener=function(){this.handlers={load:this.initiateCommonModule};this.parent.isDestroyed||(this.parent.gridSettings.contextMenuItems&&(this.parent.showFieldList&&this.parent.showGroupingBar||this.parent.on("initial-load",this.handlers.load,this)),this.parent.on(ft,this.handlers.load,this))},n.prototype.removeEventListener=function(){this.parent.isDestroyed||this.parent.off(ft,this.handlers.load)},n.prototype.destroy=function(){this.removeEventListener();this.parent.pivotCommon&&this.parent.pivotCommon.destroy()},n}(),ot=(ei=function(n,t){return(ei=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}ei(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),o=function(n,t,i,r){var f,e=arguments.length,u=e<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r,o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(n,t,i,r);else for(o=n.length-1;o>=0;o--)(f=n[o])&&(u=(e<3?f(u):e>3?f(t,i,u):f(t,i))||u);return e>3&&u&&Object.defineProperty(t,i,u),u},ri=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return ot(t,n),o([Object(r.Property)()],t.prototype,"name",void 0),o([Object(r.Property)()],t.prototype,"caption",void 0),o([Object(r.Property)("Sum")],t.prototype,"type",void 0),o([Object(r.Property)()],t.prototype,"axis",void 0),o([Object(r.Property)(!1)],t.prototype,"showNoDataItems",void 0),o([Object(r.Property)()],t.prototype,"baseField",void 0),o([Object(r.Property)()],t.prototype,"baseItem",void 0),o([Object(r.Property)(!0)],t.prototype,"showSubTotals",void 0),o([Object(r.Property)(!1)],t.prototype,"isNamedSet",void 0),o([Object(r.Property)(!1)],t.prototype,"isCalculatedField",void 0),o([Object(r.Property)(!0)],t.prototype,"showFilterIcon",void 0),o([Object(r.Property)(!0)],t.prototype,"showSortIcon",void 0),o([Object(r.Property)(!0)],t.prototype,"showRemoveIcon",void 0),o([Object(r.Property)(!0)],t.prototype,"showValueTypeIcon",void 0),o([Object(r.Property)(!0)],t.prototype,"showEditIcon",void 0),o([Object(r.Property)(!0)],t.prototype,"allowDragAndDrop",void 0),t}(r.ChildProperty),wr=(r.ChildProperty,function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return ot(t,n),o([Object(r.Property)()],t.prototype,"name",void 0),o([Object(r.Property)("Include")],t.prototype,"type",void 0),o([Object(r.Property)()],t.prototype,"items",void 0),o([Object(r.Property)("DoesNotEquals")],t.prototype,"condition",void 0),o([Object(r.Property)()],t.prototype,"value1",void 0),o([Object(r.Property)()],t.prototype,"value2",void 0),o([Object(r.Property)()],t.prototype,"measure",void 0),o([Object(r.Property)(1)],t.prototype,"levelCount",void 0),o([Object(r.Property)()],t.prototype,"selectedField",void 0),t}(r.ChildProperty)),br=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return ot(t,n),o([Object(r.Property)()],t.prototype,"measure",void 0),o([Object(r.Property)()],t.prototype,"label",void 0),o([Object(r.Property)()],t.prototype,"conditions",void 0),o([Object(r.Property)()],t.prototype,"value1",void 0),o([Object(r.Property)()],t.prototype,"value2",void 0),o([Object(r.Property)()],t.prototype,"style",void 0),o([Object(r.Property)(!0)],t.prototype,"applyGrandTotals",void 0),t}(r.ChildProperty),kr=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return ot(t,n),o([Object(r.Property)()],t.prototype,"name",void 0),o([Object(r.Property)("Ascending")],t.prototype,"order",void 0),t}(r.ChildProperty),dr=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return ot(t,n),o([Object(r.Property)()],t.prototype,"name",void 0),o([Object(r.Property)()],t.prototype,"minimumFractionDigits",void 0),o([Object(r.Property)()],t.prototype,"maximumFractionDigits",void 0),o([Object(r.Property)()],t.prototype,"minimumSignificantDigits",void 0),o([Object(r.Property)()],t.prototype,"maximumSignificantDigits",void 0),o([Object(r.Property)(!0)],t.prototype,"useGrouping",void 0),o([Object(r.Property)()],t.prototype,"skeleton",void 0),o([Object(r.Property)()],t.prototype,"type",void 0),o([Object(r.Property)()],t.prototype,"currency",void 0),o([Object(r.Property)()],t.prototype,"minimumIntegerDigits",void 0),o([Object(r.Property)()],t.prototype,"format",void 0),t}(r.ChildProperty),gr=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return ot(t,n),o([Object(r.Property)()],t.prototype,"name",void 0),o([Object(r.Property)()],t.prototype,"groupInterval",void 0),o([Object(r.Property)()],t.prototype,"startingAt",void 0),o([Object(r.Property)()],t.prototype,"endingAt",void 0),o([Object(r.Property)("Date")],t.prototype,"type",void 0),o([Object(r.Property)()],t.prototype,"rangeInterval",void 0),o([Object(r.Property)()],t.prototype,"caption",void 0),o([Object(r.Property)()],t.prototype,"customGroups",void 0),t}(r.ChildProperty),nu=(r.ChildProperty,function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return ot(t,n),o([Object(r.Property)()],t.prototype,"name",void 0),o([Object(r.Property)()],t.prototype,"formula",void 0),o([Object(r.Property)()],t.prototype,"hierarchyUniqueName",void 0),o([Object(r.Property)()],t.prototype,"formatString",void 0),t}(r.ChildProperty)),tu=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return ot(t,n),o([Object(r.Property)()],t.prototype,"name",void 0),o([Object(r.Property)()],t.prototype,"items",void 0),o([Object(r.Property)()],t.prototype,"delimiter",void 0),t}(r.ChildProperty),iu=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return ot(t,n),o([Object(r.Property)()],t.prototype,"headerText",void 0),o([Object(r.Property)(".")],t.prototype,"headerDelimiter",void 0),o([Object(r.Property)("None")],t.prototype,"sortOrder",void 0),o([Object(r.Property)()],t.prototype,"measure",void 0),t}(r.ChildProperty),ru=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return ot(t,n),o([Object(r.Property)()],t.prototype,"userName",void 0),o([Object(r.Property)()],t.prototype,"password",void 0),t}(r.ChildProperty),wi=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return ot(t,n),o([Object(r.Property)()],t.prototype,"catalog",void 0),o([Object(r.Property)()],t.prototype,"cube",void 0),o([Object(r.Property)("Relational")],t.prototype,"providerType",void 0),o([Object(r.Property)()],t.prototype,"url",void 0),o([Object(r.Property)(1033)],t.prototype,"localeIdentifier",void 0),o([Object(r.Property)()],t.prototype,"dataSource",void 0),o([Object(r.Collection)([],ri)],t.prototype,"rows",void 0),o([Object(r.Collection)([],ri)],t.prototype,"columns",void 0),o([Object(r.Collection)([],ri)],t.prototype,"values",void 0),o([Object(r.Collection)([],ri)],t.prototype,"filters",void 0),o([Object(r.Property)([])],t.prototype,"excludeFields",void 0),o([Object(r.Property)(!1)],t.prototype,"expandAll",void 0),o([Object(r.Property)("column")],t.prototype,"valueAxis",void 0),o([Object(r.Collection)([],wr)],t.prototype,"filterSettings",void 0),o([Object(r.Collection)([],kr)],t.prototype,"sortSettings",void 0),o([Object(r.Property)(!0)],t.prototype,"enableSorting",void 0),o([Object(r.Property)(!0)],t.prototype,"allowMemberFilter",void 0),o([Object(r.Property)(!1)],t.prototype,"allowLabelFilter",void 0),o([Object(r.Property)(!1)],t.prototype,"allowValueFilter",void 0),o([Object(r.Property)(!0)],t.prototype,"showSubTotals",void 0),o([Object(r.Property)(!0)],t.prototype,"showRowSubTotals",void 0),o([Object(r.Property)(!0)],t.prototype,"showColumnSubTotals",void 0),o([Object(r.Property)(!0)],t.prototype,"showGrandTotals",void 0),o([Object(r.Property)(!0)],t.prototype,"showRowGrandTotals",void 0),o([Object(r.Property)(!0)],t.prototype,"showColumnGrandTotals",void 0),o([Object(r.Property)(!1)],t.prototype,"alwaysShowValueHeader",void 0),o([Object(r.Property)(!0)],t.prototype,"showHeaderWhenEmpty",void 0),o([Object(r.Property)(!0)],t.prototype,"showAggregationOnValueField",void 0),o([Object(r.Collection)([],dr)],t.prototype,"formatSettings",void 0),o([Object(r.Collection)([],tu)],t.prototype,"drilledMembers",void 0),o([Object(r.Complex)({},iu)],t.prototype,"valueSortSettings",void 0),o([Object(r.Collection)([],nu)],t.prototype,"calculatedFieldSettings",void 0),o([Object(r.Collection)([],br)],t.prototype,"conditionalFormatSettings",void 0),o([Object(r.Property)()],t.prototype,"emptyCellsTextContent",void 0),o([Object(r.Collection)([],gr)],t.prototype,"groupSettings",void 0),o([Object(r.Complex)({},ru)],t.prototype,"authentication",void 0),t}(r.ChildProperty),uu=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),l=function(n,t,i,r){var f,e=arguments.length,u=e<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r,o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(n,t,i,r);else for(o=n.length-1;o>=0;o--)(f=n[o])&&(u=(e<3?f(u):e>3?f(t,i,u):f(t,i))||u);return e>3&&u&&Object.defineProperty(t,i,u),u},fu=(r.ChildProperty,function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return uu(t,n),l([Object(r.Property)("auto")],t.prototype,"height",void 0),l([Object(r.Property)("auto")],t.prototype,"width",void 0),l([Object(r.Property)("Both")],t.prototype,"gridLines",void 0),l([Object(r.Property)(!1)],t.prototype,"allowTextWrap",void 0),l([Object(r.Property)(!1)],t.prototype,"allowReordering",void 0),l([Object(r.Property)(!0)],t.prototype,"allowResizing",void 0),l([Object(r.Property)(null)],t.prototype,"rowHeight",void 0),l([Object(r.Property)(110)],t.prototype,"columnWidth",void 0),l([Object(r.Property)("Ellipsis")],t.prototype,"clipMode",void 0),l([Object(r.Property)(!1)],t.prototype,"allowSelection",void 0),l([Object(r.Property)(-1)],t.prototype,"selectedRowIndex",void 0),l([Object(r.Property)({mode:"Row",cellSelectionMode:"Flow",type:"Single"})],t.prototype,"selectionSettings",void 0),l([Object(r.Property)({WrapMode:"Both"})],t.prototype,"textWrapSettings",void 0),l([Object(r.Property)("AllPages")],t.prototype,"printMode",void 0),l([Object(r.Property)()],t.prototype,"contextMenuItems",void 0),l([Object(r.Event)()],t.prototype,"beforeCopy",void 0),l([Object(r.Event)()],t.prototype,"printComplete",void 0),l([Object(r.Event)()],t.prototype,"beforePrint",void 0),l([Object(r.Event)()],t.prototype,"beforePdfExport",void 0),l([Object(r.Event)()],t.prototype,"beforeExcelExport",void 0),l([Object(r.Event)()],t.prototype,"contextMenuOpen",void 0),l([Object(r.Event)()],t.prototype,"contextMenuClick",void 0),l([Object(r.Event)()],t.prototype,"queryCellInfo",void 0),l([Object(r.Event)()],t.prototype,"headerCellInfo",void 0),l([Object(r.Event)()],t.prototype,"rowSelecting",void 0),l([Object(r.Event)()],t.prototype,"rowSelected",void 0),l([Object(r.Event)()],t.prototype,"rowDeselecting",void 0),l([Object(r.Event)()],t.prototype,"rowDeselected",void 0),l([Object(r.Event)()],t.prototype,"cellSelecting",void 0),l([Object(r.Event)()],t.prototype,"cellSelected",void 0),l([Object(r.Event)()],t.prototype,"cellDeselecting",void 0),l([Object(r.Event)()],t.prototype,"cellDeselected",void 0),l([Object(r.Event)()],t.prototype,"resizeStart",void 0),l([Object(r.Event)()],t.prototype,"resizing",void 0),l([Object(r.Event)()],t.prototype,"resizeStop",void 0),l([Object(r.Event)()],t.prototype,"pdfHeaderQueryCellInfo",void 0),l([Object(r.Event)()],t.prototype,"pdfQueryCellInfo",void 0),l([Object(r.Event)()],t.prototype,"excelHeaderQueryCellInfo",void 0),l([Object(r.Event)()],t.prototype,"excelQueryCellInfo",void 0),l([Object(r.Event)()],t.prototype,"columnDragStart",void 0),l([Object(r.Event)()],t.prototype,"columnDrag",void 0),l([Object(r.Event)()],t.prototype,"columnDrop",void 0),l([Object(r.Event)()],t.prototype,"columnRender",void 0),t}(r.ChildProperty)),eu=i(13),ou=function(){function n(n){this.parent=n}return n.prototype.getModuleName=function(){return"excelExport"},n.prototype.exportToExcel=function(n){var v,y,b,c,i,u,t,h,tt,l,a;this.engine="olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule;y=e.getClonedPivotValues(this.engine.pivotValues);this.parent.exportAllPages&&this.parent.enableVirtualization&&"olap"!==this.parent.dataType?(b=this.engine.pageSettings,this.engine.pageSettings=null,this.engine.generateGridData(this.parent.dataSourceSettings),this.parent.applyFormatting(this.engine.pivotValues),v=e.getClonedPivotValues(this.engine.pivotValues),this.engine.pivotValues=y,this.engine.pageSettings=b):v=y;c={fileName:"default",header:"",footer:"",dataCollections:[v]};this.parent.trigger("beforeExport",c);for(var it=c.fileName,k=c.dataCollections,d=[],p=0;p<k.length;p++){for(var s=k[p],w=0,rt=s.length,g=0,ut=this.parent.renderModule.getFormatList(),nt=[],f=0,o=0;o<rt;o++)if(s[o]){for(g++,w=s[o].length,i=[],u=0;u<w;u++)s[o][u]?(t=s[o][u],(-1!==t.level||t.rowSpan)&&(h="value"===t.axis?t.value:t.formattedText,(h="grand sum"===t.type?this.parent.localeObj.getConstant("grandTotal"):"sum"===t.type?h.toString().replace("Total",this.parent.localeObj.getConstant("total")):h,-1!==t.level||t.rowSpan)&&((i.push({index:u+1,value:h,colSpan:t.colSpan,rowSpan:-1===t.rowSpan?1:t.rowSpan}),"value"===t.axis)?((isNaN(t.value)||""===t.formattedText||void 0===t.formattedText||Object(r.isNullOrUndefined)(t.value))&&(i[i.length-1].value=""),tt="row"===this.parent.dataSourceSettings.valueAxis&&"olap"===this.parent.dataType&&t.rowOrdinal&&this.engine.tupRowInfo[t.rowOrdinal]?this.engine.tupRowInfo[t.rowOrdinal].measureName:t.actualText,i[i.length-1].style={numberFormat:ut[tt],bold:!1,wrapText:!0},t.style&&(i[i.length-1].style.backColor=t.style.backgroundColor,i[i.length-1].style.fontColor=t.style.color,i[i.length-1].style.fontName=t.style.fontFamily,i[i.length-1].style.fontSize=Number(t.style.fontSize.split("px")[0]))):(i[i.length-1].style={bold:!0,vAlign:"Center",wrapText:!0,indent:0===u?10*t.level:0},"row"===t.axis&&0===u)&&((i[i.length-1].style.hAlign="Left","olap"===this.parent.dataType)?(l=this.parent.renderModule.indentCollection[o],i[i.length-1].style.indent=2*l,f=f>l?f:l):(i[i.length-1].style.indent=2*t.level,f=t.level>f?t.level:f)),i[i.length-1].style.borders={color:"#000000",lineStyle:"Thin"})),u+=t.colSpan?t.colSpan-1:0):i.push({index:u+1,value:"",colSpan:1,rowSpan:1});nt.push({index:g,cells:i})}for(a=[],u=0;u<w;u++)a.push({index:u+1,width:100});f>0&&(a[0].width=100+20*f);d.push({columns:a,rows:nt})}new eu.Workbook({worksheets:d},"Excel"===n?"xlsx":"csv").save(it+("Excel"===n?".xlsx":".csv"))},n.prototype.destroy=function(){},n}(),s=i(1),su=function(){function n(n){this.parent=n}return n.prototype.getModuleName=function(){return"pdfExport"},n.prototype.addPage=function(n){var t=n.document.pages.add(),o=n.args.header,h=n.args.footer,r=new s.PdfStandardFont(s.PdfFontFamily.TimesRoman,15,s.PdfFontStyle.Regular),u=new s.PdfSolidBrush(new s.PdfColor(0,0,0)),f=new s.PdfPen(new s.PdfColor(0,0,0),.5),e=new s.PdfPageTemplateElement(new s.RectangleF(0,0,t.graphics.clientSize.width,20)),i;return e.graphics.drawString(o,r,f,u,0,0,new s.PdfStringFormat(s.PdfTextAlignment.Center)),n.document.template.top=e,i=new s.PdfPageTemplateElement(new s.RectangleF(0,0,t.graphics.clientSize.width,20)),i.graphics.drawString(h,r,f,u,0,0,new s.PdfStringFormat(s.PdfTextAlignment.Center)),n.document.template.bottom=i,t},n.prototype.hexDecToRgb=function(n){if(null===n||""===n||7!==n.length)throw new Error("please set valid hex value for color..");n=n.substring(1);var t=parseInt(n,16);return{r:t>>16&255,g:t>>8&255,b:255&t}},n.prototype.getFontStyle=function(n){var t=s.PdfFontStyle.Regular;return!Object(r.isNullOrUndefined)(n)&&n.bold&&(t|=s.PdfFontStyle.Bold),!Object(r.isNullOrUndefined)(n)&&n.italic&&(t|=s.PdfFontStyle.Italic),!Object(r.isNullOrUndefined)(n)&&n.underline&&(t|=s.PdfFontStyle.Underline),!Object(r.isNullOrUndefined)(n)&&n.strikeout&&(t|=s.PdfFontStyle.Strikeout),t},n.prototype.getBorderStyle=function(n){var i=new s.PdfBorders,e,t,f;if(Object(r.isNullOrUndefined)(n))e=new s.PdfColor(234,234,234),i.all=new s.PdfPen(e);else{var u=n.width,h=Object(r.isNullOrUndefined)(u)||"number"!=typeof u?void 0:.75*u,o=new s.PdfColor(196,196,196);Object(r.isNullOrUndefined)(n.color)||(t=this.hexDecToRgb(n.color),o=new s.PdfColor(t.r,t.g,t.b));f=new s.PdfPen(o,h);Object(r.isNullOrUndefined)(n.dashStyle)||(f.dashStyle=this.getDashStyle(n.dashStyle));i.all=f}return i},n.prototype.getDashStyle=function(n){switch(n){case"Dash":return 1;case"Dot":return 2;case"DashDot":return 3;case"DashDotDot":return 4;default:return 0}},n.prototype.getStyle=function(){var u=new s.PdfBorders,n,t;if(Object(r.isNullOrUndefined)(this.gridStyle))return{brush:new s.PdfSolidBrush(new s.PdfColor),border:u,font:void 0};var f=Object(r.isNullOrUndefined)(this.gridStyle.header.fontName)?s.PdfFontFamily.Helvetica:this.getFontFamily(this.gridStyle.header.fontName),e=this.getFontStyle(this.gridStyle.header),o=Object(r.isNullOrUndefined)(this.gridStyle.header.fontSize)?10.5:this.gridStyle.header.fontSize,i=new s.PdfColor;return Object(r.isNullOrUndefined)(this.gridStyle.header.fontColor)||(n=this.hexDecToRgb(this.gridStyle.header.fontColor),i=new s.PdfColor(n.r,n.g,n.b)),t=new s.PdfStandardFont(f,o,e),Object(r.isNullOrUndefined)(this.gridStyle.header.font)||(t=this.gridStyle.header.font),{border:this.getBorderStyle(this.gridStyle.header.border),font:t,brush:new s.PdfSolidBrush(i)}},n.prototype.setRecordThemeStyle=function(n,t){var u,i,e;if(!Object(r.isNullOrUndefined)(this.gridStyle)&&!Object(r.isNullOrUndefined)(this.gridStyle.record)){var o=Object(r.isNullOrUndefined)(this.gridStyle.record.fontName)?s.PdfFontFamily.Helvetica:this.getFontFamily(this.gridStyle.record.fontName),h=Object(r.isNullOrUndefined)(this.gridStyle.record.fontSize)?9.75:this.gridStyle.record.fontSize,c=this.getFontStyle(this.gridStyle.record),f=new s.PdfStandardFont(o,h,c);Object(r.isNullOrUndefined)(this.gridStyle.record.font)||(f=this.gridStyle.record.font);n.style.setFont(f);u=new s.PdfColor;Object(r.isNullOrUndefined)(this.gridStyle.record.fontColor)||(i=this.hexDecToRgb(this.gridStyle.record.fontColor),u=new s.PdfColor(i.r,i.g,i.b));n.style.setTextBrush(new s.PdfSolidBrush(u))}return e=this.gridStyle&&this.gridStyle.record&&this.gridStyle.record.border?this.getBorderStyle(this.gridStyle.record.border):t,n.style.setBorder(e),n},n.prototype.exportToPDF=function(){var g,nt,e,h,ut,i,it,t,y,l,w,tt;this.engine="olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule;for(var c=this.applyEvent(),b=this.getStyle(),et=100+20*(this.parent.renderModule.maxIndent?this.parent.renderModule.maxIndent:5),k=Math.floor((540-et)/90)+1,d=0,n=c.args.dataCollections[d],p=0;c.args.allowRepeatHeader&&k>1&&p<n.length;p++)for(g=k;n[p]&&g<n[p].length;g+=k)n[p].splice(g,0,n[p][0]);nt=n&&n.length>0?n[0].length:0;e=0;do{var ot=this.addPage(c),o=new s.PdfGrid,a=k>1?k:5;if(n&&n.length>0){o.columns.add(n[0].length-e>=a?a:n[0].length-e);for(var st=n.length,rt=0,v=0,u=0;u<st;u++)if(n[u]){h=!(n[u][0]&&"row"===n[u][0].axis);ut=n[u].length>e+a?e+a:n[u].length;h&&o.headers.add(1);i=h?o.headers.getHeader(rt):o.rows.addRow();h?(i.style.setBorder(b.border),b.font&&i.style.setFont(b.font),i.style.setTextBrush(b.brush)):this.setRecordThemeStyle(i,b.border);for(var r=0,ft=!0,f=e;f<ut;f++)it=!1,n[u][f]?(t=n[u][f],(-1!==t.level||t.rowSpan)&&(y=t.formattedText,y="grand sum"===t.type?this.parent.localeObj.getConstant("grandTotal"):"sum"===t.type?y.toString().replace("Total",this.parent.localeObj.getConstant("total")):y,(-1!==t.level||t.rowSpan)&&(i.cells.getCell(r).columnSpan=t.colSpan?a-r<t.colSpan?a-r:t.colSpan:1,h&&t.rowSpan&&t.rowSpan>1&&(i.cells.getCell(r).rowSpan=t.rowSpan?t.rowSpan:1),i.cells.getCell(r).value=y?y.toString():""),""!==y&&(ft=!1)),v=t.level>v?t.level:v,it="value"===t.axis,f+=i.cells.getCell(r).columnSpan?i.cells.getCell(r).columnSpan-1:0,r+=i.cells.getCell(r).columnSpan?i.cells.getCell(r).columnSpan-1:0,t.style&&(i=this.applyStyle(i,t,r)),l={style:t&&t.isSum?{bold:!0}:void 0,pivotCell:t,cell:i.cells.getCell(r)},this.parent.trigger("onPdfCellRender",l),l.style&&this.processCellStyle(i.cells.getCell(r),l)):(l={style:void 0,pivotCell:void 0,cell:i.cells.getCell(r)},this.parent.trigger("onPdfCellRender",l),l.style&&this.processCellStyle(i.cells.getCell(r),l),i.cells.getCell(r).value="",(0===f&&h&&this.parent.dataSourceSettings.columns&&this.parent.dataSourceSettings.columns.length>0||0!==f&&h&&this.parent.dataSourceSettings.columns&&this.parent.dataSourceSettings.columns.length>0&&o.headers.getHeader(0).cells.getCell(0).rowSpan<Object.keys(this.engine.headerContent).length)&&o.headers.getHeader(0).cells.getCell(0).rowSpan++),w=new s.PdfStringFormat,"olap"===this.parent.dataType?(tt=!h&&0===r&&n[u][f]?this.parent.renderModule.indentCollection[n[u][f].rowIndex]:0,w.paragraphIndent=15*tt,v=v>tt?v:tt):w.paragraphIndent=!h&&0===r&&n[u][f]&&-1!==n[u][f].level?15*n[u][f].level:0,w.alignment=it?s.PdfTextAlignment.Right:s.PdfTextAlignment.Left,w.lineAlignment=s.PdfVerticalAlignment.Middle,i.cells.getCell(r).style.stringFormat=w,r++;ft&&(i.height=16);rt++}o.columns.getColumn(0).width=100+20*v}0===e&&this.parent.dataSourceSettings.columns&&this.parent.dataSourceSettings.columns.length>0&&o.headers.getHeader(0).cells.getCell(0).rowSpan--;o.draw(ot,new s.PointF(10,20));(e+=a)>=nt&&c.args.dataCollections.length>d+1&&(d++,nt=(n=c.args.dataCollections[d])&&n.length>0?n[0].length:0,e=0)}while(e<nt);c.document.save(c.args.fileName+".pdf");c.document.destroy()},n.prototype.applyStyle=function(n,t,i){var r=this.parent.conditionalFormattingModule.hexToRgb(t.style.backgroundColor),u=new s.PdfSolidBrush(new s.PdfColor(r.r,r.g,r.b)),f,e;return n.cells.getCell(i).style.backgroundBrush=u,f=Number(t.style.fontSize.split("px")[0]),e=new s.PdfStandardFont(s.PdfFontFamily.TimesRoman,f,s.PdfFontStyle.Regular),n.cells.getCell(i).style.font=e,r=this.parent.conditionalFormattingModule.hexToRgb(t.style.color),u=new s.PdfSolidBrush(new s.PdfColor(r.r,r.g,r.b)),n.cells.getCell(i).style.textBrush=u,n},n.prototype.getFontFamily=function(n){switch(n){case"TimesRoman":return 2;case"Courier":return 1;case"Symbol":return 3;case"ZapfDingbats":return 4;default:return 0}},n.prototype.getFont=function(n){if(n.style.font)return n.style.font;var i=n.cell.cellStyle.font&&n.cell.cellStyle.font.fontSize?n.cell.cellStyle.font.fontSize:Object(r.isNullOrUndefined)(n.style.fontSize)?9.75:.75*n.style.fontSize,u=Object(r.isNullOrUndefined)(n.style.fontFamily)?s.PdfFontFamily.TimesRoman:this.getFontFamily(n.style.fontFamily),t=s.PdfFontStyle.Regular;return!Object(r.isNullOrUndefined)(n.style.bold)&&n.style.bold&&(t|=s.PdfFontStyle.Bold),!Object(r.isNullOrUndefined)(n.style.italic)&&n.style.italic&&(t|=s.PdfFontStyle.Italic),!Object(r.isNullOrUndefined)(n.style.underline)&&n.style.underline&&(t|=s.PdfFontStyle.Underline),!Object(r.isNullOrUndefined)(n.style.strikeout)&&n.style.strikeout&&(t|=s.PdfFontStyle.Strikeout),new s.PdfStandardFont(u,i,t)},n.prototype.processCellStyle=function(n,t){var i,u,f,e,h;if(Object(r.isNullOrUndefined)(t.style.backgroundColor)||(i=this.hexDecToRgb(t.style.backgroundColor),n.style.backgroundBrush=new s.PdfSolidBrush(new s.PdfColor(i.r,i.g,i.b))),Object(r.isNullOrUndefined)(t.style.textBrushColor)||(u=this.hexDecToRgb(t.style.textBrushColor),n.style.textBrush=new s.PdfSolidBrush(new s.PdfColor(u.r,u.g,u.b))),Object(r.isNullOrUndefined)(t.style.textPenColor)||(f=this.hexDecToRgb(t.style.textPenColor),n.style.textPen=new s.PdfPen(new s.PdfColor(f.r,f.g,f.b))),Object(r.isNullOrUndefined)(t.style.fontFamily)&&Object(r.isNullOrUndefined)(t.style.fontSize)&&Object(r.isNullOrUndefined)(t.style.bold)&&Object(r.isNullOrUndefined)(t.style.italic)&&Object(r.isNullOrUndefined)(t.style.underline)&&Object(r.isNullOrUndefined)(t.style.strikeout)||(n.style.font=this.getFont(t)),!Object(r.isNullOrUndefined)(t.style.border)){var c=new s.PdfBorders,o=t.style.border.width,a=Object(r.isNullOrUndefined)(o)||"number"!=typeof o?void 0:.75*o,l=new s.PdfColor(196,196,196);Object(r.isNullOrUndefined)(t.style.border.color)||(e=this.hexDecToRgb(t.style.border.color),l=new s.PdfColor(e.r,e.g,e.b));h=new s.PdfPen(l,a);Object(r.isNullOrUndefined)(t.style.border.dashStyle)||(h.dashStyle=this.getDashStyle(t.style.border.dashStyle));c.all=h;n.style.borders=c}},n.prototype.applyEvent=function(){var t,i=e.getClonedPivotValues(this.engine.pivotValues),r,n;return this.parent.exportAllPages&&this.parent.enableVirtualization&&"olap"!==this.parent.dataType?(r=this.engine.pageSettings,this.engine.pageSettings=null,this.engine.generateGridData(this.parent.dataSourceSettings),this.parent.applyFormatting(this.engine.pivotValues),t=e.getClonedPivotValues(this.engine.pivotValues),this.engine.pivotValues=i,this.engine.pageSettings=r):t=i,n={fileName:"default",header:"",footer:"",dataCollections:[t],allowRepeatHeader:!0,style:void 0},this.parent.trigger("beforeExport",n),this.gridStyle=n.style,{document:new s.PdfDocument,args:n}},n.prototype.destroy=function(){},n}(),hu=function(){function n(n){this.keyConfigs={tab:"tab",enter:"enter",shiftUp:"shift+upArrow",shiftDown:"shift+downArrow",shiftLeft:"shift+leftArrow",shiftRight:"shift+rightArrow",upArrow:"upArrow",downArrow:"downArrow",leftArrow:"leftArrow",rightArrow:"rightArrow",escape:"escape"};this.parent=n;this.parent.element.tabIndex=-1===this.parent.element.tabIndex?0:this.parent.element.tabIndex;this.pivotViewKeyboardModule=new r.KeyboardEvents(this.parent.element,{keyAction:this.keyActionHandler.bind(this),keyConfigs:this.keyConfigs,eventName:"keydown"})}return n.prototype.keyActionHandler=function(n){switch(n.action){case"tab":this.processTab(n);break;case"enter":this.processEnter(n);break;case"shiftUp":case"shiftDown":case"shiftLeft":case"shiftRight":case"upArrow":case"downArrow":case"leftArrow":case"rightArrow":this.processSelection(n);break;case"escape":this.clearSelection()}},n.prototype.getNextButton=function(n){var i=[].slice.call(this.parent.element.querySelectorAll(".e-pivot-button")),r=n,u,t;if(this.parent.grid.element.querySelector(".e-pivot-button"))for(u=i.length,t=0;t<u;t++)if(i[t].getAttribute("data-uid")===n.getAttribute("data-uid")){r=i[t+1]?i[t+1]:r;break}return r},n.prototype.processTab=function(n){var t=n.target,i,f,u,o,e;t&&Object(r.closest)(t,".e-pivot-button")?(i=this.parent.grid.serviceLocator.getService("focus"),f=this.getNextButton(t),f.getAttribute("data-uid")!==t.getAttribute("data-uid")?(i.currentInfo.skipAction=!0,f.focus()):(i.focus(),u=i.getFocusedElement(),Object(r.addClass)([u],["e-focused","e-focus"]),u.setAttribute("tabindex","0")),n.preventDefault()):!this.parent.showGroupingBar&&this.parent.showFieldList?t&&Object(r.closest)(t,".e-toggle-field-list")&&((i=this.parent.grid.serviceLocator.getService("focus")).focus(),u=i.getFocusedElement(),Object(r.addClass)([u],["e-focused","e-focus"]),u.setAttribute("tabindex","0")):!this.parent.showGroupingBar&&!this.parent.showFieldList&&t&&Object(r.closest)(t,".e-pivotview")&&(o=Object(r.closest)(t,".e-pivotview"),e=(i=this.parent.grid.serviceLocator.getService("focus"),[].slice.call(o.getElementsByTagName("tr"))),t.innerHTML===e[e.length-1].lastChild.innerHTML?i.currentInfo.skipAction=!0:(i.focus(),u=i.getFocusedElement(),Object(r.addClass)([u],["e-focused","e-focus"]),u.setAttribute("tabindex","0")))},n.prototype.processEnter=function(n){var t=n.target;if(t&&Object(r.closest)(t,".e-grid"))return t.querySelector("."+h)?t.querySelector("."+h).click():t.classList.contains("e-valuescontent")&&t.dispatchEvent(new MouseEvent("dblclick",{view:window,bubbles:!0,cancelable:!0})),void n.preventDefault()},n.prototype.clearSelection=function(){var n=this.parent;Object(r.removeClass)(n.element.querySelectorAll("."+d+",."+k),[k,d,"e-active"]);this.parent.renderModule.selected()},n.prototype.processSelection=function(n){var o,s;if(this.parent.gridSettings.allowSelection&&"Row"!==this.parent.gridSettings.selectionSettings.mode){var t,e=n.target,u=this.parent,f=Number(n.target.getAttribute("aria-colIndex")),i=Number(n.target.getAttribute("index"));("TH"!==e.nodeName&&"TD"!==e.nodeName||(t="shiftUp"===n.action||"upArrow"===n.action?0===i||0===f||"TH"!==e.nodeName&&u.renderModule.rowStartPos!==i?null:this.getParentElement(u,t,f,i-1):"shiftDown"===n.action||"downArrow"===n.action?u.element.querySelector('th[aria-colindex="'+f+'"][index="'+(i+1)+'"]'):"shiftLeft"===n.action||"leftArrow"===n.action?n.target.previousSibling:n.target.nextSibling),Object(r.isNullOrUndefined)(t))?("upArrow"===n.action?(t=u.element.querySelector('[aria-colindex="'+f+'"][index="'+(i-1)+'"]'),i--):"downArrow"===n.action&&(t=u.element.querySelector('[aria-colindex="'+f+'"][index="'+(i+1)+'"]'),i++),Object(r.isNullOrUndefined)(t)||u.clearSelection(t,n,f,i)):"Both"===u.gridSettings.selectionSettings.mode&&t.classList.contains("e-rowcell")?u.clearSelection(t,n,f,i):(f=Number(t.getAttribute("aria-colindex")),i=Number(t.getAttribute("index")),o=Number(t.getAttribute("aria-colspan")),u.clearSelection(t,n,f,i),s={cancel:!1,isCellClick:!0,currentCell:t,data:u.pivotValues[i][f]},u.trigger("cellSelecting",s,function(r){r.cancel||u.applyColumnSelection(n,t,f,f+(o>0?o-1:0),i)}))}},n.prototype.getParentElement=function(n,t,i,r){for(;!t;)t=n.element.querySelector('[aria-colindex="'+i+'"][index="'+r+'"]'),i--;return t},n.prototype.destroy=function(){this.pivotViewKeyboardModule&&this.pivotViewKeyboardModule.destroy()},n}(),cu=function(){function n(n){this.parent=n;this.parent.contextMenuModule=this}return n.prototype.render=function(){this.renderContextMenu()},n.prototype.renderContextMenu=function(){var t={cssClass:"e-pivot-context-menu",items:[{text:this.parent.localeObj.getConstant("addToFilter"),id:this.parent.element.id+"_Filters"},{text:this.parent.localeObj.getConstant("addToRow"),id:this.parent.element.id+"_Rows"},{text:this.parent.localeObj.getConstant("addToColumn"),id:this.parent.element.id+"_Columns"},{text:this.parent.localeObj.getConstant("addToValue"),id:this.parent.element.id+"_Values"}],enableRtl:this.parent.enableRtl,beforeOpen:this.onBeforeMenuOpen.bind(this),select:this.onSelectContextMenu.bind(this)},n=Object(r.createElement)("ul",{id:this.parent.element.id+"_PivotContextMenu"});this.parent.element.appendChild(n);this.menuObj=new rt.ContextMenu(t);this.menuObj.isStringTemplate=!0;this.menuObj.appendTo(n)},n.prototype.onBeforeMenuOpen=function(n){var i=[].slice.call(n.element.querySelectorAll("li")),o="olap"===this.parent.dataType?this.fieldElement.getAttribute("data-type"):this.fieldElement.querySelector(".e-content").getAttribute("data-type"),u,s,f,h,e,c,t;if(Object(r.removeClass)(i,"e-disabled"),"CalculatedField"===o||"isMeasureFieldsAvail"===o)for(u=0,s=i;u<s.length;u++)(t=s[u]).textContent!==this.parent.localeObj.getConstant("addToValue")&&Object(r.addClass)([t],"e-disabled");else if("isMeasureAvail"===o)for(f=0,h=i;f<h.length;f++)(t=h[f]).textContent!==this.parent.localeObj.getConstant("addToRow")&&t.textContent!==this.parent.localeObj.getConstant("addToColumn")&&Object(r.addClass)([t],"e-disabled");else if("olap"===this.parent.dataType)for(e=0,c=i;e<c.length;e++)if((t=c[e]).textContent===this.parent.localeObj.getConstant("addToValue")){Object(r.addClass)([t],"e-disabled");break}},n.prototype.onSelectContextMenu=function(n){if(null!==n.element.textContent){var t=this.fieldElement.getAttribute("data-uid"),i=n.item.id.replace(this.parent.element.id+"_","").toLowerCase();this.parent.pivotCommon.dataSourceUpdate.control="pivotview"===this.parent.getModuleName()?this.parent:this.parent.pivotGridModule?this.parent.pivotGridModule:this.parent;this.parent.pivotCommon.dataSourceUpdate.btnElement=this.fieldElement;this.parent.pivotCommon.dataSourceUpdate.updateDataSource(t,i,-1);this.parent.updateDataSource(!0);this.fieldElement=void 0}},n.prototype.destroy=function(){this.parent.isDestroyed&&this.menuObj&&!this.menuObj.isDestroyed&&this.menuObj.destroy()},n}(),bi=function(){function n(n){this.previousValues={top:0,left:0};this.frozenPreviousValues={top:0,left:0};this.eventType="";this.parent=n;this.engineModule="pivot"===this.parent.dataType?this.parent.engineModule:this.parent.olapEngineModule;this.addInternalEvents()}return n.prototype.getModuleName=function(){return"virtualscroll"},n.prototype.addInternalEvents=function(){this.parent.on(st,this.wireEvents,this)},n.prototype.wireEvents=function(){var n=this.parent.element.querySelector(".e-movablecontent"),t=this.parent.element.querySelector(".e-frozencontent"),i=this.parent.element.querySelector(".e-movableheader");r.EventHandler.clearEvents(n);r.EventHandler.clearEvents(t);this.engineModule&&(r.EventHandler.add(n,"scroll touchmove pointermove",this.onHorizondalScroll(i,n,t),this),r.EventHandler.add(n,"scroll wheel touchmove pointermove",this.onVerticalScroll(t,n),this),r.EventHandler.add(n,"mouseup touchend",this.common(i,n,t),this),r.EventHandler.add(t,"wheel",this.onWheelScroll(n,t),this),r.EventHandler.add(t,"touchstart pointerdown",this.setPageXY(),this),r.EventHandler.add(t,"touchmove pointermove",this.onTouchScroll(i,n,t),this),r.EventHandler.add(i,"touchstart pointerdown",this.setPageXY(),this),r.EventHandler.add(i,"touchmove pointermove",this.onTouchScroll(i,n,t),this));this.parent.grid.isPreventScrollEvent=!0},n.prototype.onWheelScroll=function(n,t){var i=this,r=n;return function(n){var u=r.scrollTop+(1===n.deltaMode?30*n.deltaY:n.deltaY);i.frozenPreviousValues.top!==u&&(n.preventDefault(),t.scrollTop=u,r.scrollTop=u,i.frozenPreviousValues.top=u,i.eventType=n.type)}},n.prototype.getPointXY=function(n){var t={x:0,y:0};return n.touches&&n.touches.length?(t.x=n.touches[0].pageX,t.y=n.touches[0].pageY):(t.x=n.pageX,t.y=n.pageY),t},n.prototype.onTouchScroll=function(n,t,i){var r=this,u=t;return function(t){if("mouse"!==t.pointerType){var o=r.getPointXY(t),f=u.scrollTop+(r.pageXY.y-o.y),e=u.scrollLeft+(r.pageXY.x-o.x);if(r.parent.element.querySelector(".e-headercontent").contains(t.target)){if(r.frozenPreviousValues.left===e||e<0)return;n.scrollLeft=e;u.scrollLeft=e;r.pageXY.x=o.x;r.frozenPreviousValues.left=e}else{if(r.frozenPreviousValues.top===f||f<0)return;i.scrollTop=f;u.scrollTop=f;r.pageXY.y=o.y;r.frozenPreviousValues.top=f}r.eventType=t.type}}},n.prototype.update=function(n,t,i,u){var nt=this,f,c,p,w,l,b,e,a,o;if(this.parent.isScrolling=!0,f="pivot"===this.parent.dataType?this.parent.engineModule:this.parent.olapEngineModule,Object(r.isBlazor)()&&(f.pageSettings=this.parent.pageSettings),this.parent.pageSettings&&f.pageSettings)if("vertical"===this.direction){var v="pivot"===this.parent.dataType&&"row"===this.parent.dataSourceSettings.valueAxis?this.parent.dataSourceSettings.values.length:1,k=this.parent.pageSettings.rowSize*v*this.parent.gridSettings.rowHeight,s=Math.ceil(i/k);if(this.parent.scrollPosObject.vertical===s||f.pageSettings.rowSize>=f.rowCount)return void this.parent.hideWaitingPopup();if(this.parent.showWaitingPopup(),this.parent.scrollPosObject.vertical=s,f.pageSettings.rowCurrentPage=s>1?s:1,c=0,"pivot"===this.parent.dataType)if(Object(r.isBlazor)()){var h=this.parent,y="ejsInterop",d=window[y].copyWithoutCircularReferences([h.dataSourceSettings],h.dataSourceSettings),g=window[y].copyWithoutCircularReferences([f.pageSettings],f.pageSettings);h.interopAdaptor.invokeMethodAsync("PivotInteropMethod","generateGridData",{dataSourceSettings:d,pageSettings:g,isScrolling:!0}).then(function(n){h.updateBlazorData(n,h);h.pivotValues=f.pivotValues;c=nt.parent.engineModule.rowStartPos;var t=Math.ceil(c/(h.pageSettings.rowSize*v)),i=k*t-f.rowFirstLvl*v*h.gridSettings.rowHeight;h.scrollPosObject.verticalSection=i})}else this.parent.engineModule.generateGridData(this.parent.dataSourceSettings,this.parent.engineModule.headerCollection),c=this.parent.engineModule.rowStartPos;else this.parent.olapEngineModule.scrollPage("scroll"),c=this.parent.olapEngineModule.pageRowStartPos;Object(r.isBlazor)()&&"pivot"===this.parent.dataType||(this.parent.pivotValues=f.pivotValues,p=Math.ceil(c/(this.parent.pageSettings.rowSize*v)),w=k*p-f.rowFirstLvl*v*this.parent.gridSettings.rowHeight,this.parent.scrollPosObject.verticalSection=w)}else{if(l="pivot"===this.parent.dataType&&"column"===this.parent.dataSourceSettings.valueAxis?this.parent.dataSourceSettings.values.length:1,b=this.parent.pageSettings.columnSize*l*this.parent.gridSettings.columnWidth,s=Math.ceil(u/b),this.parent.scrollPosObject.horizontal===s)return void this.parent.hideWaitingPopup();this.parent.showWaitingPopup();e=this.parent;e.scrollPosObject.horizontal=s;f.pageSettings.columnCurrentPage=s>1?s:1;a=0;"pivot"===e.dataType?Object(r.isBlazor)()?(y="ejsInterop",o=this.parent,g=window[y].copyWithoutCircularReferences([f.pageSettings],f.pageSettings),d=window[y].copyWithoutCircularReferences([o.dataSourceSettings],o.dataSourceSettings),o.interopAdaptor.invokeMethodAsync("PivotInteropMethod","generateGridData",{dataSourceSettings:d,pageSettings:g,isScrolling:!0}).then(function(n){o.updateBlazorData(n,o);a=o.engineModule.colStartPos;o.pivotValues=f.pivotValues;var t=Math.ceil(a/(o.pageSettings.columnSize*l)),i=b*t-f.colFirstLvl*l*o.gridSettings.columnWidth;o.scrollPosObject.horizontalSection=i})):(e.engineModule.generateGridData(e.dataSourceSettings,e.engineModule.headerCollection),a=e.engineModule.colStartPos):(e.olapEngineModule.scrollPage("scroll"),a=e.olapEngineModule.pageColStartPos);Object(r.isBlazor)()&&"pivot"===e.dataType||(e.pivotValues=f.pivotValues,p=Math.ceil(a/(e.pageSettings.columnSize*l)),w=b*p-f.colFirstLvl*l*e.gridSettings.columnWidth,e.scrollPosObject.horizontalSection=w)}},n.prototype.setPageXY=function(){var n=this;return function(t){"mouse"!==t.pointerType&&(n.pageXY=n.getPointXY(t))}},n.prototype.common=function(n,t){var i=this;return function(r){i.update(n,t,t.scrollTop*i.parent.verticalScrollScale,t.scrollLeft*i.parent.horizontalScrollScale,r)}},n.prototype.onHorizondalScroll=function(n,t,i){var f,u=this;return function(e){var o=t.scrollLeft*u.parent.horizontalScrollScale,s,l,h,a,c;("wheel"!==e.type&&"touchmove"!==e.type&&"wheel"!==u.eventType&&"touchmove"!==u.eventType||(clearTimeout(f),f=setTimeout(function(){o="touchmove"===e.type?t.scrollLeft:o;u.update(n,t,t.scrollTop*u.parent.verticalScrollScale,o,e)},300)),u.previousValues.left!==o)?(u.direction="horizondal",s=-(o-u.parent.scrollPosObject.horizontalSection-t.scrollLeft),l=t.querySelector("."+bt).style.transform.split(",")[1].trim(),t.scrollLeft<u.parent.scrollerBrowserLimit&&(Object(r.setStyleAttribute)(t.querySelector(".e-table"),{transform:"translate("+s+"px,"+l}),Object(r.setStyleAttribute)(n.querySelector(".e-table"),{transform:"translate("+s+"px,0px)"})),h=u.parent.scrollPosObject.horizontalSection>o?-(u.parent.scrollPosObject.horizontalSection-o):o+n.offsetWidth-(u.parent.scrollPosObject.horizontalSection+t.querySelector(".e-table").offsetWidth),a=Math.ceil(u.parent.scrollPosObject.horizontalSection/u.parent.horizontalScrollScale)<u.parent.scrollerBrowserLimit,(u.parent.scrollPosObject.horizontalSection>o||h>1&&a)&&(o>n.clientWidth?(u.parent.scrollPosObject.left<1&&(u.parent.scrollPosObject.left=n.clientWidth),u.parent.scrollPosObject.left=u.parent.scrollPosObject.left-50,h=u.parent.scrollPosObject.horizontalSection>o?h-u.parent.scrollPosObject.left:h+u.parent.scrollPosObject.left):h=-u.parent.scrollPosObject.horizontalSection,s=-(o-(u.parent.scrollPosObject.horizontalSection+h)-t.scrollLeft),c=u.parent.gridSettings.columnWidth*u.engineModule.columnCount-u.parent.grid.columns[0].width,c>u.parent.scrollerBrowserLimit&&(u.parent.horizontalScrollScale=c/u.parent.scrollerBrowserLimit,c=u.parent.scrollerBrowserLimit),s>c&&s>o&&(s=o,h=0),Object(r.setStyleAttribute)(t.querySelector(".e-table"),{transform:"translate("+s+"px,"+l}),Object(r.setStyleAttribute)(n.querySelector(".e-table"),{transform:"translate("+s+"px,0px)"}),u.parent.scrollPosObject.horizontalSection=u.parent.scrollPosObject.horizontalSection+h),u.previousValues.left=o,u.frozenPreviousValues.left=o,u.eventType="",n.scrollLeft=t.scrollLeft):i.scrollTop=t.scrollTop}},n.prototype.onVerticalScroll=function(n,t){var u,i=this;return function(f){var e=t.scrollTop*i.parent.verticalScrollScale,o,c,s,l,a,h;("wheel"!==f.type&&"touchmove"!==f.type&&"wheel"!==i.eventType&&"touchmove"!==i.eventType||(clearTimeout(u),u=setTimeout(function(){i.update(null,t,t.scrollTop*i.parent.verticalScrollScale,t.scrollLeft*i.parent.horizontalScrollScale,f)},300)),i.previousValues.top!==e)&&(i.direction="vertical",o=-(e-i.parent.scrollPosObject.verticalSection-t.scrollTop),c=t.querySelector("."+bt).style.transform.split(",")[0].trim(),t.scrollTop<i.parent.scrollerBrowserLimit&&(Object(r.setStyleAttribute)(n.querySelector(".e-table"),{transform:"translate(0px,"+o+"px)"}),Object(r.setStyleAttribute)(t.querySelector(".e-table"),{transform:c+","+o+"px)"})),s=i.parent.scrollPosObject.verticalSection>e?-(i.parent.scrollPosObject.verticalSection-e):e+n.clientHeight-(i.parent.scrollPosObject.verticalSection+n.querySelector(".e-table").offsetHeight),l=Math.ceil(i.parent.scrollPosObject.verticalSection/i.parent.verticalScrollScale)<i.parent.scrollerBrowserLimit,(i.parent.scrollPosObject.verticalSection>e||s>1&&l)&&(e>n.clientHeight?(i.parent.scrollPosObject.top<1&&(i.parent.scrollPosObject.top=n.clientHeight),i.parent.scrollPosObject.top=i.parent.scrollPosObject.top-50,s=i.parent.scrollPosObject.verticalSection>e?s-i.parent.scrollPosObject.top:s+i.parent.scrollPosObject.top):s=-i.parent.scrollPosObject.verticalSection,a=i.parent.element.querySelector(".e-movablecontent").querySelector(".e-table"),o=-(e-(i.parent.scrollPosObject.verticalSection+s)-t.scrollTop),h=i.parent.gridSettings.rowHeight*i.engineModule.rowCount+.1-a.clientHeight,h>i.parent.scrollerBrowserLimit&&(i.parent.verticalScrollScale=h/i.parent.scrollerBrowserLimit,h=i.parent.scrollerBrowserLimit),o>h&&o>e&&(o=e,s=0),Object(r.setStyleAttribute)(n.querySelector(".e-table"),{transform:"translate(0px,"+o+"px)"}),Object(r.setStyleAttribute)(t.querySelector(".e-table"),{transform:c+","+o+"px)"}),i.parent.scrollPosObject.verticalSection=i.parent.scrollPosObject.verticalSection+s),i.previousValues.top=e,i.frozenPreviousValues.top=e,i.eventType="",n.scrollTop=t.scrollTop,t.scrollTop=n.scrollTop)}},n.prototype.removeInternalEvents=function(){this.parent.isDestroyed||this.parent.off(st,this.wireEvents)},n.prototype.destroy=function(){this.removeInternalEvents()},n}(),lu=function(){function n(n){this.indexString=[];this.isUpdated=!1;this.gridIndexObjects={};this.gridData=[];this.parent=n;this.engine="olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule}return n.prototype.showDrillThroughDialog=function(n){var t=this,i;this.gridData=n.rawData;this.removeDrillThroughDialog();i=Object(r.createElement)("div",{id:this.parent.element.id+"_drillthrough",className:"e-drillthrough-dialog"});this.parent.element.appendChild(i);this.dialogPopUp=new p.Dialog({animationSettings:{effect:"Fade"},allowDragging:!1,header:this.parent.localeObj.getConstant("details"),content:this.createDrillThroughGrid(n),beforeOpen:function(){t.drillThroughGrid.setProperties({dataSource:t.parent.editSettings.allowEditing?t.dataWithPrimarykey(n):t.gridData,height:t.parent.editSettings.allowEditing?220:300},!0);t.drillThroughGrid.enableVirtualization=!t.parent.editSettings.allowEditing},beforeClose:function(){var n,f,h,c,i;if(t.parent.editSettings.allowEditing&&t.isUpdated){for(var u=Object.keys(t.gridIndexObjects).length,o=[],s=0,a=t.drillThroughGrid.dataSource;s<a.length;s++)if(n=a[s],Object(r.isNullOrUndefined)(n.__index)||""===n.__index){for(f=0,h=t.engine.fields;f<h.length;f++)c=h[f],Object(r.isNullOrUndefined)(n[c])&&delete n[c];delete n.__index;o.push(n)}else u>0&&(delete t.gridIndexObjects[n.__index.toString()],u--);if(u=0,Object(r.isBlazor)()&&t.parent.enableVirtualization)i=t,i.parent.interopAdaptor.invokeMethodAsync("PivotInteropMethod","updateRawData",{AddItem:o,RemoveItem:i.gridIndexObjects,ModifiedItem:i.gridData}).then(function(n){i.parent.updateBlazorData(n,i.parent);i.parent.setProperties({pivotValues:i.parent.engineModule.pivotValues},!0);i.isUpdated=!1;i.gridIndexObjects={}});else{for(var e=[],l=0,v=t.parent.allowDataCompression&&t.parent.enableVirtualization?t.parent.engineModule.actualData:t.parent.engineModule.data;l<v.length;l++)delete(n=v[l]).__index,void 0===t.gridIndexObjects[u.toString()]&&e.push(n),u++;e=e.concat(o);t.parent.setProperties({dataSourceSettings:{dataSource:e}},!0);t.engine.updateGridData(t.parent.dataSourceSettings);t.parent.pivotValues=t.engine.pivotValues}}Object(r.isBlazor)()&&t.parent.enableVirtualization||(t.isUpdated=!1,t.gridIndexObjects={})},isModal:!0,visible:!0,showCloseIcon:!0,locale:this.parent.locale,enableRtl:this.parent.enableRtl,width:this.parent.isAdaptive?"100%":"60%",position:{X:"center",Y:"center"},closeOnEscape:!0,target:document.body,close:this.removeDrillThroughDialog.bind(this)});this.dialogPopUp.isStringTemplate=!0;this.dialogPopUp.appendTo(i);Object(r.setStyleAttribute)(this.dialogPopUp.element,{visibility:"visible"})},n.prototype.removeDrillThroughDialog=function(){this.dialogPopUp&&!this.dialogPopUp.isDestroyed&&this.dialogPopUp.destroy();var n=document.getElementById(this.parent.element.id+"_drillthrough");n&&Object(r.remove)(n);document.getElementById(this.parent.element.id+"_drillthroughgrid_ccdlg")&&Object(r.remove)(document.getElementById(this.parent.element.id+"_drillthroughgrid_ccdlg"))},n.prototype.createDrillThroughGrid=function(n){var f=Object(r.createElement)("div",{id:this.parent.element.id+"_drillthroughbody",className:"e-drillthrough-body"}),i=Object(r.createElement)("div",{id:this.parent.element.id+"_drillthroughbodyheader",className:"e-drillthrough-body-header-container"}),s,e,o,u,t;return(""!==n.rowHeaders&&(i.innerHTML="<span class=e-drillthrough-body-header-common><span class=e-drillthrough-body-header>"+this.parent.localeObj.getConstant("row")+"<\/span> :<span class=e-drillthrough-body-header-value>"+n.rowHeaders+"<\/span><\/span>"),""!==n.columnHeaders&&(i.innerHTML=i.innerHTML+"<span class=e-drillthrough-body-header-common><span class=e-drillthrough-body-header>"+this.parent.localeObj.getConstant("column")+"<\/span> :<span class=e-drillthrough-body-header-value>"+n.columnHeaders+"<\/span><\/span>"),""!==n.value)&&(s=n.value.split("(")[0],e=n.value.split("(")[1].split(")")[0],"0"!==e&&(i.innerHTML=i.innerHTML+"<span class=e-drillthrough-body-header-common><span class=e-drillthrough-body-header>"+s+"<\/span> :<span class=e-drillthrough-body-header-value>"+e+"<\/span><\/span>")),o=["ColumnChooser"],this.parent.editSettings.allowEditing&&(o=this.parent.editSettings.allowCommandColumns?["ColumnChooser","Add"]:"Batch"===this.parent.editSettings.mode?["ColumnChooser","Add","Delete","Update","Cancel"]:"Dialog"===this.parent.editSettings.mode?["ColumnChooser","Add","Edit","Delete"]:["ColumnChooser","Add","Edit","Delete","Update","Cancel"]),u=Object(r.createElement)("div",{id:this.parent.element.id+"_drillthroughgrid",className:"e-drillthrough-grid"}),c.Grid.Inject(c.Selection,c.Reorder,c.Resize,c.Toolbar,c.ColumnChooser),this.drillThroughGrid=new c.Grid({gridLines:"Default",allowResizing:!0,allowReordering:!0,showColumnChooser:!0,enableHover:!1,toolbar:o,columns:n.gridColumns,locale:this.parent.locale,enableRtl:this.parent.enableRtl,enableVirtualization:this.parent.editSettings.allowEditing,allowPaging:this.parent.editSettings.allowEditing}),"olap"===this.parent.dataType&&this.formatData(),t=this,this.parent.trigger("beginDrillThrough",{cellInfo:n,gridObj:Object(r.isBlazor)()?void 0:this.drillThroughGrid,type:"editing"}),this.parent.editSettings.allowEditing?(c.Grid.Inject(c.Edit,c.Page),this.drillThroughGrid.editSettings=this.parent.editSettings,this.parent.editSettings.allowCommandColumns?(this.drillThroughGrid.editSettings.mode="Normal",this.drillThroughGrid.editSettings.allowEditOnDblClick=!1,c.Grid.Inject(c.CommandColumn),this.drillThroughGrid.columns.push({headerText:this.parent.localeObj.getConstant("manageRecords"),width:160,showInColumnChooser:!1,commands:[{type:"Edit",buttonOption:{iconCss:" e-icons e-edit",cssClass:"e-flat"}},{type:"Delete",buttonOption:{iconCss:"e-icons e-delete",cssClass:"e-flat"}},{type:"Save",buttonOption:{iconCss:"e-icons e-update",cssClass:"e-flat"}},{type:"Cancel",buttonOption:{iconCss:"e-icons e-cancel-icon",cssClass:"e-flat"}}]})):this.drillThroughGrid.editSettings.allowEditOnDblClick=this.parent.editSettings.allowEditOnDblClick,this.drillThroughGrid.columns.push({field:"__index",visible:!1,isPrimaryKey:!0,type:"string",showInColumnChooser:!1}),this.drillThroughGrid.actionComplete=function(n){"batchsave"!==n.requestType&&"save"!==n.requestType&&"delete"!==n.requestType||(t.isUpdated=!0);("Normal"===t.drillThroughGrid.editSettings.mode&&"save"===n.requestType&&t.drillThroughGrid.element.querySelectorAll(".e-tbar-btn:hover").length>0&&!t.parent.editSettings.allowCommandColumns||"batchsave"===n.requestType)&&t.dialogPopUp.hide()},this.drillThroughGrid.beforeBatchSave=function(){t.isUpdated=!0}):c.Grid.Inject(c.VirtualScroll),document.body.appendChild(u),this.drillThroughGrid.isStringTemplate=!0,this.drillThroughGrid.appendTo(u),f.appendChild(i),f.appendChild(u),f},n.prototype.frameGridColumns=function(n){var s="olap"===this.parent.dataType?n[0]?Object.keys(n[0]):[]:Object.keys(this.engine.fieldList),u=[],i,f,t,r,e,o;if("olap"===this.parent.dataType)for(i=0,f=s;i<f.length;i++)t=f[i],u.push({field:t.replace(/_x005B_|_x0020_|_x005D_|_x0024_/g,"").replace("].[","").split(".").reverse().join(""),headerText:t.replace(/_x005B_|_x005D_|_x0024_/g,"").replace(/_x0020_/g," ").replace("].[","").split(".").reverse().join("."),width:120,visible:!0,validationRules:{required:!0},type:"string"});else for(r=0,e=s;r<e.length;r++)t=e[r],"CalculatedField"!==this.engine.fieldList[t].aggregateType&&(o="",o="number"===this.engine.fieldList[t].type?"numericedit":"date"===this.engine.fieldList[t].type?"datepickeredit":"defaultedit",u.push({field:t,headerText:this.engine.fieldList[t].caption,width:120,visible:this.engine.fieldList[t].isSelected,validationRules:{required:!0},editType:o,type:"string"}));return u},n.prototype.formatData=function(){for(var n=0;n<this.gridData.length;){for(var u=this.gridData[n],i=Object.keys(this.gridData[n]),r={},t=0;t<i.length;)r[i[t].replace(/_x005B_|_x0020_|_x005D_|_x0024_/g,"").replace("].[","").split(".").reverse().join("")]=u[i[t]],t++;this.gridData[n]=r;n++}},n.prototype.dataWithPrimarykey=function(n){for(var i=this.indexString.length>0?this.indexString:Object.keys(n.currentCell.indexObject),u=this.gridData,t=0,r=0,f=u;r<f.length;r++)f[r].__index=i[t],this.gridIndexObjects[i[t].toString()]=Number(i[t]),t++;return u},n}(),ki=function(){function n(n){this.parent=n;this.drillThroughDialog=new lu(this.parent);this.addInternalEvents()}return n.prototype.getModuleName=function(){return"drillthrough"},n.prototype.addInternalEvents=function(){this.parent.on(st,this.wireEvents,this)},n.prototype.wireEvents=function(){this.unWireEvents();r.EventHandler.add(this.parent.element,"dblclick",this.mouseClickHandler,this)},n.prototype.unWireEvents=function(){r.EventHandler.remove(this.parent.element,"dblclick",this.mouseClickHandler)},n.prototype.mouseClickHandler=function(n){var t=n.target,i=null,r,u;(t.classList.contains("e-stackedheadercelldiv")||t.classList.contains("e-cellvalue")||t.classList.contains("e-headercelldiv")?i=t.parentElement:t.classList.contains("e-headercell")||t.classList.contains("e-rowcell")?i=t:t.classList.contains("e-headertext")&&(i=t.parentElement.parentElement),i&&(this.parent.allowDrillThrough&&i.classList.contains("e-valuescontent")||this.parent.editSettings.allowEditing))&&(r=Number(i.getAttribute("aria-colindex")),u=Number(i.getAttribute("index")),this.executeDrillThrough(this.parent.pivotValues[u][r],u,r,i))},n.prototype.executeDrillThrough=function(n,t,i,u){var f="olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule,s="",h="",e=[],a,o,v,y,c,p,b,l,k,g;if(void 0!==n.rowHeaders&&void 0!==n.columnHeaders&&!Object(r.isNullOrUndefined)(n.value)){if("olap"===this.parent.dataType){if(a=void 0,o=(a="row"===this.parent.dataSourceSettings.valueAxis?f.tupRowInfo[n.rowOrdinal]:f.tupColumnInfo[n.colOrdinal])?f.getUniqueName(a.measureName):n.actualText,f.fieldList[o]&&f.fieldList[o].isCalculatedField)return void this.parent.pivotCommon.errorDialog.createErrorDialog(this.parent.localeObj.getConstant("error"),this.parent.localeObj.getConstant("drillError"));s=f.fieldList[o].caption;h=f.fieldList[o].aggregateType;this.parent.olapEngineModule.getDrillThroughData(n,this.parent.maxRowsInDrillThrough);try{e=JSON.parse(f.gridJSON)}catch(n){return void this.parent.pivotCommon.errorDialog.createErrorDialog(this.parent.localeObj.getConstant("error"),f.gridJSON)}}else if(s=f.fieldList[n.actualText.toString()]?f.fieldList[n.actualText.toString()].caption:n.actualText.toString(),h=f.fieldList[n.actualText]?f.fieldList[n.actualText].aggregateType:"",v=this,Object(r.isBlazor)()&&this.parent.enableVirtualization)v.parent.interopAdaptor.invokeMethodAsync("PivotInteropMethod","fetchRawData",{RowIndex:t,ColumnIndex:i}).then(function(t){e=JSON.parse(t.rawData);for(var r=JSON.parse(t.indexObject),f={},i=0;i<r.length;i++)f[r[i].Key]=r[i].Value;n.indexObject=f;v.triggerDialog(s,h,e,n,u)});else if(this.parent.enableVirtualization&&this.parent.allowDataCompression)for(y=Object.keys(n.indexObject),this.drillThroughDialog.indexString=[],c=0,p=y;c<p.length;c++)for(var nt=p[c],w=0,d=this.parent.engineModule.groupRawIndex[Number(nt)];w<d.length;w++)b=d[w],e.push(this.parent.engineModule.actualData[b]),this.drillThroughDialog.indexString.push(b.toString());else for(l=0,k=y=Object.keys(n.indexObject);l<k.length;l++)g=k[l],e.push(this.parent.engineModule.data[Number(g)]);Object(r.isBlazor)()&&this.parent.enableVirtualization||this.triggerDialog(s,h,e,n,u)}},n.prototype.triggerDialog=function(n,t,i,u,f){var s="CalculatedField"===t?n.toString():""!==t?this.parent.localeObj.getConstant(t)+" "+this.parent.localeObj.getConstant("of")+" "+n:n,o={currentTarget:f,currentCell:u,rawData:i,rowHeaders:""===u.rowHeaders?"":u.rowHeaders.toString().split(".").join(" - "),columnHeaders:""===u.columnHeaders?"":u.columnHeaders.toString().split(".").join(" - "),value:s+"("+u.formattedText+")",gridColumns:this.drillThroughDialog.frameGridColumns(i)},h=this,e=o.gridColumns;this.parent.trigger("drillThrough",o,function(n){if(Object(r.isBlazor)()){for(var t=0;t<n.gridColumns.length;t++)e[t].field===n.gridColumns[t].field&&(e[t].field=n.gridColumns[t].field,e[t].editType=n.gridColumns[t].editType,e[t].headerText=n.gridColumns[t].headerText,e[t].type=n.gridColumns[t].type,e[t].validationRules=n.gridColumns[t].validationRules,e[t].visible=n.gridColumns[t].visible,e[t].width=n.gridColumns[t].width);n.gridColumns=e}h.drillThroughDialog.showDrillThroughDialog(n)})},n}(),v=i(5),di=function(){function n(){this.headerColl={};this.maxLevel=0;this.columnGroupObject={};this.fieldPosition=[];this.measurePos=-1;this.measuresNames={}}return n.prototype.getModuleName=function(){return"pivotchart"},n.prototype.loadChart=function(n,t){var p,tt,w,it,f,g,ut,lt,u,nt,ft;if(this.parent=n,this.measuresNames={},this.engineModule="olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule,this.dataSourceSettings=this.parent.dataSourceSettings,this.chartSettings=t,!("olap"===n.dataType?n.olapEngineModule.tupColumnInfo.length>0&&n.olapEngineModule.tupRowInfo.length>0&&(!Object(r.isNullOrUndefined)(n.olapEngineModule.colMeasurePos)||!Object(r.isNullOrUndefined)(n.olapEngineModule.rowMeasurePos)):n.dataSourceSettings.values.length>0))return this.parent.chart?(this.parent.chart.series=[],this.parent.chart.rows=[],this.parent.chart.primaryXAxis.title="",this.parent.chart.primaryYAxis.title="",this.parent.chart.primaryXAxis.multiLevelLabels=[],this.parent.chart.primaryYAxis.multiLevelLabels=[],this.parent.chart.axes.length>0&&(this.parent.chart.axes[0].title=""),this.parent.chart.primaryXAxis.zoomFactor=1,void this.parent.chart.refresh()):void this.parent.notify(st,{});for(this.measureList=this.chartSettings.enableMultiAxis?this.dataSourceSettings.values.map(function(n){return n.name}):[""===t.value?this.dataSourceSettings.values[0].name:t.value],p=0,tt=this.dataSourceSettings.values;p<tt.length;p++)w=tt[p],it=w.name.replace(/[^A-Z0-9]+/gi,"_"),this.measuresNames[w.name]=it,this.measuresNames[it]=w.name;this.columnGroupObject={};f=this.engineModule.pivotValues;this.currentMeasure=t.enableMultiAxis?this.measureList[0]:(""===t.value||0===this.dataSourceSettings.values.filter(function(n){return n.name===t.value}).length)&&this.dataSourceSettings.values.length>0?this.dataSourceSettings.values[0].name:t.value;var b,k,h,bt=this.getColumnTotalIndex(f),kt=Object.keys(f),l={},o=0,a=-.5;this.headerColl={};this.maxLevel=0;var d,ht={},rt="",ct="";for("olap"===this.parent.dataType&&(ht=this.groupHierarchyWithLevels(f),rt=this.fieldPosition[this.fieldPosition.length-1],ct=this.measurePos===this.fieldPosition.length-1&&this.fieldPosition.length>1?this.fieldPosition[this.fieldPosition.length-2]:rt),g=0,ut=kt;g<ut.length;g++)if(lt=ut[g],u=Number(lt),f[u][0]&&"row"===f[u][0].axis&&(0===this.dataSourceSettings.rows.length||"grand sum"!==f[u][0].type)){var i=f[u][0],s="olap"===this.parent.dataType?this.engineModule.tupRowInfo[i.ordinal]:void 0,at=-1,c=i.level;"olap"===this.parent.dataType?(at=s.uNameCollection.split("::[").length-1,3===i.memberType||s.measureName&&s.measureName!==this.dataSourceSettings.values[0].name||(l=0===(o=(k=void 0===k?i.levelUniqueName:k)===i.levelUniqueName?0:o)?{}:l,o=h&&k!==i.levelUniqueName?h.hierarchy===i.hierarchy?o+(i.level-h.level):Object(r.isNullOrUndefined)(l[i.levelUniqueName])?ht[i.hierarchy].start:l[i.levelUniqueName]:o,l[i.levelUniqueName]=o,c=o,a+=h&&ct===h.hierarchy&&!h.isDrilled?1:0,b=o,h=i)):"value"!==i.type&&(void 0===b||b<c||a++,b=c);this.maxLevel=c>this.maxLevel?c:this.maxLevel;var vt="olap"===this.parent.dataType?i.formattedText:i.actualText?i.actualText.toString():i.formattedText.toString(),yt=i.formattedText?i.formattedText.toString():vt,dt=i.hasChild&&!i.isNamedSet?(i.isDrilled?" - ":" + ")+yt:yt,gt=s?s.uNameCollection:i.valueSort.levelName.toString(),ni={name:vt,text:dt,hasChild:i.hasChild,isDrilled:i.isDrilled,levelName:gt,level:c,fieldName:i.valueSort.axis?i.valueSort.axis.toString():"",rowIndex:u,colIndex:0,cell:i};("olap"===this.parent.dataType?3!==i.memberType:"value"!==i.type)&&(this.headerColl[a]||(this.headerColl[a]={}),this.headerColl[a][c]=ni);var ti=f[u],ii=Object.keys(ti),v=void 0;for(d="olap"===this.parent.dataType?3!==i.memberType?i:d:"value"!==i.type?i:d,nt=0,ft=ii;nt<ft.length;nt++){var ri=ft[nt],y=Number(ri),e=f[u][y],ui=""!==e.rowHeaders||0===this.dataSourceSettings.rows.length,et="olap"===this.parent.dataType&&s&&s.measureName?s.measureName:e.actualText;if(!bt[e.colIndex]&&"value"===e.axis&&"header"!==i.type&&""!==et&&(t.enableMultiAxis||et===this.currentMeasure)){if("olap"===this.parent.dataType?rt!==i.hierarchy||(3===i.memberType&&v?at!==this.measurePos||v.isDrilled:i.isDrilled):("value"===i.type&&v?v.members.length>0:i.members.length>0)||!ui)break;var fi="olap"===this.parent.dataType?e.columnHeaders.toString().split(/~~|::/).join(" - "):e.columnHeaders.toString().split(".").join(" - "),pt="olap"===this.parent.dataType?e.rowHeaders.toString().split(/~~|::/).join(" - "):e.rowHeaders.toString().split(".").join(" - "),ot=fi+" | "+et,wt="pivot"===this.parent.dataType&&this.engineModule.aggregatedValueMatrix[u]&&!Object(r.isNullOrUndefined)(this.engineModule.aggregatedValueMatrix[u][y])?Number(this.engineModule.aggregatedValueMatrix[u][y]):Number(e.value);this.columnGroupObject[ot]?this.columnGroupObject[ot].push({x:0===this.dataSourceSettings.rows.length?i.formattedText:pt,y:wt,rIndex:u,cIndex:y}):this.columnGroupObject[ot]=[{x:0===this.dataSourceSettings.rows.length?i.formattedText:pt,y:wt,rIndex:u,cIndex:y}]}v=d}}this.refreshChart()},n.prototype.refreshChart=function(){var o,u,e,t,n,f,s,i;for(this.chartSeries=[],o=Object.keys(this.columnGroupObject),this.persistSettings=JSON.parse(this.parent.getPersistData()).chartSettings,u=0,e=o;u<e.length;u++)t=e[u],n={},((n=this.persistSettings.chartSeries?this.frameObjectWithKeys(this.persistSettings.chartSeries):n).dataSource=this.columnGroupObject[t],n.xName="x",n.yName="y",n.name=this.chartSettings.enableMultiAxis?t:t.split(" | ")[0],"Polar"!==this.chartSettings.chartSeries.type&&"Radar"!==this.chartSettings.chartSeries.type)&&(f=t.split(" | ")[1],n.yAxisName=this.measuresNames[f]?this.measuresNames[f]:f),this.chartSeries=this.chartSeries.concat(n);s={series:this.chartSeries,cancel:!1};i=this;this.parent.trigger("chartSeriesCreated",s,function(n){n.cancel?(i.element&&Object(r.remove)(i.element),i.parent.notify(st,{})):i.bindChart()})},n.prototype.frameObjectWithKeys=function(n){for(var i=Object.keys(n),t=0,r={};t<i.length;)r[i[t]]=n[i[t]],t++;return r},n.prototype.bindChart=function(){var f=this.configXAxis(),e=this.configTooltipSettings(),o=this.configLegendSettings(),s=this.configZoomSettings(),i=this.frameAxesWithRows(),n=this.chartSettings.chartSeries.type,u,t;"Both"===this.parent.displayOption.view?this.element="Chart"===this.parent.displayOption.primary?this.parent.element.insertBefore(this.element?this.element:Object(r.createElement)("div",{className:it,id:this.parent.element.id+"_chart"}),this.parent.element.querySelector(".e-grid")):this.parent.element.appendChild(this.element?this.element:Object(r.createElement)("div",{className:it,id:this.parent.element.id+"_chart"})):this.element||(this.element=this.parent.element.appendChild(Object(r.createElement)("div",{className:it,id:this.parent.element.id+"_chart"})));!this.chartElement&&this.parent.chartSettings.showMultipleAxesScrollbar&&this.parent.chartSettings.enableMultiAxis&&(this.parent.element.querySelector("."+it).innerHTML="",this.chartElement=this.parent.element.querySelector("."+it).appendChild(Object(r.createElement)("div",{className:"e-pivotchart-inner",id:this.parent.element.id+"_chartInner"})));this.parent.element.querySelector(".e-pivotchart-inner")&&(this.parent.element.querySelector(".e-pivotchart-inner").innerHTML="");this.element.style.minWidth=this.parent.showGroupingBar?"400px !important":"310px !important";u=this.parent.width.toString();this.parent.showToolbar&&this.parent.grid&&(u=this.parent.getGridWidthAsNumber().toString());t=this.getChartHeight();this.parent.chartSettings.showMultipleAxesScrollbar&&this.parent.chartSettings.enableMultiAxis&&(this.parent.element.querySelector("."+it).style.height=("auto"===t?this.getChartAutoHeight():t)+"px",this.parent.element.querySelector("."+it).style.width=u+"px","Polar"!==this.parent.chartSettings.chartSeries.type&&"Radar"!==this.parent.chartSettings.chartSeries.type&&(this.parent.element.querySelector("."+it).style.overflow="auto",this.parent.element.querySelector("."+it).style.overflowX="hidden"));this.parent.chart&&this.parent.chart.element&&this.parent.element.querySelector(".e-chart")?(this.parent.chart.series=this.chartSeries,this.parent.chart.primaryXAxis=f,"Polar"===n||"Radar"===n?(this.parent.chart.primaryYAxis.visible=!0,this.parent.chart.primaryYAxis=i.axes[0],this.parent.chart.axes=[],this.parent.chart.rows=[{}]):(this.parent.chart.primaryYAxis.visible=!1,this.parent.chart.axes=i.axes,"Bar"===n||"StackingBar"===n||"StackingBar100"===n&&this.chartSettings.enableMultiAxis?(this.parent.chart.rows=[{height:"100%"}],this.parent.chart.columns=i.columns):(this.parent.chart.rows=i.rows,this.parent.chart.columns=[{width:"100%"}])),this.parent.chart.refresh()):(v.Chart.Inject(v.ColumnSeries,v.StackingColumnSeries,v.RangeColumnSeries,v.BarSeries,v.StackingBarSeries,v.ScatterSeries,v.BubbleSeries,v.LineSeries,v.StepLineSeries,v.SplineSeries,v.SplineAreaSeries,v.MultiColoredLineSeries,v.PolarSeries,v.RadarSeries,v.AreaSeries,v.RangeAreaSeries,v.StackingAreaSeries,v.StepAreaSeries,v.MultiColoredAreaSeries,v.ParetoSeries,v.Legend,v.Tooltip,v.Category,v.MultiLevelLabel,v.ScrollBar,v.Zoom,v.Export,v.Crosshair),this.parent.chart=new v.Chart({series:this.chartSeries.length>0?this.chartSeries:[{}],legendSettings:o,tooltip:e,zoomSettings:s,axes:"Polar"===n||"Radar"===n?[]:i.axes,rows:"Polar"===n||"Radar"===n?[{}]:"Bar"===n||"StackingBar"===n||"StackingBar100"===n&&this.chartSettings.enableMultiAxis?[{height:"100%"}]:i.rows,columns:"Polar"===n||"Radar"===n?[{}]:"Bar"===n||"StackingBar"===n||"StackingBar100"===n&&this.chartSettings.enableMultiAxis?i.columns:[{width:"100%"}],primaryYAxis:"Polar"===n||"Radar"===n?i.axes[0]:{visible:!1},primaryXAxis:f,width:u,height:"Polar"!==this.parent.chartSettings.chartSeries.type&&"Radar"!==this.parent.chartSettings.chartSeries.type&&this.parent.chartSettings.showMultipleAxesScrollbar&&this.parent.chartSettings.enableMultiAxis&&this.parent.dataSourceSettings.values.length>0?Number(t)>235*this.parent.dataSourceSettings.values.length+100?isNaN(Number(t))?t.toString():(Number(t)-5).toString():!isNaN(Number(t))||this.parent.dataSourceSettings.values.length>1?(235*this.parent.dataSourceSettings.values.length+100).toString():t.toString():t.toString(),title:this.chartSettings.title,titleStyle:this.chartSettings.titleStyle,subTitle:this.chartSettings.subTitle,subTitleStyle:this.chartSettings.subTitleStyle,margin:this.chartSettings.margin,border:this.chartSettings.border,background:this.chartSettings.background,chartArea:this.chartSettings.chartArea,palettes:this.chartSettings.palettes,theme:this.chartSettings.theme,crosshair:this.chartSettings.crosshair,selectionMode:this.chartSettings.selectionMode,isMultiSelect:this.chartSettings.isMultiSelect,enableExport:this.chartSettings.enableExport,selectedDataIndexes:this.chartSettings.selectedDataIndexes,isTransposed:this.chartSettings.isTransposed,enableAnimation:this.chartSettings.enableAnimation,useGroupingSeparator:this.chartSettings.useGroupingSeparator,description:this.chartSettings.description,tabIndex:this.chartSettings.tabIndex,locale:this.parent.locale,enableSideBySidePlacement:this.chartSettings.enableSideBySidePlacement,beforePrint:this.chartSettings.beforePrint?this.chartSettings.beforePrint.bind(this):void 0,animationComplete:this.chartSettings.animationComplete?this.chartSettings.animationComplete.bind(this):void 0,legendRender:this.chartSettings.legendRender?this.chartSettings.legendRender.bind(this):void 0,textRender:this.chartSettings.textRender?this.chartSettings.textRender.bind(this):void 0,pointRender:this.chartSettings.pointRender?this.chartSettings.pointRender.bind(this):void 0,seriesRender:this.chartSettings.seriesRender?this.chartSettings.seriesRender.bind(this):void 0,chartMouseMove:this.chartSettings.chartMouseMove?this.chartSettings.chartMouseMove.bind(this):void 0,chartMouseClick:this.chartSettings.chartMouseClick?this.chartSettings.chartMouseClick.bind(this):void 0,pointMove:this.chartSettings.pointMove?this.chartSettings.pointMove.bind(this):void 0,pointClick:this.pointClick.bind(this),chartMouseLeave:this.chartSettings.chartMouseLeave?this.chartSettings.chartMouseLeave.bind(this):void 0,chartMouseDown:this.chartSettings.chartMouseDown?this.chartSettings.chartMouseDown.bind(this):void 0,chartMouseUp:this.chartSettings.chartMouseUp?this.chartSettings.chartMouseUp.bind(this):void 0,dragComplete:this.chartSettings.dragComplete?this.chartSettings.dragComplete.bind(this):void 0,zoomComplete:this.chartSettings.zoomComplete?this.chartSettings.zoomComplete.bind(this):void 0,scrollStart:this.chartSettings.scrollStart?this.chartSettings.scrollStart.bind(this):void 0,scrollEnd:this.chartSettings.scrollEnd?this.chartSettings.scrollEnd.bind(this):void 0,scrollChanged:this.chartSettings.scrollChanged?this.chartSettings.scrollChanged.bind(this):void 0,tooltipRender:this.tooltipRender.bind(this),loaded:this.loaded.bind(this),load:this.load.bind(this),resized:this.resized.bind(this),axisLabelRender:this.axisLabelRender.bind(this),multiLevelLabelClick:this.multiLevelLabelClick.bind(this)}),this.parent.chart.isStringTemplate=!0);this.parent.chartSettings.showMultipleAxesScrollbar&&this.parent.chartSettings.enableMultiAxis?this.parent.chart.appendTo("#"+this.parent.element.id+"_chartInner"):this.parent.chart.appendTo("#"+this.parent.element.id+"_chart")},n.prototype.pointClick=function(n){if((this.parent.allowDrillThrough||this.parent.editSettings.allowEditing)&&this.parent.drillThroughModule){var t=n.series.dataSource[n.pointIndex].rIndex,i=n.series.dataSource[n.pointIndex].cIndex;this.parent.drillThroughModule.executeDrillThrough(this.parent.pivotValues[t][i],t,i)}this.parent.trigger("chartPointClick",n)},n.prototype.frameAxesWithRows=function(){var u=[],o=[],s=[],w=this.persistSettings.chartSeries&&("StackingColumn100"===this.persistSettings.chartSeries.type||"StackingBar100"===this.persistSettings.chartSeries.type||"StackingArea100"===this.persistSettings.chartSeries.type),b=["PercentageOfGrandTotal","PercentageOfColumnTotal","PercentageOfRowTotal","PercentageOfDifferenceFrom","PercentageOfParentRowTotal","PercentageOfParentColumnTotal","PercentageOfParentTotal"],v,f,p;if(this.chartSettings.enableMultiAxis)for(var h=0,k=100/this.dataSourceSettings.values.length+"%",c=0,d=this.dataSourceSettings.values;c<d.length;c++){for(var r=d[c],t=this.engineModule.fieldList[r.name],l=("olap"===this.parent.dataType?"":this.parent.localeObj.getConstant(t.aggregateType)+" "+this.parent.localeObj.getConstant("of")+" ")+t.caption,i=void 0,a=0,g=this.dataSourceSettings.formatSettings;a<g.length;a++)if(v=g[a],v.name===r.name){i=v;break}var y=-1!==e.inArray(t.aggregateType,b)?"P2":i?null===i.format.toLowerCase().match(/n|p|c/)?"N":i.format:"olap"===this.parent.dataType?this.getFormat(t.formatString):"N",nt="Polar"===this.chartSettings.chartSeries.type||"Radar"===this.chartSettings.chartSeries.type,n={};(n=this.persistSettings.primaryYAxis?this.frameObjectWithKeys(this.persistSettings.primaryYAxis):n).labelFormat=n.labelFormat?n.labelFormat:w?"":nt?"N":y;n.title=n.title?n.title:l;n.plotOffsetTop=n.plotOffsetTop?n.plotOffsetTop:"Bar"===this.chartSettings.chartSeries.type||"StackingBar"===this.chartSettings.chartSeries.type||"StackingBar100"===this.chartSettings.chartSeries.type?50:30;n.rowIndex=h;n.columnIndex=h;nt||(n.name=this.measuresNames[r.name]?this.measuresNames[r.name]:r.name);u=u.concat(n);o.push({height:k});s.push({width:k});h++}else{for(t=this.engineModule.fieldList[this.currentMeasure],l=("olap"===this.parent.dataType?"":this.parent.localeObj.getConstant(t.aggregateType)+" "+this.parent.localeObj.getConstant("of")+" ")+t.caption,i=void 0,f=0,p=this.dataSourceSettings.formatSettings;f<p.length;f++)if((r=p[f]).name===this.currentMeasure){i=r;break}n={};y=-1!==e.inArray(t.aggregateType,b)?"P2":i?null===i.format.toLowerCase().match(/n|p|c/)?"N":i.format:"olap"===this.parent.dataType?this.getFormat(t.formatString):"N";(n=this.persistSettings.primaryYAxis?this.frameObjectWithKeys(this.persistSettings.primaryYAxis):n).rowIndex=0;n.columnIndex=0;"Polar"!==this.chartSettings.chartSeries.type&&"Radar"!==this.chartSettings.chartSeries.type&&(n.name=this.measuresNames[this.currentMeasure]?this.measuresNames[this.currentMeasure]:this.currentMeasure);n.labelFormat=n.labelFormat?n.labelFormat:w?"":y;n.title=n.title?n.title:l;u=u.concat(n);o.push({height:"100%"});s.push({width:"100%"})}return{axes:u,rows:o,columns:s}},n.prototype.getFormat=function(n){return"Currency"===n?"C":"Percent"===n?"P":"N"},n.prototype.getColumnTotalIndex=function(n){for(var s,t,i={},r=0,f=Object.keys(n);r<f.length;r++)for(var h=f[r],e=n[Number(h)],u=0,o=Object.keys(e);u<o.length;u++){if(s=o[u],t=e[Number(s)],"column"!==t.axis)return i;("sum"===t.type||0!==this.dataSourceSettings.columns.length&&"grand sum"===t.type)&&-1!==t.rowSpan&&(i[t.colIndex]=t.colIndex)}return i},n.prototype.groupHierarchyWithLevels=function(n){var h,c,e,t,o,i;this.fieldPosition=[];var u={},f=0,s={};for(this.measurePos=this.engineModule.tupRowInfo[0].measurePosition,e=0;e<n.length;e++)t=n[e][0],t&&"row"===t.axis&&"grand sum"!==t.type&&(Object(r.isNullOrUndefined)(u[t.hierarchy])?(3===t.memberType?f===this.measurePos?(this.fieldPosition[this.measurePos]=t.hierarchy,u[t.hierarchy]=((h={})[t.levelUniqueName]=t.levelUniqueName,h)):f--:(this.fieldPosition[f]=t.hierarchy,u[t.hierarchy]=((c={})[t.levelUniqueName]=t.levelUniqueName,c)),f++):u[t.hierarchy][t.levelUniqueName]=t.levelUniqueName);for(o=-1,i=0;i<this.fieldPosition.length;i++)this.measurePos!==i&&(s[this.fieldPosition[i]]={start:o+1,end:o+Object.keys(u[this.fieldPosition[i]]).length},o=s[this.fieldPosition[i]].end);return s},n.prototype.frameMultiLevelLabels=function(){for(var e,l,k,i,a,v,o,y=Object.keys(this.headerColl),f=this.headerColl[-.5],s=0,p=y;s<p.length;s++){for(var h=p[s],r=Number(h),n=this.headerColl[r],t=0,w=!1;t<=this.maxLevel;)w?n[t]||(n[t]={name:n[t-1].name,text:"",hasChild:n[t-1].hasChild,isDrilled:n[t-1].isDrilled,levelName:n[t-1].levelName,level:n[t-1].level,fieldName:n[t-1].fieldName,rowIndex:n[t-1].rowIndex,colIndex:n[t-1].colIndex,span:-1}):n[t]?w=!0:n[t]=f[t],t++;f=this.headerColl[r]}for(var u={},c=0,b=y;c<b.length;c++){for(h=b[c],r=Number(h),n=this.headerColl[r],e=0,l=Object.keys(n);e<l.length;e++)k=l[e],i=Number(k),u[i]?(a=u[i].length,n[i].levelName===f[i].levelName?u[i][a-1].end=u[i][a-1].end+1:u[i].push({start:r,end:r+1,text:n[i].text,type:-1===n[i].span?"WithoutTopandBottomBorder":"WithoutTopBorder",customAttributes:n[i]})):u[i]=[{start:r,end:r+1,text:n[i].text,type:-1===n[i].span?"WithoutTopandBottomBorder":"WithoutTopBorder",customAttributes:n[i]}];f=n}for(v=[],o=Object.keys(u).length-1;o>-1;o--)v.push({categories:u[o],border:{width:1},overflow:"Trim"});return v},n.prototype.getZoomFactor=function(){this.calculatedWidth=isNaN(Number(this.parent.width))?this.parent.width.indexOf("%")>-1?this.parent.element.clientWidth*(parseFloat(this.parent.width)/100):this.parent.width.indexOf("px")>-1?Number(this.parent.width.toString().split("px")[0]):this.parent.element.clientWidth:Number(this.parent.width);var t=10*this.chartSeries.length>120?10*this.chartSeries.length:120,n=this.chartSeries.length>0?this.calculatedWidth/(Object.keys(this.chartSeries[0].dataSource).length*t):1;return n<1&&n>0?n:1},n.prototype.configTooltipSettings=function(){var n=this.chartSettings.tooltip;return n.enable=void 0===n.enable||n.enable,(this.parent.tooltipTemplate||n.template)&&(n.template=n.template?n.template:this.parent.tooltipTemplate),Object(r.isBlazor)()?(this.parent.allowServerDataBinding=!1,this.parent.setProperties({chartSettings:{tooltip:{header:n.header?n.header:""}}},!0),this.parent.allowServerDataBinding=!0):n.header=n.header?n.header:"",n.enableMarker=void 0===n.enableMarker||n.enableMarker,n},n.prototype.configLegendSettings=function(){var n={};return(n=this.chartSettings.legendSettings?this.chartSettings.legendSettings:n).padding=n.padding?n.padding:25,n.shapePadding=n.shapePadding?n.shapePadding:10,n},n.prototype.configXAxis=function(){var n={};return(n=this.persistSettings.primaryXAxis?this.frameObjectWithKeys(this.persistSettings.primaryXAxis):n).valueType="Category",n.labelIntersectAction=n.labelIntersectAction?n.labelIntersectAction:"Rotate45",n.title=n.title?n.title:this.dataSourceSettings.rows.map(function(n){return n.caption||n.name}).join(" / "),n.zoomFactor=this.getZoomFactor(),this.parent.chartSettings.zoomSettings.enableScrollbar||(n.zoomFactor=1),this.chartSettings.showMultiLevelLabels&&(n.multiLevelLabels=this.frameMultiLevelLabels(),n.border={width:1,type:"WithoutTopandBottomBorder"},n.majorTickLines={width:0,height:-10}),n},n.prototype.configZoomSettings=function(){var n=this.chartSettings.zoomSettings;return n.enableSelectionZooming=void 0===n.enableSelectionZooming||n.enableSelectionZooming,n.enableScrollbar=void 0===n.enableScrollbar||n.enableScrollbar,n},n.prototype.tooltipRender=function(n){var i=n.series.yAxisName?n.series.yAxisName.split("_CumulativeAxis")[0]:this.chartSettings.enableMultiAxis?n.series.name.split(" | ")[1]:this.measuresNames[this.currentMeasure]?this.measuresNames[this.currentMeasure]:this.currentMeasure,u=n.series.dataSource?n.series.dataSource[n.data.pointIndex].rIndex:void 0,f=n.series.dataSource?n.series.dataSource[n.data.pointIndex].cIndex:void 0,t=this.engineModule.fieldList[this.measuresNames[i]?this.measuresNames[i]:i],e="olap"===this.parent.dataType?"":this.parent.localeObj.getConstant(t.aggregateType),l=("olap"===this.parent.dataType?"":e+" "+this.parent.localeObj.getConstant("of")+" ")+t.caption,o=n.text.split("<b>")[1].split("<\/b>")[0],r=this.engineModule.formatFields[t.id],s=r&&r.format&&null!==r.format.toLowerCase().match(/n|p|c/)&&this.chartSettings.useGroupingSeparator?"olap"===this.parent.dataType?this.engineModule.getFormattedValue(n.point.y,t.id,o):this.parent.engineModule.getFormattedValue(n.point.y,t.id).formattedText:o,h=n.series.name?n.series.name.split(" | ")[0]:n.data.seriesName.split(" | ")[0],c=n.point.x;if(this.parent.tooltipTemplate&&void 0!==this.parent.getTooltipTemplate()){var a=n.series.dataSource?this.parent.getHeaderField(u,f,"row"):"",v=n.series.dataSource?this.parent.getHeaderField(u,f,"Column"):"",y={rowHeaders:c,columnHeaders:h,aggregateType:e,value:s,valueField:t.caption,rowFields:a,columnFields:v},p=this.parent.getTooltipTemplate()(y,this,"tooltipTemplate",this.element.id+"tooltipTemplate")[0].outerHTML;n.template=p}else n.text=l+": "+s+(0===this.dataSourceSettings.columns.length?"":" <br/>"+this.parent.localeObj.getConstant("column")+": "+h)+(0===this.dataSourceSettings.rows.length?"":" <br/>"+this.parent.localeObj.getConstant("row")+": "+c),this.parent.trigger("chartTooltipRender",n)},n.prototype.loaded=function(n){if(this.parent.isChartLoaded=!0,this.parent.chart&&this.parent.showGroupingBar&&this.parent.groupingBarModule&&this.parent.showFieldList&&"Chart"===this.parent.currentView&&this.parent.groupingBarModule.alignIcon(),this.chartSettings.showMultiLevelLabels){var t=e.inArray(this.chartSettings.chartSeries.type,["Bar","StackingBar","StackingBar100"])>-1?"_chartYAxisMultiLevelLabel0":"_chartXAxisMultiLevelLabel0";Object(r.isNullOrUndefined)(this.parent.element.querySelector("#"+this.parent.element.id+t))||this.parent.element.querySelector("#"+this.parent.element.id+t).setAttribute("cursor","pointer")}("Polar"===this.parent.chartSettings.chartSeries.type||"Radar"===this.parent.chartSettings.chartSeries.type)&&this.parent.chartSettings.showMultipleAxesScrollbar&&this.parent.chartSettings.enableMultiAxis?this.parent.element.querySelector("."+it).style.overflow="hidden":this.parent.chartSettings.showMultipleAxesScrollbar&&this.parent.chartSettings.enableMultiAxis&&(this.parent.element.querySelector("."+it).style.overflow="auto",this.parent.element.querySelector("."+it).style.overflowX="hidden");this.parent.chart.height="Polar"!==this.parent.chartSettings.chartSeries.type&&"Radar"!==this.parent.chartSettings.chartSeries.type&&this.parent.chartSettings.showMultipleAxesScrollbar&&this.parent.chartSettings.enableMultiAxis&&this.parent.dataSourceSettings.values.length>0?Number(this.parent.chart.height)>235*this.parent.dataSourceSettings.values.length+100?isNaN(Number(this.getChartHeight()))?this.getChartHeight().toString():(Number(this.getChartHeight())-5).toString():!isNaN(Number(this.getChartHeight()))||this.parent.dataSourceSettings.values.length>1?(235*this.parent.dataSourceSettings.values.length+100).toString():this.getChartHeight().toString():this.getChartHeight().toString();this.parent.grid&&this.parent.chart&&this.parent.showToolbar&&("Table"===this.parent.currentView?(this.parent.grid.element.style.display="",this.parent.chart.element.style.display="none"):(this.parent.grid.element.style.display="none",this.parent.chart.element.style.display=""));this.parent.notify(st,{});this.parent.trigger("chartLoaded",n)},n.prototype.getChartHeight=function(){var n=this.parent.height.toString();return Object(r.isNullOrUndefined)(this.parent.getHeightAsNumber())?n="auto":this.parent.showToolbar&&this.parent.showGroupingBar?n=(this.parent.getHeightAsNumber()-(this.parent.element.querySelector(".e-pivot-toolbar")?this.parent.element.querySelector(".e-pivot-toolbar").clientHeight:42)-(this.parent.element.querySelector(".e-chart-grouping-bar")?this.parent.element.querySelector(".e-chart-grouping-bar").clientHeight:76)).toString():this.parent.showToolbar?n=(this.parent.getHeightAsNumber()-(this.parent.element.querySelector(".e-pivot-toolbar")?this.parent.element.querySelector(".e-pivot-toolbar").clientHeight:42)).toString():this.parent.showGroupingBar?n=(this.parent.getHeightAsNumber()-(this.parent.element.querySelector(".e-chart-grouping-bar")?this.parent.element.querySelector(".e-chart-grouping-bar").clientHeight:76)).toString():(this.parent.chart&&parseInt(this.parent.chart.height,10)<200||this.parent.getHeightAsNumber()<200)&&(n="200"),n},n.prototype.getChartAutoHeight=function(){var n=this.parent.element.offsetHeight;return this.parent.showToolbar&&this.parent.showGroupingBar?n=this.parent.element.offsetHeight-(this.parent.element.querySelector(".e-pivot-toolbar")?this.parent.element.querySelector(".e-pivot-toolbar").clientHeight:42)-(this.parent.element.querySelector(".e-chart-grouping-bar")?this.parent.element.querySelector(".e-chart-grouping-bar").clientHeight:76):this.parent.showToolbar?n=this.parent.element.offsetHeight-(this.parent.element.querySelector(".e-pivot-toolbar")?this.parent.element.querySelector(".e-pivot-toolbar").clientHeight:42):this.parent.showGroupingBar&&(n=this.parent.element.offsetHeight-(this.parent.element.querySelector(".e-chart-grouping-bar")?this.parent.element.querySelector(".e-chart-grouping-bar").clientHeight:76)),n},n.prototype.axisLabelRender=function(n){this.chartSettings.showMultiLevelLabels&&"primaryXAxis"===n.axis.name&&(n.text="");this.parent.trigger("chartAxisLabelRender",n)},n.prototype.multiLevelLabelClick=function(n){n.customAttributes&&n.customAttributes.hasChild&&!n.customAttributes.cell.isNamedSet&&("olap"===this.parent.dataType?this.parent.onDrill(void 0,n.customAttributes):this.onDrill(n))},n.prototype.onDrill=function(n){var f=n.customAttributes,i=this.dataSourceSettings.drilledMembers[0]&&this.dataSourceSettings.drilledMembers[0].delimiter?this.dataSourceSettings.drilledMembers[0].delimiter:"**",e=f.fieldName,c=this.engineModule.pivotValues[f.rowIndex][f.colIndex],u=c.valueSort.levelName.split(this.engineModule.valueSortSettings.headerDelimiter).join(i),l=!1,o,t,s,h;if(0===this.dataSourceSettings.drilledMembers.length)this.parent.setProperties({dataSourceSettings:{drilledMembers:[{name:e,items:[u],delimiter:i}]}},!0);else{for(o=0;o<this.dataSourceSettings.drilledMembers.length;o++)t=this.dataSourceSettings.drilledMembers[o],(u=u.split(i).join(t.delimiter?t.delimiter:i),i=t.delimiter=t.delimiter?t.delimiter:i,t.name===e)&&(l=!0,s=t.items.indexOf(u),s>-1?t.items.splice(s,1):t.items.push(u));l||this.dataSourceSettings.drilledMembers.push({name:e,items:[u],delimiter:i})}this.parent.showWaitingPopup();h={fieldName:e,memberName:u,delimiter:i,axis:"row",action:f.isDrilled?"up":"down",currentCell:c};this.parent.trigger("drill",{drillInfo:h,pivotview:Object(r.isBlazor)()?void 0:this});this.parent.enableVirtualization?(this.engineModule.drilledMembers=this.dataSourceSettings.drilledMembers,this.engineModule.onDrill(h)):this.engineModule.generateGridData(this.dataSourceSettings);this.parent.setProperties({pivotValues:this.engineModule.pivotValues},!0);this.parent.renderPivotGrid()},n.prototype.load=function(n){n.chart.zoomModule&&(n.chart.zoomModule.isZoomed=!0);this.parent.trigger("chartLoad",n)},n.prototype.resized=function(n){Object(r.isBlazor)()&&(n.chart=this.parent.chart);n.chart.primaryXAxis.zoomFactor=this.getZoomFactor();this.parent.chartSettings.zoomSettings.enableScrollbar||(n.chart.primaryXAxis.zoomFactor=1);this.parent.trigger("chartResized",n)},n.prototype.destroy=function(){this.parent.isDestroyed||this.parent.chart&&!this.parent.chart.isDestroyed&&this.parent.chart.destroy()},n}();!function(n){n.axisLabelFont={size:"12px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"};n.axisTitleFont={size:"14px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"};n.chartTitleFont={size:"15px",fontWeight:"500",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"};n.chartSubTitleFont={size:"11px",fontWeight:"500",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"};n.crosshairLabelFont={size:"13px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"};n.tooltipLabelFont={size:"13px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"};n.legendLabelFont={size:"13px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"};n.stripLineLabelFont={size:"12px",fontWeight:"Regular",color:"#353535",fontStyle:"Normal",fontFamily:"Segoe UI"};n.stockEventFont={size:"13px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"}}(ht||(ht={}));var y=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),u=function(n,t,i,r){var f,e=arguments.length,u=e<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r,o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(n,t,i,r);else for(o=n.length-1;o>=0;o--)(f=n[o])&&(u=(e<3?f(u):e>3?f(t,i,u):f(t,i))||u);return e>3&&u&&Object.defineProperty(t,i,u),u},gi=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return y(t,n),u([Object(r.Property)(!0)],t.prototype,"enable",void 0),u([Object(r.Property)(1e3)],t.prototype,"duration",void 0),u([Object(r.Property)(0)],t.prototype,"delay",void 0),t}(r.ChildProperty),au=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return y(t,n),u([Object(r.Property)(null)],t.prototype,"value",void 0),u([Object(r.Property)(null)],t.prototype,"color",void 0),u([Object(r.Property)("0")],t.prototype,"dashArray",void 0),t}(r.ChildProperty),yt=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return y(t,n),u([Object(r.Property)("Normal")],t.prototype,"fontStyle",void 0),u([Object(r.Property)("16px")],t.prototype,"size",void 0),u([Object(r.Property)("Normal")],t.prototype,"fontWeight",void 0),u([Object(r.Property)("")],t.prototype,"color",void 0),u([Object(r.Property)("Center")],t.prototype,"textAlignment",void 0),u([Object(r.Property)("Segoe UI")],t.prototype,"fontFamily",void 0),u([Object(r.Property)(1)],t.prototype,"opacity",void 0),u([Object(r.Property)("Trim")],t.prototype,"textOverflow",void 0),t}(r.ChildProperty),nr=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return y(t,n),u([Object(r.Property)(10)],t.prototype,"left",void 0),u([Object(r.Property)(10)],t.prototype,"right",void 0),u([Object(r.Property)(10)],t.prototype,"top",void 0),u([Object(r.Property)(10)],t.prototype,"bottom",void 0),t}(r.ChildProperty),at=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return y(t,n),u([Object(r.Property)("")],t.prototype,"color",void 0),u([Object(r.Property)(1)],t.prototype,"width",void 0),t}(r.ChildProperty),vu=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return y(t,n),u([Object(r.Property)(0)],t.prototype,"x",void 0),u([Object(r.Property)(0)],t.prototype,"y",void 0),t}(r.ChildProperty),yu=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return y(t,n),u([Object(r.Property)(0)],t.prototype,"series",void 0),u([Object(r.Property)(0)],t.prototype,"point",void 0),t}(r.ChildProperty),pu=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return y(t,n),u([Object(r.Complex)({},at)],t.prototype,"border",void 0),u([Object(r.Property)("transparent")],t.prototype,"background",void 0),u([Object(r.Property)(1)],t.prototype,"opacity",void 0),u([Object(r.Property)(null)],t.prototype,"backgroundImage",void 0),t}(r.ChildProperty),wu=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return y(t,n),u([Object(r.Property)(!1)],t.prototype,"enable",void 0),u([Object(r.Property)("")],t.prototype,"dashArray",void 0),u([Object(r.Complex)({color:null,width:1},at)],t.prototype,"line",void 0),u([Object(r.Property)("Both")],t.prototype,"lineType",void 0),t}(r.ChildProperty),bu=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return y(t,n),u([Object(r.Property)(!1)],t.prototype,"visible",void 0),u([Object(r.Property)(null)],t.prototype,"name",void 0),u([Object(r.Property)("transparent")],t.prototype,"fill",void 0),u([Object(r.Property)(1)],t.prototype,"opacity",void 0),u([Object(r.Property)(0)],t.prototype,"angle",void 0),u([Object(r.Property)(!1)],t.prototype,"enableRotation",void 0),u([Object(r.Property)("Auto")],t.prototype,"position",void 0),u([Object(r.Property)(5)],t.prototype,"rx",void 0),u([Object(r.Property)(5)],t.prototype,"ry",void 0),u([Object(r.Property)("Center")],t.prototype,"alignment",void 0),u([Object(r.Complex)({width:null,color:null},at)],t.prototype,"border",void 0),u([Object(r.Complex)({left:5,right:5,top:5,bottom:5},nr)],t.prototype,"margin",void 0),u([Object(r.Complex)({size:"11px",color:"",fontStyle:"Normal",fontWeight:"Normal",fontFamily:"Segoe UI"},yt)],t.prototype,"font",void 0),u([Object(r.Property)(null)],t.prototype,"template",void 0),t}(r.ChildProperty),tr=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return y(t,n),u([Object(r.Property)(!1)],t.prototype,"visible",void 0),u([Object(r.Property)("Circle")],t.prototype,"shape",void 0),u([Object(r.Property)("")],t.prototype,"imageUrl",void 0),u([Object(r.Property)(5)],t.prototype,"width",void 0),u([Object(r.Property)(5)],t.prototype,"height",void 0),u([Object(r.Complex)({width:2,color:null},at)],t.prototype,"border",void 0),u([Object(r.Complex)({x:0,y:0},vu)],t.prototype,"offset",void 0),u([Object(r.Property)(null)],t.prototype,"fill",void 0),u([Object(r.Property)(1)],t.prototype,"opacity",void 0),u([Object(r.Complex)({},bu)],t.prototype,"dataLabel",void 0),t}(r.ChildProperty),ku=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return y(t,n),u([Object(r.Property)(1)],t.prototype,"width",void 0),u([Object(r.Property)(10)],t.prototype,"length",void 0),u([Object(r.Property)(null)],t.prototype,"color",void 0),u([Object(r.Property)(1)],t.prototype,"opacity",void 0),t}(r.ChildProperty),du=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return y(t,n),u([Object(r.Property)(!1)],t.prototype,"visible",void 0),u([Object(r.Property)("Fixed")],t.prototype,"type",void 0),u([Object(r.Property)("Both")],t.prototype,"direction",void 0),u([Object(r.Property)("Vertical")],t.prototype,"mode",void 0),u([Object(r.Property)(1)],t.prototype,"verticalError",void 0),u([Object(r.Property)(null)],t.prototype,"color",void 0),u([Object(r.Property)(1)],t.prototype,"width",void 0),u([Object(r.Property)(1)],t.prototype,"horizontalError",void 0),u([Object(r.Property)(3)],t.prototype,"verticalNegativeError",void 0),u([Object(r.Property)(3)],t.prototype,"verticalPositiveError",void 0),u([Object(r.Property)(1)],t.prototype,"horizontalNegativeError",void 0),u([Object(r.Property)(1)],t.prototype,"horizontalPositiveError",void 0),u([Object(r.Complex)(null,ku)],t.prototype,"errorBarCap",void 0),t}(r.ChildProperty),gu=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return y(t,n),u([Object(r.Property)("")],t.prototype,"name",void 0),u([Object(r.Property)("0")],t.prototype,"dashArray",void 0),u([Object(r.Property)(!0)],t.prototype,"visible",void 0),u([Object(r.Property)(2)],t.prototype,"period",void 0),u([Object(r.Property)("Linear")],t.prototype,"type",void 0),u([Object(r.Property)(0)],t.prototype,"backwardForecast",void 0),u([Object(r.Property)(0)],t.prototype,"forwardForecast",void 0),u([Object(r.Property)(2)],t.prototype,"polynomialOrder",void 0),u([Object(r.Complex)({},tr)],t.prototype,"marker",void 0),u([Object(r.Property)(!0)],t.prototype,"enableTooltip",void 0),u([Object(r.Complex)({},gi)],t.prototype,"animation",void 0),u([Object(r.Property)("")],t.prototype,"fill",void 0),u([Object(r.Property)(1)],t.prototype,"width",void 0),u([Object(r.Property)(null)],t.prototype,"intercept",void 0),u([Object(r.Property)("SeriesType")],t.prototype,"legendShape",void 0),t}(r.ChildProperty),nf=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return y(t,n),u([Object(r.Property)(null)],t.prototype,"fill",void 0),u([Object(r.Complex)({color:"transparent",width:0},at)],t.prototype,"border",void 0),u([Object(r.Property)("Gap")],t.prototype,"mode",void 0),t}(r.ChildProperty),tf=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return y(t,n),u([Object(r.Property)(0)],t.prototype,"topLeft",void 0),u([Object(r.Property)(0)],t.prototype,"topRight",void 0),u([Object(r.Property)(0)],t.prototype,"bottomLeft",void 0),u([Object(r.Property)(0)],t.prototype,"bottomRight",void 0),t}(r.ChildProperty),rf=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return y(t,n),u([Object(r.Property)(!1)],t.prototype,"enable",void 0),u([Object(r.Property)(null)],t.prototype,"fill",void 0),u([Object(r.Complex)(ht.crosshairLabelFont,yt)],t.prototype,"textStyle",void 0),t}(r.ChildProperty),uf=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return y(t,n),u([Object(r.Property)(!0)],t.prototype,"visible",void 0),u([Object(r.Property)(!1)],t.prototype,"startFromAxis",void 0),u([Object(r.Property)(null)],t.prototype,"start",void 0),u([Object(r.Property)(null)],t.prototype,"end",void 0),u([Object(r.Property)(null)],t.prototype,"size",void 0),u([Object(r.Property)("#808080")],t.prototype,"color",void 0),u([Object(r.Property)(null)],t.prototype,"dashArray",void 0),u([Object(r.Property)("Auto")],t.prototype,"sizeType",void 0),u([Object(r.Property)(!1)],t.prototype,"isRepeat",void 0),u([Object(r.Property)(null)],t.prototype,"repeatEvery",void 0),u([Object(r.Property)(null)],t.prototype,"repeatUntil",void 0),u([Object(r.Property)(!1)],t.prototype,"isSegmented",void 0),u([Object(r.Property)(null)],t.prototype,"segmentStart",void 0),u([Object(r.Property)(null)],t.prototype,"segmentEnd",void 0),u([Object(r.Property)(null)],t.prototype,"segmentAxisName",void 0),u([Object(r.Complex)({color:"transparent",width:1},at)],t.prototype,"border",void 0),u([Object(r.Property)("")],t.prototype,"text",void 0),u([Object(r.Property)(null)],t.prototype,"rotation",void 0),u([Object(r.Property)("Middle")],t.prototype,"horizontalAlignment",void 0),u([Object(r.Property)("Middle")],t.prototype,"verticalAlignment",void 0),u([Object(r.Complex)(ht.stripLineLabelFont,yt)],t.prototype,"textStyle",void 0),u([Object(r.Property)("Behind")],t.prototype,"zIndex",void 0),u([Object(r.Property)(1)],t.prototype,"opacity",void 0),t}(r.ChildProperty),ff=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return y(t,n),u([Object(r.Property)("")],t.prototype,"color",void 0),u([Object(r.Property)(1)],t.prototype,"width",void 0),u([Object(r.Property)("Rectangle")],t.prototype,"type",void 0),t}(r.ChildProperty),ef=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return y(t,n),u([Object(r.Property)(1)],t.prototype,"width",void 0),u([Object(r.Property)("")],t.prototype,"dashArray",void 0),u([Object(r.Property)(null)],t.prototype,"color",void 0),t}(r.ChildProperty),of=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return y(t,n),u([Object(r.Property)(.7)],t.prototype,"width",void 0),u([Object(r.Property)("")],t.prototype,"dashArray",void 0),u([Object(r.Property)(null)],t.prototype,"color",void 0),t}(r.ChildProperty),sf=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return y(t,n),u([Object(r.Property)(1)],t.prototype,"width",void 0),u([Object(r.Property)("")],t.prototype,"dashArray",void 0),u([Object(r.Property)(null)],t.prototype,"color",void 0),t}(r.ChildProperty),hf=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return y(t,n),u([Object(r.Property)(1)],t.prototype,"width",void 0),u([Object(r.Property)(5)],t.prototype,"height",void 0),u([Object(r.Property)(null)],t.prototype,"color",void 0),t}(r.ChildProperty),cf=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return y(t,n),u([Object(r.Property)(.7)],t.prototype,"width",void 0),u([Object(r.Property)(5)],t.prototype,"height",void 0),u([Object(r.Property)(null)],t.prototype,"color",void 0),t}(r.ChildProperty),lf=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return y(t,n),u([Object(r.Property)(null)],t.prototype,"fill",void 0),u([Object(r.Complex)(null,gi)],t.prototype,"animation",void 0),u([Object(r.Property)("0")],t.prototype,"dashArray",void 0),u([Object(r.Property)(1)],t.prototype,"width",void 0),u([Object(r.Property)("X")],t.prototype,"segmentAxis",void 0),u([Object(r.Property)("Line")],t.prototype,"drawType",void 0),u([Object(r.Property)(!0)],t.prototype,"isClosed",void 0),u([Object(r.Collection)([],au)],t.prototype,"segments",void 0),u([Object(r.Property)("")],t.prototype,"stackingGroup",void 0),u([Object(r.Complex)({color:"transparent",width:0},at)],t.prototype,"border",void 0),u([Object(r.Property)(!0)],t.prototype,"visible",void 0),u([Object(r.Property)(1)],t.prototype,"opacity",void 0),u([Object(r.Property)("Line")],t.prototype,"type",void 0),u([Object(r.Complex)(null,tr)],t.prototype,"marker",void 0),u([Object(r.Complex)(null,du)],t.prototype,"errorBar",void 0),u([Object(r.Property)(!0)],t.prototype,"enableTooltip",void 0),u([Object(r.Collection)([],gu)],t.prototype,"trendlines",void 0),u([Object(r.Property)("")],t.prototype,"tooltipMappingName",void 0),u([Object(r.Property)("SeriesType")],t.prototype,"legendShape",void 0),u([Object(r.Property)(1)],t.prototype,"minRadius",void 0),u([Object(r.Property)(null)],t.prototype,"selectionStyle",void 0),u([Object(r.Property)("Natural")],t.prototype,"splineType",void 0),u([Object(r.Property)(3)],t.prototype,"maxRadius",void 0),u([Object(r.Property)(.5)],t.prototype,"cardinalSplineTension",void 0),u([Object(r.Property)(null)],t.prototype,"columnWidth",void 0),u([Object(r.Complex)(null,nf)],t.prototype,"emptyPointSettings",void 0),u([Object(r.Complex)(null,tf)],t.prototype,"cornerRadius",void 0),u([Object(r.Property)(0)],t.prototype,"columnSpacing",void 0),t}(r.ChildProperty),ir=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return y(t,n),u([Object(r.Property)("Rotate45")],t.prototype,"labelIntersectAction",void 0),u([Object(r.Complex)(ht.axisLabelFont,yt)],t.prototype,"labelStyle",void 0),u([Object(r.Property)("")],t.prototype,"title",void 0),u([Object(r.Complex)({},rf)],t.prototype,"crosshairTooltip",void 0),u([Object(r.Property)("")],t.prototype,"labelFormat",void 0),u([Object(r.Complex)(ht.axisTitleFont,yt)],t.prototype,"titleStyle",void 0),u([Object(r.Property)(!1)],t.prototype,"isIndexed",void 0),u([Object(r.Property)(0)],t.prototype,"plotOffset",void 0),u([Object(r.Property)("None")],t.prototype,"edgeLabelPlacement",void 0),u([Object(r.Property)("BetweenTicks")],t.prototype,"labelPlacement",void 0),u([Object(r.Property)("Outside")],t.prototype,"tickPosition",void 0),u([Object(r.Property)(!1)],t.prototype,"opposedPosition",void 0),u([Object(r.Property)(!0)],t.prototype,"visible",void 0),u([Object(r.Property)("Outside")],t.prototype,"labelPosition",void 0),u([Object(r.Property)(0)],t.prototype,"labelRotation",void 0),u([Object(r.Property)(0)],t.prototype,"minorTicksPerInterval",void 0),u([Object(r.Property)(null)],t.prototype,"maximum",void 0),u([Object(r.Property)(null)],t.prototype,"minimum",void 0),u([Object(r.Property)(34)],t.prototype,"maximumLabelWidth",void 0),u([Object(r.Property)(null)],t.prototype,"interval",void 0),u([Object(r.Complex)({},hf)],t.prototype,"majorTickLines",void 0),u([Object(r.Property)(!1)],t.prototype,"enableTrim",void 0),u([Object(r.Complex)({},ef)],t.prototype,"majorGridLines",void 0),u([Object(r.Complex)({},cf)],t.prototype,"minorTickLines",void 0),u([Object(r.Complex)({},sf)],t.prototype,"lineStyle",void 0),u([Object(r.Complex)({},of)],t.prototype,"minorGridLines",void 0),u([Object(r.Property)(!1)],t.prototype,"isInversed",void 0),u([Object(r.Property)(null)],t.prototype,"description",void 0),u([Object(r.Property)(0)],t.prototype,"startAngle",void 0),u([Object(r.Property)(100)],t.prototype,"coefficient",void 0),u([Object(r.Collection)([],uf)],t.prototype,"stripLines",void 0),u([Object(r.Property)(2)],t.prototype,"tabIndex",void 0),u([Object(r.Complex)({color:null,width:0,type:"Rectangle"},ff)],t.prototype,"border",void 0),t}(r.ChildProperty),af=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return y(t,n),u([Object(r.Property)(!1)],t.prototype,"enableMarker",void 0),u([Object(r.Property)(!0)],t.prototype,"enable",void 0),u([Object(r.Property)(null)],t.prototype,"fill",void 0),u([Object(r.Property)(!1)],t.prototype,"shared",void 0),u([Object(r.Property)(.75)],t.prototype,"opacity",void 0),u([Object(r.Property)(null)],t.prototype,"header",void 0),u([Object(r.Property)(null)],t.prototype,"format",void 0),u([Object(r.Complex)(ht.tooltipLabelFont,yt)],t.prototype,"textStyle",void 0),u([Object(r.Property)(null)],t.prototype,"template",void 0),u([Object(r.Complex)({color:"#cccccc",width:.5},at)],t.prototype,"border",void 0),u([Object(r.Property)(!0)],t.prototype,"enableAnimation",void 0),t}(r.ChildProperty),vf=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return y(t,n),u([Object(r.Property)(!1)],t.prototype,"enablePinchZooming",void 0),u([Object(r.Property)(!0)],t.prototype,"enableSelectionZooming",void 0),u([Object(r.Property)(!1)],t.prototype,"enableDeferredZooming",void 0),u([Object(r.Property)(!1)],t.prototype,"enableMouseWheelZooming",void 0),u([Object(r.Property)("XY")],t.prototype,"mode",void 0),u([Object(r.Property)(["Zoom","ZoomIn","ZoomOut","Pan","Reset"])],t.prototype,"toolbarItems",void 0),u([Object(r.Property)(!0)],t.prototype,"enableScrollbar",void 0),u([Object(r.Property)(!1)],t.prototype,"enablePan",void 0),t}(r.ChildProperty),yf=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return y(t,n),u([Object(r.Complex)({},lf)],t.prototype,"chartSeries",void 0),u([Object(r.Complex)({},ir)],t.prototype,"primaryXAxis",void 0),u([Object(r.Complex)({},ir)],t.prototype,"primaryYAxis",void 0),u([Object(r.Property)("")],t.prototype,"value",void 0),u([Object(r.Property)(!1)],t.prototype,"enableMultiAxis",void 0),u([Object(r.Property)(!1)],t.prototype,"showMultipleAxesScrollbar",void 0),u([Object(r.Complex)(ht.chartTitleFont,yt)],t.prototype,"titleStyle",void 0),u([Object(r.Property)("")],t.prototype,"title",void 0),u([Object(r.Complex)(ht.chartSubTitleFont,yt)],t.prototype,"subTitleStyle",void 0),u([Object(r.Property)("")],t.prototype,"subTitle",void 0),u([Object(r.Complex)({color:"#DDDDDD",width:0},at)],t.prototype,"border",void 0),u([Object(r.Complex)({},nr)],t.prototype,"margin",void 0),u([Object(r.Complex)({border:{color:null,width:.5},background:"transparent"},pu)],t.prototype,"chartArea",void 0),u([Object(r.Property)(null)],t.prototype,"background",void 0),u([Object(r.Property)("Material")],t.prototype,"theme",void 0),u([Object(r.Property)([])],t.prototype,"palettes",void 0),u([Object(r.Complex)({},wu)],t.prototype,"crosshair",void 0),u([Object(r.Complex)({},af)],t.prototype,"tooltip",void 0),u([Object(r.Complex)({},vf)],t.prototype,"zoomSettings",void 0),u([Object(r.Property)()],t.prototype,"legendSettings",void 0),u([Object(r.Property)("None")],t.prototype,"selectionMode",void 0),u([Object(r.Property)(!0)],t.prototype,"enableExport",void 0),u([Object(r.Property)(!1)],t.prototype,"isMultiSelect",void 0),u([Object(r.Collection)([],yu)],t.prototype,"selectedDataIndexes",void 0),u([Object(r.Property)(!0)],t.prototype,"enableAnimation",void 0),u([Object(r.Property)(!0)],t.prototype,"useGroupingSeparator",void 0),u([Object(r.Property)(!1)],t.prototype,"isTransposed",void 0),u([Object(r.Property)(1)],t.prototype,"tabIndex",void 0),u([Object(r.Property)(null)],t.prototype,"description",void 0),u([Object(r.Event)()],t.prototype,"resized",void 0),u([Object(r.Property)(!0)],t.prototype,"enableSideBySidePlacement",void 0),u([Object(r.Event)()],t.prototype,"loaded",void 0),u([Object(r.Event)()],t.prototype,"beforePrint",void 0),u([Object(r.Event)()],t.prototype,"animationComplete",void 0),u([Object(r.Event)()],t.prototype,"load",void 0),u([Object(r.Event)()],t.prototype,"textRender",void 0),u([Object(r.Event)()],t.prototype,"legendRender",void 0),u([Object(r.Event)()],t.prototype,"seriesRender",void 0),u([Object(r.Event)()],t.prototype,"pointRender",void 0),u([Object(r.Event)()],t.prototype,"tooltipRender",void 0),u([Object(r.Event)()],t.prototype,"axisLabelRender",void 0),u([Object(r.Event)()],t.prototype,"chartMouseClick",void 0),u([Object(r.Event)()],t.prototype,"chartMouseMove",void 0),u([Object(r.Event)()],t.prototype,"pointMove",void 0),u([Object(r.Event)()],t.prototype,"pointClick",void 0),u([Object(r.Event)()],t.prototype,"chartMouseDown",void 0),u([Object(r.Event)()],t.prototype,"chartMouseLeave",void 0),u([Object(r.Event)()],t.prototype,"dragComplete",void 0),u([Object(r.Event)()],t.prototype,"chartMouseUp",void 0),u([Object(r.Event)()],t.prototype,"scrollStart",void 0),u([Object(r.Event)()],t.prototype,"zoomComplete",void 0),u([Object(r.Event)()],t.prototype,"scrollChanged",void 0),u([Object(r.Event)()],t.prototype,"scrollEnd",void 0),u([Object(r.Property)(!0)],t.prototype,"showMultiLevelLabels",void 0),t}(r.ChildProperty),dt=function(){function n(){}return n.getCellSets=function(n,t,i,u,f){var s;this.engine=t;this.isMondrian=t.isMondrian;this.isMeasureAvail=t.isMeasureAvail;this.isPaging=t.isPaging;this.pageSettings=t.pageSettings;this.rows=t.rows;this.columns=t.columns;this.values=t.values;this.filters=t.filters;this.allowLabelFilter=t.allowLabelFilter;this.allowValueFilter=t.allowValueFilter;this.valueSortSettings=n.valueSortSettings?n.valueSortSettings:void 0;this.drilledMembers=t.updateDrilledItems(n.drilledMembers);this.calculatedFieldSettings=t.calculatedFieldSettings;this.valueAxis="row"===n.valueAxis?"rows":"columns";u&&(u.axis="row"===u.axis?"rows":"columns");this.filterMembers=Object(r.extend)({},t.filterMembers,null,!0);this.fieldDataObj=t.fieldListObj;this.fieldList=t.fieldList;this.cellSetInfo="\nDIMENSION PROPERTIES PARENT_UNIQUE_NAME, HIERARCHY_UNIQUE_NAME, CHILDREN_CARDINALITY, MEMBER_TYPE, MEMBER_VALUE";var h=this.getMeasuresQuery(this.values),e=this.getDimensionsQuery(this.rows,h,"rows",u).replace(/\&/g,"&amp;"),o=this.getDimensionsQuery(this.columns,h,"columns",u).replace(/\&/g,"&amp;");this.isPaging&&i&&void 0!==this.pageSettings?(e=(s=this.getPagingQuery(e,o)).rowQuery,o=s.columnQuery):this.isPaging&&!i&&void 0!==this.pageSettings&&(e=(s=this.getPagingCountQuery(e,o)).rowQuery,o=s.columnQuery);e=e.length>0?e+(this.isPaging&&!i?"":this.cellSetInfo+" ON ROWS"):"";o=o.length>0?o+(this.isPaging&&!i?"":this.cellSetInfo+" ON COLUMNS"):"";var l=this.getSlicersQuery(this.filters,"filters").replace(/\&/g,"&amp;"),a=this.getfilterQuery(this.filterMembers,n.cube).replace(/\&/g,"&amp;").replace(/\>/g,"&gt;").replace(/\</g,"&lt;"),v=this.getCalculatedFieldQuery(this.calculatedFieldSettings).replace(/\&/g,"&amp;"),c=this.frameMDXQuery(e,o,l,a,v,i),y={catalog:n.catalog,cube:n.cube,url:n.url,request:c,LCID:n.localeIdentifier.toString()};t.mdxQuery=c.replace(/\&amp;/g,"&").replace(/\&gt;/g,">").replace(/\&lt;/g,"<").replace(/%280/g,'"');u&&(u.axis="rows"===u.axis?"row":"column");f||this.getTableCellData(y,this.isPaging&&!i?this.engine.generatePagingData.bind(this.engine):this.engine.generateEngine.bind(this.engine),u?{action:u.action,drillInfo:u}:{dataSourceSettings:n,action:"loadTableElements"})},n.getTableCellData=function(n,t,i){var r=this.engine.getConnectionInfo(n.url,n.LCID),u='<Envelope xmlns="http://schemas.xmlsoap.org/soap/envelope/"> <Header><\/Header> <Body> <Execute xmlns="urn:schemas-microsoft-com:xml-analysis"> <Command> <Statement>'+n.request+"<\/Statement> <\/Command> <Properties> <PropertyList> <Catalog>"+n.catalog+"<\/Catalog> <LocaleIdentifier>"+r.LCID+"<\/LocaleIdentifier> <\/PropertyList> <\/Properties><\/Execute> <\/Body> <\/Envelope>";this.engine.doAjaxPost("POST",r.url,u,t,i)},n.frameMDXQuery=function(n,t,i,r,u,f){var e=this.isPaging&&!f?""!==u?"":"\nWITH":"\nSelect ";return t.length>0&&(e+=t),n.length>0&&(e=e+(t.length>0?this.isPaging&&!f?"":", ":"")+n),e=u+e+(this.isPaging&&!f?"\nMEMBER [Measures].[3d268ce0-664d-4092-b9cb-fece97175006] AS Count([e16a30d0-2174-4874-8dae-a5085a75a3e2]) MEMBER [Measures].[8d7fe8c1-f09f-410e-b9ba-eaab75a1fc3e] AS Count ([d1876d2b-e50e-4547-85fe-5b8ed9d629de])\nSELECT { [Measures].[3d268ce0-664d-4092-b9cb-fece97175006] , [Measures].[8d7fe8c1-f09f-410e-b9ba-eaab75a1fc3e] } ON AXIS(0)":"")+r+i+"\nCELL PROPERTIES VALUE, FORMAT_STRING, FORMATTED_VALUE\n"},n.getPagingQuery=function(n,t){n=n.replace("NON EMPTY ( ","").slice(0,-1);t=t.replace("NON EMPTY ( ","").slice(0,-1);var e=n,i=(this.pageSettings.rowCurrentPage-1)*this.pageSettings.rowSize,r=(this.pageSettings.columnCurrentPage-1)*this.pageSettings.columnSize,u=3*this.pageSettings.rowSize,f=3*this.pageSettings.columnSize;return i=this.engine.rowCount<i+u?this.engine.rowCount>u?this.engine.rowCount-u:0:i,this.engine.pageRowStartPos=i,r=this.engine.columnCount<r+f?this.engine.columnCount>f?this.engine.columnCount-f:0:r,this.engine.pageColStartPos=r,{rowQuery:""!==n?"\nSUBSET ({ "+(this.isMondrian?"":"NONEMPTY")+" ("+n+(this.isMondrian||""===t?"":","+t)+")},"+i+","+u+")":"",columnQuery:""!==t?"\nSUBSET ({ "+(this.isMondrian?"":"NONEMPTY")+" ("+t+(this.isMondrian||""===e?"":","+e)+")},"+r+","+f+")":""}},n.getPagingCountQuery=function(n,t){n=n.replace("NON EMPTY ( ","").slice(0,-1);t=t.replace("NON EMPTY ( ","").slice(0,-1);var i=n;return{rowQuery:""!==n?"SET [d1876d2b-e50e-4547-85fe-5b8ed9d629de] as "+(this.isMondrian?"":"NONEMPTY")+" ("+n+(this.isMondrian||""===t?"":","+t)+")\n":"",columnQuery:""!==t?"\nSET [e16a30d0-2174-4874-8dae-a5085a75a3e2] as "+(this.isMondrian?"":"NONEMPTY")+" ("+t+(this.isMondrian||""===i?"":","+i)+")\n":""}},n.getDimensionsQuery=function(n,t,i,r){var u="",f,e;if(n.length>0){for(u="\nNON EMPTY ( "+(this.drilledMembers.length>0?"HIERARCHIZE ({":""),f=0;f<n.length;)0===f?"[measures]"===n[f].name.toLowerCase()?""!==t&&(u+=t):u+="({"+this.getDimensionQuery(n[f],i)+"})":"[measures]"===n[f].name.toLowerCase()?""!==t&&(u=u+" * "+t):u=u+" * "+("({"+this.getDimensionQuery(n[f],i)+"})"),f++;e=this.getDrillQuery(n,t,i,r);u=r&&r.axis===i?"\nNON EMPTY ( "+(this.drilledMembers.length>0?"HIERARCHIZE ({":"")+e.query:u+(""!==e.query?",":"")+e.query;u=(this.valueAxis!==i?this.updateValueSortQuery(u,this.valueSortSettings):u)+(this.drilledMembers.length>0?"})":"")+(this.isPaging&&"columns"===i&&""!==e.query?"-"+e.collection.join("-"):"")+")"}return u},n.getDrillQuery=function(n,t,i,r){var c="",w=[],a=[],s=!1,f="",l,v;for(r&&r.axis===i&&"down"===r.action.toLowerCase()?(s=!0,a=[{name:r.fieldName,items:[r.memberName],delimiter:"~~"}]):a=this.drilledMembers,l=0,v=a;l<v.length;l++)for(var y=v[l],p=0,b=y.items;p<b.length;p++){for(var o=[],h=[],u=0,e=b[p].split(y.delimiter?y.delimiter:"~~");u<n.length;){if(e[u]&&-1!==e[u].indexOf(n[u].name))-1!==e[e.length-1].indexOf(n[u].name)?s?f=f+(""!==f?" * ":"")+"({"+e[u]+".CHILDREN})":(o.push("("+e[u]+".CHILDREN)"),h.push("("+e[u]+")")):"[measures]"===e[u].toLowerCase()&&""!==t?s?f=f+(""!==f?" * ":"")+"("+t+")":(o.push("("+t+")"),h.push("("+t+")")):-1!==e[u].toLowerCase().indexOf("[measures]")?s?f=f+(""!==f?" * ":"")+"({"+e[u]+"})":(o.push("({"+e[u]+"})"),h.push("({"+e[u]+"})")):s?f=f+(""!==f?" * ":"")+"({"+e[u]+"})":(o.push("("+e[u]+")"),h.push("("+e[u]+")"));else{if(e[u]||!n[u]){o=[];break}"[measures]"===n[u].name.toLowerCase()&&""!==t?s?f=f+(""!==f?" * ":"")+"("+t+")":(o.push("("+t+")"),h.push("("+t+")")):s?f=f+(""!==f?" * ":"")+"({"+this.getDimensionQuery(n[u],i)+"})":(o.push("("+this.getDimensionQuery(n[u],i)+")"),h.push("("+this.getDimensionQuery(n[u],i)+")"))}u++}o.length>0&&o.length<e.length&&(o=[],h=[]);c=c+(""!==c&&o.length>0?",":"")+(o.length>0?"("+o.toString()+")":"");h.length>0&&w.push("("+h.toString()+")")}return{query:s?f:c,collection:s?[f]:w}},n.updateValueSortQuery=function(n,t){if(t&&t.measure&&""!==t.measure){var i=this.drilledMembers.length>0?"HIERARCHIZE ({":"",r=this.fieldList[t.measure].isCalculatedField?this.fieldList[t.measure].tag:t.measure;switch(t.sortOrder){case"Ascending":n=(n=n.replace("NON EMPTY ( "+i,"NON EMPTY ( "+i+" ORDER ({"))+"},("+r+"), ASC)";break;case"Descending":n=(n=n.replace("NON EMPTY ( "+i,"NON EMPTY ( "+i+" ORDER ({"))+"},("+r+"), DESC)"}}return n},n.getSlicersQuery=function(n,t){var f=this,i="",e=Object(r.extend)([],this.rows,null,!0),u;if(e=e.concat(this.columns),n.length>0){for(u=0;u<n.length;)e.filter(function(t){var i=f.getDimensionUniqueName(t.name),r=f.getDimensionUniqueName(n[u].name);return i===r&&!(f.isMondrian&&""===r&&""===i)}).length>0||(void 0===n[u].name||this.filterMembers[n[u].name]?this.filterMembers[n[u].name]&&(i=i+(""!==i?" * ":"")+"{"+this.filterMembers[n[u].name].toString()+"}"):i=i+(""!==i?" * ":"")+"{"+this.getDimensionQuery(n[u],t)+"}"),u++;i="\nWHERE ("+i.replace(/DrilldownLevel/g,"")+")"}return i},n.getDimensionQuery=function(n,t){var i=n.isCalculatedField?this.fieldList[n.name].tag:n.name;return this.fieldList[n.name].hasAllMember||n.isNamedSet||n.isCalculatedField?n.isNamedSet?"{"+i+"}":this.isPaging?i+".CHILDREN":"DrilldownLevel({"+i+"}"+("rows"===t||"columns"===t?",,,INCLUDE_CALC_MEMBERS":"")+")":"(("+i+").levels(0).AllMembers)"},n.getDimensionUniqueName=function(n){var f=this.fieldDataObj.hierarchy,i=[],t,r,u;if(f){for(t=0,r=f;t<r.length;t++)u=r[t],u.id.toLowerCase()===n.toLowerCase()&&i.push(u);return i.length>0?i[0].pid:""}return n.split(".")[0]},n.getMeasuresQuery=function(n){var t="",r,f;if(n.length>0){t="{{";for(var i="",u=0,e=n;u<e.length;u++)r=e[u],f=r.isCalculatedField?this.fieldList[r.name].tag:r.name,i=i.length>0?i+", "+f:f;t=t+i+"}}"}return t},n.getfilterQuery=function(n,t){for(var l,k,d,a,g,ot,v,tt,st,y,it,o,u,p,w,s="\nFROM ["+t+"]",r="\nFROM( SELECT (",h=[],c=[],f=[],e=[],b=0,ut=this.rows;b<ut.length;b++)n[(i=ut[b]).name]&&n[i.name].length>0&&("string"==typeof n[i.name][0]?f.push(n[i.name]):(n[i.name][1]=n[i.name][0].type,h.push(n[i.name]),delete n[i.name]));for(l=0,k=this.columns;l<k.length;l++)n[(i=k[l]).name]&&n[i.name].length>0&&("string"==typeof n[i.name][0]?e.push(n[i.name]):(d=n[i.name],d[1]=d[0].type,h.push(n[i.name]),delete n[i.name]));for(a=0,g=this.filters;a<g.length;a++){for(var i=g[a],ft=!1,nt=0,et=this.columns;nt<et.length;nt++)ot=et[nt],this.getDimensionUniqueName(ot.name)===this.getDimensionUniqueName(i.name)&&n[i.name]&&(e.push(n[i.name]),ft=!0);if(ft)for(v=0,tt=this.rows;v<tt.length;v++)st=tt[v],this.getDimensionUniqueName(st.name)===this.getDimensionUniqueName(i.name)&&n[i.name]&&f.push(n[i.name])}if((this.allowLabelFilter||this.allowValueFilter)&&h.length>0)for(y=0,it=["Value","Label"];y<it.length;y++)for(var ct=it[y],rt=0,ht=h;rt<ht.length;rt++)o=ht[rt],o&&2===o.length&&"string"==typeof o[1]&&o[1]===ct&&c.push(this.getAdvancedFilterQuery(o[0],r,"COLUMNS"));for(u=0,p=e.length;u<p;u++)r=0===u?r+"{"+e[u].toString()+"}":r+",{"+e[u].toString()+"}";for(e.length>0&&(r=f.length>0?r+" ) ON COLUMNS ,(":r+" ) ON COLUMNS"),u=0,p=f.length;u<p;u++)r=u>0?r+",{"+f[u].toString()+"}":r+"{"+f[u].toString()+"}";return r=e.length>0&&f.length>0?r+=") ON ROWS ":0===e.length&&f.length>0?r+") ON COLUMNS ":r,w="",c.length>0&&(w=c.join(" ")+" "+(e.length>0||f.length>0?r:"")+" "+s+Array(c.length+1+(e.length>0||f.length>0?1:0)).join(")")),s=0===e.length&&0===f.length?s:r+s+")",w.length>0?w:s},n.getAdvancedFilterQuery=function(n,t,i){return"\nFROM (SELECT Filter("+n.selectedField+".AllMembers, "+this.getAdvancedFilterCondtions(n.name,n.condition,n.value1,n.value2,n.type,n.measure)+")) on "+i},n.getAdvancedFilterCondtions=function(n,t,i,r,u,f){var e="";switch(t){case"Equals":e="("+("Value"!==u?n+'.CurrentMember.member_caption ="'+i+'"':f+" = "+i);break;case"DoesNotEquals":e="("+("Value"!==u?n+'.CurrentMember.member_caption <>"'+i+'"':f+" <>"+i);break;case"Contains":e="( InStr (1,"+n+'.CurrentMember.member_caption,"'+i+'") >0';break;case"DoesNotContains":e="( InStr (1,"+n+'.CurrentMember.member_caption,"'+i+'")=0';break;case"BeginWith":e="( Left ("+n+".CurrentMember.member_caption,"+i.length+')="'+i+'"';break;case"DoesNotBeginWith":e="( Left ("+n+".CurrentMember.member_caption,"+i.length+') <>"'+i+'"';break;case"EndsWith":e="( Right ("+n+".CurrentMember.member_caption,"+i.length+')="'+i+'"';break;case"DoesNotEndsWith":e="( Right ("+n+".CurrentMember.member_caption,"+i.length+') <>"'+i+'"';break;case"GreaterThan":e="("+("Value"!==u?n+'.CurrentMember.member_caption >"'+i+'"':f+" >"+i);break;case"GreaterThanOrEqualTo":e="("+("Value"!==u?n+'.CurrentMember.member_caption >="'+i+'"':f+" >="+i);break;case"LessThan":e="("+("Value"!==u?n+'.CurrentMember.member_caption <"'+i+'"':f+" <"+i);break;case"LessThanOrEqualTo":e="("+("Value"!==u?n+'.CurrentMember.member_caption <="'+i+'"':f+" <="+i);break;case"Between":e="("+("Value"!==u?n+'.CurrentMember.member_caption >="'+i+'"AND '+n+'.CurrentMember.member_caption <="'+r+'"':f+" >="+i+" AND "+f+" <="+r);break;case"NotBetween":e="("+("Value"!==u?n+'.CurrentMember.member_caption >="'+i+'"OR '+n+'.CurrentMember.member_caption <="'+r+'"':f+" >="+i+" OR "+f+" <="+r);break;default:e="( InStr (1,"+n+'.CurrentMember.member_caption,"'+i+'") >0'}return e},n.getCalculatedFieldQuery=function(n){var u="",i,f;if(n.length>0)for(u="\nWITH",i=0,f=n;i<f.length;i++){var t=f[i],o=(t.formula.indexOf("Measure")>-1?"[Measures].":t.hierarchyUniqueName+".")+"["+t.name+"]",e=Object(r.isNullOrUndefined)(t.formatString)?null:t.formatString;u+="\nMEMBER "+o+"as ("+t.formula+") "+(Object(r.isNullOrUndefined)(e)?"":', FORMAT_STRING ="'+e.trim()+'"')}return u},n}(),rr=function(){function n(){this.fieldList={};this.columnCount=0;this.rowCount=0;this.colFirstLvl=0;this.rowFirstLvl=0;this.pageColStartPos=0;this.enableSort=!1;this.enableValueSorting=!1;this.dataFields={};this.formatFields={};this.filterMembers={};this.drilledSets={};this.aggregatedValueMatrix=[];this.customRegex=/^(('[^']+'|''|[^*#@0,.])*)(\*.)?((([0#,]*[0,]*[0#]*)(\.[0#]*)?)|([#,]*@+#*))(E\+?0+)?(('[^']+'|''|[^*#@0,.E])*)$/;this.formatRegex=/(^[ncpae]{1})([0-1]?[0-9]|20)?$/i;this.pivotValues=[];this.valueContent=[];this.headerContent=[];this.rowStartPos=0;this.pageRowStartPos=0;this.tupColumnInfo=[];this.tupRowInfo=[];this.gridJSON="";this.namedSetsPosition={};this.colDepth=0;this.totalCollection=[];this.parentObjCollection={};this.curDrillEndPos=-1;this.headerGrouping={};this.lastLevel=[];this.showRowSubTotals=!0;this.showColumnSubTotals=!0;this.hideRowTotalsObject={};this.hideColumnTotalsObject={};this.sortObject={}}return n.prototype.renderEngine=function(n,t){this.isEmptyData=!1;this.mdxQuery="";this.isMeasureAvail=!1;this.allowMemberFilter=!1;this.allowLabelFilter=!1;this.allowValueFilter=!1;this.isMondrian=!1;this.aggregatedValueMatrix=[];this.measureReportItems=[];this.calcChildMembers=[];this.selectedItems=[];this.savedFieldList=void 0;this.savedFieldListData=void 0;this.formatFields={};this.filterMembers={};this.dataFields={};this.valueAxis="";this.columnCount=0;this.rowCount=0;this.colFirstLvl=0;this.rowFirstLvl=0;this.pageColStartPos=0;this.enableValueSorting=!1;this.sortObject={};this.globalize=new r.Internationalization;this.locale=this.globalize.getCulture();this.localeObj=t?t.localeObj:void 0;this.enableValueSorting=!!t&&t.enableValueSorting;n.url&&(this.dataSourceSettings=n,this.valueAxis="row"===n.valueAxis?"row":"column",this.getAxisFields(),this.formats=n.formatSettings?n.formatSettings:[],this.enableSort=void 0===n.enableSorting||n.enableSorting,this.valueSortSettings=n.valueSortSettings?n.valueSortSettings:void 0,this.filterSettings=n.filterSettings?n.filterSettings:[],this.sortSettings=n.sortSettings?n.sortSettings:[],this.allowMemberFilter=!!n.allowMemberFilter,this.allowLabelFilter=!!n.allowLabelFilter,this.allowValueFilter=!!n.allowValueFilter,this.drilledMembers=n.drilledMembers?this.updateDrilledItems(n.drilledMembers):[],this.calculatedFieldSettings=n.calculatedFieldSettings?n.calculatedFieldSettings:[],this.emptyCellTextContent=n.emptyCellsTextContent?n.emptyCellsTextContent:"",this.pageSettings=t?t.pageSettings?t.pageSettings:this.pageSettings:void 0,this.isPaging=!!this.pageSettings,this.frameSortObject(),this.getFormattedFields(this.formats),this.savedFieldList=t?t.savedFieldList:void 0,this.savedFieldListData=t?t.savedFieldListData:void 0,this.fieldListData=[],this.fieldListObj={},this.setNamedSetsPosition(),this.savedFieldList&&this.savedFieldListData?this.updateFieldlist(!0):this.getFieldList(n),this.loadCalculatedMemberElements(this.calculatedFieldSettings),this.measureReportItems=[],this.updateFilterItems(this.filterSettings),this.generateGridData(n))},n.prototype.generateGridData=function(n,t){var i=!(!t||"navPaging"!==t||!this.isPaging||void 0===this.pageSettings);this.rows.length>0||this.columns.length>0||this.values.length>0||this.filters.length>0?dt.getCellSets(n,this,i):(dt.getCellSets(n,this,!0,void 0,!0),this.generateEngine(void 0,void 0,{dataSourceSettings:n,action:"loadTableElements"}))},n.prototype.generatePagingData=function(n,t,i){var u=[].slice.call(n.querySelectorAll("Axes, CellData")),r=u[1]?u[1].querySelectorAll("FmtValue"):null,f;r&&r.length>0&&(this.columnCount=Number(r[0].textContent),this.rowCount=Number(r[1].textContent));f=i.dataSourceSettings;dt.getCellSets(f,this,!0)},n.prototype.scrollPage=function(){dt.getCellSets(this.dataSourceSettings,this,!0)},n.prototype.generateEngine=function(n,t,i){var s,f,e;"down"!==i.action&&(this.pivotValues=[],this.valueContent=[],this.headerContent=[],this.colDepth=0,this.tupColumnInfo=[],this.tupRowInfo=[],this.colMeasures={},this.colMeasurePos=void 0,this.rowMeasurePos=void 0,this.rowStartPos=-1);this.xmlDoc=n?n.cloneNode(!0):void 0;this.request=t;this.customArgs=i;this.totalCollection=[];this.parentObjCollection={};this.curDrillEndPos=-1;this.onDemandDrillEngine=[];this.getSubTotalsVisibility();this.xmlaCellSet=n?n.querySelectorAll("Axes, CellData"):void 0;var r=this.xmlaCellSet&&this.xmlaCellSet.length>0?[].slice.call(this.xmlaCellSet[0].querySelectorAll('Axis[name|="Axis0"] Tuple')):[],o=this.xmlaCellSet&&this.xmlaCellSet.length>0?[].slice.call(this.xmlaCellSet[0].querySelectorAll('Axis[name|="Axis1"] Tuple')):[],u=this.xmlaCellSet&&this.xmlaCellSet.length>1?[].slice.call(this.xmlaCellSet[1].querySelectorAll("Cell")):[];if(this.drilledMembers.length>0&&(s=this.getMeasureInfo(),f=void 0,r=(f=this.frameMeasureOrder(s,"column",r,u,r.length)).orderedHeaderTuples,u=f.orderedValueTuples,o=(f=this.frameMeasureOrder(s,"row",o,u,r.length)).orderedHeaderTuples,u=f.orderedValueTuples),"down"===i.action&&this.updateTupCollection("row"===i.drillInfo.axis?o.length:r.length),"down"===i.action&&"column"!==i.drillInfo.axis||(this.frameColumnHeader(r),this.isPaging||this.performColumnSorting()),"down"===i.action&&"row"!==i.drillInfo.axis||(this.frameRowHeader(o),this.isPaging||this.performRowSorting()),this.frameValues(u,r.length),this.performColumnSpanning(),!this.isPaging&&this.enableSort)for(e=0;e<this.headerContent.length;e++)this.headerContent[e]=this.pivotValues[e];this.isEngineUpdated=!0;this.isEmptyData=0===r.length},n.prototype.getSubTotalsVisibility=function(){var i,n,t;this.showRowSubTotals=this.dataSourceSettings.showRowSubTotals&&this.dataSourceSettings.showSubTotals;this.showColumnSubTotals=this.dataSourceSettings.showColumnSubTotals&&this.dataSourceSettings.showSubTotals;this.hideRowTotalsObject={};this.hideColumnTotalsObject={};i=1;do{if(1===i){if(this.showColumnSubTotals)for(n=0;n<this.dataSourceSettings.columns.length;n++)!1===this.dataSourceSettings.columns[n].showSubTotals&&(this.hideColumnTotalsObject[this.dataSourceSettings.columns[n].name]=n)}else if(this.showRowSubTotals)for(t=0;t<this.dataSourceSettings.rows.length;t++)!1===this.dataSourceSettings.rows[t].showSubTotals&&(this.hideRowTotalsObject[this.dataSourceSettings.rows[t].name]=t);i++}while(i<3)},n.prototype.frameRowHeader=function(n){var u,ct,p,yt,l,g,pt,nt,wt,ut,lt,o,bt,kt,ft,tt;this.headerGrouping={};this.lastLevel=[];var r=this.pivotValues.length,e=[],a=[];"down"!==this.customArgs.action?(e=this.pivotValues,a=this.valueContent):r=this.customArgs.drillInfo.currentCell.rowIndex+1;this.rowStartPos=this.rowStartPos>0?this.rowStartPos:r;for(var et,ot,f,v,i=0,it=[],y={},dt=[],st=!1,rt=-1,ht=-1,at=[],s=[{axis:"row",colIndex:0,formattedText:"Grand Total",hasChild:!1,level:-1,rowIndex:0,index:[],type:"grand sum",ordinal:0,colSpan:1,rowSpan:1,memberType:2,isDrilled:!1,valueSort:{"Grand Total":1,levelName:"Grand Total"}}],vt=[],gt=this.customArgs.drillInfo&&"row"===this.customArgs.drillInfo.axis?this.customArgs.drillInfo.currentCell.ordinal+1:0;i<n.length;)u=n[i].querySelectorAll("Member"),vt=this.frameTupCollection(u,vt,i+gt,this.tupRowInfo,this.showRowSubTotals,this.hideRowTotalsObject,"row"),i++;for(i=0,ct=n.length,"down"===this.customArgs.action&&(p=this.customArgs.drillInfo.currentCell.ordinal+1,i=p,ct+=p,ot=this.tupRowInfo[p-1].allCount,et=this.tupRowInfo[p-1].allStartPos,v=this.tupRowInfo[p-1]),yt=i;i<ct;){u=n["down"===this.customArgs.action?i-(this.customArgs.drillInfo.currentCell.ordinal+1):i].querySelectorAll("Member");var t=0,k=void 0,w=this.tupRowInfo[i].allCount,c=this.tupRowInfo[i].allStartPos,b=this.tupRowInfo[i].measure,h=this.tupRowInfo[i].typeCollection,d=(this.tupRowInfo[i].drillInfo,this.tupRowInfo[i].drillStartPos),ni=this.tupRowInfo[i].startDrillUniquename;if(this.tupRowInfo[i].drillEndPos,this.tupRowInfo[i].levelCollection,0===i||i===yt){for(l="down"===this.customArgs.action?this.tupRowInfo[0].members:u;t<l.length;)at[t]="1"===l[t].querySelector("MEMBER_TYPE").textContent&&0===Number(l[t].querySelector("LNum").textContent)?0:Number(l[t].querySelector("LNum").textContent),"1"===l[t].querySelector("MEMBER_TYPE").textContent?(y[t]=0,rt=-1===rt?t:rt,ht=t):(y[t]=1,st="3"!==l[t].querySelector("MEMBER_TYPE").textContent||st),t++;f=h.indexOf("3")}if(t=0,0===i&&(u.length>w+(b?1:0)||1===u.length&&b)&&s.pop(),0===i&&this.isPaging?0===s.length:!st||w===ot||c!==et||1===u.length&&b){if(g=!(d>-1)||!(w>0)||c>d,g=v&&g&&d>-1?v.startDrillUniquename!==ni||!(ht>v.measurePosition||v.measureName===this.tupRowInfo[i].measureName||c!==d+1&&this.tupRowInfo[i].measurePosition!==d+1):g,pt=!(rt>-1&&w>0)||c>ht,u.length===w+(b?1:0)&&b)nt="Grand Total."+u[f].querySelector("Caption").textContent,s.push({axis:"row",actualText:this.getUniqueName(u[f].querySelector("UName").textContent),colIndex:0,formattedText:u[f].querySelector("Caption").textContent,hasChild:!1,level:-1,rowIndex:r,index:[],ordinal:i,colSpan:1,rowSpan:1,memberType:Number(h[f]),isDrilled:!1,parentUniqueName:u[f].querySelector("PARENT_UNIQUE_NAME")?u[f].querySelector("PARENT_UNIQUE_NAME").textContent:void 0,levelUniqueName:u[f].querySelector("LName").textContent,hierarchy:u[f].getAttribute("Hierarchy"),valueSort:{levelName:nt,axis:u[f].getAttribute("Hierarchy")}}),s[s.length-1].valueSort["Grand Total."+u[f].querySelector("Caption").textContent]=1;else if(0!==c&&(0!==f||1!==c)&&g&&pt){for(v=this.tupRowInfo[i],wt=r,ut=t,k={},lt=!1;t<u.length;){if(o=u[t],o.querySelector("UName").textContent===it[t]||"2"===h[t]||(Object.keys(k).length>0?k.isDrilled:lt)&&("3"!==h[t]||!y[t-1]||0===y[t+1]))"2"===h[t]?ut=t:this.tupRowInfo[i].drillInfo[t].isDrilled&&0===y[t]&&(lt=!0);else{for(bt=Number(o.querySelector("LNum").textContent)-(y[t]&&"3"!==h[t]?1:at[t]),kt=!!this.namedSetsPosition.row[t],e[r]=[{axis:"row",actualText:this.getUniqueName(o.querySelector("UName").textContent),colIndex:0,formattedText:o.querySelector("Caption").textContent,hasChild:Number(o.querySelector("CHILDREN_CARDINALITY").textContent)>0,level:bt,rowIndex:r,index:[],ordinal:i,type:"header",colSpan:1,rowSpan:1,memberType:Number(h[t]),isDrilled:this.tupRowInfo[i].drillInfo[t].isDrilled,parentUniqueName:o.querySelector("PARENT_UNIQUE_NAME")?o.querySelector("PARENT_UNIQUE_NAME").textContent:void 0,levelUniqueName:o.querySelector("LName").textContent,hierarchy:o.getAttribute("Hierarchy"),isNamedSet:kt,valueSort:{levelName:"",axis:o.getAttribute("Hierarchy")}}],(k="3"!==h[t]?e[r][0]:k)||dt.push(o.querySelector("Caption").textContent),nt=this.getCaptionCollectionWithMeasure(this.tupRowInfo[i]),e[r][0].valueSort.levelName=nt,e[r][0].valueSort[nt]=1,a[r-this.rowStartPos]={},a[r-this.rowStartPos][0]=e[r][0],b&&f>t&&(it[f]=""),ft=t+1;ft<u.length;ft++)it[ft]="";it[t]=o.querySelector("UName").textContent;r++;ut=t}this.tupRowInfo[i].drillInfo[t].isDrilled&&this.tupRowInfo[i].showTotals&&(this.tupRowInfo[i].showTotals=!!this.showRowSubTotals&&void 0===this.hideRowTotalsObject[this.tupRowInfo[i].drillInfo[t].hierarchy]);t++}wt<r&&ut>=u.length-1&&(e[r-1][0].ordinal=i,"header"===e[r-1][0].type&&delete e[r-1][0].type)}ot=w;et=c}i++}if(s.length>1&&3!==s[0].memberType&&(s[0].ordinal=-1),"down"!==this.customArgs.action){if(this.dataSourceSettings.showGrandTotals&&this.dataSourceSettings.showRowGrandTotals)for(tt=0;tt<s.length;tt++)s[tt].rowIndex=r,e[r]=[s[tt]],a[r-this.rowStartPos]={},a[r-this.rowStartPos][0]=e[r][0],r++}else this.updateRowEngine(e,a,n.length),this.onDemandDrillEngine=e},n.prototype.frameTupCollection=function(n,t,i,u,f,e,o){for(var w,l,ft,et,b,a,pt,ot,st,ht,ct,wt,g,nt,y,lt,at,k,s=0,tt=0,it=[],vt=[],rt=[],p="",d="",yt=!0,ut=-1;s<n.length;){var c=n[s],h=Number(c.querySelector("LNum").textContent),v=c.querySelector("UName").textContent;if(Number(c.querySelector("MEMBER_TYPE").textContent)>3&&(c.querySelector("MEMBER_TYPE").textContent=v.startsWith("[Measures]")?"3":"1"),w=v.startsWith("[Measures]")?"3":Number(c.querySelector("MEMBER_TYPE").textContent)>3?"1":c.querySelector("MEMBER_TYPE").textContent,l=c.querySelector("Caption").textContent,this.fieldList[l]&&"CalculatedField"===this.fieldList[l].type&&(l=this.fieldList[l].caption,c.querySelector("Caption").textContent=l),ft=c.getAttribute("Hierarchy"),et=c.querySelector("PARENT_UNIQUE_NAME")?c.querySelector("PARENT_UNIQUE_NAME").textContent:"","2"===w?(tt++,y=Object(r.isNullOrUndefined)(y)?s:y):"3"===w?(lt=c,at=v,k=s,"column"===o?(this.colMeasures[v]=c,this.colMeasurePos=s):this.rowMeasurePos=s):ut=e[ft],"2"!==w){if(this.headerGrouping[s]){if(h>this.lastLevel[s])this.lastLevel[s]=h;else if(h<this.lastLevel[s]){for(b=this.lastLevel[s];b>=h;)delete this.headerGrouping[s].UName[b],delete this.headerGrouping[s].Caption[b],b--;this.lastLevel[s]=h}this.headerGrouping[s].UName[h]=v;this.headerGrouping[s].Caption[h]=l}else this.lastLevel[s]=h,this.headerGrouping[s]={UName:(g={},g[h]=v,g),Caption:(nt={},nt[h]=l,nt)};if(this.isPaging)for(a=et;this.drilledSets[a];)pt=this.drilledSets[a].querySelector("Caption").textContent,ot=Number(this.drilledSets[a].querySelector("LNum").textContent),this.headerGrouping[s].UName[ot]=a,this.headerGrouping[s].Caption[ot]=pt,a=null===this.drilledSets[a].querySelector("PARENT_UNIQUE_NAME")?"":this.drilledSets[a].querySelector("PARENT_UNIQUE_NAME").textContent;st=Object.values(this.headerGrouping[s].UName).join("~~");p=""===p?st:p+"::"+st;ht=Object.values(this.headerGrouping[s].Caption).join("~~");s!==k&&(d=""===d?ht:d+"::"+ht)}(it.push(w),vt.push(h),(Object(r.isNullOrUndefined)(t[s])||t[s]<h)&&(t[s]=h),rt.push({level:h,uName:v,hierarchy:ft,isDrilled:!1}),u[i-1]&&"1"===u[i-1].typeCollection[s]&&rt[s].level>u[i-1].drillInfo[s].level)&&(ct=p.split(/~~|::\[/).map(function(n){return"["===n[0]?n:"["+n}),ct.pop(),wt=ct.join("~~"),this.setDrillInfo(et,wt,s,i,u));s++}return ut>-1&&(yt="2"!==it[ut+1]),u[i]={allCount:tt,allStartPos:y,measure:lt,measureName:at,measurePosition:k,members:n,typeCollection:it,uNameCollection:p,captionCollection:d,levelCollection:vt,drillInfo:rt,drillStartPos:-1,drillEndPos:-1,showTotals:!(!f&&tt>0&&y>(0===k?1:0))&&yt},t},n.prototype.getCaptionCollectionWithMeasure=function(n){var t=n.captionCollection,r,u,i;return n.measure?(r=n.measure.querySelector("Caption").textContent,u=n.uNameCollection.split(/[~~,::]+/g).indexOf(n.measureName),(i=n.captionCollection.split(/[~~,::]+/g)).splice(u,0,r),t=i.join(".")):t=(i=n.captionCollection.split(/[~~,::]+/g)).join("."),t},n.prototype.setNamedSetsPosition=function(){var n;this.namedSetsPosition={};n=0;do{for(var r={},i=n?this.dataSourceSettings.rows:this.dataSourceSettings.columns,t=0;t<i.length;t++)i[t].isNamedSet&&(r[t]=i[t].name);this.namedSetsPosition[n?"row":"column"]=r;n++}while(n<2)},n.prototype.updateRowEngine=function(n,t,i){for(var u,r=this.pivotValues.length-1,f=Object.keys(n).length;r>this.customArgs.drillInfo.currentCell.rowIndex;)this.pivotValues[r+f]=this.pivotValues[r],this.pivotValues[r+f][0].ordinal+=i,this.pivotValues[r+f][0].rowIndex+=f,this.valueContent[r+f-this.rowStartPos]=this.valueContent[r-this.rowStartPos],r--;for(u=0;u<n.length;u++)this.pivotValues[u]=n[u],this.valueContent[Number(u)-this.rowStartPos]=t[Number(u)-this.rowStartPos];this.pivotValues[this.customArgs.drillInfo.currentCell.rowIndex][0].isDrilled=!0},n.prototype.updateTupCollection=function(n){for(var i="row"===this.customArgs.drillInfo.axis?this.tupRowInfo:this.tupColumnInfo,t=i.length-1;t>this.customArgs.drillInfo.currentCell.ordinal;)i[t+n]=i[t],t--},n.prototype.frameColumnHeader=function(n){var r,e,tt,o,ot,st,nt,ft,y;this.headerGrouping={};this.lastLevel=[];for(var t=0,h=[],c=[],l=[],k=-1,d=-1,ht=this.customArgs.drillInfo&&"column"===this.customArgs.drillInfo.axis?this.customArgs.drillInfo.currentCell.ordinal+1:0;t<n.length;)r=n[t].querySelectorAll("Member"),h=this.frameTupCollection(r,h,t+ht,this.tupColumnInfo,this.showColumnSubTotals,this.hideColumnTotalsObject,"column"),t++;if(n.length>0)for(r=n[0].querySelectorAll("Member"),e=0;e<r.length;)l[e]="1"===r[e].querySelector("MEMBER_TYPE").textContent&&0===Number(r[e].querySelector("LNum").textContent)?0:Number(r[e].querySelector("LNum").textContent),"1"!==r[e].querySelector("MEMBER_TYPE").textContent||!this.isPaging&&0!==Number(r[e].querySelector("LNum").textContent)?c[e]=1:(c[e]=0,k=-1===k?e:k,d=e),e++;tt=this;h.map(function(n,t){tt.colDepth=tt.colDepth+(0===c[t]?n+(1-(l[t]>1?1:l[t])):0===n?1:n)});t=0;for(var it,u=1,i={},v=!0,w=!1;t<n.length;){r=n[t].querySelectorAll("Member");var f=this.tupColumnInfo[t].allCount,s=this.tupColumnInfo[t].allStartPos,ct=this.tupColumnInfo[t].measure,rt=this.tupColumnInfo[t].typeCollection,p=this.tupColumnInfo[t].drillInfo,a=this.tupColumnInfo[t].drillStartPos,g=this.tupColumnInfo[t].startDrillUniquename,ut=this.tupColumnInfo[t].endDrillUniquename,lt=this.tupColumnInfo[t].drillEndPos,et=this.tupColumnInfo[t].levelCollection,b="2"!==rt[0]&&("3"!==rt[0]||"2"!==rt[1]);(0===t&&r.length>f+(ct?1:0)&&(w=!0,b=f>0&&b?s>k:b),b&&0===f)&&(o=[-1,-1,-1],this.tupColumnInfo[t-1]&&0===this.tupColumnInfo[t-1].allCount?o=this.levelCompare(et,this.tupColumnInfo[t-1].levelCollection):w&&it&&(o=this.levelCompare(et,it.levelCollection)),this.tupColumnInfo[t].drillStartPos<0?(!v&&o[0]>-1&&o[2]>-1&&(u=this.mergeTotCollection(u,f,h,l,c,s,p,o)),this.setParentCollection(r),this.frameCommonColumnLoop(r,t,u,h,c,l),this.tupColumnInfo[t].showTotals||u--,!v&&o[0]>-1&&o[2]>-1&&(u=this.mergeTotCollection(u,f,h,l,c,s,p,o)),v=!1,u++):i.drillStartPos===a&&i.startDrillUniquename===g&&i.allCount!==f||(!v&&o[0]>-1&&o[2]>-1&&(u=this.mergeTotCollection(u,f,h,l,c,s,p,o),v=!0),this.setParentCollection(r),(!w||d<=a)&&(this.totalCollection[this.totalCollection.length]={allCount:f,ordinal:t,members:r,drillInfo:p},i.allCount=f,i.allStartPos=s,i.drillStartPos=a,i.startDrillUniquename=g,i.endDrillUniquename=ut)),it=this.tupColumnInfo[t]);f>0&&(!w||b&&d<s)&&(f===i.allCount||s!==i.allStartPos)&&(ot=lt===a||i.endDrillUniquename===ut,st=s!==i.allStartPos?i.startDrillUniquename!==g:ot,a>-1&&!st||(v||(u=this.mergeTotCollection(u,f,h,l,c,s,p),v=!0),this.setParentCollection(r),w&&a>-1&&!(d<=a)||(this.totalCollection[this.totalCollection.length]={allCount:f,ordinal:t,members:r,allStartPos:s,drillInfo:p},i.allCount=f,i.allStartPos=s,i.drillStartPos=a,i.startDrillUniquename=g,i.endDrillUniquename=ut)));t++}if(this.totalCollection.length>0)if(Object.keys(this.colMeasures).length>1)this.orderTotals(u,h,c,l);else for(this.totalCollection=this.totalCollection.reverse(),nt=0,ft=this.totalCollection;nt<ft.length;nt++)y=ft[nt],(0===this.tupColumnInfo[y.ordinal].measurePosition?1===this.tupColumnInfo[y.ordinal].allStartPos:0===this.tupColumnInfo[y.ordinal].allStartPos)&&(!this.dataSourceSettings.showGrandTotals||!this.dataSourceSettings.showColumnGrandTotals)||(this.frameCommonColumnLoop(y.members,y.ordinal,u,h,l,c),this.tupColumnInfo[y.ordinal].showTotals&&u++)},n.prototype.orderTotals=function(n,t,i,r){for(var u,e,v,s,h,l,f={},o=1,c=0,a=this.totalCollection;c<a.length;c++)u=a[c],(0===this.tupColumnInfo[u.ordinal].measurePosition?1===this.tupColumnInfo[u.ordinal].allStartPos:0===this.tupColumnInfo[u.ordinal].allStartPos)&&(!this.dataSourceSettings.showGrandTotals||!this.dataSourceSettings.showColumnGrandTotals)||(e=this.tupColumnInfo[u.ordinal].measure.querySelector("UName").textContent,f[e]?(f[e].coll.push(u),f[e].count++,o=o<f[e].count?f[e].count:o):f[e]={coll:[u],count:1});for(v=Object.keys(f),s=o-1;s>-1;){for(h=0,l=v;h<l.length;h++)(u=f[l[h]].coll[s])&&(this.frameCommonColumnLoop(u.members,u.ordinal,n,t,i,r),this.tupColumnInfo[u.ordinal].showTotals&&n++);s--}},n.prototype.setParentCollection=function(n){for(var o,u,t=0;n.length>t;){var i=n[t],s=Number(i.querySelector("MEMBER_TYPE").textContent)>2?"3":i.querySelector("MEMBER_TYPE").textContent,r=Number(i.querySelector("LNum").textContent),h=i.querySelector("UName").textContent,c=i.querySelector("PARENT_UNIQUE_NAME")?i.querySelector("PARENT_UNIQUE_NAME").textContent:"",f=!0,e=!1;this.parentObjCollection[t]&&(o=Object.keys(this.parentObjCollection[t]),u=this.parentObjCollection[t][r-1],f=u?c===u.querySelector("UName").textContent:0===o.length,e="1"===this.tupColumnInfo[0].typeCollection[t]);"2"===s?delete this.parentObjCollection[t]:(!this.isPaging&&!e||f||delete this.parentObjCollection[t],this.parentObjCollection[t]?this.parentObjCollection[t][r]&&this.parentObjCollection[t][r].querySelector("UName").textContent===h||(this.parentObjCollection[t][r]=i):(this.parentObjCollection[t]={},this.parentObjCollection[t][r]=i));t++}},n.prototype.setDrillInfo=function(n,t,i,r,u){for(r--;u[r]&&u[r].drillInfo[i].uName===n;){if(u[r].uNameCollection.split(/~~|::\[/).map(function(n){return"["===n[0]?n:"["+n}).join("~~").indexOf(t)<0)break;u[r].drillInfo[i].isDrilled=!0;this.curDrillEndPos<=i&&(u[r].drillEndPos=this.curDrillEndPos=i,u[r].endDrillUniquename=n);(u[r].drillStartPos>i||-1===u[r].drillStartPos)&&(u[r].drillStartPos=i);u[r].startDrillUniquename=n;r--}},n.prototype.levelCompare=function(n,t){for(var r=[-1,0],i=0;i<t.length;i++)if(n[i]!==t[i]){r=[i,n[i],t[i]-n[i]];break}return r},n.prototype.mergeTotCollection=function(n,t,i,u,f,e,o,s){for(var h,a,tt,p,w,k,l,v=Object(r.isNullOrUndefined)(e)?s[0]:e-(this.colMeasurePos===e-1?2:1),d=o[v]&&o[v].level,it=this.getLevelsAsString(v-1,o),c={},y=1,g=!1,b=0,nt=this.totalCollection;b<nt.length;b++)h=nt[b],(g||h.allCount<=t&&(!(d>-1&&h.drillInfo[v])||h.drillInfo[v].level>=d&&this.getLevelsAsString(v-1,h.drillInfo)===it))&&(a=this.tupColumnInfo[h.ordinal].measure?this.tupColumnInfo[h.ordinal].measure.querySelector("UName").textContent:"measure",c[a]?(c[a].coll.push(h),c[a].count++,y=y<c[a].count?c[a].count:y):c[a]={coll:[h],count:1},g=!1);for(tt=Object.keys(c),p=y-1;p>-1;){for(w=0,k=tt;w<k.length;w++)l=c[k[w]].coll[p],l&&((0===this.tupColumnInfo[l.ordinal].measurePosition?1===this.tupColumnInfo[l.ordinal].allStartPos:0===this.tupColumnInfo[l.ordinal].allStartPos)&&(!this.dataSourceSettings.showGrandTotals||!this.dataSourceSettings.showColumnGrandTotals)||(this.frameCommonColumnLoop(l.members,l.ordinal,n,i,f,u),this.tupColumnInfo[l.ordinal].showTotals&&n++),this.totalCollection.pop());p--}return n},n.prototype.getLevelsAsString=function(n,t){for(var r=[],i=0;i<n;i++)r[i]=t[i].level;return r.length>0?r.toString():""},n.prototype.frameCommonColumnLoop=function(n,t,i,r,u,f){var v,y=-1,e,c,p,w,d;if(this.tupColumnInfo[t].showTotals)for(e=0,c=0;e<n.length;)c+=f[e]>0&&this.tupColumnInfo[t].measurePosition!==e?r[e]:r[e]+(1-u[e]),this.tupColumnInfo[t].drillInfo[e].isDrilled&&this.tupColumnInfo[t].showTotals&&(this.tupColumnInfo[t].showTotals=!!this.showColumnSubTotals&&void 0===this.hideColumnTotalsObject[this.tupColumnInfo[t].drillInfo[e].hierarchy],c-=r[e]-this.tupColumnInfo[t].levelCollection[e],y=this.tupColumnInfo[t].showTotals?-1:c-1),e++;if(this.tupColumnInfo[t].showTotals)for(var o=0,h=0,b={};o<n.length;){for(var s=n[o],a=Number(s.querySelector("MEMBER_TYPE").textContent)>2?"3":s.querySelector("MEMBER_TYPE").textContent,k=0,l="2"!==a?f[o]?1:u[o]:1;l<=("3"===a?1:r[o]);l++)p=!1,this.pivotValues[h]||(this.pivotValues[h]=[]),Number(n[o].querySelector("LNum").textContent)>l&&"2"!==a?(this.parentObjCollection[o][l]||this.getDrilledParent(n[o],l,this.parentObjCollection[o]),this.parentObjCollection[o][l]&&(s=this.parentObjCollection[o][l]),p=!0):(s=n[o],k++),"2"!==a&&(b[s.querySelector("UName").textContent]=s.querySelector("Caption").textContent),w=Object.values(b).join("."),d=!!this.namedSetsPosition.column[o],this.pivotValues[h][i]={axis:"column",actualText:this.getUniqueName(s.querySelector("UName").textContent),colIndex:i,formattedText:s.querySelector("Caption").textContent,hasChild:Number(s.querySelector("CHILDREN_CARDINALITY").textContent)>0,level:k>1?-1:Number(s.querySelector("LNum").textContent)-(f[o]&&"3"!==a?1:0),rowIndex:h,ordinal:t,memberType:Number(a),isDrilled:p||this.tupColumnInfo[t].drillInfo[o].isDrilled,parentUniqueName:s.querySelector("PARENT_UNIQUE_NAME")?s.querySelector("PARENT_UNIQUE_NAME").textContent:void 0,levelUniqueName:s.querySelector("LName").textContent,hierarchy:s.getAttribute("Hierarchy"),isNamedSet:d,valueSort:(v={levelName:w},v[w]=1,v.axis=s.getAttribute("Hierarchy"),v)},this.headerContent[h]||(this.headerContent[h]={}),this.headerContent[h][i]=this.pivotValues[h][i],h++;o++}else if(y>-1)this.pivotValues[y][i-1].ordinal=t;else if(this.tupColumnInfo[t].allCount>0){for(e=0,c=0;e<this.tupColumnInfo[t].allStartPos;)c+=f[e]>0&&this.tupColumnInfo[t].measurePosition!==e?r[e]:r[e]+(1-u[e]),e++;c-=this.tupColumnInfo[t].allStartPos===this.tupColumnInfo[t].measurePosition+1?r[this.tupColumnInfo[t].allStartPos-2]-this.tupColumnInfo[t].levelCollection[this.tupColumnInfo[t].allStartPos-2]+1:r[this.tupColumnInfo[t].allStartPos-1]-this.tupColumnInfo[t].levelCollection[this.tupColumnInfo[t].allStartPos-1];this.pivotValues[c-1][i-1].ordinal=t}},n.prototype.getDrilledParent=function(n,t,i){for(var r,e=Number(n.querySelector("LNum").textContent),f=n,u=e-1;u>=t;u--){if(r=this.drilledSets[f.querySelector("PARENT_UNIQUE_NAME").textContent],!r)break;i[u]=r;f=r}},n.prototype.performRowSorting=function(){var at,rt,l,i,a,u,ot,tt,st,n,k,ht,ct,lt;if(this.enableSort&&this.tupRowInfo.length>0){for(var vt=this.pivotValues.length,d={},t={},it=[],w=!1,et=this.tupRowInfo[0].typeCollection.lastIndexOf("1"),o=this.colDepth;o<vt;o++){var s=this.pivotValues[o][0],g=this.tupRowInfo[s.ordinal],y=g?0===g.measurePosition&&3===s.memberType?g.measureName:g.uNameCollection:"";""!==y&&(et>-1&&(y=this.frameUniqueName(y,s,g)),rt=y.split(/~~|::\[/).length,3===s.memberType&&this.tupRowInfo[0].measurePosition>0?t[n=this.getParentUname(y,s,!0,!0)]?t[n].push(s):t[n]=[s]:d[rt]?d[rt][y]=[s]:d[rt]=((at={})[y]=[s],at));w&&it.push(s);"grand sum"===s.type&&(w=!0)}for(var ut=Object.keys(t).length>0&&this.tupRowInfo[0].measurePosition>0,v=Object.keys(d).map(function(n){return Number(n)}).sort(function(n,t){return n>t?1:t>n?-1:0}),p={},c=v.length-1;c>=0;c--){for(var h={},ft=d[v[c]],nt=Object.keys(ft),b=0;b<nt.length;b++)h[n=0===c?"parent":this.getParentUname(nt[b],ft[nt[b]][0],ut,!1)]?h[n].push(ft[nt[b]][0]):h[n]=ft[nt[b]];for(l=Object.keys(h),i=0;i<l.length;i++)h[l[i]]=this.sortRowHeaders(h[l[i]]);if(p[v[c+1]])for(i=0;i<l.length;i++){for(var f=[],e=h[l[i]],r=0;r<e.length;r++){if(a=this.tupRowInfo[e[r].ordinal],u=0===a.measurePosition&&3===e[r].memberType?a.measureName:a.uNameCollection,f.push(e[r]),et>-1&&(u=this.frameUniqueName(u,e[r],a)),ot=!1,ut&&t[n=this.getParentUname(u,e[r],ut,!0)]){t[n]=this.sortRowHeaders(t[n]);var yt=u.lastIndexOf("::[")===u.indexOf("::[Measures]"),pt=u.split("::[").length-1===a.measurePosition,wt=!a.drillInfo[a.measurePosition-1].isDrilled,bt=a.members.length>a.measurePosition+1;if(yt&&pt&&wt&&bt)for(ot=!0,tt=0;tt<t[n].length;tt++)f.push(t[n][tt]),st=u.substring(0,u.indexOf("::[Measures]"))+"::"+t[n][tt].actualText,p[v[c+1]][st]&&(f=f.concat(p[v[c+1]][st]));else f=f.concat(t[n])}!ot&&p[v[c+1]][u]&&(f=f.concat(p[v[c+1]][u]))}h[l[i]]=f}else if(ut)for(i=0;i<l.length;i++){for(e=h[l[i]],f=[],r=0;r<e.length;r++)f.push(e[r]),u=this.tupRowInfo[e[r].ordinal].uNameCollection,et>-1&&(u=this.frameUniqueName(u,e[r],this.tupRowInfo[e[r].ordinal])),t[n=this.getParentUname(u,e[r],!0,!0)]&&(t[n]=this.sortRowHeaders(t[n]),f=f.concat(t[n]));h[l[i]]=f}p[v[c]]=h}for(k=0,ht=0,w=!1,it=this.sortRowHeaders(it),o=this.colDepth;o<vt;o++)ct=w?it:p[v[0]].parent,lt=w?k-ht:k,ct[lt]&&(this.pivotValues[o]=[ct[lt]],this.pivotValues[o][0].rowIndex=o,this.valueContent[k][0]=this.pivotValues[o][0]),k++,"grand sum"===this.pivotValues[o][0].type&&(w=!0,ht=k)}},n.prototype.performColumnSorting=function(){var ut,t,l,v,ot,g,y,st,c,ft,ht,nt,et,tt,ct,p,lt,d,w,b,it,a,rt;if(this.enableSort)for(ut=0;ut<this.dataSourceSettings.columns.length;ut++){for(var f=[],n=0,e=[],s=0;s<this.pivotValues.length;s++){var i=this.pivotValues[s],h=void 0,k=void 0,u={},o=1;for(e[n]=[],f[n]=[],t=1,t=t;t<i.length;t++)if(!i[t].isNamedSet){if(2!=i[t].memberType&&"[Measures]"!=i[t].hierarchy&&-1!=i[t].level){if(Object(r.isNullOrUndefined)(u[i[t].formattedText])||Object(r.isNullOrUndefined)(this.pivotValues[s-1]))u[i[t].formattedText]=u[i[t].formattedText]?u[i[t].formattedText]:[],u[i[t].formattedText][i[t].colIndex]=i[t];else if(u[i[t].formattedText]&&this.pivotValues[s-1]){var at=this.pivotValues[s-1][i[t].colIndex],vt=Object.values(u[i[t].formattedText])[0].colIndex,yt=this.pivotValues[s-1][vt];if(at.formattedText!==yt.formattedText){for(l=Object.keys(u),l=this.sortColumnHeaders(l,this.sortObject[i[t-1].levelUniqueName]||this.sortObject[i[t].hierarchy]),Object(r.isNullOrUndefined)(f[n])?f[n]=[]:f[n],v=0;v<l.length;v++)for(ot=Object.keys(u[l[v]]).length,g=0;g<ot;g++)o=0===f[n].length?1:0,f[n][f[n].length+o]=u[l[v]][Number(Object.keys(u[l[v]])[g])];(u={})[i[t].formattedText]=[];u[i[t].formattedText][i[t].colIndex]=i[t]}else u[i[t].formattedText][i[t].colIndex]=i[t]}}else if(Object.keys(u).length>0)for(e[n][e[n].length+o]=i[t],h=Object.keys(u),h=this.sortColumnHeaders(h,this.sortObject[i[t-1].levelUniqueName]||this.sortObject[i[t].hierarchy]),Object(r.isNullOrUndefined)(f[n])?f[n]=[]:f[n],y=0;y<h.length;y++)for(st=Object.keys(u[h[y]]).length,c=0;c<st;c++)o=0===f[n].length?1:0,f[n][f[n].length+o]=u[h[y]][Number(Object.keys(u[h[y]])[c])];else(-1===i[t].level||0===i[t].level)&&Object.keys(u).length>=0&&"[Measures]"!=i[t].hierarchy&&(e[n][e[n].length+o]=i[t]);if(-1!=i[t].level&&1===Object.keys(u).length&&"[Measures]"!=i[t].hierarchy&&!Object(r.isNullOrUndefined)(i[t+1])&&-1===i[t+1].level)if(ft=Object.keys(u[i[t].formattedText]).length,ht=Object.keys(u[i[t].formattedText]),ft>1)for(nt=0;nt<ft;nt++)o=0===e[n].length?1:0,e[n][e[n].length+o]=u[i[t].formattedText][Number(ht[nt])];else e[n][e[n].length+o]=i[t];if(Object.keys(e[n]).length>0){if(o=0===f[n].length?1:0,et=e[n].length,et>2)for(tt=1;tt<et;tt++)o=0===f[n].length?1:0,f[n][f[n].length+o]=e[n][tt];else f[n][f[n].length+o]=e[n][1]||e[n][0];u={};e[n]=[]}}if(Object.keys(u).length>0)for(e[n][e[n].length+o]=i[t],k=Object.keys(u),ct=this.sortObject[i[t-1].levelUniqueName]||this.sortObject[i[t-1].hierarchy],h=this.sortColumnHeaders(k,ct),Object(r.isNullOrUndefined)(f[n])?f[n]=[]:f[n],p=0;p<k.length;p++)for(lt=Object.keys(u[k[p]]).length,c=0;c<lt;c++)o=0===f[n].length?1:0,f[n][f[n].length+o]=u[h[p]][Number(Object.keys(u[k[p]])[c])];for(d=1;d<f[n].length;d++)this.pivotValues[n][d]=f[n][d];for(w=s;w<this.pivotValues.length;w++)if(b=Object(r.extend)({},this.pivotValues[w+1],null,!0),it=Object(r.extend)({},this.pivotValues[w],null,!0),Object.keys(b).length===Object.keys(it).length&&Object.keys(b).length>2){for(a=1;a<this.pivotValues[s].length;a++)Object.keys(b).length>0&&it[a].colIndex!=b[a].colIndex&&(this.pivotValues[w+1][a]=b[it[a].colIndex]);break}n++;u={}}for(rt=0;rt<this.pivotValues.length;rt++)for(i=this.pivotValues[rt],s=1;s<i.length;s++)i[s].colIndex=s}},n.prototype.frameUniqueName=function(n,t,i){var r=n.indexOf(t.actualText.toString()+"::[Measures]")>-1,u=(n=n.substring(0,n.indexOf(t.actualText.toString()))+t.actualText.toString()).split("::[").length<=i.measurePosition;return n+(r||u?"::"+i.measureName:"")},n.prototype.sortRowHeaders=function(n){if(n.length>0&&3!==n[0].memberType&&!n[0].isNamedSet){var t=this.sortObject[n[0].hierarchy]||this.sortObject[n[0].levelUniqueName];"Ascending"===t||void 0===t?n.sort(function(n,t){return n.formattedText>t.formattedText?1:t.formattedText>n.formattedText?-1:0}):"Descending"===t&&n.sort(function(n,t){return n.formattedText<t.formattedText?1:t.formattedText<n.formattedText?-1:0})}return n},n.prototype.sortColumnHeaders=function(n,t){return"Ascending"===t||void 0===t?n.sort(function(n,t){return n>t?1:t>n?-1:0}):"Descending"===t&&n.sort(function(n,t){return n<t?1:t<n?-1:0}),n},n.prototype.frameSortObject=function(){if(this.enableSort)for(var n=0;n<this.sortSettings.length;n++)this.sortObject[this.sortSettings[n].name]=this.sortSettings[n].order},n.prototype.getParentUname=function(n,t,i,r){var o="",e;if(i&&!r){for(var s=this.tupRowInfo[t.ordinal],f=[],h={},u=0;u<n.length;u++)"~"!==n[u]&&":"!==n[u]||(f.push(u),h[u]=n[u]+n[u],u++);o=s.measurePosition>=n.split("::[").length-1?f[f.length-2]>-1?n.substring(0,f[f.length-2])+h[f[f.length-1]]+s.measureName:"parent":(e=n.lastIndexOf("~~")>n.lastIndexOf("::[")?n.lastIndexOf("~~"):n.lastIndexOf("::["))>-1?n.substring(0,e):"parent"}else o=(e=n.lastIndexOf("~~")>n.lastIndexOf("::[")?n.lastIndexOf("~~"):n.lastIndexOf("::["))>-1?n.substring(0,e):"parent";return o},n.prototype.performColumnSpanning=function(){for(var r,e,u={},t=this.rowStartPos-1,h=Object.keys(this.colMeasures).length;t>-1;){for(u[t]={},r=this.pivotValues[t].length-1;r>0;){u[t][r]=1;var f=this.pivotValues[t][r+1],i=this.pivotValues[t+1]&&this.rowStartPos-t>1?this.pivotValues[t+1][r]:void 0,n=this.pivotValues[t][r],c=!1,o=!1,s=this.tupColumnInfo[n.ordinal],l=s.allStartPos>("3"===s.typeCollection[0]?1:0);(i&&f&&(2===n.memberType||-1===n.level?f.actualText===n.actualText:3===n.memberType&&n.actualText===f.actualText||f.valueSort.levelName===n.valueSort.levelName)&&(2===n.memberType?n.colSpan=l&&"sum"!==f.type?1:f.colSpan+1>(s.measurePosition>t?h:0)?1:f.colSpan+1:(n.colSpan=f.colSpan+1,n.ordinal=f.ordinal),c=!0),2===n.memberType)?(l?(n.type="sum",n.formattedText="Total",n.valueSort.levelName=n.valueSort.levelName,n.valueSort[n.valueSort.levelName.toString()]=1):(e="Grand Total",i&&h>0&&(e=3===i.memberType?"Grand Total."+i.formattedText:i.valueSort.levelName),n.type="grand sum",n.formattedText="Grand Total",n.valueSort.levelName=e,n.valueSort[e.toString()]=1),n.hasChild=!1):-1===n.level&&(n.type="sum",n.formattedText="Total",n.hasChild=!1,n.valueSort.levelName=n.valueSort.levelName,n.valueSort[n.valueSort.levelName.toString()]=1);i?2===n.memberType&&2===i.memberType||i.actualText===n.actualText?(u[t][r]=u[t+1]?u[t+1][r]+1:1,0===t||1===n.memberType&&n.level>-1&&1===i.memberType&&-1===i.level?(n.rowSpan=n.isDrilled?1:u[t+1][r]+1,i.rowSpan=i.isDrilled&&-1===i.level?u[t+1][r]:i.rowSpan):n.rowSpan=3===n.memberType?1:-1,o=!0):n.isDrilled&&-1===n.level&&2===i.memberType?(u[t][r]=u[t+1]?u[t+1][r]+1:1,n.rowSpan=-1,o=!0):(n.rowSpan=0===t?u[t][r]:-1,i.rowSpan=i.level>-1&&!i.isDrilled||2!==n.memberType&&2===i.memberType?u[t+1][r]:1):n.rowSpan=n.level>-1||1===this.rowStartPos?u[t][r]:-1;c||(n.colSpan=1);o||(u[t][r]=1);r--}t--}},n.prototype.frameValues=function(n,t){var v=this.colDepth,w=this.pivotValues.length,b=0,l,y,i,o,e,u,g,nt;for("down"===this.customArgs.action&&(l=Object.keys(this.onDemandDrillEngine),v=Number(l[0]),w=Number(l[l.length-1])+1,b=this.onDemandDrillEngine[v][0].ordinal),y={},i=0;i<n.length;i++)y[Number(n[i].getAttribute("CellOrdinal"))]=n[i];for(o=v;o<w;o++)for(e=this.pivotValues[o],u=e[0].ordinal,i=1;i<this.pivotValues[0].length;i++){var f=this.pivotValues[this.colDepth-1][i].ordinal,p=this.pivotValues[this.colDepth-1][i],k=3===e[0].memberType?e[0].actualText.toString():this.tupColumnInfo[p.ordinal]&&this.tupColumnInfo[p.ordinal].measure?this.tupColumnInfo[p.ordinal].measure.querySelector("UName").textContent:e[0].actualText;if("header"===e[0].type)e[i]={axis:"value",actualText:this.getUniqueName(k),formattedText:"",value:0,colIndex:i,rowIndex:o};else{var h,s=void 0,c=void 0,d=this.getUniqueName(k),a=!0;a=this.tupRowInfo[u]?this.tupRowInfo[u].showTotals:this.dataSourceSettings.showGrandTotals&&this.dataSourceSettings.showRowGrandTotals;s=y[(u-b)*t+f];c=a?Object(r.isNullOrUndefined)(s)||Object(r.isNullOrUndefined)(s.querySelector("FmtValue"))?this.emptyCellTextContent:s.querySelector("FmtValue").textContent:"";h=a?Object(r.isNullOrUndefined)(s)||Object(r.isNullOrUndefined)(s.querySelector("Value"))?null:s.querySelector("Value").textContent:"0";c=a&&!Object(r.isNullOrUndefined)(h)?this.getFormattedValue(Number(h),d,""!==c?c:h):c;g=!this.tupColumnInfo[f]||this.tupColumnInfo[f].allCount>0||this.tupColumnInfo[f].drillStartPos>-1||!this.tupRowInfo[u]||this.tupRowInfo[u].allCount>0||this.tupRowInfo[u].drillStartPos>-1;nt=!!this.tupRowInfo[u]&&(0===this.tupRowInfo[u].measurePosition?1===this.tupRowInfo[u].allStartPos:0===this.tupRowInfo[u].allStartPos)||!!this.tupColumnInfo[f]&&(0===this.tupColumnInfo[f].measurePosition?1===this.tupColumnInfo[f].allStartPos:0===this.tupColumnInfo[f].allStartPos);e[i]={axis:"value",actualText:d,formattedText:c,colOrdinal:f,rowOrdinal:u,columnHeaders:this.tupColumnInfo[f]?this.tupColumnInfo[f].captionCollection:"",rowHeaders:this.tupRowInfo[u]?this.tupRowInfo[u].captionCollection:"",value:Object(r.isNullOrUndefined)(h)?null:Number(h),colIndex:i,rowIndex:o,isSum:g,isGrandSum:nt}}this.valueContent[o-this.rowStartPos][i]=e[i]}},n.prototype.getFormattedValue=function(n,t,i){var f=i,e,u,o;return this.formatFields[t]&&!Object(r.isNullOrUndefined)(n)&&(e=this.formatFields[t].properties?this.formatFields[t].properties:this.formatFields[t],u=Object(r.extend)({},e,null,!0),(delete u.name,!u.minimumSignificantDigits&&u.minimumSignificantDigits<1&&delete u.minimumSignificantDigits,!u.maximumSignificantDigits&&u.maximumSignificantDigits<1&&delete u.maximumSignificantDigits,u.type)?f=this.globalize.formatDate(new Date(n.toString()),u):((delete u.type,u.format&&!this.formatRegex.test(u.format))&&(o=u.format.match(this.customRegex)[6],u.useGrouping=-1!==o.indexOf(",")),f=this.globalize.formatNumber(n,u))),f},n.prototype.getMeasureInfo=function(){for(var u,i,t="column",r=[],f=0,s=this.values;f<s.length;f++)u=s[f],r[r.length]=u.isCalculatedField?this.fieldList[u.name].tag:u.name;if(r.length>1){if(this.isMeasureAvail){for(var e=!1,n=0,o=this.rows.length;n<o;n++)if("[measures]"===this.rows[n].name.toLowerCase()){t="row";i=n;e=!0;break}if(!e)for(n=0,o=this.columns.length;n<o;n++)if("[measures]"===this.columns[n].name.toLowerCase()){t="column";i=n;e=!0;break}}else i="row"===(t=this.valueAxis)?this.rows.length-1:this.columns.length-1;return{measureAxis:t,measureIndex:i,valueInfo:r}}return{measureAxis:t,measureIndex:-1,valueInfo:[]}},n.prototype.frameMeasureOrder=function(n,t,i,r,u){var y=[],d=[],h=[],p={},ft=[],pt=n.measureAxis,w=n.measureIndex,et=n.valueInfo,g,ot,nt,ht,tt,ct,rt,yt,ut;if(pt===t&&et.length>0){for(var c={},b=[],f=0,ni=i.length;f<ni;f++){for(var wt=i[f],bt=[].slice.call(wt.querySelectorAll("Member")),o="",l="",e=0;e<bt.length;)o=o+(""!==o?"~~":"")+bt[e].querySelector("UName").textContent,(e===w&&0===w||e===w-1)&&(l=o),e++;c[l]?c[l][c[l].length]=o:(c[l]=[o],b[b.length]=l);p[o]={index:f,node:wt};ft[ft.length]=o}if(ft.length>0&&b.length>0)if(0===w){for(g=0,ot=et;g<ot.length;g++)for(var ti=ot[g],st=0,kt=b;st<kt.length;st++)if((lt=kt[st])===ti)for(nt=0,ht=c[lt];nt<ht.length;nt++)o=ht[nt],h[h.length]=p[o].index,y[y.length]=p[o].node}else for(tt=0,ct=b;tt<ct.length;tt++)for(var lt=ct[tt],at=0,dt=et;at<dt.length;at++)for(var ii=dt[at],vt=0,gt=c[lt];vt<gt.length;vt++)(o=gt[vt]).split("~~")[w]===ii&&(h[h.length]=p[o].index,y[y.length]=p[o].node);if(r.length>0){for(var s=[],it=[],a=0,v=0,k=(f=0,r.length);f<k;f++)a>u-1?(a=0,s[++v]||(s[v]=[]),s[v][a]=f,a++):(s[v]||(s[v]=[]),s[v][a]=f,a++),it[it.length]=Number(r[f].getAttribute("CellOrdinal"));if("column"===pt){if(s.length>0&&s[0].length===h.length)for(e=0,k=h.length;e<k;e++)for(f=0;f<s.length;)rt=it[yt=f*u+e].toString(),(ut=r[Number(s[f][h[e]])]).setAttribute("CellOrdinal",rt.toString()),d[yt]=ut,f++}else if(s.length===h.length)for(e=0,k=h.length;e<k;e++)for(f=0;f<s[h[e]].length;)rt=it[yt=e*u+f].toString(),(ut=r[Number(s[h[e]][f])]).setAttribute("CellOrdinal",rt.toString()),d[d.length]=ut,f++}return{orderedHeaderTuples:y,orderedValueTuples:d}}return{orderedHeaderTuples:i,orderedValueTuples:r}},n.prototype.getDrilledSets=function(n,t,i,u){for(var v,l,f,nt,y,o,rt,p=[],ut=t.actualText.toString(),e="row"===u?this.tupRowInfo:this.tupColumnInfo,ct=e[t.ordinal],lt=0===e[0].typeCollection.indexOf("3")?1:0,h=0,at="1"===e[0].typeCollection[i];h<e.length;)(Object(r.isNullOrUndefined)(e[h].allStartPos)||e[h].allStartPos>lt)&&(p[p.length]=e[h].uNameCollection),h++;for(var w=n.split("::[").map(function(n){return"["===n[0]?n:"["+n}),c=[],s=0;s<=i;s++)if((at||this.isPaging)&&s===i){for(var ft=w[s].split("~~"),vt=ft.indexOf(ut),b=[],k=0;k<=vt;k++)b.push(ft[k]);c[c.length]=b.length>0?b.join("~~"):w[s]}else c[c.length]=w[s];n=c.join("::");for(var d=[],et={},g=0,ot=p;g<ot.length;g++)if(v=ot[g],0===v.indexOf(n)&&(d.push(v),this.isPaging))for(l=v.split("::[")[i],f=(o=(l="["===l[0]?l:"["+l).split("~~")).indexOf(ut);f<o.length;f++)et[o[f]]=o[f];if(this.isPaging){for(nt=ct.uNameCollection.split("::[").map(function(n){return"["===n[0]?n:"["+n}),y=[],f=0;f<nt.length;f++)f!==i&&(y[f]=nt[f]);for(o=Object.keys(et),f=0;f<o.length;f++)y[i]=o[f],d.push(y.join("::"))}for(var st={},tt=0,ht=d;tt<ht.length;tt++){for(var yt=ht[tt].split("::[").map(function(n){return"["===n[0]?n:"["+n}),a="",it=0;it<=i;it++)rt=yt[it].split("~~"),a=a+(""!==a?"~~":"")+rt[rt.length-1];st[a]=a}return st},n.prototype.updateDrilledInfo=function(n){this.dataSourceSettings=n;this.drilledMembers=n.drilledMembers?this.updateDrilledItems(n.drilledMembers):[];this.generateGridData(n)},n.prototype.updateCalcFields=function(n,t){this.dataSourceSettings=n;this.calculatedFieldSettings=n.calculatedFieldSettings?n.calculatedFieldSettings:[];this.getAxisFields();this.updateFieldlist();this.loadCalculatedMemberElements(this.calculatedFieldSettings);this.dataFields[t.name]?this.generateGridData(n):dt.getCellSets(n,this,!0,void 0,!0)},n.prototype.onSort=function(n){this.dataSourceSettings=n;this.sortSettings=n.sortSettings?n.sortSettings:[];this.getAxisFields();this.frameSortObject();this.updateFieldlist();this.xmlaCellSet.length>0&&this.xmlDoc?this.generateEngine(this.xmlDoc,this.request,this.customArgs):this.generateGridData(n)},n.prototype.updateFieldlist=function(n){for(var t,u,e,r,f,s,i=0;i<this.savedFieldListData.length;){if(t=this.savedFieldListData[i].id,u=this.savedFieldListData[i].pid,this.savedFieldList[t]&&(e=this.enableSort?this.sortObject[t]?this.sortObject[t]:"Ascending":"None",this.savedFieldList[t].isSelected=!1,this.savedFieldList[t].isExcelFilter=!1,this.savedFieldList[t].sort=e,this.savedFieldList[t].allowDragAndDrop=!0,this.savedFieldList[t].showFilterIcon=!0,this.savedFieldList[t].showSortIcon=!0,this.savedFieldList[t].showEditIcon=!0,this.savedFieldList[t].showRemoveIcon=!0,this.savedFieldList[t].showValueTypeIcon=!0,this.savedFieldListData[i].sort=e,this.savedFieldListData[i].allowDragAndDrop=!0,this.savedFieldListData[i].showFilterIcon=!0,this.savedFieldListData[i].showSortIcon=!0,this.savedFieldListData[i].showEditIcon=!0,this.savedFieldListData[i].showRemoveIcon=!0,this.savedFieldListData[i].showValueTypeIcon=!0,n&&(this.savedFieldList[t].filter=[],this.savedFieldList[t].actualFilter=[])),this.dataFields[t]&&this.savedFieldList[t]&&this.selectedItems.indexOf(t)>-1?(this.savedFieldList[t].isSelected=!0,this.savedFieldList[t].allowDragAndDrop=!this.dataFields[t]||this.dataFields[t].allowDragAndDrop,this.savedFieldList[t].showFilterIcon=!this.dataFields[t]||this.dataFields[t].showFilterIcon,this.savedFieldList[t].showSortIcon=!this.dataFields[t]||this.dataFields[t].showSortIcon,this.savedFieldList[t].showEditIcon=!this.dataFields[t]||this.dataFields[t].showEditIcon,this.savedFieldList[t].showRemoveIcon=!this.dataFields[t]||this.dataFields[t].showRemoveIcon,this.savedFieldList[t].showValueTypeIcon=!this.dataFields[t]||this.dataFields[t].showValueTypeIcon,this.savedFieldListData[i].isSelected=!0,this.savedFieldListData[i].allowDragAndDrop=!this.dataFields[t]||this.dataFields[t].allowDragAndDrop,this.savedFieldListData[i].showFilterIcon=!this.dataFields[t]||this.dataFields[t].showFilterIcon,this.savedFieldListData[i].showSortIcon=!this.dataFields[t]||this.dataFields[t].showSortIcon,this.savedFieldListData[i].showEditIcon=!this.dataFields[t]||this.dataFields[t].showEditIcon,this.savedFieldListData[i].showRemoveIcon=!this.dataFields[t]||this.dataFields[t].showRemoveIcon,this.savedFieldListData[i].showValueTypeIcon=!this.dataFields[t]||this.dataFields[t].showValueTypeIcon):this.savedFieldListData[i].isSelected=this.dataFields[u]&&this.savedFieldList[u]&&this.selectedItems.indexOf(u)>-1?!0:!1,this.savedFieldList[t]&&this.savedFieldList[t].isCalculatedField||"[calculated members].[_0]"===t.toLowerCase()){for(var h=!1,o=0,c=this.calculatedFieldSettings;o<c.length;o++)r=c[o],t===r.name&&(f=r.formula,s=r.formatString,this.savedFieldListData[i].formula=f,this.savedFieldListData[i].formatString=s,this.savedFieldListData[i].parentHierarchy=f.toLowerCase().indexOf("measure")>-1?void 0:r.hierarchyUniqueName,this.savedFieldList[t].formula=f,this.savedFieldList[t].formatString=s,this.savedFieldList[t].parentHierarchy=this.savedFieldListData[i].parentHierarchy,h=!0);h&&("[calculated members].[_0]"!==t.toLowerCase()||0!==this.calculatedFieldSettings.length)||(this.savedFieldListData.splice(i,1),i--,this.savedFieldList[t]&&delete this.savedFieldList[t])}i++}this.fieldList=this.savedFieldList;this.fieldListData=this.savedFieldListData},n.prototype.updateFieldlistData=function(n,t){for(var u,i=0,r=this.fieldListData;i<r.length;i++)if(u=r[i],u.id===n){u.isSelected=!!t;break}},n.prototype.getFormattedFields=function(n){this.formatFields={};for(var t=n.length;t--;)this.formatFields[n[t].name]=n[t]},n.prototype.getFieldList=function(n){var t={catalog:n.catalog,cube:n.cube,url:n.url,LCID:n.localeIdentifier.toString(),request:"MDSCHEMA_HIERARCHIES"};this.getTreeData(t,this.getFieldListItems.bind(this),{dataSourceSettings:n,action:"loadFieldElements"})},n.prototype.getTreeData=function(n,t,i){var r=this.getConnectionInfo(n.url,n.LCID),u='<Envelope xmlns="http://schemas.xmlsoap.org/soap/envelope/"><Header/><Body><Discover xmlns="urn:schemas-microsoft-com:xml-analysis"><RequestType>'+n.request+"<\/RequestType><Restrictions><RestrictionList><CATALOG_NAME>"+n.catalog+"<\/CATALOG_NAME><CUBE_NAME>"+n.cube+"<\/CUBE_NAME><\/RestrictionList><\/Restrictions><Properties><PropertyList><Catalog>"+n.catalog+"<\/Catalog> <LocaleIdentifier>"+r.LCID+"<\/LocaleIdentifier><\/PropertyList><\/Properties><\/Discover><\/Body><\/Envelope>";this.doAjaxPost("POST",r.url,u,t,i)},n.prototype.getAxisFields=function(){var n,t,i;for(this.rows=this.dataSourceSettings.rows?this.dataSourceSettings.rows:[],this.columns=this.dataSourceSettings.columns?this.dataSourceSettings.columns:[],this.filters=this.dataSourceSettings.filters?this.dataSourceSettings.filters:[],this.values=this.dataSourceSettings.values?this.dataSourceSettings.values:[],n=Object(r.extend)([],this.rows,null,!0),t=(n=n.concat(this.columns,this.values,this.filters)).length;t--;)this.dataFields[n[t].name]=n[t],"[measures]"===n[t].name.toLowerCase()?this.isMeasureAvail=!0:this.selectedItems.push(n[t].name);!this.isMeasureAvail&&this.values.length>0&&(i={name:"[Measures]",caption:"Measures",showRemoveIcon:!0,allowDragAndDrop:!0},"row"===this.valueAxis?this.rows.push(i):this.columns.push(i),this.isMeasureAvail=!0)},n.prototype.getAggregateType=function(n,t){var i;switch(t){case"1":i="Sum";break;case"2":i="Count";break;case"3":i="Min";break;case"4":i="Max";break;case"5":i="Avg";break;case"8":i="DistinctCount";break;case"127":i="CalculatedField";break;default:i=void 0}return i||void 0},n.prototype.getUniqueName=function(n){for(var t,r=n,i=0,u=this.calculatedFieldSettings;i<u.length;i++)if(t=u[i],n===(t.formula.toLowerCase().indexOf("measure")>-1?"[Measures].":t.hierarchyUniqueName+".")+"["+t.name+"]"){r=t.name;break}return r},n.prototype.updateFilterItems=function(n){var c=Object(r.extend)([],this.rows,null,!0),f,l,t,u,a,v,o,g,p,s,h,b,i;for(c=c.concat(this.columns),f=0,l=n;f<l.length;f++)if(t=l[f],"Include"===t.type&&this.allowMemberFilter){if(u=this.fieldList[t.name].members,a=u&&Object.keys(u).length>0,this.fieldList[t.name].actualFilter=t.items.slice(),v=Object(r.extend)([],t.items,null,!0),a)for(o=0;o<v.length;){for(var k=[],y=0,d=k=this.getParentNode(v[o],u,k);y<d.length;y++)g=d[y],p=e.inArray(g,t.items),-1!==p&&t.items.splice(p,1);o++}for(var nt=[],w=0,tt=t.items;w<tt.length;w++)s=tt[w],nt.push(s),a?this.fieldList[t.name].filter.push(u[s].caption):this.fieldList[t.name].filter.push(s);this.filterMembers[t.name]=nt;this.fieldList[t.name].isExcelFilter=!1}else if((this.allowValueFilter||this.allowLabelFilter)&&-1!==["Date","Label","Number","Value"].indexOf(t.type))for(h=0,b=c;h<b.length;h++)if(b[h].name===t.name){i=this.filterMembers[t.name];i&&"object"==typeof i[0]&&i[0].type===t.type?i[i.length]=t:this.filterMembers[t.name]=[t];this.fieldList[t.name].isExcelFilter=!0;break}},n.prototype.getParentNode=function(n,t,i){if(t[n].parent&&n!==t[n].parent){var r=t[n].parent;i.push(r);this.getParentNode(r,t,i)}return i},n.prototype.updateDrilledItems=function(n){var e=[],i=Object(r.extend)([],this.rows,null,!0),t,u,h;for(i=i.concat(this.columns),t=0,u=n;t<u.length;t++)for(var o=u[t],f=0,s=i;f<s.length;f++)if(h=s[f],o.name===h.name){e.push(o);break}return e},n.prototype.getDrillThroughData=function(n,t){for(var o,s,h,f=this.tupColumnInfo[n.colOrdinal]&&this.tupColumnInfo[n.colOrdinal].uNameCollection&&""!==this.tupColumnInfo[n.colOrdinal].uNameCollection?this.tupColumnInfo[n.colOrdinal].uNameCollection.split("::[").map(function(n){return"["===n[0]?n:"["+n}):[],e=this.tupRowInfo[n.rowOrdinal]&&this.tupRowInfo[n.rowOrdinal].uNameCollection&&""!==this.tupRowInfo[n.rowOrdinal].uNameCollection?this.tupRowInfo[n.rowOrdinal].uNameCollection.split("::[").map(function(n){return"["===n[0]?n:"["+n}):[],r="",u="",i=0;i<f.length;i++)r=(r.length>0?r+",":"")+(f[i].split("~~").length>1?f[i].split("~~")[f[i].split("~~").length-1]:f[i]);for(i=0;i<e.length;i++)u=(u.length>0?u+",":"")+(e[i].split("~~").length>1?e[i].split("~~")[e[i].split("~~").length-1]:e[i]);o="DRILLTHROUGH MAXROWS "+t+" Select("+(r.length>0?r:"")+(r.length>0&&u.length>0?",":"")+(u.length>0?u:"")+") on 0 from ["+this.dataSourceSettings.cube+"]";o=o.replace(/&/g,"&amp;");s=this.getSoapMsg(this.dataSourceSettings,o);h=this.getConnectionInfo(this.dataSourceSettings.url,this.dataSourceSettings.localeIdentifier);this.doAjaxPost("POST",h.url,s,this.drillThroughSuccess.bind(this),{dataSourceSettings:this.dataSourceSettings,action:"drillThrough"})},n.prototype.drillThroughSuccess=function(n){var o=[].slice.call(n.querySelectorAll("row")),u="",t,i,e,f,h,r,s;if(o.length>0){for(t=[],i=0;i<o.length;){for(e=[].slice.call(o[i].children),f=0;f<e.length;)t.push('"'+e[f].tagName+'":"'+e[f].textContent+'"'),f++;i++}for(h=t[0],r=0;r<t.length;)Object.keys(JSON.parse("[{"+t[r]+"}]")[0])[0]!==Object.keys(JSON.parse("[{"+h+"}]")[0])[0]?(u+=","+t[r],r++):(u+=""===u?"[{"+t[r]:"}, {"+t[r],r++);u+="}]"}else for(s=[].slice.call(n.querySelectorAll("faultstring")),i=0;i<s.length;)u+=s[i].textContent,i++;this.gridJSON=u},n.prototype.getFilterMembers=function(n,t,i,r,u){var e,f=this.fieldList[t].levels,o=this.fieldList[t].levelCount;return e=u?"Descendants({"+f[o].id+"}, "+f[i-1].id+", "+(i-o==1?"SELF)":"SELF_AND_BEFORE)"):t+", Descendants({"+f[0].id+"}, "+f[i-1].id+", SELF_AND_BEFORE)",this.fieldList[t].levelCount=i,r||this.getMembers(n,t,!1,e,u),e},n.prototype.getMembers=function(n,t,i,r,u){var e,o="DIMENSION PROPERTIES PARENT_UNIQUE_NAME, HIERARCHY_UNIQUE_NAME, CHILDREN_CARDINALITY, MEMBER_TYPE, MEMBER_VALUE",s=this.fieldList[t].hasAllMember,f=(s?t:t+".LEVELS(0)").replace(/\&/g,"&amp;"),h,c;e=i?"SELECT ({"+f+".ALLMEMBERS})"+o+" ON 0 FROM ["+n.cube+"]":"SELECT ({"+(r||(s?f+", "+f+".CHILDREN":f+".ALLMEMBERS"))+"})"+o+" ON 0 FROM ["+n.cube+"]";h=this.getSoapMsg(n,e);c=this.getConnectionInfo(n.url,n.localeIdentifier);u||(this.fieldList[t].filterMembers=[],this.fieldList[t].childMembers=[],this.fieldList[t].searchMembers=[],this.fieldList[t].members={},this.fieldList[t].currrentMembers={});this.doAjaxPost("POST",c.url,h,this.generateMembers.bind(this),{dataSourceSettings:n,fieldName:t,loadLevelMembers:u,action:"fetchMembers"})},n.prototype.getChildMembers=function(n,t,i){var r="SELECT ({"+t.replace(/\&/g,"&amp;")+".CHILDREN})DIMENSION PROPERTIES PARENT_UNIQUE_NAME, HIERARCHY_UNIQUE_NAME, CHILDREN_CARDINALITY, MEMBER_TYPE, MEMBER_VALUE ON 0 FROM ["+n.cube+"]",u=this.getSoapMsg(n,r),f=this.getConnectionInfo(n.url,n.localeIdentifier);this.doAjaxPost("POST",f.url,u,this.generateMembers.bind(this),{dataSourceSettings:n,fieldName:i,action:"fetchChildMembers"})},n.prototype.getCalcChildMembers=function(n,t){this.calcChildMembers=[];var i="SELECT ({"+t.replace(/\&/g,"&amp;")+".MEMBERS})DIMENSION PROPERTIES PARENT_UNIQUE_NAME, HIERARCHY_UNIQUE_NAME, CHILDREN_CARDINALITY, MEMBER_TYPE, MEMBER_VALUE ON 0 FROM ["+n.cube+"]",r=this.getConnectionInfo(n.url,n.localeIdentifier),u=this.getSoapMsg(n,i);this.doAjaxPost("POST",r.url,u,this.generateMembers.bind(this),{dataSourceSettings:n,action:"fetchCalcChildMembers"})},n.prototype.getSearchMembers=function(n,t,i,r,u,f){if(this.fieldList[t].searchMembers=[],this.fieldList[t].currrentMembers={},""!==i){var e=t.replace(/\&/g,"&amp;"),o="WITH SET [SearchMembersSet] AS &#39;FILTER("+(u?e+".ALLMEMBERS, ":"{"+(f>1?this.getFilterMembers(n,t,f,!0):e+", "+e+".CHILDREN")+"},")+"(INSTR(1, "+e+'.CurrentMember.member_caption, "'+i+'") > 0))&#39;SET [SearchParentsSet] AS &#39;GENERATE([SearchMembersSet], ASCENDANTS([SearchMembersSet].Current))&#39;SET [SearchSet] AS &#39;HIERARCHIZE(DISTINCT({[SearchMembersSet], [SearchParentsSet]}))&#39;SELECT SUBSET([SearchSet], 0, '+r+")DIMENSION PROPERTIES PARENT_UNIQUE_NAME, HIERARCHY_UNIQUE_NAME, CHILDREN_CARDINALITY, MEMBER_TYPE, MEMBER_VALUE ON 0 FROM ["+n.cube+"]",s=this.getSoapMsg(n,o),h=this.getConnectionInfo(n.url,n.localeIdentifier);this.doAjaxPost("POST",h.url,s,this.generateMembers.bind(this),{dataSourceSettings:n,fieldName:t,action:"fetchSearchMembers"})}},n.prototype.generateMembers=function(n,t,i){for(var p,v,w=[].slice.call(n.querySelectorAll('Axis[name="Axis0"] Tuple')),u=i.fieldName,f={},l=0,y=w;l<y.length;l++){var o=y[l],h=o.querySelector("Member"),c=h.querySelector("MEMBER_TYPE").textContent,r=h.querySelector("UName").textContent,e=h.querySelector("Caption").textContent,a={"data-fieldName":u},s=h.querySelector("PARENT_UNIQUE_NAME")?h.querySelector("PARENT_UNIQUE_NAME").textContent:"";if(""===s&&"1"===c)f={hasChildren:!!o.querySelector("CHILDREN_CARDINALITY")&&"0"!==o.querySelector("CHILDREN_CARDINALITY").textContent,isSelected:!1,id:r,tag:r,name:e,caption:e,htmlAttributes:a},"fetchMembers"===i.action||"fetchChildMembers"===i.action?(this.fieldList[u].members[r]={name:r,caption:e,parent:void 0,isNodeExpand:!1,isSelected:!1},this.fieldList[u].filterMembers.push(f),this.fieldList[u].childMembers.push(f)):"fetchSearchMembers"===i.action?(this.fieldList[u].currrentMembers[r]={name:r,caption:e,parent:void 0,isNodeExpand:!1,isSelected:!1},this.fieldList[u].searchMembers.push(f),f.expanded=!0):this.calcChildMembers.push(f);else if(""!==s&&"1"===c)if(s===v&&"1"===c)f={hasChildren:!!o.querySelector("CHILDREN_CARDINALITY")&&"0"!==o.querySelector("CHILDREN_CARDINALITY").textContent,id:r,name:e,isSelected:!1,caption:e,htmlAttributes:a,tag:r},"fetchMembers"===i.action||"fetchChildMembers"===i.action?(this.fieldList[u].filterMembers.push(f),this.fieldList[u].childMembers.push(f),this.fieldList[u].members[r]={name:r,caption:e,parent:void 0,isNodeExpand:!1,isSelected:!1}):"fetchSearchMembers"===i.action?(f.expanded=!0,this.fieldList[u].searchMembers.push(f),this.fieldList[u].currrentMembers[r]={name:r,caption:e,parent:void 0,isNodeExpand:!1,isSelected:!1}):this.calcChildMembers.push(f);else{if("fetchMembers"===i.action&&this.fieldList[u].members[r])continue;p=!!i.loadLevelMembers&&this.fieldList[u].members[s].isSelected;f={hasChildren:!!o.querySelector("CHILDREN_CARDINALITY")&&"0"!==o.querySelector("CHILDREN_CARDINALITY").textContent,htmlAttributes:a,isSelected:!1,id:r,pid:s,name:e,caption:e,tag:r};"fetchMembers"===i.action||"fetchChildMembers"===i.action?(this.fieldList[u].isHierarchy=!1,this.fieldList[u].filterMembers.push(f),this.fieldList[u].childMembers.push(f),this.fieldList[u].members[r]={name:r,caption:e,parent:s,isNodeExpand:!1,isSelected:p}):"fetchSearchMembers"===i.action?(this.fieldList[u].searchMembers.push(f),f.expanded=!0,this.fieldList[u].currrentMembers[r]={name:r,caption:e,parent:s,isNodeExpand:!1,isSelected:!1}):this.calcChildMembers.push(f)}else"2"===c&&(v=r)}},n.prototype.getFieldListItems=function(n,t,i){for(var r,f,h,e,o=[],u=0,s=[].slice.call(n.querySelectorAll("row"));u<s.length;u++)r=s[u],f=[].slice.call(r.querySelectorAll("ALL_MEMBER")).length>0,o.push({pid:r.querySelector("DIMENSION_UNIQUE_NAME").textContent,id:r.querySelector("HIERARCHY_UNIQUE_NAME").textContent,name:r.querySelector("HIERARCHY_CAPTION").textContent,caption:r.querySelector("HIERARCHY_CAPTION").textContent,tag:r.querySelector("HIERARCHY_UNIQUE_NAME").textContent,hasAllMember:f,allMember:f?r.querySelectorAll("ALL_MEMBER")[0].textContent:void 0,type:"string"});e={hierarchy:o,hierarchySuccess:n,measures:[]};this.fieldListObj=e;h={catalog:i.dataSourceSettings.catalog,cube:i.dataSourceSettings.cube,url:i.dataSourceSettings.url,LCID:i.dataSourceSettings.localeIdentifier.toString(),request:"MDSCHEMA_DIMENSIONS"};this.getTreeData(h,this.loadDimensionElements.bind(this),i)},n.prototype.loadCalculatedMemberElements=function(n){var i,o,u,f,t;if(n.length>0)for(i=this.fieldListData,o={hasChildren:!0,isSelected:!1,id:"[Calculated Members].[_0]",name:"[Calculated Members].[_0]",caption:"Calculated Members",spriteCssClass:"e-calcMemberGroupCDB "+h,tag:"[Calculated Members].[_0]",type:"string"},i.length>0&&"[measures]"===i[0].id.toLowerCase()&&i.splice(0,0,o),u=0,f=n;u<f.length;u++)if(t=f[u],!this.fieldList[t.name]){var r=t.formula,s=(r.toLowerCase().indexOf("measure")>-1?"[Measures].":t.hierarchyUniqueName+".")+"["+t.name+"]",c=this.dataFields[t.name]&&this.dataFields[t.name].caption?this.dataFields[t.name].caption:t.name,l=t.formatString,e={hasChildren:!1,isSelected:!1,id:t.name,pid:"[Calculated Members].[_0]",name:t.name,caption:c,spriteCssClass:"e-calc-member "+(r.toLowerCase().indexOf("measure")>-1?"e-calc-measure-icon":"e-calc-dimension-icon")+" "+h,tag:s,formula:r,formatString:l,aggregateType:void 0,type:"CalculatedField",filter:[],dateMember:[],sort:"Ascending",actualFilter:[],filterMembers:[],childMembers:[],searchMembers:[],members:{},currrentMembers:{},isHierarchy:!0,isExcelFilter:!1,isCalculatedField:!0,allowDragAndDrop:!this.dataFields[t.name]||this.dataFields[t.name].allowDragAndDrop,showFilterIcon:!this.dataFields[t.name]||this.dataFields[t.name].showFilterIcon,showSortIcon:!this.dataFields[t.name]||this.dataFields[t.name].showSortIcon,showEditIcon:!this.dataFields[t.name]||this.dataFields[t.name].showEditIcon,showRemoveIcon:!this.dataFields[t.name]||this.dataFields[t.name].showRemoveIcon,showValueTypeIcon:!this.dataFields[t.name]||this.dataFields[t.name].showValueTypeIcon,fieldType:r.toLowerCase().indexOf("measure")>-1?"Measure":"Dimension",parentHierarchy:r.toLowerCase().indexOf("measure")>-1?void 0:t.hierarchyUniqueName};i.push(e);this.fieldList[e.id]=e}},n.prototype.loadDimensionElements=function(n,t,i){for(var v,f=[],s=[].slice.call(n.querySelectorAll("row")),c={},e=0,l=s;e<l.length;e++){var o=l[e],u=o.querySelector("DIMENSION_UNIQUE_NAME").textContent,a=o.querySelector("DIMENSION_CAPTION").textContent;u.toLowerCase().indexOf("[measure")>=0?c={hasChildren:!0,isSelected:!1,id:u,name:u,caption:a,spriteCssClass:"[measures]"===u.toLowerCase()?"e-measureGroupCDB-icon "+h:"e-dimensionCDB-icon "+h,tag:u,type:"string"}:Object(r.isNullOrUndefined)(s[0].querySelector("HIERARCHY_CAPTION"))&&f.push({hasChildren:!0,isSelected:!1,id:this.isMondrian?u+"~#^Dim":u,name:u,caption:a,spriteCssClass:"e-dimensionCDB-icon "+h,tag:u,defaultHierarchy:o.querySelector("DEFAULT_HIERARCHY").textContent,type:"string"})}f.splice(0,0,c);this.fieldListData=f;v={catalog:i.dataSourceSettings.catalog,cube:i.dataSourceSettings.cube,url:i.dataSourceSettings.url,LCID:i.dataSourceSettings.localeIdentifier.toString(),request:"MDSCHEMA_SETS"};this.getTreeData(v,this.loadNamedSetElements.bind(this),i)},n.prototype.loadNamedSetElements=function(n,t,i){var e=Object(r.extend)([],this.rows,null,!0),u,f,c;e=e.concat(this.columns,this.filters);for(var l=this.fieldListData,a=[],o=0,v=e;o<v.length;o++)u=v[o],a.push(u.name);for(var y=[],s=0,p=[].slice.call(n.querySelectorAll("row"));s<p.length;s++)u=p[s],y.indexOf(u.querySelector("DIMENSIONS").textContent.split(".")[0])>=0||(l.push({hasChildren:!0,isSelected:!1,pid:u.querySelector("DIMENSIONS").textContent.split(".")[0],id:u.querySelector("SET_DISPLAY_FOLDER").textContent+"_"+u.querySelector("DIMENSIONS").textContent.split(".")[0],name:u.querySelector("SET_DISPLAY_FOLDER").textContent,spriteCssClass:"e-folderCDB-icon "+h+" namedSets",caption:u.querySelector("SET_DISPLAY_FOLDER").textContent,type:"string"}),y.push(u.querySelector("DIMENSIONS").textContent.split(".")[0])),f="["+u.querySelector("SET_NAME").textContent.trim()+"]",c={hasChildren:!0,isNamedSets:!0,isSelected:a.indexOf("["+u.querySelector("SET_NAME").textContent+"]")>=0,pid:u.querySelector("SET_DISPLAY_FOLDER").textContent+"_"+u.querySelector("DIMENSIONS").textContent.split(".")[0],id:f,name:u.querySelector("SET_CAPTION").textContent,caption:u.querySelector("SET_CAPTION").textContent,spriteCssClass:"e-namedSetCDB-icon "+h,tag:u.querySelector("EXPRESSION").textContent,type:"string",filter:[],dateMember:[],actualFilter:[],filterMembers:[],childMembers:[],searchMembers:[],members:{},currrentMembers:{},isHierarchy:!0,isExcelFilter:!1,allowDragAndDrop:!this.dataFields[f]||this.dataFields[f].allowDragAndDrop,showFilterIcon:!this.dataFields[f]||this.dataFields[f].showFilterIcon,showSortIcon:!this.dataFields[f]||this.dataFields[f].showSortIcon,showEditIcon:!this.dataFields[f]||this.dataFields[f].showEditIcon,showRemoveIcon:!this.dataFields[f]||this.dataFields[f].showRemoveIcon,showValueTypeIcon:!this.dataFields[f]||this.dataFields[f].showValueTypeIcon},l.push(c),this.fieldList[f]=c;i.hierarchy=this.fieldListData;i.hierarchySuccess=this.fieldListObj.hierarchySuccess;this.loadHierarchyElements(i)},n.prototype.loadHierarchyElements=function(n){for(var t,o,v,p,c,f,et,k,ot,st=n.hierarchySuccess,e=n.hierarchy,d=Object(r.extend)([],this.rows,null,!0),g=[],a=0,nt=d=d.concat(this.columns,this.filters);a<nt.length;a++)t=nt[a],g.push(t.name);for(o=0,v=[].slice.call(st.querySelectorAll("row"));o<v.length;o++){var u=(t=v[o]).querySelector("DIMENSION_UNIQUE_NAME").textContent,i=t.querySelector("HIERARCHY_UNIQUE_NAME").textContent,tt=[].slice.call(t.querySelectorAll("ALL_MEMBER")).length>0,y=void 0;tt?(p=t.querySelectorAll("ALL_MEMBER")[0].textContent.replace(/[\[\]\&']+/g,"").split("."),y=p[p.length-1].trim()):y=void 0;for(var s=t.querySelector("HIERARCHY_DISPLAY_FOLDER")?t.querySelector("HIERARCHY_DISPLAY_FOLDER").textContent:"",it=[],w=0,rt=e;w<rt.length;w++)(f=rt[w]).tag===u&&it.push(f);if(it.length>0&&(u!==i||this.isMondrian)){if(c=u+(this.isMondrian?"~#^Dim":""),""!==s){for(var l=u+(this.isMondrian?"~#^Dim":"")+"_"+s,ut=[],b=0,ft=e;b<ft.length;b++)(f=ft[b]).tag===l&&f.pid===c&&ut.push(f);0===ut.length&&(et={hasChildren:!0,isSelected:!1,pid:u+(this.isMondrian?"~#^Dim":""),id:l,name:s,spriteCssClass:"e-folderCDB-icon "+h,tag:l,caption:s,type:"string"},e.push(et));c=l}k={hasChildren:!t.querySelector("HIERARCHY_ORIGIN")||"2"!==t.querySelector("HIERARCHY_ORIGIN").textContent&&"6"!==t.querySelector("HIERARCHY_ORIGIN").textContent,isSelected:g.indexOf(i)>=0,pid:c,id:i,name:t.querySelector("HIERARCHY_CAPTION").textContent,spriteCssClass:(t.querySelector("HIERARCHY_ORIGIN")?"2"!==t.querySelector("HIERARCHY_ORIGIN").textContent&&"6"!==t.querySelector("HIERARCHY_ORIGIN").textContent?"e-hierarchyCDB-icon":"e-attributeCDB-icon":"e-hierarchyCDB-icon")+" "+h,hasAllMember:tt,allMember:y,tag:i,caption:t.querySelector("HIERARCHY_CAPTION").textContent,type:"string",filter:[],dateMember:[],sort:this.enableSort?this.sortObject[i]?this.sortObject[i]:"Ascending":"None",actualFilter:[],filterMembers:[],childMembers:[],searchMembers:[],members:{},currrentMembers:{},levels:[],levelCount:1,isHierarchy:!!t.querySelector("HIERARCHY_ORIGIN")&&("2"===t.querySelector("HIERARCHY_ORIGIN").textContent||"6"===t.querySelector("HIERARCHY_ORIGIN").textContent),isExcelFilter:!1,allowDragAndDrop:!this.dataFields[i]||this.dataFields[i].allowDragAndDrop,showFilterIcon:!this.dataFields[i]||this.dataFields[i].showFilterIcon,showSortIcon:!this.dataFields[i]||this.dataFields[i].showSortIcon,showEditIcon:!this.dataFields[i]||this.dataFields[i].showEditIcon,showRemoveIcon:!this.dataFields[i]||this.dataFields[i].showRemoveIcon,showValueTypeIcon:!this.dataFields[i]||this.dataFields[i].showValueTypeIcon};e.push(k);this.fieldList[i]=k}}ot={catalog:n.dataSourceSettings.catalog,cube:n.dataSourceSettings.cube,url:n.dataSourceSettings.url,LCID:n.dataSourceSettings.localeIdentifier.toString(),request:"MDSCHEMA_LEVELS"};this.getTreeData(ot,this.loadLevelElements.bind(this),n)},n.prototype.loadLevelElements=function(n,t,i){var e=[],s=this.fieldListData,f,o,u,v;for(e=[],f=0,o=[].slice.call(n.querySelectorAll("row"));f<o.length;f++)if(u=o[f],1!==parseInt(u.querySelector("LEVEL_TYPE").textContent,10)&&"[measures]"!==u.querySelector("HIERARCHY_UNIQUE_NAME").textContent.toLowerCase()){var r=u.querySelector("HIERARCHY_UNIQUE_NAME").textContent,c=u.querySelector("LEVEL_UNIQUE_NAME").textContent,l=u.querySelector("LEVEL_CAPTION").textContent,a={hasChildren:!1,isChecked:!1,isSelected:this.fieldList[r].isSelected,pid:r,id:c,name:l,tag:c,spriteCssClass:"e-level-members e-hierarchy-level-"+parseInt(u.querySelector("LEVEL_NUMBER").textContent,10)+"-icon "+h,caption:l,type:"string"};e.push(a);this.fieldList[r]&&this.fieldList[r].spriteCssClass&&-1===this.fieldList[r].spriteCssClass.indexOf("e-attributeCDB-icon")?(this.fieldList[r].levels.push(a),this.fieldList[r].isHierarchy=!1):this.fieldList[r].isHierarchy=!0}this.fieldListData=s=s.concat(e);v={catalog:i.dataSourceSettings.catalog,cube:i.dataSourceSettings.cube,url:i.dataSourceSettings.url,LCID:i.dataSourceSettings.localeIdentifier.toString(),request:"MDSCHEMA_MEASURES"};this.getTreeData(v,this.loadMeasureElements.bind(this),i)},n.prototype.loadMeasureElements=function(n,t,i){for(var f,g,c,a,p,w,s,b=this.fieldListData,k=[],o=[],l=0,d=Object(r.extend)([],this.values,null,!0);l<d.length;l++)f=d[l],o.push(f.name);for("en-US"!==this.locale&&(g={catalog:i.dataSourceSettings.catalog,cube:i.dataSourceSettings.cube,url:i.dataSourceSettings.url,LCID:i.dataSourceSettings.localeIdentifier.toString(),request:"MDSCHEMA_MEASUREGROUPS"},this.getTreeData(g,this.loadMeasureGroups.bind(this),i)),c=0,a=[].slice.call(n.querySelectorAll("row"));c<a.length;c++){f=a[c];var e=Object(r.isNullOrUndefined)(f.querySelector("MEASUREGROUP_NAME"))?"":f.querySelector("MEASUREGROUP_NAME").textContent,u=f.querySelector("MEASURE_UNIQUE_NAME").textContent,it=f.querySelector("DEFAULT_FORMAT_STRING")?f.querySelector("DEFAULT_FORMAT_STRING").textContent:"#,#",nt=f.querySelector("MEASURE_AGGREGATOR")?f.querySelector("MEASURE_AGGREGATOR").textContent:"1";if(!(k.indexOf(e)>=0)){if("en-US"!==this.locale){for(var v=[],y=0,tt=this.fieldListObj.measuresGroups;y<tt.length;y++)p=tt[y],p.querySelector("MEASUREGROUP_NAME").textContent===e&&v.push(p);s=v.length>0?v[0].querySelector("MEASUREGROUP_CAPTION").textContent:e}else s=e;""!==e&&(b.push({hasChildren:!0,isChecked:!1,isSelected:!1,pid:"[Measures]",id:e,name:s,spriteCssClass:"e-measureCDB e-folderCDB-icon "+h,tag:e,caption:s,aggregateType:this.getAggregateType(e,nt),type:"string"}),k.push(e))}w={hasChildren:!1,isSelected:o.indexOf(u)>=0,pid:""===e?"[Measures]":e,id:u,name:f.querySelector("MEASURE_CAPTION").textContent,spriteCssClass:"e-measure-icon "+h,tag:u,caption:f.querySelector("MEASURE_CAPTION").textContent,aggregateType:this.getAggregateType(u,nt),type:"number",filter:[],actualFilter:[],filterMembers:[],childMembers:[],searchMembers:[],members:{},currrentMembers:{},formatString:it,allowDragAndDrop:!this.dataFields[u]||this.dataFields[u].allowDragAndDrop,showFilterIcon:!this.dataFields[u]||this.dataFields[u].showFilterIcon,showSortIcon:!this.dataFields[u]||this.dataFields[u].showSortIcon,showEditIcon:!this.dataFields[u]||this.dataFields[u].showEditIcon,showRemoveIcon:!this.dataFields[u]||this.dataFields[u].showRemoveIcon,showValueTypeIcon:!this.dataFields[u]||this.dataFields[u].showValueTypeIcon};b.push(w);this.fieldList[u]=w;o.indexOf(u)>=0&&o.splice(o.indexOf(u),1)}this.measureReportItems=o},n.prototype.loadMeasureGroups=function(n){Object(r.isNullOrUndefined)(this.fieldListObj)&&(this.fieldListObj={});this.fieldListObj.measuresGroups=[].slice.call(n.querySelectorAll("row"))},n.prototype.doAjaxPost=function(n,t,i,u,f){new r.Ajax({mode:!1,contentType:"text/xml",url:t,data:i,dataType:"xml",type:n,beforeSend:this.beforeSend.bind(this),onSuccess:function(n,t){var i=(new DOMParser).parseFromString(n,"text/xml");u(i,t,f)},onFailure:function(n){return n}}).send()},n.prototype.beforeSend=function(n){this.dataSourceSettings.authentication.userName&&this.dataSourceSettings.authentication.password&&n.httpRequest.setRequestHeader("Authorization","Basic "+btoa(this.dataSourceSettings.authentication.userName+":"+this.dataSourceSettings.authentication.password))},n.prototype.getSoapMsg=function(n,t){var i=this.getConnectionInfo(n.url,n.localeIdentifier);return this.isMondrian?'<SOAP-ENV:Envelope xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" SOAP-ENV:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"><SOAP-ENV:Body><Execute xmlns="urn:schemas-microsoft-com:xml-analysis"><Command><Statement><![CDATA['+t+"]\]><\/Statement><\/Command><Properties><PropertyList><DataSourceInfo><\/DataSourceInfo><Catalog>"+n.catalog+"<\/Catalog><AxisFormat>TupleFormat<\/AxisFormat><Content>Data<\/Content><Format>Multidimensional<\/Format><\/PropertyList><\/Properties><\/Execute><\/SOAP-ENV:Body><\/SOAP-ENV:Envelope>":'<Envelope xmlns="http://schemas.xmlsoap.org/soap/envelope/"> <Header><\/Header> <Body> <Execute xmlns="urn:schemas-microsoft-com:xml-analysis"> <Command> <Statement> '+t+" <\/Statement> <\/Command> <Properties> <PropertyList> <Catalog>"+n.catalog+"<\/Catalog> <LocaleIdentifier>"+i.LCID+"<\/LocaleIdentifier><\/PropertyList> <\/Properties> <\/Execute> <\/Body> <\/Envelope>"},n.prototype.getConnectionInfo=function(n,t){var i={url:"",LCID:"1033"},f,e,u;if(""!==n)for(f=0,e=n.split(";");f<e.length;f++)u=e[f],u.toLowerCase().indexOf("locale")<0&&0===i.url.length?i.url=u:u.toLowerCase().indexOf("locale")>=0?i.LCID=u.replace(/ /g,"").split("=")[1]:Object(r.isNullOrUndefined)(t)||(i.LCID=t.toString());return i},n.prototype.getMDXQuery=function(n){return dt.getCellSets(n,this,!0,void 0,!0),this.mdxQuery},n}(),gt=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),f=function(n,t,i,r){var f,e=arguments.length,u=e<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r,o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(n,t,i,r);else for(o=n.length-1;o>=0;o--)(f=n[o])&&(u=(e<3?f(u):e>3?f(t,i,u):f(t,i))||u);return e>3&&u&&Object.defineProperty(t,i,u),u},pf=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return gt(t,n),f([Object(r.Property)(!0)],t.prototype,"showFilterIcon",void 0),f([Object(r.Property)(!0)],t.prototype,"showSortIcon",void 0),f([Object(r.Property)(!0)],t.prototype,"showRemoveIcon",void 0),f([Object(r.Property)(!0)],t.prototype,"showValueTypeIcon",void 0),f([Object(r.Property)("Both")],t.prototype,"displayMode",void 0),f([Object(r.Property)(!0)],t.prototype,"allowDragAndDrop",void 0),t}(r.ChildProperty),wf=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return gt(t,n),f([Object(r.Property)(!1)],t.prototype,"allowAdding",void 0),f([Object(r.Property)(!1)],t.prototype,"allowEditing",void 0),f([Object(r.Property)(!1)],t.prototype,"allowDeleting",void 0),f([Object(r.Property)(!1)],t.prototype,"allowCommandColumns",void 0),f([Object(r.Property)("Normal")],t.prototype,"mode",void 0),f([Object(r.Property)(!0)],t.prototype,"allowEditOnDblClick",void 0),f([Object(r.Property)(!0)],t.prototype,"showConfirmDialog",void 0),f([Object(r.Property)(!1)],t.prototype,"showDeleteConfirmDialog",void 0),t}(r.ChildProperty),bf=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return gt(t,n),f([Object(r.Property)()],t.prototype,"measure",void 0),f([Object(r.Property)()],t.prototype,"label",void 0),f([Object(r.Property)("NotEquals")],t.prototype,"conditions",void 0),f([Object(r.Property)()],t.prototype,"value1",void 0),f([Object(r.Property)()],t.prototype,"value2",void 0),t}(r.ChildProperty),kf=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return gt(t,n),f([Object(r.Property)(!1)],t.prototype,"showHyperlink",void 0),f([Object(r.Property)(!1)],t.prototype,"showRowHeaderHyperlink",void 0),f([Object(r.Property)(!1)],t.prototype,"showColumnHeaderHyperlink",void 0),f([Object(r.Property)(!1)],t.prototype,"showValueCellHyperlink",void 0),f([Object(r.Property)(!1)],t.prototype,"showSummaryCellHyperlink",void 0),f([Object(r.Collection)([],bf)],t.prototype,"conditionalSettings",void 0),f([Object(r.Property)()],t.prototype,"headerText",void 0),f([Object(r.Property)("")],t.prototype,"cssClass",void 0),t}(r.ChildProperty),df=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return gt(t,n),f([Object(r.Property)("Table")],t.prototype,"view",void 0),f([Object(r.Property)("Table")],t.prototype,"primary",void 0),t}(r.ChildProperty),ui=function(n){function t(t,i){var u=n.call(this,t,i)||this;return u.verticalScrollScale=1,u.horizontalScrollScale=1,u.scrollerBrowserLimit=5e5,u.lastSortInfo={},u.lastFilterInfo={},u.lastAggregationInfo={},u.lastCalcFieldInfo={},u.isScrolling=!1,u.shiftLockedPos=[],u.savedSelectedCellsPos=[],u.cellSelectionPos=[],u.isPopupClicked=!1,u.isMouseDown=!1,u.isMouseUp=!1,u.fieldsType={},u.defaultItems={},u.isCellBoxMultiSelection=!1,u.gridHeaderCellInfo=[],u.gridCellCollection={},u.rowRangeSelection={enable:!1,startIndex:0,endIndex:0},u.resizeInfo={},u.scrollPosObject={vertical:0,horizontal:0,verticalSection:0,horizontalSection:0,top:0,left:0,scrollDirection:{direction:"",position:0}},u.pivotColumns=[],u.totColWidth=0,u.posCount=0,u.isModified=!1,u.needsID=!0,u.pivotRefresh=r.Component.prototype.refresh,u.pivotView=u,Object(r.setValue)("mergePersistData",u.mergePersistPivotData,u),u}var i;return gt(t,n),i=t,t.prototype.requiredModules=function(){var n=[];return n.push({args:[this],member:"groupingbar"}),this.allowConditionalFormatting&&n.push({args:[this],member:"conditionalformatting"}),this.allowNumberFormatting&&n.push({args:[this],member:"numberformatting"}),this.allowCalculatedField&&n.push({args:[this],member:"calculatedfield"}),this.showToolbar&&this.toolbar.length>0&&n.push({args:[this],member:"toolbar"}),this.showFieldList&&n.push({args:[this],member:"fieldlist"}),this.allowExcelExport&&n.push({args:[this],member:"excelExport"}),this.allowPdfExport&&n.push({args:[this],member:"pdfExport"}),this.enableVirtualization&&n.push({args:[this],member:"virtualscroll"}),this.allowGrouping&&n.push({args:[this],member:"grouping"}),n},t.prototype.preRender=function(){this.dataSourceSettings&&"SSAS"===this.dataSourceSettings.providerType?(this.dataType="olap",this.olapEngineModule=new rr):(this.dataType="pivot",this.engineModule=new li);this.isAdaptive=r.Browser.isDevice;this.isTouchMode=!!Object(r.closest)(this.element,"e-bigger");this.initProperties();this.renderToolTip();this.keyboardModule=new hu(this);this.contextMenuModule=new cu(this);this.globalize=new r.Internationalization(this.locale);(this.showFieldList||this.showGroupingBar||this.allowNumberFormatting||this.allowCalculatedField||this.toolbar||this.allowGrouping||this.gridSettings.contextMenuItems)&&(this.commonModule=new pr(this));this.defaultLocale={grandTotal:"Grand Total",total:"Total",value:"Value",noValue:"No value",row:"Row",column:"Column",collapse:"Collapse",expand:"Expand",rowAxisPrompt:"Drop row here",columnAxisPrompt:"Drop column here",valueAxisPrompt:"Drop value here",filterAxisPrompt:"Drop filter here",filter:"Filter",filtered:"Filtered",sort:"Sort",filters:"Filters",rows:"Rows",columns:"Columns",values:"Values",close:"Close",cancel:"Cancel","delete":"Delete",CalculatedField:"Calculated Field",createCalculatedField:"Create Calculated Field",fieldName:"Enter the field name",error:"Error",invalidFormula:"Invalid formula.",dropText:'Example: ("Sum(Order_Count)" + "Sum(In_Stock)") * 250',dropTextMobile:"Add fields and edit formula here.",dropAction:"Calculated field cannot be place in any other region except value axis.",alert:"Alert",warning:"Warning",ok:"OK",search:"Search",drag:"Drag",remove:"Remove",allFields:"All Fields",formula:"Formula",addToRow:"Add to Row",addToColumn:"Add to Column",addToValue:"Add to Value",addToFilter:"Add to Filter",emptyData:"No records to display",fieldExist:"A field already exists in this name. Please enter a different name.",confirmText:"A calculation field already exists in this name. Do you want to replace it?",noMatches:"No matches",format:"Summaries values by",edit:"Edit",clear:"Clear",sortAscending:"Sort ascending order",sortDescending:"Sort descending order",sortNone:"Sort data order",clearCalculatedField:"Clear edited field info",editCalculatedField:"Edit calculated field",formulaField:"Drag and drop fields to formula",dragField:"Drag field to formula",clearFilter:"Clear",by:"by",all:"All",multipleItems:"Multiple items",member:"Member",label:"Label",date:"Date",enterValue:"Enter value",chooseDate:"Enter date",Before:"Before",BeforeOrEqualTo:"Before Or Equal To",After:"After",AfterOrEqualTo:"After Or Equal To",labelTextContent:"Show the items for which the label",dateTextContent:"Show the items for which the date",valueTextContent:"Show the items for which",Equals:"Equals",DoesNotEquals:"Does Not Equal",BeginWith:"Begins With",DoesNotBeginWith:"Does Not Begin With",EndsWith:"Ends With",DoesNotEndsWith:"Does Not End With",Contains:"Contains",DoesNotContains:"Does Not Contain",GreaterThan:"Greater Than",GreaterThanOrEqualTo:"Greater Than Or Equal To",LessThan:"Less Than",LessThanOrEqualTo:"Less Than Or Equal To",Between:"Between",NotBetween:"Not Between",And:"and",Sum:"Sum",Count:"Count",DistinctCount:"Distinct Count",Product:"Product",Avg:"Avg",Min:"Min",SampleVar:"Sample Var",PopulationVar:"Population Var",RunningTotals:"Running Totals",Max:"Max",Index:"Index",SampleStDev:"Sample StDev",PopulationStDev:"Population StDev",PercentageOfRowTotal:"% of Row Total",PercentageOfParentTotal:"% of Parent Total",PercentageOfParentColumnTotal:"% of Parent Column Total",PercentageOfParentRowTotal:"% of Parent Row Total",DifferenceFrom:"Difference From",PercentageOfDifferenceFrom:"% of Difference From",PercentageOfGrandTotal:"% of Grand Total",PercentageOfColumnTotal:"% of Column Total",MoreOption:"More...",NotEquals:"Not Equals",AllValues:"All Values",conditionalFormating:"Conditional Formatting",apply:"APPLY",condition:"Add Condition",formatLabel:"Format",valueFieldSettings:"Value field settings",baseField:"Base field :",baseItem:"Base item :",summarizeValuesBy:"Summarize values by :",sourceName:"Field name :",sourceCaption:"Field caption :",example:"e.g:",editorDataLimitMsg:" more items. Search to refine further.",details:"Details",manageRecords:"Manage Records",Years:"Years",Quarters:"Quarters",Months:"Months",Days:"Days",Hours:"Hours",Minutes:"Minutes",Seconds:"Seconds",save:"Save a report","new":"Create a new report",load:"Load",saveAs:"Save as current report",rename:"Rename a current report",deleteReport:"Delete a current report","export":"Export",subTotals:"Sub totals",grandTotals:"Grand totals",reportName:"Report Name :",pdf:"PDF",excel:"Excel",csv:"CSV",png:"PNG",jpeg:"JPEG",svg:"SVG",mdxQuery:"MDX Query",showSubTotals:"Show sub totals",doNotShowSubTotals:"Do not show sub totals",showSubTotalsRowsOnly:"Show sub totals rows only",showSubTotalsColumnsOnly:"Show sub totals columns only",showGrandTotals:"Show grand totals",doNotShowGrandTotals:"Do not show grand totals",showGrandTotalsRowsOnly:"Show grand totals rows only",showGrandTotalsColumnsOnly:"Show grand totals columns only",fieldList:"Show fieldlist",grid:"Show table",toolbarFormatting:"Conditional formatting",chart:"Chart",reportMsg:"Please enter vaild report name!!!",reportList:"Report list",removeConfirm:"Are you sure want to delete this report?",emptyReport:"No reports found!!",bar:"Bar",stackingcolumn:"Stacked Column",stackingarea:"Stacked Area",stackingbar:"Stacked Bar",stepline:"Step Line",steparea:"Step Area",splinearea:"Spline Area",spline:"Spline",stackingcolumn100:"100% Stacked Column",stackingbar100:"100% Stacked Bar",stackingarea100:"100% Stacked Area",bubble:"Bubble",pareto:"Pareto",radar:"Radar",line:"Line",area:"Area",scatter:"Scatter",polar:"Polar",of:"of",emptyFormat:"No format found!!!",emptyInput:"Enter a value",newReportConfirm:"Want to save changes to report?",emptyReportName:"Enter a report name",qtr:"Qtr","null":"null",undefined:"undefined",groupOutOfRange:"Out of Range",fieldDropErrorAction:"The field you are moving cannot be placed in that area of the report",aggregate:"Aggregate",drillThrough:"Drill Through",ascending:"Ascending",descending:"Descending",number:"Number",currency:"Currency",percentage:"Percentage",formatType:"Format Type",customText:"Currency Symbol",symbolPosition:"Symbol Position",left:"Left",right:"Right",grouping:"Grouping","true":"True","false":"False",decimalPlaces:"Decimal Places",numberFormat:"Number Formatting",memberType:"Field Type",formatString:"Format String",expressionField:"Expression",customFormat:"Enter custom format string",numberFormatString:"Enter the format string",selectedHierarchy:"Parent Hierarchy",olapDropText:"Example: [Measures].[Order Quantity] + ([Measures].[Order Quantity] * 0.10)",Percent:"Percent",Currency:"Currency",Custom:"Custom",Measure:"Measure",Dimension:"Dimension",Standard:"Standard",blank:"(Blank)",fieldTooltip:'Drag and drop fields to create an expression. And, if you want to edit the existing calculated fields! You can achieve it by simply selecting the field under "Calculated Members".',fieldTitle:"Field Name",QuarterYear:"Quarter Year",drillError:"Cannot show the raw items of calculated fields.",caption:"Field Caption",copy:"Copy",defaultReport:"Default report",customFormatString:"Custom Format",invalidFormat:"Invalid Format.",group:"Group",unGroup:"Ungroup",invalidSelection:"Cannot group that selection.",groupName:"Enter the caption to display in header",captionName:"Enter the caption for group field",selectedItems:"Selected items",groupFieldCaption:"Field caption",groupTitle:"Group name",startAt:"Starting at",endAt:"Ending at",groupBy:"Interval by",selectGroup:"Select groups",multipleAxes:"Multiple axes",chartTypeSettings:"Chart Type Settings",ChartType:"Chart Type"};this.localeObj=new r.L10n(this.getModuleName(),this.defaultLocale,this.locale);this.renderContextMenu();this.isDragging=!1;this.addInternalEvents()},t.prototype.onBeforeTooltipOpen=function(n){n.element.classList.add("e-pivottooltipwrap")},t.prototype.renderToolTip=function(){this.showTooltip?(this.tooltip=this.tooltipTemplate?new p.Tooltip({target:"td.e-valuescontent",cssClass:"e-pivottooltiptemplate",showTipPointer:!1,enableRtl:this.enableRtl,beforeRender:this.setToolTip.bind(this),beforeOpen:this.onBeforeTooltipOpen}):new p.Tooltip({target:"td.e-valuescontent",showTipPointer:!1,enableRtl:this.enableRtl,beforeRender:this.setToolTip.bind(this),beforeOpen:this.onBeforeTooltipOpen}),this.tooltip.isStringTemplate=!0,this.tooltip.appendTo(this.element)):this.tooltip&&this.tooltip.destroy()},t.prototype.renderContextMenu=function(){var t,u,n,f,e;if(this.gridSettings.contextMenuItems||this.allowGrouping&&"pivot"===this.dataType){var o=[],i=[],s=[],r=[],h=[],c=[],l=[];if(this.gridSettings.contextMenuItems)for(t=0,u=this.gridSettings.contextMenuItems;t<u.length;t++)n=u[t],"string"==typeof n&&-1!==this.getDefaultItems().indexOf(n)?-1!==n.toString().toLowerCase().indexOf("aggregate")&&"pivot"===this.dataType?(l=[{text:this.localeObj.getConstant("Sum")}],f=this.buildDefaultItems("Aggregate"),f.items=l,h.push(f)):-1!==n.toString().toLowerCase().indexOf("export")?r.push(this.buildDefaultItems(n)):o.push(this.buildDefaultItems(n)):"string"!=typeof n&&s.push(n);(this.allowGrouping&&"pivot"===this.dataType&&(i.push(this.buildDefaultItems("Group")),i.push(this.buildDefaultItems("Ungroup"))),r.length>0)&&(e=this.buildDefaultItems("export"),e.items=r,c.push(e));this.gridSettings.contextMenuItems=[];Array.prototype.push.apply(this.gridSettings.contextMenuItems,h);Array.prototype.push.apply(this.gridSettings.contextMenuItems,o);Array.prototype.push.apply(this.gridSettings.contextMenuItems,i);Array.prototype.push.apply(this.gridSettings.contextMenuItems,c);Array.prototype.push.apply(this.gridSettings.contextMenuItems,s)}},t.prototype.getAllSummaryType=function(){return["Sum","Count","DistinctCount","Product","Min","Max","Avg","Index","PopulationVar","SampleVar","PopulationStDev","SampleStDev","RunningTotals","PercentageOfGrandTotal","PercentageOfColumnTotal","PercentageOfRowTotal","PercentageOfParentColumnTotal","PercentageOfParentRowTotal","DifferenceFrom","PercentageOfDifferenceFrom","PercentageOfParentTotal"]},t.prototype.getDefaultItems=function(){return["Drillthrough","Expand","Collapse","Pdf Export","Excel Export","Csv Export","Sort Ascending","Sort Descending","Aggregate","CalculatedField"]},t.prototype.buildDefaultItems=function(n){var t;switch(n){case"Aggregate":t={text:this.localeObj.getConstant("aggregate"),target:"th.e-valuesheader,td.e-valuescontent,.e-stot.e-rowsheader",id:this.element.id+"_aggregate"};break;case"CalculatedField":t={text:this.localeObj.getConstant("CalculatedField"),target:"td.e-valuescontent",id:this.element.id+"_CalculatedField"};break;case"Drillthrough":t={text:this.localeObj.getConstant("drillThrough"),target:"td.e-valuescontent",id:this.element.id+"_drillthrough_menu",iconCss:"e-pivotview-grid "+h};break;case"export":t={text:this.localeObj.getConstant("export"),target:"td.e-valuescontent",id:this.element.id+"_exporting",iconCss:"e-pivotview-export "+h};break;case"Pdf Export":t={text:this.localeObj.getConstant("pdf"),id:this.element.id+"_pdf",iconCss:"e-pivotview-pdf-export "+h};break;case"Excel Export":t={text:this.localeObj.getConstant("excel"),id:this.element.id+"_excel",iconCss:"e-pivotview-excel-export "+h};break;case"Csv Export":t={text:this.localeObj.getConstant("csv"),id:this.element.id+"_csv",iconCss:"e-pivotview-csv-export "+h};break;case"Expand":t={text:this.localeObj.getConstant("expand"),target:"td.e-rowsheader,.e-columnsheader",id:this.element.id+"_expand",iconCss:"e-pivotview-expand "+h};break;case"Collapse":t={text:this.localeObj.getConstant("collapse"),target:"td.e-rowsheader,.e-columnsheader",id:this.element.id+"_collapse",iconCss:"e-pivotview-collapse "+h};break;case"Sort Ascending":t={text:this.localeObj.getConstant("ascending"),target:"th.e-valuesheader,.e-stot",id:this.element.id+"_sortasc",iconCss:"e-icon-ascending "+h};break;case"Sort Descending":t={text:this.localeObj.getConstant("descending"),target:"th.e-valuesheader,.e-stot",id:this.element.id+"_sortdesc",iconCss:"e-icon-descending "+h};break;case"Group":t={text:this.localeObj.getConstant("group"),target:"td.e-rowsheader,.e-columnsheader",id:this.element.id+"_custom_group",iconCss:"e-pivotview-group "+h};break;case"Ungroup":t={text:this.localeObj.getConstant("unGroup"),target:"td.e-rowsheader,.e-columnsheader",id:this.element.id+"_custom_ungroup",iconCss:"e-pivotview-ungroup "+h}}return this.defaultItems[n]={text:t.text,id:t.id,target:t.target,iconCss:t.iconCss},this.defaultItems[n]},t.prototype.initProperties=function(){this.pivotRefresh=r.Component.prototype.refresh;this.isScrolling=!1;this.setProperties({pivotValues:[]},!0);this.scrollPosObject={vertical:0,horizontal:0,verticalSection:0,horizontalSection:0,top:0,left:0,scrollDirection:{direction:"",position:0}};this.queryCellInfo=this.gridSettings.queryCellInfo?this.gridSettings.queryCellInfo.bind(this):void 0;this.headerCellInfo=this.gridSettings.headerCellInfo?this.gridSettings.headerCellInfo.bind(this):void 0;this.resizing=this.gridSettings.resizing?this.gridSettings.resizing.bind(this):void 0;this.resizeStop=this.gridSettings.resizeStop?this.gridSettings.resizeStop.bind(this):void 0;this.pdfHeaderQueryCellInfo=this.gridSettings.pdfHeaderQueryCellInfo?this.gridSettings.pdfHeaderQueryCellInfo.bind(this):void 0;this.pdfQueryCellInfo=this.gridSettings.pdfQueryCellInfo?this.gridSettings.pdfQueryCellInfo.bind(this):void 0;this.excelHeaderQueryCellInfo=this.gridSettings.excelHeaderQueryCellInfo?this.gridSettings.excelHeaderQueryCellInfo.bind(this):void 0;this.excelQueryCellInfo=this.gridSettings.excelQueryCellInfo?this.gridSettings.excelQueryCellInfo.bind(this):void 0;this.columnDragStart=this.gridSettings.columnDragStart?this.gridSettings.columnDragStart.bind(this):void 0;this.columnDrag=this.gridSettings.columnDrag?this.gridSettings.columnDrag.bind(this):void 0;this.columnDrop=this.gridSettings.columnDrop?this.gridSettings.columnDrop.bind(this):void 0;this.beforeColumnsRender=this.gridSettings.columnRender?this.gridSettings.columnRender:void 0;this.selected=this.gridSettings.cellSelected?this.gridSettings.cellSelected:void 0;this.cellDeselected=this.gridSettings.cellDeselected?this.gridSettings.cellDeselected:void 0;this.rowSelected=this.gridSettings.rowSelected?this.gridSettings.rowSelected:void 0;this.rowDeselected=this.gridSettings.rowDeselected?this.gridSettings.rowDeselected:void 0;this.chartTooltipRender=this.chartSettings.tooltipRender?this.chartSettings.tooltipRender:void 0;this.chartLoaded=this.chartSettings.loaded?this.chartSettings.loaded:void 0;this.chartLoad=this.chartSettings.load?this.chartSettings.load:void 0;this.chartResized=this.chartSettings.resized?this.chartSettings.resized:void 0;this.chartAxisLabelRender=this.chartSettings.axisLabelRender?this.chartSettings.axisLabelRender:void 0;this.chartPointClick=this.chartSettings.pointClick?this.chartSettings.pointClick:void 0;this.contextMenuClick=this.gridSettings.contextMenuClick?this.gridSettings.contextMenuClick:void 0;this.contextMenuOpen=this.gridSettings.contextMenuOpen?this.gridSettings.contextMenuOpen:void 0;this.beforePdfExport=this.gridSettings.beforePdfExport?this.gridSettings.beforePdfExport.bind(this):void 0;this.beforeExcelExport=this.gridSettings.beforeExcelExport?this.gridSettings.beforeExcelExport.bind(this):void 0;null===this.gridSettings.rowHeight&&(this.isTouchMode?this.setProperties({gridSettings:{rowHeight:36}},!0):this.setProperties({gridSettings:{rowHeight:this.isAdaptive?36:30}},!0));this.element.style.height="100%";this.enableVirtualization&&(this.updatePageSettings(!0),this.allowExcelExport&&i.Inject(ou),this.allowPdfExport&&i.Inject(su),this.editSettings.allowEditing&&i.Inject(ki));this.isCellBoxMultiSelection=this.gridSettings.allowSelection&&"Box"===this.gridSettings.selectionSettings.cellSelectionMode&&"Cell"===this.gridSettings.selectionSettings.mode&&"Multiple"===this.gridSettings.selectionSettings.type;this.allowGrouping&&!this.isCellBoxMultiSelection&&(this.isCellBoxMultiSelection=!0,this.setProperties({gridSettings:{allowSelection:!0,selectionSettings:{cellSelectionMode:"Box",mode:"Cell",type:"Multiple"}}},!0));"Table"!==this.displayOption.view&&(this.chartModule=new di);this.currentView=this.currentView?this.currentView:"Both"===this.displayOption.view?this.displayOption.primary:this.displayOption.view},t.prototype.updatePageSettings=function(n){var i,r,t;this.enableVirtualization&&(i=1,r=1,this.dataSourceSettings.values.length>1&&"pivot"===this.dataType&&("row"===this.dataSourceSettings.valueAxis?r=this.dataSourceSettings.values.length:i=this.dataSourceSettings.values.length),t=this.getHeightAsNumber(),isNaN(t)&&(t=this.element.offsetHeight),this.pageSettings={columnCurrentPage:n?1:this.pageSettings.columnCurrentPage,rowCurrentPage:n?1:this.pageSettings.rowCurrentPage,columnSize:Math.ceil((Math.floor(this.getWidthAsNumber()/this.gridSettings.columnWidth)-1)/i),rowSize:Math.ceil(Math.floor(t/this.gridSettings.rowHeight)/r),allowDataCompression:this.allowDataCompression})},t.prototype.render=function(){var n=this,t;this.cellTemplateFn=this.templateParser(this.cellTemplate);this.tooltipTemplateFn=this.templateParser(this.tooltipTemplate);this.spinnerTemplate?Object(p.createSpinner)({target:this.element,template:this.spinnerTemplate},this.createElement):Object(p.createSpinner)({target:this.element},this.createElement);t={dataSourceSettings:this.dataSourceSettings,pivotview:Object(r.isBlazor)()?void 0:this,fieldsType:{}};this.trigger("load",t,function(t){Object(r.isBlazor)()&&(t.dataSourceSettings.dataSource=n.dataSourceSettings.dataSource);n.dataSourceSettings=t.dataSourceSettings;n.fieldsType=t.fieldsType;n.updateClass();n.notify("init-groupingbar",{});n.notify("initial-load",{});n.isAdaptive&&n.contextMenuModule.render();n.notify("init-toolbar",{})});Object(r.isBlazor)()&&this.renderComplete()},t.prototype.addInternalEvents=function(){this.on("initial-load",this.generateData,this);this.on(ct,this.renderPivotGrid,this);this.on(st,this.onContentReady,this)},t.prototype.removeInternalEvents=function(){this.off("initial-load",this.generateData);this.off(ct,this.renderPivotGrid);this.off(st,this.onContentReady)},t.prototype.getPersistData=function(){return this.chartSettings.tooltipRender=void 0,this.addOnPersist(["dataSourceSettings","pivotValues","gridSettings","chartSettings","displayOption"])},t.prototype.loadPersistData=function(n){var t;Object(r.isBlazor)()?(t=n).dataSourceSettings.dataSource=this.dataSourceSettings.dataSource:t=JSON.parse(n);this.setProperties({gridSettings:t.gridSettings,pivotValues:t.pivotValues,chartSettings:t.chartSettings,displayOption:t.displayOption},!0);this.dataSourceSettings=t.dataSourceSettings},t.prototype.mergePersistPivotData=function(){var t,n;Object(r.isBlazor)()&&(t=this.dataSourceSettings.dataSource);n=window.localStorage.getItem(this.getModuleName()+this.element.id);Object(r.isNullOrUndefined)(n)||""===n||this.setProperties(JSON.parse(n),!0);this.dataSourceSettings.dataSource instanceof Object&&Object(r.isBlazor)()&&this.setProperties({dataSourceSettings:{dataSource:t}},!0)},t.prototype.showConditionalFormattingDialog=function(){this.conditionalFormattingModule&&this.conditionalFormattingModule.showConditionalFormattingDialog()},t.prototype.createCalculatedFieldDialog=function(){this.calculatedFieldModule&&this.calculatedFieldModule.createCalculatedFieldDialog()},t.prototype.getModuleName=function(){return"pivotview"},t.prototype.copy=function(n){this.grid.copy(n)},t.prototype.onPropertyChanged=function(t,i){for(var o,u=0,f=Object.keys(t);u<f.length;u++){o=f[u];switch(o){case"dataSourceSettings":case"hyperlinkSettings":case"allowDrillThrough":case"editSettings":case"allowDataCompression":if(t.dataSourceSettings&&1===Object.keys(t.dataSourceSettings).length&&t.dataSourceSettings.groupSettings&&"pivot"===this.dataType&&this.updateGroupingReport(t.dataSourceSettings.groupSettings,"Date"),t.dataSourceSettings&&1===Object.keys(t.dataSourceSettings).length&&"dataSource"===Object.keys(t.dataSourceSettings)[0])Object(r.isBlazor)()&&this.enableVirtualization||(this.engineModule.fieldList=null,this.refreshData());else if(e.isButtonIconRefesh(o,i,t)){if(this.showGroupingBar&&this.groupingBarModule&&this.axisFieldModule.render(),this.showFieldList&&this.pivotFieldListModule){var s=e.cloneFieldSettings(this.dataSourceSettings.rows),h=e.cloneFieldSettings(this.dataSourceSettings.columns),c=e.cloneFieldSettings(this.dataSourceSettings.values),l=e.cloneFieldSettings(this.dataSourceSettings.filters);this.pivotFieldListModule.setProperties({dataSourceSettings:{rows:s,columns:h,values:c,filters:l}},!0);this.pivotFieldListModule.axisFieldModule.render();this.pivotFieldListModule.treeViewModule.fieldTable&&!this.isAdaptive&&this.pivotFieldListModule.notify("tree-view-update",{})}}else this.notify("initial-load",{});break;case"height":case"width":this.layoutRefresh();break;case"pivotValues":case"displayOption":!this.showToolbar&&t.displayOption&&1===Object.keys(t.displayOption).length&&t.displayOption.view&&(this.currentView="Both"===t.displayOption.view?this.displayOption.primary:t.displayOption.view,(this.showGroupingBar||this.showFieldList)&&(this.showFieldList&&this.pivotFieldListModule&&this.pivotFieldListModule.destroy(),this.showGroupingBar&&this.groupingBarModule&&this.groupingBarModule.destroy(),this.notify("init-groupingbar",this)),this.grid||"Chart"===t.displayOption.view?this.chartModule||"Table"===this.displayOption.view||(this.chartModule=new di):(this.renderEmptyGrid(),"Table"===t.displayOption.view&&this.chartModule&&(this.chartModule.destroy(),this.chart=void 0,this.chartModule=void 0)));this.notify(ct,{});break;case"gridSettings":this.lastGridSettings=t.gridSettings;this.isCellBoxMultiSelection=this.gridSettings.allowSelection&&"Box"===this.gridSettings.selectionSettings.cellSelectionMode&&"Cell"===this.gridSettings.selectionSettings.mode&&"Multiple"===this.gridSettings.selectionSettings.type;this.allowGrouping&&this.groupingModule&&!this.isCellBoxMultiSelection&&(this.setProperties({gridSettings:{allowSelection:!0,selectionSettings:{cellSelectionMode:"Box",mode:"Cell",type:"Multiple"}}},!0),this.isCellBoxMultiSelection=!0);this.renderModule.updateGridSettings();break;case"chartSettings":this.showGroupingBar&&this.groupingBarModule&&-1!==Object.keys(t.chartSettings).indexOf("enableMultiAxis")&&this.groupingBarModule.renderLayout();this.chartModule.loadChart(this,this.chartSettings);this.notify(ft,this);break;case"locale":case"currencyCode":case"enableRtl":this.tooltip&&this.tooltip.destroy();n.prototype.refresh.call(this);this.updateClass();break;case"enableValueSorting":this.enableValueSorting=t.enableValueSorting;this.updateDataSource();break;case"showGroupingBar":this.element.querySelector(".e-grouping-bar")&&this.element.querySelector(".e-grouping-bar").remove();this.renderPivotGrid();break;case"groupingBarSettings":this.axisFieldModule.render();break;case"showTooltip":this.renderToolTip();break;case"toolbar":case"chartTypes":this.toolbarModule&&this.toolbarModule.refreshToolbar();break;case"aggregateTypes":this.showGroupingBar&&this.axisFieldModule&&this.axisFieldModule.render();this.showFieldList&&this.pivotFieldListModule&&this.pivotFieldListModule.axisFieldModule&&(this.pivotFieldListModule.setProperties({aggregateTypes:t.aggregateTypes},!0),this.pivotFieldListModule.axisFieldModule.render())}}},t.prototype.templateParser=function(n){if(n)try{if(document.querySelectorAll(n).length)return Object(r.compile)(document.querySelector(n).innerHTML.trim())}catch(t){return Object(r.compile)(n)}},t.prototype.getCellTemplate=function(){return this.cellTemplateFn},t.prototype.appendHtml=function(n,t){var i=document.createElement("div");return i.innerHTML=t,Object(r.isNullOrUndefined)(i.firstChild)||n.appendChild(i.firstChild),n},t.prototype.renderPivotGrid=function(){"Table"===this.currentView&&this.cellTemplate&&Object(r.isBlazor)()&&Object(r.resetBlazorTemplate)(this.element.id+"_cellTemplate","CellTemplate");this.chartModule&&(this.chartModule.engineModule=this.engineModule,this.chartModule.loadChart(this,this.chartSettings),this.enableRtl&&this.chart&&Object(r.addClass)([this.chart.element],"e-ltr"));(this.showFieldList||this.showGroupingBar||this.allowNumberFormatting||this.allowCalculatedField||this.toolbar||this.allowGrouping||this.gridSettings.contextMenuItems)&&(this.notify(ft,this),this.pivotFieldListModule&&this.allowDeferLayoutUpdate&&(this.pivotFieldListModule.clonedDataSource=Object(r.extend)({},this.dataSourceSettings,null,!0)));this.enableVirtualization&&(this.virtualscrollModule=new bi(this));(this.allowDrillThrough||this.editSettings.allowEditing)&&(this.drillThroughModule=new ki(this));"Chart"!==this.displayOption.view?(this.hyperlinkSettings&&(this.isRowCellHyperlink=!!this.hyperlinkSettings.showRowHeaderHyperlink||!!this.hyperlinkSettings.showHyperlink,this.isColumnCellHyperlink=!!this.hyperlinkSettings.showColumnHeaderHyperlink||!!this.hyperlinkSettings.showHyperlink,this.isValueCellHyperlink=!!this.hyperlinkSettings.showValueCellHyperlink||!!this.hyperlinkSettings.showHyperlink,this.isSummaryCellHyperlink=!!this.hyperlinkSettings.showSummaryCellHyperlink||!!this.hyperlinkSettings.showHyperlink,this.applyHyperlinkSettings()),this.renderModule=new vi(this),this.renderModule.render()):this.grid&&Object(r.remove)(this.grid.element);this.trigger("dataBound");this.allowConditionalFormatting&&this.applyFormatting(this.pivotValues);this.showToolbar&&"Both"===this.displayOption.view&&this.chart&&this.grid&&(this.showGroupingBar&&this.groupingBarModule&&this.element.querySelector(".e-grouping-bar")&&this.groupingBarModule.refreshUI(),this.toolbarModule&&this.toolbarModule.toolbar&&(this.toolbarModule.toolbar.width=this.getGridWidthAsNumber()-2),this.chart.element.style.width=Object(r.formatUnit)(this.getGridWidthAsNumber()),this.chart.width=Object(r.formatUnit)(this.getGridWidthAsNumber()),"Table"===this.currentView?(this.grid.element.style.display="",this.chart.element.style.display="none",this.chartSettings.enableMultiAxis&&this.chartSettings.showMultipleAxesScrollbar&&(this.element.querySelector(".e-pivotchart").style.display="none")):(this.grid.element.style.display="none",this.chart.element.style.display="",this.chartSettings.enableMultiAxis&&this.chartSettings.showMultipleAxesScrollbar&&(this.element.querySelector(".e-pivotchart").style.display="")));this.toolbarModule&&(this.showFieldList&&this.element.querySelector("#"+this.element.id+"_PivotFieldList")&&(this.element.querySelector("#"+this.element.id+"_PivotFieldList").style.display="none"),this.toolbarModule&&"New"!==this.toolbarModule.action&&"Load"!==this.toolbarModule.action&&"Remove"!==this.toolbarModule.action?this.isModified=!0:this.toolbarModule.action="")},t.prototype.showWaitingPopup=function(){this.grid&&this.grid.element&&!this.spinnerTemplate?Object(p.showSpinner)(this.grid.element):Object(p.showSpinner)(this.element)},t.prototype.hideWaitingPopup=function(){this.grid&&this.grid.element&&!this.spinnerTemplate?Object(p.hideSpinner)(this.grid.element):Object(p.hideSpinner)(this.element)},t.prototype.updateDataSource=function(){this.showWaitingPopup();var n=this,i=Object.keys(n.lastSortInfo).length>0,u=Object.keys(n.lastFilterInfo).length>0,f=Object.keys(n.lastAggregationInfo).length>0,t=Object.keys(n.lastCalcFieldInfo).length>0,o={dataSourceSettings:e.getClonedDataSourceSettings(n.dataSourceSettings)};n.trigger("enginePopulating",o,function(o){var s,h,l,c,a,v;if(n.enableVirtualization&&(i||u||f||t)||e.updateDataSourceSettings(n,o.dataSourceSettings),n.updatePageSettings(!1),"pivot"===n.dataType&&n.enableVirtualization&&(i||u||f||t)){if(s={},i){if(n.setProperties({dataSourceSettings:{valueSortSettings:{headerText:""}}},!0),Object(r.isBlazor)())h="ejsInterop",n.lastSortInfo.name,n.lastSortInfo.order,s={key:"onSort",arg:window[h].copyWithoutCircularReferences([n.lastSortInfo],n.lastSortInfo)};else n.engineModule.onSort(n.lastSortInfo);n.lastSortInfo={}}if(f){if(Object(r.isBlazor)())h="ejsInterop",s={key:"onAggregation",arg:window[h].copyWithoutCircularReferences([n.lastAggregationInfo],n.lastAggregationInfo)};else n.engineModule.onAggregation(n.lastAggregationInfo);n.lastAggregationInfo={}}if(t){if(Object(r.isBlazor)())l=window.ejsInterop.copyWithoutCircularReferences([n.dataSourceSettings.properties],n.dataSourceSettings.properties),s={key:"onCalcOperation",arg:{lastCalcFieldInfo:n.lastCalcFieldInfo,values:l.values,calculatedFieldSettings:l.calculatedFieldSettings}};else n.engineModule.onCalcOperation(n.lastCalcFieldInfo);n.lastCalcFieldInfo={}}if(u){if(Object(r.isBlazor)())s={key:"onFilter",arg:{lastFilterInfo:window.ejsInterop.copyWithoutCircularReferences([n.lastFilterInfo],n.lastFilterInfo),filterSettings:window.ejsInterop.copyWithoutCircularReferences([n.dataSourceSettings.filterSettings],n.dataSourceSettings.filterSettings)}};else n.engineModule.onFilter(n.lastFilterInfo,n.dataSourceSettings);n.lastFilterInfo={}}Object(r.isBlazor)()?n.interopAdaptor.invokeMethodAsync("PivotInteropMethod",s.key,s.arg).then(function(t){n.updateBlazorData(t,n);n.setProperties({pivotValues:n.engineModule.pivotValues},!0);n.enginePopulatedEventMethod("updateDataSource",n);n.calculatedFieldModule&&n.calculatedFieldModule.isRequireUpdate&&(n.calculatedFieldModule.endDialog(),n.calculatedFieldModule.isRequireUpdate=!1)}):(n.setProperties({pivotValues:n.engineModule.pivotValues},!0),n.enginePopulatedEventMethod("updateDataSource"))}else"olap"===n.dataType?(c={mode:"",savedFieldList:n.olapEngineModule.fieldList,savedFieldListData:n.olapEngineModule.fieldListData,pageSettings:n.pageSettings,enableValueSorting:n.enableValueSorting,isDrillThrough:n.allowDrillThrough||n.editSettings.allowEditing,localeObj:n.localeObj},t||i?(n.olapEngineModule.savedFieldList=n.olapEngineModule.fieldList,n.olapEngineModule.savedFieldListData=n.olapEngineModule.fieldListData,t?(n.olapEngineModule.updateCalcFields(n.dataSourceSettings,n.lastCalcFieldInfo),n.lastCalcFieldInfo={}):(n.olapEngineModule.onSort(n.dataSourceSettings),n.lastSortInfo={})):n.olapEngineModule.renderEngine(n.dataSourceSettings,c),n.setProperties({pivotValues:n.olapEngineModule.pivotValues},!0),n.enginePopulatedEventMethod("updateDataSource")):(c={mode:"",savedFieldList:n.engineModule.fieldList,pageSettings:n.pageSettings,enableValueSorting:n.enableValueSorting,isDrillThrough:n.allowDrillThrough||n.editSettings.allowEditing,localeObj:n.localeObj,fieldsType:n.fieldsType},Object(r.isBlazor)()&&n.enableVirtualization?(h="ejsInterop",a=window[h].copyWithoutCircularReferences([c],c),v=window[h].copyWithoutCircularReferences([n.dataSourceSettings],n.dataSourceSettings),n.interopAdaptor.invokeMethodAsync("PivotInteropMethod","renderEngine",{dataSourceSettings:v,customProperties:a}).then(function(t){n.updateBlazorData(t,n);n.setProperties({pivotValues:n.engineModule.pivotValues},!0);n.enginePopulatedEventMethod("updateDataSource",n)})):(n.engineModule.renderEngine(n.dataSourceSettings,c,n.getValueCellInfo.bind(n)),n.setProperties({pivotValues:n.engineModule.pivotValues},!0),n.enginePopulatedEventMethod("updateDataSource")))})},t.prototype.excelExport=function(n,t,i,r){this.enableVirtualization?this.excelExportModule.exportToExcel("Excel"):this.grid.excelExport(n,t,i,r)},t.prototype.csvExport=function(n,t,i,r){this.enableVirtualization?this.excelExportModule.exportToExcel("CSV"):this.grid.csvExport(n,t,i,r)},t.prototype.pdfExport=function(n,t,i,r){this.enableVirtualization?this.pdfExportModule.exportToPDF():this.grid.pdfExport(n,t,i,r)},t.prototype.chartExport=function(n,t,i,r,u){this.chart&&this.chart.enableExport&&this.chart.exportModule.export(n,t,i,null,r,u)},t.prototype.printChart=function(){this.chart&&this.chart.print()},t.prototype.onDrill=function(n,t){var w=this,f=this.dataSourceSettings.drilledMembers[0]&&this.dataSourceSettings.drilledMembers[0].delimiter?this.dataSourceSettings.drilledMembers[0].delimiter:"**",o="",h="",c="",l,a,u,y;if(t?(o=t.fieldName,h=t.cell.axis,c=t.isDrilled?"up":"down"):(o=n.parentElement.getAttribute("fieldname"),h=n.parentElement.classList.contains("e-rowsheader")?"row":"column",c=n.classList.contains(pt)?"up":"down"),"pivot"===this.dataType){var d=e.cloneDrillMemberSettings(this.dataSourceSettings.drilledMembers),b=t?t.cell:this.engineModule.pivotValues[Number(n.parentElement.getAttribute("index"))][Number(n.parentElement.getAttribute("aria-colindex"))],s=b.valueSort.levelName.split(this.engineModule.valueSortSettings.headerDelimiter).join(f),k=!1;if(0===this.dataSourceSettings.drilledMembers.length)this.setProperties({dataSourceSettings:{drilledMembers:[{name:o,items:[s],delimiter:f}]}},!0);else{for(l=e.cloneDrillMemberSettings(this.dataSourceSettings.drilledMembers),a=0;a<l.length;a++)u=l[a],(s=s.split(f).join(u.delimiter?u.delimiter:f),f=u.delimiter=u.delimiter?u.delimiter:f,u.name===o)&&(k=!0,y=u.items.indexOf(s),y>-1?u.items.splice(y,1):u.items.push(s));this.setProperties({dataSourceSettings:{drilledMembers:l}},!0);k||this.dataSourceSettings.drilledMembers.push({name:o,items:[s],delimiter:f})}this.showWaitingPopup();var i=this,v={fieldName:o,memberName:s,delimiter:f,axis:h,action:c,currentCell:b},p={drillInfo:v,pivotview:Object(r.isBlazor)()?void 0:i,cancel:!1};i.trigger("drill",p,function(n){if(n.cancel)w.hideWaitingPopup(),w.setProperties({dataSourceSettings:{drilledMembers:d}},!0);else{if(i.enableVirtualization)if(Object(r.isBlazor)()){var t=window.ejsInterop.copyWithoutCircularReferences([i.dataSourceSettings],i.dataSourceSettings),u=window.ejsInterop.copyWithoutCircularReferences([v],v);window.ejsInterop.copyWithoutCircularReferences([p],p);i.interopAdaptor.invokeMethodAsync("PivotInteropMethod","onDrill",{dataSourceSettings:t,drilledItem:u}).then(function(n){i.updateBlazorData(n,i);i.engineModule.drilledMembers=i.dataSourceSettings.drilledMembers;i.setProperties({pivotValues:i.engineModule.pivotValues},!0);i.renderPivotGrid()})}else i.engineModule.drilledMembers=i.dataSourceSettings.drilledMembers,i.engineModule.onDrill(v);else i.engineModule.generateGridData(i.dataSourceSettings);Object(r.isBlazor)()&&i.enableVirtualization||(i.setProperties({pivotValues:i.engineModule.pivotValues},!0),i.renderPivotGrid())}})}else this.onOlapDrill(o,h,c,f,n,t)},t.prototype.onOlapDrill=function(n,t,i,u,f,o){var s=this,et=e.cloneDrillMemberSettings(this.dataSourceSettings.drilledMembers),a=o?o.cell:this.olapEngineModule.pivotValues[Number(f.parentElement.getAttribute("index"))][Number(f.parentElement.getAttribute("aria-colindex"))],b="row"===t?this.olapEngineModule.tupRowInfo[a.ordinal]:this.olapEngineModule.tupColumnInfo[a.ordinal],l={axis:t,action:i,fieldName:n,delimiter:"~~",memberName:b.uNameCollection,currentCell:a},y,p,g,tt,it,w,v;if(this.showWaitingPopup(),y={drillInfo:l,pivotview:Object(r.isBlazor)()?void 0:this,cancel:!1},p=b.drillInfo.map(function(n){return n.hierarchy}).indexOf(a.hierarchy.toString()),l&&"down"===l.action){this.olapEngineModule.drilledSets[a.actualText]=b.members[p];for(var k=l.memberName.split("::[").map(function(n){return"["===n[0]?n:"["+n}),h="",d=0;d<=p;d++)g=(tt=k[d]).split("~~"),h=h+(""!==h?"~~":"")+g[g.length-1];l.memberName=h;for(var c=[],nt=0,ot=this.dataSourceSettings.drilledMembers;nt<ot.length;nt++)(tt=ot[nt]).name===l.fieldName&&c.push(tt);c.length>0?(c[0].delimiter&&(h=h.replace(/~~/g,c[0].delimiter)),-1===e.inArray(h,c[0].items)&&c[0].items.push(h)):(it={name:l.fieldName,items:[h],delimiter:"~~"},this.dataSourceSettings.drilledMembers?this.dataSourceSettings.drilledMembers.push(it):this.dataSourceSettings.drilledMembers=[it]);y.drillInfo.memberName=h;this.trigger("drill",y,function(n){n.cancel?(s.hideWaitingPopup(),s.setProperties({dataSourceSettings:{drilledMembers:et}},!0)):(s.olapEngineModule.updateDrilledInfo(s.dataSourceSettings),s.setProperties({pivotValues:s.olapEngineModule.pivotValues},!0),s.renderPivotGrid())})}else{delete this.olapEngineModule.drilledSets[a.actualText];for(var st=this.olapEngineModule.getDrilledSets(l.memberName,a,p,t),rt=0,ht=Object.keys(st);rt<ht.length;rt++)for(var ct=st[ht[rt]],ut=0,vt=this.dataSourceSettings.drilledMembers.length;ut<vt;ut++){for(h=ct,(c=this.dataSourceSettings.drilledMembers[ut]).delimiter&&(h=ct.replace(/~~/g,c.delimiter)),w=[],v=0;v<c.items.length;v++)0!==c.items[v].indexOf(h)&&(w[w.length]=c.items[v]);c.items=w}for(var lt=[],ft=0,at=this.dataSourceSettings.drilledMembers;ft<at.length;ft++)(k=at[ft]).items.length>0&&lt.push(k);this.trigger("drill",y,function(n){n.cancel?(s.hideWaitingPopup(),s.setProperties({dataSourceSettings:{drilledMembers:et}},!0)):(s.setProperties({dataSourceSettings:{drilledMembers:lt}},!0),s.olapEngineModule.updateDrilledInfo(s.dataSourceSettings),s.setProperties({pivotValues:s.olapEngineModule.pivotValues},!0),s.renderPivotGrid())})}},t.prototype.onContentReady=function(){var o,a,f,u,c,s,l,e;if("Table"!==this.currentView&&this.cellTemplate&&Object(r.isBlazor)()&&Object(r.resetBlazorTemplate)(this.element.id+"_cellTemplate","CellTemplate"),this.isPopupClicked=!1,this.showFieldList?Object(p.hideSpinner)(this.pivotFieldListModule.fieldListSpinnerElement):this.fieldListSpinnerElement&&Object(p.hideSpinner)(this.fieldListSpinnerElement),this.isEmptyGrid?this.isEmptyGrid=!1:(this.hideWaitingPopup(),this.trigger("dataBound")),this.grid){if(o="pivot"===this.dataType?this.engineModule:this.olapEngineModule,this.enableVirtualization&&o){this.element.querySelector(".e-movablecontent")&&!this.element.querySelector(".e-movablecontent").querySelector(".e-virtualtrack")&&(this.virtualDiv=Object(r.createElement)("div",{className:"e-virtualtrack"}),this.element.querySelector(".e-movablecontent").appendChild(this.virtualDiv));this.element.querySelector(".e-movableheader")&&!this.element.querySelector(".e-movableheader").querySelector(".e-virtualtrack")?(this.virtualHeaderDiv=Object(r.createElement)("div",{className:"e-virtualtrack"}),this.element.querySelector(".e-movableheader").appendChild(this.virtualHeaderDiv)):this.virtualHeaderDiv=this.element.querySelector(".e-movableheader").querySelector(".e-virtualtrack");a=this.element.querySelector(".e-movablecontent").querySelector(".e-table");f=this.gridSettings.rowHeight*o.rowCount+.1-a.clientHeight;f>this.scrollerBrowserLimit&&(this.verticalScrollScale=f/this.scrollerBrowserLimit,f=this.scrollerBrowserLimit);u=this.gridSettings.columnWidth*o.columnCount-this.grid.columns[0].width;u>this.scrollerBrowserLimit&&(this.horizontalScrollScale=u/this.scrollerBrowserLimit,u=this.scrollerBrowserLimit);Object(r.setStyleAttribute)(this.virtualDiv,{height:(f>.1?f:.1)+"px",width:(u>.1?u:.1)+"px"});Object(r.setStyleAttribute)(this.virtualHeaderDiv,{height:0,width:(u>.1?u:.1)+"px"});var i=this.element.querySelector(".e-movablecontent"),w=this.element.querySelector(".e-frozencontent"),b=this.element.querySelector(".e-movableheader"),v=i.scrollTop>this.scrollerBrowserLimit?i.querySelector("."+bt).style.transform.split(",")[1].trim():-(i.scrollTop*this.verticalScrollScale-this.scrollPosObject.verticalSection-i.scrollTop)+"px)",y=i.scrollLeft>this.scrollerBrowserLimit?i.querySelector("."+bt).style.transform.split(",")[0].trim()+",":"translate("+-(i.scrollLeft*this.horizontalScrollScale-this.scrollPosObject.horizontalSection-i.scrollLeft)+"px,";Object(r.setStyleAttribute)(w.querySelector(".e-table"),{transform:"translate(0px,"+v});Object(r.setStyleAttribute)(i.querySelector(".e-table"),{transform:y+v});Object(r.setStyleAttribute)(b.querySelector(".e-table"),{transform:y+0+"px)"})}this.showGroupingBar?(this.element.style.minWidth="400px",this.grid.element.style.minWidth="400px"):(this.element.style.minWidth="310px",this.grid.element.style.minWidth="310px")}if((this.unwireEvents(),this.wireEvents(),this.isChartLoaded=!1,this.cellTemplate&&Object(r.isBlazor)())&&(c=Object.keys(this.gridCellCollection),c.length>0)){for(s=0,l=c;s<l.length;s++){var k=l[s],n={},h=this.gridCellCollection[k],d=Number(h.getAttribute("aria-colindex")),g=Number(h.getAttribute("index")),t=this.pivotValues[g][d];n.axis=t.axis;"column"===n.axis||"row"===n.axis?(n.fieldName=t.valueSort.axis,n.formattedText=t.formattedText):(n.fieldName=t.actualText,n.formattedText=t.formattedText,n.value=t.value);n.rowHeaders=t.rowHeaders;n.columnHeaders=t.columnHeaders;n.rowIndex=t.rowIndex;n.columnIndex=t.colIndex;n.isGrandTotal=t.isGrandSum;n.isTotal=t.isSum;n.rowSpan=t.rowSpan;n.columnSpan=t.colSpan;n.isDrilled=t.isDrilled;n.hasChild=t.hasChild;n.valueSortInfo=t.valueSort;e=this.getCellTemplate()(n,this,"cellTemplate",this.element.id+"_cellTemplate");e&&""!==e&&e.length>0&&(this.enableHtmlSanitizer?this.appendHtml(h,r.SanitizeHtmlHelper.sanitize(e[0].outerHTML)):this.appendHtml(h,e[0].outerHTML))}Object(r.updateBlazorTemplate)(this.element.id+"_cellTemplate","CellTemplate",this)}},t.prototype.setToolTip=function(n){var f,e,u=Number(n.target.getAttribute("aria-colindex")),i=Number(n.target.getAttribute("index")),t=this.pivotValues&&this.pivotValues[i]&&this.pivotValues[i][u]?this.pivotValues[i][u]:void 0,r,o,l;if(this.tooltip.content="",o=!1,t&&"olap"===this.dataType?this.olapEngineModule.fieldList[t.actualText]&&(f=(r=this.olapEngineModule.fieldList[t.actualText]).isCalculatedField?r.type:r.aggregateType,e=r.caption,o=!0):t&&this.engineModule.fieldList[t.actualText]&&(f=(r=this.engineModule.fieldList[t.actualText]).aggregateType,e=r.caption,o=!0),t&&o){var s=this.getRowText(i,0),h=this.getColText(0,u,i),c="0"===t.formattedText||""===t.formattedText?this.localeObj.getConstant("noValue"):t.formattedText;this.tooltipTemplate&&void 0!==this.getTooltipTemplate()?(l={rowHeaders:s,columnHeaders:h,aggregateType:f,valueField:e,value:c,rowFields:this.getHeaderField(i,u,"row"),columnFields:this.getHeaderField(i,u,"column")},this.tooltip.content=this.getTooltipTemplate()(l,this,"tooltipTemplate",this.element.id+"tooltipTemplate")[0].outerHTML):this.tooltip.content="<div class=e-pivottooltip><p class=e-tooltipheader>"+this.localeObj.getConstant("row")+":<\/p><p class=e-tooltipcontent>"+s+"<\/p><\/br><p class=e-tooltipheader>"+this.localeObj.getConstant("column")+":<\/p><p class=e-tooltipcontent>"+h+"<\/p><\/br>"+(""!==t.actualText?"<p class=e-tooltipheader>"+("olap"===this.dataType?"":this.localeObj.getConstant(f)+" "+this.localeObj.getConstant("of")+" ")+e+":<\/p><p class=e-tooltipcontent>"+c+"<\/p><\/div>":"")}else n.cancel=!0},t.prototype.getTooltipTemplate=function(){return this.tooltipTemplateFn},t.prototype.getHeaderField=function(n,t,i){var e,o="",r="olap"===this.dataType?this.olapEngineModule:this.engineModule,s=r.valueSortSettings.headerDelimiter,u,h,f;if("row"===i)for(e=this.pivotValues[n][0].valueSort.levelName.toString().split(s).length,u=0;u<e&&r.rows.length>0&&r.rows[u];u++)o+=(u?" - ":"")+(r.rows[u].caption?r.rows[u].caption:r.rows[u].name);else for(r.columns.length>0&&(h=0===r.values.length?0:Number(Object.keys(r.headerContent)[Object.keys(r.headerContent).length-1]),e=this.pivotValues[h][t].valueSort.levelName.toString().split(s).length,e=r.values.length>1?e-1:e),f=0;f<e&&r.columns.length>0&&r.columns[f];f++)o+=(f?" - ":"")+(r.columns[f].caption?r.columns[f].caption:r.columns[f].name);return o},t.prototype.getRowText=function(n,t){for(var i=this.pivotValues[n][t],r=i.level,u="grand sum"===i.type?this.localeObj.getConstant("grandTotal"):i.formattedText;r>0||void 0===i.index;)n--,void 0!==(i=this.pivotValues[n][t]).index&&r>i.level&&(u=u+" - "+i.formattedText,r-=1);return u.split(" - ").reverse().join(" - ")},t.prototype.getColText=function(n,t,i){for(var r=this.pivotValues[0][t],u=r.axis,f="grand sum"===r.type?this.localeObj.getConstant("grandTotal"):r.formattedText;"value"!==u&&i>n;)n++,this.pivotValues[n]&&(u=(r=this.pivotValues[n][t]).axis,"sum"!==r.type&&"grand sum"!==r.type&&"value"!==u&&(f=f+" - "+r.formattedText));return f},t.prototype.updateClass=function(){this.enableRtl?Object(r.addClass)([this.element],et):Object(r.removeClass)([this.element],et);this.isAdaptive?Object(r.addClass)([this.element],vt):Object(r.removeClass)([this.element],vt)},t.prototype.mouseRclickHandler=function(n){(3===n.which||0===n.which)&&(this.lastCellClicked=n.target);this.lastCellClicked=n.target},t.prototype.mouseDownHandler=function(n){if(3===n.which&&(this.lastCellClicked=n.target),this.isCellBoxMultiSelection){this.isMouseDown=!0;this.isMouseUp=!1;var t=this.parentAt(n.target,"TH");this.clearSelection(t,n,Number(t.getAttribute("aria-colindex")),Number(t.getAttribute("index")));this.lastSelectedElement=void 0}},t.prototype.mouseMoveHandler=function(n){if(this.isCellBoxMultiSelection&&(n.preventDefault(),this.isMouseDown&&n.target)){var i=n.target,t=this.parentAt(i,"TH");this.lastSelectedElement&&this.lastSelectedElement!==t&&t.classList.contains(k)?(this.lastSelectedElement.classList.remove("e-active"),this.lastSelectedElement.classList.remove(k),this.lastSelectedElement=t):(this.lastSelectedElement=t,t.classList.add("e-active"),t.classList.add(k));this.renderModule.selected()}},t.prototype.mouseUpHandler=function(){this.isCellBoxMultiSelection&&(this.isMouseDown=!1,this.isMouseUp=!0)},t.prototype.parentAt=function(n,t){for(;n.tagName!==t&&n.parentElement;)n=n.parentElement;return n},t.prototype.mouseClickHandler=function(n){var i,u,e,f,t,o,s,h;if((3===n.which||0===n.which)&&(this.lastCellClicked=n.target),i=n.target,(i.classList.contains("e-headercell")||i.classList.contains("e-headercelldiv")||i.classList.contains("e-rowsheader")||i.classList.contains("e-rowcell")||i.classList.contains("e-stackedheadercelldiv")||i.classList.contains("e-headertext")||i.classList.contains("e-ascending")||i.classList.contains("e-descending"))&&this.enableValueSorting&&"pivot"===this.dataType){if(u=null,i.classList.contains("e-headercell")||i.classList.contains("e-rowsheader")||i.classList.contains("e-rowcell")?u=i:i.classList.contains("e-stackedheadercelldiv")||i.classList.contains("e-headercelldiv")||i.classList.contains("e-ascending")||i.classList.contains("e-descending")?u=i.parentElement:i.classList.contains("e-headertext")&&(u=i.parentElement.parentElement),this.CellClicked(i,n),u.parentElement.parentElement.parentElement.parentElement.classList.contains("e-movableheader")&&"column"===this.dataSourceSettings.valueAxis||u.parentElement.classList.contains("e-row")&&"row"===this.dataSourceSettings.valueAxis&&(u.classList.contains("e-rowsheader")||u.classList.contains("e-stot"))){if(e=Number(u.getAttribute("aria-colindex")),f=Number(u.getAttribute("index")),"row"===this.dataSourceSettings.valueAxis&&(this.dataSourceSettings.values.length>1||this.dataSourceSettings.alwaysShowValueHeader)?f="value"===this.pivotValues[f][e].type?f:f+1:"column"===this.dataSourceSettings.valueAxis&&(this.dataSourceSettings.values.length>1||this.dataSourceSettings.alwaysShowValueHeader)&&(e=Number(u.getAttribute("aria-colindex"))+Number(u.getAttribute("aria-colspan"))-1,f=this.engineModule.headerContent.length-1),this.setProperties({dataSourceSettings:{valueSortSettings:{columnIndex:Number(u.getAttribute("aria-colindex"))+Number(u.getAttribute("aria-colspan"))-1,sortOrder:"Descending"===this.dataSourceSettings.valueSortSettings.sortOrder?"Ascending":"Descending",headerText:this.pivotValues[f][e].valueSort.levelName,headerDelimiter:this.dataSourceSettings.valueSortSettings.headerDelimiter?this.dataSourceSettings.valueSortSettings.headerDelimiter:"."}}},!0),this.showWaitingPopup(),t=this,t.engineModule.enableValueSorting=!0,t.enableVirtualization){if(t.dataSourceSettings.enableSorting){for(o=0,s=Object.keys(t.engineModule.fieldList);o<s.length;o++)h=s[o],t.engineModule.fieldList[h].sort="Ascending";t.setProperties({dataSourceSettings:{sortSettings:[]}},!0)}Object(r.isBlazor)()?t.interopAdaptor.invokeMethodAsync("PivotInteropMethod","applyValueSorting",{valueSortSettings:t.dataSourceSettings.valueSortSettings.properties}).then(function(n){t.updateBlazorData(n,t);t.setProperties({pivotValues:t.engineModule.pivotValues},!0);t.renderPivotGrid()}):(t.engineModule.rMembers=t.engineModule.headerCollection.rowHeaders,t.engineModule.cMembers=t.engineModule.headerCollection.columnHeaders,t.engineModule.applyValueSorting(),t.engineModule.updateEngine())}else t.engineModule.generateGridData(t.dataSourceSettings);Object(r.isBlazor)()&&t.enableVirtualization||(t.setProperties({pivotValues:t.engineModule.pivotValues},!0),t.renderPivotGrid())}}else{if(!i.classList.contains(pt)&&!i.classList.contains(wt))return void this.CellClicked(i,n);this.onDrill(i)}},t.prototype.framePivotColumns=function(n){for(var t,u,f,i=0,r=n;i<r.length;i++)t=r[i],t.columns&&t.columns.length>0?this.framePivotColumns(t.columns):(u="0.formattedText"===t.field?"":t.customAttributes?t.customAttributes.cell.valueSort.levelName:"",f=this.renderModule.setSavedWidth("0.formattedText"===t.field?t.field:u,Number("auto"===t.width?t.minWidth:t.width)),this.pivotColumns.push({allowReordering:t.allowReordering,allowResizing:t.allowResizing,headerText:u,width:f}),this.totColWidth=this.totColWidth+Number(f))},t.prototype.setGridColumns=function(n){var i,r,t,f,u;if(this.element.offsetWidth<this.totColWidth){for(i=0,r=n;i<r.length;i++)t=r[i],t.columns&&t.columns.length>0?this.setGridColumns(t.columns):(f="0.formattedText"===t.field?"":t.customAttributes?t.customAttributes.cell.valueSort.levelName:"",t.allowReordering=this.pivotColumns[this.posCount].allowReordering,t.allowResizing=this.pivotColumns[this.posCount].allowResizing,u=this.renderModule.setSavedWidth("0.formattedText"===t.field?t.field:f,Number(this.pivotColumns[this.posCount].width)),"auto"!==t.width?t.width=u:t.minWidth=u,this.posCount++,t.allowReordering&&(this.gridSettings.allowReordering=!0),t.allowResizing&&(this.gridSettings.allowResizing=!0));this.gridSettings.allowReordering&&c.Grid.Inject(c.Reorder);this.gridSettings.allowResizing&&c.Grid.Inject(c.Resize)}},t.prototype.fillGridColumns=function(n){for(var t,i=0,r=n;i<r.length;i++)t=r[i],t.allowReordering=this.gridSettings.allowReordering,t.allowResizing=this.gridSettings.allowResizing,this.posCount++,t.columns&&t.columns.length>0&&this.fillGridColumns(t.columns)},t.prototype.triggerColumnRenderEvent=function(n){this.pivotColumns=[];this.totColWidth=0;this.framePivotColumns(n);var t=this.pivotColumns[0].width,i={columns:this.pivotColumns,dataSourceSettings:this.dataSourceSettings};this.trigger("beforeColumnsRender",i);t!==this.pivotColumns[0].width&&this.element.offsetWidth<this.totColWidth&&(this.firstColWidth=this.pivotColumns[0].width);this.posCount=0;this.setGridColumns(n)},t.prototype.setCommonColumnsWidth=function(n,t){for(var i,r=0,u=n;r<u.length;r++)i=u[r],"0.formattedText"!==i.field?i.columns?this.setCommonColumnsWidth(i.columns,t):"auto"!==i.width?i.width=t:i.minWidth=t:i.width=this.firstColWidth?this.firstColWidth:i.width},t.prototype.getHeightAsNumber=function(){var n;return isNaN(this.height)?this.height.toString().indexOf("%")>-1?n=parseFloat(this.height.toString())/100*this.element.offsetHeight:this.height.toString().indexOf("px")>-1&&(n=Number(this.height.toString().split("px")[0])):n=Number(this.height),n<this.gridSettings.rowHeight&&(n=this.gridSettings.rowHeight),n},t.prototype.getWidthAsNumber=function(){var n;return isNaN(this.width)?(this.width.toString().indexOf("%")>-1?n=parseFloat(this.width.toString())/100*this.element.offsetWidth:this.width.toString().indexOf("px")>-1&&(n=Number(this.width.toString().split("px")[0])),isNaN(n)&&(n=this.element.offsetWidth)):n=Number(this.width),n<400&&(n=400),n},t.prototype.getGridWidthAsNumber=function(){var n;return isNaN(this.grid.width)?(this.grid.width.toString().indexOf("%")>-1?n=parseFloat(this.grid.width.toString())/100*this.element.offsetWidth:this.grid.width.toString().indexOf("px")>-1&&(n=Number(this.grid.width.toString().split("px")[0])),isNaN(n)&&(n=this.element.offsetWidth)):n=Number(this.grid.width),n},t.prototype.onWindowResize=function(){clearTimeout(this.timeOutObj);this.timeOutObj=setTimeout(this.layoutRefresh.bind(this),500)},t.prototype.refresh=function(){Object(r.isBlazor)()?this.layoutRefresh():this.pivotRefresh()},t.prototype.layoutRefresh=function(){if(this.element&&this.element.classList.contains("e-pivotview")&&("olap"===this.dataType?this.olapEngineModule&&this.olapEngineModule.pivotValues:this.engineModule&&this.engineModule.pivotValues)){if(this.grid){var n="olap"===this.dataType&&this.olapEngineModule.pivotValues.length>0?this.olapEngineModule.pivotValues[0].length:this.dataSourceSettings.values.length>0&&this.engineModule.pivotValues.length>0?this.engineModule.pivotValues[0].length:2,t=this.renderModule.resizeColWidth(n);this.grid.width=this.renderModule.calculateGridWidth();this.renderModule.calculateGridHeight(!0);this.setCommonColumnsWidth(this.grid.columns,t);this.posCount=0;this.showGroupingBar||this.setGridColumns(this.grid.columns);"Table"===this.currentView&&this.cellTemplate&&Object(r.isBlazor)()&&Object(r.resetBlazorTemplate)(this.element.id+"_cellTemplate","CellTemplate");this.grid.refreshColumns();this.showGroupingBar&&this.groupingBarModule&&this.element.querySelector(".e-grouping-bar")&&this.groupingBarModule.setGridRowWidth()}this.showToolbar&&this.toolbarModule&&this.toolbarModule.toolbar&&(this.toolbarModule.toolbar.width=this.grid?this.getGridWidthAsNumber()-2:this.getWidthAsNumber()-2);this.chart&&(this.showToolbar&&"Chart"===this.currentView||!this.showToolbar)&&(this.chart.width=this.showToolbar&&this.grid?this.getGridWidthAsNumber().toString():this.getWidthAsNumber().toString(),"Chart"===this.displayOption.view&&this.showGroupingBar&&this.groupingBarModule&&this.element.querySelector(".e-chart-grouping-bar")&&this.groupingBarModule.refreshUI())}},t.prototype.CellClicked=function(n,t){var i=this,r=null;if(n.classList.contains("e-headercell")||n.classList.contains("e-rowcell")?r=n:n.classList.contains("e-stackedheadercelldiv")||n.classList.contains("e-cellvalue")||n.classList.contains("e-headercelldiv")?r=n.parentElement:n.classList.contains("e-headertext")?r=n.parentElement.parentElement:n.classList.contains("e-rowselect")&&(this.isPopupClicked=n.classList.contains("e-spanclicked")?!1:!0),r){var f=Number(r.getAttribute("aria-colindex")),u=Number(r.getAttribute("index")),e=Number(r.getAttribute("aria-colspan")),o={cancel:!1,isCellClick:!0,currentCell:r,data:this.pivotValues[u][f]};this.trigger("cellSelecting",o,function(n){i.gridSettings.allowSelection&&(("Both"===i.gridSettings.selectionSettings.mode?r.classList.contains("e-rowcell"):"Row"===i.gridSettings.selectionSettings.mode)?i.clearSelection(r,t,f,u):(i.clearSelection(r,t,f,u),n.cancel||i.applyColumnSelection(t,r,f,f+(e>0?e-1:0),u)),"Column"===i.gridSettings.selectionSettings.mode||r.classList.contains("e-columnsheader")||i.rowDeselect(r,t,u,i.gridSettings.selectionSettings.mode,n),"Multiple"!==i.gridSettings.selectionSettings.type||"Row"!==i.gridSettings.selectionSettings.mode&&"Both"!==i.gridSettings.selectionSettings.mode||i.applyRowSelection(0,u,t));i.cellClick&&n.isCellClick&&i.trigger("cellClick",{currentCell:r,data:i.pivotValues[u][f]});i.getSelectedCellsPos()})}},t.prototype.rowDeselect=function(n,t,i,u,f){if((t.shiftKey||t.ctrlKey)&&"Single"!==this.gridSettings.selectionSettings.type)(t.shiftKey||t.ctrlKey)&&f.cancel&&(Object(r.removeClass)(this.element.querySelectorAll("."+d),d),Object(r.removeClass)(this.element.querySelectorAll("."+k),k),Object(r.removeClass)(this.element.querySelectorAll(".e-active"),"e-active"),this.setSavedSelectedCells());else if(Object(r.removeClass)(this.element.querySelectorAll("."+d),d),Object(r.removeClass)(this.element.querySelectorAll("."+k),k),Object(r.removeClass)(this.element.querySelectorAll(".e-active"),"e-active"),f.cancel)this.setSavedSelectedCells();else if("Cell"===u)Object(r.addClass)([n],[d]);else if("Row"===u||"Both"===u||"Single"===this.gridSettings.selectionSettings.type){var e='[index="'+i+'"]';Object(r.addClass)(this.element.querySelectorAll(e),[k,"e-active"]);n.classList.add(d)}},t.prototype.clearSelection=function(n,t,i,u){var f,e,o;if(!t.shiftKey&&!t.ctrlKey||"Single"===this.gridSettings.selectionSettings.type)if("Cell"===this.gridSettings.selectionSettings.mode)n.classList.contains("e-columnsheader")?Object(r.removeClass)(this.element.querySelectorAll(".e-rowcell."+d),d):Object(r.removeClass)(this.element.querySelectorAll(".e-columnsheader.e-active"),["e-active",k]);else if("Both"===this.gridSettings.selectionSettings.mode)if(n.classList.contains("e-rowcell"))for(f=0,e=[].slice.call(this.element.querySelectorAll("."+k));f<e.length;f++)o=e[f],Number(o.getAttribute("index"))!==u&&Object(r.removeClass)([o],["e-active",k]);else Object(r.removeClass)(this.element.querySelectorAll("."+d),d)},t.prototype.applyRowSelection=function(n,t,i){var r=this.engineModule.pivotValues[t][n],f,u;if(!i.ctrlKey&&!i.shiftKey&&r&&r.members&&r.members.length>0){f=r.level;u=t;do u++,r=this.engineModule.pivotValues[u][n];while(r&&f<r.level);this.isAdaptive?this.rowRangeSelection={enable:!0,startIndex:t-this.renderModule.rowStartPos,endIndex:u-(1+this.renderModule.rowStartPos)}:this.grid.selectionModule.selectRowsByRange(t-this.renderModule.rowStartPos,u-(1+this.renderModule.rowStartPos))}},t.prototype.applyColumnSelection=function(n,t,i,u,f){var o,h,w,e,b,g,c,nt,l;if(!t.classList.contains("e-rowsheader")&&("Cell"!==this.gridSettings.selectionSettings.mode||t.classList.contains("e-columnsheader"))){o=n.ctrlKey;this.isAdaptive&&"Multiple"===this.gridSettings.selectionSettings.type&&(this.grid.selectionModule.showPopup(n),this.isPopupClicked?(this.element.querySelector(".e-rowselect").classList.add("e-spanclicked"),o=!0):(this.element.querySelector(".e-rowselect").classList.remove("e-spanclicked"),o=!1));for(var it=[],a=this.gridSettings.selectionSettings.type,v=t.classList.contains("e-active"),s=[],y={},p=i;p<=u;p++)s.push(p.toString());if(o&&"Single"!==a)v=!1;else{for(h=0,w=[].slice.call(this.element.querySelectorAll(".e-active"));h<w.length;h++)e=w[h],Object(r.removeClass)([e],["e-active",k]),-1===s.indexOf(e.getAttribute("aria-colindex"))&&(v=!1),b=Number(e.getAttribute("aria-colindex")),y[b]=b;s=Object.keys(y).length>0?Object.keys(y).sort(function(n,t){return n-t}):s}if("Multiple"===a&&n.shiftKey?(this.shiftLockedPos=0===this.shiftLockedPos.length?s:this.shiftLockedPos,Number(this.shiftLockedPos[0])<=i?i=Number(this.shiftLockedPos[0]):u=u<Number(this.shiftLockedPos[this.shiftLockedPos.length-1])?Number(this.shiftLockedPos[this.shiftLockedPos.length-1]):u):this.shiftLockedPos=[],g=[],n.ctrlKey&&"Both"===this.gridSettings.selectionSettings.mode&&"Multiple"===a&&!t.classList.contains("e-rowsheader"))for(c=0,nt=[].slice.call(this.element.querySelectorAll(".e-rowsheader."+d));c<nt.length;c++)e=nt[c],g.push(e.getAttribute("index"));for(l=i;l<=u;)it.push('[aria-colindex="'+l+'"]'+("Cell"===this.gridSettings.selectionSettings.mode?'[index="'+f+'"]':"")),l++;if(!v){f=t.classList.contains("e-headercell")?f:this.renderModule.rowStartPos-1;for(var ut=t.classList.contains("e-active"),tt=0,rt=[].slice.call(this.element.querySelectorAll(it.toString()));tt<rt.length;tt++)e=rt[tt],Number(e.getAttribute("index"))>=f&&(ut&&o&&-1===g.indexOf(e.getAttribute("index"))?Object(r.removeClass)([e],["e-active",k]):Object(r.addClass)([e],["e-active",k]))}this.renderModule.selected()}},t.prototype.getSelectedCellsPos=function(){var t,r,n,i,u;for(this.savedSelectedCellsPos=[],this.cellSelectionPos=[],t=0,r=[].slice.call(this.element.querySelectorAll("."+k));t<r.length;t++)n=r[t],this.savedSelectedCellsPos.push({rowIndex:n.getAttribute("index"),colIndex:n.getAttribute("aria-colindex")});for(i=0,u=[].slice.call(this.element.querySelectorAll("."+d));i<u.length;i++)n=u[i],this.cellSelectionPos.push({rowIndex:n.getAttribute("index"),colIndex:n.getAttribute("aria-colindex")})},t.prototype.setSavedSelectedCells=function(){for(var t,i,e,u,n=0,f=[].slice.call(this.savedSelectedCellsPos);n<f.length;n++)t='[aria-colindex="'+(u=f[n]).colIndex+'"][index="'+u.rowIndex+'"]',Object(r.addClass)([this.element.querySelector(t)],["e-active",k]);for(i=0,e=[].slice.call(this.cellSelectionPos);i<e.length;i++)t='[aria-colindex="'+(u=e[i]).colIndex+'"][index="'+u.rowIndex+'"]',Object(r.addClass)([this.element.querySelector(t)],[d])},t.prototype.renderEmptyGrid=function(){var n=this;this.isEmptyGrid=!0;this.renderModule=new vi(this);this.grid&&this.grid.element&&this.element.querySelector(".e-grid")?(this.grid.setProperties({columns:this.renderModule.frameEmptyColumns(),dataSource:this.renderModule.frameEmptyData()},!0),this.grid.notify("datasource-modified",{}),this.grid.refreshColumns()):(this.element.querySelector(".e-grid")&&Object(r.remove)(this.element.querySelector(".e-grid")),this.renderModule.bindGrid(this,!0),this.grid.showSpinner=function(){},this.grid.hideSpinner=function(){},this.element.appendChild(Object(r.createElement)("div",{id:this.element.id+"_grid"})),this.grid.isStringTemplate=!0,this.grid.appendTo("#"+this.element.id+"_grid"),this.grid.off("data-ready",this.grid.dataReady),this.grid.on("data-ready",function(){n.grid.scrollModule.setWidth();n.grid.scrollModule.setHeight();n.grid.element.querySelector(".e-movablecontent").style.overflowY="auto"}))},t.prototype.initEngine=function(){var n=this,t={dataSourceSettings:e.getClonedDataSourceSettings(this.dataSourceSettings)};this.trigger("enginePopulating",t,function(t){var u,f;if(e.updateDataSourceSettings(n,t.dataSourceSettings),n.updatePageSettings(!1),u={mode:"",savedFieldList:void 0,pageSettings:n.pageSettings,enableValueSorting:n.enableValueSorting,isDrillThrough:n.allowDrillThrough||n.editSettings.allowEditing,localeObj:n.localeObj,fieldsType:n.fieldsType},"pivot"===n.dataType)if(n.dataSourceSettings.groupSettings&&n.dataSourceSettings.groupSettings.length>0&&(f=n.engineModule.data,n.clonedDataSet=n.clonedDataSet?n.clonedDataSet:e.getClonedData(f),Object(r.isBlazor)()?n.clonedReport=n.clonedReport?n.clonedReport:Object(r.extend)({},n.dataSourceSettings,null,!0):(n.setProperties({dataSourceSettings:{dataSource:[]}},!0),n.clonedReport=n.clonedReport?n.clonedReport:Object(r.extend)({},n.dataSourceSettings,null,!0),n.setProperties({dataSourceSettings:{dataSource:f}},!0))),Object(r.isBlazor)()&&n.enableVirtualization){var i=n,o=window.ejsInterop.copyWithoutCircularReferences([u],u),s=window.ejsInterop.copyWithoutCircularReferences([i.dataSourceSettings],i.dataSourceSettings);i.interopAdaptor.invokeMethodAsync("PivotInteropMethod","renderEngine",{dataSourceSettings:s,customProperties:o}).then(function(n){i.updateBlazorData(n,i);e.setPivotProperties(i,{pivotValues:i.engineModule.pivotValues});i.enginePopulatedEventMethod("initEngine",i)})}else n.engineModule.renderEngine(n.dataSourceSettings,u,n.getValueCellInfo.bind(n)),n.setProperties({pivotValues:n.engineModule.pivotValues},!0),n.enginePopulatedEventMethod("initEngine");else"SSAS"===n.dataSourceSettings.providerType&&"olap"===n.dataType&&(u.savedFieldList=n.olapEngineModule.fieldList,u.savedFieldListData=n.olapEngineModule.fieldListData,n.olapEngineModule.renderEngine(n.dataSourceSettings,u),n.setProperties({pivotValues:n.olapEngineModule.pivotValues},!0),n.enginePopulatedEventMethod("initEngine"))})},t.prototype.enginePopulatedEventMethod=function(n,t){var f=this,u,i,e;"initEngine"===n?(u=t||this,this.trigger("enginePopulated",{pivotValues:this.pivotValues},function(n){"olap"===u.dataType?(u.olapEngineModule.pivotValues=Object(r.isBlazor)()?f.olapEngineModule.pivotValues:n.pivotValues,u.pivotValues=u.olapEngineModule.pivotValues):(u.engineModule.pivotValues=Object(r.isBlazor)()?f.engineModule.pivotValues:n.pivotValues,u.pivotValues=u.engineModule.pivotValues);u.notify(ct,{});u.isEmptyGrid=!1})):(i=t||this,e={dataSourceSettings:i.dataSourceSettings,pivotValues:Object(r.isBlazor)()?"olap"===i.dataType?i.olapEngineModule.pivotValues:i.engineModule.pivotValues:i.pivotValues},i.trigger("enginePopulated",e,function(n){var t=i.dataSourceSettings.dataSource;Object(r.isBlazor)()&&n.dataSourceSettings.dataSource instanceof Object&&(n.dataSourceSettings.dataSource=t);i.dataSourceSettings=n.dataSourceSettings;"olap"===i.dataType?(i.olapEngineModule.pivotValues=Object(r.isBlazor)()?i.olapEngineModule.pivotValues:n.pivotValues,i.setProperties({pivotValues:i.olapEngineModule.pivotValues},!0)):(i.engineModule.pivotValues=Object(r.isBlazor)()?i.engineModule.pivotValues:n.pivotValues,i.setProperties({pivotValues:i.engineModule.pivotValues},!0));i.pivotCommon.engineModule="olap"===i.dataType?i.olapEngineModule:i.engineModule;i.pivotCommon.dataSourceSettings=i.dataSourceSettings;i.renderPivotGrid()}))},t.prototype.updateBlazorData=function(n,t){var e,l,a,v,y,p,f,i,c,o,u;t.allowServerDataBinding=!1;f=t;l=JSON.parse(n.fieldList);e=JSON.parse(n.pivotValue);a=JSON.parse(n.fields);v=JSON.parse(n.valueSortSettings);var h=e.length,b=JSON.parse(e[0]).length,r=new Array(h);for(i=0;i<h;i++)r[i]=new Array(b);for(i=0;i<h;i++)if(null!=e[i])for(var w=JSON.parse(e[i]),k=w.length,s=0;s<k;s++)r[i][s]=w[s];else r[i]=void 0;for(o=r,u=0;u<o.length;u++)if(o[u]&&o[u][0]&&"row"===o[u][0].axis){c=u;break}f.pivotValues=r;y=f.frameContent(r,"value",c,f);p=f.frameContent(r,"header",c,f);this.engineModule.pivotValues=r;this.engineModule.fieldList=l;this.engineModule.fields=a;this.engineModule.valueSortSettings=v;this.engineModule.valueContent=y;this.engineModule.headerContent=p;this.engineModule.isEngineUpdated=JSON.parse(n.isEngineUpdated);this.engineModule.isEmptyData=JSON.parse(n.isEmptyData);this.engineModule.rowCount=JSON.parse(n.rowCount);this.engineModule.columnCount=JSON.parse(n.columnCount);this.engineModule.rowStartPos=JSON.parse(n.rowStartPos);this.engineModule.colStartPos=JSON.parse(n.colStartPos);this.engineModule.rowFirstLvl=JSON.parse(n.rowFirstLvl);this.engineModule.colFirstLvl=JSON.parse(n.colFirstLvl);t.allowServerDataBinding=!0},t.prototype.frameContent=function(n,t,i,r){var s=[],e=r,f;if(e.dataSourceSettings.values.length>0&&!e.engineModule.isEmptyData&&(e.enableValueSorting||!e.engineModule.isEngineUpdated))for(var o=0,h="value"===t?i:0,c="value"===t?n.length:i,u=h;u<c;u++)if(n[u]){for(s[o="header"===t?u:o]={},f=0;f<n[u].length;f++)n[u][f]&&(s[o][f]=n[u][f]);o++}return s},t.prototype.generateData=function(){"Chart"!==this.displayOption.view&&this.renderEmptyGrid();this.refreshData()},t.prototype.refreshData=function(){this.showWaitingPopup();Object(r.isBlazor)()&&"olap"===this.dataType&&this.dataSourceSettings.dataSource instanceof tt.DataManager&&(this.dataSourceSettings.dataSource=void 0);this.dataSourceSettings&&(this.dataSourceSettings.dataSource||this.dataSourceSettings.url)?this.dataSourceSettings.dataSource instanceof tt.DataManager?Object(r.isBlazor)()&&this.enableVirtualization?(this.element.querySelector(".e-spinner-pane")||this.showWaitingPopup(),this.initEngine()):setTimeout(this.getData.bind(this),100):""!==this.dataSourceSettings.url&&"olap"===this.dataType||this.dataSourceSettings.dataSource.length>0?("pivot"===this.dataType&&(this.hideWaitingPopup(),this.engineModule.data=this.dataSourceSettings.dataSource),this.initEngine()):this.hideWaitingPopup():Object(r.isBlazor)()&&"pivot"===this.dataType&&this.engineModule.data&&this.engineModule.data.length>0?this.initEngine():this.hideWaitingPopup()},t.prototype.getValueCellInfo=function(n){var t=n;return this.trigger("aggregateCellInfo",t),t},t.prototype.bindTriggerEvents=function(n){this.trigger(Object(c.getObject)("name",n),n)},t.prototype.getData=function(){Object(r.isBlazor)()?this.dataSourceSettings.dataSource.executeQuery((new tt.Query).requiresCount()).then(this.executeQuery.bind(this)):this.dataSourceSettings.dataSource.executeQuery(new tt.Query).then(this.executeQuery.bind(this))},t.prototype.executeQuery=function(n){this.element.querySelector(".e-spinner-pane")||this.showWaitingPopup();this.engineModule.data=n.result;this.initEngine()},t.prototype.applyFormatting=function(n){var f,i,t,e,o,s;if(n){for(var h=[],c=n.length,u=0;u<c;u++)void 0!==n[u]&&void 0===n[u][0]&&h.push(u);for(u=0;u<n.length;u++)for(f=1;n[u]&&f<n[u].length;f++)if("value"===n[u][f].axis&&""!==n[u][f].formattedText)for(n[u][f].style=void 0,n[u][f].cssClass=void 0,i=this.dataSourceSettings.conditionalFormatSettings,t=0;t<i.length;t++)(!0===i[t].applyGrandTotals||Object(r.isNullOrUndefined)(i[t].applyGrandTotals)||""!==n[u][f].rowHeaders&&""!==n[u][f].columnHeaders)&&this.checkCondition(n[u][f].value,i[t].conditions,i[t].value1,i[t].value2)&&(i[t].measure&&n[u][f].actualText!==i[t].measure||void 0!==i[t].measure&&""===i[t].measure||void 0!==i[t].label&&""===i[t].label||!(!i[t].label||n[u][0].valueSort.levelName.indexOf(i[t].label)>-1||n[u][f].rowHeaders.indexOf(i[t].label)>-1||n[u][f].columnHeaders.indexOf(i[t].label)>-1)||(i[t].style&&i[t].style.backgroundColor&&(i[t].style.backgroundColor=this.conditionalFormattingModule.isHex(i[t].style.backgroundColor.substr(1))?i[t].style.backgroundColor:this.conditionalFormattingModule.colourNameToHex(i[t].style.backgroundColor)),i[t].style&&i[t].style.color&&(i[t].style.color=this.conditionalFormattingModule.isHex(i[t].style.color.substr(1))?i[t].style.color:this.conditionalFormattingModule.colourNameToHex(i[t].style.color)),n[u][f].style=i[t].style,n[u][f].cssClass="format"+this.element.id+t));for(e=this.dataSourceSettings.conditionalFormatSettings,t=0;t<e.length;t++)o=this.createStyleSheet.bind(this)(),s="color: "+e[t].style.color+"!important;background-color: "+e[t].style.backgroundColor+"!important;font-size: "+e[t].style.fontSize+"!important;font-family: "+e[t].style.fontFamily+" !important;",o.insertRule(".format"+this.element.id+t+"{"+s+"}",0)}},t.prototype.createStyleSheet=function(){var n=document.createElement("style");return n.appendChild(document.createTextNode("")),document.head.appendChild(n),n.sheet},t.prototype.applyHyperlinkSettings=function(){var i,f,u,h,c,o,l,a,s;if(this.pivotValues){for(var n=this.pivotValues,e=[],v=n.length,t=0;t<v;t++)void 0!==n[t]&&void 0===n[t][0]&&e.push(t);if(this.hyperlinkSettings.conditionalSettings.length>0)for(t=0;t<n.length;t++)for(i=1;n[t]&&i<n[t].length;i++)if("value"===n[t][i].axis)for(n[t][i].enableHyperlink=!1,f=this.hyperlinkSettings.conditionalSettings,u=0;u<f.length;u++)this.checkCondition(n[t][i].value,f[u].conditions,f[u].value1,f[u].value2)&&(h="row"===this.dataSourceSettings.valueAxis?t:"pivot"===this.dataType?this.engineModule.headerContent.length-1:this.olapEngineModule.headerContent.length-1,c="row"===this.dataSourceSettings.valueAxis?0:i,(!f[u].measure||1===this.dataSourceSettings.values.length||n[h][c].valueSort&&n[h][c].actualText===f[u].measure)&&(!f[u].label||n[e[f[u].label.split(".").length-1]]&&n[e[f[u].label.split(".").length-1]][i]&&n[e[f[u].label.split(".").length-1]][i].valueSort&&n[e[f[u].label.split(".").length-1]][i].valueSort[f[u].label]||n[t][0].valueSort.levelName.indexOf(f[u].label)>-1)&&(n[t][i].enableHyperlink=!0));if(Object(r.isNullOrUndefined)(this.hyperlinkSettings.headerText))return;for(t=0;t<n.length;t++)for(i=1;n[t]&&i<n[t].length;i++)if("value"===n[t][i].axis)if(o=this.hyperlinkSettings.headerText,h="row"===this.dataSourceSettings.valueAxis?t:"pivot"===this.dataType?this.engineModule.headerContent.length-1:this.olapEngineModule.headerContent.length-1,c="row"===this.dataSourceSettings.valueAxis?0:i,n[e[o.split(".").length-1]]&&n[e[o.split(".").length-1]][i]&&n[e[o.split(".").length-1]][i].valueSort&&n[e[o.split(".").length-1]][i].valueSort[o]){for(l=0,a=e;l<a.length;l++)s=a[l],n[s][i]&&"column"===n[s][i].axis&&n[s][i].valueSort.levelName.indexOf(o)>-1&&(n[s][i].enableHyperlink=!0);n[t][i].enableHyperlink=!0}else n[t][0].valueSort.levelName.indexOf(o)>-1&&(n[t][0].enableHyperlink=!0,n[t][i].enableHyperlink=!0)}},t.prototype.checkCondition=function(n,t,i,r){switch(t){case"LessThan":return n<i;case"LessThanOrEqualTo":return n<=i;case"GreaterThan":return n>i;case"GreaterThanOrEqualTo":return n>=i;case"Equals":return n===i;case"NotEquals":return n!==i;case"Between":return i<r&&n>=i&&n<=r||i>r&&n<=i&&n>=r;case"NotBetween":return!(i<r&&n>=i&&n<=r||i>r&&n<=i&&n>=r);default:return!1}},t.prototype.updateGroupingReport=function(n,t){var w,u,l,o,ot,d,y,g,a,p;this.clonedDataSet||this.clonedReport||(w=this.engineModule.data,this.clonedDataSet=e.getClonedData(w),Object(r.isBlazor)()?this.clonedReport=e.getClonedDataSourceSettings(this.dataSourceSettings):(this.setProperties({dataSourceSettings:{dataSource:[]}},!0),this.clonedReport=e.getClonedDataSourceSettings(this.dataSourceSettings),this.setProperties({dataSourceSettings:{dataSource:w}},!0)));var ut=/_date_group_years|_date_group_quarters|_date_group_quarterYear|_date_group_months|_date_group_days|_date_group_hours|_date_group_minutes|_date_group_seconds/g,ft=e.getClonedData(this.clonedDataSet),s=this.dataSourceSettings,c=this.clonedReport.properties?this.clonedReport.properties:this.clonedReport,h=[s.rows,s.columns,s.values,s.filters],f=[s.filterSettings,s.sortSettings,s.formatSettings,s.drilledMembers],b=c.rows;if(b=b.concat(c.columns,c.values,c.filters),0===n.length||n.length>0){this.engineModule.groupingFields={};Object(r.isBlazor)()||this.setProperties({dataSourceSettings:{dataSource:ft,groupSettings:n.length>0?s.groupSettings:[]}},!0);for(var et="Date"===t,v=[],i=0,k=h.length;i<k;i++)for(u=0,l=h[i].length;u<l;u++)o=h[i][u].name,-1===v.indexOf(o)&&v.push(o),ot=v.indexOf(o),e.getFieldByName(o,s.groupSettings),(Object(r.isNullOrUndefined)(o.match(ut))||!et)&&(-1===o.indexOf("_custom_group")||e.getFieldByName(o.replace("_custom_group",""),s.groupSettings))?(d=e.getFieldByName(o,b),d&&h[i].splice(u,1,d)):(h[i].splice(u,1),v.splice(ot,1),u--,l--);for(y=0,g=v;y<g.length;y++){o=g[y];var nt=e.getFilterItemByName(o,c.filterSettings),tt=e.getFieldByName(o,c.sortSettings),it=e.getFieldByName(o,c.formatSettings),rt=e.getFieldByName(o,c.drilledMembers),st=[nt,tt,it,rt];for(i=0,k=f.length;i<k;i++){for(a=!1,u=0,l=f[i].length;u<l;u++)if(p=f[i][u].name,(Object(r.isNullOrUndefined)(p.match(ut))||!et)&&(-1===p.indexOf("_custom_group")||e.getFieldByName(p.replace("_custom_group",""),s.groupSettings))){if(o===f[i][u].name){a=!0;st[i]?f[i].splice(u,1,st[i]):(f[i].splice(u,1),u--,l--);break}}else f[i].splice(u,1),u--,l--;!a&&0===i&&nt&&f[i].push(nt);!a&&1===i&&tt&&f[i].push(tt);!a&&2===i&&it&&f[i].push(it);!a&&3===i&&rt&&f[i].push(rt)}}Object(r.isBlazor)()&&(this.engineModule.data=ft,this.allowServerDataBinding=!1,this.setProperties({dataSourceSettings:{rows:h[0],columns:h[1],values:h[2],filters:h[3],filterSettings:f[0],sortSettings:f[1],formatSettings:f[2],drilledMembers:f[3],groupSettings:n.length>0?s.groupSettings:[]}},!0),this.allowServerDataBinding=!0)}},t.prototype.wireEvents=function(){"Chart"!==this.displayOption.view&&(r.EventHandler.add(this.element,this.isAdaptive?"touchend":"click",this.mouseClickHandler,this),r.EventHandler.add(this.element,"mousedown",this.mouseDownHandler,this),r.EventHandler.add(this.element.querySelector(".e-gridheader"),"mousemove",this.mouseMoveHandler,this),r.EventHandler.add(this.element,"mouseup",this.mouseUpHandler,this),r.EventHandler.add(this.element,this.isAdaptive?"touchend":"contextmenu",this.mouseRclickHandler,this));window.addEventListener("resize",this.onWindowResize.bind(this),!0)},t.prototype.unwireEvents=function(){"Chart"!==this.displayOption.view&&(r.EventHandler.remove(this.element,this.isAdaptive?"touchend":"click",this.mouseClickHandler),r.EventHandler.remove(this.element,"mousedown",this.mouseDownHandler),this.element.querySelector(".e-gridheader")&&r.EventHandler.remove(this.element.querySelector(".e-gridheader"),"mousemove",this.mouseMoveHandler),r.EventHandler.remove(this.element,"mouseup",this.mouseUpHandler),r.EventHandler.remove(this.element,this.isAdaptive?"touchend":"contextmenu",this.mouseRclickHandler));window.removeEventListener("resize",this.onWindowResize.bind(this),!0)},t.prototype.destroy=function(){this.removeInternalEvents();this.showGroupingBar&&this.groupingBarModule&&this.groupingBarModule.destroy();this.allowGrouping&&this.groupingModule&&this.groupingModule.destroy();this.showToolbar&&this.toolbarModule&&this.toolbarModule.destroy();this.enableVirtualization&&this.virtualscrollModule&&this.virtualscrollModule.destroy();this.allowConditionalFormatting&&this.conditionalFormattingModule&&this.conditionalFormattingModule.destroy();this.allowNumberFormatting&&this.numberFormattingModule&&this.numberFormattingModule.destroy();this.isAdaptive&&this.contextMenuModule&&this.contextMenuModule.destroy();this.keyboardModule&&this.keyboardModule.destroy();this.tooltip&&this.tooltip.destroy();this.chart&&this.chart.destroy();this.grid&&this.grid.contextMenuModule&&this.grid.contextMenuModule.destroy();this.unwireEvents();Object(r.removeClass)([this.element],oi);Object(r.removeClass)([this.element],et);Object(r.removeClass)([this.element],vt);this.element.innerHTML="";n.prototype.destroy.call(this)},f([Object(r.Property)("USD")],t.prototype,"currencyCode",void 0),f([Object(r.Property)(!1)],t.prototype,"showFieldList",void 0),f([Object(r.Complex)({},fu)],t.prototype,"gridSettings",void 0),f([Object(r.Complex)({},yf)],t.prototype,"chartSettings",void 0),f([Object(r.Complex)({},pf)],t.prototype,"groupingBarSettings",void 0),f([Object(r.Complex)({},kf)],t.prototype,"hyperlinkSettings",void 0),f([Object(r.Complex)({},wi)],t.prototype,"dataSourceSettings",void 0),f([Object(r.Complex)({},wf)],t.prototype,"editSettings",void 0),f([Object(r.Complex)({},df)],t.prototype,"displayOption",void 0),f([Object(r.Property)()],t.prototype,"pivotValues",void 0),f([Object(r.Property)(!1)],t.prototype,"showGroupingBar",void 0),f([Object(r.Property)(!0)],t.prototype,"showTooltip",void 0),f([Object(r.Property)(!1)],t.prototype,"showToolbar",void 0),f([Object(r.Property)([])],t.prototype,"toolbar",void 0),f([Object(r.Property)(!1)],t.prototype,"showValuesButton",void 0),f([Object(r.Property)(!1)],t.prototype,"allowCalculatedField",void 0),f([Object(r.Property)(!1)],t.prototype,"enableValueSorting",void 0),f([Object(r.Property)(!1)],t.prototype,"allowConditionalFormatting",void 0),f([Object(r.Property)(!1)],t.prototype,"allowNumberFormatting",void 0),f([Object(r.Property)("auto")],t.prototype,"height",void 0),f([Object(r.Property)("auto")],t.prototype,"width",void 0),f([Object(r.Property)(!1)],t.prototype,"allowExcelExport",void 0),f([Object(r.Property)(!1)],t.prototype,"enableVirtualization",void 0),f([Object(r.Property)(!1)],t.prototype,"allowDrillThrough",void 0),f([Object(r.Property)(!1)],t.prototype,"allowPdfExport",void 0),f([Object(r.Property)(!1)],t.prototype,"allowDeferLayoutUpdate",void 0),f([Object(r.Property)(!1)],t.prototype,"allowDataCompression",void 0),f([Object(r.Property)(1e3)],t.prototype,"maxNodeLimitInMemberEditor",void 0),f([Object(r.Property)(1e4)],t.prototype,"maxRowsInDrillThrough",void 0),f([Object(r.Property)(!0)],t.prototype,"loadOnDemandInMemberEditor",void 0),f([Object(r.Property)(!0)],t.prototype,"enableHtmlSanitizer",void 0),f([Object(r.Property)()],t.prototype,"cellTemplate",void 0),f([Object(r.Property)()],t.prototype,"tooltipTemplate",void 0),f([Object(r.Property)()],t.prototype,"spinnerTemplate",void 0),f([Object(r.Property)(!1)],t.prototype,"allowGrouping",void 0),f([Object(r.Property)(!0)],t.prototype,"exportAllPages",void 0),f([Object(r.Property)(["Sum","Count","DistinctCount","Product","Min","Max","Avg","Index","PopulationVar","SampleVar","PopulationStDev","SampleStDev","RunningTotals","PercentageOfGrandTotal","PercentageOfColumnTotal","PercentageOfRowTotal","PercentageOfParentColumnTotal","PercentageOfParentRowTotal","DifferenceFrom","PercentageOfDifferenceFrom","PercentageOfParentTotal"])],t.prototype,"aggregateTypes",void 0),f([Object(r.Property)(["Column","Bar","Line","Area","Scatter","Polar","StackingColumn","StackingArea","StackingBar","StepLine","StepArea","SplineArea","Spline","StackingColumn100","StackingBar100","StackingArea100","Bubble","Pareto","Radar"])],t.prototype,"chartTypes",void 0),f([Object(r.Event)()],t.prototype,"queryCellInfo",void 0),f([Object(r.Event)()],t.prototype,"headerCellInfo",void 0),f([Object(r.Event)()],t.prototype,"resizing",void 0),f([Object(r.Event)()],t.prototype,"resizeStop",void 0),f([Object(r.Event)()],t.prototype,"pdfHeaderQueryCellInfo",void 0),f([Object(r.Event)()],t.prototype,"pdfQueryCellInfo",void 0),f([Object(r.Event)()],t.prototype,"excelHeaderQueryCellInfo",void 0),f([Object(r.Event)()],t.prototype,"excelQueryCellInfo",void 0),f([Object(r.Event)()],t.prototype,"columnDragStart",void 0),f([Object(r.Event)()],t.prototype,"columnDrag",void 0),f([Object(r.Event)()],t.prototype,"columnDrop",void 0),f([Object(r.Event)()],t.prototype,"beforePdfExport",void 0),f([Object(r.Event)()],t.prototype,"beforeExcelExport",void 0),f([Object(r.Event)()],t.prototype,"beforeColumnsRender",void 0),f([Object(r.Event)()],t.prototype,"selected",void 0),f([Object(r.Event)()],t.prototype,"cellDeselected",void 0),f([Object(r.Event)()],t.prototype,"rowSelected",void 0),f([Object(r.Event)()],t.prototype,"rowDeselected",void 0),f([Object(r.Event)()],t.prototype,"chartTooltipRender",void 0),f([Object(r.Event)()],t.prototype,"chartLoaded",void 0),f([Object(r.Event)()],t.prototype,"chartLoad",void 0),f([Object(r.Event)()],t.prototype,"chartResized",void 0),f([Object(r.Event)()],t.prototype,"chartAxisLabelRender",void 0),f([Object(r.Event)()],t.prototype,"chartPointClick",void 0),f([Object(r.Event)()],t.prototype,"contextMenuClick",void 0),f([Object(r.Event)()],t.prototype,"contextMenuOpen",void 0),f([Object(r.Event)()],t.prototype,"onPdfCellRender",void 0),f([Object(r.Event)()],t.prototype,"saveReport",void 0),f([Object(r.Event)()],t.prototype,"fetchReport",void 0),f([Object(r.Event)()],t.prototype,"loadReport",void 0),f([Object(r.Event)()],t.prototype,"renameReport",void 0),f([Object(r.Event)()],t.prototype,"removeReport",void 0),f([Object(r.Event)()],t.prototype,"newReport",void 0),f([Object(r.Event)()],t.prototype,"toolbarRender",void 0),f([Object(r.Event)()],t.prototype,"toolbarClick",void 0),f([Object(r.Event)()],t.prototype,"load",void 0),f([Object(r.Event)()],t.prototype,"enginePopulating",void 0),f([Object(r.Event)()],t.prototype,"enginePopulated",void 0),f([Object(r.Event)()],t.prototype,"onFieldDropped",void 0),f([Object(r.Event)()],t.prototype,"fieldDrop",void 0),f([Object(r.Event)()],t.prototype,"fieldDragStart",void 0),f([Object(r.Event)()],t.prototype,"dataBound",void 0),f([Object(r.Event)()],t.prototype,"created",void 0),f([Object(r.Event)()],t.prototype,"destroyed",void 0),f([Object(r.Event)()],t.prototype,"beforeExport",void 0),f([Object(r.Event)()],t.prototype,"conditionalFormatting",void 0),f([Object(r.Event)()],t.prototype,"memberFiltering",void 0),f([Object(r.Event)()],t.prototype,"cellClick",void 0),f([Object(r.Event)()],t.prototype,"drillThrough",void 0),f([Object(r.Event)()],t.prototype,"beginDrillThrough",void 0),f([Object(r.Event)()],t.prototype,"hyperlinkCellClick",void 0),f([Object(r.Event)()],t.prototype,"cellSelecting",void 0),f([Object(r.Event)()],t.prototype,"drill",void 0),f([Object(r.Event)()],t.prototype,"cellSelected",void 0),f([Object(r.Event)()],t.prototype,"chartSeriesCreated",void 0),f([Object(r.Event)()],t.prototype,"aggregateCellInfo",void 0),f([Object(r.Event)()],t.prototype,"fieldListRefreshed",void 0),f([Object(r.Event)()],t.prototype,"memberEditorOpen",void 0),f([Object(r.Event)()],t.prototype,"calculatedFieldCreate",void 0),f([Object(r.Event)()],t.prototype,"numberFormatting",void 0),f([Object(r.Event)()],t.prototype,"aggregateMenuOpen",void 0),f([Object(r.Event)()],t.prototype,"fieldRemove",void 0),t=i=f([r.NotifyPropertyChanges],t)}(r.Component),gf=function(){function n(n){this.parent=n}return n.prototype.render=function(){var n=Object(r.createElement)("div",{id:this.parent.element.id+"_Wrapper",className:"e-pivotfieldlist-wrapper "+("olap"===this.parent.dataType?"e-olapfieldlist-wrapper":""),styles:"width:"+this.parent.element.style.width});this.parent.isAdaptive?Object(r.addClass)([n],vt):Object(r.removeClass)([n],vt);this.parent.enableRtl?Object(r.addClass)([n],et):Object(r.removeClass)([n],et);this.parent.cssClass&&Object(r.addClass)([n],this.parent.cssClass);this.parentElement=Object(r.createElement)("div",{className:"e-field-list-container"});this.parent.element.appendChild(n);this.parent.isAdaptive&&(n.removeAttribute("style"),this.parentElement=Object(r.createElement)("div",{className:"e-adaptive-container"}),this.renderAdaptiveLayout(n));"Popup"===this.parent.renderMode?(this.renderFieldListDialog(n),this.unWireDialogEvent(this.parent.element.querySelector(".e-toggle-field-list")),this.wireDialogEvent(this.parent.element.querySelector(".e-toggle-field-list"))):this.renderStaticLayout(n)},n.prototype.renderStaticLayout=function(n){if(!this.parent.isAdaptive){var t=Object(r.createElement)("div",{className:"e-field-list-title"}),i=Object(r.createElement)("div",{className:"e-title-content",innerHTML:this.parent.localeObj.getConstant("staticFieldList")});t.appendChild(i);t.appendChild(this.createCalculatedButton());Object(r.addClass)([n],"e-static");n.appendChild(t);n.appendChild(this.parentElement);Object(r.addClass)([n],"e-static");this.parent.allowDeferLayoutUpdate&&(n.appendChild(this.createDeferUpdateButtons()),this.renderDeferUpdateButtons())}},n.prototype.renderDeferUpdateButtons=function(){this.parent.allowDeferLayoutUpdate&&(this.deferUpdateCheckBox=new g.CheckBox({label:this.parent.localeObj.getConstant("deferLayoutUpdate"),checked:!0,enableRtl:this.parent.enableRtl,change:this.onCheckChange.bind(this)}),this.deferUpdateCheckBox.isStringTemplate=!0,this.deferUpdateCheckBox.appendTo("#"+this.parent.element.id+"DeferUpdateCheckBox"),this.deferUpdateApplyButton=new g.Button({cssClass:"e-defer-apply-button e-defer-update-btn"+("Popup"===this.parent.renderMode?" e-flat":""),content:this.parent.localeObj.getConstant("apply"),enableRtl:this.parent.enableRtl,isPrimary:!0}),this.deferUpdateApplyButton.isStringTemplate=!0,this.deferUpdateApplyButton.appendTo("#"+this.parent.element.id+"_DeferUpdateButton1"),this.deferUpdateApplyButton.element.onclick="Fixed"===this.parent.renderMode?this.applyButtonClick.bind(this):this.onDeferUpdateClick.bind(this));this.deferUpdateCancelButton=new g.Button({cssClass:"e-defer-cancel-button e-cancel-btn"+("Popup"===this.parent.renderMode?" e-flat":""),content:this.parent.allowDeferLayoutUpdate?this.parent.localeObj.getConstant("cancel"):this.parent.localeObj.getConstant("close"),enableRtl:this.parent.enableRtl,isPrimary:!this.parent.allowDeferLayoutUpdate});this.deferUpdateCancelButton.isStringTemplate=!0;this.deferUpdateCancelButton.appendTo("#"+this.parent.element.id+"_DeferUpdateButton2");this.deferUpdateCancelButton.element.onclick="Fixed"===this.parent.renderMode?this.cancelButtonClick.bind(this):this.onCloseFieldList.bind(this)},n.prototype.createDeferUpdateButtons=function(){var t=Object(r.createElement)("div",{className:"e-layout-footer"}),i,u,n,f,e;return this.parent.allowDeferLayoutUpdate&&(i=Object(r.createElement)("div",{className:"e-checkbox-layout"}),u=Object(r.createElement)("input",{id:this.parent.element.id+"DeferUpdateCheckBox"}),i.appendChild(u),t.appendChild(i)),n=Object(r.createElement)("div",{className:"e-button-layout"}),this.parent.allowDeferLayoutUpdate&&(f=Object(r.createElement)("button",{id:this.parent.element.id+"_DeferUpdateButton1"}),n.appendChild(f)),e=Object(r.createElement)("button",{id:this.parent.element.id+"_DeferUpdateButton2"}),n.appendChild(e),t.appendChild(n),t},n.prototype.onCheckChange=function(n){n.checked&&(this.parent.clonedDataSource=Object(r.extend)({},this.parent.dataSourceSettings,null,!0),this.parent.clonedFieldList=Object(r.extend)({},this.parent.pivotFieldList,null,!0));this.parent.allowDeferLayoutUpdate=!this.parent.allowDeferLayoutUpdate;"Fixed"===this.parent.renderMode?(this.deferUpdateApplyButton.setProperties({disabled:!this.parent.allowDeferLayoutUpdate}),this.deferUpdateCancelButton.setProperties({disabled:!this.parent.allowDeferLayoutUpdate})):this.parent.allowDeferLayoutUpdate?(this.deferUpdateApplyButton.element.style.display="",this.deferUpdateCancelButton.setProperties({content:this.parent.localeObj.getConstant("cancel")}),this.deferUpdateCancelButton.isPrimary=!1):(this.deferUpdateApplyButton.element.style.display="none",this.deferUpdateCancelButton.setProperties({content:this.parent.localeObj.getConstant("close")}),this.deferUpdateCancelButton.isPrimary=!0);this.cancelButtonClick()},n.prototype.applyButtonClick=function(){this.parent.updateDataSource(!1);var n=this.parent;n.axisFieldModule.render();n.clonedDataSource=Object(r.extend)({},n.dataSourceSettings,null,!0);n.clonedFieldList=Object(r.extend)({},n.pivotFieldList,null,!0)},n.prototype.cancelButtonClick=function(){var n,t,u,i;if(Object(r.isBlazor)()&&!this.parent.isPopupView?e.updateDataSourceSettings(this.parent,e.getClonedDataSourceSettings(this.parent.clonedDataSource.properties)):this.parent.setProperties({dataSourceSettings:this.parent.clonedDataSource.properties},!0),"olap"===this.parent.dataType)for(this.parent.olapEngineModule.fieldList=Object(r.extend)({},this.parent.clonedFieldList,null,!0),n=0,t=Object.keys(this.parent.clonedFieldList);n<t.length;n++)u=t[n],i=this.parent.clonedFieldList[u],this.parent.olapEngineModule.updateFieldlistData(i.id,i.isSelected);else this.parent.engineModule.fieldList=Object(r.extend)({},this.parent.clonedFieldList,null,!0);this.parent.updateDataSource(!1,!0)},n.prototype.renderFieldListDialog=function(n){var e=Object(r.createElement)("div",{className:"e-toggle-field-list "+h+" e-select-table",attrs:{tabindex:"0",title:this.parent.localeObj.getConstant("fieldList"),"aria-disabled":"false","aria-label":this.parent.localeObj.getConstant("fieldList")}}),t,u,i,f;(this.parent.element.appendChild(e),this.parent.isAdaptive)?(t='<div class=e-title-mobile-header><span class="'+h+' e-field-list-back-icon"><\/span><div class=e-title-mobile-content>'+this.parent.localeObj.getConstant("fieldList")+"<\/div><\/div>",u=[{click:this.showFieldListDialog.bind(this),buttonModel:{cssClass:"e-field-list-btn e-small e-round",iconCss:h+" e-add-icon",isPrimary:!0}},{click:this.showCalculatedField.bind(this),buttonModel:{cssClass:"e-calculated-field-btn e-small e-round e-disable",iconCss:h+" e-add-icon",enableRtl:this.parent.enableRtl,isPrimary:!0}}],this.fieldListDialog=new p.Dialog({animationSettings:{effect:this.parent.enableRtl?"SlideRight":"SlideLeft"},header:t,content:this.parentElement,isModal:!0,showCloseIcon:!1,visible:!1,allowDragging:!1,closeOnEscape:!0,enableRtl:this.parent.enableRtl,width:"100%",height:"100%",position:{X:"center",Y:"center"},buttons:u,target:document.body,close:this.removeFieldListIcon.bind(this),open:this.dialogOpen.bind(this)}),this.fieldListDialog.isStringTemplate=!0,this.fieldListDialog.appendTo(n),Object(r.setStyleAttribute)(n.querySelector("#"+n.id+"_dialog-content"),{padding:"0"}),i=n.querySelector(".e-footer-content"),Object(r.addClass)([i],"e-field-list-footer"),Object(r.removeClass)([i.querySelector(".e-calculated-field-btn")],"e-flat"),Object(r.removeClass)([i.querySelector(".e-field-list-btn")],"e-flat"),this.fieldListDialog.element.querySelector(".e-field-list-back-icon").onclick=this.parent.allowDeferLayoutUpdate?this.onDeferUpdateClick.bind(this):this.onCloseFieldList.bind(this)):(f=this.createDeferUpdateButtons().outerHTML,t="<div class=e-title-header><div class=e-title-content>"+this.parent.localeObj.getConstant("fieldList")+"<\/div><\/div>",this.fieldListDialog=new p.Dialog({animationSettings:{effect:"Zoom"},header:t,content:this.parentElement,isModal:!1,showCloseIcon:!1,visible:!1,allowDragging:!0,enableRtl:this.parent.enableRtl,width:this.parent.element.style.width,position:{X:"center",Y:this.parent.element.offsetTop},footerTemplate:f,closeOnEscape:!0,target:Object(r.isNullOrUndefined)(this.parent.target)?document.body:"string"==typeof this.parent.target?document.querySelector(this.parent.target):this.parent.target,close:this.removeFieldListIcon.bind(this)}),this.fieldListDialog.isStringTemplate=!0,this.fieldListDialog.appendTo(n),this.renderDeferUpdateButtons(),Object(r.setStyleAttribute)(n.querySelector("#"+n.id+"_title"),{width:"100%"}),n.querySelector(".e-title-header").appendChild(this.createCalculatedButton()))},n.prototype.dialogOpen=function(){this.adaptiveElement.refresh()},n.prototype.updateDataSource=function(n){for(var r,u,f=["filters","columns","rows","values"],t=0,i=n;t<i.length;t++)r=i[t],u=f[this.adaptiveElement.selectedItem],this.parent.pivotCommon.dataSourceUpdate.control="pivotview"===this.parent.getModuleName()?this.parent:this.parent.pivotGridModule?this.parent.pivotGridModule:this.parent,this.parent.pivotCommon.dataSourceUpdate.updateDataSource(r,u,-1);this.parent.axisFieldModule.render();this.parent.allowDeferLayoutUpdate?this.parent.triggerPopulateEvent():this.parent.updateDataSource(!0)},n.prototype.onDeferUpdateClick=function(){this.parent.updateDataSource();this.parent.dialogRenderer.fieldListDialog.hide()},n.prototype.renderAdaptiveLayout=function(n){var i=Object(r.createElement)("div",{className:"e-field-list-footer"}),t;n.appendChild(this.parentElement);t=[{header:{text:this.parent.localeObj.getConstant("filters")},content:this.createAxisTable("filters")},{header:{text:this.parent.localeObj.getConstant("columns")},content:this.createAxisTable("columns")},{header:{text:this.parent.localeObj.getConstant("rows")},content:this.createAxisTable("rows")},{header:{text:this.parent.localeObj.getConstant("values")},content:this.createAxisTable("values")},{header:{text:this.parent.localeObj.getConstant("createCalculatedField")},content:"Calculated Field Related UI"}];this.parent.allowCalculatedField||t.pop();this.adaptiveElement=new rt.Tab({heightAdjustMode:"Auto",items:t,height:"100%",enableRtl:this.parent.enableRtl,selected:this.tabSelect.bind(this)});"Fixed"===this.parent.renderMode?(i.appendChild(this.createAddButton()),Object(r.addClass)([n],"e-static"),this.adaptiveElement.isStringTemplate=!0,this.adaptiveElement.appendTo(this.parentElement),this.parentElement.appendChild(i)):(this.adaptiveElement.isStringTemplate=!0,this.adaptiveElement.appendTo(this.parentElement))},n.prototype.tabSelect=function(n){var t=Object(r.closest)(this.parentElement,".e-pivotfieldlist-wrapper");t&&t.querySelector(".e-field-list-btn")&&(4!==n.selectedIndex?(Object(r.addClass)([t.querySelector(".e-calculated-field-btn")],"e-disable"),Object(r.removeClass)([t.querySelector(".e-field-list-btn")],"e-disable")):(Object(r.removeClass)([t.querySelector(".e-calculated-field-btn")],"e-disable"),Object(r.addClass)([t.querySelector(".e-field-list-btn")],"e-disable")));4===n.selectedIndex?(this.adaptiveElement.items[4].content="",this.adaptiveElement.dataBind(),this.parent.notify("init-calculatedfield",{})):this.parent.axisFieldModule.render()},n.prototype.createCalculatedButton=function(){var n=Object(r.createElement)("div",{id:this.parent.element.id+"_CalculatedField",attrs:{tabindex:"0","aria-disabled":"false","aria-label":this.parent.localeObj.getConstant("CalculatedField")}}),t=new g.Button({cssClass:"e-calculated-field e-disable",content:this.parent.localeObj.getConstant("CalculatedField"),enableRtl:this.parent.enableRtl});return t.isStringTemplate=!0,t.appendTo(n),this.parent.calculatedFieldModule&&Object(r.removeClass)([n],"e-disable"),t.element.onclick=this.showCalculatedField.bind(this),n},n.prototype.createAddButton=function(){var n=Object(r.createElement)("div",{className:"e-field-list-footer-content"}),u=Object(r.createElement)("div",{}),f=Object(r.createElement)("div",{}),t=new g.Button({cssClass:"e-calculated-field-btn e-small e-round e-disable",iconCss:h+" e-add-icon",enableRtl:this.parent.enableRtl}),i=new g.Button({cssClass:"e-field-list-btn e-small e-round",iconCss:h+" e-add-icon",enableRtl:this.parent.enableRtl});return i.isStringTemplate=!0,i.appendTo(u),t.isStringTemplate=!0,t.appendTo(f),n.appendChild(u),n.appendChild(f),t.element.onclick=this.showCalculatedField.bind(this),i.element.onclick=this.showFieldListDialog.bind(this),n},n.prototype.createAxisTable=function(n){var t=Object(r.createElement)("div",{className:"e-field-list-"+n}),i=Object(r.createElement)("div",{className:"e-axis-content e-"+n}),u=Object(r.createElement)("span",{className:"e-draggable-prompt",innerHTML:this.parent.localeObj.getConstant("addPrompt")});return t.appendChild(i),t.appendChild(u),t},n.prototype.showCalculatedField=function(){this.parent.isAdaptive||this.parent.dialogRenderer.fieldListDialog&&(this.parent.dialogRenderer.fieldListDialog.hide(),Object(r.addClass)([this.parent.element.querySelector(".e-toggle-field-list")],"e-hide"));this.parent.notify("init-calculatedfield",{})},n.prototype.showFieldListDialog=function(){var n=this.adaptiveElement.selectedItem;this.parent.treeViewModule.render(n)},n.prototype.onShowFieldList=function(){this.parent.allowDeferLayoutUpdate&&(this.parent.isAdaptive&&this.parent.axisFieldModule.render(),this.parent.clonedDataSource=Object(r.extend)({},this.parent.dataSourceSettings,null,!0),this.parent.clonedFieldList=Object(r.extend)({},this.parent.pivotFieldList,null,!0));Object(r.addClass)([this.parent.element.querySelector(".e-toggle-field-list")],"e-hide");this.parent.dialogRenderer.fieldListDialog.show();this.parent.dialogRenderer.fieldListDialog.element.style.top=parseInt(this.parent.dialogRenderer.fieldListDialog.element.style.top,10)<0?"0px":this.parent.dialogRenderer.fieldListDialog.element.style.top},n.prototype.onCloseFieldList=function(){this.parent.allowDeferLayoutUpdate&&(this.parent.dataSourceSettings=Object(r.extend)({},this.parent.clonedDataSource.properties,null,!0),this.parent.pivotGridModule.engineModule=this.parent.engineModule,this.parent.pivotGridModule.olapEngineModule=this.parent.olapEngineModule,this.parent.pivotGridModule.setProperties({dataSourceSettings:this.parent.clonedDataSource.properties},!0),Object.keys(this.parent.clonedFieldList).length>0&&("olap"===this.parent.dataType?this.parent.olapEngineModule.fieldList=Object(r.extend)({},this.parent.clonedFieldList,null,!0):this.parent.engineModule.fieldList=Object(r.extend)({},this.parent.clonedFieldList,null,!0)),this.parent.pivotGridModule.notify(ft,this),this.parent.pivotGridModule.notify(st,this));this.parent.dialogRenderer.fieldListDialog.hide()},n.prototype.removeFieldListIcon=function(){this.parent.isAdaptive&&this.parent.allowCalculatedField&&this.parent.calculatedFieldModule&&this.adaptiveElement&&4===this.adaptiveElement.selectedItem&&(this.adaptiveElement.element.querySelector("#"+this.parent.element.id+"droppable")?this.parent.calculatedFieldModule.updateAdaptiveCalculatedField(!1):this.parent.notify("init-calculatedfield",{edit:!1}));document.getElementById(this.parent.element.id+"calculateddialog")||Object(r.removeClass)([this.parent.element.querySelector(".e-toggle-field-list")],"e-hide")},n.prototype.keyPress=function(n){return n.target,13===n.keyCode&&n.target?(n.target.click(),void n.preventDefault()):void 0},n.prototype.wireDialogEvent=function(n){r.EventHandler.add(n,"keydown",this.keyPress,this);r.EventHandler.add(n,"click",this.onShowFieldList,this)},n.prototype.unWireDialogEvent=function(n){r.EventHandler.remove(n,"keydown",this.keyPress);r.EventHandler.remove(n,"click",this.onShowFieldList)},n}(),ne=function(){function n(n){this.selectedNodes=[];this.parent=n;this.addEventListener()}return n.prototype.render=function(n){var t,f,e;if(this.parentElement=this.parent.dialogRenderer.parentElement,this.fieldListSort="None",this.parent.isAdaptive)this.renderTreeDialog(n);else{var i=Object(r.createElement)("div",{className:"e-field-table "+("olap"===this.parent.dataType?"e-olap-field-table":"")}),o=Object(r.createElement)("div",{className:"e-field-header",innerHTML:this.parent.localeObj.getConstant("allFields")}),u=Object(r.createElement)("div",{className:"e-field-list-tree-outer-div"});this.treeViewElement=Object(r.createElement)("div",{id:this.parent.element.id+"_TreeView",className:"e-field-list "+("olap"===this.parent.dataType?"e-olap-field-list-tree":"")});t=Object(r.createElement)("div",{className:"e-field-header-wrapper"});(t.appendChild(o),i.appendChild(t),this.updateSortElements(t),u.appendChild(this.treeViewElement),i.appendChild(u),this.parentElement.appendChild(i),"Fixed"===this.parent.renderMode)&&(f=Object(r.createElement)("div",{className:"e-center-div"}),e=Object(r.createElement)("div",{className:"e-center-title",innerHTML:this.parent.localeObj.getConstant("centerHeader")}),this.parentElement.appendChild(f),this.parentElement.appendChild(e));this.renderTreeView()}},n.prototype.updateSortElements=function(n){for(var t,i,f={None:"sortNone",Ascend:"sortAscending",Descend:"sortDescending"},u=0,e=Object.keys(f);u<e.length;u++)t=e[u],i=Object(r.createElement)("span",{attrs:{tabindex:"0","aria-disabled":"false","aria-label":"Sort "+t,"data-sort":t,title:this.parent.localeObj.getConstant(f[t])},className:h+" e-sort-"+t.toLowerCase()+" "+(this.fieldListSort===t?"e-selected":"")}),n.appendChild(i),this.unWireFieldListEvent(i),this.wireFieldListEvent(i)},n.prototype.renderTreeView=function(){this.fieldTable=new rt.TreeView({fields:{dataSource:this.getTreeData(),id:"id",text:"caption",isChecked:"isSelected",parentID:"pid",iconCss:"spriteCssClass"},nodeChecked:this.nodeStateChange.bind(this),cssClass:"e-field-list-tree",showCheckBox:!0,allowDragAndDrop:!0,sortOrder:"None",autoCheck:!1,loadOnDemand:!1,enableRtl:this.parent.enableRtl,nodeDragStart:this.dragStart.bind(this),nodeDragStop:this.dragStop.bind(this),drawNode:this.updateTreeNode.bind(this),nodeExpanding:this.updateNodeIcon.bind(this),nodeCollapsed:this.updateNodeIcon.bind(this),nodeSelected:function(n){Object(r.removeClass)([n.node],"e-active");n.cancel=!0}});this.treeViewElement.innerHTML="";this.fieldTable.isStringTemplate=!0;this.fieldTable.appendTo(this.treeViewElement)},n.prototype.updateNodeIcon=function(n){if("olap"===this.parent.dataType)if(n.node&&n.node.querySelector(".e-list-icon")&&n.node.querySelector(".e-list-icon").className.indexOf("e-folderCDB-icon")>-1){var t=n.node.querySelector(".e-list-icon");Object(r.removeClass)([t],"e-folderCDB-icon");Object(r.addClass)([t],"e-folderCDB-open-icon")}else n.node&&n.node.querySelector(".e-list-icon")&&n.node.querySelector(".e-list-icon").className.indexOf("e-folderCDB-open-icon")>-1&&(t=n.node.querySelector(".e-list-icon"),Object(r.removeClass)([t],"e-folderCDB-open-icon"),Object(r.addClass)([t],"e-folderCDB-icon"))},n.prototype.updateTreeNode=function(n){var u=!1,t,f,i,o;u="olap"!==this.parent.dataType||this.updateOlapTreeNode(n);t=n.node.querySelector(".e-text-content");n.node.querySelector(".e-list-icon")&&t&&(f=n.node.querySelector(".e-list-icon"),t.insertBefore(f,n.node.querySelector(".e-list-text")));u&&!this.parent.isAdaptive&&(i=e.getFieldInfo(n.nodeData.id,this.parent),u=!1,o=Object(r.createElement)("span",{attrs:{tabindex:"-1",title:i.fieldItem?i.fieldItem.allowDragAndDrop?this.parent.localeObj.getConstant("drag"):"":this.parent.localeObj.getConstant("drag"),"aria-disabled":"false"},className:h+" e-drag "+(i.fieldItem?i.fieldItem.allowDragAndDrop?"":"e-disable-drag":"")}),n.node.querySelector(".e-checkbox-wrapper")&&!n.node.querySelector(".cls.DRAG_CLASS")&&t&&t.insertBefore(o,n.node.querySelector(".e-checkbox-wrapper")));n.node.querySelector(".e-check")&&Object(r.addClass)([n.node.querySelector(".e-list-text")],"e-selected-node")},n.prototype.updateOlapTreeNode=function(n){var t=!1;return"olap"===this.parent.dataType?(n.node&&n.node.querySelector(".e-calcMemberGroupCDB,.e-measureGroupCDB-icon,.e-folderCDB-icon,.e-folderCDB-open-icon,.e-dimensionCDB-icon,.e-kpiCDB-icon")&&(n.node.querySelector(".e-checkbox-wrapper").style.display="none"),n.node&&n.node.querySelector(".e-list-icon")&&n.node.querySelector(".e-list-icon").className.indexOf("e-level-members")>-1&&(this.parent.isAdaptive?n.node.querySelector(".e-checkbox-wrapper").style.display="none":n.node.querySelector(".e-checkbox-wrapper").style.visibility="hidden"),n.node&&(n.node.querySelector(".e-hierarchyCDB-icon,.e-attributeCDB-icon,.e-namedSetCDB-icon")||n.node.querySelector(".e-measure-icon,.e-kpiGoal-icon,.e-kpiStatus-icon,.e-kpiTrend-icon,.e-kpiValue-icon")||n.node.querySelector(".e-calc-measure-icon,.e-calc-dimension-icon"))&&(n.node.querySelector(".e-measure-icon")?(n.node.querySelector(".e-list-icon").style.display="none",t=!0):t=!0)):t=!0,t},n.prototype.renderTreeDialog=function(n){var t=Object(r.createElement)("div",{id:this.parent.element.id+"_FieldListTreeView",className:"e-adaptive-field-list-dialog "+("olap"===this.parent.dataType?"e-olap-editor-dialog":"")});this.parentElement.appendChild(t);this.fieldDialog=new p.Dialog({animationSettings:{effect:"Fade"},allowDragging:!1,header:this.parent.localeObj.getConstant("adaptiveFieldHeader"),content:this.createTreeView(this.getTreeData(n)),isModal:!0,visible:!0,showCloseIcon:!1,enableRtl:this.parent.enableRtl,width:"auto",height:"350px",position:{X:"center",Y:"center"},buttons:[{click:this.closeTreeDialog.bind(this),buttonModel:{cssClass:"e-cancel-btn",content:this.parent.localeObj.getConstant("cancel")}},{click:this.onFieldAdd.bind(this),buttonModel:{cssClass:"e-ok-btn",content:this.parent.localeObj.getConstant("add"),isPrimary:!0}}],closeOnEscape:!0,target:this.parentElement.parentElement,close:this.dialogClose.bind(this)});this.fieldDialog.isStringTemplate=!0;this.fieldDialog.appendTo(t)},n.prototype.dialogClose=function(){document.getElementById(this.parent.element.id+"_FieldListTreeView")&&Object(r.remove)(document.getElementById(this.parent.element.id+"_FieldListTreeView"))},n.prototype.createTreeView=function(n){var t=Object(r.createElement)("div",{id:this.parent.element.id+"EditorDiv",className:"e-member-editor-wrapper"}),f=Object(r.createElement)("div",{id:this.parent.element.id+"_SearchDiv",attrs:{tabindex:"-1"},className:"e-editor-search-wrapper"}),e=Object(r.createElement)("input",{attrs:{type:"text"}}),i,u,o;return f.appendChild(e),i=Object(r.createElement)("div",{className:"e-member-editor-container-outer-div"}),u=Object(r.createElement)("div",{className:"e-member-editor-container "+("olap"===this.parent.dataType?"e-olap-field-list-tree":"")}),t.appendChild(f),this.editorSearch=new b.MaskedTextBox({showClearButton:!0,placeholder:this.parent.localeObj.getConstant("search"),enableRtl:this.parent.enableRtl,cssClass:"e-editor-search",change:this.textChange.bind(this)}),this.editorSearch.isStringTemplate=!0,this.editorSearch.appendTo(e),o=Object(r.createElement)("div",{className:"e-member-prompt e-disable",innerHTML:this.parent.localeObj.getConstant("noMatches")}),t.appendChild(o),i.appendChild(u),t.appendChild(i),this.fieldTable=new rt.TreeView({fields:{dataSource:n,id:"id",text:"caption",isChecked:"isSelected",parentID:"pid",iconCss:"spriteCssClass"},showCheckBox:!0,autoCheck:!1,loadOnDemand:!1,sortOrder:"olap"===this.parent.dataType?"None":"Ascending",enableRtl:this.parent.enableRtl,nodeChecked:this.addNode.bind(this),drawNode:this.updateTreeNode.bind(this),nodeExpanding:this.updateNodeIcon.bind(this),nodeCollapsed:this.updateNodeIcon.bind(this),nodeSelected:function(n){Object(r.removeClass)([n.node],"e-active");n.cancel=!0}}),this.fieldTable.isStringTemplate=!0,this.fieldTable.appendTo(u),t},n.prototype.textChange=function(n){this.parent.pivotCommon.eventBase.searchTreeNodes(n,this.fieldTable,!0);var t=this.fieldDialog.element.querySelector(".e-member-prompt"),i=[].slice.call(this.fieldTable.element.querySelectorAll("li")),u=[].slice.call(this.fieldTable.element.querySelectorAll("li.e-disable"));i.length===u.length?Object(r.removeClass)([t],"e-disable"):Object(r.addClass)([t],"e-disable")},n.prototype.dragStart=function(n){var t=this,i,u;n.event.target.classList.contains("e-drag")&&!n.event.target.classList.contains("e-disable-drag")?(i=e.getFieldInfo(n.draggedNode.getAttribute("data-uid"),this.parent),u={fieldName:i.fieldName,fieldItem:i.fieldItem,axis:i.axis,dataSourceSettings:this.parent.dataSourceSettings,cancel:!1},(this.parent.isPopupView?this.parent.pivotGridModule:this.parent).trigger("fieldDragStart",u,function(i){var f,s,u,e,h,o;if(i.cancel)t.parent.isDragging=!1,n.cancel=!0;else{if(t.parent.isDragging=!0,Object(r.addClass)([n.draggedNode.querySelector(".e-list-text")],"e-list-selected"),f=void 0,s=["e-rows","e-columns","e-filters"],(f="olap"===t.parent.dataType?t.parent.olapEngineModule.fieldList[n.draggedNode.getAttribute("data-uid")]:t.parent.engineModule.fieldList[n.draggedNode.getAttribute("data-uid")])&&"CalculatedField"===f.aggregateType)for(u=0,e=s;u<e.length;u++)h=e[u],Object(r.addClass)([t.parentElement.querySelector("."+h)],"e-drag-restrict");o=n.clonedNode;o&&"Popup"===("pivotfieldlist"===t.parent.getModuleName()&&t.parent.renderMode)&&(o.style.zIndex=(t.parent.dialogRenderer.fieldListDialog.zIndex+1).toString())}})):(this.parent.isDragging=!1,n.cancel=!0)},n.prototype.dragStop=function(n){var t,u,f,i,e;for(n.cancel=!0,this.parent.isDragging=!1,t=0,u=["e-rows","e-columns","e-filters"];t<u.length;t++)f=u[t],Object(r.removeClass)([this.parentElement.querySelector("."+f)],"e-drag-restrict");Object(r.removeClass)([n.draggedNode.querySelector(".e-list-text")],"e-list-selected");this.parent.pivotCommon.filterDialog.dialogPopUp&&this.parent.pivotCommon.filterDialog.dialogPopUp.close();i=n.draggedNodeData.id.toString();this.isNodeDropped(n,i)&&(e=this.parent.pivotFieldList[i],(this.parent.pivotCommon.dataSourceUpdate.control="pivotview"===this.parent.getModuleName()?this.parent:this.parent.pivotGridModule?this.parent.pivotGridModule:this.parent,this.parent.pivotCommon.nodeStateModified.onStateModified(n,i))&&(this.parent.allowDeferLayoutUpdate?(e.isSelected=!0,this.updateDataSource()):this.parent.updateDataSource(),this.parent.axisFieldModule.render()))},n.prototype.isNodeDropped=function(n,t){var s=!0,l,a;if("true"===n.draggedNodeData.isChecked){var f=this.getButton(t),h=Object(r.closest)(f,".e-droppable"),v=Object(r.closest)(n.target,".e-droppable");if(f&&h===v){for(var u=[].slice.call(h.querySelectorAll(".e-pivot-button")),c=Object(r.closest)(n.target,".e-pvt-btn-div"),e=void 0,o=-1,i=0,y=u.length;i<y;i++)(u[i].id===f.id&&(e=i),c)&&(l=c.querySelector(".e-pivot-button"),u[i].id===l.id&&(o=i));(e===o||e===u.length-1&&-1===o)&&(a=document.getElementById(this.parent.element.id+"_Wrapper"),Object(r.removeClass)([].slice.call(a.querySelectorAll(".e-drop-indicator")),"e-drop-hover"),s=!1)}}return s},n.prototype.getButton=function(n){for(var r,u=document.getElementById(this.parent.element.id+"_Wrapper"),i=[].slice.call(u.querySelectorAll(".e-pivot-button")),t=0,f=i.length;t<f;t++)if(i[t].id===n){r=i[t];break}return r},n.prototype.nodeStateChange=function(n){var t=this,o=Object(r.closest)(n.node,".e-text-content"),s,i,c,l;if(!Object(r.isNullOrUndefined)(o)){s=Object(r.closest)(o,"li");i=s.getAttribute("data-uid");this.parent.pivotCommon.filterDialog.dialogPopUp&&this.parent.pivotCommon.filterDialog.dialogPopUp.close();var u=this.parent.pivotFieldList[i],f=e.getFieldInfo(i,this.parent),h=this.parent.isPopupView?this.parent.pivotGridModule:this.parent;"check"===n.action?(c={fieldName:i,dropField:f.fieldItem,dataSourceSettings:e.getClonedDataSourceSettings(this.parent.dataSourceSettings),dropAxis:"number"===u.type||"CalculatedField"===u.type&&u.formula&&u.formula.indexOf("Measure")>-1&&"olap"===this.parent.dataType?"values":"rows",dropPosition:f.position,draggedAxis:"fieldlist",cancel:!1},h.trigger("fieldDrop",c,function(e){if(e.cancel)t.updateCheckState(u);else{Object(r.addClass)([o.querySelector(".e-list-text")],"e-selected-node");t.updateSelectedNodes(s,n.action);var h=t.parent.pivotCommon.dataSourceUpdate.getNewField(i,f.fieldItem);t.updateReportSettings(h,e);t.updateNodeStateChange(i,n,u)}})):(l={cancel:!1,fieldName:i,dataSourceSettings:e.getClonedDataSourceSettings(this.parent.dataSourceSettings),fieldItem:f.fieldItem,axis:f.axis},h.trigger("fieldRemove",l,function(f){f.cancel?t.updateCheckState(u):(Object(r.removeClass)([o.querySelector(".e-list-text")],"e-selected-node"),t.updateSelectedNodes(s,n.action),t.parent.pivotCommon.dataSourceUpdate.removeFieldFromReport(i),"olap"===t.parent.dataType&&0===t.parent.dataSourceSettings.values.length&&t.parent.pivotCommon.dataSourceUpdate.removeFieldFromReport("[Measures]"),t.updateNodeStateChange(i,n,u))}))}},n.prototype.updateReportSettings=function(n,t){var i=t.dropPosition,r;switch(t.dropAxis){case"filters":-1!==i?this.parent.dataSourceSettings.filters.splice(i,0,n):this.parent.dataSourceSettings.filters.push(n);break;case"rows":-1!==i?this.parent.dataSourceSettings.rows.splice(i,0,n):this.parent.dataSourceSettings.rows.push(n);break;case"columns":-1!==i?this.parent.dataSourceSettings.columns.splice(i,0,n):this.parent.dataSourceSettings.columns.push(n);break;case"values":(-1!==i?this.parent.dataSourceSettings.values.splice(i,0,n):this.parent.dataSourceSettings.values.push(n),"olap"===this.parent.dataType&&this.parent.olapEngineModule&&!this.parent.olapEngineModule.isMeasureAvail)&&(r={name:"[Measures]",caption:"Measures",baseField:void 0,baseItem:void 0},("row"===this.parent.dataSourceSettings.valueAxis?this.parent.dataSourceSettings.rows:this.parent.dataSourceSettings.columns).push(r))}},n.prototype.updateCheckState=function(n){for(var i=this.fieldTable.element.querySelectorAll(".e-checkbox-wrapper"),u=this.fieldTable.element.querySelectorAll(".e-list-text"),r=this.fieldTable.element.querySelectorAll(".e-frame"),t=0;t<i.length;t++)n.caption===u[t].textContent&&("false"===i[t].getAttribute("aria-checked")?(i[t].setAttribute("aria-checked","false"),r[t].classList.add("e-check")):(i[t].setAttribute("aria-checked","true"),r[t].classList.remove("e-check")))},n.prototype.updateNodeStateChange=function(n,t,i){this.parent.allowDeferLayoutUpdate?(i.isSelected="check"===t.action,"olap"===this.parent.dataType&&this.parent.olapEngineModule.updateFieldlistData(n,"check"===t.action),this.updateDataSource()):this.parent.updateDataSource(!0);var r=this.parent;setTimeout(function(){r.axisFieldModule.render()})},n.prototype.updateSelectedNodes=function(n,t){var i,u,f;if(n&&n.querySelector("ul"))for(i=0,u=[].slice.call(n.querySelectorAll("li"));i<u.length;i++)f=u[i],"check"===t?Object(r.addClass)([f.querySelector(".e-list-text")],"e-selected-node"):Object(r.removeClass)([f.querySelector(".e-list-text")],"e-selected-node")},n.prototype.updateDataSource=function(){"pivotfieldlist"===this.parent.getModuleName()&&"Popup"===this.parent.renderMode?("olap"===this.parent.dataType?this.parent.pivotGridModule.olapEngineModule=this.parent.olapEngineModule:this.parent.pivotGridModule.engineModule=this.parent.engineModule,this.parent.pivotGridModule.setProperties({dataSourceSettings:this.parent.dataSourceSettings.properties},!0),this.parent.pivotGridModule.notify(ft,this)):this.parent.triggerPopulateEvent()},n.prototype.addNode=function(n){var t=this,i=this.parent.pivotFieldList[n.data[0].id.toString()],r=e.getFieldInfo(i.id.toString(),this.parent),u=this.parent.isPopupView?this.parent.pivotGridModule:this.parent,f,o;"check"===n.action?(f={fieldName:r.fieldName,dropField:r.fieldItem,dataSourceSettings:e.getClonedDataSourceSettings(this.parent.dataSourceSettings),dropAxis:"rows",draggedAxis:"fieldlist",cancel:!1},u.trigger("fieldDrop",f,function(n){n.cancel?t.updateCheckState(i):t.selectedNodes.push(i.id.toString())})):(o={cancel:!1,fieldName:r.fieldName,dataSourceSettings:e.getClonedDataSourceSettings(this.parent.dataSourceSettings),fieldItem:r.fieldItem,axis:r.axis},u.trigger("fieldRemove",o,function(n){if(n.cancel)t.updateCheckState(i);else for(var r=t.selectedNodes.length;r--;)if(t.selectedNodes[r]===i.id.toString()){t.selectedNodes.splice(r,1);break}}))},n.prototype.refreshTreeView=function(){if(this.fieldTable){var n=this.getUpdatedData();this.fieldTable.fields={dataSource:n,id:"id",text:"caption",isChecked:"isSelected",parentID:"pid",iconCss:"spriteCssClass"};this.fieldTable.dataBind()}},n.prototype.getUpdatedData=function(){var n=this.getTreeData(),t=this.fieldTable.expandedNodes;return this.updateExpandedNodes(n,t),this.applySorting(n,this.fieldListSort)},n.prototype.getTreeData=function(n){var f=[],o,t,a,s,u,h,y;if("olap"===this.parent.dataType)f=this.getOlapTreeData(n);else{for(var i=Object.keys(this.parent.pivotFieldList),r={},e=0,l=i;e<l.length;e++)o=l[e],t=this.parent.pivotFieldList[o],r[o]={id:t.id,caption:t.caption,isSelected:t.isSelected};if(this.parent.isAdaptive){for(a=[this.parent.dataSourceSettings.filters,this.parent.dataSourceSettings.columns,this.parent.dataSourceSettings.rows,this.parent.dataSourceSettings.values][n],s=i.length;s--;)r[i[s]].isSelected=!1;for(u=0,h=a;u<h.length;u++)r[h[u].name].isSelected=!0}for(var p=r,c=0,v=i;c<v.length;c++)y=p[t=v[c]],f.push(y)}return f},n.prototype.getOlapTreeData=function(n){var r=[],l=this.parent.olapEngineModule.fieldListData,s,u,t,i,f,h,a,o,c,v;if(this.parent.isAdaptive)for(s=[this.parent.dataSourceSettings.filters,this.parent.dataSourceSettings.columns,this.parent.dataSourceSettings.rows,this.parent.dataSourceSettings.values][n],u=0;u<l.length;){if(t=l[u],i=void 0,3===n){if("[measures]"!==t.id.toLowerCase()&&(0===t.id.toLowerCase().indexOf("[measures]")||t.spriteCssClass&&-1!==t.spriteCssClass.indexOf("e-measureCDB"))||"[calculated members].[_0]"===t.id.toLowerCase()||t.spriteCssClass&&-1!==t.spriteCssClass.indexOf("e-calc-measure-icon")){for((i={id:t.id,caption:t.caption,hasChildren:t.hasChildren,type:t.type,aggregateType:t.aggregateType,isSelected:t.isSelected,pid:t.pid,spriteCssClass:t.spriteCssClass}).isSelected=!1,i.spriteCssClass&&-1!==i.spriteCssClass.indexOf("e-measureCDB")&&(i.spriteCssClass=i.spriteCssClass.replace("e-folderCDB-icon","e-measureGroupCDB-icon"),i.pid=void 0),f=0,h=s;f<h.length;f++)if(a=h[f],i.id===a.name){i.isSelected=!0;break}r.push(i)}}else if(!(0===t.id.toLowerCase().indexOf("[measures]")||t.spriteCssClass&&-1!==t.spriteCssClass.indexOf("e-measureCDB")||t.spriteCssClass&&-1!==t.spriteCssClass.indexOf("e-calc-measure-icon"))){for((i={id:t.id,caption:t.caption,hasChildren:t.hasChildren,type:t.type,aggregateType:t.aggregateType,isSelected:t.isSelected,pid:t.pid,spriteCssClass:t.spriteCssClass}).isSelected=!1,o=0,c=s;o<c.length;o++)if(v=c[o],i.id===v.name){i.isSelected=!0;break}r.push(i)}u++}else r=e.getClonedData(this.parent.olapEngineModule.fieldListData);return r},n.prototype.updateExpandedNodes=function(n,t){var i;if(t.length>0)for(var u=0,r=0,f=n;r<f.length;r++)if(i=f[r],t.indexOf(i.id)>-1&&(u++,i.expanded=!0,i.spriteCssClass=i.spriteCssClass&&i.spriteCssClass.toString().indexOf("e-folderCDB-icon")>-1?i.spriteCssClass.toString().replace("e-folderCDB-icon","e-folderCDB-open-icon"):i.spriteCssClass,u===t.length))break},n.prototype.updateSorting=function(n){var t=n.target,i=t.getAttribute("data-sort");if(-1===t.className.indexOf("e-selected")){switch(i){case"None":this.fieldListSort="None";Object(r.addClass)([t],"e-selected");Object(r.removeClass)([this.parentElement.querySelector(".e-sort-ascend")],"e-selected");Object(r.removeClass)([this.parentElement.querySelector(".e-sort-descend")],"e-selected");break;case"Ascend":this.fieldListSort="Ascend";Object(r.addClass)([t],"e-selected");Object(r.removeClass)([this.parentElement.querySelector(".e-sort-none")],"e-selected");Object(r.removeClass)([this.parentElement.querySelector(".e-sort-descend")],"e-selected");break;case"Descend":this.fieldListSort="Descend";Object(r.addClass)([t],"e-selected");Object(r.removeClass)([this.parentElement.querySelector(".e-sort-ascend")],"e-selected");Object(r.removeClass)([this.parentElement.querySelector(".e-sort-none")],"e-selected")}this.refreshTreeView()}},n.prototype.applySorting=function(n,t){if("olap"===this.parent.dataType){var i=void 0,r=void 0;this.parent.dataSourceSettings.calculatedFieldSettings.length>0&&"[calculated members].[_0]"===n[0].id.toLowerCase()?(r=n[0],i=n[1],n.splice(0,2)):(i=n[0],n.splice(0,1));n="Ascend"===t?n.sort(function(n,t){return n.caption>t.caption?1:t.caption>n.caption?-1:0}):"Descend"===t?n.sort(function(n,t){return n.caption<t.caption?1:t.caption<n.caption?-1:0}):n;r?n.splice(0,0,r,i):n.splice(0,0,i)}else this.fieldTable.sortOrder="Ascend"===t?"Ascending":"Descend"===t?"Descending":"None";return n},n.prototype.onFieldAdd=function(){this.parent.dialogRenderer.updateDataSource(this.selectedNodes);this.closeTreeDialog()},n.prototype.closeTreeDialog=function(){this.selectedNodes=[];this.fieldDialog.hide()},n.prototype.keyPress=function(n){return n.target,13===n.keyCode&&n.target?(n.target.click(),void n.preventDefault()):void 0},n.prototype.wireFieldListEvent=function(n){r.EventHandler.add(n,"keydown",this.keyPress,this);r.EventHandler.add(n,"click",this.updateSorting,this)},n.prototype.unWireFieldListEvent=function(n){r.EventHandler.remove(n,"keydown",this.keyPress);r.EventHandler.remove(n,"click",this.updateSorting)},n.prototype.addEventListener=function(){this.parent.on("tree-view-update",this.refreshTreeView,this)},n.prototype.removeEventListener=function(){this.parent.isDestroyed||this.parent.off("tree-view-update",this.refreshTreeView)},n.prototype.destroy=function(){this.removeEventListener()},n}(),te=function(){function n(n){this.parent=n}return n.prototype.render=function(){if(!this.parent.isAdaptive){var n=Object(r.createElement)("div",{className:"e-axis-table "+("olap"===this.parent.dataType?"e-olap-axis-table":"")});this.leftAxisPanel=Object(r.createElement)("div",{className:"e-left-axis-fields"});this.rightAxisPanel=Object(r.createElement)("div",{className:"e-right-axis-fields"});this.parent.dialogRenderer.parentElement.appendChild(n);n.appendChild(this.leftAxisPanel);n.appendChild(this.rightAxisPanel);this.axisTable=n;this.renderAxisTable()}this.parent.axisFieldModule.render()},n.prototype.renderAxisTable=function(){for(var u,e,o,t=["filters","rows","columns","values"],n=0,s=t.length;n<s;n++){var i=Object(r.createElement)("div",{className:"e-field-list-"+t[n]}),f=Object(r.createElement)("div",{className:"e-axis-wrapper"}),h=Object(r.createElement)("div",{className:"e-axis-header",attrs:{title:this.parent.localeObj.getConstant(t[n])},innerHTML:this.parent.localeObj.getConstant(t[n])});f.appendChild(this.getIconupdate(t[n]));f.appendChild(h);u=Object(r.createElement)("div",{className:"e-axis-content e-"+t[n]});e=void 0;e="rows"===t[n]?this.parent.localeObj.getConstant("dropRowPrompt"):"columns"===t[n]?this.parent.localeObj.getConstant("dropColPrompt"):"values"===t[n]?this.parent.localeObj.getConstant("dropValPrompt"):this.parent.localeObj.getConstant("dropFilterPrompt");o=Object(r.createElement)("span",{className:"e-draggable-prompt",innerHTML:e});new r.Droppable(u,{});i.appendChild(f);i.appendChild(u);i.appendChild(o);n<=1?this.leftAxisPanel.appendChild(i):this.rightAxisPanel.appendChild(i);this.unWireEvent(u);this.wireEvent(u)}},n.prototype.getIconupdate=function(n){var t=Object(r.createElement)("span",{attrs:{tabindex:"-1","aria-disabled":"false"},className:"e-axis-icon-wrapper"}),i=Object(r.createElement)("span",{attrs:{tabindex:"-1","aria-disabled":"false"},className:h+" e-axis-"+n});return t.appendChild(i),t},n.prototype.wireEvent=function(n){r.EventHandler.add(n,"mouseover",this.updateDropIndicator,this);r.EventHandler.add(n,"mouseleave",this.updateDropIndicator,this)},n.prototype.unWireEvent=function(n){r.EventHandler.remove(n,"mouseover",this.updateDropIndicator);r.EventHandler.remove(n,"mouseleave",this.updateDropIndicator)},n.prototype.updateDropIndicator=function(n){var t=this.parent.dialogRenderer.parentElement,i;this.parent.isDragging&&n.target.classList.contains("e-axis-content")&&"mouseover"===n.type?(Object(r.removeClass)([].slice.call(t.querySelectorAll(".e-drop-indicator")),"e-drop-hover"),Object(r.removeClass)([].slice.call(t.querySelectorAll(".e-drop-indicator-last")),"e-drop-hover"),i=[].slice.call(n.target.querySelectorAll(".e-pvt-btn-div")),i.length>0&&Object(r.addClass)([i[i.length-1].querySelector(".e-drop-indicator-last")],"e-drop-hover")):"mouseleave"===n.type&&(Object(r.removeClass)([].slice.call(t.querySelectorAll(".e-drop-indicator")),"e-drop-hover"),Object(r.removeClass)([].slice.call(t.querySelectorAll(".e-drop-indicator-last")),"e-drop-hover"))},n}(),ur=function(){function n(n){this.parent=n;this.menuOption=new ai(this.parent);this.parent.pivotButtonModule=this;this.addEventListener();this.parent instanceof ni&&(this.axisField=new fr(this.parent));this.isDestroyed=!1}return n.prototype.renderPivotButton=function(n){var w,i=Object(r.extend)([],n.field,null,!0),u=n.axis,s=-1,st="pivot"===this.parent.dataType&&("pivotfieldlist"===this.parent.getModuleName()&&this.parent.pivotGridModule?this.parent.pivotGridModule.showValuesButton:this.parent.showValuesButton),p,b,nt,t,ft,k,tt,l,it,d,y,rt,c;if(("row"===this.parent.dataSourceSettings.valueAxis&&"rows"===n.axis||"column"===this.parent.dataSourceSettings.valueAxis&&"columns"===n.axis)&&st&&this.parent.dataSourceSettings.values.length>1&&(s=i.length,Object(r.isNullOrUndefined)(e.getFieldByName(this.parent.localeObj.getConstant("values"),i))&&i.push({name:this.parent.localeObj.getConstant("values"),caption:this.parent.localeObj.getConstant("values"),axis:n.axis,showRemoveIcon:!0,allowDragAndDrop:!0})),this.parentElement="pivotview"===this.parent.getModuleName()?this.parent.element:document.getElementById(this.parent.element.id+"_Wrapper"),"pivotfieldlist"===this.parent.getModuleName()){if(this.parentElement=document.getElementById(this.parent.element.id+"_Wrapper"),!this.parentElement.querySelector(".e-field-list-"+u))return;p=this.parentElement.querySelector(".e-field-list-"+u).querySelector(".e-draggable-prompt");0===i.length?Object(r.removeClass)([p],"e-disable"):Object(r.addClass)([p],"e-disable");w=this.parentElement.querySelector(".e-field-list-"+u).querySelector(".e-axis-content")}else this.parentElement=this.parent.element,w=this.parentElement.querySelector(".e-group-"+u);if(w)if("pivotview"===this.parent.getModuleName()&&0===i.length)for(b=0,nt=this.parentElement.querySelectorAll(".e-group-"+u);b<nt.length;b++)(c=nt[b]).classList.contains("e-group-chart-values")||(p=Object(r.createElement)("span",{className:"e-draggable-prompt",innerHTML:this.parent.groupingBarSettings.allowDragAndDrop?"rows"===u?this.parent.localeObj.getConstant("rowAxisPrompt"):"columns"===u?this.parent.localeObj.getConstant("columnAxisPrompt"):"values"===u?this.parent.localeObj.getConstant("valueAxisPrompt"):this.parent.localeObj.getConstant("filterAxisPrompt"):""}),c.appendChild(p));else{for(t=0,ft=i.length;t<ft;t++)for(k=0,tt="pivotfieldlist"===this.parent.getModuleName()?[w]:this.parentElement.querySelectorAll(".e-group-"+u);k<tt.length;k++)if(c=c=tt[k],l="olap"===this.parent.dataType&&("[measures]"===i[t].name.toLowerCase()||"values"===u),it="olap"===this.parent.dataType&&"values"===u,!c.classList.contains("e-group-chart-values")){var v=Object(r.createElement)("div",{className:"e-pvt-btn-div"+(0===t?" e-first-btn":""),attrs:{"data-tag":u+":"+i[t].name}}),f=Object(r.createElement)("div",{id:i[t].name,className:"e-pivot-button "+i[t].name.replace(/[^A-Z0-9]/gi,""),attrs:{"data-uid":i[t].name,tabindex:"0",isvalue:t===s||l&&!it?"true":"false","aria-disabled":"false","aria-label":i[t].caption?i[t].caption:i[t].name,"data-type":"olap"===this.parent.dataType?it?"isMeasureFieldsAvail":l?"isMeasureAvail":i[t].type:i[t].type,"data-caption":i[t].caption?i[t].caption:i[t].name,"data-basefield":i[t].baseField,"data-baseitem":i[t].baseItem}}),ht=Object(r.createElement)("span",{attrs:{tabindex:"-1","aria-disabled":"false"},className:"e-drop-indicator"}),ct=Object(r.createElement)("span",{attrs:{tabindex:"-1","aria-disabled":"false"},className:"e-drop-indicator-last"}),lt=this.createButtonDragIcon(i[t],f),et=this.createButtonText(i,t,u,s);(f.appendChild(et),l||i[t].isNamedSet||i[t].isCalculatedField||(-1!==["filters","values"].indexOf(u)||s===t||"olap"===this.parent.dataType&&("pivotview"===this.parent.getModuleName()&&this.parent.enableVirtualization||"pivotfieldlist"===this.parent.getModuleName()&&void 0!==this.parent.pivotGridModule&&this.parent.pivotGridModule.enableVirtualization)||this.createSortOption(f,i[t].name,i[t]),"values"!==u&&s!==t&&this.createFilterOption(f,i[t].name,u,i[t]),"values"===u&&this.getTypeStatus(i,t,f)),i[t].isCalculatedField||"CalculatedField"===i[t].type)&&(d=Object(r.createElement)("span",{attrs:{tabindex:"-1","aria-disabled":"false",title:this.parent.localeObj.getConstant("editCalculatedField")},className:h+" e-edit"}),this.parent.allowCalculatedField&&this.parent.calculatedFieldModule&&i[t].showEditIcon?Object(r.removeClass)([d],"e-disable"):Object(r.addClass)([d],"e-disable"),f.appendChild(d));y=Object(r.createElement)("span",{attrs:{tabindex:"-1","aria-disabled":"false",title:this.parent.localeObj.getConstant("remove")},className:h+" e-remove"});"pivotview"===this.parent.getModuleName()?this.parent.groupingBarSettings.showRemoveIcon&&i[t].showRemoveIcon?Object(r.removeClass)([y],"e-disable"):Object(r.addClass)([y],"e-disable"):i[t].showRemoveIcon?Object(r.removeClass)([y],"e-disable"):Object(r.addClass)([y],"e-disable");f.appendChild(y);v.appendChild(ht);v.appendChild(f);v.appendChild(ct);c.appendChild(v);rt=new g.Button({enableRtl:this.parent.enableRtl});rt.isStringTemplate=!0;rt.appendTo(f);this.unWireEvent(v,t===s?"values":u,l);this.wireEvent(v,t===s?"values":u,l);("pivotview"===this.parent.getModuleName()&&!this.parent.isAdaptive||"pivotfieldlist"===this.parent.getModuleName())&&this.createDraggable(i[t],"pivotview"===this.parent.getModuleName()?et:lt)}if("values"===u)for(var at=function(n){var u,t,f;n.classList.contains("e-group-chart-values")&&o.parent.chartModule&&(u=i.map(function(n){return{text:n.caption?n.caption:n.name,value:n.name}}),t=o.parent,o.valueFiedDropDownList&&n.querySelector(".e-group-chart-values-drodown-div")?(o.valueFiedDropDownList.dataSource=u,o.valueFiedDropDownList.value=t.chartSettings.enableMultiAxis?u[0].value:t.chartModule.currentMeasure):(f=Object(r.createElement)("div",{className:"e-group-chart-values-drodown-div"}),n.appendChild(f),o.valueFiedDropDownList=new a.DropDownList({dataSource:u,enableRtl:o.parent.enableRtl,value:t.chartSettings.enableMultiAxis?u[0].value:t.chartModule.currentMeasure,width:200,fields:{value:"value",text:"text"},cssClass:"e-group-chart-values-drodown",change:function(n){n.e&&null!==n.e&&(t.chartSettings.value=n.value)}}),o.valueFiedDropDownList.isStringTemplate=!0,o.valueFiedDropDownList.appendTo(f)))},o=this,ut=0,ot=this.parentElement.querySelectorAll(".e-group-"+u);ut<ot.length;ut++)at(c=ot[ut])}},n.prototype.createButtonText=function(n,t,i,u){var e,s,o,f;return"filters"===i&&(s=this.updateButtontext(n[t].name)),void 0!==(o="olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule).fieldList[n[t].name]&&(e="DistinctCount"===(e=o.fieldList[n[t].name].aggregateType)||"number"===o.fieldList[n[t].name].type&&"include"!==o.fieldList[n[t].name].type&&"exclude"!==o.fieldList[n[t].name].type?void 0===e?"Sum":o.fieldList[n[t].name].aggregateType:"Count"),f=n[t].caption?n[t].caption:n[t].name,Object(r.createElement)("span",{attrs:{title:"filters"===i?"olap"===this.parent.dataType&&"CalculatedField"===o.fieldList[n[t].name].type?f:f+" ("+s+")":"olap"===this.parent.dataType?f:this.parent.dataSourceSettings.showAggregationOnValueField&&"values"===i&&"CalculatedField"!==e?this.parent.localeObj.getConstant(e)+" "+this.parent.localeObj.getConstant("of")+" "+f:f,tabindex:"-1","aria-disabled":"false",oncontextmenu:"return false;","data-type":u===t?"":e},className:"e-content "+("pivotview"===this.parent.getModuleName()?this.parent.groupingBarSettings.allowDragAndDrop&&n[t].allowDragAndDrop?"":"e-disable-drag":""),innerHTML:"filters"===i?"olap"===this.parent.dataType&&"CalculatedField"===o.fieldList[n[t].name].type?f:f+" ("+s+")":"olap"===this.parent.dataType?f:this.parent.dataSourceSettings.showAggregationOnValueField&&"values"===i&&"CalculatedField"!==e?this.parent.localeObj.getConstant(e)+" "+this.parent.localeObj.getConstant("of")+" "+f:f})},n.prototype.getTypeStatus=function(n,t,i){var r=("olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule).fieldList[n[t].name];"CalculatedField"!==r.aggregateType&&this.validateDropdown(r.type)&&this.createSummaryType(i,n[t].name,n[t])},n.prototype.validateDropdown=function(n){var t=this.parent.aggregateTypes,i;if("number"!==n)return t.indexOf("Count")>-1||t.indexOf("DistinctCount")>-1;for(i=0;i<t.length;i++)if(this.parent.getAllSummaryType().indexOf(t[i])>-1)return!0;return!1},n.prototype.createSummaryType=function(n,t,i){var u=Object(r.createElement)("span",{attrs:{tabindex:"-1","aria-disabled":"false",title:this.parent.localeObj.getConstant("format")},className:h+" e-dropdown-icon"});return"pivotview"===this.parent.getModuleName()?this.parent.groupingBarSettings.showValueTypeIcon&&i.showValueTypeIcon?Object(r.removeClass)([u],"e-disable"):Object(r.addClass)([u],"e-disable"):i.showValueTypeIcon?Object(r.removeClass)([u],"e-disable"):Object(r.addClass)([u],"e-disable"),n.appendChild(u),u},n.prototype.createMenuOption=function(n){this.menuOption.render(n,this.parentElement);this.parent.pivotButtonModule=this},n.prototype.openCalculatedFieldDialog=function(n){var t=n.target.parentElement.id;"pivotview"===this.parent.getModuleName()?this.parent.isAdaptive&&this.parent.showFieldList&&this.parent.pivotFieldListModule&&!this.parent.pivotFieldListModule.isDestroyed?(this.parent.pivotFieldListModule.element.querySelector(".e-toggle-field-list").click(),this.parent.pivotFieldListModule.dialogRenderer.adaptiveElement.select(4),this.parent.pivotFieldListModule.calculatedFieldModule.updateAdaptiveCalculatedField(!0,t)):this.parent.notify("init-calculatedfield",{edit:!0,fieldName:t}):"pivotfieldlist"===this.parent.getModuleName()&&(this.parent.isAdaptive?(this.parent.dialogRenderer.adaptiveElement.select(4),this.parent.calculatedFieldModule.updateAdaptiveCalculatedField(!0,t)):(this.parent.dialogRenderer.fieldListDialog&&(this.parent.dialogRenderer.fieldListDialog.hide(),Object(r.addClass)([this.parent.element.querySelector(".e-toggle-field-list")],"e-hide")),this.parent.notify("init-calculatedfield",{edit:!0,fieldName:t})))},n.prototype.createDraggable=function(n,t){this.draggable=new r.Draggable(t,{clone:!0,enableTailMode:!0,enableAutoScroll:!0,helper:this.createDragClone.bind(this),dragStart:this.onDragStart.bind(this),drag:this.onDragging.bind(this),dragStop:this.onDragStop.bind(this),abort:"pivotview"===this.parent.getModuleName()?this.parent.groupingBarSettings.allowDragAndDrop&&n.allowDragAndDrop?"":".e-pivot-button":n.allowDragAndDrop?"":".e-pivot-button"})},n.prototype.createButtonDragIcon=function(n,t){var i=Object(r.createElement)("span",{attrs:{tabindex:"-1","aria-disabled":"false"}}),u=Object(r.createElement)("span",{attrs:{tabindex:"-1","aria-disabled":"false",title:this.parent.localeObj.getConstant("drag")},className:h+" e-drag "+(n.allowDragAndDrop?"":"e-disable-drag")});return i.appendChild(u),t.appendChild(i),i},n.prototype.createSortOption=function(n,t,i){var e,u,o,f;if(o="olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule,this.parent.allowDeferLayoutUpdate)for(e="",f=0;f<this.parent.dataSourceSettings.sortSettings.length;f++)this.parent.dataSourceSettings.sortSettings[f].name===t&&(e="Descending"===this.parent.dataSourceSettings.sortSettings[f].order?"e-descend":"");else e="Descending"===o.fieldList[t].sort?"e-descend":"";return u="None"===o.fieldList[t].sort?Object(r.createElement)("span",{attrs:{tabindex:"-1","aria-disabled":"false",title:this.parent.localeObj.getConstant("sort")},className:h}):Object(r.createElement)("span",{attrs:{tabindex:"-1","aria-disabled":"false",title:this.parent.localeObj.getConstant("sort")},className:h+" e-sort "+e}),this.parent.dataSourceSettings.enableSorting?"pivotview"===this.parent.getModuleName()?i.showSortIcon&&this.parent.groupingBarSettings.showSortIcon?Object(r.removeClass)([u],"e-disable"):Object(r.addClass)([u],"e-disable"):i.showSortIcon?Object(r.removeClass)([u],"e-disable"):Object(r.addClass)([u],"e-disable"):Object(r.addClass)([u],"e-disable"),n.appendChild(u),u},n.prototype.createFilterOption=function(n,t,i,u){var o,e,s,f;if(e="olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule,this.parent.allowDeferLayoutUpdate)for(o="e-pv-filter",s=0;s<this.parent.dataSourceSettings.filterSettings.length;s++)this.parent.dataSourceSettings.filterSettings[s].name===t&&(o="e-pv-filtered");else e.fieldList[t].filter=null===e.fieldList[t].filter?[]:e.fieldList[t].filter,o=0===e.fieldList[t].filter.length?e.fieldList[t].isExcelFilter?"e-pv-filtered":"e-pv-filter":"e-pv-filtered";return f=Object(r.createElement)("span",{attrs:{tabindex:"-1","aria-disabled":"false",title:this.parent.localeObj.getConstant("filter")},className:"e-btn-filter "+h+" "+o}),(this.parent.dataSourceSettings.allowLabelFilter||this.parent.dataSourceSettings.allowValueFilter)&&"filters"!==i||this.parent.dataSourceSettings.allowMemberFilter?Object(r.removeClass)([f],"e-disable"):Object(r.addClass)([f],"e-disable"),"pivotview"===this.parent.getModuleName()?((this.parent.dataSourceSettings.allowLabelFilter||this.parent.dataSourceSettings.allowValueFilter)&&"filters"!==i||this.parent.dataSourceSettings.allowMemberFilter)&&this.parent.groupingBarSettings.showFilterIcon&&u.showFilterIcon?Object(r.removeClass)([f],"e-disable"):Object(r.addClass)([f],"e-disable"):u.showFilterIcon&&((this.parent.dataSourceSettings.allowLabelFilter||this.parent.dataSourceSettings.allowValueFilter)&&"filters"!==i||this.parent.dataSourceSettings.allowMemberFilter)?Object(r.removeClass)([f],"e-disable"):Object(r.addClass)([f],"e-disable"),n.appendChild(f),f},n.prototype.updateButtontext=function(n){var t,i,r=(t="olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule).fieldList[n].filter.length,o=t.fieldList[n].filterType,s=t.fieldList[n].dateMember.length,f=t.fieldList[n].filter[0],h;if("olap"===this.parent.dataType)i=this.updateOlapButtonText(t,n,f,r);else if("include"===o)1===r?i=f:r>1&&(i=r===s?this.parent.localeObj.getConstant("all"):this.parent.localeObj.getConstant("multipleItems"));else if("exclude"===o){if(1===r)i=2===s?f!==t.fieldList[n].dateMember[0].actualText?f:t.fieldList[n].dateMember[0].actualText:this.parent.localeObj.getConstant("multipleItems");else if(r>1){var u=void 0,e=Object.keys(t.fieldList[n].members),c=t.fieldList[n].filter;if(r===e.length-1){n:for(u=0;u<e.length;u++)if(h=e[u],-1===c.indexOf(h)){i=e[u];break n}}else i=this.parent.localeObj.getConstant("multipleItems")}}else i=this.parent.localeObj.getConstant("all");return i},n.prototype.updateOlapButtonText=function(n,t,i,r){var s,a=n.fieldList[t].actualFilter,f,e,h,l,u;if(a.length>0){if(f=n.fieldList[t].members,e=[],n.fieldList[t].filterMembers.length>0){for(var o={},c=0,v=a;c<v.length;c++)o[u=v[c]]=u,f[u]&&(o=this.parent.pivotCommon.eventBase.getParentNode(t,u,o));for(h=0,l=o?Object.keys(o):[];h<l.length;h++)f[u=l[h]].isSelected&&(f[u].parent&&f[f[u].parent].isSelected||e.push(u));i=1===e.length?f[e[0]].caption:i}r=0===e.length?r:e.length}return 0===r?s=n.fieldList[t].allMember?n.fieldList[t].allMember:this.parent.localeObj.getConstant("all"):1===r?s=i:r>1&&(s=this.parent.localeObj.getConstant("multipleItems")),s},n.prototype.createDragClone=function(n){var i=Object(r.closest)(n.element,".e-pivot-button"),t=Object(r.createElement)("div",{id:this.parent.element.id+"_DragClone",className:"e-button-drag-clone"}),u=Object(r.createElement)("span",{className:"e-text-content",innerHTML:i.textContent});return t.appendChild(u),document.body.appendChild(t),t},n.prototype.onDragStart=function(n){var t=this,i=Object(r.closest)(n.element,".e-pivot-button"),u=document.getElementById(this.parent.element.id+"_DragClone"),f=e.getFieldInfo(i.getAttribute("data-uid"),this.parent),o={fieldName:f.fieldName,fieldItem:f.fieldItem,axis:f.axis,dataSourceSettings:e.getClonedDataSourceSettings(this.parent.dataSourceSettings),cancel:!1};("pivotfieldlist"===this.parent.getModuleName()&&this.parent.isPopupView?this.parent.pivotGridModule:this.parent).trigger("fieldDragStart",o,function(f){var o,h,c,e,s,l;if(f.cancel)t.parent.isDragging=!1,t.draggable.intDestroy(n.event),Object(r.detach)(u);else{if(t.parent.isDragging=!0,o=("olap"===t.parent.dataType?t.parent.olapEngineModule:t.parent.engineModule).fieldList[i.getAttribute("data-uid")],h=["e-rows","e-columns","e-filters"],(Object(r.addClass)([i],"e-list-selected"),u&&"Popup"===("pivotfieldlist"===t.parent.getModuleName()&&t.parent.renderMode))&&(c=t.parent,u.style.zIndex=(c.dialogRenderer.fieldListDialog.zIndex+1).toString()),o&&"CalculatedField"===o.aggregateType)for(e=0,s=h;e<s.length;e++)l=s[e],Object(r.addClass)([t.parentElement.querySelector("."+l)],"e-drag-restrict");Object(r.isBlazor)()&&n.bindEvents(n.dragElement)}})},n.prototype.onDragging=function(n){this.draggable.setProperties({cursorAt:{top:!Object(r.isNullOrUndefined)(n.event.targetTouches)||r.Browser.isDevice?60:-20}})},n.prototype.onDragStop=function(n){var i,t,u,f;for(this.parent.isDragging=!1,n.target.classList&&(n.target.classList.contains("e-group-chart-values")||n.target.classList.contains("e-group-chart-values-drodown"))&&(n.target=this.parent.element.querySelector(".e-group-chart-rows")),i=Object(r.closest)(n.element,".e-pivot-button"),Object(r.removeClass)([].slice.call(this.parentElement.querySelectorAll(".e-pivot-button")),"e-list-selected"),Object(r.removeClass)([].slice.call(this.parentElement.querySelectorAll(".e-drop-indicator")),"e-drop-hover"),t=0,u=["e-rows","e-columns","e-filters"];t<u.length;t++)f=u[t],Object(r.removeClass)([this.parentElement.querySelector("."+f)],"e-drag-restrict");(this.parent.pivotCommon.filterDialog.dialogPopUp&&this.parent.pivotCommon.filterDialog.dialogPopUp.close(),document.getElementById(this.parent.element.id+"_DragClone")&&Object(r.remove)(document.getElementById(this.parent.element.id+"_DragClone")),document.body.style.cursor="auto",this.isButtonDropped(n.target,i)&&(this.parent.pivotCommon.dataSourceUpdate.control="pivotview"===this.parent.getModuleName()?this.parent:this.parent.pivotGridModule?this.parent.pivotGridModule:this.parent,this.parent.pivotCommon.nodeStateModified.onStateModified(n,i.id)))&&(this.updateDataSource(),this.parent.axisFieldModule.render())},n.prototype.isButtonDropped=function(n,t){var o=Object(r.closest)(t,".e-droppable"),s=!0,c;if(o===Object(r.closest)(n,".e-droppable")){for(var u=[].slice.call(o.querySelectorAll(".e-pivot-button")),h=Object(r.closest)(n,".e-pvt-btn-div"),f=void 0,e=-1,i=0,l=u.length;i<l;i++)(u[i].id===t.id&&(f=i),h)&&(c=h.querySelector(".e-pivot-button"),u[i].id===c.id&&(e=i));(f===e||f===u.length-1&&-1===e)&&(Object(r.removeClass)([].slice.call(this.parentElement.querySelectorAll(".e-drop-indicator")),"e-drop-hover"),s=!1)}return s},n.prototype.updateSorting=function(n){var t=Object(r.closest)(n.target,".e-pivot-button"),i=e.getFieldInfo(t?t.id:"",this.parent);n.target.classList.contains("e-btn-filter")||n.target.classList.contains("e-remove")||n.target.classList.contains("e-drag")||!t||!i.fieldItem||!(i.fieldItem.showSortIcon||Object(r.isNullOrUndefined)(i.fieldItem.showSortIcon))||!(this.parent instanceof ni||this.parent.groupingBarSettings.showSortIcon)||!this.parent.dataSourceSettings.enableSorting||"olap"===this.parent.dataType&&("pivotfieldlist"===this.parent.getModuleName()&&void 0!==this.parent.pivotGridModule&&this.parent.pivotGridModule.enableVirtualization||"pivotview"===this.parent.getModuleName()&&this.parent.enableVirtualization)||(("pivotview"===this.parent.getModuleName()&&this.parent.enableValueSorting||"pivotfieldlist"===this.parent.getModuleName()&&void 0!==this.parent.pivotGridModule&&this.parent.pivotGridModule.enableValueSorting)&&(this.parent.enableValueSorting||this.parent.pivotGridModule.enableValueSorting)&&(n.target.classList.contains("e-pivot-button")?"rows"===n.target.parentElement.getAttribute("data-tag").split(":")[0]&&this.parent.setProperties({dataSourceSettings:{valueSortSettings:{headerText:""}}},!0):"rows"===n.target.parentElement.parentElement.getAttribute("data-tag").split(":")[0]&&this.parent.setProperties({dataSourceSettings:{valueSortSettings:{headerText:""}}},!0)),this.parent.pivotCommon.eventBase.updateSorting(n),this.parent.allowDeferLayoutUpdate&&"pivotfieldlist"===this.parent.getModuleName()||this.updateDataSource(!0),this.parent instanceof ni&&this.axisField.render())},n.prototype.updateDataSource=function(n){this.parent.allowDeferLayoutUpdate&&"pivotview"!==this.parent.getModuleName()?"pivotfieldlist"===this.parent.getModuleName()&&"Popup"===this.parent.renderMode?("olap"===this.parent.dataType?this.parent.pivotGridModule.olapEngineModule=this.parent.olapEngineModule:this.parent.pivotGridModule.engineModule=this.parent.engineModule,this.parent.pivotGridModule.notify(ft,this),this.parent.pivotGridModule.setProperties({dataSourceSettings:this.parent.dataSourceSettings.properties},!0)):this.parent.triggerPopulateEvent():this.parent.updateDataSource(n)},n.prototype.updateFiltering=function(n){var u=this.parent.pivotGridModule?this.parent.pivotGridModule:this.parent,t,i;u&&u.enableVirtualization&&Object(r.isBlazor)()&&"pivot"===u.dataType?(t=n.target.parentElement.id,i=this,u.interopAdaptor.invokeMethodAsync("PivotInteropMethod","fetchFieldMembers",t).then(function(r){for(var f=JSON.parse(r.dateMembers),e=[],o={},s={},u=0;u<f.length;u++)e.push({formattedText:f[u].FormattedText,actualText:f[u].ActualText}),o[f[u].FormattedText]={},s[f[u].ActualText]={};i.parent.engineModule.fieldList[t].dateMember=e;i.parent.engineModule.fieldList[t].formattedMembers=o;i.parent.engineModule.fieldList[t].members=s;i.updateFilterEvents(n)})):this.updateFilterEvents(n)},n.prototype.updateFilterEvents=function(n){this.parent.pivotCommon.eventBase.updateFiltering(n);var t=n.target;this.fieldName=t.parentElement.id;this.parent.pivotCommon.filterDialog.dialogPopUp&&(this.dialogPopUp=this.parent.pivotCommon.filterDialog.dialogPopUp,this.bindDialogEvents())},n.prototype.bindDialogEvents=function(){this.parent.pivotCommon.filterDialog.allowExcelLikeFilter&&this.parent.pivotCommon.filterDialog.tabObj?(this.index=this.parent.pivotCommon.filterDialog.tabObj.selectedItem,this.updateDialogButtonEvents(),this.dialogPopUp.buttons=this.buttonModel(),this.dialogPopUp.dataBind(),this.parent.pivotCommon.filterDialog.tabObj.selected=this.tabSelect.bind(this)):this.parent.dataSourceSettings.allowMemberFilter&&(this.index=0,this.updateDialogButtonEvents())},n.prototype.buttonModel=function(){return[{buttonModel:{cssClass:"e-ok-btn",content:this.parent.localeObj.getConstant("ok"),isPrimary:!0},click:0===this.index?this.updateFilterState.bind(this,this.fieldName):this.updateCustomFilter.bind(this)},{buttonModel:{cssClass:"e-clear-filter-button"+(this.parent.pivotCommon.filterDialog.allowExcelLikeFilter?"":" e-disable"),iconCss:"e-icons e-clear-filter-icon",enableRtl:this.parent.enableRtl,content:this.parent.localeObj.getConstant("clearFilter"),disabled:!this.parent.pivotCommon.filterDialog.filterObject},click:this.ClearFilter.bind(this)},{click:this.parent.pivotCommon.filterDialog.closeFilterDialog.bind(this),buttonModel:{cssClass:"e-cancel-btn",content:this.parent.localeObj.getConstant("cancel")}}]},n.prototype.tabSelect=function(n){this.index=n.selectedIndex;this.updateDialogButtonEvents();Object(r.removeClass)([].slice.call(this.dialogPopUp.element.querySelectorAll(".e-selected-tab")),"e-selected-tab");n.selectedIndex>0&&Object(r.addClass)([this.dialogPopUp.element.querySelector(".e-filter-div-content."+(1===n.selectedIndex&&this.parent.dataSourceSettings.allowLabelFilter?"e-label-filter":"e-value-filter"))],"e-selected-tab");0===n.selectedIndex?this.parent.pivotCommon.filterDialog.updateCheckedState():(this.dialogPopUp.buttons[0].buttonModel.disabled=!1,this.dialogPopUp.element.querySelector(".e-ok-btn").removeAttribute("disabled"))},n.prototype.updateDialogButtonEvents=function(){this.dialogPopUp.buttons=this.buttonModel();this.dialogPopUp.dataBind()},n.prototype.updateCustomFilter=function(){var n,u=this,i=this.dialogPopUp.element.querySelector(".e-selected-tab"),f=i.getAttribute("data-fieldname"),v=i.getAttribute("data-selectedField"),s=i.getAttribute("data-type"),d=i.getAttribute("data-measure"),w=i.getAttribute("data-operator"),o=i.getAttribute("data-value1"),h=i.getAttribute("data-value2"),c="value"===s?"Value":"date"===s?"Date":"number"===s?"Number":"Label",t={name:f,type:c,measure:d,condition:w,value1:"date"!==s||Object(r.isBlazor)()?o:new Date(o),value2:"date"!==s||Object(r.isBlazor)()?h:new Date(h)},l,y,a,b,p,k;if("olap"===this.parent.dataType)for(t.selectedField=v,this.removeDataSourceSettings(f,v,c),l=0,y=this.parent.dataSourceSettings.filterSettings;l<y.length;l++)a=y[l],a.name===f&&a.selectedField===v&&(n=a);else n=e.getFilterItemByName(f,this.parent.dataSourceSettings.filterSettings);if(Object(r.isNullOrUndefined)(o)||""===o||["Between","NotBetween"].indexOf(w)>-1&&(Object(r.isNullOrUndefined)(h)||""===h))return b=c.toLowerCase()+(Object(r.isNullOrUndefined)(o)||""===o?"_input_option_1":"_input_option_2"),p=i.querySelector("#"+this.parent.element.id+"_"+b),Object(r.addClass)([p],"e-empty-field"),void p.focus();k={cancel:!1,filterSettings:t,dataSourceSettings:e.getClonedDataSourceSettings(this.parent.dataSourceSettings)};("pivotfieldlist"===this.parent.getModuleName()&&this.parent.isPopupView?this.parent.pivotGridModule:this.parent).trigger("memberFiltering",k,function(i){i.cancel||(t=i.filterSettings,n?((n=n.properties?n.properties:n).type=t.type,n.measure=t.measure,n.condition=t.condition,n.value1=t.value1,n.value2=t.value2,"olap"===u.parent.dataType&&(n.selectedField=t.selectedField)):u.parent.dataSourceSettings.filterSettings.push(t));"Value"!==c&&(u.parent.lastFilterInfo=e.getFilterItemByName(f,u.parent.dataSourceSettings.filterSettings));u.dialogPopUp.close();i.cancel||(u.refreshPivotButtonState(f,!0),u.updateDataSource(!0))})},n.prototype.ClearFilter=function(){var t=this.dialogPopUp.element,n=t.getAttribute("data-fieldname"),i=t.querySelector(".e-selected-tab"),r,u;(this.dialogPopUp.close(),"olap"===this.parent.dataType&&i)?(r=i.getAttribute("data-selectedField"),this.removeDataSourceSettings(n,r)):this.removeDataSourceSettings(n);u=e.getFilterItemByName(n,this.parent.dataSourceSettings.filterSettings);this.refreshPivotButtonState(n,!!u);this.updateDataSource(!0)},n.prototype.removeButton=function(n){var t=this,r=n.target,i=r.parentElement.id,u=e.getFieldInfo(i,this.parent),f={cancel:!1,fieldName:i,dataSourceSettings:e.getClonedDataSourceSettings(this.parent.dataSourceSettings),fieldItem:u.fieldItem,axis:u.axis};("pivotfieldlist"===this.parent.getModuleName()&&this.parent.isPopupView?this.parent.pivotGridModule:this.parent).trigger("fieldRemove",f,function(n){n.cancel||("true"===r.parentElement.getAttribute("isvalue")?(t.parent.setProperties({dataSourceSettings:{values:[]}},!0),"olap"===t.parent.dataType&&t.parent.pivotCommon.dataSourceUpdate.removeFieldFromReport("[measures]")):(t.parent.pivotCommon.dataSourceUpdate.removeFieldFromReport(i),"olap"===t.parent.dataType&&0===t.parent.dataSourceSettings.values.length&&t.parent.pivotCommon.dataSourceUpdate.removeFieldFromReport("[measures]")),"pivotfieldlist"===t.parent.getModuleName()&&t.parent.axisFieldModule.render(),t.updateDataSource())})},n.prototype.nodeStateModified=function(n){var t=Object(r.closest)(n.node,"li"),i=t.getAttribute("data-fieldname"),f,u;"all"===t.getAttribute("data-uid")?(this.memberTreeView.nodeChecked=null,"check"===n.action?this.memberTreeView.checkAll():this.memberTreeView.uncheckAll(),"olap"===this.parent.dataType&&this.parent.olapEngineModule&&!this.parent.olapEngineModule.fieldList[i].isHierarchy&&this.updateNodeStates(this.memberTreeView.getAllCheckedNodes(),i,n.action),this.checkedStateAll(n.action),this.memberTreeView.nodeChecked=this.nodeStateModified.bind(this)):("olap"===this.parent.dataType&&this.parent.olapEngineModule&&!this.parent.olapEngineModule.fieldList[i].isHierarchy&&(f=this.memberTreeView.getAllCheckedNodes(),this.updateNodeStates(f,i,n.action)),u=this.parent.pivotCommon.currentTreeItemsPos[t.getAttribute("data-uid")].index,this.parent.pivotCommon.currentTreeItems[u]&&(this.parent.pivotCommon.currentTreeItems[u].isSelected="check"===n.action,this.parent.pivotCommon.currentTreeItemsPos[t.getAttribute("data-uid")].isSelected="check"===n.action));this.parent.pivotCommon.filterDialog.updateCheckedState()},n.prototype.checkedStateAll=function(n){for(var i,u,t,f={},r=0,e=this.parent.pivotCommon.searchTreeItems;r<e.length;r++)(t=e[r]).isSelected="check"===n,f[t.id]=t.id;for(i=0,u=this.parent.pivotCommon.currentTreeItems;i<u.length;i++)void 0!==f[(t=u[i]).id]&&(t.isSelected="check"===n,this.parent.pivotCommon.currentTreeItemsPos[t.id].isSelected="check"===n)},n.prototype.updateNodeStates=function(n,t){var f=this.parent.pivotCommon.engineModule.fieldList[t],r=f.members,e=f.currrentMembers,o,a,s,v,h,c,y,u,l,p,i;if(f.searchMembers.length>0){for(o=0,a=Object.keys(e);o<a.length;o++)(e[u=a[o]]&&(e[u].isSelected=!1),r[u])&&(r[u].isSelected=!1,this.memberTreeView.element.querySelector('li[data-uid="'+u+'"]'))&&(h=this.memberTreeView.element.querySelector('li[data-uid="'+u+'"]'))&&!h.querySelector("ul")&&this.parent.pivotCommon.eventBase.updateChildNodeStates(f.filterMembers,t,u,!1);for(s=0,v=n;s<v.length;s++)r[i=v[s]]&&this.memberTreeView.element.querySelector('li[data-uid="'+i+'"]')&&(h=this.memberTreeView.element.querySelector('li[data-uid="'+i+'"]'))&&!h.querySelector("ul")&&(r[i].isSelected=!0,this.parent.pivotCommon.eventBase.updateChildNodeStates(f.filterMembers,t,i,!0)),e[i]&&(e[i].isSelected=!0)}else{for(c=0,y=Object.keys(r);c<y.length;c++)r[u=y[c]].isSelected&&(r[u].isSelected=!1);for(l=0,p=n;l<p.length;l++)r[i=p[l]]&&(r[i].isSelected=!0,this.parent.pivotCommon.eventBase.updateChildNodeStates(f.filterMembers,t,i,!0))}},n.prototype.updateFilterState=function(n){var i=this,u=!1,t={items:[],name:n,type:"Include"},r=this.parent.olapEngineModule,o,s,a,p,h,v,f,c,y,l,w;if("olap"===this.parent.dataType&&r&&!r.fieldList[n].isHierarchy)for(o=r.fieldList[n].members,s=r.fieldList[n].currrentMembers,(t.items=this.memberTreeView.getAllCheckedNodes(),t.levelCount=r.fieldList[n].levelCount,u=t.items.length!==this.memberTreeView.fields.dataSource.length,r.fieldList[n].searchMembers.length>0&&!u)&&(a=Object.keys(o).length,p=Object.keys(s).length,u=a!==p||a!==t.items.length),h=0,v=t.items;h<v.length;h++)f=v[h],r.fieldList[n].searchMembers.length>0&&s[f]?s[f].isSelected=!0:o[f]&&(o[f].isSelected=!0);else{for(c=0,y=this.parent.pivotCommon.searchTreeItems;c<y.length;c++)l=y[c],l.isSelected&&(this.parent.pivotCommon.isDateField?t.items.push(l.name):t.items.push(l.id));u=t.items.length!==this.parent.pivotCommon.currentTreeItems.length}"olap"===this.parent.dataType&&this.removeDataSourceSettings(n);w={filterSettings:t,dataSourceSettings:e.getClonedDataSourceSettings(this.parent.dataSourceSettings),cancel:!1};("pivotfieldlist"===this.parent.getModuleName()&&this.parent.isPopupView?this.parent.pivotGridModule:this.parent).trigger("memberFiltering",w,function(r){var f,o;if(t=r.filterSettings,!r.cancel){if(e.getFilterItemByName(n,i.parent.dataSourceSettings.filterSettings))for(f=0;f<i.parent.dataSourceSettings.filterSettings.length;f++)if(i.parent.dataSourceSettings.filterSettings[f].name===n){i.parent.dataSourceSettings.filterSettings.splice(f,1);break}i.parent.dataSourceSettings.filterSettings.push(t)}(i.dialogPopUp.close(),r.cancel)||(i.refreshPivotButtonState(n,u),u||i.removeDataSourceSettings(n),i.parent.lastFilterInfo=t,i.updateDataSource(!0),o=i,o.parent instanceof ni&&o.axisField.render())})},n.prototype.refreshPivotButtonState=function(n,t){for(var i,e,u=0,f=[].slice.call(this.parentElement.querySelectorAll(".e-pivot-button"));u<f.length;u++)if(e=f[u],e.getAttribute("data-uid")===n){i=e.querySelector(".e-btn-filter");break}t?(Object(r.removeClass)([i],"e-pv-filter"),Object(r.addClass)([i],"e-pv-filtered")):(Object(r.removeClass)([i],"e-pv-filtered"),Object(r.addClass)([i],"e-pv-filter"))},n.prototype.removeDataSourceSettings=function(n,t,i){for(var u=this.parent.dataSourceSettings.filterSettings,r=0,f=u.length;r<f;r++)if("olap"===this.parent.dataType&&t){if(!i&&u[r].name===n&&u[r].selectedField===t){u.splice(r,1);break}i&&u[r].type!==i&&u[r].name===n&&(u.splice(r,1),f--,r--)}else if(u[r].name===n){if(u.splice(r,1),"olap"!==this.parent.dataType)break;f--;r--}},n.prototype.updateDropIndicator=function(n){if(this.parent.isDragging){Object(r.removeClass)([].slice.call(this.parentElement.querySelectorAll(".e-drop-indicator-last")),"e-drop-hover");Object(r.removeClass)([].slice.call(this.parentElement.querySelectorAll(".e-drop-indicator")),"e-drop-hover");var t=Object(r.closest)(n.target,".e-pvt-btn-div");Object(r.addClass)([t.querySelector(".e-drop-indicator")],"e-drop-hover")}},n.prototype.wireEvent=function(n,t,i){r.EventHandler.add(n,"mouseover",this.updateDropIndicator,this);i||(-1===["filters","values"].indexOf(t)&&null!==n.querySelector(".e-pivot-button")&&r.EventHandler.add(n.querySelector(".e-pivot-button"),"click",this.updateSorting,this),"values"!==t&&null!==n.querySelector(".e-btn-filter")&&r.EventHandler.add(n.querySelector(".e-btn-filter"),"click",this.updateFiltering,this),"values"===t&&null!==n.querySelector(".e-dropdown-icon")&&r.EventHandler.add(n.querySelector(".e-dropdown-icon"),"click",this.createMenuOption,this));null!==n.querySelector(".e-edit")&&r.EventHandler.add(n.querySelector(".e-edit"),"click",this.openCalculatedFieldDialog,this);r.EventHandler.add(n.querySelector(".e-remove"),"click",this.removeButton,this)},n.prototype.unWireEvent=function(n,t,i){r.EventHandler.remove(n,"mouseover",this.updateDropIndicator);i||(-1===["filters","values"].indexOf(t)&&null!==n.querySelector(".e-pivot-button")&&r.EventHandler.remove(n.querySelector(".e-pivot-button"),"click",this.updateSorting),"values"!==t&&null!==n.querySelector(".e-btn-filter")&&r.EventHandler.remove(n.querySelector(".e-btn-filter"),"click",this.updateFiltering),"values"===t&&null!==n.querySelector(".e-dropdown-icon")&&r.EventHandler.remove(n.querySelector(".e-dropdown-icon"),"click",this.createMenuOption));null!==n.querySelector(".e-edit")&&r.EventHandler.remove(n.querySelector(".e-edit"),"click",this.openCalculatedFieldDialog);r.EventHandler.remove(n.querySelector(".e-remove"),"click",this.removeButton)},n.prototype.addEventListener=function(){this.handlers={load:this.renderPivotButton};this.parent.isDestroyed||this.parent.on("pivot-button-update",this.handlers.load,this)},n.prototype.removeEventListener=function(){this.parent.isDestroyed||this.parent.off("pivot-button-update",this.handlers.load)},n.prototype.destroy=function(){this.menuOption&&this.menuOption.destroy();this.removeEventListener();this.isDestroyed=!0},n}(),fr=function(){function n(n){this.parent=n}return n.prototype.render=function(){!this.parent.pivotButtonModule||this.parent.pivotButtonModule&&this.parent.pivotButtonModule.isDestroyed?new ur(this.parent):this.parent.pivotButtonModule;this.createPivotButtons()},n.prototype.createPivotButtons=function(){var i=[this.parent.dataSourceSettings.rows,this.parent.dataSourceSettings.columns,this.parent.dataSourceSettings.values,this.parent.dataSourceSettings.filters],n=this.parent.dialogRenderer.parentElement,r;n.querySelector(".e-field-list-filters")&&(n.querySelector(".e-field-list-filters").querySelector(".e-axis-content").innerHTML="");n.querySelector(".e-field-list-rows")&&(n.querySelector(".e-field-list-rows").querySelector(".e-axis-content").innerHTML="");n.querySelector(".e-field-list-columns")&&(n.querySelector(".e-field-list-columns").querySelector(".e-axis-content").innerHTML="");n.querySelector(".e-field-list-values")&&(n.querySelector(".e-field-list-values").querySelector(".e-axis-content").innerHTML="");for(var u=["rows","columns","values","filters"],t=0,f=i.length;t<f;t++)i[t]&&(r={field:i[t],axis:u[t].toString()},this.parent.notify("pivot-button-update",r))},n}(),ie=function(){function n(n){this.parent=n;this.parent.dialogRenderer=new gf(this.parent);this.parent.treeViewModule=new ne(this.parent);this.parent.axisTableModule=new te(this.parent);this.parent.axisFieldModule=new fr(this.parent)}return n.prototype.render=function(){this.parent.dialogRenderer.render();this.parent.isAdaptive||this.parent.treeViewModule.render();this.parent.axisTableModule.render()},n}(),re=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),w=function(n,t,i,r){var f,e=arguments.length,u=e<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r,o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(n,t,i,r);else for(o=n.length-1;o>=0;o--)(f=n[o])&&(u=(e<3?f(u):e>3?f(t,i,u):f(t,i))||u);return e>3&&u&&Object.defineProperty(t,i,u),u},ni=function(n){function t(t,i){var r=n.call(this,t,i)||this;return r.isRequiredUpdate=!0,r.lastSortInfo={},r.lastFilterInfo={},r.lastAggregationInfo={},r.lastCalcFieldInfo={},r.isPopupView=!1,r}return re(t,n),t.prototype.requiredModules=function(){var n=[];return this.allowCalculatedField&&n.push({args:[this],member:"calculatedfield"}),n},t.prototype.getAllSummaryType=function(){return["Sum","Count","DistinctCount","Product","Min","Max","Avg","Index","PopulationVar","SampleVar","PopulationStDev","SampleStDev","RunningTotals","PercentageOfGrandTotal","PercentageOfColumnTotal","PercentageOfRowTotal","PercentageOfParentColumnTotal","PercentageOfParentRowTotal","DifferenceFrom","PercentageOfDifferenceFrom","PercentageOfParentTotal"]},t.prototype.preRender=function(){this.dataSourceSettings&&"SSAS"===this.dataSourceSettings.providerType?(this.olapEngineModule=new rr,this.dataType="olap"):(this.engineModule=new li,this.dataType="pivot");this.isAdaptive=r.Browser.isDevice;this.globalize=new r.Internationalization(this.locale);this.renderModule=new ie(this);this.defaultLocale={staticFieldList:"Pivot Field List",fieldList:"Field List",dropFilterPrompt:"Drop filter here",dropColPrompt:"Drop column here",dropRowPrompt:"Drop row here",dropValPrompt:"Drop value here",addPrompt:"Add field here",adaptiveFieldHeader:"Choose field",centerHeader:"Drag fields between axes below:",add:"add",drag:"Drag",filter:"Filter",filtered:"Filtered",sort:"Sort",remove:"Remove",filters:"Filters",rows:"Rows",columns:"Columns",values:"Values",CalculatedField:"Calculated Field",createCalculatedField:"Create Calculated Field",fieldName:"Enter the field name",error:"Error",invalidFormula:"Invalid formula.",dropText:'Example: ("Sum(Order_Count)" + "Sum(In_Stock)") * 250',dropTextMobile:"Add fields and edit formula here.",dropAction:"Calculated field cannot be place in any other region except value axis.",search:"Search",close:"Close",cancel:"Cancel","delete":"Delete",alert:"Alert",warning:"Warning",ok:"OK",allFields:"All Fields",formula:"Formula",fieldExist:"A field already exists in this name. Please enter a different name.",confirmText:"A calculation field already exists in this name. Do you want to replace it?",noMatches:"No matches",format:"Summaries values by",edit:"Edit",clear:"Clear",clearCalculatedField:"Clear edited field info",editCalculatedField:"Edit calculated field",sortAscending:"Sort ascending order",sortDescending:"Sort descending order",sortNone:"Sort data order",formulaField:"Drag and drop fields to formula",dragField:"Drag field to formula",clearFilter:"Clear",by:"by",enterValue:"Enter value",chooseDate:"Enter date",all:"All",multipleItems:"Multiple items",Equals:"Equals",DoesNotEquals:"Does Not Equal",BeginWith:"Begins With",DoesNotBeginWith:"Does Not Begin With",EndsWith:"Ends With",DoesNotEndsWith:"Does Not End With",Contains:"Contains",DoesNotContains:"Does Not Contain",GreaterThan:"Greater Than",GreaterThanOrEqualTo:"Greater Than Or Equal To",LessThan:"Less Than",LessThanOrEqualTo:"Less Than Or Equal To",Between:"Between",NotBetween:"Not Between",Before:"Before",BeforeOrEqualTo:"Before Or Equal To",After:"After",AfterOrEqualTo:"After Or Equal To",member:"Member",label:"Label",date:"Date",value:"Value",labelTextContent:"Show the items for which the label",dateTextContent:"Show the items for which the date",valueTextContent:"Show the items for which",And:"and",Sum:"Sum",Count:"Count",DistinctCount:"Distinct Count",Product:"Product",Avg:"Avg",Min:"Min",Max:"Max",Index:"Index",SampleStDev:"Sample StDev",PopulationStDev:"Population StDev",SampleVar:"Sample Var",PopulationVar:"Population Var",RunningTotals:"Running Totals",DifferenceFrom:"Difference From",PercentageOfDifferenceFrom:"% of Difference From",PercentageOfGrandTotal:"% of Grand Total",PercentageOfColumnTotal:"% of Column Total",PercentageOfRowTotal:"% of Row Total",PercentageOfParentTotal:"% of Parent Total",PercentageOfParentColumnTotal:"% of Parent Column Total",PercentageOfParentRowTotal:"% of Parent Row Total",MoreOption:"More...",Years:"Years",Quarters:"Quarters",Months:"Months",Days:"Days",Hours:"Hours",Minutes:"Minutes",Seconds:"Seconds",apply:"APPLY",valueFieldSettings:"Value field settings",sourceName:"Field name :",sourceCaption:"Field caption :",summarizeValuesBy:"Summarize values by :",baseField:"Base field :",baseItem:"Base item :",example:"e.g:",editorDataLimitMsg:" more items. Search to refine further.",deferLayoutUpdate:"Defer Layout Update","null":"null",undefined:"undefined",groupOutOfRange:"Out of Range",fieldDropErrorAction:"The field you are moving cannot be placed in that area of the report",memberType:"Field Type",selectedHierarchy:"Parent Hierarchy",formatString:"Format String",expressionField:"Expression",olapDropText:"Example: [Measures].[Order Quantity] + ([Measures].[Order Quantity] * 0.10)",customFormat:"Enter custom format string",numberFormatString:"Enter the format string",Measure:"Measure",Dimension:"Dimension",Standard:"Standard",Currency:"Currency",Percent:"Percent",Custom:"Custom",blank:"(Blank)",fieldTooltip:'Drag and drop fields to create an expression. And, if you want to edit the existing calculated fields! You can achieve it by simply selecting the field under "Calculated Members".',fieldTitle:"Field Name",QuarterYear:"Quarter Year",caption:"Field Caption",copy:"Copy",of:"of",group:"Group"};this.localeObj=new r.L10n(this.getModuleName(),this.defaultLocale,this.locale);this.isDragging=!1;this.captionData=[];this.wireEvent()},t.prototype.frameCustomProperties=function(n,t){this.pivotGridModule&&this.pivotGridModule.updatePageSettings(!1);var i=this.pivotGridModule?this.pivotGridModule.pageSettings:void 0,r=!this.pivotGridModule||this.pivotGridModule.allowDrillThrough||this.pivotGridModule.editSettings.allowEditing,u=this.pivotGridModule?this.pivotGridModule.enableValueSorting:void 0;return"olap"===this.dataType?{mode:"",savedFieldList:t||void 0,savedFieldListData:n||void 0,pageSettings:i,enableValueSorting:u,isDrillThrough:r,localeObj:this.localeObj}:{mode:"",savedFieldList:void 0,pageSettings:i,enableValueSorting:u,isDrillThrough:r,localeObj:this.localeObj}},t.prototype.render=function(){var n=this;this.trigger("load",{dataSourceSettings:this.dataSourceSettings},function(t){Object(r.isBlazor)()&&(t.dataSourceSettings.dataSource=n.dataSourceSettings.dataSource);n.dataSourceSettings=t.dataSourceSettings;Object(r.addClass)([n.element],oi);n.enableRtl?Object(r.addClass)([n.element],et):Object(r.removeClass)([n.element],et);n.isAdaptive?Object(r.addClass)([n.element],vt):Object(r.removeClass)([n.element],vt);n.cssClass&&Object(r.addClass)([n.element],n.cssClass);n.notify("initial-load",{})});Object(r.isBlazor)()&&this.renderComplete()},t.prototype.wireEvent=function(){this.on("initial-load",this.generateData,this);this.on(ct,this.fieldListRender,this)},t.prototype.unWireEvent=function(){this.pivotGridModule&&this.pivotGridModule.isDestroyed||(this.off("initial-load",this.generateData),this.off(ct,this.fieldListRender))},t.prototype.getPersistData=function(){return this.addOnPersist(["dataSourceSettings"])},t.prototype.getModuleName=function(){return"pivotfieldlist"},t.prototype.onPropertyChanged=function(n,t){for(var f,i,l=!1,u=0,a=Object.keys(n);u<a.length;u++){f=a[u];switch(f){case"locale":this.refresh();break;case"dataSourceSettings":if(e.isButtonIconRefesh(f,t,n)){if(this.isPopupView&&this.pivotGridModule&&this.pivotGridModule.showGroupingBar&&this.pivotGridModule.groupingBarModule){var o=e.cloneFieldSettings(this.dataSourceSettings.filters),s=e.cloneFieldSettings(this.dataSourceSettings.values),h=e.cloneFieldSettings(this.dataSourceSettings.rows),c=e.cloneFieldSettings(this.dataSourceSettings.columns);this.pivotGridModule.setProperties({dataSourceSettings:{rows:h,columns:c,values:s,filters:o}},!0);this.pivotGridModule.axisFieldModule.render()}else this.isPopupView||!this.staticPivotGridModule||this.staticPivotGridModule.isDestroyed||(i=this.staticPivotGridModule,(i.showGroupingBar&&i.groupingBarModule&&i.axisFieldModule.render(),i.showFieldList&&i.pivotFieldListModule)&&(h=e.cloneFieldSettings(i.dataSourceSettings.rows),c=e.cloneFieldSettings(i.dataSourceSettings.columns),s=e.cloneFieldSettings(i.dataSourceSettings.values),o=e.cloneFieldSettings(i.dataSourceSettings.filters),i.pivotFieldListModule.setProperties({dataSourceSettings:{rows:h,columns:c,values:s,filters:o}},!0),i.pivotFieldListModule.axisFieldModule.render(),i.pivotFieldListModule.treeViewModule.fieldTable&&!i.isAdaptive&&i.pivotFieldListModule.notify("tree-view-update",{})));this.axisFieldModule.render();this.treeViewModule.fieldTable&&!this.isAdaptive&&this.notify("tree-view-update",{})}break;case"aggregateTypes":this.axisFieldModule&&this.axisFieldModule.render();this.pivotGridModule&&this.pivotGridModule.axisFieldModule&&(this.pivotGridModule.setProperties({aggregateTypes:n.aggregateTypes},!0),this.pivotGridModule.axisFieldModule.render());break;case"enableRtl":this.enableRtl?Object(r.addClass)([this.element],et):Object(r.removeClass)([this.element],et);l=!0}l&&this.fieldListRender()}},t.prototype.initEngine=function(){var n=this,i={dataSourceSettings:e.getClonedDataSourceSettings(this.dataSourceSettings)},t=this.isPopupView?this.pivotGridModule:this;t.trigger("enginePopulating",i,function(i){var o,s,u,f;(e.updateDataSourceSettings(n,i.dataSourceSettings),"pivot"===n.dataType)?(n.dataSourceSettings.groupSettings&&n.dataSourceSettings.groupSettings.length>0&&(o=void 0,o=Object(r.isBlazor)()?n.engineModule.data:n.dataSourceSettings.dataSource,n.clonedDataSet=n.clonedDataSet?n.clonedDataSet:e.getClonedData(o),Object(r.isBlazor)()?n.clonedReport=n.clonedReport?n.clonedReport:Object(r.extend)({},n.dataSourceSettings,null,!0):(n.setProperties({dataSourceSettings:{dataSource:[]}},!0),n.clonedReport=n.clonedReport?n.clonedReport:Object(r.extend)({},n.dataSourceSettings,null,!0),n.setProperties({dataSourceSettings:{dataSource:o}},!0))),n.engineModule.renderEngine(n.dataSourceSettings,n.frameCustomProperties(),n.getValueCellInfo.bind(n)),n.pivotFieldList=n.engineModule.fieldList,s={pivotFieldList:n.pivotFieldList,pivotValues:n.engineModule.pivotValues},u=n,t.trigger("enginePopulated",s,function(t){u.pivotFieldList=t.pivotFieldList;u.engineModule.pivotValues=Object(r.isBlazor)()?n.engineModule.pivotValues:t.pivotValues;u.notify(ct,{});u.trigger("dataBound")})):"olap"===n.dataType&&(n.olapEngineModule.renderEngine(n.dataSourceSettings,n.frameCustomProperties(n.olapEngineModule.fieldListData,n.olapEngineModule.fieldList)),n.pivotFieldList=n.olapEngineModule.fieldList,s={pivotFieldList:n.pivotFieldList,pivotValues:n.olapEngineModule.pivotValues},f=n,t.trigger("enginePopulated",s,function(t){f.pivotFieldList=t.pivotFieldList;f.olapEngineModule.pivotValues=Object(r.isBlazor)()?n.engineModule.pivotValues:t.pivotValues;f.notify(ct,{});f.trigger("dataBound")}))})},t.prototype.generateData=function(){this.pivotFieldList={};this.dataSourceSettings&&(this.dataSourceSettings.dataSource||this.dataSourceSettings.url)?""!==this.dataSourceSettings.url&&"olap"===this.dataType||this.dataSourceSettings.dataSource.length>0?("pivot"===this.dataType&&(this.engineModule.data=this.dataSourceSettings.dataSource),this.initEngine()):this.dataSourceSettings.dataSource instanceof tt.DataManager&&setTimeout(this.getData.bind(this),100):Object(r.isBlazor)()&&"pivot"===this.dataType&&this.engineModule.data&&this.engineModule.data.length>0?this.initEngine():(this.notify(ct,{}),this.trigger("dataBound"))},t.prototype.getValueCellInfo=function(n){var t=n;return this.trigger("aggregateCellInfo",t),t},t.prototype.getData=function(){this.dataSourceSettings.dataSource.executeQuery(new tt.Query).then(this.executeQuery.bind(this))},t.prototype.executeQuery=function(n){this.engineModule.data=n.result;this.initEngine()},t.prototype.fieldListRender=function(){var n;this.element.innerHTML="";"Popup"===this.renderMode&&this.dialogRenderer.fieldListDialog&&!this.dialogRenderer.fieldListDialog.isDestroyed&&(this.dialogRenderer.fieldListDialog.destroy(),Object(r.remove)(document.getElementById(this.element.id+"_Wrapper")));this.renderModule.render();this.fieldListSpinnerElement="Popup"===this.renderMode?this.dialogRenderer.fieldListDialog.element:this.element.querySelector(".e-pivotfieldlist-wrapper");this.spinnerTemplate?Object(p.createSpinner)({target:this.fieldListSpinnerElement,template:this.spinnerTemplate},this.createElement):Object(p.createSpinner)({target:this.fieldListSpinnerElement},this.createElement);n={pivotEngine:"olap"===this.dataType?this.olapEngineModule:this.engineModule,dataSourceSettings:this.dataSourceSettings,id:this.element.id,element:document.getElementById(this.element.id+"_Wrapper"),moduleName:this.getModuleName(),enableRtl:this.enableRtl,isAdaptive:this.isAdaptive,renderMode:this.renderMode,localeObj:this.localeObj,dataType:this.dataType};this.pivotCommon=new pi(n);this.pivotCommon.control=this;this.allowDeferLayoutUpdate&&(this.clonedDataSource=Object(r.extend)({},this.dataSourceSettings,null,!0),this.clonedFieldList=Object(r.extend)({},this.pivotFieldList,null,!0))},t.prototype.getFieldCaption=function(n){var i,u,r,f,t;if(this.getFields(n),this.captionData.length>0)for(i=this.captionData.length,u="olap"===this.dataType?this.olapEngineModule:this.engineModule;i--;)if(this.captionData[i])for(r=0,f=this.captionData[i];r<f.length;r++)t=f[r],t&&u.fieldList[t.name]&&(u.fieldList[t.name].caption=t.caption?t.caption:t.name)},t.prototype.getFields=function(n){this.captionData=[n.rows,n.columns,n.values,n.filters]},t.prototype.updateDataSource=function(n,t){this.pivotGridModule&&this.pivotGridModule.showWaitingPopup();Object(p.showSpinner)(this.fieldListSpinnerElement);var i=this,a=i.isPopupView?i.pivotGridModule:i,u=!1,f=i.pivotGridModule&&i.pivotGridModule.enableVirtualization?i.pivotGridModule.pageSettings:void 0,o=Object.keys(i.lastCalcFieldInfo).length>0,s=Object.keys(i.lastSortInfo).length>0,l=i.lastSortInfo;i.pivotGridModule&&"pivot"===i.dataType&&(i.pivotGridModule.lastSortInfo={});i.lastSortInfo={};var h=Object.keys(i.lastAggregationInfo).length>0,c=Object.keys(i.lastFilterInfo).length>0,v={dataSourceSettings:e.getClonedDataSourceSettings(i.dataSourceSettings)};a.trigger("enginePopulating",v,function(a){var y,v,p,w;if(f&&(s||c||h||o)||(e.updateDataSourceSettings(i,a.dataSourceSettings),e.updateDataSourceSettings(i.pivotGridModule,a.dataSourceSettings)),Object(r.isNullOrUndefined)(t)){if("pivot"===i.dataType)if(y=i.frameCustomProperties(),y.savedFieldList=i.pivotFieldList,f&&(s||c||h||o)){if(v={},s&&(i.pivotGridModule.setProperties({dataSourceSettings:{valueSortSettings:{headerText:""}}},!0),Object(r.isBlazor)()?v={key:"onSort",arg:l}:i.engineModule.onSort(l)),c){if(Object(r.isBlazor)())p=window.ejsInterop.copyWithoutCircularReferences([i.dataSourceSettings.filterSettings],i.dataSourceSettings.filterSettings),v={key:"onFilter",arg:{lastFilterInfo:i.lastFilterInfo,filterSettings:p}};else i.engineModule.onFilter(i.lastFilterInfo,i.dataSourceSettings);i.lastFilterInfo={}}(h&&(Object(r.isBlazor)()?v={key:"onAggregation",arg:i.lastAggregationInfo}:i.engineModule.onAggregation(i.lastAggregationInfo),i.lastAggregationInfo={}),o&&(Object(r.isBlazor)()?v={key:"onCalcOperation",arg:{lastCalcFieldInfo:i.lastCalcFieldInfo,values:i.dataSourceSettings.values,calculatedFieldSettings:i.dataSourceSettings.calculatedFieldSettings}}:i.engineModule.onCalcOperation(i.lastCalcFieldInfo),i.lastCalcFieldInfo={}),Object(r.isBlazor)())&&(w=window.ejsInterop.copyWithoutCircularReferences([v.arg],v.arg),i.pivotGridModule.interopAdaptor.invokeMethodAsync("PivotInteropMethod",v.key,w).then(function(t){i.pivotGridModule.updateBlazorData(t,i.pivotGridModule);i.getFieldCaption(i.dataSourceSettings);i.enginePopulatedEventMethod(i,n,u);i.calculatedFieldModule&&i.calculatedFieldModule.isRequireUpdate&&(i.calculatedFieldModule.endDialog(),i.calculatedFieldModule.isRequireUpdate=!1)}))}else Object(r.isBlazor)()&&f?(p=window.ejsInterop.copyWithoutCircularReferences([i.dataSourceSettings.properties],i.dataSourceSettings.properties),i.pivotGridModule.interopAdaptor.invokeMethodAsync("PivotInteropMethod","renderEngine",{dataSourceSettings:p,customProperties:y}).then(function(t){i.pivotGridModule.updateBlazorData(t,i.pivotGridModule);i.getFieldCaption(i.dataSourceSettings);i.enginePopulatedEventMethod(i,n,u)})):i.engineModule.renderEngine(i.dataSourceSettings,y,i.getValueCellInfo.bind(i));else u=i.updateOlapDataSource(i,s,o,u);Object(r.isBlazor)()&&f||i.getFieldCaption(i.dataSourceSettings)}else i.axisFieldModule.render(),i.isRequiredUpdate=!1;Object(r.isBlazor)()&&f||i.enginePopulatedEventMethod(i,n,u)})},t.prototype.enginePopulatedEventMethod=function(n,t,i){var u=n.isPopupView?n.pivotGridModule:n,f={dataSourceSettings:n.dataSourceSettings,pivotFieldList:"pivot"===n.dataType?n.engineModule.fieldList:n.olapEngineModule.fieldList,pivotValues:"pivot"===n.dataType?n.engineModule.pivotValues:n.olapEngineModule.pivotValues};u.trigger("enginePopulated",f,function(u){var f=n.dataSourceSettings.dataSource;Object(r.isBlazor)()&&u.dataSourceSettings.dataSource instanceof Object&&(u.dataSourceSettings.dataSource=f);n.dataSourceSettings=u.dataSourceSettings;n.pivotCommon.dataSourceSettings=n.dataSourceSettings;n.pivotFieldList=u.pivotFieldList;"olap"===n.dataType?(n.olapEngineModule.pivotValues=Object(r.isBlazor)()?n.olapEngineModule.pivotValues:u.pivotValues,n.pivotCommon.engineModule=n.olapEngineModule):(n.engineModule.pivotValues=Object(r.isBlazor)()?n.engineModule.pivotValues:u.pivotValues,n.pivotCommon.engineModule=n.engineModule);t||!n.treeViewModule.fieldTable||n.isAdaptive||n.notify("tree-view-update",{});n.isRequiredUpdate?(n.allowDeferLayoutUpdate&&(n.clonedDataSource=Object(r.extend)({},n.dataSourceSettings,null,!0),n.clonedFieldList=Object(r.extend)({},n.pivotFieldList,null,!0)),n.updateView(n.pivotGridModule)):"Popup"===n.renderMode&&n.allowDeferLayoutUpdate&&(n.pivotGridModule.engineModule=n.engineModule,n.pivotGridModule.setProperties({dataSourceSettings:n.dataSourceSettings.properties},!0),n.pivotGridModule.notify(ft,n),Object(p.hideSpinner)(n.fieldListSpinnerElement));"Popup"===n.renderMode&&n.pivotGridModule&&n.pivotGridModule.allowDeferLayoutUpdate&&!n.isRequiredUpdate&&(Object(p.hideSpinner)(n.fieldListSpinnerElement),n.pivotGridModule.hideWaitingPopup());n.isRequiredUpdate=!0;!n.pivotGridModule||i?Object(p.hideSpinner)(n.fieldListSpinnerElement):n.pivotGridModule.fieldListSpinnerElement=n.fieldListSpinnerElement})},t.prototype.updateOlapDataSource=function(n,t,i,r){var u=n.frameCustomProperties(n.olapEngineModule.fieldListData,n.olapEngineModule.fieldList);return u.savedFieldList=n.pivotFieldList,i||t?(n.olapEngineModule.savedFieldList=n.pivotFieldList,n.olapEngineModule.savedFieldListData=n.olapEngineModule.fieldListData,i?(n.olapEngineModule.updateCalcFields(n.dataSourceSettings,n.lastCalcFieldInfo),n.lastCalcFieldInfo={},r=!n.olapEngineModule.dataFields[n.lastCalcFieldInfo.name],n.pivotGridModule&&n.pivotGridModule.hideWaitingPopup()):n.olapEngineModule.onSort(n.dataSourceSettings)):n.olapEngineModule.renderEngine(n.dataSourceSettings,u),r},t.prototype.update=function(n){if(Object(r.isBlazor)()&&void 0!==n){var t=n.ID;n=Object(r.getInstance)("#"+t,ui)}n&&(this.clonedDataSet=n.clonedDataSet,Object(r.isBlazor)()&&!this.isPopupView?e.updateDataSourceSettings(this,e.getClonedDataSourceSettings(n.dataSourceSettings)):this.setProperties({dataSourceSettings:n.dataSourceSettings},!0),this.engineModule=n.engineModule,this.olapEngineModule=n.olapEngineModule,this.dataType=n.dataType,this.pivotFieldList="olap"===this.dataType?n.olapEngineModule.fieldList:n.engineModule.fieldList,"Popup"===this.renderMode&&(this.pivotGridModule=n),this.getFieldCaption(n.dataSourceSettings),this.pivotCommon.engineModule="olap"===this.dataType?this.olapEngineModule:this.engineModule,this.pivotCommon.dataSourceSettings=this.dataSourceSettings,this.pivotCommon.control=this,this.treeViewModule.fieldTable&&!this.isAdaptive&&this.notify("tree-view-update",{}),this.axisFieldModule.render(),"Fixed"===this.renderMode&&this.allowDeferLayoutUpdate&&(this.clonedDataSource=Object(r.extend)({},this.dataSourceSettings,null,!0),this.clonedFieldList=Object(r.extend)({},this.pivotFieldList,null,!0)),this.isPopupView||(this.staticPivotGridModule=n))},t.prototype.updateView=function(n){var t,i;Object(r.isBlazor)()&&void 0!==n&&(t=n.ID,n=Object(r.getInstance)("#"+t,ui));n&&(n.clonedDataSet=this.clonedDataSet,Object(r.isBlazor)()?e.updateDataSourceSettings(n,e.getClonedDataSourceSettings(this.dataSourceSettings)):n.setProperties({dataSourceSettings:this.dataSourceSettings},!0),n.engineModule=this.engineModule,n.olapEngineModule=this.olapEngineModule,n.dataType=this.dataType,n.pivotValues="olap"===this.dataType?this.olapEngineModule.pivotValues:this.engineModule.pivotValues,i={dataSourceSettings:e.getClonedDataSourceSettings(n.dataSourceSettings),pivotValues:n.pivotValues},n.trigger("fieldListRefreshed",i),this.isPopupView||(this.staticPivotGridModule=n),n.enableVirtualization&&Object(r.isBlazor)()?n.renderPivotGrid():n.dataBind())},t.prototype.triggerPopulateEvent=function(){var n=this,t=this.isPopupView?this.pivotGridModule:this,i={dataSourceSettings:this.dataSourceSettings,pivotFieldList:"olap"===this.dataType?this.olapEngineModule.fieldList:this.engineModule.fieldList,pivotValues:"olap"===this.dataType?this.olapEngineModule.pivotValues:this.engineModule.pivotValues};t.trigger("enginePopulated",i,function(t){n.dataSourceSettings=t.dataSourceSettings;n.pivotFieldList=t.pivotFieldList;"olap"===n.dataType?n.olapEngineModule.pivotValues=Object(r.isBlazor)()?n.olapEngineModule.pivotValues:t.pivotValues:n.engineModule.pivotValues=Object(r.isBlazor)()?n.engineModule.pivotValues:t.pivotValues})},t.prototype.destroy=function(){this.unWireEvent();this.treeViewModule&&this.treeViewModule.destroy();this.pivotButtonModule&&this.pivotButtonModule.destroy();this.allowDeferLayoutUpdate&&this.dialogRenderer&&this.dialogRenderer.deferUpdateCheckBox&&!this.dialogRenderer.deferUpdateCheckBox.isDestroyed&&this.dialogRenderer.deferUpdateCheckBox.destroy();n.prototype.destroy.call(this);this.element.innerHTML="";Object(r.removeClass)([this.element],oi);Object(r.removeClass)([this.element],et);Object(r.removeClass)([this.element],vt);"Popup"===this.renderMode&&(this.dialogRenderer.fieldListDialog&&!this.dialogRenderer.fieldListDialog.isDestroyed&&this.dialogRenderer.fieldListDialog.destroy(),document.getElementById(this.element.id+"_Wrapper")&&Object(r.remove)(document.getElementById(this.element.id+"_Wrapper")))},w([Object(r.Complex)({},wi)],t.prototype,"dataSourceSettings",void 0),w([Object(r.Property)("Popup")],t.prototype,"renderMode",void 0),w([Object(r.Property)()],t.prototype,"target",void 0),w([Object(r.Property)("")],t.prototype,"cssClass",void 0),w([Object(r.Property)(!1)],t.prototype,"allowCalculatedField",void 0),w([Object(r.Property)(!1)],t.prototype,"showValuesButton",void 0),w([Object(r.Property)(!1)],t.prototype,"allowDeferLayoutUpdate",void 0),w([Object(r.Property)(1e3)],t.prototype,"maxNodeLimitInMemberEditor",void 0),w([Object(r.Property)(!0)],t.prototype,"loadOnDemandInMemberEditor",void 0),w([Object(r.Property)()],t.prototype,"spinnerTemplate",void 0),w([Object(r.Property)(["Sum","Count","DistinctCount","Product","Min","Max","Avg","Index","PopulationVar","SampleVar","PopulationStDev","SampleStDev","RunningTotals","PercentageOfGrandTotal","PercentageOfColumnTotal","PercentageOfRowTotal","PercentageOfParentColumnTotal","PercentageOfParentRowTotal","DifferenceFrom","PercentageOfDifferenceFrom","PercentageOfParentTotal"])],t.prototype,"aggregateTypes",void 0),w([Object(r.Event)()],t.prototype,"load",void 0),w([Object(r.Event)()],t.prototype,"enginePopulating",void 0),w([Object(r.Event)()],t.prototype,"memberFiltering",void 0),w([Object(r.Event)()],t.prototype,"enginePopulated",void 0),w([Object(r.Event)()],t.prototype,"onFieldDropped",void 0),w([Object(r.Event)()],t.prototype,"fieldDrop",void 0),w([Object(r.Event)()],t.prototype,"fieldDragStart",void 0),w([Object(r.Event)()],t.prototype,"aggregateCellInfo",void 0),w([Object(r.Event)()],t.prototype,"memberEditorOpen",void 0),w([Object(r.Event)()],t.prototype,"calculatedFieldCreate",void 0),w([Object(r.Event)()],t.prototype,"aggregateMenuOpen",void 0),w([Object(r.Event)()],t.prototype,"fieldRemove",void 0),w([Object(r.Event)()],t.prototype,"dataBound",void 0),w([Object(r.Event)()],t.prototype,"created",void 0),w([Object(r.Event)()],t.prototype,"destroyed",void 0),t=w([r.NotifyPropertyChanges],t)}(r.Component),er="PopulationVar",nt="CalculatedField",ue=function(){function n(n){this.isFormula=!1;this.isRequireUpdate=!1;this.parent=n;this.existingReport=null;this.parent.calculatedFieldModule=this;this.removeEventListener();this.addEventListener();this.parentID=this.parent.element.id;this.dialog=null;this.inputObj=null;this.treeObj=null;this.droppable=null;this.menuObj=null;this.newFields=null;this.isFieldExist=!0;this.formulaText=null;this.fieldText=null;this.formatText=null;this.formatType=null;this.fieldType=null;this.parentHierarchy=null;this.isEdit=!1;this.currentFieldName=null;this.confirmPopUp=null}return n.prototype.getModuleName=function(){return"calculatedfield"},n.prototype.keyActionHandler=function(n){var r=n.currentTarget.querySelector(".e-hover.e-node-focus");if(r)switch(n.action){case"moveRight":"pivot"===this.parent.dataType&&this.displayMenu(r.previousSibling);break;case"enter":var i=r.getAttribute("data-field"),u=r.getAttribute("data-type"),t=this.dialog.element.querySelector("#"+this.parentID+"droppable");"pivot"===this.parent.dataType?""===t.value?t.value=u===nt?r.getAttribute("data-uid"):'"'+u+"("+i+')"':""!==t.value&&(t.value=u===nt?t.value+r.getAttribute("data-uid"):t.value+'"'+u+"("+i+')"'):(this.parent.olapEngineModule&&this.parent.olapEngineModule.fieldList[i]&&this.parent.olapEngineModule.fieldList[i].isCalculatedField&&(i=this.parent.olapEngineModule.fieldList[i].tag),""===t.value?t.value=i:""!==t.value&&(t.value=t.value+i))}},n.prototype.fieldClickHandler=function(n){var t=Object(r.closest)(n.event.target,"li");(n.event.target.classList.contains(lt)||n.event.target.classList.contains("e-edit")||n.event.target.classList.contains("e-edited"))&&(this.parent.isAdaptive?"olap"===this.parent.dataType&&this.parent.isAdaptive&&("LI"===t.tagName&&t.querySelector(".e-list-edit-icon").classList.contains("e-edit")?(this.isEdit=!0,this.currentFieldName=t.getAttribute("data-field"),this.fieldText=t.getAttribute("data-caption"),this.formulaText=t.getAttribute("data-formula"),this.formatType=t.getAttribute("data-formatString"),this.formatText="Custom"===this.formatType?t.getAttribute("data-customString"):null,this.fieldType=t.getAttribute("data-membertype"),this.parentHierarchy="Dimension"===this.fieldType?t.getAttribute("data-hierarchy"):null,Object(r.addClass)([t.querySelector(".e-list-edit-icon")],"e-edited"),Object(r.removeClass)([t.querySelector(".e-list-edit-icon")],"e-edit"),this.renderMobileLayout(this.parent.dialogRenderer.adaptiveElement)):"LI"===t.tagName&&t.querySelector(".e-list-edit-icon").classList.contains("e-edited")&&(this.isEdit=!1,this.fieldText=this.formatText=this.formulaText=this.currentFieldName=null,this.parentHierarchy=this.fieldType=this.formatType=null,Object(r.addClass)([t.querySelector(".e-list-edit-icon")],"e-edit"),Object(r.removeClass)([t.querySelector(".e-list-edit-icon")],"e-edited"))):this.displayMenu(t))},n.prototype.accordionClickHandler=function(n){if(n.item&&-1!==n.item.iconCss.indexOf("e-list-icon")&&Object(r.closest)(n.originalEvent.target,".e-acrdn-header-icon")){var i=Object(r.closest)(n.originalEvent.target,".e-acrdn-header").querySelector(".e-pivot-calc-check").getAttribute("data-field"),u=e.getFieldByName(i,this.parent.dataSourceSettings.formatSettings),t=Object(r.closest)(n.originalEvent.target,".e-acrdn-header-icon");t.querySelector(".e-edit")?(this.isEdit=!0,this.currentFieldName=this.fieldText=i,this.formulaText=this.parent.engineModule.fieldList[i].formula,this.formatText=u?u.format:"",Object(r.addClass)([t.querySelector(".e-list-icon")],"e-edited"),Object(r.removeClass)([t.querySelector(".e-list-icon")],"e-edit"),this.renderMobileLayout(this.parent.dialogRenderer.adaptiveElement)):t.querySelector(".e-edited")&&(this.isEdit=!1,this.fieldText=this.formatText=this.formulaText=this.currentFieldName=null,Object(r.addClass)([t.querySelector(".e-list-icon")],"e-edit"),Object(r.removeClass)([t.querySelector(".e-list-icon")],"e-edited"))}},n.prototype.clearFormula=function(){this.treeObj&&this.treeObj.element.querySelector("li")&&(Object(r.removeClass)(this.treeObj.element.querySelectorAll("li"),"e-active"),this.displayMenu(this.treeObj.element.querySelector("li")))},n.prototype.displayMenu=function(n){var s,c;if("pivot"===this.parent.dataType&&n.querySelector(".e-list-icon.e-format")&&n.querySelector(".e-list-icon.e-format").classList.contains(h)&&!n.querySelector(".e-list-icon").classList.contains("e-edited")&&!n.querySelector(".e-list-icon").classList.contains("e-edit")&&"LI"===n.tagName)this.menuObj&&!this.menuObj.isDestroyed&&this.menuObj.destroy(),this.curMenu=n.querySelector(".e-list-text"),this.openContextMenu(n);else if("LI"===n.tagName&&(n.querySelector(".e-list-icon").classList.contains("e-edit")||"olap"===this.parent.dataType&&n.getAttribute("data-type")===nt&&n.classList.contains("e-active"))){this.isEdit=!0;s=n.getAttribute("data-field");c=n.getAttribute("data-caption");this.currentFieldName=s;this.inputObj.value=c;this.inputObj.dataBind();var o=n.getAttribute("data-formatString"),t=this.dialog.element,u=Object(r.getInstance)(t.querySelector("#"+this.parentID+"Custom_Format_Element"),b.MaskedTextBox);if("olap"===this.parent.dataType){var l=n.getAttribute("data-membertype"),y=n.getAttribute("data-hierarchy"),p=n.getAttribute("data-formula"),w=n.getAttribute("data-customString"),v=t.querySelector("#"+this.parentID+"_FieldNameTitle"),i=Object(r.getInstance)(t.querySelector("#"+this.parentID+"Member_Type_Div"),a.DropDownList),e=Object(r.getInstance)(t.querySelector("#"+this.parentID+"Hierarchy_List_Div"),a.DropDownList),f=Object(r.getInstance)(t.querySelector("#"+this.parentID+"Format_Div"),a.DropDownList);v.innerHTML=this.parent.localeObj.getConstant("caption");document.querySelector("#"+this.parentID+"droppable").value=p;i.readonly=!0;i.value=l;i.dataBind();"Dimension"===l&&(e.value=y);""!==o&&(f.value=o,f.dataBind());u.value=w}else u.value=o,Object(r.addClass)(this.treeObj.element.querySelectorAll(".e-edited"),"e-edit"),Object(r.removeClass)(this.treeObj.element.querySelectorAll(".e-edited"),"e-edited"),Object(r.addClass)([n.querySelector(".e-list-icon")],"e-edited"),Object(r.removeClass)([n.querySelector(".e-list-icon")],"e-edit"),n.querySelector(".e-edited").setAttribute("title",this.parent.localeObj.getConstant("clearCalculatedField")),document.querySelector("#"+this.parentID+"droppable").value=n.getAttribute("data-uid");u.dataBind()}else"LI"===n.tagName&&(n.querySelector(".e-list-icon").classList.contains("e-edited")||"olap"===this.parent.dataType&&!n.classList.contains("e-active"))&&(this.isEdit=!1,this.inputObj.value="",this.inputObj.dataBind(),t=this.dialog.element,((u=Object(r.getInstance)(t.querySelector("#"+this.parentID+"Custom_Format_Element"),b.MaskedTextBox)).value="",u.dataBind(),"olap"===this.parent.dataType)?(e=Object(r.getInstance)(t.querySelector("#"+this.parentID+"Hierarchy_List_Div"),a.DropDownList),f=Object(r.getInstance)(t.querySelector("#"+this.parentID+"Format_Div"),a.DropDownList),i=Object(r.getInstance)(t.querySelector("#"+this.parentID+"Member_Type_Div"),a.DropDownList),(v=t.querySelector("#"+this.parentID+"_FieldNameTitle")).innerHTML=this.parent.localeObj.getConstant("fieldTitle"),e.index=0,e.dataBind(),f.index=0,f.dataBind(),i.index=0,i.readonly=!1,i.dataBind()):(Object(r.addClass)(this.treeObj.element.querySelectorAll(".e-edited"),"e-edit"),Object(r.removeClass)(this.treeObj.element.querySelectorAll(".e-edited"),"e-edited"),n.querySelector(".e-edit").setAttribute("title",this.parent.localeObj.getConstant("edit"))),document.querySelector("#"+this.parentID+"droppable").value="")},n.prototype.openContextMenu=function(n){var t=this,i=n.getAttribute("data-field"),r="number"!==this.parent.engineModule.fieldList[i].type?"string":"number",u="string"===r?this.getValidSummaryType().slice(0,2):this.getValidSummaryType(),f={cancel:!1,fieldName:i,aggregateTypes:this.getMenuItems(r).slice()};("pivotfieldlist"===this.parent.getModuleName()&&this.parent.isPopupView?this.parent.pivotGridModule:this.parent).trigger("aggregateMenuOpen",f,function(i){var r,f,o;if(!i.cancel){for(var s=[],h=[],e=0,c=i.aggregateTypes;e<c.length;e++)r=c[e],u.indexOf(r)>-1&&-1===s.indexOf(r)&&(s.push(r),h.push({id:t.parent.element.id+"Calc_"+r,text:t.parent.localeObj.getConstant(r)}));t.createMenu(h);f=n.getBoundingClientRect();o=window.scrollY||document.documentElement.scrollTop;t.parent.enableRtl?t.menuObj.open(f.top+o,f.left-100):t.menuObj.open(f.top+o,f.left+150)}})},n.prototype.selectContextMenu=function(n){if(null!==n.element.textContent){var t=Object(r.closest)(this.curMenu,".e-list-item").getAttribute("data-caption");Object(r.closest)(this.curMenu,".e-list-item").setAttribute("data-type",n.element.id.split("_").pop());this.curMenu.textContent=t+" ("+n.element.textContent+")";Object(r.addClass)([this.curMenu.parentElement.parentElement],["e-node-focus","e-hover"]);this.curMenu.parentElement.parentElement.setAttribute("tabindex","-1");this.curMenu.parentElement.parentElement.focus()}},n.prototype.createMenu=function(n){var t,i={cssClass:this.parentID+"calculatedmenu",items:n,enableRtl:this.parent.enableRtl,select:this.selectContextMenu.bind(this)};t=document.querySelector("#"+this.parentID+"CalcContextmenu")?document.querySelector("#"+this.parentID+"CalcContextmenu"):Object(r.createElement)("ul",{id:this.parentID+"CalcContextmenu"});this.dialog.element.appendChild(t);this.menuObj=new rt.ContextMenu(i);this.menuObj.isStringTemplate=!0;this.menuObj.appendTo(t)},n.prototype.applyFormula=function(){var n=this,t=this,i=!1,u;Object(r.removeClass)([document.getElementById(this.parentID+"ddlelement")],"e-empty-field");this.newFields=Object(r.extend)([],this.parent.dataSourceSettings.calculatedFieldSettings,null,!0);u={fieldName:this.isEdit?this.currentFieldName:this.inputObj.value,calculatedField:this.getCalculatedFieldInfo(),calculatedFieldSettings:e.cloneCalculatedFieldSettings(this.parent.dataSourceSettings.calculatedFieldSettings),cancel:!1};("pivotfieldlist"===this.parent.getModuleName()&&this.parent.isPopupView?this.parent.pivotGridModule:this.parent).trigger("calculatedFieldCreate",u,function(u){var f,o,c,y,p,e,l,b,a,v,s,h;if(u.cancel)n.endDialog(),n.parent.lastCalcFieldInfo={},n.isFormula=!1;else{if(f=u.calculatedField,!n.isEdit)if("olap"===t.parent.dataType)o=f.name,t.parent.olapEngineModule.fieldList[o]&&"CalculatedField"!==t.parent.olapEngineModule.fieldList[o].type&&(i=!0);else for(c=0,y=Object.keys(t.parent.engineModule.fieldList);c<y.length;c++)p=y[c],f.name&&f.name===p&&"CalculatedField"!==t.parent.engineModule.fieldList[p].aggregateType&&(i=!0);if(i)return void t.parent.pivotCommon.errorDialog.createErrorDialog(t.parent.localeObj.getConstant("error"),t.parent.localeObj.getConstant("fieldExist"));if(n.existingReport=Object(r.extend)({},n.parent.dataSourceSettings,null,!0),e=n.parent.dataSourceSettings,Object(r.isNullOrUndefined)(f.name)||""===f.name||Object(r.isNullOrUndefined)(f.caption)||""===f.caption||!f.formula||""===f.formula)Object(r.isNullOrUndefined)(f.name)||""===f.name||Object(r.isNullOrUndefined)(f.caption)||""===f.caption?(n.inputObj.value="",Object(r.addClass)([document.getElementById(n.parentID+"ddlelement")],"e-empty-field"),document.getElementById(n.parentID+"ddlelement").focus()):n.parent.pivotCommon.errorDialog.createErrorDialog(n.parent.localeObj.getConstant("error"),n.parent.localeObj.getConstant("invalidFormula"));else{if(o=void 0,"olap"===n.parent.dataType){if(o={name:f.name,formula:f.formula,formatString:f.formatString},Object(r.isNullOrUndefined)(f.hierarchyUniqueName)||(o.hierarchyUniqueName=f.hierarchyUniqueName),n.isFieldExist=!1,n.isEdit){for(s=0;s<e.calculatedFieldSettings.length;s++)if(e.calculatedFieldSettings[s].name===o.name&&n.isEdit){e.calculatedFieldSettings[s].hierarchyUniqueName=f.hierarchyUniqueName;n.parent.olapEngineModule.fieldList[o.name].caption=f.caption;e.calculatedFieldSettings[s].formatString=o.formatString;e.calculatedFieldSettings[s].formula=o.formula;o=e.calculatedFieldSettings[s];n.isFieldExist=!0;break}for(var k=!1,w=0,d=[e.rows,e.columns,e.values,e.filters];w<d.length;w++){for(l=0,b=d[w];l<b.length;l++)if(a=b[l],a.isCalculatedField&&null!==o.name&&a.name===o.name&&n.isEdit){a.caption=f.caption;n.isFieldExist=!0;k=!0;break}if(k)break}}else for(s=0;s<e.calculatedFieldSettings.length;s++)if(e.calculatedFieldSettings[s].name===o.name)return void n.createConfirmDialog(t.parent.localeObj.getConstant("alert"),t.parent.localeObj.getConstant("confirmText"),f);n.isFieldExist||e.calculatedFieldSettings.push(o);n.parent.lastCalcFieldInfo=o}else{if(o={name:f.name,caption:f.caption,type:"CalculatedField"},v={name:f.name,formula:f.formula},Object(r.isNullOrUndefined)(f.formatString)||(v.formatString=f.formatString),n.isFieldExist=!0,n.isEdit){for(s=0;s<e.values.length;s++)if(e.values[s].type===nt&&null!==o.name&&e.values[s].name===o.name&&n.isEdit)for(h=0;h<e.calculatedFieldSettings.length;h++)e.calculatedFieldSettings[h].name===o.name&&(e.values[s].caption=f.caption,e.calculatedFieldSettings[h].formula=f.formula,n.parent.engineModule.fieldList[o.name].caption=f.caption,n.updateFormatSettings(e,o.name,f.formatString),n.isFieldExist=!1)}else for(s=0;s<e.values.length;s++)if(e.values[s].type===nt&&e.values[s].name===o.name){for(h=0;h<e.calculatedFieldSettings.length;h++)if(e.calculatedFieldSettings[h].name===o.name)return void n.createConfirmDialog(t.parent.localeObj.getConstant("alert"),t.parent.localeObj.getConstant("confirmText"),f);n.isFieldExist=!1}n.isFieldExist&&(e.values.push(o),e.calculatedFieldSettings.push(v),n.updateFormatSettings(e,o.name,f.formatString));n.parent.lastCalcFieldInfo=v}n.addFormula(e,o.name)}}})},n.prototype.getCalculatedFieldInfo=function(){var n,f=document.querySelector("#"+this.parentID+"droppable"),t=this.parent.isAdaptive?this.parent.dialogRenderer.adaptiveElement.element:this.dialog.element,i=Object(r.getInstance)(t.querySelector("#"+this.parentID+"Custom_Format_Element"),b.MaskedTextBox);if(n={name:this.isEdit?this.currentFieldName:this.inputObj.value,caption:this.inputObj.value,formula:f.value},"olap"===this.parent.dataType){var u=Object(r.getInstance)(t.querySelector("#"+this.parentID+"Format_Div"),a.DropDownList),e=Object(r.getInstance)(t.querySelector("#"+this.parentID+"Member_Type_Div"),a.DropDownList),o=Object(r.getInstance)(t.querySelector("#"+this.parentID+"Hierarchy_List_Div"),a.DropDownList);n.formatString="Custom"===u.value?i.value:u.value;"Dimension"===e.value&&(n.hierarchyUniqueName=o.value)}else n.formatString=i.value;return n},n.prototype.updateFormatSettings=function(n,t,i){for(var f,e={name:t,format:i,useGrouping:!0},u=!1,r=0;r<n.formatSettings.length;r++)if(n.formatSettings[r].name===t){if("undefined"===i||void 0===i||""===i){n.formatSettings.splice(r,1);u=!0;break}f=n.formatSettings[r].properties?n.formatSettings[r].properties:n.formatSettings[r];f.format=i;n.formatSettings.splice(r,1,f);u=!0;break}u||""===i||n.formatSettings.push(e)},n.prototype.addFormula=function(n,t){this.isFormula=!0;this.field=t;Object(r.isBlazor)()?e.updateDataSourceSettings(this.parent,e.getClonedDataSourceSettings(n)):this.parent.setProperties({dataSourceSettings:n},!0);"pivotfieldlist"===this.parent.getModuleName()&&this.parent.allowDeferLayoutUpdate&&(this.parent.isRequiredUpdate=!1);try{this.parent.updateDataSource(!1);var i="pivotfieldlist"===this.parent.getModuleName()?this.parent.pivotGridModule:this.parent;Object(r.isBlazor)()&&i&&i.enableVirtualization?this.isRequireUpdate=!0:this.endDialog()}catch(n){this.showError()}},n.prototype.endDialog=function(){var n;if(this.isEdit=!1,this.dialog)this.dialog.close();else if(this.inputObj.value="",this.currentFieldName=this.formatText=this.fieldText=this.formatType=null,this.formulaText=this.fieldType=this.parentHierarchy=null,n=this.parent.isAdaptive?this.parent.dialogRenderer.parentElement:this.dialog.element,this.parent.dialogRenderer.parentElement.querySelector("."+ti).value="",this.parent.dialogRenderer.parentElement.querySelector("#"+this.parentID+"droppable").value="",this.parent.dialogRenderer.parentElement.querySelector("#"+this.parentID+"Custom_Format_Element").value="","olap"===this.parent.dataType){var u=Object(r.getInstance)(n.querySelector("#"+this.parentID+"Custom_Format_Element"),b.MaskedTextBox),f=Object(r.getInstance)(n.querySelector("#"+this.parentID+"Format_Div"),a.DropDownList),t=Object(r.getInstance)(n.querySelector("#"+this.parentID+"Member_Type_Div"),a.DropDownList),i=Object(r.getInstance)(n.querySelector("#"+this.parentID+"Hierarchy_List_Div"),a.DropDownList);f.index=0;f.dataBind();t.index=0;t.readonly=!1;t.dataBind();i.index=0;i.enabled=!1;i.dataBind();u.enabled=!1;u.dataBind()}},n.prototype.showError=function(){this.parent.engineModule.fieldList[this.field]&&delete this.parent.engineModule.fieldList[this.field];this.parent.pivotCommon.errorDialog.createErrorDialog(this.parent.localeObj.getConstant("error"),this.parent.localeObj.getConstant("invalidFormula"));Object(r.isBlazor)()?e.updateDataSourceSettings(this.parent,e.getClonedDataSourceSettings(this.existingReport)):this.parent.setProperties({dataSourceSettings:this.existingReport},!0);this.parent.lastCalcFieldInfo={};this.parent.updateDataSource(!1);this.isFormula=!1},n.prototype.getFieldListData=function(n){var o=[],r,s,i,u,c,l,t,f;if("olap"===this.parent.dataType)for(r=0,s=o=e.getClonedData(n.olapEngineModule.fieldListData);r<s.length;r++)i=s[r],i.spriteCssClass&&(i.spriteCssClass.indexOf("e-attributeCDB-icon")>-1||i.spriteCssClass.indexOf("e-level-members")>-1)?i.hasChildren=!0:i.spriteCssClass&&i.spriteCssClass.indexOf("e-namedSetCDB-icon")>-1?i.hasChildren=!1:i.spriteCssClass&&i.spriteCssClass.indexOf("e-calcMemberGroupCDB")>-1&&(i.expanded=this.isEdit);else for(u=0,c=Object.keys(n.engineModule.fieldList);u<c.length;u++)t=c[u],f=null,f="number"===n.engineModule.fieldList[t].type&&"include"!==n.engineModule.fieldList[t].type&&"exclude"!==n.engineModule.fieldList[t].type||"DistinctCount"===n.engineModule.fieldList[t].aggregateType?void 0!==n.engineModule.fieldList[t].aggregateType?n.engineModule.fieldList[t].aggregateType:"Sum":"Count",l=this.parent.localeObj.getConstant(f),o.push({index:n.engineModule.fieldList[t].index,name:n.engineModule.fieldList[t].caption+" ("+l+")",type:f,icon:lt+" "+h,formula:n.engineModule.fieldList[t].formula,field:t,caption:n.engineModule.fieldList[t].caption?n.engineModule.fieldList[t].caption:t});return o},n.prototype.fieldDropped=function(n){var t,i,o,f;if(n.cancel=!0,t=this.dialog.element.querySelector("#"+this.parentID+"droppable"),Object(r.removeClass)([t],"e-copy-drop"),Object(r.removeClass)([n.draggedNode.querySelector(".e-list-text")],"e-list-selected"),i=n.draggedNode.getAttribute("data-field"),"olap"===this.parent.dataType)if(this.parent.olapEngineModule.fieldList[i]&&this.parent.olapEngineModule.fieldList[i].isCalculatedField&&(i=this.parent.olapEngineModule.fieldList[i].tag),n.target.id===this.parentID+"droppable"&&""===t.value)t.value=i,t.focus();else if(n.target.id===this.parentID+"droppable"&&""!==t.value){var u=void 0,e=t.value,s=t.selectionStart,h=e.substring(s,e.length);u=(f=e.substring(0,s))+i;t.value=f+i+h;t.focus();t.setSelectionRange(u.length,u.length)}else n.cancel=!0;else o=n.draggedNode.getAttribute("data-type"),n.target.id===this.parentID+"droppable"&&""===t.value?(t.value=o===nt?n.draggedNodeData.id.toString():'"'+o+"("+i+')"',t.focus()):n.target.id===this.parentID+"droppable"&&""!==t.value?(u=void 0,s=t.selectionStart,f=(e=t.value).substring(0,s),h=e.substring(s,e.length),o===nt?(u=f+n.draggedNodeData.id.toString(),t.value=f+n.draggedNodeData.id.toString()+h):(u=f+'"'+o+"("+i+')"',t.value=f+'"'+o+"("+i+')"'+h),t.focus(),t.setSelectionRange(u.length,u.length)):n.cancel=!0},n.prototype.createDialog=function(){var n=this,t,i;if(null!==document.querySelector("#"+this.parentID+"calculateddialog"))for(Object(r.remove)(document.querySelector("#"+this.parentID+"calculateddialog"));!Object(r.isNullOrUndefined)(document.querySelector("."+this.parentID+"calculatedmenu"));)Object(r.remove)(document.querySelector("."+this.parentID+"calculatedmenu"));this.parent.element.appendChild(Object(r.createElement)("div",{id:this.parentID+"calculateddialog",className:"e-pivot-calc-dialog-div "+("olap"===this.parent.dataType?"e-olap-calc-dialog-div":"")}));t=[{click:this.applyFormula.bind(this),buttonModel:{content:this.parent.localeObj.getConstant("ok"),isPrimary:!0}},{click:this.cancelClick.bind(this),buttonModel:{content:this.parent.localeObj.getConstant("cancel")}}];"olap"===this.parent.dataType&&(i={click:this.clearFormula.bind(this),buttonModel:{cssClass:"e-calc-clear-btn",content:this.parent.localeObj.getConstant("clear")}},t.splice(0,0,i));this.dialog=new p.Dialog({allowDragging:!0,position:{X:"center",Y:"center"},buttons:t,close:this.closeDialog.bind(this),beforeOpen:this.beforeOpen.bind(this),open:function(){n.dialog.element.querySelector("#"+n.parentID+"ddlelement")&&n.dialog.element.querySelector("#"+n.parentID+"ddlelement").focus()},animationSettings:{effect:"Zoom"},width:"25%",isModal:!1,closeOnEscape:!0,enableRtl:this.parent.enableRtl,showCloseIcon:!0,header:this.parent.localeObj.getConstant("createCalculatedField"),target:document.body});this.dialog.isStringTemplate=!0;this.dialog.appendTo("#"+this.parentID+"calculateddialog")},n.prototype.cancelClick=function(){this.dialog.close();this.isEdit=!1},n.prototype.beforeOpen=function(){this.dialog.element.querySelector(".e-dlg-header").setAttribute("title",this.parent.localeObj.getConstant("createCalculatedField"))},n.prototype.closeDialog=function(){"pivotfieldlist"===this.parent.getModuleName()&&(this.parent.axisFieldModule.render(),"Fixed"!==this.parent.renderMode&&(Object(r.addClass)([this.parent.element.querySelector(".e-toggle-field-list")],"e-hide"),this.parent.dialogRenderer.fieldListDialog.show()));this.treeObj.destroy();this.dialog.destroy();this.newFields=null;this.menuObj&&!this.menuObj.isDestroyed&&this.menuObj.destroy();Object(r.remove)(document.getElementById(this.parentID+"calculateddialog"));Object(r.isNullOrUndefined)(document.querySelector("."+this.parentID+"calculatedmenu"))||Object(r.remove)(document.querySelector("."+this.parentID+"calculatedmenu"))},n.prototype.renderDialogElements=function(){var n=Object(r.createElement)("div",{id:this.parentID+"outerDiv",className:("olap"===this.parent.dataType?"e-olap-calc-outer-div ":"")+"e-pivot-calc-outer-div"}),g=Object(r.createElement)("div",{id:this.parentID+"Olap_Tree_Div",className:"e-olap-field-tree-div"}),t=Object(r.createElement)("div",{id:this.parentID+"Olap_Calc_Div",className:"e-olap-calculated-div"}),nt,f,s,tt,e,v,o,it,y,w,c,rt,b,ut,k,l,d,i,a;if("pivotfieldlist"===this.parent.getModuleName()&&null!==this.parent.dialogRenderer.parentElement.querySelector("."+kt)&&this.parent.isAdaptive){nt=Object(r.createElement)("div",{id:this.parentID+"accordDiv",className:"e-pivot-accord"});n.appendChild(nt);var u=Object(r.createElement)("div",{id:this.parentID+"buttonDiv",className:"e-pivot-button-div"}),ft=Object(r.createElement)("button",{id:this.parentID+"addBtn",innerHTML:this.parent.localeObj.getConstant("add"),className:"e-pivot-add-button"}),et=Object(r.createElement)("button",{id:this.parentID+"cancelBtn",innerHTML:this.parent.localeObj.getConstant("cancel"),className:"e-pivot-cancel-button"});u.appendChild(et);u.appendChild(ft);n.appendChild(u)}else this.parent.isAdaptive||"olap"!==this.parent.dataType||(f=Object(r.createElement)("div",{className:"e-pivot-field-name-title",id:this.parentID+"_FieldNameTitle",innerHTML:this.parent.localeObj.getConstant("fieldTitle")}),t.appendChild(f)),s=Object(r.createElement)("div",{id:this.parentID+"outerDiv",className:"e-pivot-calc-input-div"}),tt=Object(r.createElement)("input",{id:this.parentID+"ddlelement",attrs:{type:"text"},className:ti}),s.appendChild(tt),"olap"!==this.parent.dataType||this.parent.isAdaptive?n.appendChild(s):t.appendChild(s),e=Object(r.createElement)("div",{id:this.parentID+"control_wrapper",className:"e-pivot-treeview-outer"}),this.parent.isAdaptive||(v=Object(r.createElement)("div",{className:"e-pivot-all-field-title",innerHTML:"olap"===this.parent.dataType?this.parent.localeObj.getConstant("allFields"):this.parent.localeObj.getConstant("formulaField")}),"olap"===this.parent.dataType?(o=Object(r.createElement)("div",{className:"e-pivot-all-field-title-wrapper"}),o.appendChild(v),it=Object(r.createElement)("span",{attrs:{tabindex:"0","aria-disabled":"false","aria-label":this.parent.localeObj.getConstant("fieldTooltip")},className:h+" e-info"}),o.appendChild(it),new p.Tooltip({content:this.parent.localeObj.getConstant("fieldTooltip"),position:this.parent.enableRtl?"RightCenter":"LeftCenter",target:".e-info",offsetY:(this.parent.enableRtl,-10),width:220}).appendTo(o),e.appendChild(o)):n.appendChild(v)),y=Object(r.createElement)("div",{className:"e-pivot-treeview-outer-div"}),(e.appendChild(y),y.appendChild(Object(r.createElement)("div",{id:this.parentID+"tree",className:"e-pivot-treeview"})),"olap"!==this.parent.dataType||this.parent.isAdaptive?n.appendChild(e):g.appendChild(e),this.parent.isAdaptive)||(f=Object(r.createElement)("div",{className:"e-pivot-formula-title",innerHTML:"olap"===this.parent.dataType?this.parent.localeObj.getConstant("expressionField"):this.parent.localeObj.getConstant("formula")}),"olap"===this.parent.dataType?t.appendChild(f):n.appendChild(f)),w=Object(r.createElement)("textarea",{id:this.parentID+"droppable",className:kt,attrs:{placeholder:this.parent.isAdaptive?this.parent.localeObj.getConstant("dropTextMobile"):"olap"===this.parent.dataType?this.parent.localeObj.getConstant("olapDropText"):this.parent.localeObj.getConstant("dropText")}}),("olap"!==this.parent.dataType||this.parent.isAdaptive?n.appendChild(w):t.appendChild(w),this.parent.isAdaptive)&&(u=Object(r.createElement)("div",{id:this.parentID+"buttonDiv",className:"e-pivot-button-div"}),c=Object(r.createElement)("button",{id:this.parentID+"okBtn",innerHTML:this.parent.localeObj.getConstant("apply"),className:"e-pivot-ok-button"}),u.appendChild(c),n.appendChild(u)),"olap"===this.parent.dataType?(this.parent.isAdaptive||(rt=Object(r.createElement)("div",{className:"e-olap-member-title",innerHTML:this.parent.localeObj.getConstant("memberType")}),t.appendChild(rt)),b=Object(r.createElement)("div",{id:this.parentID+"Member_Type_Div",className:"e-olap-calc-member-type-div"}),(this.parent.isAdaptive?n.appendChild(b):t.appendChild(b),this.parent.isAdaptive)||(ut=Object(r.createElement)("div",{className:"e-olap-hierarchy-title",innerHTML:this.parent.localeObj.getConstant("selectedHierarchy")}),t.appendChild(ut)),k=Object(r.createElement)("div",{id:this.parentID+"Hierarchy_List_Div",className:"e-olap-calc-hierarchy-list-div"}),(this.parent.isAdaptive?n.appendChild(k):t.appendChild(k),this.parent.isAdaptive)||(l=Object(r.createElement)("div",{className:"e-olap-format-title",innerHTML:this.parent.localeObj.getConstant("formatString")}),t.appendChild(l)),d=Object(r.createElement)("div",{id:this.parentID+"Format_Div",className:"e-olap-calc-format-type-div"}),this.parent.isAdaptive?n.appendChild(d):t.appendChild(d),i=Object(r.createElement)("div",{id:this.parentID+"custom_Format_Div",className:"e-olap-calc-custom-format-div"}),a=Object(r.createElement)("input",{id:this.parentID+"Custom_Format_Element",attrs:{type:"text"},className:"e-custom-format-input"}),(i.appendChild(a),t.appendChild(i),this.parent.isAdaptive?n.appendChild(i):t.appendChild(i),"pivotfieldlist"===this.parent.getModuleName()&&null===this.parent.dialogRenderer.parentElement.querySelector("."+kt)&&this.parent.isAdaptive)?(c=n.querySelector(".e-pivot-ok-button"),n.appendChild(c)):(n.appendChild(g),n.appendChild(t))):(i=Object(r.createElement)("div",{id:this.parentID+"custom_Format_Div",className:"e-pivot-calc-custom-format-div"}),this.parent.isAdaptive||(l=Object(r.createElement)("div",{className:"e-olap-format-title",innerHTML:this.parent.localeObj.getConstant("formatString")}),i.appendChild(l)),a=Object(r.createElement)("input",{id:this.parentID+"Custom_Format_Element",attrs:{type:"text"},className:"e-custom-format-input"}),i.appendChild(a),this.parent.isAdaptive?n.insertBefore(i,n.querySelector("#"+this.parentID+"buttonDiv")):n.appendChild(i));return n},n.prototype.renderAdaptiveLayout=function(n){var t=this.parent.dialogRenderer.adaptiveElement,u,f,e,i;n?((t.element.querySelector("#"+this.parentID+"droppable")&&(this.formulaText=document.querySelector("#"+this.parentID+"droppable").value,this.fieldText=this.inputObj.value),t.element.querySelector(".e-olap-calc-member-type-div"))&&(u=Object(r.getInstance)(t.element.querySelector("#"+this.parentID+"Member_Type_Div"),a.DropDownList),this.fieldType=u.value),t.element.querySelector(".e-olap-calc-hierarchy-list-div")&&(f=Object(r.getInstance)(t.element.querySelector("#"+this.parentID+"Hierarchy_List_Div"),a.DropDownList),this.parentHierarchy="Dimension"===this.fieldType?f.value:null),t.element.querySelector(".e-olap-calc-format-type-div")&&(e=Object(r.getInstance)(t.element.querySelector("#"+this.parentID+"Format_Div"),a.DropDownList),this.formatType=e.value),t.element.querySelector(".e-custom-format-input")&&(i=Object(r.getInstance)(t.element.querySelector("#"+this.parentID+"Custom_Format_Element"),b.MaskedTextBox),this.formatText="olap"===this.parent.dataType?"Custom"===this.formatType?i.value:null:i.value)):(this.currentFieldName=this.formulaText=this.fieldText=this.formatText=null,this.fieldType=this.formatType=this.parentHierarchy=null);this.renderMobileLayout(t)},n.prototype.updateAdaptiveCalculatedField=function(n,t){var i=this.parent.dialogRenderer.adaptiveElement.element,u,f,o,c,s,h;this.isEdit=n;u=n?"pivot"===this.parent.dataType?this.parent.engineModule.fieldList[t]:this.parent.olapEngineModule.fieldList[t]:{id:null,caption:null,formula:null,fieldType:"Measure",formatString:"pivot"===this.parent.dataType?null:"Standard",parentHierarchy:null};(this.currentFieldName=u.id,i.querySelector("#"+this.parentID+"droppable")&&(this.formulaText=document.querySelector("#"+this.parentID+"droppable").value=u.formula,this.fieldText=this.inputObj.value=u.caption,this.inputObj.dataBind()),i.querySelector(".e-olap-calc-member-type-div"))&&(f=Object(r.getInstance)(i.querySelector("#"+this.parentID+"Member_Type_Div"),a.DropDownList),this.fieldType=f.value=u.fieldType,f.readonly=!!n,f.dataBind());i.querySelector(".e-olap-calc-hierarchy-list-div")&&(o=Object(r.getInstance)(i.querySelector("#"+this.parentID+"Hierarchy_List_Div"),a.DropDownList),"Dimension"===this.fieldType?this.parentHierarchy=o.value=u.parentHierarchy:(this.parentHierarchy=null,o.index=0),o.dataBind());i.querySelector(".e-olap-calc-format-type-div")&&(c=Object(r.getInstance)(i.querySelector("#"+this.parentID+"Format_Div"),a.DropDownList),this.formatType=c.value=["Standard","Currency","Percent"].indexOf(u.formatString)>-1?u.formatString:"Custom");i.querySelector(".e-custom-format-input")&&(s=Object(r.getInstance)(i.querySelector("#"+this.parentID+"Custom_Format_Element"),b.MaskedTextBox),h=e.getFieldByName(t,this.parent.dataSourceSettings.formatSettings),this.formatText="pivot"===this.parent.dataType?s.value=h?h.format:null:s.value="Custom"===this.formatType?u.formatString:null,s.dataBind())},n.prototype.createOlapDropElements=function(){for(var p,s,w,k,h,d,t,i,r,u,f,n=this,c=this.parent.isAdaptive?this.parent.dialogRenderer.parentElement:this.dialog.element,l=[],v=[],o=[],y=0,g=["Measure","Dimension"];y<g.length;y++)p=g[y],l.push({value:p,text:this.parent.localeObj.getConstant(p)});for(s=0,w=["Standard","Currency","Percent","Custom"];s<w.length;s++)k=w[s],v.push({value:k,text:this.parent.localeObj.getConstant(k)});for(h=0,d=e.getClonedData(this.parent.olapEngineModule.fieldListData);h<d.length;h++)t=d[h],t.spriteCssClass&&(t.spriteCssClass.indexOf("e-attributeCDB-icon")>-1||t.spriteCssClass.indexOf("e-hierarchyCDB-icon")>-1)&&o.push({value:t.id,text:t.caption});i=new a.DropDownList({dataSource:l,enableRtl:this.parent.enableRtl,fields:{value:"value",text:"text"},value:null!==this.fieldType?this.fieldType:l[0].value,readonly:this.isEdit,cssClass:"e-member-options",width:"100%",change:function(t){r.enabled="Dimension"===t.value;n.fieldType=t.value;n.formulaText=document.querySelector("#"+n.parentID+"droppable").value;r.dataBind()}});i.isStringTemplate=!0;i.appendTo(c.querySelector("#"+this.parentID+"Member_Type_Div"));r=new a.DropDownList({dataSource:o,enableRtl:this.parent.enableRtl,allowFiltering:!0,enabled:"Dimension"===i.value,filterBarPlaceholder:this.parent.localeObj.getConstant("example")+" "+o[0].text.toString(),fields:{value:"value",text:"text"},value:null!==this.parentHierarchy&&"Dimension"===i.value?this.parentHierarchy:o[0].value,cssClass:"e-member-options",width:"100%",change:function(t){n.parentHierarchy=t.value;n.formulaText=document.querySelector("#"+n.parentID+"droppable").value}});r.isStringTemplate=!0;r.appendTo(c.querySelector("#"+this.parentID+"Hierarchy_List_Div"));u=new a.DropDownList({dataSource:v,enableRtl:this.parent.enableRtl,fields:{value:"value",text:"text"},value:null!==this.formatType?this.formatType:v[0].value,cssClass:"e-member-options",width:"100%",change:function(t){f.enabled="Custom"===t.value;n.formatType=t.value;n.formulaText=document.querySelector("#"+n.parentID+"droppable").value;f.dataBind()}});u.isStringTemplate=!0;u.appendTo(c.querySelector("#"+this.parentID+"Format_Div"));f=new b.MaskedTextBox({placeholder:this.parent.localeObj.getConstant("customFormat"),value:null!==this.formatText&&"Custom"===u.value?this.formatText:null,enabled:"Custom"===u.value,change:function(t){n.formatText=t.value;n.formulaText=document.querySelector("#"+n.parentID+"droppable").value}});f.isStringTemplate=!0;f.appendTo("#"+this.parentID+"Custom_Format_Element")},n.prototype.createTreeView=function(){var n=this;this.treeObj="olap"===this.parent.dataType?new rt.TreeView({fields:{dataSource:this.getFieldListData(this.parent),id:"id",text:"caption",parentID:"pid",iconCss:"spriteCssClass"},allowDragAndDrop:!0,enableRtl:this.parent.enableRtl,nodeDragStart:this.dragStart.bind(this),nodeDragging:function(n){n.event.target&&n.event.target.classList.contains(kt)?(Object(r.removeClass)([n.clonedNode],"e-drag-restrict"),Object(r.addClass)([n.event.target],"e-copy-drop")):(Object(r.addClass)([n.clonedNode],"e-drag-restrict"),Object(r.removeClass)([n.event.target],"e-copy-drop"),n.dropIndicator="e-no-drop",Object(r.addClass)([n.clonedNode.querySelector("."+h)],"e-icon-expandable"),Object(r.removeClass)([n.clonedNode.querySelector("."+h)],"e-list-icon"))},nodeClicked:this.fieldClickHandler.bind(this),nodeSelected:function(t){t.node.getAttribute("data-type")===nt?n.displayMenu(t.node):(Object(r.removeClass)([t.node],"e-active"),t.cancel=!0)},nodeDragStop:this.fieldDropped.bind(this),drawNode:this.drawTreeNode.bind(this),nodeExpanding:this.updateNodeIcon.bind(this),nodeCollapsed:this.updateNodeIcon.bind(this),sortOrder:"None"}):new rt.TreeView({fields:{dataSource:this.getFieldListData(this.parent),id:"formula",text:"name",iconCss:"icon"},allowDragAndDrop:!0,enableRtl:this.parent.enableRtl,nodeCollapsing:this.nodeCollapsing.bind(this),nodeDragStart:this.dragStart.bind(this),nodeClicked:this.fieldClickHandler.bind(this),nodeDragStop:this.fieldDropped.bind(this),drawNode:this.drawTreeNode.bind(this),sortOrder:"Ascending"});this.treeObj.isStringTemplate=!0;this.treeObj.appendTo("#"+this.parentID+"tree")},n.prototype.updateNodeIcon=function(n){var t,e,u,o;if(n.node&&n.node.querySelector(".e-list-icon")&&n.node.querySelector(".e-icon-expandable.e-process")&&n.node.querySelector(".e-list-icon").className.indexOf("e-folderCDB-icon")>-1)t=n.node.querySelector(".e-list-icon"),Object(r.removeClass)([t],"e-folderCDB-icon"),Object(r.addClass)([t],"e-folderCDB-open-icon");else if(n.node&&n.node.querySelector(".e-list-icon")&&n.node.querySelector(".e-icon-expandable")&&n.node.querySelector(".e-list-icon").className.indexOf("e-folderCDB-open-icon")>-1)t=n.node.querySelector(".e-list-icon"),Object(r.removeClass)([t],"e-folderCDB-open-icon"),Object(r.addClass)([t],"e-folderCDB-icon");else{for(var s=this.treeObj.fields.dataSource,i=[],f=0,h=s;f<h.length;f++)e=h[f],e.pid===n.nodeData.id.toString()&&i.push(e);if(0!==i.length)return;for(this.parent.olapEngineModule.calcChildMembers=[],this.parent.olapEngineModule.getCalcChildMembers(this.parent.dataSourceSettings,n.nodeData.id.toString()),i=this.parent.olapEngineModule.calcChildMembers,this.parent.olapEngineModule.calcChildMembers=[],u=0,o=i;u<o.length;u++)(t=o[u]).pid=n.nodeData.id.toString(),t.hasChildren=!1,t.spriteCssClass="e-level-members",t.caption=""===t.caption?this.parent.localeObj.getConstant("blank"):t.caption,s.push(t);this.treeObj.addNodes(i,n.node)}},n.prototype.nodeCollapsing=function(n){n.cancel=!0},n.prototype.dragStart=function(n){var i=!1,t=n.clonedNode;t&&("olap"===this.parent.dataType&&(t.querySelector(".e-calc-dimension-icon,.e-calc-measure-icon,.e-measure-icon")||t.querySelector(".e-dimensionCDB-icon,.e-attributeCDB-icon,.e-hierarchyCDB-icon")||t.querySelector(".e-level-members,.e-namedSetCDB-icon"))||"pivot"===this.parent.dataType&&n.event.target.classList.contains("e-drag"))&&(i=!0);i?(Object(r.addClass)([n.draggedNode.querySelector(".e-list-text")],"e-list-selected"),Object(r.addClass)([t],"e-pivot-calc"),t.style.zIndex=(this.dialog.zIndex+1).toString(),t.style.display="inline"):n.cancel=!0},n.prototype.drawTreeNode=function(n){var t,i,u,c,f,o,l,s,a;"olap"===this.parent.dataType?(n.node.querySelector(".e-measure-icon")&&(n.node.querySelector(".e-list-icon").style.display="none"),t=n.nodeData,n.node.setAttribute("data-field",t.id),n.node.setAttribute("data-caption",t.caption),i=n.node.querySelector(".e-text-content"),n.nodeData&&n.nodeData.type===nt&&i&&n.node.querySelector(".e-list-icon.e-calc-member")&&(n.node.setAttribute("data-type",t.type),n.node.setAttribute("data-membertype",t.fieldType),n.node.setAttribute("data-hierarchy",t.parentHierarchy?t.parentHierarchy:""),n.node.setAttribute("data-formula",t.formula),(u=t.formatString?["Standard","Currency","Percent"].indexOf(t.formatString)>-1?t.formatString:"Custom":"",n.node.setAttribute("data-formatString",u),n.node.setAttribute("data-customString","Custom"===u?t.formatString:""),this.parent.isAdaptive)&&(c=Object(r.createElement)("span",{className:"e-list-edit-icon"+(this.isEdit&&this.currentFieldName===t.id?" e-edited ":" e-edit ")+h}),f=Object(r.createElement)("div",{className:"e-list-header-icon"}),f.appendChild(c),i.appendChild(f))),this.parent.isAdaptive&&(o=n.node.querySelector(".e-text-content"),n.node&&n.node.querySelector(".e-list-icon")&&o&&(l=n.node.querySelector(".e-list-icon"),o.insertBefore(l,n.node.querySelector(".e-list-text"))),n.node&&n.node.querySelector(".e-calcMemberGroupCDB,.e-measureGroupCDB-icon,.e-folderCDB-icon")&&(n.node.querySelector(".e-checkbox-wrapper").style.display="none"),n.node&&n.node.querySelector(".e-level-members")&&(n.node.querySelector(".e-list-icon").style.display="none"))):(t=n.nodeData.field,n.node.setAttribute("data-field",t),n.node.setAttribute("data-caption",n.nodeData.caption),n.node.setAttribute("data-type",n.nodeData.type),s=e.getFieldByName(t,this.parent.dataSourceSettings.formatSettings),n.node.setAttribute("data-formatString",s?s.format:""),a=Object(r.createElement)("span",{attrs:{tabindex:"-1","aria-disabled":"false",title:this.parent.localeObj.getConstant("dragField")},className:h+" e-drag"}),Object(r.prepend)([a],n.node.querySelector(".e-text-content")),Object(r.append)([n.node.querySelector("."+lt)],n.node.querySelector(".e-text-content")),this.getMenuItems(this.parent.engineModule.fieldList[t].type).length<=0?Object(r.removeClass)([n.node.querySelector("."+lt)],h):n.node.querySelector("."+lt).setAttribute("title",this.parent.localeObj.getConstant("format")),this.parent.engineModule.fieldList[t].aggregateType===nt&&(n.node.querySelector("."+lt).setAttribute("title",this.parent.localeObj.getConstant("edit")),Object(r.addClass)([n.node.querySelector("."+lt)],"e-edit"),Object(r.removeClass)([n.node.querySelector("."+lt)],lt)))},n.prototype.createTypeContainer=function(n){for(var f,u=Object(r.createElement)("div",{id:this.parentID+"control_wrapper",className:"e-pivot-treeview-outer"}),i=this.getMenuItems(this.parent.engineModule.fieldList[n].type),t=0;t<i.length;t++)f=Object(r.createElement)("input",{id:this.parentID+"radio"+n+i[t],attrs:{type:"radio","data-ftxt":n,"data-value":i[t]},className:"e-pivot-calc-radio"}),u.appendChild(f);return u},n.prototype.getMenuItems=function(n,t){for(var u=Object(r.isNullOrUndefined)(t)?this.parent.aggregateTypes:t,f=[],e=this.getValidSummaryType(),i=0;i<u.length;i++)e.indexOf(u[i])>-1&&f.indexOf(u[i])<0&&(("Count"!==u[i]&&"DistinctCount"!==u[i]||"number"===n)&&"number"!==n||f.push(u[i]));return f},n.prototype.getValidSummaryType=function(){return["Count","DistinctCount","Sum","Avg","Min","Max","Product","SampleStDev","PopulationStDev","SampleVar",er]},n.prototype.getAccordionData=function(n){for(var t,r=[],u=Object.keys(n.engineModule.fieldList),i=0,f=u.length;i<f;i++)t=u[i],r.push({header:"<input id="+this.parentID+"_"+i+' class=e-pivot-calc-check type="checkbox" data-field='+t+" data-caption="+this.parent.engineModule.fieldList[t].caption+" data-type="+this.parent.engineModule.fieldList[t].type+"/>",content:this.parent.engineModule.fieldList[t].aggregateType===nt||this.getMenuItems(this.parent.engineModule.fieldList[t].type).length<1?"":this.createTypeContainer(t).outerHTML,iconCss:this.parent.engineModule.fieldList[t].aggregateType===nt?"e-list-icon "+(this.isEdit&&this.currentFieldName===t?"e-edited":"e-edit"):""});return r},n.prototype.renderMobileLayout=function(n){var t=this,i,u,e,f,o;n.items[4].content=this.renderDialogElements().outerHTML;n.dataBind();"olap"===this.parent.dataType&&this.parent.isAdaptive&&null!==this.parent.dialogRenderer.parentElement.querySelector("."+kt)&&this.createOlapDropElements();i=new g.Button({cssClass:ii,isPrimary:!0});(i.isStringTemplate=!0,i.appendTo("#"+this.parentID+"cancelBtn"),i.element&&(i.element.onclick=this.cancelBtnClick.bind(this)),null!==this.parent.dialogRenderer.parentElement.querySelector("."+kt)&&this.parent.isAdaptive)?(u=new g.Button({cssClass:ii+" e-outline",isPrimary:!0}),(u.isStringTemplate=!0,u.appendTo("#"+this.parentID+"okBtn"),this.inputObj=new b.MaskedTextBox({placeholder:this.parent.localeObj.getConstant("fieldName"),change:function(n){t.fieldText=n.value;t.formulaText=document.querySelector("#"+t.parentID+"droppable").value}}),this.inputObj.isStringTemplate=!0,this.inputObj.appendTo("#"+this.parentID+"ddlelement"),"pivot"===this.parent.dataType)&&(e=new b.MaskedTextBox({placeholder:this.parent.localeObj.getConstant("numberFormatString"),change:function(n){t.formatText=n.value;t.formulaText=document.querySelector("#"+t.parentID+"droppable").value}}),e.isStringTemplate=!0,e.appendTo("#"+this.parentID+"Custom_Format_Element"),null!==this.formatText&&null!==this.parent.dialogRenderer.parentElement.querySelector(".e-custom-format-input")&&(this.parent.dialogRenderer.parentElement.querySelector(".e-custom-format-input").value=this.formatText,e.value=this.formatText)),null!==this.formulaText&&null!==this.parent.dialogRenderer.parentElement.querySelector("#"+this.parentID+"droppable")&&(this.parent.dialogRenderer.parentElement.querySelector("#"+this.parentID+"droppable").value=this.formulaText),null!==this.fieldText&&null!==this.parent.dialogRenderer.parentElement.querySelector("."+ti)&&(this.parent.dialogRenderer.parentElement.querySelector("."+ti).value=this.fieldText,this.inputObj.value=this.fieldText),u.element&&(u.element.onclick=this.applyFormula.bind(this))):this.parent.isAdaptive&&(f=new g.Button({cssClass:ii,isPrimary:!0}),(f.isStringTemplate=!0,f.appendTo("#"+this.parentID+"addBtn"),"olap"===this.parent.dataType)?(this.treeObj=new rt.TreeView({fields:{dataSource:this.getFieldListData(this.parent),id:"id",text:"caption",parentID:"pid",iconCss:"spriteCssClass"},showCheckBox:!0,autoCheck:!1,sortOrder:"None",enableRtl:this.parent.enableRtl,nodeClicked:this.fieldClickHandler.bind(this),drawNode:this.drawTreeNode.bind(this),nodeExpanding:this.updateNodeIcon.bind(this),nodeCollapsed:this.updateNodeIcon.bind(this),nodeSelected:function(n){Object(r.removeClass)([n.node],"e-active");n.cancel=!0}}),this.treeObj.isStringTemplate=!0,this.treeObj.appendTo("#"+this.parentID+"accordDiv")):(o=new rt.Accordion({items:this.getAccordionData(this.parent),enableRtl:this.parent.enableRtl,expanding:this.accordionExpand.bind(this),clicked:this.accordionClickHandler.bind(this)}),o.isStringTemplate=!0,o.appendTo("#"+this.parentID+"accordDiv"),this.updateType()),f.element&&(f.element.onclick=this.addBtnClick.bind(this)))},n.prototype.accordionExpand=function(n){var t;if(0===n.element.querySelectorAll(".e-radio-wrapper").length)for(var f=Object.keys(this.parent.engineModule.fieldList),u=0,o=f.length;u<o;u++){var i=f[u],r="number"!==this.parent.engineModule.fieldList[i].type?["Count","DistinctCount"]:["Sum","Count","Avg","Min","Max","DistinctCount","Product","SampleStDev","PopulationStDev","SampleVar",er],e=void 0;if(i===n.element.querySelector("[data-field").getAttribute("data-field"))for(t=0;t<r.length;t++)(e=new g.RadioButton({label:this.parent.localeObj.getConstant(r[t]),name:"AggregateType"+i,checked:n.element.querySelector("[data-type").getAttribute("data-type")===r[t],change:this.onChange.bind(this)})).isStringTemplate=!0,e.appendTo("#"+this.parentID+"radio"+i+r[t])}},n.prototype.onChange=function(n){var t=n.event.target.parentElement.querySelector(".e-label").innerText,i=n.event.target.closest(".e-acrdn-item").querySelector("[data-field").getAttribute("data-caption");n.event.target.closest(".e-acrdn-item").querySelector(".e-label").innerText=i+" ("+t+")";n.event.target.closest(".e-acrdn-item").querySelector("[data-type").setAttribute("data-type",n.event.target.getAttribute("data-value"))},n.prototype.updateType=function(){for(var n,i,r,u=Object.keys(this.parent.engineModule.fieldList),t=0,f=u.length;t<f;t++)n=u[t],i=null,i="number"===this.parent.engineModule.fieldList[n].type&&"include"!==this.parent.engineModule.fieldList[n].type&&"exclude"!==this.parent.engineModule.fieldList[n].type||"DistinctCount"===this.parent.engineModule.fieldList[n].aggregateType?void 0!==this.parent.engineModule.fieldList[n].aggregateType?this.parent.engineModule.fieldList[n].aggregateType:"Sum":"Count",r=new g.CheckBox({label:this.parent.engineModule.fieldList[n].caption+" ("+this.parent.localeObj.getConstant(i)+")"}),r.isStringTemplate=!0,r.appendTo("#"+this.parentID+"_"+t),document.querySelector("#"+this.parentID+"_"+t).setAttribute("data-field",n),document.querySelector("#"+this.parentID+"_"+t).setAttribute("data-type",i)},n.prototype.cancelBtnClick=function(){this.renderMobileLayout(this.parent.dialogRenderer.adaptiveElement)},n.prototype.addBtnClick=function(){var n="",f=null,s=null,u,t,i,r;if("pivot"===this.parent.dataType){for(u=document.querySelectorAll(".e-accordion .e-check"),t=0;t<u.length;t++)if(f=u[t].parentElement.querySelector("[data-field]").getAttribute("data-field"),-1===(s=u[t].parentElement.querySelector("[data-field]").getAttribute("data-type")).indexOf(nt))n=n+'"'+s+"("+f+')"';else for(i=0;i<this.parent.dataSourceSettings.calculatedFieldSettings.length;i++)if(this.parent.dataSourceSettings.calculatedFieldSettings[i].name===f){n+=this.parent.dataSourceSettings.calculatedFieldSettings[i].formula;break}}else for(var c=this.treeObj.getAllCheckedNodes(),e=this.parent.olapEngineModule,o=0,h=c;o<h.length;o++)r=h[o],n+=e.fieldList[r]&&e.fieldList[r].type===nt?e.fieldList[r].tag:r;this.formulaText=null!==this.formulaText?this.formulaText+n:n;this.renderMobileLayout(this.parent.dialogRenderer.adaptiveElement)},n.prototype.createCalculatedFieldDialog=function(n){var t,i;this.parent.isAdaptive&&"pivotfieldlist"===this.parent.getModuleName()?(this.renderAdaptiveLayout(!n||void 0===n.edit||n.edit),this.isEdit=n&&void 0!==n.edit?n.edit:this.isEdit):this.parent.isAdaptive||((this.isEdit=!(!n||void 0===n.edit)&&n.edit,this.renderDialogLayout(),n&&n.edit)&&(t=this.treeObj.element.querySelector('li[data-field="'+n.fieldName+'"]'),t&&((Object(r.addClass)([t],["e-active","e-node-focus"]),t.setAttribute("aria-selected","true"),t.id=this.treeObj.element.id+"_active","pivot"===this.parent.dataType)?(i={event:{target:t.querySelector(".e-list-icon.e-edit.e-icons")}},this.fieldClickHandler(i)):this.displayMenu(t))),this.dialog.element.style.top=parseInt(this.dialog.element.style.top,10)<0?"0px":this.dialog.element.style.top)},n.prototype.renderDialogLayout=function(){if(this.newFields=Object(r.extend)([],this.parent.dataSourceSettings.calculatedFieldSettings,null,!0),this.createDialog(),this.dialog.content=this.renderDialogElements(),this.dialog.refresh(),this.inputObj=new b.MaskedTextBox({placeholder:this.parent.localeObj.getConstant("fieldName")}),this.inputObj.isStringTemplate=!0,this.inputObj.appendTo("#"+this.parentID+"ddlelement"),"pivot"===this.parent.dataType){var n=new b.MaskedTextBox({placeholder:this.parent.localeObj.getConstant("numberFormatString")});n.isStringTemplate=!0;n.appendTo("#"+this.parentID+"Custom_Format_Element")}"olap"!==this.parent.dataType||this.parent.isAdaptive||this.createOlapDropElements();this.createTreeView();this.droppable=new r.Droppable(this.dialog.element.querySelector("#"+this.parentID+"droppable"));this.keyboardEvents=new r.KeyboardEvents(this.parent.calculatedFieldModule.dialog.element,{keyAction:this.keyActionHandler.bind(this),keyConfigs:{moveRight:"rightarrow",enter:"enter"},eventName:"keydown"})},n.prototype.createConfirmDialog=function(n,t,i){var u=Object(r.createElement)("div",{id:this.parentID+"_ErrorDialog",className:"e-pivot-error-dialog"});this.parent.element.appendChild(u);this.confirmPopUp=new p.Dialog({animationSettings:{effect:"Fade"},allowDragging:!1,showCloseIcon:!0,enableRtl:this.parent.enableRtl,width:"auto",height:"auto",position:{X:"center",Y:"center"},buttons:[{click:this.replaceFormula.bind(this,i),buttonModel:{cssClass:"e-ok-btn e-outline",content:this.parent.localeObj.getConstant("ok"),isPrimary:!0}},{click:this.removeErrorDialog.bind(this),buttonModel:{cssClass:"e-cancel-btn",content:this.parent.localeObj.getConstant("cancel"),isPrimary:!0}}],header:n,content:t,isModal:!0,visible:!0,closeOnEscape:!0,target:document.body,close:this.removeErrorDialog.bind(this)});this.confirmPopUp.isStringTemplate=!0;this.confirmPopUp.appendTo(u)},n.prototype.replaceFormula=function(n){var t=this.parent.dataSourceSettings,i,u;if("olap"===this.parent.dataType){for(i=0;i<t.calculatedFieldSettings.length;i++)if(t.calculatedFieldSettings[i].name===n.name){Object(r.isNullOrUndefined)(n.hierarchyUniqueName)||(t.calculatedFieldSettings[i].hierarchyUniqueName=n.hierarchyUniqueName);t.calculatedFieldSettings[i].formatString=n.formatString;t.calculatedFieldSettings[i].formula=n.formula;this.parent.lastCalcFieldInfo=t.calculatedFieldSettings[i];break}}else for(u=0;u<t.values.length;u++)if(t.values[u].type===nt&&t.values[u].name===n.name)for(i=0;i<t.calculatedFieldSettings.length;i++)t.calculatedFieldSettings[i].name===n.name&&(t.calculatedFieldSettings[i].formula=n.formula,this.parent.lastCalcFieldInfo=t.calculatedFieldSettings[i],this.updateFormatSettings(t,n.name,n.formatString));this.addFormula(t,n.name);this.removeErrorDialog()},n.prototype.removeErrorDialog=function(){document.getElementById(this.parentID+"_ErrorDialog")&&Object(r.remove)(document.getElementById(this.parentID+"_ErrorDialog").parentElement)},n.prototype.addEventListener=function(){this.parent.isDestroyed||this.parent.on("init-calculatedfield",this.createCalculatedFieldDialog,this)},n.prototype.removeEventListener=function(){this.parent.isDestroyed||this.parent.off("init-calculatedfield",this.createCalculatedFieldDialog)},n.prototype.destroy=function(){this.removeEventListener()},n}();ni.Inject(ue);var fe=function(){function n(n){this.parent=n}return n.prototype.render=function(){var u,e,n,o;!this.parent.pivotButtonModule||this.parent.pivotButtonModule&&this.parent.pivotButtonModule.isDestroyed?new ur(this.parent):this.parent.pivotButtonModule;this.createPivotButtons();for(var t=[],i=0,f=this.parent.element.querySelectorAll(".e-group-rows");i<f.length;i++)u=f[i],u.classList.contains("e-group-chart-rows")||(t=t.concat([].slice.call(u.querySelectorAll(".e-pvt-btn-div"))));for(e=t.length,n=0;n<e;n++)o=Object(r.createElement)("span",{className:"e-indent-div",styles:"width:"+24*n+"px"}),Object(r.prepend)([o],t[n])},n.prototype.createPivotButtons=function(){for(var r,e,t=[this.parent.dataSourceSettings.rows,this.parent.dataSourceSettings.columns,this.parent.dataSourceSettings.values,this.parent.dataSourceSettings.filters],i=0,u=this.parent.element.querySelectorAll(".e-group-rows,.e-group-columns,.e-group-values,.e-group-filters");i<u.length;i++)r=u[i],this.parent.dataSourceSettings.values.length>0&&r.classList.contains("e-group-chart-values")||(r.innerHTML="");for(var f=["rows","columns","values","filters"],n=(f.length,0),o=t.length;n<o;n++)t[n]&&(e={field:t[n],axis:f[n].toString()},this.parent.notify("pivot-button-update",e))},n}(),ee=function(){function n(n){this.parent=n;this.parent.groupingBarModule=this;this.resColWidth=this.parent.isAdaptive?180:249;this.addEventListener();this.parent.axisFieldModule=new fe(this.parent);this.touchObj=new r.Touch(this.parent.element,{tapHold:this.tapHoldHandler.bind(this)})}return n.prototype.getModuleName=function(){return"groupingbar"},n.prototype.renderLayout=function(){var n,o,t;this.groupingTable=Object(r.createElement)("div",{className:"e-grouping-bar"});this.leftAxisPanel=Object(r.createElement)("div",{className:"e-left-axis-fields"});this.rightAxisPanel=Object(r.createElement)("div",{className:"e-right-axis-fields"});var i=Object(r.createElement)("div",{className:"e-axis-row e-axiswrapper"}),u=Object(r.createElement)("div",{className:"e-axis-column e-axiswrapper"}),f=Object(r.createElement)("div",{className:"e-axis-value e-axiswrapper"}),e=Object(r.createElement)("div",{className:"e-axis-filter e-axiswrapper"});for(this.rowPanel=Object(r.createElement)("div",{className:"e-group-rows e-rows"}),this.columnPanel=Object(r.createElement)("div",{className:"e-group-columns e-columns"}),this.valuePanel=Object(r.createElement)("div",{className:"e-group-values e-values"}),this.filterPanel=Object(r.createElement)("div",{className:"e-group-filters e-filters"}),i.appendChild(this.rowPanel),u.appendChild(this.columnPanel),f.appendChild(this.valuePanel),e.appendChild(this.filterPanel),this.rowAxisPanel=i,this.columnAxisPanel=u,this.valueAxisPanel=f,this.filterAxisPanel=e,this.leftAxisPanel.appendChild(f),this.leftAxisPanel.appendChild(i),this.rightAxisPanel.appendChild(e),this.rightAxisPanel.appendChild(u),this.groupingTable.appendChild(this.leftAxisPanel),this.groupingTable.appendChild(this.rightAxisPanel),this.groupingTable.classList.add("e-pivot-grouping-bar"),n=0,o=[this.rowPanel,this.columnPanel,this.valuePanel,this.filterPanel];n<o.length;n++)t=o[n],this.parent.groupingBarSettings.allowDragAndDrop&&new r.Droppable(t,{}),this.unWireEvent(t),this.wireEvent(t);"Table"!==this.parent.displayOption.view&&"Table"!==this.parent.groupingBarSettings.displayMode?(this.groupingChartTable=this.groupingTable.cloneNode(!0),this.groupingChartTable.classList.add("e-chart-grouping-bar"),this.groupingChartTable.classList.remove("e-pivot-grouping-bar"),this.groupingChartTable.querySelector(".e-group-rows").classList.add("e-group-chart-rows"),this.groupingChartTable.querySelector(".e-group-columns").classList.add("e-group-chart-columns"),this.parent.chartSettings.enableMultiAxis?this.groupingChartTable.querySelector(".e-group-values").classList.add("e-group-chart-multi-values"):(this.groupingChartTable.querySelector(".e-group-values").classList.add("e-group-chart-values"),this.groupingChartTable.querySelector(".e-group-values").classList.remove("e-droppable")),this.groupingChartTable.querySelector(".e-group-filters").classList.add("e-group-chart-filters")):this.groupingChartTable=void 0;"Chart"!==this.parent.displayOption.view&&"Chart"!==this.parent.groupingBarSettings.displayMode||(this.groupingTable=void 0)},n.prototype.appendToElement=function(){var i,o,t,s,n,h,a,u,f,e,l,w;if((this.parent.element.querySelector(".e-grid")||this.parent.element.querySelector("."+it))&&this.parent.showGroupingBar){if(this.parent.element.querySelector(".e-grouping-bar"))for(i=0,o=this.parent.element.querySelectorAll(".e-grouping-bar");i<o.length;i++)t=o[i],Object(r.remove)(t);if(this.groupingChartTable&&(this.parent.element.querySelector("#"+this.parent.element.id+"_chart")?(Object(r.setStyleAttribute)(this.groupingChartTable,{width:Object(r.formatUnit)(this.parent.grid?this.parent.getGridWidthAsNumber():this.parent.getWidthAsNumber())}),this.parent.element.insertBefore(this.groupingChartTable,this.parent.element.querySelector("#"+this.parent.element.id+"_chart"))):this.groupingChartTable=void 0),"Chart"!==this.parent.displayOption.view&&this.groupingTable){this.parent.isAdaptive&&(this.leftAxisPanel.style.minWidth="180px",this.valuePanel.style.minWidth="180px");this.parent.firstColWidth&&(this.leftAxisPanel.style.minWidth="auto",this.valuePanel.style.minWidth="auto");this.filterPanel.removeAttribute("style");this.columnPanel.removeAttribute("style");this.rowPanel.removeAttribute("style");this.filterPanel.removeAttribute("style");s=void 0;(s="olap"===this.parent.dataType?Object.keys(this.parent.olapEngineModule.headerContent).length:Object.keys(this.parent.engineModule.headerContent).length,Object(r.isNullOrUndefined)(s))||(n=this.parent.element.querySelector(".e-frozenheader").querySelector(".e-columnheader"),Object(r.addClass)([n],"e-row"),n.removeAttribute("style"),Object(r.addClass)([n.querySelector(".e-headercell")],"e-group-row"),n.querySelector(".e-group-row").appendChild(this.rowAxisPanel),n.querySelector(".e-group-row").querySelector(".e-headercelldiv").style.display="none",n.querySelector(".e-group-row").querySelector(".e-sortfilterdiv").style.display="none");this.parent.element.insertBefore(this.groupingTable,this.parent.element.querySelector(".e-grid"));Object(r.setStyleAttribute)(this.groupingTable,{width:Object(r.formatUnit)(this.parent.grid?this.parent.getGridWidthAsNumber():this.parent.getWidthAsNumber())});this.groupingTable.style.minWidth="400px";this.parent.axisFieldModule.render();this.setGridRowWidth();h=this.parent.element.querySelector(".e-frozenheader").querySelector("colgroup").children[0];a=Object(r.formatUnit)(this.groupingTable.offsetWidth-parseInt(h.style.width,10));Object(r.setStyleAttribute)(this.valuePanel,{width:h.style.width});Object(r.setStyleAttribute)(this.rightAxisPanel,{width:a});u=this.valuePanel.offsetHeight/2;u>this.columnPanel.offsetHeight&&(Object(r.setStyleAttribute)(this.filterPanel,{height:Object(r.formatUnit)(u)}),Object(r.setStyleAttribute)(this.columnPanel,{height:Object(r.formatUnit)(u+2)}));f=this.parent.element.querySelector(".e-headercontent").offsetHeight;Object(r.setStyleAttribute)(this.rowPanel,{height:f+"px"});this.parent.element.querySelector(".e-frozenheader").querySelector(".e-rhandler")&&(this.parent.element.querySelector(".e-frozenheader").querySelector(".e-rhandler").style.height=f+"px");for(var v=[].slice.call(this.parent.element.querySelector(".e-movableheader").querySelector("thead").querySelectorAll("tr")).filter(function(n){return n.childNodes.length>0}),y=f/v.length,c=0,p=v;c<p.length;c++)for(t=p[c],Object(r.setStyleAttribute)(t,{height:y+"px"}),e=0,l=[].slice.call(t.querySelectorAll(".e-rhandler"));e<l.length;e++)w=l[e],Object(r.setStyleAttribute)(w,{height:y+"px"})}else this.parent.axisFieldModule.render();this.parent.showToolbar&&"Both"===this.parent.displayOption.view&&("Table"===this.parent.currentView?this.parent.element.querySelector(".e-chart-grouping-bar").style.display="none":this.parent.element.querySelector(".e-pivot-grouping-bar").style.display="none")}},n.prototype.refreshUI=function(){var u,s,n,t,e,i,o,a;if((this.groupingChartTable&&Object(r.setStyleAttribute)(this.groupingChartTable,{width:Object(r.formatUnit)(this.parent.grid?this.parent.getGridWidthAsNumber():this.parent.getWidthAsNumber())}),this.groupingTable)&&(Object(r.setStyleAttribute)(this.groupingTable,{width:Object(r.formatUnit)(this.parent.grid?this.parent.getGridWidthAsNumber():this.parent.getWidthAsNumber())}),this.groupingTable.style.minWidth="400px",u=this.parent.element.querySelector(".e-frozenheader").querySelector("colgroup").children[0],s=Object(r.formatUnit)(this.groupingTable.offsetWidth-parseInt(u.style.width,10)),Object(r.setStyleAttribute)(this.valuePanel,{width:u.style.width}),Object(r.setStyleAttribute)(this.rightAxisPanel,{width:s}),this.parent.showFieldList&&this.parent.pivotFieldListModule&&this.parent.pivotFieldListModule.element&&(clearTimeout(this.timeOutObj),this.timeOutObj=setTimeout(this.alignIcon.bind(this))),!this.parent.grid.element.querySelector(".e-group-row"))){n=this.parent.element.querySelector(".e-frozenheader").querySelector(".e-columnheader");Object(r.addClass)([n],"e-row");Object(r.addClass)([n.querySelector(".e-headercell")],"e-group-row");Object(r.setStyleAttribute)(this.rowPanel,{height:this.parent.element.querySelector(".e-headercontent").offsetHeight+"px"});n.querySelector(".e-group-row").appendChild(this.rowAxisPanel);Object(r.setStyleAttribute)(n.querySelector(".e-group-row").querySelector(".e-headercelldiv"),{display:"none"});Object(r.setStyleAttribute)(n.querySelector(".e-group-row").querySelector(".e-sortfilterdiv"),{display:"none"});t=this.parent.element.querySelector(".e-headercontent").offsetHeight;Object(r.setStyleAttribute)(this.rowPanel,{height:t+"px"});this.parent.element.querySelector(".e-frozenheader").querySelector(".e-rhandler")&&(this.parent.element.querySelector(".e-frozenheader").querySelector(".e-rhandler").style.height=t+"px");for(var h=[].slice.call(this.parent.element.querySelector(".e-movableheader").querySelector("thead").querySelectorAll("tr")).filter(function(n){return n.childNodes.length>0}),c=t/h.length,f=0,l=h;f<l.length;f++)for(e=l[f],Object(r.setStyleAttribute)(e,{height:c+"px"}),i=0,o=[].slice.call(e.querySelectorAll(".e-rhandler"));i<o.length;i++)a=o[i],Object(r.setStyleAttribute)(a,{height:c+"px"})}},n.prototype.alignIcon=function(){var n,t=this.parent.pivotFieldListModule.element,i;(n="Table"===this.parent.currentView?this.parent.grid?this.parent.grid.element.offsetWidth:n:this.parent.chart?this.parent.chartModule.calculatedWidth:n)&&(i=n<400?400:n,Object(r.setStyleAttribute)(t.querySelector(".e-toggle-field-list"),{left:Object(r.formatUnit)(this.parent.enableRtl?-Math.abs(i-t.querySelector(".e-toggle-field-list").offsetWidth):i-t.querySelector(".e-toggle-field-list").offsetWidth)}))},n.prototype.setGridRowWidth=function(){var a=this.parent.element.querySelector(".e-frozenheader").querySelector("colgroup").children[0],u,t,l;if(this.rowPanel.querySelector(".e-pivot-button"))if(this.parent.isAdaptive)this.parent.firstColWidth||((n=this.parent.grid.columns)&&n.length>0&&(n[0].width=this.resColWidth),this.parent.posCount=0,this.parent.grid.headerModule.refreshUI());else{var n,f=[].slice.call(this.rowPanel.querySelectorAll(".e-pvt-btn-div")),e=f[f.length-1],o=e.querySelector(".e-pivot-button").offsetWidth+e.querySelector(".e-indent-div").offsetWidth+20,i=Object(r.formatUnit)(o<this.resColWidth?this.resColWidth:o),s=this.parent.element.querySelector(".e-frozenheader").querySelector("table"),h=this.parent.element.querySelector(".e-frozencontent").querySelector("table"),v=this.parent.element.querySelector(".e-frozencontent").querySelector("colgroup").children[0],c=parseInt(i,10);for((n=this.parent.grid.columns)&&n.length>0&&(n[0].width=(n[0].width,this.resColWidth,c>this.resColWidth?c:this.resColWidth)),u=void 0,u="olap"===this.parent.dataType?this.parent.renderModule.calculateColWidth(this.parent.olapEngineModule.pivotValues.length>0?this.parent.olapEngineModule.pivotValues[0].length:2):this.parent.renderModule.calculateColWidth(this.parent.dataSourceSettings.values.length>0&&this.parent.engineModule.pivotValues.length>0?this.parent.engineModule.pivotValues[0].length:2),t=0;t<n.length;t++)0!==t&&(n[t].columns?this.setColWidth(n[t].columns,u):(n[t].width=u,"auto"!==n[t].width)?(l=n[t].customAttributes?n[t].customAttributes.cell.valueSort.levelName:"",n[t].width=this.parent.renderModule.setSavedWidth(l,u)):n[t].minWidth=u);this.parent.posCount=0;this.parent.setGridColumns(this.parent.grid.columns);this.parent.grid.headerModule.refreshUI();this.parent.firstColWidth||(a.style.width=i,v.style.width=i,s.style.width=i,h.style.width=i,Object(r.setStyleAttribute)(s,{width:i}),Object(r.setStyleAttribute)(h,{width:i}))}else this.parent.grid.columns&&this.parent.grid.columns.length>0&&(this.parent.grid.columns[0].width=this.parent.grid.columns[0].width>this.resColWidth?this.parent.grid.columns[0].width:this.resColWidth),this.parent.grid.headerModule.refreshUI();this.groupingTable&&this.refreshUI()},n.prototype.setColWidth=function(n,t){for(var i=0;i<n.length;i++)n[i].columns?this.setColWidth(n[i].columns,t):n[i].width=t},n.prototype.wireEvent=function(n){r.EventHandler.add(n,"mouseover",this.dropIndicatorUpdate,this);r.EventHandler.add(n,"mouseleave",this.dropIndicatorUpdate,this)},n.prototype.unWireEvent=function(n){r.EventHandler.remove(n,"mouseover",this.dropIndicatorUpdate);r.EventHandler.remove(n,"mouseleave",this.dropIndicatorUpdate)},n.prototype.dropIndicatorUpdate=function(n){(this.parent.isDragging&&n.target.classList.contains("e-droppable")&&"mouseover"===n.type||"mouseleave"===n.type)&&(Object(r.removeClass)([].slice.call(this.parent.element.querySelectorAll(".e-drop-indicator")),"e-drop-hover"),Object(r.removeClass)([].slice.call(this.parent.element.querySelectorAll(".e-drop-indicator-last")),"e-drop-hover"))},n.prototype.tapHoldHandler=function(n){var t=Object(r.closest)(n.originalEvent.target,".e-pivot-button"),i;if(!Object(r.isNullOrUndefined)(t)&&this.parent.isAdaptive)return i=t.getBoundingClientRect(),this.parent.contextMenuModule.fieldElement=t,void this.parent.contextMenuModule.menuObj.open(i.top,i.left)},n.prototype.addEventListener=function(){this.handlers={load:this.renderLayout,end:this.appendToElement};this.parent.isDestroyed||(this.parent.on("init-groupingbar",this.handlers.load,this),this.parent.on(ft,this.handlers.end,this))},n.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(ft,this.handlers.end),this.parent.off("init-groupingbar",this.handlers.load))},n.prototype.destroy=function(){this.removeEventListener();this.parent.pivotButtonModule&&(this.parent.pivotButtonModule.destroy(),this.touchObj&&!this.touchObj.isDestroyed&&this.touchObj.destroy())},n}(),oe=function(){function n(n){this.parent=n;this.parent.conditionalFormattingModule=this;this.parentID=this.parent.element.id;this.dialog=null;this.fieldsDropDown=[];this.conditionsDropDown=[];this.fontNameDropDown=[];this.fontSizeDropDown=[];this.fontColor=[];this.backgroundColor=[];this.newFormat=[]}return n.prototype.getModuleName=function(){return"conditionalformatting"},n.prototype.createDialog=function(){null!==document.querySelector("#"+this.parentID+"conditionalformatting")&&Object(r.remove)(document.querySelector("#"+this.parentID+"conditionalformatting"));this.parent.element.appendChild(Object(r.createElement)("div",{id:this.parentID+"conditionalformatting"}));var n=[{click:this.addButtonClick.bind(this),buttonModel:{cssClass:this.parent.isAdaptive?"e-small e-round e-format-condition-button":"e-format-condition-button",iconCss:h+" e-add-icon",content:this.parent.isAdaptive?"":this.parent.localeObj.getConstant("condition")}},{click:this.applyButtonClick.bind(this),buttonModel:{cssClass:"e-flat e-primary e-format-apply-button",content:this.parent.localeObj.getConstant("apply")}},{click:this.cancelButtonClick.bind(this),buttonModel:{cssClass:"e-flat e-primary e-format-cancel-button",content:this.parent.localeObj.getConstant("cancel")}}];this.dialog=this.parent.isAdaptive?new p.Dialog({animationSettings:{effect:"Zoom"},isModal:!0,width:"100%",height:"100%",showCloseIcon:!1,closeOnEscape:!1,enableRtl:this.parent.enableRtl,position:{X:"center",Y:"center"},allowDragging:!0,buttons:n,beforeOpen:this.beforeOpen.bind(this),cssClass:"e-pivot-formatting-dialog",header:this.parent.localeObj.getConstant("conditionalFormating"),target:document.body}):new p.Dialog({allowDragging:!0,position:{X:"center",Y:this.parent.element.offsetTop},buttons:n,beforeOpen:this.beforeOpen.bind(this),cssClass:"e-pivot-formatting-dialog",isModal:!1,closeOnEscape:!0,enableRtl:this.parent.enableRtl,showCloseIcon:!0,header:this.parent.localeObj.getConstant("conditionalFormating"),target:this.parent.element});this.dialog.isStringTemplate=!0;this.dialog.appendTo("#"+this.parentID+"conditionalformatting")},n.prototype.beforeOpen=function(){this.dialog.element.querySelector(".e-dlg-header").setAttribute("title",this.parent.localeObj.getConstant("conditionalFormating"))},n.prototype.addButtonClick=function(){var n=this;this.parent.trigger("conditionalFormatting",{conditions:"LessThan",value1:0,applyGrandTotals:!0,style:{backgroundColor:"white",color:"black",fontFamily:"Arial",fontSize:"12px"}},function(t){n.refreshConditionValues();n.newFormat.push(t);n.addFormat()})},n.prototype.applyButtonClick=function(){this.refreshConditionValues()&&(this.parent.setProperties({dataSourceSettings:{conditionalFormatSettings:this.newFormat}},!0),this.parent.renderPivotGrid(),this.destroy())},n.prototype.cancelButtonClick=function(){this.destroy();this.newFormat=[]},n.prototype.refreshConditionValues=function(){for(var n=0;n<this.newFormat.length;n++){if(""===document.querySelector("#"+this.parentID+"conditionvalue1"+n).value||""===document.querySelector("#"+this.parentID+"conditionvalue2"+n).value)return""===document.querySelector("#"+this.parentID+"conditionvalue1"+n).value?document.querySelector("#"+this.parentID+"conditionvalue1"+n).focus():document.querySelector("#"+this.parentID+"conditionvalue2"+n).focus(),!1;this.newFormat[n].value1=Number(document.querySelector("#"+this.parentID+"conditionvalue1"+n).value);this.newFormat[n].value2=Number(document.querySelector("#"+this.parentID+"conditionvalue2"+n).value)}return!0},n.prototype.addFormat=function(){for(var i,u,t=Object(r.createElement)("div",{id:this.parentID+"formatDiv",className:"e-new-format"}),n=0;n<this.newFormat.length;n++)t.appendChild(this.createDialogElements(n));for(0===this.newFormat.length&&(i=this.createDialogElements(),u=Object(r.createElement)("p",{id:this.parentID+"emptyFormat",className:"e-pivot-conditional-empty-format",innerHTML:this.parent.localeObj.getConstant("emptyFormat")}),i.appendChild(u),t.appendChild(i)),this.dialog.setProperties({content:t},!1),n=0;n<this.newFormat.length;n++)this.renderDropDowns(n),this.renderColorPicker(n)},n.prototype.createDialogElements=function(n){var o=Object(r.createElement)("div",{id:this.parentID+"outerDiv"+n,className:"e-format-outer-div"}),f,v,h,y,c,p,e,w,b,k,d,l,g,a,nt,tt,it,rt;if(void 0!==n){f=this.newFormat[n];v=Object(r.createElement)("button",{id:this.parentID+"removeButton"+n,className:"e-format-delete-button",attrs:{title:this.parent.localeObj.getConstant("delete")}});o.appendChild(v);var s=Object(r.createElement)("div",{id:this.parentID+"innerDiv",className:"e-format-inner-div"}),u=Object(r.createElement)("table",{id:this.parentID+"cftable",className:"e-format-table"}),i=Object(r.createElement)("tr"),t=Object(r.createElement)("td"),ut=Object(r.createElement)("span",{id:this.parentID+"valuelabel"+n,className:"e-format-value-label",innerHTML:this.parent.localeObj.getConstant("value")});t.appendChild(ut);i.appendChild(t);u.appendChild(i);i=Object(r.createElement)("tr");t=Object(r.createElement)("td");h=Object(r.createElement)("div",{id:this.parentID+"measure"+n});y=Object(r.createElement)("input",{id:this.parentID+"measureinput"+n,attrs:{type:"text",tabindex:"1"}});h.appendChild(y);t.appendChild(h);i.appendChild(t);t=Object(r.createElement)("td");c=Object(r.createElement)("div",{id:this.parentID+"condition"});p=Object(r.createElement)("input",{id:this.parentID+"conditioninput"+n,attrs:{type:"text",tabindex:"1"}});c.appendChild(p);t.appendChild(c);i.appendChild(t);t=Object(r.createElement)("td");e="Between"!==f.conditions&&"NotBetween"!==f.conditions?"display:none; width:10px":"";w=Object(r.createElement)("input",{id:this.parentID+"conditionvalue1"+n,attrs:{type:"text",tabindex:"1",value:Object(r.isNullOrUndefined)(f.value1)?"0":f.value1.toString(),placeholder:this.parent.localeObj.getConstant("emptyInput")},styles:this.parent.isAdaptive?""===e?"width: 35%":"width: 100%":""===e?"width: 45px":"width: 120px",className:si+" e-format-value1"});t.appendChild(w);b=Object(r.createElement)("span",{id:this.parentID+"valuespan"+n,className:"e-format-value-span",innerHTML:"&",styles:e});t.appendChild(b);k=Object(r.createElement)("input",{id:this.parentID+"conditionvalue2"+n,attrs:{type:"text",tabindex:"1",value:Object(r.isNullOrUndefined)(f.value2)?"0":f.value2.toString(),placeholder:this.parent.localeObj.getConstant("emptyInput")},styles:this.parent.isAdaptive&&""===e?"width: 35%":""===e?"width: 45px":e,className:si+" e-format-value2"});t.appendChild(k);i.appendChild(t);u.appendChild(i);this.parent.isAdaptive&&(s.appendChild(u),u=Object(r.createElement)("table",{id:this.parentID+"cftable",className:"e-format-table"}));i=Object(r.createElement)("tr");t=Object(r.createElement)("td");d=Object(r.createElement)("span",{id:this.parentID+"formatlabel"+n,className:"e-format-label",innerHTML:this.parent.localeObj.getConstant("formatLabel")});t.appendChild(d);i.appendChild(t);u.appendChild(i);i=Object(r.createElement)("tr");t=Object(r.createElement)("td");l=Object(r.createElement)("div",{id:this.parentID+"fontname"});g=Object(r.createElement)("input",{id:this.parentID+"fontnameinput"+n,attrs:{type:"text",tabindex:"1"}});l.appendChild(g);t.appendChild(l);i.appendChild(t);t=Object(r.createElement)("td");a=Object(r.createElement)("div",{id:this.parentID+"fontsize"});nt=Object(r.createElement)("input",{id:this.parentID+"fontsizeinput"+n,attrs:{type:"text",tabindex:"1"}});a.appendChild(nt);t.appendChild(a);i.appendChild(t);this.parent.isAdaptive&&(u.appendChild(i),i=Object(r.createElement)("tr"),u.appendChild(i),i=Object(r.createElement)("tr"));t=Object(r.createElement)("td");tt=Object(r.createElement)("input",{id:this.parentID+"fontcolor"+n,attrs:{type:"color",tabindex:"1"},className:"e-format-font-color"});t.appendChild(tt);it=Object(r.createElement)("input",{id:this.parentID+"backgroundcolor"+n,attrs:{type:"color",tabindex:"1"},className:"e-format-back-color"});t.appendChild(it);i.appendChild(t);t=Object(r.createElement)("td");rt=Object(r.createElement)("div",{id:this.parentID+"valuepreview"+n,className:si+" e-format-value-preview",innerHTML:"123.45"});t.appendChild(rt);i.appendChild(t);u.appendChild(i);s.appendChild(u);o.appendChild(s)}return o},n.prototype.renderDropDowns=function(n){var t=this.newFormat[n],f=[],u,i,e;for(f.push({index:0,name:this.parent.localeObj.getConstant("AllValues"),field:this.parent.localeObj.getConstant("AllValues")}),u=0;u<this.parent.dataSourceSettings.values.length;u++)f.push({index:u+1,name:this.parent.dataSourceSettings.values[u].caption||this.parent.dataSourceSettings.values[u].name,field:this.parent.dataSourceSettings.values[u].name});i=Object(r.isNullOrUndefined)(t.measure)?this.parent.localeObj.getConstant("AllValues"):t.measure;this.fieldsDropDown[n]=new a.DropDownList({dataSource:f,fields:{text:"name",value:"field"},value:i,width:this.parent.isAdaptive?"100%":"120px",popupHeight:"200px",popupWidth:"auto",change:this.measureChange.bind(this,n)});this.fieldsDropDown[n].isStringTemplate=!0;this.fieldsDropDown[n].appendTo("#"+this.parentID+"measureinput"+n);e=[{value:"LessThan",name:this.parent.localeObj.getConstant("LessThan")},{value:"LessThanOrEqualTo",name:this.parent.localeObj.getConstant("LessThanOrEqualTo")},{value:"GreaterThan",name:this.parent.localeObj.getConstant("GreaterThan")},{value:"GreaterThanOrEqualTo",name:this.parent.localeObj.getConstant("GreaterThanOrEqualTo")},{value:"Equals",name:this.parent.localeObj.getConstant("Equals")},{value:"NotEquals",name:this.parent.localeObj.getConstant("NotEquals")},{value:"Between",name:this.parent.localeObj.getConstant("Between")},{value:"NotBetween",name:this.parent.localeObj.getConstant("NotBetween")}];i=Object(r.isNullOrUndefined)(t.conditions)?"LessThan":t.conditions;this.conditionsDropDown[n]=new a.DropDownList({dataSource:e,fields:{value:"value",text:"name"},value:i,width:this.parent.isAdaptive?"100%":"120px",popupHeight:"200px",popupWidth:"auto",change:this.conditionChange.bind(this,n)});this.conditionsDropDown[n].isStringTemplate=!0;this.conditionsDropDown[n].appendTo("#"+this.parentID+"conditioninput"+n);i=Object(r.isNullOrUndefined)(t.style.fontFamily)?"Arial":t.style.fontFamily;this.fontNameDropDown[n]=new a.DropDownList({dataSource:[{index:0,name:"Arial"},{index:1,name:"San Serif"},{index:2,name:"Impact"},{index:3,name:"Trebuchet MS"},{index:4,name:"Serif"},{index:5,name:"Verdana"},{index:6,name:"Courier New"},{index:7,name:"Times New Roman"},{index:8,name:"Tahoma"},{index:9,name:"Gerogia"}],fields:{text:"name"},value:i,width:this.parent.isAdaptive?"100%":"120px",popupWidth:"150px",popupHeight:"200px",change:this.fontNameChange.bind(this,n)});this.fontNameDropDown[n].isStringTemplate=!0;this.fontNameDropDown[n].appendTo("#"+this.parentID+"fontnameinput"+n);i=Object(r.isNullOrUndefined)(t.style.fontSize)?"12px":t.style.fontSize;this.fontSizeDropDown[n]=new a.DropDownList({dataSource:[{index:0,name:"9px"},{index:1,name:"10px"},{index:2,name:"11px"},{index:3,name:"12px"},{index:4,name:"13px"},{index:5,name:"14px"},{index:6,name:"15px"},{index:6,name:"16px"}],fields:{text:"name"},popupHeight:"200px",value:i,width:this.parent.isAdaptive?"100%":"120px",change:this.fontSizeChange.bind(this,n)});this.fontSizeDropDown[n].isStringTemplate=!0;this.fontSizeDropDown[n].appendTo("#"+this.parentID+"fontsizeinput"+n)},n.prototype.conditionChange=function(n,t){this.newFormat[n].conditions=t.value;"Between"===t.value||"NotBetween"===t.value?(document.querySelector("#"+this.parentID+"valuespan"+n).style.display="inline-block",document.querySelector("#"+this.parentID+"valuespan"+n).style.width=this.parent.isAdaptive?"10%":"10px",document.querySelector("#"+this.parentID+"conditionvalue2"+n).style.display="inline-block",document.querySelector("#"+this.parentID+"conditionvalue2"+n).style.width=this.parent.isAdaptive?"35%":"45px",document.querySelector("#"+this.parentID+"conditionvalue1"+n).style.width=this.parent.isAdaptive?"35%":"45px"):(document.querySelector("#"+this.parentID+"valuespan"+n).style.display="none",document.querySelector("#"+this.parentID+"conditionvalue2"+n).style.display="none",document.querySelector("#"+this.parentID+"conditionvalue1"+n).style.width=this.parent.isAdaptive?"100%":"120px")},n.prototype.fontNameChange=function(n,t){this.newFormat[n].style.fontFamily=t.value.toString();document.querySelector("#"+this.parentID+"valuepreview"+n).style.fontFamily=t.value},n.prototype.fontSizeChange=function(n,t){this.newFormat[n].style.fontSize=t.value.toString();document.querySelector("#"+this.parentID+"valuepreview"+n).style.fontSize=t.value},n.prototype.measureChange=function(n,t){this.newFormat[n].measure=t.value.toString()===this.parent.localeObj.getConstant("AllValues")?void 0:t.value.toString()},n.prototype.renderColorPicker=function(n){var i=this.newFormat[n],t=Object(r.isNullOrUndefined)(i.style.color)?"black":i.style.color,u=this.isHex(t.substr(1))?t:this.colourNameToHex(t),f;document.querySelector("#"+this.parentID+"valuepreview"+n).style.color=u;this.fontColor[n]=new b.ColorPicker({cssClass:"e-format-color-picker",value:u,mode:"Palette",change:this.fontColorChange.bind(this,n)});this.fontColor[n].isStringTemplate=!0;this.fontColor[n].appendTo("#"+this.parentID+"fontcolor"+n);Object(r.addClass)([this.fontColor[n].element.nextElementSibling.querySelector(".e-selected-color")],h);t=Object(r.isNullOrUndefined)(i.style.backgroundColor)?"white":i.style.backgroundColor;u=this.isHex(t.substr(1))?t:this.colourNameToHex(t);document.querySelector("#"+this.parentID+"valuepreview"+n).style.backgroundColor=u;document.querySelector("#"+this.parentID+"valuepreview"+n).style.fontFamily=i.style.fontFamily;document.querySelector("#"+this.parentID+"valuepreview"+n).style.fontSize=i.style.fontSize;this.backgroundColor[n]=new b.ColorPicker({cssClass:"e-format-color-picker",value:u,mode:"Palette",change:this.backColorChange.bind(this,n)});this.backgroundColor[n].isStringTemplate=!0;this.backgroundColor[n].appendTo("#"+this.parentID+"backgroundcolor"+n);Object(r.addClass)([this.backgroundColor[n].element.nextElementSibling.querySelector(".e-selected-color")],h);f=new g.Button({iconCss:h+" e-format-delete-icon",cssClass:ii});f.isStringTemplate=!0;f.appendTo("#"+this.parentID+"removeButton"+n);f.element.onclick=this.toggleButtonClick.bind(this,n)},n.prototype.backColorChange=function(n,t){this.newFormat[n].style.backgroundColor=t.currentValue.hex;document.querySelector("#"+this.parentID+"valuepreview"+n).style.backgroundColor=t.currentValue.hex},n.prototype.fontColorChange=function(n,t){this.newFormat[n].style.color=t.currentValue.hex;document.querySelector("#"+this.parentID+"valuepreview"+n).style.color=t.currentValue.hex},n.prototype.toggleButtonClick=function(n){this.newFormat.splice(n,1);this.addFormat()},n.prototype.isHex=function(n){for(var t=parseInt(n,16);"0"===n.charAt(0);)n=n.substr(1);return t.toString(16)===n.toLowerCase()||0===t&&""===n},n.prototype.hexToRgb=function(n){var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(n);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:null},n.prototype.colourNameToHex=function(n){var t={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4","indianred ":"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};return void 0!==t[n.toLowerCase()]?t[n.toLowerCase()]:"#d5d5d5"},n.prototype.showConditionalFormattingDialog=function(){this.newFormat=[];for(var n=0;n<this.parent.dataSourceSettings.conditionalFormatSettings.length;n++)this.newFormat.push(Object(r.extend)({},this.parent.dataSourceSettings.conditionalFormatSettings[n].properties,null,!0));this.createDialog();this.dialog.refresh();this.addFormat()},n.prototype.destroy=function(){if(this.dialog&&!this.dialog.isDestroyed){this.dialog.hide();for(var n=0;n<this.newFormat.length;n++)this.fontColor[n]&&!this.fontColor[n].isDestroyed&&this.fontColor[n].destroy(),this.backgroundColor[n]&&!this.backgroundColor[n].isDestroyed&&this.backgroundColor[n].destroy();this.dialog.destroy()}},n}();ui.Inject(ee,oe,bi);fi={};fi.PivotView=ui;or={pivotview:fi=Object(hi.copy)(window.ejs?window.ejs.pivotview:{},fi)};window.ejs=Object(hi.copy)(window.ejs||{},or);window.ejdashboard=window.ejs}]);
