/*!
*  filename: ej2.richtexteditor.all.min.js
*  version : 4.1.36.36
*  Copyright Syncfusion Inc. 2001 - 2017. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
!function(n){function t(r){if(i[r])return i[r].exports;var u=i[r]={i:r,l:!1,exports:{}};return n[r].call(u.exports,u,u.exports,t),u.l=!0,u.exports}var i={};t.m=n;t.c=i;t.d=function(n,i,r){t.o(n,i)||Object.defineProperty(n,i,{enumerable:!0,get:r})};t.r=function(n){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"});Object.defineProperty(n,"__esModule",{value:!0})};t.t=function(n,i){var r,u;if((1&i&&(n=t(n)),8&i)||4&i&&"object"==typeof n&&n&&n.__esModule)return n;if(r=Object.create(null),t.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:n}),2&i&&"string"!=typeof n)for(u in n)t.d(r,u,function(t){return n[t]}.bind(null,u));return r};t.n=function(n){var i=n&&n.__esModule?function(){return n.default}:function(){return n};return t.d(i,"a",i),i};t.o=function(n,t){return Object.prototype.hasOwnProperty.call(n,t)};t.p="";t(t.s=4)}([function(n){n.exports=ejs.base},function(n){n.exports=ejs.buttons},function(n){n.exports=ejs.popups},function(n,t){t.copy=function(n,t,i,r){var u=n||{},e=arguments.length;r&&(e-=1);for(var s=function(n){if(!o[n])return"continue";var t=o[n];Object.keys(t).forEach(function(n){var f,e=u[n],i=t[n];r&&(isObject(i)||Array.isArray(i))?isObject(i)?(f=e||{},u[n]=i({},f,i,r)):(f=e||[],u[n]=i([],f,i,r)):u[n]=i})},o=arguments,f=1;f<e;f++)s(f);return u}},function(n,t,i){"use strict";function c(n,t){for(var f,i=Object(r.extend)({},n),u=0,e=Object.keys(i);u<e.length;u++)f=e[u],t.indexOf(f)<0&&Object(r.deleteObject)(i,f);return i}function it(n,t){var f=40===t?0:n.childElementCount-1,i=f,e=n.querySelector(".e-selected"),u,o;for(e&&e.classList.remove("e-selected"),u=0,o=n.children.length;u<o;u++)n.children[u].classList.contains("e-focused")&&(i=u,n.children[u].classList.remove("e-focused"),40===t?i++:i--,i===(40===t?n.childElementCount:-1)&&(i=f));-1!==(i=function n(t,i,r,u,f){if(void 0===f&&(f=0),(i.classList.contains("e-separator")||i.classList.contains("e-disabled"))&&(r===(40===u?t.childElementCount-1:0)?r=40===u?0:t.childElementCount-1:40===u?r++:r--),(i=t.children[r]).classList.contains("e-separator")||i.classList.contains("e-disabled")){if(++f===t.childElementCount)return-1;r=n(t,i,r,u,f)}return r}(n,n.children[i],i,t))&&(Object(r.addClass)([n.children[i]],"e-focused"),n.children[i].focus())}function rt(n){var f=[].slice.call(n.getElementsByClassName("e-blank-icon")),t,i,r,e,u;f.length&&(t=n.querySelector(".e-item:not(.e-blank-icon):not(.e-separator)"),t.classList.contains("e-url")&&(t=t.querySelector(".e-menu-url")),r=t.querySelector(".e-menu-icon"),e=n.classList.contains("e-rtl"),i=e?{padding:"paddingRight",margin:"marginLeft"}:{padding:"paddingLeft",margin:"marginRight"},u=parseInt(getComputedStyle(r).fontSize,10)+parseInt(getComputedStyle(r)[i.margin],10)+parseInt(getComputedStyle(t).paddingLeft,10)+"px",f.forEach(function(n){n.classList.contains("e-url")?n.querySelector(".e-menu-url").style[i.padding]=u:n.style[i.padding]=u}))}function pt(n,t,i){var e,o,l,u,f,h,c,s;for(void 0===t&&(t={}),Object(r.isNullOrUndefined)(i)&&(i=r.createElement),f=document.querySelector(n),Object(r.addClass)([f],["e-btn-group","e-css"]),f.setAttribute("role","group"),h=f.children,t.buttons=t.buttons||[],c=0,s=0;s<h.length;c++,s++)e=h[s],null!==(u=t.buttons[c])&&("BUTTON"===e.tagName?o=e:(o=i("label"),(l=h[s+1])?f.insertBefore(o,l):f.appendChild(o),e.id&&o.setAttribute("for",e.id),u&&u.disabled&&(e.disabled=!0),s++),t.cssClass&&u&&!u.cssClass&&(u.cssClass=t.cssClass),new a.Button(u||{},o));return f}var o,ot;i.r(t);o={};i.r(o);i.d(o,"getModel",function(){return c});i.d(o,"upDownKeyHandler",function(){return it});i.d(o,"setBlankIconStyle",function(){return rt});i.d(o,"Item",function(){return l});i.d(o,"DropDownButton",function(){return k});i.d(o,"SplitButton",function(){return yt});i.d(o,"Deferred",function(){return g});i.d(o,"createButtonGroup",function(){return pt});i.d(o,"SpinSettings",function(){return ft});i.d(o,"AnimationSettings",function(){return et});i.d(o,"ProgressButton",function(){return wt});var p,w=i(3),r=i(0),st=(p=function(n,t){return(p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}p(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),h=function(n,t,i,r){var f,e=arguments.length,u=e<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r,o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(n,t,i,r);else for(o=n.length-1;o>=0;o--)(f=n[o])&&(u=(e<3?f(u):e>3?f(t,i,u):f(t,i))||u);return e>3&&u&&Object.defineProperty(t,i,u),u};var l=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return st(t,n),h([Object(r.Property)("")],t.prototype,"iconCss",void 0),h([Object(r.Property)("")],t.prototype,"id",void 0),h([Object(r.Property)(!1)],t.prototype,"separator",void 0),h([Object(r.Property)("")],t.prototype,"text",void 0),h([Object(r.Property)("")],t.prototype,"url",void 0),h([Object(r.Property)(!1)],t.prototype,"disabled",void 0),t}(r.ChildProperty),a=i(1),v=i(2),ht=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),f=function(n,t,i,r){var f,e=arguments.length,u=e<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r,o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(n,t,i,r);else for(o=n.length-1;o>=0;o--)(f=n[o])&&(u=(e<3?f(u):e>3?f(t,i,u):f(t,i))||u);return e>3&&u&&Object.defineProperty(t,i,u),u},ct="e-menu-icon",b="e-item",lt="e-dropdown-popup",at="e-separator",ut="e-vertical",k=function(n){function t(t,i){return n.call(this,t,i)||this}return ht(t,n),t.prototype.preRender=function(){},t.prototype.getPersistData=function(){return this.addOnPersist([])},t.prototype.toggle=function(){this.canOpen()?this.openPopUp():this.closePopup()},t.prototype.render=function(){this.initialize();this.disabled||this.wireEvents();this.renderComplete()},t.prototype.addItems=function(n,t){for(var r,u,f=this.items.length,i=0,e=this.items.length;i<e;i++)if(t===this.items[i].text){f=i;break}for(r=n.length-1;r>=0;r--)u=new l(this,"items",n[r],!0),this.items.splice(f,0,u);this.canOpen()||this.createItems()},t.prototype.removeItems=function(n,t){for(var i,f,u=!1,r=0,e=n.length;r<e;r++)for(i=0,f=this.items.length;i<f;i++)if(n[r]===(t?this.items[i].id:this.items[i].text)){this.items.splice(i,1);u=!0;break}u&&this.getULElement()&&this.createItems()},t.prototype.createPopup=function(){var n,t=this.createElement("div",{className:lt,id:this.element.id+"-popup"});document.body.appendChild(t);this.dropDown=new v.Popup(t,{relateTo:this.element,collision:{X:"fit",Y:"flip"},position:{X:"left",Y:"bottom"},targetType:"relative",content:this.target?this.getTargetElement():"",enableRtl:this.enableRtl});"fixed"===this.dropDown.element.style.position&&this.dropDown.refreshPosition(this.element);this.dropDown.hide();Object(r.attributes)(this.element,((n={})["aria-haspopup"]=this.items.length||this.target?"true":"false",n["aria-expanded"]="false",n["aria-owns"]=this.getPopUpElement().id,n.type="button",n["aria-label"]=this.element.textContent+" dropdownbutton",n));this.cssClass&&Object(r.addClass)([t],this.cssClass.split(" "))},t.prototype.getTargetElement=function(){return"string"==typeof this.target?Object(r.select)(this.target):this.target},t.prototype.createItems=function(n){var e,t,i,o,s=this.items,h=this.hasIcon(this.items,"iconCss"),u=this.getULElement(),f,c;for(u?u.innerHTML="":u=this.createElement("ul",{attrs:{role:"menu",tabindex:"0"}}),f=0;f<s.length;f++)t=s[f],c=this.enableHtmlSanitizer?r.SanitizeHtmlHelper.sanitize(t.text):t.text,i=this.createElement("li",{innerHTML:t.url?"":c,className:t.separator?b+" "+at:b,attrs:{role:"menuItem",tabindex:"-1"},id:t.id?t.id:Object(r.getUniqueID)("e-"+this.getModuleName()+"-item")}),t.url&&(i.appendChild(this.createAnchor(t)),i.classList.add("e-url")),t.iconCss?(e=this.createElement("span",{className:ct+" "+t.iconCss}),t.url?i.childNodes[0].appendChild(e):i.insertBefore(e,i.childNodes[0])):h&&!t.separator&&i.classList.add("e-blank-icon"),t.disabled&&i.classList.add("e-disabled"),o={item:t,element:i},this.trigger("beforeItemRender",o),u.appendChild(i);n&&this.getPopUpElement().appendChild(u);h&&rt(this.getPopUpElement())},t.prototype.hasIcon=function(n,t){for(var i=0,r=n.length;i<r;i++)if(n[i][t])return!0;return!1},t.prototype.createAnchor=function(n){var t=this.enableHtmlSanitizer?r.SanitizeHtmlHelper.sanitize(n.text):n.text;return this.createElement("a",{className:"e-menu-text e-menu-url",innerHTML:t,attrs:{href:n.url}})},t.prototype.initialize=function(){this.button=new a.Button({iconCss:this.iconCss,iconPosition:this.iconPosition,cssClass:this.cssClass,content:this.content,disabled:this.disabled,enableRtl:this.enableRtl,enablePersistence:this.enablePersistence});this.button.createElement=this.createElement;this.button.appendTo(this.element);this.element.id||(this.element.id=Object(r.getUniqueID)("e-"+this.getModuleName()));this.appendArrowSpan();this.createPopup();this.setActiveElem([this.element])},t.prototype.appendArrowSpan=function(){this.element.appendChild(this.createElement("span",{className:"e-btn-icon e-icons e-icon-"+(this.cssClass.indexOf(ut)>-1?"bottom":"right")+" e-caret"}))},t.prototype.setActiveElem=function(n){this.activeElem=n},t.prototype.getModuleName=function(){return"dropdown-btn"},t.prototype.canOpen=function(){return this.getPopUpElement().classList.contains("e-popup-close")},t.prototype.destroy=function(){var u=this,i,t;(n.prototype.destroy.call(this),"dropdown-btn"===this.getModuleName())&&(this.element.querySelector("span.e-caret")&&Object(r.detach)(this.element.querySelector("span.e-caret")),this.cssClass&&(i=this.cssClass.split(" ")),this.button.destroy(),i&&Object(r.removeClass)([this.element],i),Object(r.removeClass)(this.activeElem,["e-active"]),(this.element.getAttribute("class")?["aria-haspopup","aria-expanded","aria-owns","type"]:["aria-haspopup","aria-expanded","aria-owns","type","class"]).forEach(function(n){u.element.removeAttribute(n)}),this.dropDown.destroy(),t=document.getElementById(this.getPopUpElement().id),t&&(Object(r.removeClass)([t],["e-popup-open","e-popup-close"]),Object(r.detach)(t)),this.disabled||this.unWireEvents())},t.prototype.getPopUpElement=function(){return this.dropDown.element},t.prototype.getULElement=function(){return this.getPopUpElement().children[0]},t.prototype.wireEvents=function(){var n=this.getPopUpElement();this.delegateMousedownHandler=this.mousedownHandler.bind(this);r.EventHandler.add(document,"mousedown touchstart",this.delegateMousedownHandler,this);r.EventHandler.add(this.element,"click",this.clickHandler,this);r.EventHandler.add(n,"click",this.clickHandler,this);r.EventHandler.add(this.element,"keydown",this.keyBoardHandler,this);r.EventHandler.add(n,"keydown",this.keyBoardHandler,this);this.rippleFn=Object(r.rippleEffect)(n,{selector:"."+b})},t.prototype.keyBoardHandler=function(n){if(n.target!==this.element||9!==n.keyCode&&(n.altKey||40!==n.keyCode)&&38!==n.keyCode)switch(n.keyCode){case 38:case 40:!n.altKey||38!==n.keyCode&&40!==n.keyCode?this.upDownKeyHandler(n):this.keyEventHandler(n);break;case 9:case 13:case 27:case 32:this.keyEventHandler(n)}},t.prototype.upDownKeyHandler=function(n){this.target&&(38===n.keyCode||40===n.keyCode)||(n.preventDefault(),it(this.getULElement(),n.keyCode))},t.prototype.keyEventHandler=function(n){this.target&&(13===n.keyCode||9===n.keyCode)||(9!==n.keyCode&&n.preventDefault(),27===n.keyCode||38===n.keyCode||9===n.keyCode?this.canOpen()||this.closePopup(n,this.element):this.clickHandler(n))},t.prototype.getLI=function(n){return"LI"===n.tagName?n:Object(r.closest)(n,"li")},t.prototype.mousedownHandler=function(n){var t=n.target;this.canOpen()||Object(r.closest)(t,'[id="'+this.getPopUpElement().id+'"]')||Object(r.closest)(t,'[id="'+this.element.id+'"]')||this.closePopup(n)},t.prototype.clickHandler=function(n){var t=n.target,o=this.canOpen();if(Object(r.closest)(t,'[id="'+this.element.id+'"]'))o?this.openPopUp(n):this.closePopup(n,this.activeElem[0]);else if(Object(r.closest)(t,'[id="'+this.getPopUpElement().id+'"]')){var u=void 0,f=void 0,e=void 0,i=this.getLI(t);i&&(f=Array.prototype.indexOf.call(this.getULElement().children,i),(e=this.items[f])&&(u={element:i,item:e},this.trigger("select",u)),this.closePopup(n,this.activeElem[0]))}},t.prototype.openPopUp=function(n){var t=this,i;void 0===n&&(n=null);this.target||this.createItems(!0);i={element:this.getULElement(),items:this.items,event:n,cancel:!1};this.trigger("beforeOpen",i,function(n){var i,u;n.cancel||(i=t.getULElement(),t.dropDown.show(null,t.element),Object(r.addClass)([t.element],"e-active"),t.element.setAttribute("aria-expanded","true"),i.focus(),u={element:i,items:t.items},t.trigger("open",u))})},t.prototype.closePopup=function(n,t){var i=this,u;void 0===n&&(n=null);u={element:this.getULElement(),items:this.items,event:n,cancel:!1};this.trigger("beforeClose",u,function(n){var u,f,e;n.cancel||(u=i.getULElement(),f=u.querySelector(".e-selected"),f&&f.classList.remove("e-selected"),i.dropDown.hide(),Object(r.removeClass)(i.activeElem,"e-active"),i.element.setAttribute("aria-expanded","false"),t&&t.focus(),e={element:u,items:i.items},i.trigger("close",e),!i.target&&u&&Object(r.detach)(u))})},t.prototype.unWireEvents=function(){r.EventHandler.remove(document,"mousedown touchstart",this.delegateMousedownHandler);r.EventHandler.remove(this.element,"click",this.clickHandler);r.EventHandler.remove(this.getPopUpElement(),"click",this.clickHandler);r.EventHandler.remove(this.element,"keydown",this.keyBoardHandler);r.EventHandler.remove(this.getPopUpElement(),"keydown",this.keyBoardHandler);this.rippleFn()},t.prototype.onPropertyChanged=function(n,t){var e;this.button.setProperties(c(n,["content","cssClass","iconCss","iconPosition","disabled","enableRtl"]));this.dropDown.setProperties(c(n,["enableRtl"]));for(var u=this.getPopUpElement(),i=0,f=Object.keys(n);i<f.length;i++)switch(f[i]){case"content":this.element.querySelector("span.e-caret")||this.appendArrowSpan();break;case"disabled":n.disabled?(this.unWireEvents(),this.canOpen()||this.closePopup()):this.wireEvents();break;case"cssClass":n.cssClass.indexOf(ut)>-1&&(e=this.element.querySelector("span.e-caret"),Object(r.classList)(e,["e-icon-bottom"],["e-icon-right"]));t.cssClass&&Object(r.removeClass)([u],t.cssClass.split(" "));n.cssClass&&Object(r.addClass)([u],n.cssClass.split(" "));break;case"target":this.dropDown.content=this.getTargetElement();this.dropDown.dataBind();break;case"items":this.getULElement()&&this.createItems()}},t.prototype.focusIn=function(){this.element.focus()},f([Object(r.Property)("")],t.prototype,"content",void 0),f([Object(r.Property)("")],t.prototype,"cssClass",void 0),f([Object(r.Property)(!1)],t.prototype,"disabled",void 0),f([Object(r.Property)("")],t.prototype,"iconCss",void 0),f([Object(r.Property)("Left")],t.prototype,"iconPosition",void 0),f([Object(r.Property)(!1)],t.prototype,"enableHtmlSanitizer",void 0),f([Object(r.Collection)([],l)],t.prototype,"items",void 0),f([Object(r.Property)("")],t.prototype,"target",void 0),f([Object(r.Event)()],t.prototype,"beforeItemRender",void 0),f([Object(r.Event)()],t.prototype,"beforeOpen",void 0),f([Object(r.Event)()],t.prototype,"beforeClose",void 0),f([Object(r.Event)()],t.prototype,"close",void 0),f([Object(r.Event)()],t.prototype,"open",void 0),f([Object(r.Event)()],t.prototype,"select",void 0),f([Object(r.Event)()],t.prototype,"created",void 0),t=f([r.NotifyPropertyChanges],t)}(r.Component),vt=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),e=function(n,t,i,r){var f,e=arguments.length,u=e<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r,o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(n,t,i,r);else for(o=n.length-1;o>=0;o--)(f=n[o])&&(u=(e<3?f(u):e>3?f(t,i,u):f(t,i))||u);return e>3&&u&&Object.defineProperty(t,i,u),u},y="e-rtl",d="EJS-SPLITBUTTON",yt=function(n){function t(t,i){return n.call(this,t,i)||this}return vt(t,n),t.prototype.preRender=function(){var n=this.element;if(n.tagName===d){for(var f=Object(r.getValue)("ej2_instances",n),u=this.createElement("button",{attrs:{type:"button"}}),i=this.createElement(d,{className:"e-"+this.getModuleName()+"-wrapper"}),t=0,e=n.attributes.length;t<e;t++)u.setAttribute(n.attributes[t].nodeName,n.attributes[t].nodeValue);n.parentNode.insertBefore(i,n);Object(r.detach)(n);n=u;i.appendChild(n);Object(r.setValue)("ej2_instances",f,n);this.wrapper=i;this.element=n}this.element.id||(this.element.id=Object(r.getUniqueID)("e-"+this.getModuleName()))},t.prototype.render=function(){this.initWrapper();this.createPrimaryButton();this.renderControl()},t.prototype.renderControl=function(){this.createSecondaryButton();this.setActiveElem([this.element,this.secondaryBtnObj.element]);this.setAria();this.wireEvents();this.renderComplete()},t.prototype.addItems=function(t,i){n.prototype.addItems.call(this,t,i);this.secondaryBtnObj.items=this.items},t.prototype.removeItems=function(t,i){n.prototype.removeItems.call(this,t,i);this.secondaryBtnObj.items=this.items},t.prototype.initWrapper=function(){this.wrapper||(this.wrapper=this.createElement("div",{className:"e-"+this.getModuleName()+"-wrapper"}),this.element.parentNode.insertBefore(this.wrapper,this.element));this.element.classList.remove("e-"+this.getModuleName());this.enableRtl&&this.wrapper.classList.add(y);this.cssClass&&Object(r.addClass)([this.wrapper],this.cssClass.split(" "))},t.prototype.createPrimaryButton=function(){var n={cssClass:this.cssClass,enableRtl:this.enableRtl,iconCss:this.iconCss,iconPosition:this.iconPosition,content:this.content,disabled:this.disabled};this.primaryBtnObj=new a.Button(n);this.primaryBtnObj.createElement=this.createElement;this.primaryBtnObj.appendTo(this.element);this.element.classList.add("e-"+this.getModuleName());this.element.type="button";this.wrapper.appendChild(this.element)},t.prototype.createSecondaryButton=function(){var n,i,t=this;i=this.createElement("button",{className:"e-icon-btn",attrs:{tabindex:"-1"},id:this.element.id+"_dropdownbtn"});this.wrapper.appendChild(i);(n={cssClass:this.cssClass,disabled:this.disabled,enableRtl:this.enableRtl,items:this.items,target:this.target}).beforeItemRender=function(n){t.trigger("beforeItemRender",n)};n.open=function(n){t.trigger("open",n)};n.close=function(n){t.trigger("close",n)};n.select=function(n){t.trigger("select",n)};n.beforeOpen=function(n){var i=new g;return t.trigger("beforeOpen",n,function(n){i.resolve(n)}),i};n.beforeClose=function(n){var i=new g;return t.trigger("beforeClose",n,function(n){i.resolve(n)}),i};this.secondaryBtnObj=new k(n);this.secondaryBtnObj.createElement=this.createElement;this.secondaryBtnObj.appendTo(i);this.secondaryBtnObj.dropDown.relateTo=this.wrapper;this.dropDown=this.secondaryBtnObj.dropDown;this.secondaryBtnObj.activeElem=[this.element,this.secondaryBtnObj.element];r.EventHandler.remove(this.getPopUpElement(),"keydown",this.secondaryBtnObj.keyBoardHandler);this.secondaryBtnObj.element.querySelector(".e-btn-icon").classList.remove("e-icon-right")},t.prototype.setAria=function(){Object(r.attributes)(this.element,{"aria-expanded":"false","aria-haspopup":"true","aria-label":this.element.textContent+" splitbutton","aria-owns":this.secondaryBtnObj.dropDown.element.id})},t.prototype.getModuleName=function(){return"split-btn"},t.prototype.toggle=function(){this.secondaryBtnObj.toggle()},t.prototype.destroy=function(){var u=this,t=[y],i=document.getElementById(this.element.id);this.cssClass&&(t=t.concat(this.cssClass.split(" ")));i&&i.parentElement===this.wrapper&&(this.wrapper.tagName===d?(this.wrapper.innerHTML="",Object(r.removeClass)([this.wrapper],["e-rtl","e-"+this.getModuleName()+"-wrapper"]),Object(r.removeClass)([this.wrapper],this.cssClass.split(" "))):(Object(r.removeClass)([this.element],t),["aria-label","aria-haspopup","aria-expanded","aria-owns","type"].forEach(function(n){u.element.removeAttribute(n)}),this.wrapper.parentNode.insertBefore(this.element,this.wrapper),Object(r.remove)(this.wrapper)),this.unWireEvents());this.primaryBtnObj.destroy();this.secondaryBtnObj.destroy();n.prototype.destroy.call(this);this.element.getAttribute("class")||this.element.removeAttribute("class")},t.prototype.wireEvents=function(){r.EventHandler.add(this.element,"click",this.primaryBtnClickHandler,this);r.EventHandler.add(this.getPopUpElement(),"keydown",this.keyBoardHandler,this);new r.KeyboardEvents(this.element,{keyAction:this.btnKeyBoardHandler.bind(this),keyConfigs:{altdownarrow:"alt+downarrow"}})},t.prototype.unWireEvents=function(){r.EventHandler.remove(this.element,"click",this.primaryBtnClickHandler);Object(r.getInstance)(this.element,r.KeyboardEvents).destroy()},t.prototype.primaryBtnClickHandler=function(){this.trigger("click",{element:this.element})},t.prototype.btnKeyBoardHandler=function(n){switch(n.action){case"altdownarrow":this.clickHandler(n)}},t.prototype.onPropertyChanged=function(n,t){var u=["content","iconCss","iconPosition","cssClass","disabled","enableRtl"],i,f;for(this.primaryBtnObj.setProperties(c(n,u)),u=["beforeOpen","beforeItemRender","select","open","close","cssClass","disabled","enableRtl"],Object.keys(n).indexOf("items")>-1&&(this.secondaryBtnObj.items=n.items,this.secondaryBtnObj.dataBind()),this.secondaryBtnObj.setProperties(c(n,u)),i=0,f=Object.keys(n);i<f.length;i++)switch(f[i]){case"cssClass":t.cssClass&&Object(r.removeClass)([this.wrapper],t.cssClass.split(" "));Object(r.addClass)([this.wrapper],n.cssClass.split(" "));break;case"enableRtl":n.enableRtl?Object(r.addClass)([this.wrapper],y):Object(r.removeClass)([this.wrapper],y)}},t.prototype.focusIn=function(){this.element.focus()},e([Object(r.Property)("")],t.prototype,"content",void 0),e([Object(r.Property)("")],t.prototype,"cssClass",void 0),e([Object(r.Property)(!1)],t.prototype,"disabled",void 0),e([Object(r.Property)("")],t.prototype,"iconCss",void 0),e([Object(r.Property)("Left")],t.prototype,"iconPosition",void 0),e([Object(r.Collection)([],l)],t.prototype,"items",void 0),e([Object(r.Property)("")],t.prototype,"target",void 0),e([Object(r.Event)()],t.prototype,"beforeItemRender",void 0),e([Object(r.Event)()],t.prototype,"beforeOpen",void 0),e([Object(r.Event)()],t.prototype,"beforeClose",void 0),e([Object(r.Event)()],t.prototype,"click",void 0),e([Object(r.Event)()],t.prototype,"close",void 0),e([Object(r.Event)()],t.prototype,"open",void 0),e([Object(r.Event)()],t.prototype,"select",void 0),e([Object(r.Event)()],t.prototype,"created",void 0),t=e([r.NotifyPropertyChanges],t)}(k),g=function(){return function(){var n=this;this.promise=new Promise(function(t,i){n.resolve=t;n.reject=i});this.catch=this.promise.catch.bind(this.promise);this.then=this.promise.then.bind(this.promise)}}();var nt=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),u=function(n,t,i,r){var f,e=arguments.length,u=e<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r,o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(n,t,i,r);else for(o=n.length-1;o>=0;o--)(f=n[o])&&(u=(e<3?f(u):e>3?f(t,i,u):f(t,i))||u);return e>3&&u&&Object.defineProperty(t,i,u),u},s="e-btn-content",ft=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return nt(t,n),u([Object(r.Property)(null)],t.prototype,"template",void 0),u([Object(r.Property)(16)],t.prototype,"width",void 0),u([Object(r.Property)("Left")],t.prototype,"position",void 0),t}(r.ChildProperty),et=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return nt(t,n),u([Object(r.Property)(400)],t.prototype,"duration",void 0),u([Object(r.Property)("None")],t.prototype,"effect",void 0),u([Object(r.Property)("ease")],t.prototype,"easing",void 0),t}(r.ChildProperty),wt=function(n){function t(t,i){var r=n.call(this,t,i)||this;return r.step=1,r}return nt(t,n),t.prototype.preRender=function(){n.prototype.preRender.call(this)},t.prototype.render=function(){Object(r.isBlazor)()&&(this.isServerRendered=!1);n.prototype.render.call(this);this.init();this.wireEvents();this.setAria();this.renderComplete()},t.prototype.start=function(n){this.isPaused=!1;this.startProgress(n||this.percent,this.progressTime)},t.prototype.stop=function(){this.isPaused=!0;cancelAnimationFrame(this.timerId)},t.prototype.progressComplete=function(){this.isPaused=!1;this.finishProgress()},t.prototype.getModuleName=function(){return"progress-btn"},t.prototype.destroy=function(){var i=this,t=["e-hide-spinner","e-progress-active","e-round-corner","e-"+n.prototype.getModuleName.call(this),"e-spin-"+this.spinSettings.position.toLowerCase()];n.prototype.destroy.call(this);this.unWireEvents();this.element.innerHTML="";this.cssClass&&(t=t.concat(this.cssClass.split(" ")));Object(r.removeClass)([this.element],t);(this.element.getAttribute("class")?["aria-label","aria-valuemin","aria-valuemax","aria-valuenow"]:["aria-label","aria-valuemin","aria-valuemax","aria-valuenow","class"]).forEach(function(n){i.element.removeAttribute(n)});this.disabled&&this.element.removeAttribute("disabled")},t.prototype.init=function(){this.element.classList.add("e-"+n.prototype.getModuleName.call(this));this.setContent();this.createSpinner();this.enableProgress&&this.createProgress()},t.prototype.createSpinner=function(){var n=this.createElement("span",{className:"e-spinner"});this.setSpinPosition(n);Object(v.createSpinner)({target:n,width:this.spinSettings.width||16,template:this.spinSettings.template},this.createElement)},t.prototype.getSpinner=function(){return this.element.getElementsByClassName("e-spinner")[0]},t.prototype.getProgress=function(){return this.element.getElementsByClassName("e-progress")[0]},t.prototype.setSpinPosition=function(n){var t=this.spinSettings.position||"Left";"Left"===t||"Top"===t?this.element.insertBefore(n,this.element.getElementsByClassName(s)[0]):this.element.appendChild(n);this.element.classList.add("e-spin-"+t.toLowerCase())},t.prototype.createProgress=function(){this.element.appendChild(this.createElement("span",{className:"e-progress"}))},t.prototype.setContent=function(){var n;Object(r.isBlazor)()?(n=this.content,this.enableHtmlSanitizer&&(n=r.SanitizeHtmlHelper.sanitize(this.content)),this.setContentIcon(n)):(n=this.element.innerHTML,this.enableHtmlSanitizer&&(n=r.SanitizeHtmlHelper.sanitize(this.element.innerHTML)),this.element.innerHTML="",this.element.appendChild(this.createElement("span",{className:s,innerHTML:n})))},t.prototype.setContentIcon=function(n){var t=this.createElement("span",{className:s,innerHTML:n}),i,r;this.iconCss&&(i=this.createElement("span",{className:"e-btn-icon "+this.iconCss}),this.element.textContent.trim()?(i.classList.add("e-icon-"+this.iconPosition.toLowerCase()),"Top"!==this.iconPosition&&"Bottom"!==this.iconPosition||this.element.classList.add("e-"+this.iconPosition.toLowerCase()+"-icon-btn")):this.element.classList.add("e-icon-btn"),r=t.childNodes[0],!r||"Left"!==this.iconPosition&&"Top"!==this.iconPosition?t.appendChild(i):t.insertBefore(i,r));this.element.appendChild(t)},t.prototype.clickHandler=function(){this.element.classList.contains("e-progress-active")||this.startProgress()},t.prototype.startProgress=function(n,t){var i=this.element.classList,r=i.contains("e-vertical");i.add("e-progress-active");i.contains("e-hide-spinner")||Object(v.showSpinner)(this.element);this.startAnimate(Date.now(),t||0,t?Date.now()-this.duration/100:Date.now(),n||0,0,this.step,0,r);this.startContAnimate()},t.prototype.startAnimate=function(n,t,i,r,u,f,e,o){var a=this;try{var c,s=n-i,l=this.duration*f/100,h=s?s<l?s-l:s%l:0;this.progressTime=t=t+s-h;i=n-h;r+=(s-h)/this.duration*100;c={percent:u=(t-e)%l==0||100===r?r:u,currentDuration:t,step:f};this.eIsVertical=o;0===r?this.trigger("begin",c,function(n){a.successCallback(n,r,u,t,e,h,i)}):100===r||t===this.duration?this.trigger("end",c,function(n){a.successCallback(n,r,u,t,e,h,i)}):this.trigger("progress",c,function(n){a.successCallback(n,r,u,t,e,h,i)})}catch(n){cancelAnimationFrame(this.timerId);this.trigger("fail",n)}},t.prototype.successCallback=function(n,t,i,r,u,f,e){var o=this,s=t,c=i,v=f,h=r,l=u,y=e,a=this.eIsVertical;s!==n.percent&&n.percent!==c&&(s=n.percent);this.percent=s;this.step=n.step;(h-l)%(this.duration*n.step/100)!=0&&100!==s||(this.timerId=requestAnimationFrame(function(){o.enableProgress&&(o.getProgress().style[a?"height":"width"]=s+"%");o.element.setAttribute("aria-valuenow",s.toString())}),c=s,l=h);this.isPaused||(this.interval=h<this.duration&&s<100?window.setTimeout(function(){o.startAnimate(Date.now(),h,y,s,c,n.step,l,a)},this.duration/100-v):window.setTimeout(function(){o.progressTime=o.percent=0;o.enableProgress&&(o.getProgress().style[a?"height":"width"]="0%");o.element.setAttribute("aria-valuenow","0");o.hideSpin()},100))},t.prototype.startContAnimate=function(){var n=this,t=this.element.getElementsByClassName(s)[0];"None"!==this.animationSettings.effect?new r.Animation({}).animate(t,{duration:this.animationSettings.duration,name:"Progress"+this.animationSettings.effect,timingFunction:this.animationSettings.easing,begin:function(){"Center"===n.spinSettings.position&&n.setSpinnerSize()},end:function(){t.classList.add("e-animate-end")}}):"Center"===this.spinSettings.position&&this.setSpinnerSize()},t.prototype.finishProgress=function(){var t,i=this.element.classList,r=i.contains("e-vertical"),n;for(i.add("e-progress-active"),n=this.percent;n<100;n++)(n+=10)>100&&(n=100),this.enableProgress&&(this.getProgress().style[r?"height":"width"]=this.percent<100?n+"%":"100%");this.element.setAttribute("aria-valuenow","0");this.hideSpin();t={step:this.step,currentDuration:this.progressTime,percent:100};clearTimeout(this.interval);this.trigger("end",t);this.progressTime=this.percent=0},t.prototype.setSpinnerSize=function(){var t=this.element.getElementsByClassName(s)[0],n=this.getSpinner();n.style.width=Math.max(n.offsetWidth,t.offsetWidth)+"px";n.style.height=Math.max(n.offsetHeight,t.offsetHeight)+"px";t.classList.add("e-cont-animate")},t.prototype.hideSpin=function(){var t=this.element.getElementsByClassName(s)[0],n;(this.element.classList.contains("e-hide-spinner")||Object(v.hideSpinner)(this.element),this.element.classList.remove("e-progress-active"),"None"!==this.animationSettings.effect&&t.classList.remove("e-animate-end"),"Center"===this.spinSettings.position)&&(n=this.getSpinner(),t.classList.remove("e-cont-animate"),n.style.width="auto",n.style.height="auto")},t.prototype.setIconSpan=function(){var n=this.element.getElementsByClassName(s)[0],t=this.element.getElementsByClassName("e-btn-icon")[0];!n.childNodes[0]||"Left"!==this.iconPosition&&"Top"!==this.iconPosition?n.appendChild(t):n.insertBefore(t,n.childNodes[0])},t.prototype.setAria=function(){Object(r.attributes)(this.element,{"aria-label":this.element.textContent+" progress","aria-valuemin":"0","aria-valuemax":"100","aria-valuenow":"0"})},t.prototype.wireEvents=function(){r.EventHandler.add(this.element,"click",this.clickHandler,this)},t.prototype.unWireEvents=function(){r.EventHandler.remove(this.element,"click",this.clickHandler)},t.prototype.onPropertyChanged=function(t,i){var u=this.element,f,o,e;for(n.prototype.onPropertyChanged.call(this,t,i),f=0,o=Object.keys(t);f<o.length;f++)switch(o[f]){case"content":Object(r.isBlazor)()?(e=this.element.querySelector(".e-btn-content"),this.iconCss?"Left"===this.iconPosition||"Top"===this.iconPosition?e.childNodes[1].textContent=this.content:e.childNodes[0].textContent=this.content:e.textContent=this.content):(this.setContent(),this.createSpinner(),this.enableProgress&&this.createProgress());u.setAttribute("aria-label",u.textContent+" progress");break;case"iconCss":i.iconCss||this.setIconSpan();break;case"iconPosition":this.setIconSpan();break;case"enableProgress":t.enableProgress?this.createProgress():Object(r.remove)(this.getProgress());break;case"spinSettings":t.spinSettings.position&&(u.classList.remove("e-spin-"+i.spinSettings.position.toLowerCase()),this.setSpinPosition(this.getSpinner()));(t.spinSettings.template||t.spinSettings.width)&&(u.removeChild(this.getSpinner()),this.createSpinner())}},t.prototype.focusIn=function(){this.element.focus()},u([Object(r.Property)(!1)],t.prototype,"enableProgress",void 0),u([Object(r.Property)(2e3)],t.prototype,"duration",void 0),u([Object(r.Property)("Left")],t.prototype,"iconPosition",void 0),u([Object(r.Property)("")],t.prototype,"iconCss",void 0),u([Object(r.Property)(!1)],t.prototype,"disabled",void 0),u([Object(r.Property)(!1)],t.prototype,"isPrimary",void 0),u([Object(r.Property)("")],t.prototype,"cssClass",void 0),u([Object(r.Property)("")],t.prototype,"content",void 0),u([Object(r.Property)(!1)],t.prototype,"isToggle",void 0),u([Object(r.Property)(!1)],t.prototype,"enableHtmlSanitizer",void 0),u([Object(r.Complex)({},ft)],t.prototype,"spinSettings",void 0),u([Object(r.Complex)({},et)],t.prototype,"animationSettings",void 0),u([Object(r.Event)()],t.prototype,"created",void 0),u([Object(r.Event)()],t.prototype,"begin",void 0),u([Object(r.Event)()],t.prototype,"progress",void 0),u([Object(r.Event)()],t.prototype,"end",void 0),u([Object(r.Event)()],t.prototype,"fail",void 0),t=u([r.NotifyPropertyChanges],t)}(a.Button),tt={};Object(w.copy)(tt,o);ot={splitbuttons:tt=Object(w.copy)(window.ejs?window.ejs.splitbuttons:{},tt)};window.ejs=Object(w.copy)(window.ejs||{},ot);window.ejdashboard=window.ejs}]);!function(n){function t(r){if(i[r])return i[r].exports;var u=i[r]={i:r,l:!1,exports:{}};return n[r].call(u.exports,u,u.exports,t),u.l=!0,u.exports}var i={};t.m=n;t.c=i;t.d=function(n,i,r){t.o(n,i)||Object.defineProperty(n,i,{enumerable:!0,get:r})};t.r=function(n){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"});Object.defineProperty(n,"__esModule",{value:!0})};t.t=function(n,i){var r,u;if((1&i&&(n=t(n)),8&i)||4&i&&"object"==typeof n&&n&&n.__esModule)return n;if(r=Object.create(null),t.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:n}),2&i&&"string"!=typeof n)for(u in n)t.d(r,u,function(t){return n[t]}.bind(null,u));return r};t.n=function(n){var i=n&&n.__esModule?function(){return n.default}:function(){return n};return t.d(i,"a",i),i};t.o=function(n,t){return Object.prototype.hasOwnProperty.call(n,t)};t.p="";t(t.s=7)}([function(n){n.exports=ejs.base},function(n){n.exports=ejs.popups},function(n){n.exports=ejs.inputs},function(n){n.exports=ejs.buttons},function(n,t){t.copy=function(n,t,i,r){var u=n||{},e=arguments.length;r&&(e-=1);for(var s=function(n){if(!o[n])return"continue";var t=o[n];Object.keys(t).forEach(function(n){var f,e=u[n],i=t[n];r&&(isObject(i)||Array.isArray(i))?isObject(i)?(f=e||{},u[n]=i({},f,i,r)):(f=e||[],u[n]=i([],f,i,r)):u[n]=i})},o=arguments,f=1;f<e;f++)s(f);return u}},function(n){n.exports=ejs.splitbuttons},function(n){n.exports=ejs.navigations},function(n,t,i){"use strict";function iu(n,t,i){for(var r=0;t.length>r;r++)if(t[r].value===i.subCommand)return n.localeObj.getConstant(t[r].locale);return i.text}function po(n,t){var i=-1;return t.some(function(t,r){return"string"==typeof t&&n===t.toLocaleLowerCase()&&(i=r,!0)}),i}function tt(n,t){var i=!1;return n.classList.contains(t)&&(i=!0),i}function ct(n,t,i,u){for(var e,o,f=0;f<n.length;f++){if("value"===i&&n[f].value.toLocaleLowerCase()===t.toLocaleLowerCase()){e=n[f];break}if("text"===i&&n[f].text.toLocaleLowerCase()===t.toLocaleLowerCase()){e=n[f];break}if("subCommand"===i&&n[f].subCommand.toLocaleLowerCase()===t.toLocaleLowerCase()){e=n[f];break}}if(!Object(r.isNullOrUndefined)(e))switch(u){case"text":o=e.text;break;case"value":o=e.value;break;case"iconCss":o=e.iconCss}return o}function a(){var n=!1;return r.Browser.isDevice&&r.Browser.isIos&&(n=!0),n}function wo(n){return Object(r.isNullOrUndefined)(n)?"":n}function dv(n,t,i){return i?window.pageYOffset+t.getBoundingClientRect().top+n.clientY:n.pageY}function bo(n,t){var i=t.getService("rteLocale"),r=bb[n];return i.getConstant(r)}function dh(n,t){for(var u,e,s,l,h,f,a,b,v,k,y,p,d,i=n.dropDownModule,o=n.args,c=0,w=Object.keys(n.args);c<w.length;c++)for(u=w[c],e=0;e<n.tbItems.length;e++)if(s=n.tbItems[e].subCommand,l=s&&s.toLocaleLowerCase(),s&&l===u||"UL"===s&&"unorderedlist"===u||"OL"===s&&"orderedlist"===u||"pre"===l&&"insertcode"===u)if("boolean"==typeof o[u])!0===o[u]?Object(r.addClass)([n.tbElements[e]],[dr]):Object(r.removeClass)([n.tbElements[e]],[dr]);else if(("string"==typeof o[u]||null===o[u])&&po(u,n.parent.toolbarSettings.items)>-1){h=o[u]?o[u]:"";f="";switch(u){case"formats":if(Object(r.isNullOrUndefined)(i.formatDropDown)||t||!Object(r.isNullOrUndefined)(i.formatDropDown)&&i.formatDropDown.isDestroyed)break;a=n.parent.format.types;f=ct(a,h,"subCommand","text");b=Object(r.isNullOrUndefined)(n.parent.format.default)?a[0].text:n.parent.format.default;i.formatDropDown.content='<span style="display: inline-flex;width:'+n.parent.format.width+'" ><span class="e-rte-dropdown-btn-text">'+(Object(r.isNullOrUndefined)(f)?b:f)+"<\/span><\/span>";i.formatDropDown.dataBind();break;case"alignments":if(Object(r.isNullOrUndefined)(i.alignDropDown)||!Object(r.isNullOrUndefined)(i.alignDropDown)&&i.alignDropDown.isDestroyed)break;f=ct(rf,h,"subCommand","iconCss");i.alignDropDown.iconCss=Object(r.isNullOrUndefined)(f)?"e-icons e-justify-left":f;i.alignDropDown.dataBind();break;case"fontname":if(Object(r.isNullOrUndefined)(i.fontNameDropDown)||t||!Object(r.isNullOrUndefined)(i.fontNameDropDown)&&i.fontNameDropDown.isDestroyed)break;v=n.parent.fontFamily.items;f=ct(v,h,"value","text");k=Object(r.isNullOrUndefined)(n.parent.fontFamily.default)?v[0].text:n.parent.fontFamily.default;y=Object(r.isNullOrUndefined)(f)?k:f;n.tbElements[e].title=y;i.fontNameDropDown.content='<span style="display: inline-flex;width:'+n.parent.fontFamily.width+'" ><span class="e-rte-dropdown-btn-text">'+y+"<\/span><\/span>";i.fontNameDropDown.dataBind();break;case"fontsize":if(Object(r.isNullOrUndefined)(i.fontSizeDropDown)||!Object(r.isNullOrUndefined)(i.fontSizeDropDown)&&i.fontSizeDropDown.isDestroyed)break;p=n.parent.fontSize.items;d=Object(r.isNullOrUndefined)(n.parent.fontSize.default)?p[1].text:n.parent.fontSize.default;f=ct(p,""===h?d.replace(/\s/g,""):h,"value","text");i.fontSizeDropDown.content='<span style="display: inline-flex;width:'+n.parent.fontSize.width+'" ><span class="e-rte-dropdown-btn-text">'+wo(f)+"<\/span><\/span>";i.fontSizeDropDown.dataBind()}}}function uf(n){return"object"==typeof n?n:[n]}function ff(n,t){for(var i,u=[],r=0;r<n.length;r++)for(i=0;i<t.length;i++)if("Separator"!==t[i].type){if("OrderedList"===n[r]&&"OL"===t[i].subCommand){u.push(i);break}if("UnorderedList"===n[r]&&"UL"===t[i].subCommand){u.push(i);break}if("InsertCode"===n[r]&&"Pre"===t[i].subCommand){u.push(i);break}if(n[r]===t[i].subCommand){u.push(i);break}}return u}function ru(n,t){for(var o,u,f=0,s=ff(uf(kb),n.toolbarObj.items),h=Object(r.selectAll)("."+oi,n.toolbarObj.element),i=0,e=Object.keys(t);i<e.length;i++)o=e[i],u=h[s[f]],u&&n.toolbarObj.enableItems(u,t[o]),f++}function uu(n,t){var i=document.createEvent("HTMLEvents");i.initEvent(t,!1,!0);n.dispatchEvent(i)}function ci(n){var t=Object(r.createElement)("template");return t.innerHTML=n,t.content instanceof DocumentFragment?t.content:document.createRange().createContextualFragment(n)}function gh(n,t){var i=[];for(t=t.firstChild;t;t=t.nextSibling)3===t.nodeType?i.push(t):i=i.concat(gh(n,t));return i}function ko(n){for(var i={},r=Object.keys(n),t=0;t<Object.keys(n).length;t++)i[r[t].toLocaleLowerCase()]=n[r[t]];return i}function go(n,t){var i;return null!==n&&""!==n?(i=t.enableHtmlEncode?nc(lt(n)):nc(n),t.setProperties({value:i},!0)):i=t.enableHtmlEncode?"&lt;p&gt;&lt;br/&gt;&lt;/p&gt;":"<p><br/><\/p>",i}function nc(n){var t=document.createElement("div"),i;return t.innerHTML=n,i=t.childNodes,i.length>0&&[].slice.call(i).forEach(function(n){if(n.nodeType===Node.TEXT_NODE&&n.parentNode===t&&""!==n.textContent.trim()||"IMG"===n.nodeName&&n.parentNode===t){var i=document.createElement("p");n.parentNode.insertBefore(i,n);i.appendChild(n)}}),t.innerHTML}function gv(n){return"<p><br><\/p>"===n||"&lt;p&gt;&lt;br&gt;&lt;/p&gt;"===n||""===n}function lt(n){return n.replace(/&amp;/g,"&").replace(/&amp;lt;/g,"<").replace(/&lt;/g,"<").replace(/&amp;gt;/g,">").replace(/&gt;/g,">").replace(/&nbsp;/g," ").replace(/&amp;nbsp;/g," ").replace(/&quot;/g,"")}function tc(n,t){if(t.enableHtmlSanitizer){var i=r.SanitizeHtmlHelper.beforeSanitize();Object(r.extend)(i,i,{cancel:!1,helper:null});t.trigger("beforeSanitizeHtml",i);i.cancel&&!Object(r.isNullOrUndefined)(i.helper)?n=i.helper(n):i.cancel||(n=r.SanitizeHtmlHelper.serializeValue(i,n))}return n}function ef(n){for(var i=n.split(","),f=i[0].match(/:(.*?);/)[1],r=atob(i[1]),t=r.length,u=new Uint8Array(t);t--;)u[t]=r.charCodeAt(t);return new Blob([u],{type:f})}function d(){var n=!1;return r.Browser.isDevice&&r.Browser.isIos&&(n=!0),n}function ai(n,t){if("BODY"===n.nodeName&&!Object(r.isNullOrUndefined)(t)){var i=top.window.document.querySelector(t);Object(r.isNullOrUndefined)(i)||i.contentWindow.focus()}}function hs(n,t,i,r){var f,e,o,u;if(f=i?t.contentModule.getDocument().querySelector("body"):t.element,Object.keys(n).length)for(e=0,o=Object.keys(n);e<o.length;e++)u=o[e],"class"===u?f.classList.add(n[u]):"disabled"===u&&"disabled"===n[u]?(t.enabled=!1,t.setEnable()):"readonly"===u&&"readonly"===n[u]?(t.readonly=!0,t.setReadOnly(r)):"style"===u?f.setAttribute("style",n[u]):"tabindex"===u?t.inputElement.setAttribute("tabindex",n[u]):"placeholder"===u?(t.placeholder=n[u],t.setPlaceHolder()):["name","required"].indexOf(u)>-1?t.valueContainer.setAttribute(u,n[u]):f.setAttribute(u,n[u])}var u,ew;i.r(t);u={};i.r(u);i.d(u,"Toolbar",function(){return gb});i.d(u,"KeyboardEvents",function(){return ts});i.d(u,"BaseToolbar",function(){return rc});i.d(u,"BaseQuickToolbar",function(){return ry});i.d(u,"QuickToolbar",function(){return ik});i.d(u,"Count",function(){return rk});i.d(u,"ColorPickerInput",function(){return oc});i.d(u,"MarkdownToolbarStatus",function(){return fy});i.d(u,"ExecCommandCallBack",function(){return ey});i.d(u,"ToolbarAction",function(){return iy});i.d(u,"MarkdownEditor",function(){return ek});i.d(u,"HtmlEditor",function(){return lk});i.d(u,"PasteCleanup",function(){return ak});i.d(u,"Resize",function(){return vk});i.d(u,"DropDownButtons",function(){return uc});i.d(u,"FullScreen",function(){return dp});i.d(u,"setAttributes",function(){return hs});i.d(u,"HtmlToolbarStatus",function(){return wp});i.d(u,"XhtmlValidation",function(){return kp});i.d(u,"HTMLFormatter",function(){return yp});i.d(u,"Formatter",function(){return lc});i.d(u,"MarkdownFormatter",function(){return by});i.d(u,"ContentRender",function(){return bl});i.d(u,"Render",function(){return gp});i.d(u,"ToolbarRenderer",function(){return ty});i.d(u,"Link",function(){return yk});i.d(u,"Image",function(){return pk});i.d(u,"ViewSource",function(){return nw});i.d(u,"Table",function(){return wk});i.d(u,"DialogRenderer",function(){return tw});i.d(u,"IframeContentRender",function(){return bp});i.d(u,"MarkdownRender",function(){return ky});i.d(u,"PopupRenderer",function(){return uy});i.d(u,"RichTextEditor",function(){return bd});i.d(u,"RenderType",function(){return o});i.d(u,"ToolbarType",function(){return pt});i.d(u,"executeGroup",function(){return iw});i.d(u,"created",function(){return ow});i.d(u,"destroyed",function(){return sw});i.d(u,"load",function(){return dl});i.d(u,"initialLoad",function(){return tr});i.d(u,"initialEnd",function(){return p});i.d(u,"iframeMouseDown",function(){return wt});i.d(u,"destroy",function(){return h});i.d(u,"toolbarClick",function(){return hf});i.d(u,"toolbarRefresh",function(){return bt});i.d(u,"refreshBegin",function(){return cf});i.d(u,"toolbarUpdated",function(){return ot});i.d(u,"bindOnEnd",function(){return hu});i.d(u,"renderColorPicker",function(){return cu});i.d(u,"htmlToolbarClick",function(){return lf});i.d(u,"markdownToolbarClick",function(){return af});i.d(u,"destroyColorPicker",function(){return vf});i.d(u,"modelChanged",function(){return y});i.d(u,"keyUp",function(){return ri});i.d(u,"keyDown",function(){return w});i.d(u,"mouseUp",function(){return yf});i.d(u,"toolbarCreated",function(){return gl});i.d(u,"toolbarRenderComplete",function(){return ls});i.d(u,"enableFullScreen",function(){return lu});i.d(u,"disableFullScreen",function(){return au});i.d(u,"dropDownSelect",function(){return ui});i.d(u,"beforeDropDownItemRender",function(){return pf});i.d(u,"execCommandCallBack",function(){return wf});i.d(u,"imageToolbarAction",function(){return bf});i.d(u,"linkToolbarAction",function(){return kf});i.d(u,"resizeStart",function(){return df});i.d(u,"onResize",function(){return gf});i.d(u,"resizeStop",function(){return ne});i.d(u,"undo",function(){return hw});i.d(u,"redo",function(){return cw});i.d(u,"insertLink",function(){return vu});i.d(u,"unLink",function(){return te});i.d(u,"editLink",function(){return ie});i.d(u,"openLink",function(){return re});i.d(u,"actionBegin",function(){return st});i.d(u,"actionComplete",function(){return vi});i.d(u,"toolbarStatusUpdate",function(){return as});i.d(u,"actionSuccess",function(){return lw});i.d(u,"updateToolbarItem",function(){return ir});i.d(u,"insertImage",function(){return rr});i.d(u,"insertCompleted",function(){return ur});i.d(u,"imageLeft",function(){return aw});i.d(u,"imageRight",function(){return vw});i.d(u,"imageCenter",function(){return yw});i.d(u,"imageBreak",function(){return pw});i.d(u,"imageInline",function(){return ww});i.d(u,"imageLink",function(){return ue});i.d(u,"imageAlt",function(){return fe});i.d(u,"imageDelete",function(){return ee});i.d(u,"imageCaption",function(){return oe});i.d(u,"imageSize",function(){return se});i.d(u,"sourceCode",function(){return yi});i.d(u,"updateSource",function(){return fr});i.d(u,"toolbarOpen",function(){return bw});i.d(u,"beforeDropDownOpen",function(){return he});i.d(u,"selectionSave",function(){return ht});i.d(u,"selectionRestore",function(){return rt});i.d(u,"expandPopupClick",function(){return vs});i.d(u,"count",function(){return ce});i.d(u,"contentFocus",function(){return kw});i.d(u,"contentBlur",function(){return dw});i.d(u,"mouseDown",function(){return g});i.d(u,"sourceCodeMouseDown",function(){return er});i.d(u,"editAreaClick",function(){return ii});i.d(u,"scroll",function(){return fi});i.d(u,"contentscroll",function(){return or});i.d(u,"colorPickerChanged",function(){return sr});i.d(u,"tableColorPickerChanged",function(){return hr});i.d(u,"focusChange",function(){return cr});i.d(u,"selectAll",function(){return lr});i.d(u,"selectRange",function(){return yu});i.d(u,"getSelectedHtml",function(){return ar});i.d(u,"renderInlineToolbar",function(){return le});i.d(u,"paste",function(){return pi});i.d(u,"imgModule",function(){return gw});i.d(u,"rtlMode",function(){return kt});i.d(u,"createTable",function(){return ae});i.d(u,"docClick",function(){return ve});i.d(u,"tableToolbarAction",function(){return ye});i.d(u,"checkUndo",function(){return pe});i.d(u,"readOnlyMode",function(){return vr});i.d(u,"pasteClean",function(){return we});i.d(u,"beforeDialogOpen",function(){return na});i.d(u,"dialogOpen",function(){return ta});i.d(u,"dialogClose",function(){return ia});i.d(u,"beforeQuickToolbarOpen",function(){return ra});i.d(u,"quickToolbarOpen",function(){return ua});i.d(u,"quickToolbarClose",function(){return fa});i.d(u,"popupHide",function(){return nb});i.d(u,"imageSelected",function(){return ea});i.d(u,"imageUploading",function(){return ys});i.d(u,"imageUploadSuccess",function(){return be});i.d(u,"imageUploadFailed",function(){return ke});i.d(u,"imageRemoving",function(){return oa});i.d(u,"drop",function(){return ps});i.d(u,"xhtmlValidation",function(){return pu});i.d(u,"CLS_RTE",function(){return ws});i.d(u,"CLS_RTL",function(){return de});i.d(u,"CLS_CONTENT",function(){return tb});i.d(u,"CLS_DISABLED",function(){return ge});i.d(u,"CLS_SCRIPT_SHEET",function(){return bs});i.d(u,"CLS_STYLE_SHEET",function(){return ks});i.d(u,"CLS_TOOLBAR",function(){return wu});i.d(u,"CLS_TB_FIXED",function(){return ds});i.d(u,"CLS_TB_FLOAT",function(){return no});i.d(u,"CLS_TB_ABS_FLOAT",function(){return to});i.d(u,"CLS_INLINE",function(){return io});i.d(u,"CLS_TB_INLINE",function(){return ib});i.d(u,"CLS_RTE_EXPAND_TB",function(){return gs});i.d(u,"CLS_FULL_SCREEN",function(){return yr});i.d(u,"CLS_QUICK_TB",function(){return bu});i.d(u,"CLS_POP",function(){return nh});i.d(u,"CLS_QUICK_POP",function(){return sa});i.d(u,"CLS_QUICK_DROPDOWN",function(){return ei});i.d(u,"CLS_IMAGE_POP",function(){return ha});i.d(u,"CLS_INLINE_POP",function(){return pr});i.d(u,"CLS_INLINE_DROPDOWN",function(){return th});i.d(u,"CLS_DROPDOWN_POPUP",function(){return ut});i.d(u,"CLS_DROPDOWN_ICONS",function(){return ro});i.d(u,"CLS_DROPDOWN_ITEMS",function(){return dt});i.d(u,"CLS_DROPDOWN_BTN",function(){return nt});i.d(u,"CLS_RTE_CONTENT",function(){return ih});i.d(u,"CLS_TB_ITEM",function(){return oi});i.d(u,"CLS_TB_EXTENDED",function(){return rb});i.d(u,"CLS_TB_WRAP",function(){return uo});i.d(u,"CLS_POPUP",function(){return ub});i.d(u,"CLS_SEPARATOR",function(){return fb});i.d(u,"CLS_MINIMIZE",function(){return eb});i.d(u,"CLS_MAXIMIZE",function(){return ob});i.d(u,"CLS_BACK",function(){return sb});i.d(u,"CLS_SHOW",function(){return rh});i.d(u,"CLS_HIDE",function(){return wr});i.d(u,"CLS_VISIBLE",function(){return uh});i.d(u,"CLS_FOCUS",function(){return fo});i.d(u,"CLS_RM_WHITE_SPACE",function(){return fh});i.d(u,"CLS_IMGRIGHT",function(){return eh});i.d(u,"CLS_IMGLEFT",function(){return oh});i.d(u,"CLS_IMGCENTER",function(){return sh});i.d(u,"CLS_IMGBREAK",function(){return br});i.d(u,"CLS_CAPTION",function(){return ku});i.d(u,"CLS_RTE_CAPTION",function(){return ca});i.d(u,"CLS_CAPINLINE",function(){return la});i.d(u,"CLS_IMGINLINE",function(){return kr});i.d(u,"CLS_COUNT",function(){return hh});i.d(u,"CLS_WARNING",function(){return eo});i.d(u,"CLS_ERROR",function(){return oo});i.d(u,"CLS_ICONS",function(){return ch});i.d(u,"CLS_ACTIVE",function(){return dr});i.d(u,"CLS_EXPAND_OPEN",function(){return si});i.d(u,"CLS_RTE_ELEMENTS",function(){return b});i.d(u,"CLS_TB_BTN",function(){return lh});i.d(u,"CLS_HR_SEPARATOR",function(){return aa});i.d(u,"CLS_TB_IOS_FIX",function(){return ah});i.d(u,"CLS_TB_STATIC",function(){return va});i.d(u,"CLS_FORMATS_TB_BTN",function(){return ya});i.d(u,"CLS_FONT_NAME_TB_BTN",function(){return pa});i.d(u,"CLS_FONT_SIZE_TB_BTN",function(){return wa});i.d(u,"CLS_FONT_COLOR_TARGET",function(){return ba});i.d(u,"CLS_BACKGROUND_COLOR_TARGET",function(){return ka});i.d(u,"CLS_COLOR_CONTENT",function(){return gr});i.d(u,"CLS_FONT_COLOR_DROPDOWN",function(){return da});i.d(u,"CLS_BACKGROUND_COLOR_DROPDOWN",function(){return ga});i.d(u,"CLS_COLOR_PALETTE",function(){return nv});i.d(u,"CLS_FONT_COLOR_PICKER",function(){return tv});i.d(u,"CLS_BACKGROUND_COLOR_PICKER",function(){return iv});i.d(u,"CLS_RTE_READONLY",function(){return nu});i.d(u,"CLS_TABLE_SEL",function(){return hi});i.d(u,"CLS_TB_DASH_BOR",function(){return wi});i.d(u,"CLS_TB_ALT_BOR",function(){return bi});i.d(u,"CLS_TB_COL_RES",function(){return du});i.d(u,"CLS_TB_ROW_RES",function(){return gu});i.d(u,"CLS_TB_BOX_RES",function(){return nf});i.d(u,"CLS_RTE_HIDDEN",function(){return so});i.d(u,"CLS_RTE_PASTE_KEEP_FORMAT",function(){return rv});i.d(u,"CLS_RTE_PASTE_REMOVE_FORMAT",function(){return uv});i.d(u,"CLS_RTE_PASTE_PLAIN_FORMAT",function(){return fv});i.d(u,"CLS_RTE_PASTE_OK",function(){return ev});i.d(u,"CLS_RTE_PASTE_CANCEL",function(){return ov});i.d(u,"CLS_RTE_DIALOG_MIN_HEIGHT",function(){return sv});i.d(u,"CLS_RTE_RES_HANDLE",function(){return vh});i.d(u,"CLS_RTE_RES_EAST",function(){return hv});i.d(u,"CLS_RTE_IMAGE",function(){return cv});i.d(u,"CLS_RESIZE",function(){return lv});i.d(u,"CLS_IMG_FOCUS",function(){return av});i.d(u,"CLS_RTE_DRAG_IMAGE",function(){return tf});i.d(u,"CLS_RTE_UPLOAD_POPUP",function(){return yh});i.d(u,"CLS_POPUP_OPEN",function(){return ho});i.d(u,"CLS_IMG_RESIZE",function(){return vv});i.d(u,"CLS_DROPAREA",function(){return yv});i.d(u,"CLS_IMG_INNER",function(){return pv});i.d(u,"CLS_UPLOAD_FILES",function(){return wv});i.d(u,"CLS_RTE_DIALOG_UPLOAD",function(){return ph});i.d(u,"CLS_RTE_RES_CNT",function(){return wh});i.d(u,"CLS_CUSTOM_TILE",function(){return bv});i.d(u,"CLS_NOCOLOR_ITEM",function(){return kv});i.d(u,"CLS_TABLE_BORDER",function(){return bh});i.d(u,"getIndex",function(){return po});i.d(u,"hasClass",function(){return tt});i.d(u,"getDropDownValue",function(){return ct});i.d(u,"isIDevice",function(){return a});i.d(u,"getFormattedFontSize",function(){return wo});i.d(u,"pageYOffset",function(){return dv});i.d(u,"getTooltipText",function(){return bo});i.d(u,"setToolbarStatus",function(){return dh});i.d(u,"getCollection",function(){return uf});i.d(u,"getTBarItemsIndex",function(){return ff});i.d(u,"updateUndoRedoStatus",function(){return ru});i.d(u,"dispatchEvent",function(){return uu});i.d(u,"parseHtml",function(){return ci});i.d(u,"getTextNodesUnder",function(){return gh});i.d(u,"toObjectLowerCase",function(){return ko});i.d(u,"getEditValue",function(){return go});i.d(u,"updateTextNode",function(){return nc});i.d(u,"isEditableValueEmpty",function(){return gv});i.d(u,"decode",function(){return lt});i.d(u,"sanitizeHelper",function(){return tc});i.d(u,"convertToBlob",function(){return ef});i.d(u,"ServiceLocator",function(){return fc});i.d(u,"RendererFactory",function(){return ec});i.d(u,"EditorManager",function(){return vp});i.d(u,"IMAGE",function(){return gc});i.d(u,"TABLE",function(){return nl});i.d(u,"LINK",function(){return tl});i.d(u,"INSERT_ROW",function(){return il});i.d(u,"INSERT_COLUMN",function(){return rl});i.d(u,"DELETEROW",function(){return ul});i.d(u,"DELETECOLUMN",function(){return fl});i.d(u,"REMOVETABLE",function(){return el});i.d(u,"TABLEHEADER",function(){return ol});i.d(u,"TABLE_VERTICAL_ALIGN",function(){return sl});i.d(u,"ALIGNMENT_TYPE",function(){return hl});i.d(u,"INDENT_TYPE",function(){return cl});i.d(u,"DEFAULT_TAG",function(){return it});i.d(u,"BLOCK_TAGS",function(){return di});i.d(u,"IGNORE_BLOCK_TAGS",function(){return at});i.d(u,"TABLE_BLOCK_TAGS",function(){return ou});i.d(u,"SELECTION_TYPE",function(){return ll});i.d(u,"INSERTHTML_TYPE",function(){return al});i.d(u,"INSERT_TEXT_TYPE",function(){return vl});i.d(u,"CLEAR_TYPE",function(){return yl});i.d(u,"CLASS_IMAGE_RIGHT",function(){return gt});i.d(u,"CLASS_IMAGE_LEFT",function(){return ni});i.d(u,"CLASS_IMAGE_CENTER",function(){return gi});i.d(u,"CLASS_IMAGE_BREAK",function(){return os});i.d(u,"CLASS_CAPTION",function(){return c});i.d(u,"CLASS_RTE_CAPTION",function(){return ok});i.d(u,"CLASS_CAPTION_INLINE",function(){return pl});i.d(u,"CLASS_IMAGE_INLINE",function(){return up});i.d(u,"Lists",function(){return gy});i.d(u,"markerClassName",function(){return s});i.d(u,"DOMNode",function(){return dy});i.d(u,"Alignments",function(){return ip});i.d(u,"Indents",function(){return rp});i.d(u,"Formats",function(){return np});i.d(u,"LinkCommand",function(){return tp});i.d(u,"InsertMethods",function(){return l});i.d(u,"InsertTextExec",function(){return ap});i.d(u,"InsertHtmlExec",function(){return sp});i.d(u,"InsertHtml",function(){return vt});i.d(u,"IsFormatted",function(){return yt});i.d(u,"MsWordPaste",function(){return lp});i.d(u,"NodeCutter",function(){return su});i.d(u,"ImageCommand",function(){return fp});i.d(u,"SelectionCommands",function(){return wl});i.d(u,"SelectionBasedExec",function(){return op});i.d(u,"ClearFormatExec",function(){return hp});i.d(u,"UndoRedoManager",function(){return cp});i.d(u,"TableCommand",function(){return ep});i.d(u,"statusCollection",function(){return ss});i.d(u,"ToolbarStatus",function(){return pp});i.d(u,"NodeSelection",function(){return k});i.d(u,"MarkdownParser",function(){return wy});i.d(u,"LISTS_COMMAND",function(){return ac});i.d(u,"selectionCommand",function(){return fs});i.d(u,"LINK_COMMAND",function(){return vc});i.d(u,"CLEAR_COMMAND",function(){return yc});i.d(u,"MD_TABLE",function(){return es});i.d(u,"ClearFormat",function(){return py});i.d(u,"MDLists",function(){return oy});i.d(u,"MDFormats",function(){return sy});i.d(u,"MarkdownSelection",function(){return is});i.d(u,"UndoRedoCommands",function(){return ay});i.d(u,"MDSelectionFormats",function(){return hy});i.d(u,"MDLink",function(){return vy});i.d(u,"MDTable",function(){return yy});i.d(u,"markdownFormatTags",function(){return pc});i.d(u,"markdownSelectionTags",function(){return wc});i.d(u,"markdownListsTags",function(){return bc});i.d(u,"htmlKeyConfig",function(){return cy});i.d(u,"markdownKeyConfig",function(){return ly});i.d(u,"pasteCleanupGroupingTags",function(){return kc});i.d(u,"listConversionFilters",function(){return uk});i.d(u,"selfClosingTags",function(){return dc});i.d(u,"KEY_DOWN",function(){return rs});i.d(u,"ACTION",function(){return ki});i.d(u,"FORMAT_TYPE",function(){return of});i.d(u,"KEY_DOWN_HANDLER",function(){return v});i.d(u,"LIST_TYPE",function(){return sc});i.d(u,"KEY_UP_HANDLER",function(){return li});i.d(u,"KEY_UP",function(){return fu});i.d(u,"MODEL_CHANGED_PLUGIN",function(){return eu});i.d(u,"MODEL_CHANGED",function(){return us});i.d(u,"MS_WORD_CLEANUP_PLUGIN",function(){return hc});i.d(u,"MS_WORD_CLEANUP",function(){return cc});var o,pt,cs=i(4),r=i(0),ow="create",sw="destroy",dl="load",tr="initial-load",p="initial-end",wt="iframe-click",h="destroy",hf="toolbarClick",bt="toolbar-refresh",cf="refresh-begin",ot="toolbar-updated",hu="bind-on-end",cu="render-color-picker",lf="html-toolbar-click",af="markdown-toolbar-click",vf="destroy-color-picker",y="model-changed",ri="keyUp",w="keyDown",yf="mouseUp",gl="toolbarCreated",ls="toolbarRenderComplete",lu="enableFullScreen",au="disableFullScreen",ui="dropDownSelect",pf="beforeDropDownItemRender",wf="execCommandCallBack",bf="image-toolbar-action",kf="link-toolbar-action",df="resizeStart",gf="resizing",ne="resizeStop",hw="undo",cw="redo",vu="insertLink",te="unLink",ie="editLink",re="openLink",st="actionBegin",vi="actionComplete",as="toolbarStatusUpdate",lw="actionSuccess",ir="updateToolbarItem",rr="insertImage",ur="insertCompleted",aw="justifyLeft",vw="justifyRight",yw="justifyCenter",pw="break",ww="inline",ue="insertImgLink",fe="imgAltText",ee="delete",oe="caption",se="imageSize",yi="sourceCode",fr="updateSource",bw="toolbarOpen",he="beforeDropDownOpen",ht="selection-save",rt="selection-restore",vs="expandPopupClick",ce="count",kw="contentFocus",dw="contentBlur",g="mouseDown",er="sourceCodeMouseDown",ii="editAreaClick",fi="scroll",or="contentscroll",sr="colorPickerChanged",hr="tableColorPickerChanged",cr="focusChange",lr="selectAll",yu="selectRange",ar="getSelectedHtml",le="renderInlineToolbar",pi="paste-content",gw="imageModule",kt="rtl-mode",ae="createTable",ve="docClick",ye="table-toolbar-action",pe="checkUndoStack",vr="readOnlyMode",we="pasteClean",na="beforeDialogOpen",ta="dialogOpen",ia="dialogClose",ra="beforeQuickToolbarOpen",ua="quickToolbarOpen",fa="quickToolbarClose",nb="popupHide",ea="imageSelected",ys="imageUploading",be="imageUploadSuccess",ke="imageUploadFailed",oa="imageRemoving",ps="drop",pu="xhtmlValidation",ws="e-richtexteditor",de="e-rtl",tb="e-content",ge="e-disabled",bs="rte-iframe-script-sheet",ks="rte-iframe-style-sheet",wu="e-rte-toolbar",ds="e-rte-tb-fixed",no="e-rte-tb-float",to="e-rte-tb-abs-float",io="e-rte-inline",ib="e-rte-tb-inline",gs="e-rte-tb-expand",yr="e-rte-full-screen",bu="e-rte-quick-toolbar",nh="e-rte-pop",sa="e-rte-quick-popup",ei="e-quick-dropdown",ha="e-rte-image-popup",pr="e-rte-inline-popup",th="e-rte-inline-dropdown",ut="e-rte-dropdown-popup",ro="e-rte-dropdown-icons",dt="e-rte-dropdown-items",nt="e-rte-dropdown-btn",ih="e-rte-content",oi="e-toolbar-item",rb="e-toolbar-extended",uo="e-toolbar-wrapper",ub="e-popup",fb="e-separator",eb="e-minimize",ob="e-maximize",sb="e-back",rh="e-show",wr="e-hide",uh="e-visible",fo="e-focused",fh="e-remove-white-space",eh="e-imgright",oh="e-imgleft",sh="e-imgcenter",br="e-imgbreak",ku="e-img-caption",ca="e-rte-img-caption",la="e-caption-inline",kr="e-imginline",hh="e-rte-character-count",eo="e-warning",oo="e-error",ch="e-icons",dr="e-active",si="e-expand-open",b="e-rte-elements",lh="e-tbar-btn",aa="e-rte-horizontal-separator",ah="e-tbar-ios-fixed",va="e-tb-static",ya="e-formats-tbar-btn",pa="e-font-name-tbar-btn",wa="e-font-size-tbar-btn",ba="e-rte-fontcolor-element",ka="e-rte-backgroundcolor-element",gr="e-rte-color-content",da="e-rte-fontcolor-dropdown",ga="e-rte-backgroundcolor-dropdown",nv="e-rte-square-palette",tv="e-rte-fontcolor-colorpicker",iv="e-rte-backgroundcolor-colorpicker",nu="e-rte-readonly",hi="e-cell-select",wi="e-dashed-border",bi="e-alternate-border",du="e-column-resize",gu="e-row-resize",nf="e-table-box",so="e-rte-hidden",rv="e-rte-keepformat",uv="e-rte-removeformat",fv="e-rte-plainformat",ev="e-rte-pasteok",ov="e-rte-pastecancel",sv="e-rte-dialog-minheight",vh="e-resize-handle",hv="e-south-east",cv="e-rte-image",lv="e-resize",av="e-img-focus",tf="e-rte-drag-image",yh="e-rte-upload-popup",ho="e-popup-open",vv="e-img-resize",yv="e-droparea",pv="e-img-inner",wv="e-upload-files",ph="e-rte-dialog-upload",wh="e-rte-resize",bv="e-custom-tile",kv="e-nocolor-item",bh="e-rte-table-border";!function(n){n[n.Toolbar=0]="Toolbar";n[n.Content=1]="Content";n[n.Popup=2]="Popup";n[n.LinkToolbar=3]="LinkToolbar";n[n.TextToolbar=4]="TextToolbar";n[n.ImageToolbar=5]="ImageToolbar";n[n.InlineToolbar=6]="InlineToolbar";n[n.TableToolbar=7]="TableToolbar"}(o||(o={})),function(n){n.Expand="Expand";n.MultiRow="MultiRow"}(pt||(pt={}));var kh=["alignments","formats","fontname","fontsize","fontcolor","backgroundcolor","align","display","tablerows","tablecolumns","tablecellhorizontalalign","tablecellverticalalign","styles"],tu={alignments:{id:"Alignments",icon:"e-alignments",tooltip:"Alignments",command:"Alignments",subCommand:"Alignments"},justifyleft:{id:"JustifyLeft",icon:"e-justify-left",tooltip:"JustifyLeft",command:"Alignments",subCommand:"JustifyLeft"},justifycenter:{id:"JustifyCenter",icon:"e-justify-center",tooltip:"JustifyCenter",command:"Alignments",subCommand:"JustifyCenter"},justifyright:{id:"JustifyRight",icon:"e-justify-right",tooltip:"JustifyRight",command:"Alignments",subCommand:"JustifyRight"},justifyfull:{id:"JustifyFull",icon:"e-justify-full",tooltip:"JustifyFull",command:"Alignments",subCommand:"JustifyFull"},fontname:{id:"FontName",icon:"e-font-name",tooltip:"Font Name",command:"Font",subCommand:"FontName"},fontsize:{id:"FontSize",icon:"e-font-size",tooltip:"Font Size",command:"Font",subCommand:"FontSize"},fontcolor:{id:"FontColor",icon:"e-font-color",tooltip:"Font Color",command:"Font",subCommand:"FontColor",value:"#ff0000ff"},backgroundcolor:{id:"BackgroundColor",icon:"e-background-color",tooltip:"Background Color",command:"Font",subCommand:"BackgroundColor",value:"#ffff00ff"},bold:{id:"Bold",icon:"e-bold",tooltip:"Bold",command:"Style",subCommand:"Bold"},italic:{id:"Italic",icon:"e-italic",tooltip:"Italic",command:"Style",subCommand:"Italic"},underline:{id:"Underline",icon:"e-underline",tooltip:"Underline",command:"Style",subCommand:"Underline"},strikethrough:{id:"StrikeThrough",icon:"e-strike-through",tooltip:"StrikeThrough",command:"Style",subCommand:"StrikeThrough"},clearformat:{id:"ClearFormat",icon:"e-clear-format",tooltip:"Clear Format",command:"Clear",subCommand:"ClearFormat"},clearall:{id:"ClearAll",icon:"e-clear-all",tooltip:"Clear All",command:"Clear",subCommand:"ClearAll"},cut:{id:"Cut",icon:"e-cut",tooltip:"Cut",command:"ClipBoard",subCommand:"Cut"},copy:{id:"Copy",icon:"e-copy",tooltip:"Copy",command:"ClipBoard",subCommand:"Copy"},paste:{id:"Paste",icon:"e-paste",tooltip:"Paste",command:"ClipBoard",subCommand:"Paste"},unorderedlist:{id:"UnorderedList",icon:"e-unorder-list",tooltip:"Bulleted List",command:"Lists",subCommand:"UL"},orderedlist:{id:"OrderedList",icon:"e-order-list",tooltip:"Numbered List",command:"Lists",subCommand:"OL"},indent:{id:"Indent",icon:"e-indent",tooltip:"Increase Indent",command:"Indents",subCommand:"Indent"},outdent:{id:"Outdent",icon:"e-outdent",tooltip:"Decrease Indent",command:"Indents",subCommand:"Outdent"},undo:{id:"Undo",icon:"e-undo",tooltip:"Undo",command:"Actions",subCommand:"Undo"},redo:{id:"Redo",icon:"e-redo",tooltip:"Redo",command:"Actions",subCommand:"Redo"},superscript:{id:"SuperScript",icon:"e-super-script",tooltip:"Superscript",command:"Effects",subCommand:"SuperScript"},subscript:{id:"SubScript",icon:"e-sub-script",tooltip:"Subscript",command:"Effects",subCommand:"SubScript"},createlink:{id:"CreateLink",icon:"e-create-link",tooltip:"Insert Hyperlink",command:"Links",subCommand:"CreateLink"},openlink:{id:"OpenLink",icon:"e-open-link",tooltip:"Open Link",command:"Links",subCommand:"OpenLink"},editlink:{id:"EditLink",icon:"e-edit-link",tooltip:"Edit Link",command:"Links",subCommand:"EditLink"},removelink:{id:"RemoveLink",icon:"e-remove-link",tooltip:"Remove Link",command:"Links",subCommand:"RemoveLink"},image:{id:"Image",icon:"e-image",tooltip:"Insert Image",command:"Images",subCommand:"Image"},createtable:{id:"CreateTable",icon:"e-create-table",tooltip:"Create Table",command:"Table",subCommand:"CreateTable"},removetable:{id:"removeTable",icon:"e-remove-table",tooltip:"Remove Table",command:"removeTable",subCommand:"removeTable"},replace:{id:"Replace",icon:"e-replace",tooltip:"Replace",command:"Images",subCommand:"Replace"},align:{id:"Align",icon:"e-align",tooltip:"Align",command:"Images",subCommand:"Align"},caption:{id:"Caption",icon:"e-caption",tooltip:"Image Caption",command:"Images",subCommand:"Caption"},remove:{id:"Remove",icon:"e-remove",tooltip:"Remove",command:"Images",subCommand:"Remove"},openimagelink:{id:"OpenImageLink",icon:"e-open-link",tooltip:"Open Link",command:"Images",subCommand:"OpenImageLink"},editimagelink:{id:"EditImageLink",icon:"e-edit-link",tooltip:"Edit Link",command:"Images",subCommand:"EditImageLink"},removeimagelink:{id:"RemoveImageLink",icon:"e-remove-link",tooltip:"Remove Link",command:"Images",subCommand:"RemoveImageLink"},insertlink:{id:"InsertLink",icon:"e-insert-link",tooltip:"Insert Link",command:"Images",subCommand:"InsertLink"},display:{id:"Display",icon:"e-display",tooltip:"Display",command:"Images",subCommand:"Display"},alttext:{id:"AltText",icon:"e-alt-text",tooltip:"Alternative Text",command:"Images",subCommand:"AltText"},dimension:{id:"Dimension",icon:"e-dimension",tooltip:"Change Size",command:"Images",subCommand:"Dimension"},fullscreen:{id:"Maximize",icon:"e-maximize",tooltip:"Maximize",command:"View",subCommand:"Maximize"},maximize:{id:"Maximize",icon:"e-maximize",tooltip:"Maximize",command:"FullScreen",subCommand:"Maximize"},minimize:{id:"Minimize",icon:"e-minimize",tooltip:"Minimize",command:"FullScreen",subCommand:"Minimize"},lowercase:{id:"LowerCase",icon:"e-lower-case",tooltip:"Lower Case",command:"Casing",subCommand:"LowerCase"},uppercase:{id:"UpperCase",icon:"e-upper-case",tooltip:"Upper Case",command:"Casing",subCommand:"UpperCase"},print:{id:"Print",icon:"e-print",tooltip:"Print",command:"Print",subCommand:"Print"},formats:{id:"Formats",icon:"e-formats",tooltip:"Formats",command:"Formats",subCommand:"Formats"},sourcecode:{id:"SourceCode",icon:"e-source-code",tooltip:"Source Code",command:"SourceCode",subCommand:"SourceCode"},preview:{id:"Preview",icon:"e-preview",tooltip:"Preview",command:"Preview",subCommand:"Preview"},viewside:{id:"ViewSide",icon:"e-view-side",tooltip:"ViewSide",command:"ViewSide",subCommand:"ViewSide"},insertcode:{id:"InsertCode",icon:"e-insert-code",tooltip:"Insert Code",command:"Formats",subCommand:"Pre"},tableheader:{id:"TableHeader",icon:"e-table-header",tooltip:"Table Header",command:"Table",subCommand:"TableHeader"},tableremove:{id:"TableRemove",icon:"e-table-remove",tooltip:"Table Remove",command:"Table",subCommand:"TableRemove"},tablerows:{id:"TableRows",icon:"e-table-rows",tooltip:"Table Rows",command:"Table",subCommand:"TableRows"},tablecolumns:{id:"TableColumns",icon:"e-table-columns",tooltip:"Table Columns",command:"Table",subCommand:"TableColumns"},tablecellbackground:{id:"TableCellBackground",icon:"e-table-cell-background",tooltip:"Table Cell Background",command:"Table",subCommand:"TableCellBackground"},tablecellhorizontalalign:{id:"TableCellHorizontalAlign",icon:"e-table-cell-horizontalAlign",tooltip:"Table Cell HorizontalAlign",command:"Table",subCommand:"TableCellHorizontalAlign"},tablecellverticalalign:{id:"TableCellVerticalAlign",icon:"e-table-cell-verticalAlign",tooltip:"Table Cell VerticalAlign",command:"Table",subCommand:"TableCellVerticalAlign"},tableeditproperties:{id:"TableEditProperties",icon:"e-table-edit-properties",tooltip:"Table Edit Properties",command:"Table",subCommand:"TableEditProperties"},styles:{id:"Styles",icon:"e-table-styles",tooltip:"Styles",command:"Table",subCommand:"Styles"}},hb=[{locale:"alignmentsDropDownLeft",value:"JustifyLeft"},{locale:"alignmentsDropDownCenter",value:"JustifyCenter"},{locale:"alignmentsDropDownRight",value:"JustifyRight"},{locale:"alignmentsDropDownJustify",value:"JustifyFull"}],rf=[{iconCss:"e-icons e-justify-left",text:"Align Left",command:"Alignments",subCommand:"JustifyLeft"},{iconCss:"e-icons e-justify-center",text:"Align Center",command:"Alignments",subCommand:"JustifyCenter"},{iconCss:"e-icons e-justify-right",text:"Align Right",command:"Alignments",subCommand:"JustifyRight"},{iconCss:"e-icons e-justify-full",text:"Align Justify",command:"Alignments",subCommand:"JustifyFull"}],cb=[{iconCss:"e-icons e-justify-left",command:"Images",subCommand:"JustifyLeft"},{iconCss:"e-icons e-justify-center",command:"Images",subCommand:"JustifyCenter"},{iconCss:"e-icons e-justify-right",command:"Images",subCommand:"JustifyRight"}],lb=[{locale:"imageDisplayDropDownInline",value:"Inline"},{locale:"imageDisplayDropDownBreak",value:"Break"}],co=[{text:"Inline",cssClass:"e-inline",command:"Images",subCommand:"Inline"},{text:"Break",cssClass:"e-break",command:"Images",subCommand:"Break"}],ab=[{locale:"tableInsertRowDropDownBefore",value:"InsertRowBefore"},{locale:"tableInsertRowDropDownAfter",value:"InsertRowAfter"},{locale:"tableInsertRowDropDownDelete",value:"DeleteRow"}],lo=[{iconCss:"e-icons e-insert-row-before",text:"Insert row before",command:"Table",subCommand:"InsertRowBefore"},{iconCss:"e-icons e-insert-row-after",text:"Insert row after",command:"Table",subCommand:"InsertRowAfter"},{iconCss:"e-icons e-delete-row",text:"Delete row",command:"Table",subCommand:"DeleteRow"}],vb=[{locale:"tableInsertColumnDropDownLeft",value:"InsertColumnLeft"},{locale:"tableInsertColumnDropDownRight",value:"InsertColumnRight"},{locale:"tableInsertColumnDropDownDelete",value:"DeleteColumn"}],ao=[{iconCss:"e-icons e-insert-column-left",text:"Insert column left",command:"Table",subCommand:"InsertColumnLeft"},{iconCss:"e-icons e-insert-column-right",text:"Insert column right",command:"Table",subCommand:"InsertColumnRight"},{iconCss:"e-icons e-delete-column",text:"Delete column",command:"Table",subCommand:"DeleteColumn"}],yb=[{locale:"tableVerticalAlignDropDownTop",value:"AlignTop"},{locale:"tableVerticalAlignDropDownMiddle",value:"AlignMiddle"},{locale:"tableVerticalAlignDropDownBottom",value:"AlignBottom"}],vo=[{iconCss:"e-icons e-align-top",text:"Align Top",command:"Table",subCommand:"AlignTop"},{iconCss:"e-icons e-align-middle",text:"Align Middle",command:"Table",subCommand:"AlignMiddle"},{iconCss:"e-icons e-align-bottom",text:"Align Bottom",command:"Table",subCommand:"AlignBottom"}],pb=[{locale:"tableStylesDropDownDashedBorder",value:"Dashed"},{locale:"tableStylesDropDownAlternateRows",value:"Alternate"}],yo=[{text:"Dashed Borders",cssClass:"e-dashed-borders",command:"Table",subCommand:"Dashed"},{text:"Alternate Rows",cssClass:"e-alternate-rows",command:"Table",subCommand:"Alternate"}];var wb={alignments:"Alignments",justifyLeft:"Align Left",justifyCenter:"Align Center",justifyRight:"Align Right",justifyFull:"Align Justify",fontName:"Font Name",fontSize:"Font Size",fontColor:"Font Color",backgroundColor:"Background Color",bold:"Bold",italic:"Italic",underline:"Underline",strikethrough:"Strikethrough",clearFormat:"Clear Format",clearAll:"Clear All",cut:"Cut",copy:"Copy",paste:"Paste",unorderedList:"Bulleted List",orderedList:"Numbered List",indent:"Increase Indent",outdent:"Decrease Indent",undo:"Undo",redo:"Redo",superscript:"Superscript",subscript:"Subscript",createLink:"Insert Hyperlink",openLink:"Open Link",editLink:"Edit Link",removeLink:"Remove Link",image:"Insert Image",replace:"Replace",align:"Align",caption:"Image Caption",remove:"Remove",insertLink:"Insert Link",display:"Display",altText:"Alternative Text",dimension:"Change Size",fullscreen:"Maximize",maximize:"Maximize",minimize:"Minimize",lowerCase:"Lower Case",upperCase:"Upper Case",print:"Print",formats:"Formats",sourcecode:"Code View",preview:"Preview",viewside:"ViewSide",insertCode:"Insert Code",linkText:"Display Text",linkTooltipLabel:"Title",linkWebUrl:"Web Address",linkTitle:"Enter a title",linkurl:"http://example.com",linkOpenInNewWindow:"Open Link in New Window",linkHeader:"Insert Link",dialogInsert:"Insert",dialogCancel:"Cancel",dialogUpdate:"Update",imageHeader:"Insert Image",imageLinkHeader:"You can also provide a link from the web",mdimageLink:"Please provide a URL for your image",imageUploadMessage:"Drop image here or browse to upload",imageDeviceUploadMessage:"Click here to upload",imageAlternateText:"Alternate Text",alternateHeader:"Alternative Text",browse:"Browse",imageUrl:"http://example.com/image.png",imageCaption:"Caption",imageSizeHeader:"Image Size",imageHeight:"Height",imageWidth:"Width",textPlaceholder:"Enter Text",inserttablebtn:"Insert Table",tabledialogHeader:"Insert Table",tableWidth:"Width",cellpadding:"Cell Padding",cellspacing:"Cell Spacing",columns:"Number of columns",rows:"Number of rows",tableRows:"Table Rows",tableColumns:"Table Columns",tableCellHorizontalAlign:"Table Cell Horizontal Align",tableCellVerticalAlign:"Table Cell Vertical Align",createTable:"Create Table",removeTable:"Remove Table",tableHeader:"Table Header",tableRemove:"Table Remove",tableCellBackground:"Table Cell Background",tableEditProperties:"Table Edit Properties",styles:"Styles",insertColumnLeft:"Insert Column Left",insertColumnRight:"Insert Column Right",deleteColumn:"Delete Column",insertRowBefore:"Insert Row Before",insertRowAfter:"Insert Row After",deleteRow:"Delete Row",tableEditHeader:"Edit Table",TableHeadingText:"Heading",TableColText:"Col",imageInsertLinkHeader:"Insert Link",editImageHeader:"Edit Image",alignmentsDropDownLeft:"Align Left",alignmentsDropDownCenter:"Align Center",alignmentsDropDownRight:"Align Right",alignmentsDropDownJustify:"Align Justify",imageDisplayDropDownInline:"Inline",imageDisplayDropDownBreak:"Break",tableInsertRowDropDownBefore:"Insert row before",tableInsertRowDropDownAfter:"Insert row after",tableInsertRowDropDownDelete:"Delete row",tableInsertColumnDropDownLeft:"Insert column left",tableInsertColumnDropDownRight:"Insert column right",tableInsertColumnDropDownDelete:"Delete column",tableVerticalAlignDropDownTop:"Align Top",tableVerticalAlignDropDownMiddle:"Align Middle",tableVerticalAlignDropDownBottom:"Align Bottom",tableStylesDropDownDashedBorder:"Dashed Borders",tableStylesDropDownAlternateRows:"Alternate Rows",pasteFormat:"Paste Format",pasteFormatContent:"Choose the formatting action",plainText:"Plain Text",cleanFormat:"Clean",keepFormat:"Keep",pasteDialogOk:"OK",pasteDialogCancel:"Cancel"},bb={alignments:"alignments",justifyleft:"justifyLeft",justifycenter:"justifyCenter",justifyright:"justifyRight",justifyfull:"justifyFull",fontname:"fontName",fontsize:"fontSize",fontcolor:"fontColor",backgroundcolor:"backgroundColor",bold:"bold",italic:"italic",underline:"underline",strikethrough:"strikethrough",clearformat:"clearFormat",clearall:"clearAll",cut:"cut",copy:"copy",paste:"paste",unorderedlist:"unorderedList",orderedlist:"orderedList",indent:"indent",outdent:"outdent",undo:"undo",redo:"redo",superscript:"superscript",subscript:"subscript",createlink:"createLink",openlink:"openLink",editlink:"editLink",removelink:"removeLink",openimagelink:"openLink",editimagelink:"editLink",removeimagelink:"removeLink",image:"image",replace:"replace",align:"align",caption:"caption",remove:"remove",insertlink:"insertLink",display:"display",alttext:"altText",dimension:"dimension",fullscreen:"fullscreen",maximize:"maximize",minimize:"minimize",lowercase:"lowerCase",uppercase:"upperCase",print:"print",formats:"formats",sourcecode:"sourcecode",preview:"preview",viewside:"viewside",insertcode:"insertCode",tablerows:"tableRows",tablecolumns:"tableColumns",tablecellhorizontalalign:"tableCellHorizontalAlign",tablecellverticalalign:"tableCellVerticalAlign",createtable:"createTable",removetable:"removeTable",tableheader:"tableHeader",tableremove:"tableRemove",tablecellbackground:"tableCellBackground",tableeditproperties:"tableEditProperties",styles:"styles",insertcolumnleft:"insertColumnLeft",insertcolumnright:"insertColumnRight",deletecolumn:"deleteColumn",aligntop:"AlignTop",alignmiddle:"AlignMiddle",alignbottom:"AlignBottom",insertrowbefore:"insertRowBefore",insertrowafter:"insertRowAfter",deleterow:"deleteRow"},kb=["Undo","Redo"];var ic,db=i(6),ny=i(5),ft=i(1),et=i(2),ty=function(){function n(n){this.parent=n;this.wireEvent()}return n.prototype.wireEvent=function(){this.parent.on(h,this.unWireEvent,this)},n.prototype.unWireEvent=function(){this.parent.off(h,this.unWireEvent);this.popupOverlay&&r.EventHandler.remove(this.popupOverlay,"click touchmove",this.onPopupOverlay);this.removePopupContainer()},n.prototype.toolbarBeforeCreate=function(n){"Extended"===this.mode&&(n.enableCollision=!1)},n.prototype.toolbarCreated=function(){this.parent.notify(gl,this)},n.prototype.toolbarClicked=function(n){!this.parent.readonly&&this.parent.enabled&&(this.parent.notify(hf,n),this.parent.trigger("toolbarClick",n))},n.prototype.dropDownSelected=function(n){this.parent.notify(ui,n);this.onPopupOverlay()},n.prototype.beforeDropDownItemRender=function(n){!this.parent.readonly&&this.parent.enabled&&this.parent.notify(pf,n)},n.prototype.dropDownOpen=function(n){r.Browser.isDevice&&!n.element.parentElement.classList.contains(ei)&&this.popupModal(n.element.parentElement);this.parent.notify(ht,n)},n.prototype.dropDownClose=function(n){this.removePopupContainer();this.parent.notify(rt,n)},n.prototype.removePopupContainer=function(){r.Browser.isDevice&&!Object(r.isNullOrUndefined)(this.popupContainer)&&(Object(r.detach)(this.popupContainer),this.popupContainer=void 0)},n.prototype.renderToolbar=function(n){this.setPanel(n.target);this.renderPanel();this.mode=n.overflowMode;n.rteToolbarObj.toolbarObj=new db.Toolbar({items:n.items,width:"100%",overflowMode:n.overflowMode,beforeCreate:this.toolbarBeforeCreate.bind(this),created:this.toolbarCreated.bind(this),clicked:this.toolbarClicked.bind(this),enablePersistence:n.enablePersistence,enableRtl:n.enableRtl});n.rteToolbarObj.toolbarObj.isStringTemplate=!0;n.rteToolbarObj.toolbarObj.createElement=this.parent.createElement;n.rteToolbarObj.toolbarObj.appendTo(n.target)},n.prototype.renderDropDownButton=function(n){var u,f=this,i,t;return n.element.classList.add(nt),u=n.cssClass+" "+b+" "+lh,this.parent.inlineMode.enable&&r.Browser.isDevice&&(u=u+" "+th),i=this,t=new ny.DropDownButton({items:n.items,iconCss:n.iconCss,cssClass:u,content:n.content,enablePersistence:this.parent.enablePersistence,enableRtl:this.parent.enableRtl,select:this.dropDownSelected.bind(this),beforeOpen:function(n){var u,e;if(!i.parent.readonly&&i.parent.enabled){for(u=0;u<n.element.childNodes.length;u++)e=f.parent.createElement("div"),e.innerHTML=t.content.trim(),""!==e.textContent.trim()&&n.element.childNodes[u].textContent.trim()===e.textContent.trim()?n.element.childNodes[u].classList.contains("e-active")||Object(r.addClass)([n.element.childNodes[u]],"e-active"):Object(r.removeClass)([n.element.childNodes[u]],"e-active");i.parent.notify(he,n)}else n.cancel=!0},close:this.dropDownClose.bind(this),open:this.dropDownOpen.bind(this),beforeItemRender:this.beforeDropDownItemRender.bind(this)}),t.isStringTemplate=!0,t.createElement=i.parent.createElement,t.appendTo(n.element),n.element.tabIndex=-1,document.getElementById(t.element.id+"-popup").setAttribute("aria-owns",this.parent.getID()),t},n.prototype.onPopupOverlay=function(){Object(r.isNullOrUndefined)(this.popupOverlay)||(Object(r.closest)(this.popupOverlay,".e-popup-container").style.display="none",this.popupOverlay.style.display="none",Object(r.removeClass)([this.popupOverlay],"e-popup-overlay"))},n.prototype.setIsModel=function(n){Object(r.closest)(n,".e-popup-container")?(n.parentElement.style.display="flex",this.popupOverlay=n.nextElementSibling,this.popupOverlay.style.display="block",Object(r.addClass)([this.popupOverlay],"e-popup-overlay")):(this.popupContainer=this.parent.createElement("div",{className:"e-rte-modal-popup e-popup-container e-center"}),n.parentNode.insertBefore(this.popupContainer,n),this.popupContainer.appendChild(n),this.popupContainer.style.zIndex=n.style.zIndex,this.popupContainer.style.display="flex",n.style.position="relative",Object(r.addClass)([n],"e-popup-modal"),this.popupOverlay=this.parent.createElement("div",{className:"e-popup-overlay"}),this.popupOverlay.style.zIndex=(parseInt(n.style.zIndex,null)-1).toString(),this.popupOverlay.style.display="block",this.popupContainer.appendChild(this.popupOverlay),r.EventHandler.add(this.popupOverlay,"click touchmove",this.onPopupOverlay,this))},n.prototype.paletteSelection=function(n,t){var f=n.element.querySelector(".e-control.e-colorpicker"),i=[].slice.call(Object(r.selectAll)(".e-tile",f.parentElement)),u;Object(r.removeClass)(i,"e-selected");u=t.querySelector("."+b).style.borderBottomColor;i.filter(function(n){n.style.backgroundColor===u&&Object(r.addClass)([n],"e-selected")})},n.prototype.renderColorPickerDropDown=function(n,t,i){var o=this,u=this,c=b+" "+lh+(this.parent.inlineMode?" "+th:""),e,s,h,f;return c+=" "+("backgroundcolor"===t?ga:da),s=u.parent.createElement("span",{className:gr}),h=u.parent.createElement("span",{className:n.cssClass}),h.style.borderBottomColor="backgroundcolor"===t?u.parent.backgroundColor.default:u.parent.fontColor.default,s.appendChild(h),f=new ny.DropDownButton({target:i.element.parentElement,cssClass:c,enablePersistence:this.parent.enablePersistence,enableRtl:this.parent.enableRtl,beforeOpen:function(t){var i,o,h,c,s;!u.parent.readonly&&u.parent.enabled?(i=t.event?t.event.target:null,(u.currentElement=f.element,u.currentDropdown=f,u.paletteSelection(t,u.currentElement),t.event&&"click"===t.event.type&&(i.classList.contains(gr)||i.parentElement.classList.contains(gr)))?(t.cancel=!0,o=i.classList.contains(b)?i.style.borderBottomColor:i.querySelector("."+b).style.borderBottomColor,u.parent.notify(rt,{}),h=(e=u.parent.formatter.editorManager.nodeSelection.getRange(u.parent.contentModule.getDocument())).startContainer.parentNode,("TD"===e.startContainer.nodeName||"TH"===e.startContainer.nodeName||Object(r.closest)(e.startContainer.parentNode,"td,th")||u.parent.iframeSettings.enable&&!tt(h.ownerDocument.querySelector("body"),"e-lib"))&&e.collapsed?u.parent.notify(hr,{item:{command:n.command,subCommand:n.subCommand,value:o}}):u.parent.notify(sr,{item:{command:n.command,subCommand:n.subCommand,value:o}})):(c=t.element.querySelector(".e-control.e-colorpicker"),s=Object(r.getInstance)(c,et.ColorPicker),s.showButtons=!t.element.querySelector(".e-color-palette"),s.dataBind(),t.element.onclick=function(n){n.target.classList.contains("e-cancel")&&f.toggle()})):t.cancel=!0},open:function(n){var u,t;o.setColorPickerContentWidth(i);t=n.element.querySelector(".e-control.e-colorpicker");(u=n.element.querySelector(".e-color-palette")?t.parentElement.querySelector(".e-palette"):t.parentElement.querySelector("e-handler"))&&u.focus();r.Browser.isDevice&&o.popupModal(n.element.parentElement);o.pickerRefresh(n)},beforeClose:function(t){var i=t.event?t.event.target:null,f;t.event&&"click"===t.event.type&&(i.classList.contains(gr)||i.parentElement.classList.contains(gr))&&(f=i.classList.contains(b)?i.style.borderBottomColor:i.querySelector("."+b).style.borderBottomColor,("TD"===(e=u.parent.formatter.editorManager.nodeSelection.getRange(u.parent.contentModule.getDocument())).startContainer.nodeName||"TH"===e.startContainer.nodeName||Object(r.closest)(e.startContainer.parentNode,"td,th"))&&e.collapsed?u.parent.notify(hr,{item:{command:n.command,subCommand:n.subCommand,value:f}}):u.parent.notify(sr,{item:{command:n.command,subCommand:n.subCommand,value:f}}))},close:function(n){u.parent.notify(rt,{});var t=Object(r.closest)(n.element.parentElement,".e-popup-container");t&&(t.style.display="none",t.lastElementChild.style.display="none",Object(r.removeClass)([t.lastElementChild],"e-popup-overlay"));r.Browser.isDevice&&!Object(r.isNullOrUndefined)(t)&&Object(r.detach)(t)}}),f.isStringTemplate=!0,f.createElement=u.parent.createElement,f.appendTo(n.element),document.getElementById(f.element.id+"-popup").setAttribute("aria-owns",this.parent.getID()),f.element.insertBefore(s,f.element.querySelector(".e-caret")),n.element.tabIndex=-1,f.element.removeAttribute("type"),f.element.onmousedown=function(){u.parent.notify(ht,{})},f.element.onkeydown=function(){u.parent.notify(ht,{})},f},n.prototype.pickerRefresh=function(n){if("Picker"===this.parent.backgroundColor.mode){var t=n.element.parentElement;t.style.width=(t.offsetWidth+5).toString()+"px";Object(r.getInstance)(t,ft.Popup).refreshPosition(t);t.style.width=(t.offsetWidth-5).toString()+"px"}},n.prototype.popupModal=function(n){var t=Object(r.getInstance)(n,ft.Popup);t.relateTo=document.body;t.position={X:0,Y:0};t.targetType="container";t.collision={X:"fit",Y:"fit"};t.offsetY=4;t.dataBind();this.setIsModel(n)},n.prototype.setColorPickerContentWidth=function(n){var t=n.element.nextSibling,i;"0px"===t.style.width&&(t.style.width="",i=parseInt(getComputedStyle(t).borderBottomWidth,10),t.style.width=Object(r.formatUnit)(t.children[0].offsetWidth+i+i))},n.prototype.renderColorPicker=function(n,t){var u=this,i=this;return this.colorPicker=new et.ColorPicker({enablePersistence:this.parent.enablePersistence,enableRtl:this.parent.enableRtl,inline:!0,created:function(){var n="backgroundcolor"===t?i.parent.backgroundColor.default:i.parent.fontColor.default;u.colorPicker.setProperties({value:n})},mode:"backgroundcolor"===t?i.parent.backgroundColor.mode:i.parent.fontColor.mode,modeSwitcher:"backgroundcolor"===t?i.parent.backgroundColor.modeSwitcher:i.parent.fontColor.modeSwitcher,beforeTileRender:function(n){n.element.classList.add(nv);n.element.classList.add(bv);""===n.value&&n.element.classList.add(kv)},change:function(t){var f=t.currentValue.rgba,u;t.item={command:n.command,subCommand:n.subCommand,value:f};i.parent.notify(rt,{});i.currentElement.querySelector("."+b).style.borderBottomColor=f;u=i.parent.formatter.editorManager.nodeSelection.getRange(i.parent.contentModule.getDocument());("TD"===u.startContainer.nodeName||"TH"===u.startContainer.nodeName||Object(r.closest)(u.startContainer.parentNode,"td,th"))&&u.collapsed?i.parent.notify(hr,t):i.parent.notify(sr,t);i.currentDropdown.toggle()},beforeModeSwitch:function(n){u.colorPicker.showButtons="Palette"!==n.mode}}),this.colorPicker.isStringTemplate=!0,this.colorPicker.columns="backgroundcolor"===t?this.parent.backgroundColor.columns:this.parent.fontColor.columns,this.colorPicker.presetColors="backgroundcolor"===t?this.parent.backgroundColor.colorCode:this.parent.fontColor.colorCode,this.colorPicker.cssClass="backgroundcolor"===t?iv:tv,this.colorPicker.createElement=this.parent.createElement,this.colorPicker.appendTo(document.body.querySelector(n.target)),this.colorPicker},n.prototype.renderPanel=function(){this.getPanel().classList.add(wu)},n.prototype.getPanel=function(){return this.toolbarPanel},n.prototype.setPanel=function(n){this.toolbarPanel=n},n}(),rc=function(){function n(n,t){this.tools={};this.parent=n;this.locator=t;this.renderFactory=this.locator.getService("rendererFactory");this.addEventListener();this.parent.toolbarSettings&&Object.keys(this.parent.toolbarSettings.itemConfigs).length>0?Object(r.extend)(this.tools,tu,ko(this.parent.toolbarSettings.itemConfigs),!0):this.tools=tu}return n.prototype.addEventListener=function(){this.parent.on(kt,this.setRtl,this);this.parent.on(h,this.removeEventListener,this)},n.prototype.removeEventListener=function(){this.parent.off(kt,this.setRtl);this.parent.off(h,this.removeEventListener)},n.prototype.setRtl=function(n){Object(r.isNullOrUndefined)(this.toolbarObj)||this.toolbarObj.setProperties({enableRtl:n.enableRtl})},n.prototype.getTemplateObject=function(n,t){var i;switch(n){case"fontcolor":case"backgroundcolor":i="span";break;default:i="button"}return{command:this.tools[n.toLocaleLowerCase()].command,subCommand:this.tools[n.toLocaleLowerCase()].subCommand,template:this.parent.createElement(i,{id:this.parent.getID()+"_"+t+"_"+this.tools[n.toLocaleLowerCase()].id}).outerHTML,tooltipText:bo(n,this.locator)}},n.prototype.getObject=function(n,t){var i=n.toLowerCase();if(-1!==kh.indexOf(i))return this.getTemplateObject(i,t);switch(i){case"|":return{type:"Separator"};case"-":return{type:"Separator",cssClass:aa};default:return{id:this.parent.getID()+"_"+t+"_"+this.tools[i.toLocaleLowerCase()].id,prefixIcon:this.tools[i.toLocaleLowerCase()].icon,tooltipText:bo(i,this.locator),command:this.tools[i.toLocaleLowerCase()].command,subCommand:this.tools[i.toLocaleLowerCase()].subCommand}}},n.prototype.getItems=function(n,t){var i=this;if(this.parent.toolbarSettings.items.length<1)return[];for(var u=[],o=function(n){switch(typeof n){case"string":u.push(s.getObject(n,t));break;default:if(!Object(r.isNullOrUndefined)(n.click)){var f=n,e=f.click;f.click=function(){f.undo&&0===i.parent.formatter.getUndoRedoStack().length&&i.parent.formatter.saveData();e.call(i);f.undo&&i.parent.formatter.saveData()}}u.push(n)}},s=this,f=0,e=n;f<e.length;f++)o(e[f]);return u},n.prototype.getToolbarOptions=function(n){return{target:n.target,rteToolbarObj:this,items:this.getItems(n.items,n.container),overflowMode:n.mode,enablePersistence:this.parent.enablePersistence,enableRtl:this.parent.enableRtl}},n.prototype.render=function(n){this.toolbarRenderer=this.renderFactory.getRenderer(o.Toolbar);this.toolbarRenderer.renderToolbar(this.getToolbarOptions(n))},n}(),uc=function(){function n(n,t){this.parent=n;this.locator=t;this.renderFactory=this.locator.getService("rendererFactory");this.addEventListener()}return n.prototype.initializeInstance=function(){this.toolbarRenderer=this.renderFactory.getRenderer(o.Toolbar)},n.prototype.beforeRender=function(n){var t=n.item;t.cssClass&&Object(r.addClass)([n.element],t.cssClass);"Alignments"!==t.command&&"JustifyLeft"!==t.subCommand&&"JustifyRight"!==t.subCommand&&"JustifyCenter"!==t.subCommand||n.element.setAttribute("title",bo(t.subCommand.toLocaleLowerCase(),this.locator))},n.prototype.dropdownContent=function(n,t,i){return'<span style="display: inline-flex;width:'+("quick"===t?"auto":n)+'" ><span class="e-rte-dropdown-btn-text">'+i+"<\/span><\/span>"},n.prototype.renderDropDowns=function(n){var t=this,i,u;this.initializeInstance();i=n.containerType;u=n.container;kh.forEach(function(f){var e=void 0,o,c,s,l,h,a;if(-1!==po(f,n.items))switch(f){case"formats":if(e=Object(r.select)("#"+t.parent.getID()+"_"+i+"_Formats",u),Object(r.isNullOrUndefined)(e)||e.classList.contains(nt))return;o=t.parent.format.types.slice();o.forEach(function(n){Object.defineProperties(n,{command:{value:"Formats",enumerable:!0},subCommand:{value:n.value,enumerable:!0}})});c=Object(r.isNullOrUndefined)(t.parent.format.default)?o[0].text:t.parent.format.default;t.formatDropDown=t.toolbarRenderer.renderDropDownButton({iconCss:"quick"===i?"e-formats e-icons":"",content:t.dropdownContent(t.parent.format.width,i,"quick"===i?"":ct(o,c,"text","text")),cssClass:ut+" "+dt+" "+ya,itemName:"Formats",items:o,element:e});break;case"fontname":if(e=Object(r.select)("#"+t.parent.getID()+"_"+i+"_FontName",u),Object(r.isNullOrUndefined)(e)||e.classList.contains(nt))return;s=t.parent.fontFamily.items.slice();s.forEach(function(n){Object.defineProperties(n,{command:{value:"Font",enumerable:!0},subCommand:{value:"FontName",enumerable:!0}})});l=Object(r.isNullOrUndefined)(t.parent.fontFamily.default)?s[0].text:t.parent.fontFamily.default;t.fontNameDropDown=t.toolbarRenderer.renderDropDownButton({iconCss:"quick"===i?"e-font-name e-icons":"",content:t.dropdownContent(t.parent.fontFamily.width,i,"quick"===i?"":ct(s,l,"text","text")),cssClass:ut+" "+dt+" "+pa,itemName:"FontName",items:s,element:e});Object(r.isNullOrUndefined)(t.parent.fontFamily.default)||(t.getEditNode().style.fontFamily=t.parent.fontFamily.default);break;case"fontsize":if(e=Object(r.select)("#"+t.parent.getID()+"_"+i+"_FontSize",u),Object(r.isNullOrUndefined)(e)||e.classList.contains(nt))return;h=t.parent.fontSize.items.slice();h.forEach(function(n){Object.defineProperties(n,{command:{value:"Font",enumerable:!0},subCommand:{value:"FontSize",enumerable:!0}})});a=Object(r.isNullOrUndefined)(t.parent.fontSize.default)?h[1].text:t.parent.fontSize.default;t.fontSizeDropDown=t.toolbarRenderer.renderDropDownButton({content:t.dropdownContent(t.parent.fontSize.width,i,wo(ct(h,a.replace(/\s/g,""),"value","text"))),cssClass:ut+" "+dt+" "+wa,itemName:"FontSize",items:h,element:e});Object(r.isNullOrUndefined)(t.parent.fontSize.default)||(t.getEditNode().style.fontSize=t.parent.fontSize.default);break;case"alignments":if(e=Object(r.select)("#"+t.parent.getID()+"_"+i+"_Alignments",u),Object(r.isNullOrUndefined)(e)||e.classList.contains(nt))return;t.alignDropDown=t.toolbarRenderer.renderDropDownButton({iconCss:"e-justify-left e-icons",cssClass:ut+" "+dt,itemName:"Alignments",items:rf,element:e});break;case"align":t.imageAlignmentDropDown(i,u,e);break;case"display":t.imageDisplayDropDown(i,u,e);break;case"tablerows":t.rowDropDown(i,u,e);break;case"tablecolumns":t.columnDropDown(i,u,e);break;case"tablecellverticalalign":t.verticalAlignDropDown(i,u,e);break;case"styles":t.tableStylesDropDown(i,u,e)}})},n.prototype.getUpdateItems=function(n,t){var i=n.slice();return i.forEach(function(n){Object.defineProperties(n,{command:{value:"Format"===t?"Formats":"Font",enumerable:!0},subCommand:{value:"Format"===t?n.value:t,enumerable:!0}})}),i},n.prototype.onPropertyChanged=function(n){for(var f,h,c,w,e,l,a,b,o,v,y,k,t,u,i=n.newProp,s=0,p=Object.keys(i);s<p.length;s++)switch(p[s]){case"fontFamily":if(this.fontNameDropDown)for(f=0,h=Object.keys(i.fontFamily);f<h.length;f++)switch(h[f]){case"default":case"width":c=this.fontNameDropDown.items;t=Object(r.isNullOrUndefined)(Object(r.closest)(this.fontNameDropDown.element,"."+bu))?"toolbar":"quick";w=Object(r.isNullOrUndefined)(this.parent.fontFamily.default)?c[0].text:this.parent.fontFamily.default;u=this.dropdownContent(this.parent.fontFamily.width,t,"quick"===t?"":ct(c,w,"text","text"));this.fontNameDropDown.setProperties({content:u});Object(r.isNullOrUndefined)(this.parent.fontFamily.default)?this.getEditNode().style.removeProperty("font-family"):this.getEditNode().style.fontFamily=this.parent.fontFamily.default;break;case"items":this.fontNameDropDown.setProperties({items:this.getUpdateItems(i.fontFamily.items,"FontName")})}break;case"fontSize":if(this.fontSizeDropDown)for(e=0,l=Object.keys(i.fontSize);e<l.length;e++)switch(l[e]){case"default":case"width":a=this.fontSizeDropDown.items;t=Object(r.isNullOrUndefined)(Object(r.closest)(this.fontSizeDropDown.element,"."+bu))?"toolbar":"quick";b=Object(r.isNullOrUndefined)(this.parent.fontSize.default)?a[1].text:this.parent.fontSize.default;u=this.dropdownContent(this.parent.fontSize.width,t,wo(ct(a,b.replace(/\s/g,""),"value","text")));this.fontSizeDropDown.setProperties({content:u});Object(r.isNullOrUndefined)(this.parent.fontSize.default)?this.getEditNode().style.removeProperty("font-size"):this.getEditNode().style.fontSize=this.parent.fontSize.default;break;case"items":this.fontSizeDropDown.setProperties({items:this.getUpdateItems(i.fontSize.items,"FontSize")})}break;case"format":if(this.formatDropDown)for(o=0,v=Object.keys(i.format);o<v.length;o++)switch(v[o]){case"default":case"width":y=this.formatDropDown.items;t=Object(r.isNullOrUndefined)(Object(r.closest)(this.formatDropDown.element,"."+bu))?"toolbar":"quick";k=Object(r.isNullOrUndefined)(this.parent.format.default)?y[0].text:this.parent.format.default;u=this.dropdownContent(this.parent.format.width,t,"quick"===t?"":ct(y,k,"text","text"));this.formatDropDown.setProperties({content:u});break;case"types":this.formatDropDown.setProperties({items:this.getUpdateItems(i.format.types,"Format")})}}},n.prototype.getEditNode=function(){return this.parent.contentModule.getEditPanel()},n.prototype.rowDropDown=function(n,t,i){(i=Object(r.select)("#"+this.parent.getID()+"_"+n+"_TableRows",t)).classList.contains(nt)||(this.tableRowsDropDown=this.toolbarRenderer.renderDropDownButton({iconCss:"e-table-rows e-icons",cssClass:ut+" "+dt+" "+ei,itemName:"TableRows",items:lo,element:i}))},n.prototype.columnDropDown=function(n,t,i){(i=Object(r.select)("#"+this.parent.getID()+"_"+n+"_TableColumns",t)).classList.contains(nt)||(this.tableColumnsDropDown=this.toolbarRenderer.renderDropDownButton({iconCss:"e-table-columns e-icons",cssClass:ut+" "+dt+" "+ei,itemName:"TableColumns",items:ao,element:i}))},n.prototype.verticalAlignDropDown=function(n,t,i){(i=Object(r.select)("#"+this.parent.getID()+"_"+n+"_TableCellVerticalAlign",t)).classList.contains(nt)||(this.tableCellVerticalAlignDropDown=this.toolbarRenderer.renderDropDownButton({iconCss:"e-table-cell-ver-align e-icons",cssClass:ut+" "+dt+" "+ei,itemName:"TableCellVerticalAlign",items:vo,element:i}))},n.prototype.imageDisplayDropDown=function(n,t,i){(i=Object(r.select)("#"+this.parent.getID()+"_"+n+"_Display",t)).classList.contains(nt)||(this.displayDropDown=this.toolbarRenderer.renderDropDownButton({iconCss:"e-display e-icons",cssClass:ut+" "+dt+" "+ei,itemName:"Display",items:co,element:i}))},n.prototype.imageAlignmentDropDown=function(n,t,i){(i=Object(r.select)("#"+this.parent.getID()+"_"+n+"_Align",t)).classList.contains(nt)||(this.imageAlignDropDown=this.toolbarRenderer.renderDropDownButton({iconCss:"e-justify-left e-icons",cssClass:ut+" "+ro+" "+ei,itemName:"Align",items:cb,element:i}))},n.prototype.tableStylesDropDown=function(n,t,i){(i=Object(r.select)("#"+this.parent.getID()+"_"+n+"_Styles",t)).classList.contains(nt)||(this.imageAlignDropDown=this.toolbarRenderer.renderDropDownButton({iconCss:"e-style e-icons",cssClass:ut+" "+ro+" "+ei,itemName:"Styles",items:this.parent.tableSettings.styles,element:i}))},n.prototype.removeDropDownClasses=function(n){Object(r.removeClass)([n],[nt,ut,ro,dt])},n.prototype.destroyDropDowns=function(){this.formatDropDown&&(this.removeDropDownClasses(this.formatDropDown.element),this.formatDropDown.destroy());this.fontNameDropDown&&(this.removeDropDownClasses(this.fontNameDropDown.element),this.fontNameDropDown.destroy());this.fontSizeDropDown&&(this.removeDropDownClasses(this.fontSizeDropDown.element),this.fontSizeDropDown.destroy());this.alignDropDown&&(this.removeDropDownClasses(this.alignDropDown.element),this.alignDropDown.destroy());this.imageAlignDropDown&&(this.removeDropDownClasses(this.imageAlignDropDown.element),this.imageAlignDropDown.destroy());this.displayDropDown&&(this.removeDropDownClasses(this.displayDropDown.element),this.displayDropDown.destroy());this.tableRowsDropDown&&(this.removeDropDownClasses(this.tableRowsDropDown.element),this.tableRowsDropDown.destroy());this.tableColumnsDropDown&&(this.removeDropDownClasses(this.tableColumnsDropDown.element),this.tableColumnsDropDown.destroy());this.tableCellVerticalAlignDropDown&&(this.removeDropDownClasses(this.tableCellVerticalAlignDropDown.element),this.tableCellVerticalAlignDropDown.destroy())},n.prototype.setRtl=function(n){this.formatDropDown&&this.formatDropDown.setProperties({enableRtl:n.enableRtl});this.fontNameDropDown&&this.fontNameDropDown.setProperties({enableRtl:n.enableRtl});this.fontSizeDropDown&&this.fontSizeDropDown.setProperties({enableRtl:n.enableRtl});this.alignDropDown&&this.alignDropDown.setProperties({enableRtl:n.enableRtl});this.imageAlignDropDown&&this.imageAlignDropDown.setProperties({enableRtl:n.enableRtl});this.displayDropDown&&this.displayDropDown.setProperties({enableRtl:n.enableRtl})},n.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(pf,this.beforeRender,this),this.parent.on(wt,this.onIframeMouseDown,this),this.parent.on(kt,this.setRtl,this),this.parent.on(h,this.removeEventListener,this),this.parent.on(y,this.onPropertyChanged,this))},n.prototype.onIframeMouseDown=function(){uu(document,"mousedown")},n.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(wt,this.onIframeMouseDown),this.parent.off(kt,this.setRtl),this.parent.off(pf,this.beforeRender),this.parent.off(h,this.removeEventListener),this.parent.off(y,this.onPropertyChanged))},n}(),fc=function(){function n(){this.services={}}return n.prototype.register=function(n,t){Object(r.isNullOrUndefined)(this.services[n])&&(this.services[n]=t)},n.prototype.getService=function(n){if(Object(r.isNullOrUndefined)(this.services[n]))throw"The service "+n+" is not registered";return this.services[n]},n}(),ec=function(){function n(){this.rendererMap={}}return n.prototype.addRenderer=function(n,t){var i=Object(r.getEnumValue)(o,n);Object(r.isNullOrUndefined)(this.rendererMap[i])&&(this.rendererMap[i]=t)},n.prototype.getRenderer=function(n){var t=Object(r.getEnumValue)(o,n);if(Object(r.isNullOrUndefined)(this.rendererMap[t]))throw"The renderer "+t+" is not found";return this.rendererMap[t]},n}(),iy=function(){function n(n){this.parent=n;this.addEventListener();this.serviceLocator=new fc;this.serviceLocator.register("rendererFactory",new ec)}return n.prototype.addEventListener=function(){this.parent.on(hf,this.toolbarClick,this);this.parent.on(ui,this.dropDownSelect,this);this.parent.on(sr,this.renderSelection,this);this.parent.on(h,this.removeEventListener,this)},n.prototype.toolbarClick=function(n){if(!Object(r.isNullOrUndefined)(n.item)){if(!Object(r.isNullOrUndefined)(n.item.controlParent)){var t=n.item.controlParent.activeEle;t&&(t.tabIndex=-1)}this.parent.notify(lf,n);this.parent.notify(af,n)}},n.prototype.dropDownSelect=function(n){if(this.parent.notify(rt,{}),!document.body.contains(document.body.querySelector(".e-rte-quick-toolbar"))||!n.item||"Images"!==n.item.command&&"Display"!==n.item.command&&"Table"!==n.item.command){var t=n.item.controlParent&&this.parent.quickToolbarModule&&this.parent.quickToolbarModule.tableQTBar&&this.parent.quickToolbarModule.tableQTBar.element.contains(n.item.controlParent.element)?"Table":null;this.parent.formatter.process(this.parent,n,n.originalEvent,t)}this.parent.notify(ht,{})},n.prototype.renderSelection=function(n){this.parent.notify(rt,{});this.parent.formatter.process(this.parent,n,n.originalEvent,null);this.parent.notify(ht,{})},n.prototype.removeEventListener=function(){this.parent.off(hf,this.toolbarClick);this.parent.off(ui,this.dropDownSelect);this.parent.off(sr,this.renderSelection);this.parent.off(h,this.removeEventListener)},n}(),gb=function(){function n(n,t){var i;this.parent=n;this.isToolbar=!1;this.locator=t;this.isTransformChild=!1;this.renderFactory=this.locator.getService("rendererFactory");i=this.parent;rf.forEach(function(n,t){rf[t].text=iu(i,hb,rf[t])});co.forEach(function(n,t){co[t].text=iu(i,lb,co[t])});lo.forEach(function(n,t){lo[t].text=iu(i,ab,lo[t])});ao.forEach(function(n,t){ao[t].text=iu(i,vb,ao[t])});vo.forEach(function(n,t){vo[t].text=iu(i,yb,vo[t])});yo.forEach(function(n,t){yo[t].text=iu(i,pb,yo[t])});this.renderFactory.addRenderer(o.Toolbar,new ty(this.parent));this.toolbarRenderer=this.renderFactory.getRenderer(o.Toolbar);this.baseToolbar=new rc(this.parent,this.locator);this.addEventListener();this.parent.toolbarSettings&&Object.keys(this.parent.toolbarSettings.itemConfigs).length>0?Object(r.extend)(this.tools,tu,ko(this.parent.toolbarSettings.itemConfigs),!0):this.tools=tu}return n.prototype.initializeInstance=function(){this.contentRenderer=this.renderFactory.getRenderer(o.Content);this.editableElement=this.contentRenderer.getEditPanel();this.editPanel=this.contentRenderer.getPanel()},n.prototype.toolbarBindEvent=function(){this.parent.inlineMode.enable||(this.keyBoardModule=new r.KeyboardEvents(this.getToolbarElement(),{keyAction:this.toolBarKeyDown.bind(this),keyConfigs:this.parent.formatter.keyConfig,eventName:"keydown"}))},n.prototype.toolBarKeyDown=function(n){switch(n.action){case"escape":this.parent.contentModule.getEditPanel().focus()}},n.prototype.createToolbarElement=function(){this.tbElement=this.parent.createElement("div",{id:this.parent.getID()+"_toolbar"});!r.Browser.isDevice&&this.parent.inlineMode.enable&&a()||(this.parent.toolbarSettings.enableFloating&&!this.parent.inlineMode.enable?(this.tbWrapper=this.parent.createElement("div",{id:this.parent.getID()+"_toolbar_wrapper",innerHTML:this.tbElement.outerHTML,className:uo}),this.tbElement=this.tbWrapper.firstElementChild,this.parent.element.insertBefore(this.tbWrapper,this.editPanel)):this.parent.element.insertBefore(this.tbElement,this.editPanel))},n.prototype.getToolbarMode=function(){var n;switch(this.parent.toolbarSettings.type){case pt.Expand:n="Extended";break;default:n="MultiRow"}return n},n.prototype.checkToolbarResponsive=function(n){return!(!r.Browser.isDevice||a())&&(this.baseToolbar.render({container:this.parent.inlineMode.enable?"quick":"toolbar",items:this.parent.toolbarSettings.items,mode:"MultiRow",target:n}),Object(r.addClass)([n],["e-rte-tb-mobile"]),this.parent.inlineMode.enable?this.addFixedTBarClass():Object(r.addClass)([n],[va]),this.wireEvents(),this.dropDownModule.renderDropDowns({container:n,containerType:this.parent.inlineMode.enable?"quick":"toolbar",items:this.parent.toolbarSettings.items}),this.parent.notify(cu,{container:this.tbElement,containerType:this.parent.inlineMode.enable?"quick":"toolbar",items:this.parent.toolbarSettings.items}),!0)},n.prototype.checkIsTransformChild=function(){this.isTransformChild=!1;for(var t=Object(r.selectAll)('[style*="transform"]',document),n=0;n<t.length;n++)if(!Object(r.isNullOrUndefined)(t[n].contains)&&t[n].contains(this.parent.element)){this.isTransformChild=!0;break}},n.prototype.toggleFloatClass=function(n){var t,u,e=!1,s=!1,f=this.parent.floatingToolbarOffset,c,l,a,v,o;if(n&&this.parent.iframeSettings.enable&&this.parent.inputElement.ownerDocument===n.target?u=n.target.body:n&&n.target!==document?u=n.target:(e=!0,u=document.body),c=this.getToolbarHeight()+this.getExpandTBarPopHeight(),this.isTransformChild){t=0;l=0;a=this.parent.element.offsetHeight;e&&(v=window.getComputedStyle(u),l=parseFloat(v.marginTop.split("px")[0])+parseFloat(v.paddingTop.split("px")[0]));var i=this.parent.element.getBoundingClientRect().top,p=r.Browser.isMSPointer&&e?window.pageYOffset:u.parentElement.scrollTop,y=u.getBoundingClientRect(),h=e?y.top+p:y.top;i>h+f||i<-a||i<0&&!(i-(e?0:h)+a>c+f)?(s=!1,Object(r.removeClass)([this.tbElement],[to])):i<h+f&&(t=i<0?-i+h:h-i,t=e?t-l:t,Object(r.addClass)([this.tbElement],[to]),s=!0)}else{if(o=this.parent.element.getBoundingClientRect(),window.innerHeight<o.top)return;t=n&&n.target!==document?u.getBoundingClientRect().top:0;o.bottom<f+c+t||o.bottom<0||o.top>f+t?s=!1:o.top<f&&(s=!0)}s?(Object(r.addClass)([this.tbElement],[no]),Object(r.setStyleAttribute)(this.tbElement,{width:this.parent.element.offsetWidth+"px",top:f+t+"px"})):(Object(r.removeClass)([this.tbElement],[no]),Object(r.setStyleAttribute)(this.tbElement,{top:"0px",width:"100%"}))},n.prototype.renderToolbar=function(){if(this.initializeInstance(),this.createToolbarElement(),!this.checkToolbarResponsive(this.tbElement)){this.parent.inlineMode.enable?this.parent.notify(le,{}):(this.baseToolbar.render({container:"toolbar",items:this.parent.toolbarSettings.items,mode:this.getToolbarMode(),target:this.tbElement}),this.parent.inlineMode.enable||(this.parent.toolbarSettings.enableFloating&&(this.checkIsTransformChild(),this.toggleFloatClass()),this.parent.toolbarSettings.type===pt.Expand&&Object(r.addClass)([this.parent.element],[gs])));this.wireEvents();this.parent.inlineMode.enable&&!a()&&this.addFixedTBarClass();this.parent.inlineMode.enable||(this.dropDownModule.renderDropDowns({container:this.tbElement,containerType:"toolbar",items:this.parent.toolbarSettings.items}),this.parent.notify(cu,{container:this.tbElement,containerType:"toolbar",items:this.parent.toolbarSettings.items}),this.refreshToolbarOverflow());var n=this.parent.element.querySelector(".e-rte-srctextarea"),t=this.parent.element.querySelector(".e-source-content");(this.parent.iframeSettings.enable||Object(r.isNullOrUndefined)(n)||"block"!==n.style.display)&&(!this.parent.iframeSettings.enable||Object(r.isNullOrUndefined)(t)||"block"!==t.style.display)||(this.parent.notify(ir,{targetItem:"SourceCode",updateItem:"Preview",baseToolbar:this.parent.getBaseToolbarObject()}),this.parent.disableToolbarItem(this.parent.toolbarSettings.items))}},n.prototype.addFixedTBarClass=function(){Object(r.addClass)([this.tbElement],[ds])},n.prototype.removeFixedTBarClass=function(){Object(r.removeClass)([this.tbElement],[ds])},n.prototype.showFixedTBar=function(){Object(r.addClass)([this.tbElement],[rh]);r.Browser.isIos&&Object(r.addClass)([this.tbElement],[ah])},n.prototype.hideFixedTBar=function(){this.isToolbar?this.isToolbar=!1:Object(r.removeClass)([this.tbElement],[rh,ah])},n.prototype.updateItem=function(n){var i=this.tools[n.updateItem.toLocaleLowerCase()],t=ff(uf(this.tools[n.targetItem.toLocaleLowerCase()].subCommand),n.baseToolbar.toolbarObj.items)[0],u;Object(r.isNullOrUndefined)(t)?this.addTBarItem(n,0):(u=this.parent.inlineMode.enable?"_quick_":"_toolbar_",n.baseToolbar.toolbarObj.items[t].id=this.parent.getID()+u+i.id,n.baseToolbar.toolbarObj.items[t].prefixIcon=i.icon,n.baseToolbar.toolbarObj.items[t].tooltipText=i.tooltip,n.baseToolbar.toolbarObj.items[t].subCommand=i.subCommand,n.baseToolbar.toolbarObj.dataBind())},n.prototype.updateToolbarStatus=function(n){this.tbElement&&(!this.parent.inlineMode.enable||!a()&&r.Browser.isDevice)&&dh({args:n,dropDownModule:this.dropDownModule,parent:this.parent,tbElements:Object(r.selectAll)("."+oi,this.tbElement),tbItems:this.baseToolbar.toolbarObj.items},!!this.parent.inlineMode.enable)},n.prototype.fullScreen=function(n){this.parent.fullScreenModule.showFullScreen(n)},n.prototype.hideScreen=function(n){this.parent.fullScreenModule.hideFullScreen(n)},n.prototype.getBaseToolbar=function(){return this.baseToolbar},n.prototype.addTBarItem=function(n,t){n.baseToolbar.toolbarObj.addItems([n.baseToolbar.getObject(n.updateItem,"toolbar")],t)},n.prototype.enableTBarItems=function(n,t,i,u){var o=ff(uf(t),n.toolbarObj.items),f,e;for(this.tbItems=Object(r.selectAll)("."+oi,n.toolbarObj.element),f=0;f<o.length;f++)e=this.tbItems[o[f]],e&&n.toolbarObj.enableItems(e,i);Object(r.select)(".e-rte-srctextarea",this.parent.element)||u||ru(n,this.parent.formatter.editorManager.undoRedoManager.getUndoStatus())},n.prototype.removeTBarItems=function(n){var i,t;for(Object(r.isNullOrUndefined)(this.baseToolbar.toolbarObj)&&(this.baseToolbar=this.parent.getBaseToolbarObject()),i=ff(uf(n),this.baseToolbar.toolbarObj.items),this.tbItems=this.parent.inlineMode.enable?Object(r.selectAll)("."+oi,this.baseToolbar.toolbarObj.element):Object(r.selectAll)("."+oi,this.parent.element),t=0;t<i.length;t++)this.baseToolbar.toolbarObj.removeItems(this.tbItems[i[t]])},n.prototype.getExpandTBarPopHeight=function(){var t=0,n;return this.parent.toolbarSettings.type===pt.Expand&&this.tbElement.classList.contains("e-extended-toolbar")&&(n=Object(r.select)(".e-toolbar-extended",this.tbElement),n&&this.tbElement.classList.contains("e-expand-open")||n&&n.classList.contains("e-popup-open")?(Object(r.addClass)([n],[uh]),t+=n.offsetHeight,Object(r.removeClass)([n],[uh])):Object(r.removeClass)([this.tbElement],[si])),t},n.prototype.getToolbarHeight=function(){return this.tbElement.offsetHeight},n.prototype.getToolbarElement=function(){return Object(r.select)("."+wu,this.parent.element)},n.prototype.refreshToolbarOverflow=function(){this.baseToolbar.toolbarObj.refreshOverflow()},n.prototype.isToolbarDestroyed=function(){return this.baseToolbar.toolbarObj&&!this.baseToolbar.toolbarObj.isDestroyed},n.prototype.destroyToolbar=function(){if(this.isToolbarDestroyed()){this.parent.unWireScrollElementsEvents();this.unWireEvents();this.parent.notify(vf,{});this.dropDownModule.destroyDropDowns();this.baseToolbar.toolbarObj.destroy();this.removeEventListener();Object(r.removeClass)([this.parent.element],[gs]);var n=Object(r.select)("."+uo,this.parent.element),t=Object(r.select)("."+wu,this.parent.element);Object(r.isNullOrUndefined)(n)?Object(r.isNullOrUndefined)(t)||Object(r.detach)(t):Object(r.detach)(n)}},n.prototype.destroy=function(){this.isToolbarDestroyed()&&(this.destroyToolbar(),this.keyBoardModule&&this.keyBoardModule.destroy())},n.prototype.scrollHandler=function(n){this.parent.inlineMode.enable||this.parent.toolbarSettings.enableFloating&&this.getDOMVisibility(this.tbElement)&&this.toggleFloatClass(n.args)},n.prototype.getDOMVisibility=function(n){return!(!n.offsetParent&&0===n.offsetWidth&&0===n.offsetHeight)},n.prototype.mouseDownHandler=function(){r.Browser.isDevice&&this.parent.inlineMode.enable&&!a()&&this.showFixedTBar()},n.prototype.focusChangeHandler=function(){r.Browser.isDevice&&this.parent.inlineMode.enable&&!a()&&(this.isToolbar=!1,this.hideFixedTBar())},n.prototype.dropDownBeforeOpenHandler=function(){this.isToolbar=!0},n.prototype.tbFocusHandler=function(){var i=document.activeElement,u=Object(r.closest)(i,".e-rte-toolbar"),t,n;if(i===this.parent.getToolbarElement()||u===this.parent.getToolbarElement())for(t=this.parent.getToolbarElement().querySelectorAll(".e-expended-nav"),n=0;n<t.length;n++)Object(r.isNullOrUndefined)(this.parent.getToolbarElement().querySelector(".e-insert-table-btn"))?t[n].setAttribute("tabindex","0"):t[n].setAttribute("tabindex","1")},n.prototype.tbKeydownHandler=function(n){(n.target.classList.contains("e-dropdown-btn")||n.target.getAttribute("id")===this.parent.getID()+"_toolbar_CreateTable")&&n.target.setAttribute("tabindex","0")},n.prototype.toolbarMouseDownHandler=function(n){var t=Object(r.closest)(n.target,".e-hor-nav");t&&this.parent.toolbarSettings.type===pt.Expand&&!Object(r.isNullOrUndefined)(t)?t.classList.contains("e-nav-active")?(Object(r.addClass)([this.tbElement],[si]),this.parent.setContentHeight("toolbar",!0)):(Object(r.removeClass)([this.tbElement],[si]),this.parent.setContentHeight("toolbar",!1)):(r.Browser.isDevice||this.parent.inlineMode.enable)&&(this.isToolbar=!0);Object(r.isNullOrUndefined)(t)&&this.parent.toolbarSettings.type===pt.Expand&&Object(r.removeClass)([this.tbElement],[si])},n.prototype.wireEvents=function(){this.parent.inlineMode.enable&&a()||(r.EventHandler.add(this.tbElement,"click mousedown",this.toolbarMouseDownHandler,this),r.EventHandler.add(this.tbElement,"focusin",this.tbFocusHandler,this),r.EventHandler.add(this.tbElement,"keydown",this.tbKeydownHandler,this))},n.prototype.unWireEvents=function(){r.EventHandler.remove(this.tbElement,"click mousedown",this.toolbarMouseDownHandler);r.EventHandler.remove(this.tbElement,"focusin",this.tbFocusHandler);r.EventHandler.remove(this.tbElement,"keydown",this.tbKeydownHandler)},n.prototype.addEventListener=function(){this.parent.isDestroyed||(this.dropDownModule=new uc(this.parent,this.locator),this.toolbarActionModule=new iy(this.parent),this.parent.on(p,this.renderToolbar,this),this.parent.on(fi,this.scrollHandler,this),this.parent.on(hu,this.toolbarBindEvent,this),this.parent.on(ot,this.updateToolbarStatus,this),this.parent.on(y,this.onPropertyChanged,this),this.parent.on(cf,this.onRefresh,this),this.parent.on(h,this.destroy,this),this.parent.on(lu,this.fullScreen,this),this.parent.on(au,this.hideScreen,this),this.parent.on(ir,this.updateItem,this),this.parent.on(he,this.dropDownBeforeOpenHandler,this),this.parent.on(vs,this.parent.setContentHeight,this.parent),this.parent.on(cr,this.focusChangeHandler,this),this.parent.on(g,this.mouseDownHandler,this),this.parent.on(er,this.mouseDownHandler,this))},n.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(p,this.renderToolbar),this.parent.off(fi,this.scrollHandler),this.parent.off(hu,this.toolbarBindEvent),this.parent.off(ot,this.updateToolbarStatus),this.parent.off(y,this.onPropertyChanged),this.parent.off(h,this.destroy),this.parent.off(lu,this.parent.fullScreenModule.showFullScreen),this.parent.off(au,this.parent.fullScreenModule.hideFullScreen),this.parent.off(ir,this.updateItem),this.parent.off(he,this.dropDownBeforeOpenHandler),this.parent.off(vs,this.parent.setContentHeight),this.parent.off(cr,this.focusChangeHandler),this.parent.off(g,this.mouseDownHandler),this.parent.off(er,this.mouseDownHandler))},n.prototype.onRefresh=function(){this.refreshToolbarOverflow();this.parent.setContentHeight("",!0)},n.prototype.onPropertyChanged=function(n){if(!Object(r.isNullOrUndefined)(n.newProp.inlineMode))for(var t=0,i=Object.keys(n.newProp.inlineMode);t<i.length;t++)switch(i[t]){case"enable":this.refreshToolbar()}n.module===this.getModuleName()&&this.refreshToolbar()},n.prototype.refreshToolbar=function(){Object(r.isNullOrUndefined)(this.baseToolbar.toolbarObj)&&(this.baseToolbar=this.parent.getBaseToolbarObject());var n=Object(r.select)("."+uo,this.parent.element);(Object(r.select)("."+wu,this.parent.element)||n)&&this.destroyToolbar();this.parent.toolbarSettings.enable&&(this.addEventListener(),this.renderToolbar(),this.parent.wireScrollElementsEvents(),Object(r.select)(".e-rte-srctextarea",this.parent.element)||ru(this.baseToolbar,this.parent.formatter.editorManager.undoRedoManager.getUndoStatus()))},n.prototype.getModuleName=function(){return"toolbar"},n}(),nk=(ic=function(n,t){return(ic=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}ic(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),ns=function(n,t,i,r){var f,e=arguments.length,u=e<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r,o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(n,t,i,r);else for(o=n.length-1;o>=0;o--)(f=n[o])&&(u=(e<3?f(u):e>3?f(t,i,u):f(t,i))||u);return e>3&&u&&Object.defineProperty(t,i,u),u},tk={backspace:8,tab:9,enter:13,shift:16,control:17,alt:18,pause:19,capslock:20,space:32,escape:27,pageup:33,pagedown:34,end:35,home:36,leftarrow:37,uparrow:38,rightarrow:39,downarrow:40,insert:45,"delete":46,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,semicolon:186,plus:187,comma:188,minus:189,dot:190,forwardslash:191,graveaccent:192,openbracket:219,backslash:220,closebracket:221,singlequote:222,"]":221,"[":219,"=":187},ts=function(n){function t(t,r){var u=n.call(this,r,t)||this;return u.keyPressHandler=function(n){for(var h,t,c=n.altKey,l=n.ctrlKey,a=n.shiftKey,v=n.which,r=0,e=Object.keys(u.keyConfigs);r<e.length;r++)for(var o=e[r],f=0,s=u.keyConfigs[o].split(",");f<s.length;f++)h=s[f],t=i.getKeyConfigData(h.trim()),c===t.altKey&&l===t.ctrlKey&&a===t.shiftKey&&v===t.keyCode&&(n.action=o);u.keyAction&&u.keyAction(n)},u.bind(),u}var i;return nk(t,n),i=t,t.prototype.destroy=function(){this.unwireEvents();n.prototype.destroy.call(this)},t.prototype.onPropertyChanged=function(){},t.prototype.bind=function(){this.wireEvents()},t.prototype.getModuleName=function(){return"keyboard"},t.prototype.wireEvents=function(){this.element.addEventListener(this.eventName,this.keyPressHandler)},t.prototype.unwireEvents=function(){this.element.removeEventListener(this.eventName,this.keyPressHandler)},t.getKeyConfigData=function(n){if(n in this.configCache)return this.configCache[n];var t=n.toLowerCase().split("+"),r={altKey:-1!==t.indexOf("alt"),ctrlKey:-1!==t.indexOf("ctrl"),shiftKey:-1!==t.indexOf("shift"),keyCode:null};return r.keyCode=t[t.length-1].length>1&&Number(t[t.length-1])?Number(t[t.length-1]):i.getKeyCode(t[t.length-1]),i.configCache[n]=r,r},t.getKeyCode=function(n){return tk[n]||n.toUpperCase().charCodeAt(0)},t.configCache={},ns([Object(r.Property)({})],t.prototype,"keyConfigs",void 0),ns([Object(r.Property)("keyup")],t.prototype,"eventName",void 0),ns([Object(r.Event)()],t.prototype,"keyAction",void 0),t=i=ns([r.NotifyPropertyChanges],t)}(r.Base),oc=function(){function n(n,t){this.tools={};this.parent=n;this.locator=t;this.renderFactory=this.locator.getService("rendererFactory");this.addEventListener();this.parent.toolbarSettings&&Object.keys(this.parent.toolbarSettings.itemConfigs).length>0?Object(r.extend)(this.tools,tu,ko(this.parent.toolbarSettings.itemConfigs),!0):this.tools=tu}return n.prototype.initializeInstance=function(){this.toolbarRenderer=this.renderFactory.getRenderer(o.Toolbar)},n.prototype.renderColorPickerInput=function(n){var t=this,i,u,f,e;this.initializeInstance();f=n.containerType;e=n.container;kh.forEach(function(o){var s,h;if(-1!==po(o,n.items))switch(o){case"fontcolor":i=t.parent.getID()+"_"+f+"_FontColor_Target";s=t.parent.createElement("input");s.id=i;s.classList.add(ba);document.body.appendChild(s);u={cssClass:t.tools[o.toLocaleLowerCase()].icon+" "+b+" "+ch,value:t.tools[o.toLocaleLowerCase()].value,command:t.tools[o.toLocaleLowerCase()].command,subCommand:t.tools[o.toLocaleLowerCase()].subCommand,element:Object(r.select)("#"+t.parent.getID()+"_"+f+"_FontColor",e),target:"#"+i};t.fontColorPicker=t.toolbarRenderer.renderColorPicker(u,"fontcolor");t.fontColorDropDown=t.toolbarRenderer.renderColorPickerDropDown(u,"fontcolor",t.fontColorPicker);break;case"backgroundcolor":i=t.parent.getID()+"_"+f+"_BackgroundColor_Target";h=t.parent.createElement("input");h.id=i;h.classList.add(ka);document.body.appendChild(h);u={cssClass:t.tools[o.toLocaleLowerCase()].icon+" "+b+" "+ch,value:t.tools[o.toLocaleLowerCase()].value,command:t.tools[o.toLocaleLowerCase()].command,subCommand:t.tools[o.toLocaleLowerCase()].subCommand,element:Object(r.select)("#"+t.parent.getID()+"_"+f+"_BackgroundColor",e),target:"#"+i};t.backgroundColorPicker=t.toolbarRenderer.renderColorPicker(u,"backgroundcolor");t.backgroundColorDropDown=t.toolbarRenderer.renderColorPickerDropDown(u,"backgroundcolor",t.backgroundColorPicker)}})},n.prototype.destroy=function(){this.removeEventListener();this.destroyColorPicker()},n.prototype.destroyColorPicker=function(){var n;(this.fontColorPicker&&!this.fontColorPicker.isDestroyed&&this.fontColorPicker.destroy(),this.backgroundColorPicker&&!this.backgroundColorPicker.isDestroyed&&this.backgroundColorPicker.destroy(),this.fontColorDropDown&&!this.fontColorDropDown.isDestroyed)&&((n=this.fontColorDropDown.element.querySelector(".e-rte-color-content"))&&Object(r.detach)(n),this.fontColorDropDown.destroy());this.backgroundColorDropDown&&!this.backgroundColorDropDown.isDestroyed&&((n=this.backgroundColorDropDown.element.querySelector(".e-rte-color-content"))&&Object(r.detach)(n),this.backgroundColorDropDown.destroy())},n.prototype.setRtl=function(n){this.fontColorPicker&&(this.fontColorPicker.setProperties({enableRtl:n.enableRtl}),this.fontColorDropDown.setProperties({enableRtl:n.enableRtl}));this.backgroundColorPicker&&(this.backgroundColorPicker.setProperties({enableRtl:n.enableRtl}),this.backgroundColorDropDown.setProperties({enableRtl:n.enableRtl}))},n.prototype.addEventListener=function(){this.parent.on(ls,this.renderColorPickerInput,this);this.parent.on(kt,this.setRtl,this);this.parent.on(h,this.destroy,this);this.parent.on(vf,this.destroyColorPicker,this);this.parent.on(y,this.onPropertyChanged,this)},n.prototype.onPropertyChanged=function(n){for(var i,f,r,e,t=n.newProp,u=0,o=Object.keys(t);u<o.length;u++)switch(o[u]){case"fontColor":if(this.fontColorPicker)for(i=0,f=Object.keys(t.fontColor);i<f.length;i++)switch(f[i]){case"default":this.fontColorPicker.setProperties({value:t.fontColor.default});this.fontColorDropDown.element.querySelector("."+this.tools.fontcolor.icon).style.borderBottomColor=t.fontColor.default;break;case"mode":this.fontColorPicker.setProperties({mode:t.fontColor.mode});break;case"columns":this.fontColorPicker.setProperties({columns:t.fontColor.columns});break;case"colorCode":this.fontColorPicker.setProperties({presetColors:t.fontColor.colorCode});break;case"modeSwitcher":this.fontColorPicker.setProperties({modeSwitcher:t.fontColor.modeSwitcher})}break;case"backgroundColor":if(this.backgroundColorPicker)for(r=0,e=Object.keys(t.backgroundColor);r<e.length;r++)switch(e[r]){case"default":this.backgroundColorPicker.setProperties({value:t.backgroundColor.default});this.backgroundColorDropDown.element.querySelector("."+this.tools.backgroundcolor.icon).style.borderBottomColor=t.backgroundColor.default;break;case"mode":this.backgroundColorPicker.setProperties({mode:t.backgroundColor.mode});break;case"columns":this.backgroundColorPicker.setProperties({columns:t.backgroundColor.columns});break;case"colorCode":this.backgroundColorPicker.setProperties({presetColors:t.backgroundColor.colorCode});break;case"modeSwitcher":this.backgroundColorPicker.setProperties({modeSwitcher:t.backgroundColor.modeSwitcher})}}},n.prototype.removeEventListener=function(){this.parent.off(ls,this.renderColorPickerInput);this.parent.off(h,this.destroy);this.parent.off(kt,this.setRtl);this.parent.off(vf,this.destroyColorPicker);this.parent.off(y,this.onPropertyChanged)},n}(),ry=function(){function n(n,t){this.parent=n;this.locator=t;this.isDOMElement=!1;this.renderFactory=this.locator.getService("rendererFactory");this.contentRenderer=this.renderFactory.getRenderer(o.Content);this.popupRenderer=this.renderFactory.getRenderer(o.Popup);this.dropDownButtons=new uc(this.parent,this.locator);this.colorPickerObj=new oc(this.parent,this.locator)}return n.prototype.appendPopupContent=function(){this.toolbarElement=this.parent.createElement("div",{className:bu});this.element.appendChild(this.toolbarElement)},n.prototype.render=function(n){var t,i;t="Image"===n.popupType?ha:"Inline"===n.popupType?pr:"";i=Object(r.getUniqueID)(n.popupType+"_Quick_Popup");this.stringItems=n.toolbarItems;this.element=this.parent.createElement("div",{id:i,className:t+" "+b});this.element.setAttribute("aria-owns",this.parent.getID());this.appendPopupContent();this.createToolbar(n.toolbarItems,n.mode);this.popupRenderer.renderPopup(this);this.addEventListener()},n.prototype.createToolbar=function(n,t){this.quickTBarObj=new rc(this.parent,this.locator);this.quickTBarObj.render({container:"quick",target:this.toolbarElement,items:n,mode:t});this.quickTBarObj.toolbarObj.refresh()},n.prototype.setPosition=function(n){var u,f,o=Object(r.closest)(n.target,".e-img-caption"),t=Object(r.isNullOrUndefined)(o)?n.target:o,i,e;Object(r.addClass)([this.toolbarElement],[fh]);i=t.offsetTop;e=window.pageYOffset+n.parentData.top;f=i-n.editTop>n.popHeight?e+n.tBarElementHeight+(i-n.editTop)-n.popHeight-5:n.editTop+n.editHeight-(i+t.offsetHeight)>n.popHeight?e+n.tBarElementHeight+(i-n.editTop)+t.offsetHeight+5:n.y;u=t.offsetWidth>n.popWidth?t.offsetWidth/2-n.popWidth/2+n.parentData.left+t.offsetLeft:n.parentData.left+t.offsetLeft;this.popupObj.position.X=u+n.popWidth>n.parentData.right?n.parentData.right-n.popWidth:u;this.popupObj.position.Y=f>=0?f:n.y+5;this.popupObj.dataBind();Object(r.removeClass)([this.toolbarElement],[fh])},n.prototype.checkCollision=function(n,t,i){for(var f,e,r=n.parentData.top,o=n.windowY+r+n.tBarElementHeight,s=[],s="document"===t?Object(ft.isCollide)(n.popup):Object(ft.isCollide)(n.popup,n.parentElement),u=0;u<s.length;u++)switch(s[u]){case"top":e="document"===t?n.windowY:window.pageYOffset+r+n.tBarElementHeight;break;case"bottom":e="document"===t?"inline"===i?n.y-n.popHeight-10:n.windowHeight-(r+n.tBarElementHeight)>n.popHeight?o-n.windowHeight>n.popHeight?o+(n.windowHeight-r)-n.popHeight:o:n.windowY+(r+n.tBarElementHeight):"IMG"!==n.target.tagName?n.parentData.bottom+window.pageYOffset-n.popHeight-10:n.parentData.bottom+window.pageYOffset-n.popHeight-5;break;case"right":f="inline"===i?n.windowWidth-(n.popWidth+n.bodyRightSpace+10):n.x-n.popWidth;break;case"left":f="inline"===i?0:n.parentData.left}this.popupObj.position.X=f||this.popupObj.position.X;this.popupObj.position.Y=e||this.popupObj.position.Y;this.popupObj.dataBind()},n.prototype.showPopup=function(n,t,i){var u=this,f=Object(r.isBlazor)()?{cancel:!1,targetElement:i}:{popup:this.popupObj,cancel:!1,targetElement:i};this.parent.trigger(ra,f,function(f){var o;if(!f.cancel){var e,s=void 0,h=void 0,l=window.getComputedStyle(document.body),y=parseFloat(l.marginRight.split("px")[0])+parseFloat(l.paddingRight.split("px")[0]),p=window.innerHeight,w=window.innerWidth,v=u.parent.element,c=!Object(r.isNullOrUndefined)(u.parent.getToolbar()),b=c&&u.parent.toolbarModule.getToolbarHeight(),k=c&&u.parent.toolbarModule.getExpandTBarPopHeight(),d=c?b+k:0;(Object(r.addClass)([u.element],[wr]),r.Browser.isDevice&&!a()&&Object(r.addClass)([u.parent.getToolbar()],[wr]),u.parent.iframeSettings.enable)?(s=(e=u.contentRenderer.getPanel().contentWindow).pageYOffset,h=e.innerHeight):(s=(e=Object(r.closest)(i,"."+ih))?e.scrollTop:0,h=e?e.offsetHeight:0);u.parent.inlineMode.enable||Object(r.closest)(i,"table")||(u.parent.disableToolbarItem(u.parent.toolbarSettings.items),u.parent.enableToolbarItem(["Undo","Redo"]));Object(r.append)([u.element],document.body);u.popupObj.position.X=n+20;u.popupObj.position.Y=t+(u.parent.iframeSettings.enable?35:20);u.popupObj.dataBind();u.popupObj.element.classList.add("e-popup-open");u.dropDownButtons.renderDropDowns({container:u.toolbarElement,containerType:"quick",items:u.stringItems});u.colorPickerObj.renderColorPickerInput({container:u.toolbarElement,containerType:"quick",items:u.stringItems});o={x:n,y:t,target:i,editTop:s,editHeight:h,popup:u.popupObj.element,popHeight:u.popupObj.element.offsetHeight,popWidth:u.popupObj.element.offsetWidth,parentElement:v,bodyRightSpace:y,windowY:window.pageYOffset,windowHeight:p,windowWidth:w,parentData:v.getBoundingClientRect(),tBarElementHeight:d};"IMG"===i.tagName&&u.setPosition(o);u.parent.inlineMode.enable||u.checkCollision(o,"parent","");u.checkCollision(o,"document",u.parent.inlineMode.enable?"inline":"");u.popupObj.element.classList.remove("e-popup-open");Object(r.removeClass)([u.element],[wr]);u.popupObj.show({name:"ZoomIn",duration:r.Browser.isIE?250:400});Object(r.setStyleAttribute)(u.element,{maxWidth:u.parent.element.offsetWidth+"px"});Object(r.addClass)([u.element],[nh]);u.isDOMElement=!0}})},n.prototype.hidePopup=function(){var n=this.parent.sourceCodeModule.getViewPanel();r.Browser.isDevice&&!a()&&Object(r.removeClass)([this.parent.getToolbar()],[wr]);Object(r.isNullOrUndefined)(this.parent.getToolbar())||this.parent.inlineMode.enable||(Object(r.isNullOrUndefined)(n)||"none"===n.style.display)&&this.parent.enableToolbarItem(this.parent.toolbarSettings.items);this.removeEleFromDOM();this.isDOMElement=!1},n.prototype.addQTBarItem=function(n,t){this.quickTBarObj.toolbarObj.addItems(this.quickTBarObj.getItems(n,"toolbar"),t)},n.prototype.removeQTBarItem=function(n){this.quickTBarObj.toolbarObj.removeItems(n)},n.prototype.removeEleFromDOM=function(){var t=this.popupObj.element,n;this.isDOMElement&&(this.dropDownButtons.destroyDropDowns(),this.colorPickerObj.destroyColorPicker(),Object(r.removeClass)([this.element],[nh]),Object(r.detach)(t),n=Object(r.isBlazor)()?{element:this.popupObj.element}:this.popupObj,this.parent.trigger(fa,n))},n.prototype.updateStatus=function(n){dh({args:n,dropDownModule:this.dropDownButtons,parent:this.parent,tbElements:Object(r.selectAll)("."+oi,this.element),tbItems:this.quickTBarObj.toolbarObj.items},!0);Object(r.select)(".e-rte-srctextarea",this.parent.element)||ru(this.parent.getBaseToolbarObject(),this.parent.formatter.editorManager.undoRedoManager.getUndoStatus())},n.prototype.destroy=function(){this.popupObj&&!this.popupObj.isDestroyed&&(this.popupObj.destroy(),this.removeEleFromDOM());this.removeEventListener()},n.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(h,this.destroy,this),this.parent.on(y,this.onPropertyChanged,this),this.parent.inlineMode.enable&&this.parent.on(ot,this.updateStatus,this))},n.prototype.onPropertyChanged=function(n){if(!Object(r.isNullOrUndefined)(n.newProp.inlineMode))for(var t=0,i=Object.keys(n.newProp.inlineMode);t<i.length;t++)switch(i[t]){case"enable":n.newProp.inlineMode.enable?this.parent.on(ot,this.updateStatus,this):this.parent.off(ot,this.updateStatus)}},n.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(h,this.destroy),this.parent.off(y,this.onPropertyChanged),this.parent.inlineMode.enable&&this.parent.off(ot,this.updateStatus))},n}(),uy=function(){function n(n){this.parent=n}return n.prototype.quickToolbarOpen=function(){var n=Object(r.isBlazor)()?{element:this.popupObj.element}:this.popupObj;this.parent.trigger(ua,n)},n.prototype.renderPopup=function(n){this.setPanel(n.element);this.renderPanel();n.popupObj=new ft.Popup(n.element,{targetType:"relative",relateTo:this.parent.element,open:this.quickToolbarOpen.bind(this)});this.popupObj=n.popupObj;n.popupObj.hide()},n.prototype.renderPanel=function(){this.getPanel().classList.add(sa)},n.prototype.getPanel=function(){return this.popupPanel},n.prototype.setPanel=function(n){this.popupPanel=n},n}(),ik=function(){function n(n,t){this.parent=n;this.locator=t;this.renderFactory=this.locator.getService("rendererFactory");this.renderFactory.addRenderer(o.Popup,new uy(this.parent));this.addEventListener()}return n.prototype.formatItems=function(n){var t=[];return n.forEach(function(n){if("string"==typeof n)switch(n.toLocaleLowerCase()){case"open":t.push("openLink");break;case"edit":t.push("editLink");break;case"unlink":t.push("removeLink");break;default:t.push(n)}else t.push(n)}),t},n.prototype.getQTBarOptions=function(n,t,i,r){return{popupType:n,toolbarItems:i,mode:t,renderType:r}},n.prototype.createQTBar=function(n,t,i,r){if(i.length<1)return null;var u=new ry(this.parent,this.locator);return u.render(this.getQTBarOptions(n,t,this.formatItems(i),r)),u},n.prototype.initializeQuickToolbars=function(){this.parent.quickToolbarModule=this;this.contentRenderer=this.renderFactory.getRenderer(o.Content);this.parent.inlineMode.enable&&this.parent.inlineMode.onSelection&&a()&&r.EventHandler.add(this.contentRenderer.getDocument(),"selectionchange",this.selectionChangeHandler,this)},n.prototype.onMouseDown=function(){this.parent.isBlur=!1;this.parent.isRTE=!0},n.prototype.renderQuickToolbars=function(){this.linkQTBar||this.imageQTBar||this.textQTBar||this.tableQTBar||(this.linkQTBar=this.createQTBar("Link","Scrollable",this.parent.quickToolbarSettings.link,o.LinkToolbar),this.renderFactory.addRenderer(o.LinkToolbar,this.linkQTBar),this.textQTBar=this.createQTBar("Text","Scrollable",this.parent.quickToolbarSettings.text,o.TextToolbar),this.renderFactory.addRenderer(o.TextToolbar,this.textQTBar),this.imageQTBar=this.createQTBar("Image","MultiRow",this.parent.quickToolbarSettings.image,o.ImageToolbar),this.renderFactory.addRenderer(o.ImageToolbar,this.imageQTBar),this.tableQTBar=this.createQTBar("Table","MultiRow",this.parent.quickToolbarSettings.table,o.TableToolbar),this.renderFactory.addRenderer(o.TableToolbar,this.tableQTBar),this.linkQTBar&&r.EventHandler.add(this.linkQTBar.element,"mousedown",this.onMouseDown,this),this.imageQTBar&&r.EventHandler.add(this.imageQTBar.element,"mousedown",this.onMouseDown,this),this.textQTBar&&r.EventHandler.add(this.textQTBar.element,"mousedown",this.onMouseDown,this),this.tableQTBar&&r.EventHandler.add(this.tableQTBar.element,"mousedown",this.onMouseDown,this))},n.prototype.renderInlineQuickToolbar=function(){this.parent.inlineMode.enable&&(!r.Browser.isDevice||a())&&(Object(r.addClass)([this.parent.element],[io]),this.inlineQTBar=this.createQTBar("Inline","MultiRow",this.parent.toolbarSettings.items,o.InlineToolbar),this.renderFactory.addRenderer(o.InlineToolbar,this.inlineQTBar),r.EventHandler.add(this.inlineQTBar.element,"mousedown",this.onMouseDown,this))},n.prototype.showInlineQTBar=function(n,t,i){this.parent.readonly||this.inlineQTBar.showPopup(n,t,i)},n.prototype.hideInlineQTBar=function(){this.inlineQTBar&&!tt(this.inlineQTBar.element,"e-popup-close")&&this.inlineQTBar.hidePopup()},n.prototype.hideQuickToolbars=function(){this.linkQTBar&&!tt(this.linkQTBar.element,"e-popup-close")&&document.body.contains(this.linkQTBar.element)&&this.linkQTBar.hidePopup();this.textQTBar&&!tt(this.textQTBar.element,"e-popup-close")&&document.body.contains(this.textQTBar.element)&&this.textQTBar.hidePopup();this.imageQTBar&&!tt(this.imageQTBar.element,"e-popup-close")&&document.body.contains(this.imageQTBar.element)&&this.imageQTBar.hidePopup();this.tableQTBar&&!tt(this.tableQTBar.element,"e-popup-close")&&document.body.contains(this.tableQTBar.element)&&this.tableQTBar.hidePopup();!this.parent.inlineMode.enable||r.Browser.isDevice&&!a()||this.hideInlineQTBar()},n.prototype.deBounce=function(n,t,i){var r=this;clearTimeout(this.deBouncer);this.deBouncer=window.setTimeout(function(){r.showInlineQTBar(n,t,i)},1e3)},n.prototype.mouseUpHandler=function(n){var i,u,t,f;if(this.parent.inlineMode.enable&&(!r.Browser.isDevice||a())&&(i=n.args.touches?n.args.changedTouches[0]:n.args,u=this.parent.getRange(),t=n.args.target,Object(r.isNullOrUndefined)(Object(r.select)("."+pr,document.body)))){if(a()&&n.touchData&&n.touchData.prevClientX!==n.touchData.clientX&&n.touchData.prevClientY!==n.touchData.clientY)return;if(this.hideInlineQTBar(),this.offsetX=i.pageX,this.offsetY=dv(i,this.parent.element,this.parent.iframeSettings.enable),"TEXTAREA"===t.nodeName)this.showInlineQTBar(this.offsetX,this.offsetY,t);else if(f=Object(r.closest)(t,"a"),!("IMG"===(t=f||t).tagName||"A"===t.tagName||Object(r.closest)(t,"td,th")&&u.collapsed)){if(this.parent.inlineMode.onSelection&&u.collapsed)return;this.target=t;this.showInlineQTBar(this.offsetX,this.offsetY,t)}}},n.prototype.keyDownHandler=function(){!this.parent.inlineMode.enable||r.Browser.isDevice&&!a()||Object(r.isNullOrUndefined)(Object(r.select)("."+pr,document))||this.hideInlineQTBar()},n.prototype.inlineQTBarMouseDownHandler=function(){!this.parent.inlineMode.enable||r.Browser.isDevice&&!a()||Object(r.isNullOrUndefined)(Object(r.select)("."+pr,document))||this.hideInlineQTBar()},n.prototype.keyUpHandler=function(n){if(this.parent.inlineMode.enable&&!r.Browser.isDevice){if(this.parent.inlineMode.onSelection)return;var t=n.args;this.deBounce(this.offsetX,this.offsetY,t.target)}},n.prototype.selectionChangeHandler=function(n){var t=this;clearTimeout(this.deBouncer);this.deBouncer=window.setTimeout(function(){t.onSelectionChange(n)},1e3)},n.prototype.onSelectionChange=function(n){Object(r.isNullOrUndefined)(Object(r.select)("."+pr,document.body))&&(this.contentRenderer.getDocument().getSelection().isCollapsed||this.mouseUpHandler({args:n}))},n.prototype.getInlineBaseToolbar=function(){return this.inlineQTBar&&this.inlineQTBar.quickTBarObj},n.prototype.destroy=function(){this.linkQTBar&&(r.EventHandler.remove(this.linkQTBar.element,"mousedown",this.onMouseDown),this.linkQTBar.destroy());this.textQTBar&&(r.EventHandler.remove(this.textQTBar.element,"mousedown",this.onMouseDown),this.textQTBar.destroy());this.imageQTBar&&(r.EventHandler.remove(this.imageQTBar.element,"mousedown",this.onMouseDown),this.imageQTBar.destroy());this.tableQTBar&&(r.EventHandler.remove(this.tableQTBar.element,"mousedown",this.onMouseDown),this.tableQTBar.destroy());this.inlineQTBar&&(r.EventHandler.remove(this.inlineQTBar.element,"mousedown",this.onMouseDown),a()&&r.EventHandler.remove(document,"selectionchange",this.selectionChangeHandler),this.inlineQTBar.destroy());this.removeEventListener()},n.prototype.wireInlineQTBarEvents=function(){this.parent.on(yf,this.mouseUpHandler,this);this.parent.on(g,this.inlineQTBarMouseDownHandler,this);this.parent.on(w,this.keyDownHandler,this);this.parent.on(ri,this.keyUpHandler,this);this.parent.on(er,this.mouseUpHandler,this);this.parent.on(le,this.renderInlineQuickToolbar,this)},n.prototype.unWireInlineQTBarEvents=function(){this.parent.off(yf,this.mouseUpHandler);this.parent.off(g,this.inlineQTBarMouseDownHandler);this.parent.off(w,this.keyDownHandler);this.parent.off(ri,this.keyUpHandler);this.parent.off(er,this.mouseUpHandler);this.parent.off(le,this.renderInlineQuickToolbar)},n.prototype.toolbarUpdated=function(){this.linkQTBar&&!tt(this.linkQTBar.element,"e-popup-close")&&this.linkQTBar.hidePopup();this.imageQTBar&&!tt(this.imageQTBar.element,"e-popup-close")&&this.imageQTBar.hidePopup();this.tableQTBar&&!tt(this.tableQTBar.element,"e-popup-close")&&this.tableQTBar.hidePopup()},n.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(p,this.initializeQuickToolbars,this),this.parent.on(g,this.renderQuickToolbars,this),this.parent.on(ot,this.toolbarUpdated,this),this.parent.on(ps,this.renderQuickToolbars,this),this.wireInlineQTBarEvents(),this.parent.on(y,this.onPropertyChanged,this),"hide"===this.parent.quickToolbarSettings.actionOnScroll&&(this.parent.on(fi,this.hideQuickToolbars,this),this.parent.on(or,this.hideQuickToolbars,this)),this.parent.on(cr,this.hideQuickToolbars,this),this.parent.on(wt,this.onIframeMouseDown,this),this.parent.on(h,this.destroy,this),this.parent.on(w,this.onKeyDown,this),this.parent.on(kt,this.setRtl,this))},n.prototype.onKeyDown=function(n){var t=n.args;8!==t.which&&46!==t.which||this.imageQTBar&&!tt(this.imageQTBar.element,"e-popup-close")&&this.imageQTBar.hidePopup()},n.prototype.onIframeMouseDown=function(){this.hideQuickToolbars();this.hideInlineQTBar()},n.prototype.setRtl=function(n){this.inlineQTBar&&this.inlineQTBar.quickTBarObj.toolbarObj.setProperties({enableRtl:n.enableRtl});this.imageQTBar&&this.imageQTBar.quickTBarObj.toolbarObj.setProperties({enableRtl:n.enableRtl});this.linkQTBar&&this.imageQTBar.quickTBarObj.toolbarObj.setProperties({enableRtl:n.enableRtl})},n.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(p,this.initializeQuickToolbars),this.parent.off(g,this.renderQuickToolbars),this.parent.off(ot,this.toolbarUpdated),this.unWireInlineQTBarEvents(),this.parent.off(y,this.onPropertyChanged),"hide"===this.parent.quickToolbarSettings.actionOnScroll&&(this.parent.off(fi,this.hideQuickToolbars),this.parent.off(or,this.hideQuickToolbars)),this.parent.off(cr,this.hideQuickToolbars),this.parent.off(h,this.destroy),this.parent.off(wt,this.onIframeMouseDown),this.parent.off(w,this.onKeyDown),this.parent.off(kt,this.setRtl))},n.prototype.onPropertyChanged=function(n){if(!Object(r.isNullOrUndefined)(n.newProp.quickToolbarSettings))for(var t=0,i=Object.keys(n.newProp.quickToolbarSettings);t<i.length;t++)switch(i[t]){case"actionOnScroll":"none"===n.newProp.quickToolbarSettings.actionOnScroll?(this.parent.off(fi,this.hideQuickToolbars),this.parent.off(or,this.hideQuickToolbars)):(this.parent.on(fi,this.hideQuickToolbars,this),this.parent.on(or,this.hideQuickToolbars,this))}n.module===this.getModuleName()&&(this.inlineQTBar&&(Object(r.removeClass)([this.parent.element],[io]),this.unWireInlineQTBarEvents(),this.hideInlineQTBar()),!this.parent.inlineMode.enable||r.Browser.isDevice&&!a()||(Object(r.addClass)([this.parent.element],[io]),this.wireInlineQTBarEvents()))},n.prototype.getModuleName=function(){return"quickToolbar"},n}(),rk=function(){function n(n,t){this.parent=n;this.locator=t;this.renderFactory=this.locator.getService("rendererFactory");this.addEventListener()}return n.prototype.initializeInstance=function(){this.contentRenderer=this.renderFactory.getRenderer(o.Content);this.editPanel=this.contentRenderer.getEditPanel();this.addEventListener()},n.prototype.renderCount=function(){this.initializeInstance();this.element=this.parent.createElement("span",{className:hh});this.contentRenderer.getPanel().parentElement.appendChild(this.element);this.appendCount();-1!==this.parent.maxLength&&this.charCountBackground(this.htmlLength)},n.prototype.appendCount=function(){var t="Markdown"===this.parent.editorMode?this.editPanel.value.trim():this.editPanel.textContent.trim(),n;this.htmlLength=t.length;n=-1===this.parent.maxLength?this.htmlLength:this.htmlLength+" / "+this.parent.maxLength;this.element.innerHTML=n},n.prototype.charCountBackground=function(n){var t=n/this.parent.maxLength*100;t<85?(this.element.classList.remove(eo),this.element.classList.remove(oo)):t>85&&t<=90?(this.element.classList.remove(oo),this.element.classList.add(eo)):t>90&&(this.element.classList.remove(eo),this.element.classList.add(oo))},n.prototype.refresh=function(){Object(r.isNullOrUndefined)(this.editPanel)||(this.appendCount(),-1!==this.parent.maxLength&&this.charCountBackground(this.htmlLength))},n.prototype.destroy=function(){this.element&&!Object(r.isNullOrUndefined)(document.querySelector("."+hh))&&Object(r.detach)(this.element);this.removeEventListener()},n.prototype.toggle=function(n){this.element.style.display="viewSource"===n.member?"none":"block"},n.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(p,this.renderCount,this),this.parent.on(ri,this.refresh,this),this.parent.on(ce,this.refresh,this),this.parent.on(cf,this.refresh,this),this.parent.on(g,this.refresh,this),this.parent.on(h,this.destroy,this),this.parent.on(yi,this.toggle,this),this.parent.on(fr,this.toggle,this))},n.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(p,this.renderCount),this.parent.off(ri,this.refresh),this.parent.off(cf,this.refresh),this.parent.off(ce,this.refresh),this.parent.off(g,this.refresh),this.parent.off(h,this.destroy),this.parent.off(yi,this.toggle),this.parent.off(fr,this.toggle))},n.prototype.getModuleName=function(){return"count"},n}(),is=function(){function n(){}return n.prototype.getLineNumber=function(n,t){return n.value.substr(0,t).split("\n").length},n.prototype.getSelectedText=function(n){var t=n.selectionStart,i=n.selectionEnd;return n.value.substring(t,i)},n.prototype.getAllParents=function(n){return n.split("\n")},n.prototype.getSelectedLine=function(n){return this.getAllParents(n.value)[this.getLineNumber(n,n.selectionStart)-1]},n.prototype.getLine=function(n,t){return this.getAllParents(n.value)[t]},n.prototype.getSelectedParentPoints=function(n){var o=this.getAllParents(n.value),h=this.getLineNumber(n,n.selectionStart),c=this.getLineNumber(n,n.selectionEnd),e=this.getSelectedText(n).split("\n"),t=[],s=o[h-1],l=o.slice(0,h-1).join("").length,i={},r,u,f;if(i.line=h-1,i.start=l+i.line,i.end=""!==s?i.start+s.length+1:i.start+s.length,i.text=s,t.push(i),e.length>1){for(r=1;r<e.length-1;r++)u={},u.line=t[r-1].line+1,u.start=(e[r],t[r-1].end),u.end=u.start+e[r].length+1,u.text=e[r],t.push(u);f={};f.line=t[t.length-1].line+1;f.start=t[t.length-1].end;f.end=f.start+o[c-1].length+1;f.text=o[c-1];t.push(f)}return t},n.prototype.setSelection=function(n,t,i){n.setSelectionRange(t,i);n.focus()},n.prototype.save=function(n,t){this.selectionStart=n;this.selectionEnd=t},n.prototype.restore=function(n){this.setSelection(n,this.selectionStart,this.selectionEnd)},n.prototype.isStartWith=function(n,t){var i=!1;return n&&(i=(n.trim()===t.trim()?new RegExp("^("+this.replaceSpecialChar(t.trim())+")","gim"):new RegExp("^("+this.replaceSpecialChar(t)+")","gim")).test(n.trim())),i},n.prototype.replaceSpecialChar=function(n){return n.replace(/[`~!@#$%^&*()_|+\-=?;:'",.<>\{\}\[\]\\\/]/g,"\\$&")},n.prototype.isClear=function(n,t){for(var i=0;i<n.length;i++)if(new RegExp(t,"gim").test(n[i].text))return!0;return!1},n.prototype.getSelectedInlinePoints=function(n){return{start:n.selectionStart,end:n.selectionEnd,text:this.getSelectedText(n)}},n}(),fy=function(){function n(n){this.toolbarStatus={bold:!1,italic:!1,subscript:!1,superscript:!1,strikethrough:!1,orderedlist:!1,uppercase:!1,inlinecode:!1,unorderedlist:!1,underline:!1,alignments:null,backgroundcolor:null,fontcolor:null,fontname:null,fontsize:null,formats:null};this.selection=new is;this.parent=n;this.element=this.parent.contentModule.getEditPanel();this.addEventListener()}return n.prototype.addEventListener=function(){this.parent.on(bt,this.onRefreshHandler,this);this.parent.on(h,this.removeEventListener,this)},n.prototype.removeEventListener=function(){this.parent.off(bt,this.onRefreshHandler);this.parent.off(h,this.onRefreshHandler)},n.prototype.onRefreshHandler=function(n){var t=this.selection.getSelectedParentPoints(this.element);this.toolbarStatus={orderedlist:!n.documentNode&&this.isListsApplied(t,"OL"),unorderedlist:!n.documentNode&&this.isListsApplied(t,"UL"),formats:this.currentFormat(t,n.documentNode),bold:!n.documentNode&&this.parent.formatter.editorManager.mdSelectionFormats.isAppliedCommand("Bold"),italic:!n.documentNode&&this.parent.formatter.editorManager.mdSelectionFormats.isAppliedCommand("Italic"),inlinecode:!n.documentNode&&this.parent.formatter.editorManager.mdSelectionFormats.isAppliedCommand("InlineCode"),strikethrough:!n.documentNode&&this.parent.formatter.editorManager.mdSelectionFormats.isAppliedCommand("StrikeThrough"),subscript:!n.documentNode&&this.parent.formatter.editorManager.mdSelectionFormats.isAppliedCommand("SubScript"),superscript:!n.documentNode&&this.parent.formatter.editorManager.mdSelectionFormats.isAppliedCommand("SuperScript"),uppercase:!n.documentNode&&this.parent.formatter.editorManager.mdSelectionFormats.isAppliedCommand("UpperCase")};this.parent.formatter.editorManager.mdSelectionFormats.isAppliedCommand("InlineCode")&&(this.toolbarStatus.formats="pre");this.parent.notify(ot,this.toolbarStatus)},n.prototype.isListsApplied=function(n,t){var r=!0,i,u;if("OL"===t){for(i=0;i<n.length;i++)if(u=n[i].text.trim().split(" ",2)[0]+" ",!/^[\d.]+[ ]+$/.test(u)){r=!1;break}}else for(i=0;i<n.length;i++)if(!this.selection.isStartWith(n[i].text,this.parent.formatter.listTags[t])){r=!1;break}return r},n.prototype.currentFormat=function(n,t){for(var u="p",r=Object.keys(this.parent.formatter.formatTags),f="backward"===this.element.selectionDirection?n[0].text:n[n.length-1].text,i=0;!t&&i<r.length;i++){if("pre"!==r[i]&&this.selection.isStartWith(f,this.parent.formatter.formatTags[r[i]])){u=r[i];break}if("pre"===r[i]&&this.codeFormat()){u=r[i];break}}return u},n.prototype.codeFormat=function(){var e,o=!1,i=this.parent.inputElement,s=i.selectionStart,n=(e=s,function(n){return[n.slice(0,e),n.slice(e)]})(i.value),r=this.parent.formatter.formatTags.pre,u=this.getSelectedText(i),t,f;return""!==u&&u===u.toLocaleUpperCase()?!0:""===u&&(t=i.value.substr(n[0].length-1,1),f=n[1].substr(0,1),""!==t&&""!==f&&t.match(/[a-z]/i)&&t===t.toLocaleUpperCase()&&f===f.toLocaleUpperCase())?!0:(this.isCode(n[0],r)&&this.isCode(n[1],r)&&n[0].match(this.multiCharRegx(r)).length%2==1&&n[1].match(this.multiCharRegx(r)).length%2==1&&(o=!0),o)},n.prototype.getSelectedText=function(n){return n.value.substring(n.selectionStart,n.selectionEnd)},n.prototype.isCode=function(n,t){return-1!==n.search("\\"+t)},n.prototype.multiCharRegx=function(n){return new RegExp("(\\"+n+")","g")},n}(),ey=function(){function n(n){this.parent=n;this.addEventListener()}return n.prototype.addEventListener=function(){this.parent.on(wf,this.commandCallBack,this);this.parent.on(h,this.removeEventListener,this)},n.prototype.commandCallBack=function(n){"Undo"!==n.requestType&&"Redo"!==n.requestType&&this.parent.formatter.saveData();this.parent.notify(bt,{args:n});this.parent.notify(ce,{})},n.prototype.removeEventListener=function(){this.parent.off(wf,this.commandCallBack);this.parent.off(h,this.removeEventListener)},n}(),rs="keydown",ki="action",of="format-type",v="keydown-handler",sc="list-type",li="keyup-handler",fu="keyup",eu="model_changed_plugin",us="model_changed",hc="ms_word_cleanup_plugin",cc="ms_word_cleanup",lc=function(){function n(){}return n.prototype.process=function(n,t,i,u){var h,e=this,s=n.contentModule.getDocument().getSelection(),o=s.rangeCount>0?s.getRangeAt(s.rangeCount-1):null,f,c,l;("HTML"===n.editorMode&&(h=this.editorManager.nodeSelection.save(o,n.contentModule.getDocument())),Object(r.isNullOrUndefined)(t)||!t.item.command||"Table"===t.item.command||"Actions"===t.item.command||"Links"===t.item.command||"Images"===t.item.command||!o||n.contentModule.getEditPanel().contains(this.getAncestorNode(o.commonAncestorContainer))||n.contentModule.getEditPanel()===o.commonAncestorContainer||n.contentModule.getPanel()===o.commonAncestorContainer)&&(Object(r.isNullOrUndefined)(t)?(f=i.action,"tab"!==f&&"enter"!==f&&"space"!==f&&"escape"!==f&&(t={},"Markdown"===n.editorMode&&"insert-table"===f&&(u={headingText:n.localeObj.getConstant("TableHeadingText"),colText:n.localeObj.getConstant("TableColText")}),c={originalEvent:i,cancel:!1,requestType:f||i.key+"Key",itemCollection:u},Object(r.extend)(t,t,c,!0),Object(r.isBlazor)()&&(delete t.item,delete t.itemCollection),n.trigger(st,t,function(n){n.cancel&&("paste"!==f&&"cut"!==f&&"copy"!==f||i.preventDefault())})),l=!!Object(r.isNullOrUndefined)(n.tableModule)||!!n.tableModule&&n.tableModule.ensureInsideTableList,(9===i.which&&l||9!==i.which)&&this.editorManager.observer.notify("keydown"===i.type?rs:fu,{event:i,callBack:this.onSuccess.bind(this,n),value:u})):!Object(r.isNullOrUndefined)(t)&&t.item.command&&t.item.subCommand&&(t.item.command!==t.item.subCommand&&"Font"!==t.item.command||("FontName"===t.item.subCommand||"FontSize"===t.item.subCommand)&&"dropDownSelect"===t.name||("BackgroundColor"===t.item.subCommand||"FontColor"===t.item.subCommand)&&"colorPickerChanged"===t.name)&&(Object(r.extend)(t,t,{requestType:t.item.subCommand,cancel:!1,itemCollection:u},!0),n.trigger(st,t,function(r){if(!r.cancel){0===e.getUndoRedoStack().length&&"Links"!==r.item.command&&"Images"!==r.item.command&&e.saveData();n.isBlur=!1;n.contentModule.getEditPanel().focus();"HTML"===n.editorMode&&h.restore();var f=r.item.subCommand.toLocaleLowerCase();"paste"===f||"cut"===f||"copy"===f?n.clipboardAction(f,i):(e.editorManager.observer.notify(pe,{subCommand:r.item.subCommand}),e.editorManager.execCommand(r.item.command,r.item.subCommand,i,e.onSuccess.bind(e,n),r.item.value,"Pre"===r.item.subCommand&&"dropDownSelect"===t.name?{name:t.name}:u,"#"+n.getID()+" iframe"))}})),(Object(r.isNullOrUndefined)(i)||i&&"copy"!==i.action)&&this.enableUndo(n))},n.prototype.getAncestorNode=function(n){return 3===n.nodeType?n.parentNode:n},n.prototype.onKeyHandler=function(n,t){var i=this;this.editorManager.observer.notify(fu,{event:t,callBack:function(){i.enableUndo(n)}})},n.prototype.onSuccess=function(n,t){(Object(r.isNullOrUndefined)(t.event)||t&&"copy"!==t.event.action)&&(this.enableUndo(n),n.notify(wf,t));Object(r.isBlazor)()&&delete t.elements;n.trigger(vi,t,function(t){if(n.setPlaceHolder(),"Images"===t.requestType||"Links"===t.requestType&&"HTML"===n.editorMode){var i=t;if("Links"===t.requestType&&t.event&&"keydown"===t.event.type&&32===t.event.keyCode)return;n.notify(ur,{args:i.event,type:t.requestType,isNotify:!0,elements:i.elements})}n.autoResize()})},n.prototype.saveData=function(n){this.editorManager.undoRedoManager.saveData(n)},n.prototype.getUndoStatus=function(){return this.editorManager.undoRedoManager.getUndoStatus()},n.prototype.getUndoRedoStack=function(){return this.editorManager.undoRedoManager.undoRedoStack},n.prototype.enableUndo=function(n){var t=this.getUndoStatus();!n.inlineMode.enable||r.Browser.isDevice&&!a()?n.toolbarModule&&(ru(n.toolbarModule.baseToolbar,t),n.trigger(as,t)):(ru(n.quickToolbarModule.inlineQTBar.quickTBarObj,t),n.trigger(as,t))},n}(),ac="lists-commands",fs="command-type",vc="link-commands",yc="clear-commands",es="insert-table",oy=function(){function n(n){Object(r.extend)(this,this,n,!0);this.selection=this.parent.markdownSelection;this.addEventListener()}return n.prototype.addEventListener=function(){this.parent.observer.on(ac,this.applyListsHandler,this);this.parent.observer.on(v,this.keyDownHandler,this);this.parent.observer.on(li,this.keyUpHandler,this)},n.prototype.keyDownHandler=function(n){switch(n.event.which){case 9:this.tabKey(n)}switch(n.event.action){case"ordered-list":this.applyListsHandler({subCommand:"OL",callBack:n.callBack});n.event.preventDefault();break;case"unordered-list":this.applyListsHandler({subCommand:"UL",callBack:n.callBack});n.event.preventDefault()}},n.prototype.keyUpHandler=function(n){switch(n.event.which){case 13:this.enterKey(n)}},n.prototype.tabKey=function(n){var r=this.parent.element,y,k,i,h,f,w,u;this.selection.save(r.selectionStart,r.selectionEnd);var e=r.selectionStart,o=r.selectionEnd,t=this.selection.getSelectedParentPoints(r),v=0,b=this.isNotFirstLine(r,t[0]);if(b||n.event.shiftKey){for(y=this.olListType(),k=this.getListRegex(),this.currentAction=this.getAction(t[0].text),i=0;i<t.length;i++)if(h=(n.event.shiftKey,t[i].line-1),f=this.selection.getLine(r,h),f&&(!n.event.shiftKey&&b||n.event.shiftKey)){var d=f.split(". "),c=n.event.shiftKey?-1:1,s=t[i].text.split("\t");if(n.event.shiftKey&&1===s.length)break;if("OL"===this.currentAction&&/^\d+$/.test(d[0].trim())&&y){n.event.preventDefault();t[i].text=n.event.shiftKey?s.splice(1,s.length).join("\t"):"\t"+t[i].text;var l=this.getTabSpace(t[i].text),a=this.getTabSpace(f),p=t[i].text.split(". ");if(l===a)this.changeTextAreaValue(p,this.nextOrderedListValue(d[0].trim()),n,r,t,i,o);else if(a<l)this.changeTextAreaValue(p,"1. ",n,r,t,i,o);else for(;a.length>l.length;null)if(h-=1,w=(f=this.selection.getLine(r,h)).trim().split(". "),/^\d+$/.test(w[0])&&(a=this.getTabSpace(f)).length<=l.length){this.changeTextAreaValue(p,this.nextOrderedListValue(w[0]),n,r,t,i,o);break}}else("UL"===this.currentAction&&k.test(f.trim())||!y)&&(n.event.preventDefault(),t[i].text=n.event.shiftKey?s.splice(1,s.length).join("\t"):"\t"+t[i].text,r.value=r.value.substr(0,t[i].start)+t[i].text+"\n"+r.value.substr(t[i].end,r.value.length));if(e=0===i?e+c:e,v+=c,1!==t.length)for(u=i;u<t.length;u++)t[u].start=0!==u?t[u].start+c:t[u].start,t[u].end=t[u].end+c}this.restore(r,e,o+v,n)}else this.restore(r,e,o+v,n)},n.prototype.changeTextAreaValue=function(n,t,i,u,f,e){var k=t,c,w,b;n.splice(0,1);var d,ut=this.selection.getAllParents(u.value).length,o="",h=this.getTabSpace(f[e].text),g=parseInt(k.split(".")[0],null),y=this.getTabSpace(f[e].text),nt=!0,a=!0,tt=-1,it=!0,rt=0,p="";for(o=""!==this.selection.getLine(u,f[0].line+1)?"":o+u.value.substr(f[0].end,u.value.length),c=1;c<ut&&!Object(r.isNullOrUndefined)(this.selection.getLine(u,f[0].line+c))&&""!==this.selection.getLine(u,f[0].line+c);c++){var v=this.selection.getLine(u,f[0].line+c),s=this.getTabSpace(v),l=v.split(". ");if(1===l.length){o+=u.value.substr(f[0].end+rt,u.value.length);break}rt+=v.length;w=!1;(d=i.event.shiftKey?h.length+1:h.length-1,s.length>y.length&&(it=!1),h.length!==s.length&&s.length<y.length?(a=!0,nt=!1,w=!(!i.event.shiftKey||h.length!==s.length)&&(a=!1,!0)):it&&i.event.shiftKey&&h.length===s.length&&s.length===y.length&&(a=!1,w=!0),p=""===o?"":"\n",d===s.length&&a)?(b=i.event.shiftKey?(tt++,this.nextOrderedListValue(tt.toString())):this.previousOrderedListValue(l[0]),l.splice(0,1),o=o+p+s+b+l.join(". ")):h.length===s.length&&nt||w?(b=this.nextOrderedListValue(g.toString()),g++,l.splice(0,1),o=o+p+s+b+l.join(". ")):(o=o+p+v,a=!1);y=this.getTabSpace(v)}f[e].text=this.getTabSpace(f[e].text)+k+n.join(". ")+"\n";u.value=u.value.substr(0,f[e].start)+f[e].text+o},n.prototype.getTabSpace=function(n){for(var i=n.split("\t"),r="",t=0;t<i.length&&""===i[t];t++)r+="\t";return r},n.prototype.isNotFirstLine=function(n,t){var s,c=t.text,o=t.line-1,i=this.selection.getLine(n,o),h=this.getListRegex(),r=!1,u,f,e;if(i&&(this.currentAction=this.getAction(i),u=i.split(". "),s="OL"===this.currentAction?/^\d+$/.test(u[0].trim()):h.test(i.trim())),i&&s)for(f=this.getTabSpace(c),e=this.getTabSpace(i),r=f===e||r;e.length>f.length;null)if(o-=1,u=(i=this.selection.getLine(n,o)).trim().split(". "),("OL"===this.currentAction?/^\d+$/.test(u[0]):h.test(i.trim()))&&(e=this.getTabSpace(i)).length<=f.length){r=!0;break}return r},n.prototype.getAction=function(n){var t=n.split(". ")[0],i=/^\d+$/.test(t.trim()),r=n.trim().split(new RegExp("^("+this.selection.replaceSpecialChar(this.syntax.UL).trim()+")"))[1];return i?"OL":r?"UL":"NOTLIST"},n.prototype.nextOrderedListValue=function(n){return(parseInt(n,null)+1).toString()+". "},n.prototype.previousOrderedListValue=function(n){return(parseInt(n,null)-1).toString()+". "},n.prototype.enterKey=function(n){var t=this.parent.element,a,e,f,s,h,v,g;this.selection.save(t.selectionStart,t.selectionEnd);var c=t.selectionStart,nt=t.selectionEnd,i=this.selection.getSelectedParentPoints(t),u=this.selection.getLine(t,i[0].line-1),p=this.olListType(),w=this.getListRegex(),l=[];if(Object(r.isNullOrUndefined)(u)||(l=u.split(". "),this.currentAction=this.getAction(u)),a=0,"OL"===this.currentAction&&l.length>1&&/^\d+$/.test(l[0].trim())&&p&&""!==l[1]){e=this.getTabSpace(u);this.currentAction=this.getAction(u);f=this.nextOrderedListValue(l[0]);i[0].text=e+f+i[0].text;for(var tt=this.selection.getAllParents(t.value).length,o="\n",b=this.getTabSpace(u),k=this.getTabSpace(i[0].text),d=!0,y=1;y<tt&&""!==t.value.substr(i[0].end,t.value.length);y++)s=this.selection.getLine(t,i[0].line+y),Object(r.isNullOrUndefined)(s)?o+="":(h=s.split(". "),v=this.getTabSpace(s),(v.length<k.length&&(d=!1),h.length>1&&/^\d+$/.test(h[0].trim())&&b.length===v.length&&d)?(g=this.nextOrderedListValue(h[0]),h.splice(0,1),o=o+v+g+h.join(". ")+"\n"):(o=o+s+"\n",k=this.getTabSpace(s)));t.value=t.value.substr(0,i[0].start)+b+f+this.selection.getLine(t,i[0].line)+o;c=c+f.length+e.length;a+=f.length+e.length}else("UL"===this.currentAction&&w.test(u.trim())&&""!==u.trim().replace(w,"")||"OL"===this.currentAction&&!p)&&(e=this.getTabSpace(u),f=this.syntax[this.currentAction],i[0].text=e+f+i[0].text+(i[0].text.trim().length>0?"\n":""),t.value=t.value.substr(0,i[0].start)+i[0].text+t.value.substr(i[0].end,t.value.length),c=c+f.length+e.length,a+=f.length+e.length);this.restore(t,c,nt+a,n)},n.prototype.olListType=function(){var n=this.syntax.OL.split(".,");return(1===n.length?null:parseInt(n[2].trim(),null)-parseInt(n[0].trim(),null))?1:0},n.prototype.applyListsHandler=function(n){var f=this.parent.element,p,i,u,w,e;this.selection.save(f.selectionStart,f.selectionEnd);this.currentAction=n.subCommand;var l,s,h=f.selectionStart,a=f.selectionEnd,v=0,y=0,c=0,t=this.selection.getSelectedParentPoints(f),o="";for(l=this.olListType(),p={},i=0;i<t.length;i++)if(s=l?"OL"===this.currentAction?i+l+". ":this.syntax[this.currentAction]:"OL"===this.currentAction?this.syntax.OL:this.syntax[this.currentAction],this.selection.isStartWith(t[i].text,s))t[i].text=t[i].text.replace(s,""),f.value=f.value.substr(0,t[i].start+c)+t[i].text+"\n"+f.value.substr(t[i].end+c,f.value.length),c-=s.length,y=s.length,this.restore(f,h-y,a+c,null);else{if(""===t[i].text&&0===i&&(this.selection.save(h,a),1!==t.length))for(u=i;u<t.length;u++)t[u].start=0!==u?1+t[u].start:t[u].start,t[u].end=1+t[u].end;if(w=Object(r.isNullOrUndefined)(t[i-1])?0:this.getTabSpace(t[i-1].text).length,e=this.appliedLine(t[i].text,s,p,w),o=e.line?o:s,t[i].text=e.line?e.line:o+t[i].text,e.space=e.space?e.space:0,f.value=f.value.substr(0,t[i].start+c)+t[i].text+"\n"+f.value.substr(t[i].end,f.value.length),h=0===i?h+o.length+e.space>0?h+o.length+e.space:0:h,v+=o.length+e.space,1!==t.length)for(u=i;u<t.length;u++)t[u].start=0!==u?o.length+t[u].start+e.space:t[u].start,t[u].end=o.length+t[u].end+e.space;this.restore(f,h,a+v,null)}this.restore(f,null,null,n)},n.prototype.appliedLine=function(n,t,i,u){var e={},c=new RegExp("^["+this.syntax.UL.trim()+"]"),f=n.split(". "),l=f[0]+". ",v=c.test(n.trim())||n.trim()===this.syntax.OL.trim()||n.trim()===this.syntax.UL.trim()||/^\d+$/.test(f[0].trim()),a=this.olListType(),o=this.getTabSpace(n).length,s,h;return("OL"===this.currentAction&&a&&(i[o.toString()]=Object(r.isNullOrUndefined)(i[o.toString()])?1:i[o.toString()].valueOf()+1,t=i[o.toString()].valueOf().toString()+". ",!Object(r.isNullOrUndefined)(u)&&u>o&&(i[u.toString()]=0)),v)&&(s=void 0,h=void 0,c.test(n.trim())?(h=this.syntax.UL,s=t,e.space=t.trim().length-this.syntax.UL.trim().length):/^\d+$/.test(f[0].trim())&&a?(h=f[0].trim()+". ",s=t,e.space=this.syntax.UL.trim().length-l.trim().length):/^\d+$/.test(f[0].trim())&&(h=f[0].trim()+". ",s=this.syntax.UL,e.space=this.syntax.UL.trim().length-l.trim().length),e.line=n.replace(h,s)),e},n.prototype.restore=function(n,t,i,u){Object(r.isNullOrUndefined)(t)||Object(r.isNullOrUndefined)(t)||this.selection.save(t,i);Object(r.isNullOrUndefined)(u)||this.selection.restore(n);u&&u.callBack&&u.callBack({requestType:this.currentAction,selectedText:this.selection.getSelectedText(n),editorMode:"Markdown",event:u.event})},n.prototype.getListRegex=function(){for(var n,t="",r=Object.keys(this.syntax),i=0;i<r.length;i++)n=this.selection.replaceSpecialChar(this.syntax[r[i]]),t+=""===t?"^("+n+")|^("+n.trim()+")":"|^("+n+")|^("+n.trim()+")";return new RegExp(t)},n}(),sy=function(){function n(n){Object(r.extend)(this,this,n,!0);this.selection=this.parent.markdownSelection;this.addEventListener()}return n.prototype.addEventListener=function(){this.parent.observer.on(of,this.applyFormats,this)},n.prototype.applyFormats=function(n){var i,t,f,u;if(n.subCommand=n.subCommand.toLowerCase(),i=this.parent.element,this.selection.save(i.selectionStart,i.selectionEnd),t=this.selection.getSelectedParentPoints(i),this.isAppliedFormat(t)===n.subCommand){if("pre"===n.subCommand){if(!(t.length>1))return;this.applyCodeBlock(i,n,t)}return this.cleanFormat(i),void this.restore(i,i.selectionStart,i.selectionEnd,n)}if("p"===n.subCommand)return this.cleanFormat(i),void this.restore(i,i.selectionStart,i.selectionEnd,n);("pre"===n.subCommand&&1!==t.length||"pre"!==n.subCommand)&&this.cleanFormat(i,n.subCommand);var e=i.selectionStart,o=i.selectionEnd,s=0;if(t=this.selection.getSelectedParentPoints(i),"pre"!==n.subCommand){for(f=0;f<t.length;f++)if(""===t[f].text||this.selection.isStartWith(t[f].text,"\\"+this.syntax[n.subCommand])){if(""===t[f].text&&0===f&&(this.selection.save(e,o),1!==t.length))for(u=f;u<t.length;u++)t[u].start=0!==u?1+t[u].start:t[u].start,t[u].end=1+t[u].end}else if(t[f].text=this.syntax[n.subCommand]+t[f].text,i.value=i.value.substr(0,t[f].start)+t[f].text+"\n"+i.value.substr(t[f].end,i.value.length),e=0===f?e+this.syntax[n.subCommand].length:e,s+=this.syntax[n.subCommand].length,1!==t.length)for(u=f;u<t.length;u++)t[u].start=0!==u?this.syntax[n.subCommand].length+t[u].start:t[u].start,t[u].end=this.syntax[n.subCommand].length+t[u].end;this.restore(i,e,o+s,n)}else t.length>1?this.applyCodeBlock(i,n,t):(Object(r.extend)(n,n,{subCommand:"InlineCode"},!0),this.parent.observer.notify(fs,n))},n.prototype.clearRegex=function(){for(var i="",t=Object.keys(this.syntax),n=0;n<t.length&&"pre"!==t[n]&&"p"!==t[n];n++)i+=""===i?"^("+this.selection.replaceSpecialChar(this.syntax[t[n]].trim())+")":"|^("+this.selection.replaceSpecialChar(this.syntax[t[n]].trim())+")";return i},n.prototype.cleanFormat=function(n,t){var i=this.selection.getSelectedParentPoints(n),o=n.selectionStart,c=n.selectionEnd,l=0,r,s,u,e,h,f;if(this.selection.isClear(i,this.clearRegex())){for(r=0;r<i.length;r++){for(s=Object.keys(this.syntax),u=0;""!==i[r].text&&u<s.length;u++)if(e=this.syntax[s[u]],s[u]!==t&&(h=new RegExp("^("+this.selection.replaceSpecialChar(e)+")","gim"),h.test(i[r].text))){if(i[r].text=i[r].text.replace(h,""),n.value=n.value.substr(0,i[r].start)+i[r].text+"\n"+n.value.substr(i[r].end,n.value.length),o=0===r?o-e.length>0?o-e.length:0:o,l+=e.length,1!==i.length)for(f=0;f<i.length;f++)i[f].start=0!==f?i[f].start-e.length:i[f].start,i[f].end=i[f].end-e.length;break}if(""===i[r].text&&0===r&&(this.selection.save(o,c),1!==i.length))for(u=r;u<i.length;u++)i[u].start=0!==u?1+i[u].start:i[u].start,i[u].end=1+i[u].end}this.restore(n,o,c-l)}},n.prototype.applyCodeBlock=function(n,t,i){var e=t.subCommand,r=i[0].start,u=i[i.length-1].end,h=this.selection.getAllParents(n.value),y=h[i[0].line-1],p=h[i.length+1+1],l,a,s,v;if(this.selection.isStartWith(y,this.syntax.pre.split("\n")[0])||this.selection.isStartWith(p,this.syntax.pre.split("\n")[0])){var f=this.syntax[e],o=this.parent.markdownSelection.getSelectedInlinePoints(n),w=n.value.substr(0,n.selectionStart).lastIndexOf(f),c=n.value.substr(n.selectionEnd,n.selectionEnd).indexOf(f);c+=o.end;l=this.replaceAt(n.value.substr(0,o.start),f,"",w,o.start);a=this.replaceAt(n.value.substr(o.end,n.value.length),f,"",0,c);n.value=l+o.text+a;r=this.selection.selectionStart-f.length;u=this.selection.selectionEnd-f.length}else s=n.value.substring(r,u).split("\n"),v=""===s[s.length-1]?"":"\n",n.value=n.value.substr(0,r)+this.syntax[e]+n.value.substring(r,u)+v+this.syntax[e]+n.value.substr(u,n.value.length),r=this.selection.selectionStart+this.syntax[e].length,u=this.selection.selectionEnd+this.syntax[e].length-1;this.restore(n,r,u,t)},n.prototype.replaceAt=function(n,t,i,r,u){return n.slice(0,r)+n.slice(r,u).replace(t,i)+n.slice(u)},n.prototype.restore=function(n,t,i,r){this.selection.save(t,i);this.selection.restore(n);r&&r.callBack&&r.callBack({requestType:r.subCommand,selectedText:this.selection.getSelectedText(n),editorMode:"Markdown",event:r.event})},n.prototype.isAppliedFormat=function(n,t){for(var u="p",r=(Object.keys(this.syntax),Object.keys(this.syntax)),e="backward"===this.parent.element.selectionDirection?n[0].text:n[n.length-1].text,i=0;!t&&i<r.length;i++){if("pre"!==r[i]&&this.selection.isStartWith(e,this.syntax[r[i]])){u=r[i];break}if("pre"===r[i]){var f=this.selection.getAllParents(this.parent.element.value),o=f[n[0].line-1],s=f[n.length+1];if(this.selection.isStartWith(o,this.syntax[r[i]].split("\n")[0])&&this.selection.isStartWith(s,this.syntax[r[i]].split("\n")[0])){u=r[i];break}}}return u},n}(),hy=function(){function n(n){Object(r.extend)(this,this,n,!0);this.selection=this.parent.markdownSelection;this.addEventListener()}return n.prototype.addEventListener=function(){this.parent.observer.on(fs,this.applyCommands,this);this.parent.observer.on(v,this.keyDownHandler,this)},n.prototype.keyDownHandler=function(n){switch(n.event.action){case"bold":this.applyCommands({subCommand:"Bold",callBack:n.callBack});n.event.preventDefault();break;case"italic":this.applyCommands({subCommand:"Italic",callBack:n.callBack});n.event.preventDefault();break;case"strikethrough":this.applyCommands({subCommand:"StrikeThrough",callBack:n.callBack});n.event.preventDefault();break;case"uppercase":this.applyCommands({subCommand:"UpperCase",callBack:n.callBack});n.event.preventDefault();break;case"lowercase":this.applyCommands({subCommand:"LowerCase",callBack:n.callBack});n.event.preventDefault();break;case"superscript":this.applyCommands({subCommand:"SuperScript",callBack:n.callBack});n.event.preventDefault();break;case"subscript":this.applyCommands({subCommand:"SubScript",callBack:n.callBack});n.event.preventDefault()}},n.prototype.isBold=function(n,t){return-1!==n.search("\\"+t+"\\"+t)},n.prototype.isItalic=function(n,t){return-1!==n.search("\\"+t)},n.prototype.isMatch=function(n,t){var i=[""];switch(t){case this.syntax.Italic:case this.syntax.InlineCode:case this.syntax.StrikeThrough:i=n.match(this.singleCharRegx(t))}return i},n.prototype.multiCharRegx=function(n){return new RegExp("(\\"+n+"\\"+n+")","g")},n.prototype.singleCharRegx=function(n){return new RegExp("(\\"+n+")","g")},n.prototype.isAppliedCommand=function(n){var h,i=!1,e=this.parent.element,l=e.selectionStart,t=(h=l,function(n){return[n.slice(0,h),n.slice(h)]})(e.value),u=this.syntax.Bold.substr(0,1),c=this.syntax.Italic,o=this.parent.markdownSelection.getSelectedText(e),f,s;return""!==o&&o===o.toLocaleUpperCase()&&"UpperCase"===n?!0:""===o&&(f=e.value.substr(t[0].length-1,1),s=t[1].substr(0,1),""!==f&&""!==s&&f.match(/[a-z]/i)&&f===f.toLocaleUpperCase()&&s===s.toLocaleUpperCase()&&"UpperCase"===n)?!0:(this.isBold(t[0],u)||this.isItalic(t[0],c)||this.isBold(t[1],u)||this.isItalic(t[1],c)||(Object(r.isNullOrUndefined)(this.isMatch(t[0],this.syntax.StrikeThrough))||Object(r.isNullOrUndefined)(this.isMatch(t[1],this.syntax.StrikeThrough))||this.isMatch(t[0],this.syntax.StrikeThrough).length%2!=1||this.isMatch(t[1],this.syntax.StrikeThrough).length%2!=1||"StrikeThrough"!==n||(i=!0),Object(r.isNullOrUndefined)(this.isMatch(t[0],this.syntax.InlineCode))||Object(r.isNullOrUndefined)(this.isMatch(t[1],this.syntax.InlineCode))||this.isMatch(t[0],this.syntax.InlineCode).length%2!=1||this.isMatch(t[1],this.syntax.InlineCode).length%2!=1||"InlineCode"!==n||(i=!0),Object(r.isNullOrUndefined)(t[0].match(/\<sub>/g))||Object(r.isNullOrUndefined)(t[1].match(/\<\/sub>/g))||t[0].match(/\<sub>/g).length%2!=1||t[1].match(/\<\/sub>/g).length%2!=1||"SubScript"!==n||(i=!0),Object(r.isNullOrUndefined)(t[0].match(/\<sup>/g))||Object(r.isNullOrUndefined)(t[1].match(/\<\/sup>/g))||t[0].match(/\<sup>/g).length%2!=1||t[1].match(/\<\/sup>/g).length%2!=1||"SuperScript"!==n||(i=!0)),this.isBold(t[0],u)&&this.isBold(t[1],u)&&t[0].match(this.multiCharRegx(u)).length%2==1&&t[1].match(this.multiCharRegx(u)).length%2==1&&"Bold"===n&&(i=!0),t[0]=this.isBold(t[0],u)?t[0].replace(this.multiCharRegx(u),"$%@"):t[0],t[1]=this.isBold(t[1],u)?t[1].replace(this.multiCharRegx(u),"$%@"):t[1],Object(r.isNullOrUndefined)(this.isMatch(t[0],this.syntax.Italic))||Object(r.isNullOrUndefined)(this.isMatch(t[1],this.syntax.Italic))||this.isMatch(t[0],this.syntax.Italic).length%2!=1||this.isMatch(t[1],this.syntax.Italic).length%2!=1||"Italic"!==n||(i=!0),Object(r.isNullOrUndefined)(this.isMatch(t[0],this.syntax.StrikeThrough))||Object(r.isNullOrUndefined)(this.isMatch(t[1],this.syntax.StrikeThrough))||this.isMatch(t[0],this.syntax.StrikeThrough).length%2!=1||this.isMatch(t[1],this.syntax.StrikeThrough).length%2!=1||"StrikeThrough"!==n||(i=!0),Object(r.isNullOrUndefined)(this.isMatch(t[0],this.syntax.InlineCode))||Object(r.isNullOrUndefined)(this.isMatch(t[1],this.syntax.InlineCode))||this.isMatch(t[0],this.syntax.InlineCode).length%2!=1||this.isMatch(t[1],this.syntax.InlineCode).length%2!=1||"InlineCode"!==n||(i=!0),Object(r.isNullOrUndefined)(t[0].match(/\<sub>/g))||Object(r.isNullOrUndefined)(t[1].match(/\<\/sub>/g))||t[0].match(/\<sub>/g).length%2!=1||t[1].match(/\<\/sub>/g).length%2!=1||"SubScript"!==n||(i=!0),Object(r.isNullOrUndefined)(t[0].match(/\<sup>/g))||Object(r.isNullOrUndefined)(t[1].match(/\<\/sup>/g))||t[0].match(/\<sup>/g).length%2!=1||t[1].match(/\<\/sup>/g).length%2!=1||"SuperScript"!==n||(i=!0),i)},n.prototype.applyCommands=function(n){var i,e,o,c,s;this.currentAction=n.subCommand;i=this.parent.element;this.selection.save(i.selectionStart,i.selectionEnd);var u=i.selectionStart,f=i.selectionEnd,r=0,t=this.parent.markdownSelection.getSelectedInlinePoints(i);if(this.isAppliedCommand(n.subCommand)&&""!==t.text){var h=this.syntax[n.subCommand],l="SubScript"===n.subCommand?"<\/sub>":"SuperScript"===n.subCommand?"<\/sup>":this.syntax[n.subCommand],a="UpperCase"===n.subCommand||"LowerCase"===n.subCommand?0:h.length,y=i.value.substr(0,t.start).lastIndexOf(h),v=i.value.substr(t.end,i.value.length).indexOf(l);return v+=t.end,e=this.replaceAt(i.value.substr(0,t.start),h,"",y,t.start),o=this.replaceAt(i.value.substr(t.end,i.value.length),l,"",0,v),i.value=e+t.text+o,void this.restore(i,u-a,f-a,n)}""===t.text||this.isApplied(t,n.subCommand)?"UpperCase"!==n.subCommand&&"LowerCase"!==n.subCommand?("SubScript"===n.subCommand||"SuperScript"===n.subCommand?(t.text=this.textReplace(t.text,n.subCommand),t.text=this.syntax[n.subCommand]+t.text+"<\/"+this.syntax[n.subCommand].substring(1,5)):(t.text=this.textReplace(t.text,n.subCommand),t.text=this.syntax[n.subCommand]+t.text+this.syntax[n.subCommand]),i.value=i.value.substr(0,t.start)+t.text+i.value.substr(t.end,i.value.length),r=this.syntax[n.subCommand].length,t.start===t.end?this.restore(i,u+r,f+r,n):this.restore(i,u+r,f-r,n)):this.restore(i,u,f,n):(r="UpperCase"===n.subCommand||"LowerCase"===n.subCommand?0:this.syntax[n.subCommand].length,c=i.value.substr(t.start-this.syntax[n.subCommand].length,this.syntax[n.subCommand].length),s=void 0,c===n.subCommand||t.start-this.syntax[n.subCommand].length===i.value.indexOf(this.syntax[n.subCommand])&&(t.end===i.value.lastIndexOf(this.syntax[n.subCommand])||t.end===i.value.lastIndexOf("<\/"+this.syntax[n.subCommand].substring(1,5)))?(s="SubScript"===n.subCommand||"SuperScript"===n.subCommand?i.value.substr(t.end,this.syntax[n.subCommand].length+1):i.value.substr(t.end,this.syntax[n.subCommand].length),e=this.replaceAt(i.value.substr(0,t.start),c,"",t.start-this.syntax[n.subCommand].length,t.start),o=this.replaceAt(i.value.substr(t.end,i.value.length),s,"",0,s.length),i.value=e+t.text+o,this.restore(i,u-r,f-r,n)):(t.text="SubScript"===n.subCommand||"SuperScript"===n.subCommand?this.syntax[n.subCommand]+t.text+"<\/"+this.syntax[n.subCommand].substring(1,5):"UpperCase"===n.subCommand||"LowerCase"===n.subCommand?"UpperCase"===n.subCommand?t.text.toUpperCase():t.text.toLowerCase():this.syntax[n.subCommand]+t.text+this.syntax[n.subCommand],i.value=i.value.substr(0,t.start)+t.text+i.value.substr(t.end,i.value.length),this.restore(i,u+r,f+r,n)));this.parent.undoRedoManager.saveData()},n.prototype.replaceAt=function(n,t,i,r,u){return n.slice(0,r)+n.slice(r,u).replace(t,i)+n.slice(u)},n.prototype.restore=function(n,t,i,r){this.selection.save(t,i);this.selection.restore(n);r&&r.callBack&&r.callBack({requestType:this.currentAction,selectedText:this.selection.getSelectedText(n),editorMode:"Markdown",event:r.event})},n.prototype.textReplace=function(n,t){var i=this.singleCharRegx(this.syntax[t]),u,r,f;switch(t){case"Bold":i=this.multiCharRegx(this.syntax[t].substr(0,1));n=n.replace(i,"");break;case"Italic":this.isBold(n,this.syntax[t].substr(0,1))?(u=this.multiCharRegx(this.syntax[t].substr(0,1)),r=n,r=r.replace(u,"$%@").replace(i,""),f=new RegExp("\\$%@","g"),n=r.replace(f,this.syntax[t].substr(0,1)+this.syntax[t].substr(0,1))):n=n.replace(i,"");break;case"StrikeThrough":case"InlineCode":n=n.replace(i,"");break;case"SubScript":n=n.replace(/<sub>/g,"").replace(/<\/sub>/g,"");break;case"SuperScript":n=n.replace(/<sup>/g,"").replace(/<\/sup>/g,"")}return n},n.prototype.isApplied=function(n,t){var i=this.singleCharRegx(this.syntax[t]),r,f,u;switch(t){case"SubScript":case"SuperScript":return(i=this.singleCharRegx(this.syntax[t])).test(n.text);case"Bold":case"StrikeThrough":return(i=this.multiCharRegx(this.syntax[t].substr(0,1))).test(n.text);case"UpperCase":case"LowerCase":return(i=new RegExp("^["+this.syntax[t]+"]*$","g")).test(n.text);case"Italic":return r=void 0,f=this.multiCharRegx(this.syntax[t].substr(0,1)),f.test(n.text)?(u=n.text,u=u.replace(f,"$%#"),r=i.test(u)):r=i.test(n.text),r;case"InlineCode":return i.test(n.text)}},n}(),pc={h6:"###### ",h5:"##### ",h4:"#### ",h3:"### ",h2:"## ",h1:"# ",blockquote:"> ",pre:"```\n",p:""},wc={Bold:"**",Italic:"*",StrikeThrough:"~~",InlineCode:"`",SubScript:"<sub>",SuperScript:"<sup>",UpperCase:"A-Z",LowerCase:"a-z"},bc={OL:"1. ",UL:"- "},cy={"toolbar-focus":"alt+f10",escape:"27","insert-link":"ctrl+k","insert-image":"ctrl+shift+i","insert-table":"ctrl+shift+e",undo:"ctrl+z",redo:"ctrl+y",copy:"ctrl+c",cut:"ctrl+x",paste:"ctrl+v",bold:"ctrl+b",italic:"ctrl+i",underline:"ctrl+u",strikethrough:"ctrl+shift+s",uppercase:"ctrl+shift+u",lowercase:"ctrl+shift+l",superscript:"ctrl+shift+=",subscript:"ctrl+=",indents:"ctrl+]",outdents:"ctrl+[","html-source":"ctrl+shift+h","full-screen":"ctrl+shift+f","decrease-fontsize":"ctrl+shift+<","increase-fontsize":"ctrl+shift+>","justify-center":"ctrl+e","justify-full":"ctrl+j","justify-left":"ctrl+l","justify-right":"ctrl+r","clear-format":"ctrl+shift+r","ordered-list":"ctrl+shift+o","unordered-list":"ctrl+alt+o",space:"32",enter:"13",tab:"tab","delete":"46"},ly={"toolbar-focus":"alt+f10",escape:"27","insert-link":"ctrl+k","insert-image":"ctrl+shift+i","insert-table":"ctrl+shift+e",undo:"ctrl+z",redo:"ctrl+y",copy:"ctrl+c",cut:"ctrl+x",paste:"ctrl+v",bold:"ctrl+b",italic:"ctrl+i",strikethrough:"ctrl+shift+s",uppercase:"ctrl+shift+u",lowercase:"ctrl+shift+l",superscript:"ctrl+shift+=",subscript:"ctrl+=","full-screen":"ctrl+shift+f","ordered-list":"ctrl+shift+o","unordered-list":"ctrl+alt+o"},kc={b:["strong"],strong:["b"],i:["emp","cite"],emp:["i","cite"],cite:["i","emp"]},uk={first:"MsoListParagraphCxSpFirst",middle:"MsoListParagraphCxSpMiddle",last:"MsoListParagraphCxSpLast"},dc=["BR","IMG"],ay=function(){function n(n,t){this.undoRedoStack=[];this.parent=n;this.undoRedoSteps=Object(r.isNullOrUndefined)(t)?30:t.undoRedoSteps;this.undoRedoTimer=Object(r.isNullOrUndefined)(t)?300:t.undoRedoTimer;this.selection=this.parent.markdownSelection;this.addEventListener()}return n.prototype.addEventListener=function(){var n=Object(r.debounce)(this.keyUp,this.undoRedoTimer);this.parent.observer.on(li,n,this);this.parent.observer.on(v,this.keyDown,this);this.parent.observer.on(ki,this.onAction,this);this.parent.observer.on(eu,this.onPropertyChanged,this)},n.prototype.onPropertyChanged=function(n){for(var t=0,i=Object.keys(n.newProp);t<i.length;t++)switch(i[t]){case"undoRedoSteps":this.undoRedoSteps=n.newProp.undoRedoSteps;break;case"undoRedoTimer":this.undoRedoTimer=n.newProp.undoRedoTimer}},n.prototype.removeEventListener=function(){var n=Object(r.debounce)(this.keyUp,300);this.parent.observer.off(li,n);this.parent.observer.off(v,this.keyDown);this.parent.observer.off(ki,this.onAction);this.parent.observer.off(eu,this.onPropertyChanged)},n.prototype.destroy=function(){this.removeEventListener()},n.prototype.onAction=function(n){"Undo"===n.subCommand?this.undo(n):this.redo(n)},n.prototype.keyDown=function(n){var t=n.event;switch(t.action){case"undo":t.preventDefault();this.undo(n);break;case"redo":t.preventDefault();this.redo(n)}},n.prototype.keyUp=function(n){17===n.event.keyCode||n.event.ctrlKey||this.saveData(n)},n.prototype.saveData=function(n){var t=this.parent.element;this.selection.save(t.selectionStart,t.selectionEnd);var i=t.selectionStart,r=t.selectionEnd,u={text:this.parent.element.value,start:i,end:r};this.undoRedoStack.length>=this.steps&&(this.undoRedoStack=this.undoRedoStack.slice(0,this.steps+1));this.undoRedoStack.length>1&&this.undoRedoStack[this.undoRedoStack.length-1].start===i&&this.undoRedoStack[this.undoRedoStack.length-1].end===r||(this.undoRedoStack.push(u),this.steps=this.undoRedoStack.length-1,this.steps>this.undoRedoSteps&&(this.undoRedoStack.shift(),this.steps--),n&&n.callBack&&n.callBack())},n.prototype.undo=function(n){if(this.steps>0){this.currentAction="Undo";var t=this.undoRedoStack[this.steps-1].start,i=this.undoRedoStack[this.steps-1].end,r=this.undoRedoStack[this.steps-1].text;this.parent.element.value=r;this.parent.element.focus();this.steps--;this.restore(this.parent.element,t,i,n)}},n.prototype.redo=function(n){if(null!=this.undoRedoStack[this.steps+1]){this.currentAction="Redo";var t=this.undoRedoStack[this.steps+1].start,i=this.undoRedoStack[this.steps+1].end;this.parent.element.value=this.undoRedoStack[this.steps+1].text;this.parent.element.focus();this.steps++;this.restore(this.parent.element,t,i,n)}},n.prototype.restore=function(n,t,i,r){this.selection.save(t,i);this.selection.restore(n);r&&r.callBack&&r.callBack({requestType:this.currentAction,selectedText:this.selection.getSelectedText(n),editorMode:"Markdown",event:r.event})},n.prototype.getUndoStatus=function(){var n={undo:!1,redo:!1};return this.steps>0&&(n.undo=!0),null!=this.undoRedoStack[this.steps+1]&&(n.redo=!0),n},n}(),vy=function(){function n(n){this.parent=n;this.selection=this.parent.markdownSelection;this.addEventListener()}return n.prototype.addEventListener=function(){this.parent.observer.on(vc,this.createLink,this)},n.prototype.createLink=function(n){var t=this.parent.element;t.focus();var r=t.selectionStart,u=t.selectionEnd,i="Image"===n.subCommand?this.selection.getSelectedText(t):n.item.text,f="Image"===n.subCommand?r+2:r+1,e="Image"===n.subCommand?u+2:u+1;i="Image"===n.subCommand?"!["+i+"]("+n.item.url+")":"["+i+"]("+n.item.url+")";t.value=t.value.substr(0,r)+i+t.value.substr(u,t.value.length);this.parent.markdownSelection.setSelection(t,f,e);this.restore(t,f,e,n)},n.prototype.restore=function(n,t,i,r){this.selection.save(t,i);this.selection.restore(n);r&&r.callBack&&r.callBack({requestType:r.subCommand,selectedText:this.selection.getSelectedText(n),editorMode:"Markdown",event:r.event})},n}(),yy=function(){function n(n){Object(r.extend)(this,this,n,!0);this.selection=this.parent.markdownSelection;this.addEventListener()}return n.prototype.addEventListener=function(){this.parent.observer.on(es,this.createTable,this);this.parent.observer.on(v,this.onKeyDown,this)},n.prototype.removeEventListener=function(){this.parent.observer.off(es,this.createTable);this.parent.observer.off(v,this.onKeyDown)},n.prototype.destroy=function(){this.removeEventListener()},n.prototype.onKeyDown=function(n){"insert-table"===n.event.action&&(n.item=n.value,this.createTable(n))},n.prototype.createTable=function(n){this.element=this.parent.element;var t,i=this.element.selectionStart,r=this.element.selectionEnd;t=this.element.value;this.locale=n;this.selection.save(i,r);this.restore(this.element.selectionStart,this.element.selectionEnd,null);this.insertTable(i,r,t,n)},n.prototype.getTable=function(){var n="";return n+=this.textNonEmpty(),n+=this.tableHeader(this.locale),n+this.tableCell(this.locale)},n.prototype.tableHeader=function(n){for(var r,t="",i=1;i<=2;i++){for(t+="|",r=1;r<=2;r++)t+=1===i?n.item.headingText+" "+r+"|":"---------|";t+=this.insertLine()}return t},n.prototype.tableCell=function(n){for(var r,t="",i=1;i<=2;i++){for(t+="|",r=1;r<=2;r++)t+=n.item.colText+" "+this.convertToLetters(i)+r+"|";t+=this.insertLine()}return t+this.insertLine()},n.prototype.insertLine=function(){var n=document.createElement("div");return n.innerHTML="\n",n.textContent},n.prototype.insertTable=function(n,t,i,r){var u=this.selection.getSelectedParentPoints(this.element),f=u[u.length-1].text.split(" ",2),e=this.getFormatTag();f.length<2?(this.element.value=this.updateValue(this.getTable()),this.makeSelection(i,n,t)):this.ensureFormatApply(u[u.length-1].text)?this.checkValid(n,t,this.getTable(),i,r,f,u,e):(this.element.value=this.updateValue(this.getTable()),this.makeSelection(i,n,t));this.restore(this.element.selectionStart,this.element.selectionEnd,r)},n.prototype.makeSelection=function(n,t,i){i=t+(n.length>0?12:10);t+=n.length>0?3:1;this.selection.setSelection(this.element,t,i)},n.prototype.getFormatTag=function(){for(var n,r=Object.keys(this.syntaxTag.Formats),u=Object.keys(this.syntaxTag.List),t=[],i=0;i<r.length;i++)t.push(this.syntaxTag.Formats[r[i]]);for(n=0;n<u.length;n++)t.push(this.syntaxTag.List[u[n]]);return t},n.prototype.ensureFormatApply=function(n){for(var i=this.getFormatTag(),r=n.trim().split(" ",2)[0]+" ",t=0;t<i.length;t++)if(r===i[t]||/^[\d.]+[ ]+$/.test(r))return!0;return!1},n.prototype.ensureStartValid=function(n,t){for(var r=t[0].text.split(" ",2),i=n+1;i<=n+r[0].length+1;i++)if(this.element.selectionStart===i||this.element.selectionEnd===i)return!1;return!0},n.prototype.ensureEndValid=function(n,t){for(var i=n+1;i<=n+t+1;i++)if(this.element.selectionEnd===i)return!1;return!0},n.prototype.updateValueWithFormat=function(n,t){var i=this.element.value.substring(this.element.selectionEnd,this.element.value.length);return t+=i.replace(i,n[0]+" "+i),this.element.value.substr(0,this.element.selectionStart)+t},n.prototype.updateValue=function(n){return this.element.value.substr(0,this.element.selectionStart)+n+this.element.value.substr(this.element.selectionEnd,this.element.value.length)},n.prototype.checkValid=function(n,t,i,r,u,f,e){this.ensureStartValid(e[0].start,e)&&this.ensureEndValid(e[e.length-1].start,f[0].length)&&(this.element.value=n===e[0].start?n!==t&&t!==e[e.length-1].end-1?this.updateValueWithFormat(f,i):this.updateValue(i):t===e[e.length-1].end-1?this.updateValue(i):this.updateValueWithFormat(f,i),this.makeSelection(r,n,t))},n.prototype.convertToLetters=function(n){var i="A".charCodeAt(0),t="";do n-=1,t=String.fromCharCode(i+n%26)+t,n=n/26>>0;while(n>0);return t},n.prototype.textNonEmpty=function(){var n="";return(this.isCursorBased()||this.isSelectionBased())&&this.element.value.length>0&&(n+=this.insertLine(),n+=this.insertLine()),n},n.prototype.isCursorBased=function(){return this.element.selectionStart===this.element.selectionEnd},n.prototype.isSelectionBased=function(){return this.element.selectionStart!==this.element.selectionEnd},n.prototype.restore=function(n,t,i){this.selection.save(n,t);this.selection.restore(this.element);i&&i.callBack&&i.callBack({requestType:i.subCommand,selectedText:this.selection.getSelectedText(this.element),editorMode:"Markdown",event:i.event})},n}(),py=function(){function n(n){this.parent=n;this.selection=this.parent.markdownSelection;this.addEventListener()}return n.prototype.addEventListener=function(){this.parent.observer.on(yc,this.clear,this)},n.prototype.replaceRegex=function(n){return n.replace(/\*/gi,"\\*").replace(/\&/gi,"\\&").replace(/\-/gi,"\\-").replace(/\^/gi,"\\^").replace(/\$/gi,"\\$").replace(/\./gi,"\\.").replace(/\|/gi,"\\|").replace(/\?/gi,"\\?").replace(/\+/gi,"\\+").replace(/\-/gi,"\\-").replace(/\&/gi,"\\&")},n.prototype.clearSelectionTags=function(n){for(var i,e,c,o,s,r,u,t=this.parent.selectionTags,h=Object.keys(t),f=0;f<h.length;f++)if(i=h[f],t.hasOwnProperty(i)&&""!==t[i])for(o=this.replaceRegex(t[i]),s=void 0,s="<sup>"===t[i]?new RegExp("<sup>(.*?)<\/sup>","ig"):"<sub>"===t[i]?new RegExp("<sub>(.*?)<\/sub>","ig"):new RegExp(o+"(.*?)"+o,"ig"),e=t[i].length,c="<sup>"===t[i]||"<sub>"===t[i]?t[i].length+1:t[i].length,r=n.match(s),u=0;r&&u<r.length&&""!==r[u];u++)n=n.replace(r[u],r[u].substr(e,r[u].length-c-e));return n},n.prototype.clearFormatTags=function(n){var t=n.split("\n");return this.clearFormatLines(t)},n.prototype.clearFormatLines=function(n){for(var u,r,o=[this.parent.formatTags,this.parent.listTags],f="",t=0;t<n.length;t++){for(u=0;u<o.length;u++)for(var i=o[u],s=Object.keys(i),e=0;e<s.length;e++)r=s[e],i.hasOwnProperty(r)&&""!==i[r]&&0===n[t].indexOf(i[r])&&(n[t]=n[t].replace(i[r],""),n[t]=this.clearFormatLines([n[t]]));f=f+n[t]+(t!==n.length-1?"\n":"")}return f},n.prototype.clear=function(n){var t=this.parent.element;t.focus();var r=t.selectionStart,u=t.selectionEnd,i=this.selection.getSelectedText(t);i=this.clearSelectionTags(i);i=this.clearFormatTags(i);t.value=t.value.substr(0,r)+i+t.value.substr(u,t.value.length);this.parent.markdownSelection.setSelection(t,r,r+i.length);this.restore(t,r,r+i.length,n)},n.prototype.restore=function(n,t,i,r){this.selection.save(t,i);this.selection.restore(n);r&&r.callBack&&r.callBack({requestType:r.subCommand,selectedText:this.selection.getSelectedText(n),editorMode:"Markdown",event:r.event})},n}(),wy=function(){function n(n){this.initialize();Object(r.extend)(this,this,n,!0);this.observer=new r.Observer(this);this.markdownSelection=new is;this.listObj=new oy({parent:this,syntax:this.listTags});this.formatObj=new sy({parent:this,syntax:this.formatTags});this.undoRedoManager=new ay(this,n.options);this.mdSelectionFormats=new hy({parent:this,syntax:this.selectionTags});this.linkObj=new vy(this);this.tableObj=new yy({parent:this,syntaxTag:{Formats:this.formatTags,List:this.listTags}});this.clearObj=new py(this);this.wireEvents()}return n.prototype.initialize=function(){this.formatTags=pc;this.listTags=bc;this.selectionTags=wc},n.prototype.wireEvents=function(){this.observer.on(rs,this.editorKeyDown,this);this.observer.on(fu,this.editorKeyUp,this);this.observer.on(us,this.onPropertyChanged,this)},n.prototype.onPropertyChanged=function(n){this.observer.notify(eu,n)},n.prototype.editorKeyDown=function(n){this.observer.notify(v,n)},n.prototype.editorKeyUp=function(n){this.observer.notify(li,n)},n.prototype.execCommand=function(n,t,i,r,u,f){switch(n.toLocaleLowerCase()){case"lists":this.observer.notify(ac,{subCommand:t,event:i,callBack:r});break;case"formats":this.observer.notify(of,{subCommand:t,event:i,callBack:r});break;case"actions":this.observer.notify(ki,{subCommand:t,event:i,callBack:r});break;case"style":case"effects":case"casing":this.observer.notify(fs,{subCommand:t,event:i,callBack:r});break;case"links":case"images":this.observer.notify(vc,{subCommand:t,event:i,callBack:r,item:f});break;case"table":switch(t.toString().toLocaleLowerCase()){case"createtable":this.observer.notify(es,{subCommand:t,item:f,event:i,callBack:r})}break;case"clear":this.observer.notify(yc,{subCommand:t,event:i,callBack:r})}},n}(),fk=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),by=function(n){function t(t){var i=n.call(this)||this;return i.initialize(),Object(r.extend)(i,i,t,!0),t&&i.element&&i.updateFormatter(i.element,document,t.options),i}return fk(t,n),t.prototype.initialize=function(){this.keyConfig=ly;this.formatTags=pc;this.listTags=bc;this.selectionTags=wc},t.prototype.updateFormatter=function(n,t,i){n&&(this.editorManager=new wy({element:n,formatTags:this.formatTags,listTags:this.listTags,selectionTags:this.selectionTags,options:i}))},t}(lc),ky=function(){function n(n){this.parent=n}return n.prototype.renderPanel=function(){var t=this.parent,n=this.parent.createElement("div",{id:this.parent.getID()+"_view",className:"e-rte-content"});this.editableElement=this.parent.createElement("textarea",{className:"e-content",id:this.parent.getID()+"_editable-content"});n.appendChild(this.editableElement);this.setPanel(n);t.element.appendChild(n)},n.prototype.getPanel=function(){return this.contentPanel},n.prototype.getEditPanel=function(){return this.editableElement},n.prototype.getText=function(){return this.getEditPanel().value},n.prototype.setPanel=function(n){this.contentPanel=n},n.prototype.getDocument=function(){return this.getEditPanel().ownerDocument},n}(),ek=function(){function n(n,t){this.parent=n;this.locator=t;this.renderFactory=this.locator.getService("rendererFactory");this.addEventListener()}return n.prototype.destroy=function(){this.removeEventListener()},n.prototype.addEventListener=function(){this.parent.isDestroyed||(this.saveSelection=new is,this.parent.on(tr,this.instantiateRenderer,this),this.parent.on(p,this.render,this),this.parent.on(y,this.onPropertyChanged,this),this.parent.on(af,this.onToolbarClick,this),this.parent.on(h,this.destroy,this),this.parent.on(lr,this.selectAll,this),this.parent.on(ar,this.getSelectedHtml,this),this.parent.on(ht,this.onSelectionSave,this),this.parent.on(rt,this.onSelectionRestore,this),this.parent.on(vr,this.updateReadOnly,this))},n.prototype.updateReadOnly=function(){this.parent.readonly?(this.parent.contentModule.getEditPanel().setAttribute("readonly","readonly"),Object(r.addClass)([this.parent.element],nu)):(this.parent.contentModule.getEditPanel().removeAttribute("readonly"),Object(r.removeClass)([this.parent.element],nu))},n.prototype.onSelectionSave=function(){var n=this.parent.contentModule.getEditPanel();this.saveSelection.save(n.selectionStart,n.selectionEnd)},n.prototype.onSelectionRestore=function(){this.contentRenderer.getEditPanel().focus();var n=this.parent.contentModule.getEditPanel();this.saveSelection.restore(n)},n.prototype.onToolbarClick=function(n){var i,r,u,e=n.item,t=this.parent.contentModule.getEditPanel(),f;switch(t.focus(),r=t.selectionStart,u=t.selectionEnd,i=t.value.substring(r,u),e.subCommand){case"Maximize":this.parent.notify(lu,{args:n});break;case"Minimize":this.parent.notify(au,{args:n});break;case"CreateLink":this.parent.notify(vu,{member:"link",args:n,text:i,module:"Markdown"});break;case"Image":this.parent.notify(rr,{member:"image",args:n,text:i,module:"Markdown"});break;case"CreateTable":f={headingText:this.parent.localeObj.getConstant("TableHeadingText"),colText:this.parent.localeObj.getConstant("TableColText")};this.parent.formatter.process(this.parent,n,n.originalEvent,f);break;default:this.parent.formatter.process(this.parent,n,n.originalEvent,null)}},n.prototype.instantiateRenderer=function(){this.renderFactory.addRenderer(o.Content,new ky(this.parent))},n.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(p,this.render),this.parent.off(y,this.onPropertyChanged),this.parent.off(h,this.destroy),this.parent.off(af,this.onToolbarClick),this.parent.off(tr,this.instantiateRenderer),this.parent.off(lr,this.selectAll),this.parent.off(ar,this.getSelectedHtml),this.parent.off(ht,this.onSelectionSave),this.parent.off(rt,this.onSelectionRestore),this.parent.off(vr,this.updateReadOnly))},n.prototype.render=function(){this.contentRenderer=this.renderFactory.getRenderer(o.Content);var n=this.contentRenderer.getEditPanel(),t={undoRedoSteps:this.parent.undoRedoSteps,undoRedoTimer:this.parent.undoRedoTimer};Object(r.isNullOrUndefined)(this.parent.formatter)?this.parent.formatter=new by({element:n,options:t}):this.parent.formatter.updateFormatter(n,this.contentRenderer.getDocument(),t);this.parent.toolbarSettings.enable&&(this.toolbarUpdate=new fy(this.parent));this.parent.notify(hu,{})},n.prototype.onPropertyChanged=function(n){if(!Object(r.isNullOrUndefined)(n.newProp.formatter)){var t=this.contentRenderer.getEditPanel(),i={undoRedoSteps:this.parent.undoRedoSteps,undoRedoTimer:this.parent.undoRedoTimer};this.parent.formatter.updateFormatter(t,this.contentRenderer.getDocument(),i)}},n.prototype.getModuleName=function(){return"markdownEditor"},n.prototype.selectAll=function(){this.parent.formatter.editorManager.markdownSelection.setSelection(this.parent.contentModule.getEditPanel(),0,this.parent.contentModule.getEditPanel().value.length)},n.prototype.getSelectedHtml=function(n){n.callBack(this.parent.formatter.editorManager.markdownSelection.getSelectedText(this.parent.contentModule.getEditPanel()))},n}(),gc="INSERT-IMAGE",nl="INSERT-TABLE",tl="INSERT-LINK",il="INSERT-ROW",rl="INSERT-COLUMN",ul="DELETE-ROW",fl="DELETE-COLUMN",el="REMOVE-TABLE",ol="TABLE-HEADER",sl="TABLE_VERTICAL_ALIGN",hl="alignment-type",cl="indent-type",it="p",di=["address","article","aside","audio","blockquote","canvas","details","dd","div","dl","dt","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","li","main","nav","noscript","ol","output","p","pre","section","table","tbody","td","tfoot","th","thead","tr","ul","video","button","center","dir","frameset","iframe","isindex","map","menu","noframes","object"],at=["td","th"],ou=["table","tbody","td","tfoot","th","thead","tr"],ll="selection-type",al="inserthtml-type",vl="insert-text-type",yl="clear-type",k=function(){function n(){this.startNodeName=[];this.endNodeName=[]}return n.prototype.saveInstance=function(n,t){return this.range=n.cloneRange(),this.rootNode=this.documentFromRange(n),this.body=t,this.startContainer=this.getNodeArray(n.startContainer,!0),this.endContainer=this.getNodeArray(n.endContainer,!1),this.startOffset=n.startOffset,this.endOffset=n.endOffset,this.html=this.body.innerHTML,this},n.prototype.documentFromRange=function(n){return 9===n.startContainer.nodeType?n.startContainer:n.startContainer.ownerDocument},n.prototype.getRange=function(n){var i=this.get(n),t=i&&i.rangeCount>0?i.getRangeAt(i.rangeCount-1):n.createRange();return t.startContainer!==n||t.endContainer!==n||t.startOffset||t.endOffset||(t.setStart(n.body,0),t.collapse(!0)),t},n.prototype.get=function(n){return n.defaultView.getSelection()},n.prototype.save=function(n,t){return n=n?n.cloneRange():this.getRange(t),this.saveInstance(n,t.body)},n.prototype.getIndex=function(n){var t=0;if(n=n.previousSibling||"BR"!==n.tagName?n.previousSibling:n)for(n.nodeType;n;null)t++,n.nodeType,n=n.previousSibling;return t},n.prototype.isChildNode=function(n,t){for(var i=0;i<t.childNodes.length;i++)if(n.indexOf(t.childNodes[i])>-1)return!0;return!1},n.prototype.getNode=function(n,t,i){return t!==n||3!==n.nodeType&&n.firstChild&&-1===i.indexOf(n.firstChild)&&!this.isChildNode(i,n)?-1===i.indexOf(n.firstChild)&&n.firstChild&&!this.isChildNode(i,n)?n.firstChild:n.nextSibling?n.nextSibling:n.parentNode?n.parentNode:null:null},n.prototype.getNodeCollection=function(n){var t=n.startContainer.childNodes[n.startOffset]||n.startContainer,r=n.endContainer.childNodes[n.endOffset>0?n.endOffset-1:n.endOffset]||n.endContainer,i;if(t===r&&0===t.childNodes.length)return[t];if(n.startOffset===n.endOffset&&0!==n.startOffset&&"PRE"===n.startContainer.nodeName)return["BR"===t.nodeName||"#text"===t.nodeName?t:t.childNodes[0]];i=[];do-1===i.indexOf(t)&&i.push(t),t=this.getNode(t,r,i);while(t);return i},n.prototype.getParentNodeCollection=function(n){return this.getParentNodes(this.getNodeCollection(n),n)},n.prototype.getParentNodes=function(n,t){n=n.reverse();for(var i=0;i<n.length;i++)-1!==n.indexOf(n[i].parentNode)||3===n[i].nodeType&&t.startContainer!==t.endContainer&&t.startContainer.parentNode!==t.endContainer.parentNode?(n.splice(i,1),i--):3===n[i].nodeType&&(n[i]=n[i].parentNode);return n},n.prototype.getSelectionNodeCollection=function(n){return this.getSelectionNodes(this.getNodeCollection(n))},n.prototype.getSelectionNodes=function(n){n=n.reverse();for(var i=new RegExp(String.fromCharCode(8203),"g"),t=0;t<n.length;t++)(3!==n[t].nodeType||""===n[t].textContent.trim()||1===n[t].textContent.length&&n[t].textContent.match(i))&&(n.splice(t,1),t--);return n.reverse()},n.prototype.getInsertNodeCollection=function(n){return this.getInsertNodes(this.getNodeCollection(n))},n.prototype.getInsertNodes=function(n){n=n.reverse();for(var t=0;t<n.length;t++)(0!==n[t].childNodes.length&&3!==n[t].nodeType||3===n[t].nodeType&&""===n[t].textContent)&&(n.splice(t,1),t--);return n.reverse()},n.prototype.getNodeArray=function(n,t,i){var r=[];for(t?this.startNodeName=[]:this.endNodeName=[];n!==(i||this.rootNode);null)t?this.startNodeName.push(n.nodeName.toLowerCase()):this.endNodeName.push(n.nodeName.toLowerCase()),r.push(this.getIndex(n)),n=n.parentNode;return r},n.prototype.setRangePoint=function(n,t,i,r){for(var u=this.rootNode,f=i.length,e=r;f--;null)u=u&&u.childNodes[i[f]];return u&&e>=0&&n[t?"setStart":"setEnd"](u,e),n},n.prototype.restore=function(){var n=this.range.cloneRange();return n=this.setRangePoint(n,!0,this.startContainer,this.startOffset),n=this.setRangePoint(n,!1,this.endContainer,this.endOffset),this.selectRange(this.rootNode,n),n},n.prototype.selectRange=function(n,t){this.setRange(n,t);this.save(t,n)},n.prototype.setRange=function(n,t){var i=this.get(n);i.removeAllRanges();i.addRange(t)},n.prototype.setSelectionText=function(n,t,i,r,u){var f=n.createRange();f.setStart(t,r);f.setEnd(i,u);this.setRange(n,f)},n.prototype.setSelectionContents=function(n,t){var i=n.createRange();i.selectNode(t);this.setRange(n,i)},n.prototype.setSelectionNode=function(n,t){var i=n.createRange();i.selectNodeContents(t);this.setRange(n,i)},n.prototype.getSelectedNodes=function(n){return this.getNodeCollection(this.getRange(n))},n.prototype.Clear=function(n){this.get(n).removeAllRanges()},n.prototype.insertParentNode=function(n,t,i){i.surroundContents(t);this.selectRange(n,i)},n.prototype.setCursorPoint=function(n,t,i){var r=n.createRange(),u=n.defaultView.getSelection();r.setStart(t,i);r.collapse(!0);u.removeAllRanges();u.addRange(r)},n}(),s={startSelection:"e-editor-select-start",endSelection:"e-editor-select-end"},dy=function(){function n(n,t){this.parent=n;this.nodeSelection=new k;this.currentDocument=t}return n.prototype.contents=function(n){return n&&"IFRAME"!==n.tagName?Array.prototype.slice.call(n.childNodes||[]):[]},n.prototype.isBlockNode=function(n){return!!n&&n.nodeType===Node.ELEMENT_NODE&&di.indexOf(n.tagName.toLowerCase())>=0},n.prototype.isLink=function(n){return!!n&&n.nodeType===Node.ELEMENT_NODE&&"a"===n.tagName.toLowerCase()},n.prototype.blockParentNode=function(n){for(;n&&n.parentNode!==this.parent&&(!n.parentNode||!this.hasClass(n.parentNode,"e-node-inner"));null)if(n=n.parentNode,this.isBlockNode(n))return n;return n},n.prototype.rawAttributes=function(n){var u={},i=n.attributes,t,r;if(i.length>0)for(t=0;t<i.length;t++)r=i[t],u[r.nodeName]=r.value;return u},n.prototype.attributes=function(n){var i,t;if(!n)return"";for(var u="",f=this.rawAttributes(n),e=Object.keys(f).sort(),r=0;r<e.length;r++)i=e[r],t=f[i],u+=t.indexOf("'")<0&&t.indexOf('"')>=0?" "+i+"='"+t+"'":t.indexOf('"')>=0&&t.indexOf("'")>=0?" "+i+'="'+(t=t.replace(/"/g,"&quot;"))+'"':" "+i+'="'+t+'"';return u},n.prototype.clearAttributes=function(n){for(var r,i=n.attributes,t=i.length-1;t>=0;t--)r=i[t],n.removeAttribute(r.nodeName)},n.prototype.openTagString=function(n){return"<"+n.tagName.toLowerCase()+this.attributes(n)+">"},n.prototype.closeTagString=function(n){return"<\/"+n.tagName.toLowerCase()+">"},n.prototype.createTagString=function(n,t,i){return"<"+n.toLowerCase()+this.attributes(t)+">"+i+"<\/"+n.toLowerCase()+">"},n.prototype.isList=function(n){return!!n&&["UL","OL"].indexOf(n.tagName)>=0},n.prototype.isElement=function(n){return n===this.parent},n.prototype.isEditable=function(n){return(!n.getAttribute||"true"===n.getAttribute("contenteditable"))&&["STYLE","SCRIPT"].indexOf(n.tagName)<0},n.prototype.hasClass=function(n,t){return n&&n.classList&&n.classList.contains(t)},n.prototype.replaceWith=function(n,t){n.parentNode.insertBefore(this.parseHTMLFragment(t),n);Object(r.detach)(n)},n.prototype.parseHTMLFragment=function(n){var t=Object(r.createElement)("template");return t.innerHTML=n,t.content instanceof DocumentFragment?t.content:document.createRange().createContextualFragment(n)},n.prototype.wrap=function(n,t){return n.parentNode.insertBefore(t,n),(t=n.previousSibling).appendChild(n),t},n.prototype.insertAfter=function(n,t){t.parentNode.insertBefore(n,t.nextSibling)},n.prototype.wrapInner=function(n,t){for(n.appendChild(t),(t=n.querySelector(".e-rte-wrap-inner")).classList.remove("e-rte-wrap-inner"),0===t.classList.length&&t.removeAttribute("class");n.firstChild!==t;)t.appendChild(n.firstChild);return t},n.prototype.unWrap=function(n){for(var i=n.parentNode,t=[];n.firstChild;)t.push(n.firstChild),i.insertBefore(n.firstChild,n);return t=t.length>0?t:[n.parentNode],i.removeChild(n),t},n.prototype.getSelectedNode=function(n,t){return n.nodeType===Node.ELEMENT_NODE&&n.childNodes.length>0&&n.childNodes[t-1]&&n.childNodes[t-1].nodeType===Node.ELEMENT_NODE&&(n.childNodes[t-1].classList.contains(s.startSelection)||n.childNodes[t-1].classList.contains(s.endSelection))?n=n.childNodes[t-1]:n.nodeType===Node.ELEMENT_NODE&&n.childNodes.length>0&&n.childNodes[t]&&(n=n.childNodes[t]),n.nodeType===Node.TEXT_NODE&&(n=n.parentNode),n},n.prototype.nodeFinds=function(n,t){for(var r=[],i=0;i<t.length;i++)n.contains(t[i])&&n!==t[i]&&r.push(t[i]);return r},n.prototype.isEditorArea=function(){for(var n=this.getRangePoint(0).commonAncestorContainer;n&&!this.isElement(n);null)n=n.parentNode;return!!this.isElement(n)},n.prototype.getRangePoint=function(n){var t=this.getSelection(),i=[],r;if(t&&t.getRangeAt&&t.rangeCount)for(i=[],r=0;r<t.rangeCount;r++)i.push(t.getRangeAt(r));else i=[this.currentDocument.createRange()];return void 0!==n?i[n]:i},n.prototype.getSelection=function(){return this.nodeSelection.get(this.currentDocument)},n.prototype.getPreviousNode=function(n){for(n=n.previousElementSibling;n&&"\n"===n.textContent;null)n=n.previousElementSibling;return n},n.prototype.encode=function(n){var t=document.createElement("div");return t.innerText=n,t.innerHTML.replace(/<br\s*[\/]?>/gi,"\n")},n.prototype.saveMarker=function(n,t){var f,o,i=this.parent.querySelector("."+s.startSelection),u=this.parent.querySelector("."+s.endSelection),e;return(""===i.textContent&&Object(r.isNullOrUndefined)(u)&&"tab"!==t&&(i.innerHTML=1===i.childNodes.length&&"BR"===i.childNodes[0].nodeName?"&#65279;&#65279;<br>":"&#65279;&#65279;"),this.hasClass(i,s.startSelection)&&i.classList.length>1)?(e=this.createTagString(it,i,this.encode(i.textContent)),this.replaceWith(i,e),(i=this.parent.querySelector("."+s.startSelection)).classList.remove(s.startSelection),f=i.childNodes[0]):f=this.unWrap(i)[0],this.hasClass(u,s.endSelection)&&u.classList.length>1?(e=this.createTagString(it,u,this.encode(u.textContent)),this.replaceWith(u,e),(u=this.parent.querySelector("."+s.endSelection)).classList.remove(s.endSelection),o=u.childNodes[0]):o=u?this.unWrap(u)[0]:f,n.startContainer=n.getNodeArray(f,!0),n.endContainer=n.getNodeArray(o,!1),n},n.prototype.marker=function(n,t){return'<span class="'+n+'">'+t+"<\/span>"},n.prototype.setMarker=function(n){var u=n.range,i=u.startContainer.childNodes[u.startOffset]||u.startContainer,r=u.endContainer.childNodes[u.endOffset>0?u.endOffset-1:u.endOffset]||u.endContainer,e;if(i.nodeType===Node.ELEMENT_NODE&&r.nodeType===Node.ELEMENT_NODE&&(i.contains(r)||r.contains(i))&&(e=i.contains(r)?i:r,e.nodeType!==Node.TEXT_NODE)){for(var o=[],f=[],t=e;e.contains(t);null)o.indexOf(t)<0&&t.childNodes&&t.childNodes.length?(o.push(t),t=t.childNodes[0]):t.nextSibling?t=t.nextSibling:t.parentNode&&(t=t.parentNode,o.push(t)),f.indexOf(t)<0&&(t.nodeType===Node.TEXT_NODE||at.indexOf(t.parentNode.tagName.toLocaleLowerCase())>=0&&"BR"===t.tagName)&&f.push(t);f.length&&(i=i.contains(r)?f[0]:i,r=f[f.length-1])}i!==r?(i.nodeType!==Node.TEXT_NODE&&"BR"===i.tagName&&at.indexOf(i.parentNode.tagName.toLocaleLowerCase())>=0?(this.replaceWith(i,this.marker(s.startSelection,this.encode(i.textContent))),u.startContainer.querySelector("."+s.startSelection).appendChild(i)):this.replaceWith(i,this.marker(s.startSelection,this.encode(i.textContent))),r.nodeType!==Node.TEXT_NODE&&"BR"===r.tagName&&at.indexOf(r.parentNode.tagName.toLocaleLowerCase())>=0?(this.replaceWith(r,this.marker(s.endSelection,this.encode(r.textContent))),u.endContainer.querySelector("."+s.endSelection).appendChild(r)):this.ensureSelfClosingTag(r,s.endSelection,u)):this.ensureSelfClosingTag(i,s.startSelection,u)},n.prototype.ensureSelfClosingTag=function(n,t,i){var h=!1,f,o,u,e,c;if(3===n.nodeType)this.replaceWith(n,this.marker(t,this.encode(n.textContent)));else if("BR"===n.tagName)this.replaceWith(n,this.marker(s.startSelection,this.encode(n.textContent))),i.startContainer.querySelector("."+s.startSelection).appendChild(n);else{if("IMG"===n.tagName&&(f=document.createElement("p"),n.parentElement.insertBefore(f,n),f.appendChild(n),n=f.children[0]),"TABLE"===n.tagName)if(h=!0,""===n.textContent)o=n.querySelectorAll("td"),n=o[o.length-1],n=Object(r.isNullOrUndefined)(n.childNodes[0])?n:n.childNodes[0];else{for(u=n.lastChild;3!==u.nodeType&&"#text"!==u.nodeName;)u=u.lastChild;n=u}for(e=0;e<dc.length;e++)n=n.tagName!==dc[e]||h?n:n.parentNode;3===n.nodeType&&"#text"===n.nodeName?this.replaceWith(n,this.marker(t,this.encode(n.textContent))):"BR"===n.nodeName?(this.replaceWith(n,this.marker(s.endSelection,this.encode(n.textContent))),i.endContainer.querySelector("."+s.endSelection).appendChild(n)):(c=this.marker(t,""),Object(r.append)([this.parseHTMLFragment(c)],n))}},n.prototype.createTempNode=function(n){var r=n.textContent,i,u,t;return"BR"===n.tagName?(i="<"+it+"><\/"+it+">",u=n.parentNode,at.indexOf(u.tagName.toLocaleLowerCase())>=0&&(n=this.wrap(n,this.parseHTMLFragment(i)))):(n.nodeType!==Node.TEXT_NODE&&(n.classList.contains(s.startSelection)||n.classList.contains(s.endSelection))||r.replace(/\n/g,"").replace(/(^ *)|( *$)/g,"").length>0||r.length&&r.indexOf("\n")<0)&&(i="<"+it+"><\/"+it+">",t=n,n=this.wrap(n,this.parseHTMLFragment(i)),t.nodeType===Node.ELEMENT_NODE&&t.firstChild&&"BR"===t.firstChild.nodeName&&(t.classList.contains(s.startSelection)||t.classList.contains(s.endSelection))||!n.nextElementSibling||"BR"!==n.nextElementSibling.tagName||n.appendChild(n.nextElementSibling)),n},n.prototype.getImageTagInSelection=function(){var n=this.getSelection();return this.isEditorArea()&&n.rangeCount?n.focusNode.querySelectorAll("img"):null},n.prototype.blockNodes=function(){var t=[],y=this.getSelection(),c,h,a,e,n,f,v;if(this.isEditorArea()&&y.rangeCount)for(c=this.getRangePoint(),h=0;h<c.length;h++){var u=void 0,o=c[h],i=this.getSelectedNode(o.startContainer,o.startOffset),l=this.getSelectedNode(o.endContainer,o.endOffset);for((this.isBlockNode(i)&&t.indexOf(i)<0&&t.push(i),(u=this.blockParentNode(i))&&t.indexOf(u)<0)&&(at.indexOf(u.tagName.toLocaleLowerCase())>=0&&("BR"===i.tagName||i.nodeType===Node.TEXT_NODE||i.classList.contains(s.startSelection)||i.classList.contains(s.endSelection))?(a=i.previousSibling&&i.previousSibling.nodeType===Node.TEXT_NODE?i.previousSibling:i,i.nextSibling||i.previousSibling||"BR"!==i.tagName?t.push(this.createTempNode(a)):t.push(a)):t.push(u)),e=[],n=i;n!==l&&n!==this.parent;null)e.indexOf(n)<0&&n.childNodes&&n.childNodes.length?(e.push(n),n=n.childNodes[0]):n&&8!==n.nodeType&&("BR"===n.tagName||n.nodeType===Node.TEXT_NODE&&""!==n.textContent.trim()||n.nodeType!==Node.TEXT_NODE&&(n.classList.contains(s.startSelection)||n.classList.contains(s.endSelection)))&&at.indexOf(n.parentNode.tagName.toLocaleLowerCase())>=0?n=this.createTempNode(n):n.nextSibling&&8!==n.nextSibling.nodeType&&("BR"===n.nextSibling.tagName||n.nextSibling.nodeType===Node.TEXT_NODE||n.nextSibling.classList.contains(s.startSelection)||n.nextSibling.classList.contains(s.endSelection))&&at.indexOf(n.nextSibling.parentNode.tagName.toLocaleLowerCase())>=0?n=this.createTempNode(n.nextSibling):n.nextSibling?n=n.nextSibling:n.parentNode&&(n=n.parentNode,e.push(n)),t.indexOf(n)<0&&n.nodeType===Node.ELEMENT_NODE&&at.indexOf(n.parentNode.tagName.toLocaleLowerCase())>=0&&(n.classList.contains(s.startSelection)||n.classList.contains(s.endSelection))&&t.push(this.createTempNode(n)),this.isBlockNode(n)&&this.ignoreTableTag(n)&&e.indexOf(n)<0&&t.indexOf(n)<0&&(n!==l||o.endOffset>0)&&t.push(n),"IMG"===n.nodeName&&"true"===n.parentElement.contentEditable&&t.push(n);(u=this.blockParentNode(l))&&this.ignoreTableTag(u)&&t.indexOf(u)<0&&!Object(r.isNullOrUndefined)(u.previousElementSibling)&&"IMG"!==u.previousElementSibling.tagName&&t.push(u)}for(f=t.length-1;f>0;f--)if((e=this.nodeFinds(t[f],t)).length){if(v=t[f].querySelectorAll("ul, ol"),"LI"===t[f].tagName&&v.length>0)continue;t.splice(f,1)}return t},n.prototype.ignoreTableTag=function(n){return!(ou.indexOf(n.tagName.toLocaleLowerCase())>=0)},n}();var gy=function(){function n(n){this.parent=n;this.domNode=this.parent.domNode;this.addEventListener()}return n.prototype.addEventListener=function(){this.parent.observer.on(sc,this.applyListsHandler,this);this.parent.observer.on(v,this.keyDownHandler,this)},n.prototype.testList=function(n){var i=[/^[\d]+[.]+$/,/^(?=[MDCLXVI])M*(C[MD]|D?C{0,3})(X[CL]|L?X{0,3})(I[XV]|V?I{0,3})[.]$/gi,/^[a-zA-Z][.]+$/],u=Object(r.isNullOrUndefined)(n)?null:n.innerText.trim().split(".")[0]+".",t;if(!Object(r.isNullOrUndefined)(u))for(t=0;t<i.length;t++)if(i[t].test(u))return!0;return!1},n.prototype.testCurrentList=function(n){var i=[/^[1]+[.]+$/,/^[i]+[.]+$/,/^[a]+[.]+$/],t;if(!Object(r.isNullOrUndefined)(n.startContainer.textContent.slice(0,n.startOffset)))for(t=0;t<i.length;t++)if(i[t].test(n.startContainer.textContent.slice(0,n.startOffset)))return!0;return!1},n.prototype.spaceList=function(n){var t=this.parent.nodeSelection.getRange(this.parent.currentDocument);this.saveSelection=this.parent.nodeSelection.save(t,this.parent.currentDocument);var f=this.parent.domNode.getSelectedNode(t.startContainer,t.startOffset),i=(this.parent.domNode.getSelectedNode(t.endContainer,t.endOffset),f.previousElementSibling),u=f.nextElementSibling,e=Object(r.isNullOrUndefined)(i)?null:i.innerText.trim().substring(0,1),o=Object(r.isNullOrUndefined)(u)?null:u.innerText.trim().substring(0,1),s=this.testCurrentList(t),h=this.testList(i),c=this.testList(u);h||c||"*"===e||"*"===o||(s?(t.startContainer.textContent=t.startContainer.textContent.slice(t.startOffset,t.startContainer.textContent.length),this.applyListsHandler({subCommand:"OL",callBack:n.callBack}),n.event.preventDefault()):"*"===t.startContainer.textContent.slice(0,t.startOffset)&&(t.startContainer.textContent=t.startContainer.textContent.slice(t.startOffset,t.startContainer.textContent.length),this.applyListsHandler({subCommand:"UL",callBack:n.callBack}),n.event.preventDefault()))},n.prototype.keyDownHandler=function(n){var r;if(32===n.event.which&&this.spaceList(n),9===n.event.which){r=this.parent.nodeSelection.getRange(this.parent.currentDocument);n.event.action&&"indent"===n.event.action||(this.saveSelection=this.parent.nodeSelection.save(r,this.parent.currentDocument));var t=void 0,o=r.startOffset,s=r.endOffset,f=this.parent.domNode.getSelectedNode(r.startContainer,r.startOffset);if(f===this.parent.domNode.getSelectedNode(r.endContainer,r.endOffset)&&("BR"===f.nodeName||"#text"===f.nodeName)&&at.indexOf(f.parentNode.tagName.toLocaleLowerCase())>=0)return;n.event.action&&"indent"===n.event.action||this.domNode.setMarker(this.saveSelection);t=this.domNode.blockNodes();for(var u=[],e=!0,i=0;i<t.length;i++)"LI"===t[i].parentNode.tagName?u.push(t[i].parentNode):"LI"===t[i].tagName&&"P"!==t[i].childNodes[0].tagName&&"OL"!==t[i].childNodes[0].tagName&&"UL"!==t[i].childNodes[0].tagName&&u.push(t[i]);u.length>1||u.length&&(0===o&&0===s||n.ignoreDefault)?(n.event.preventDefault(),n.event.stopPropagation(),this.currentAction=this.getAction(u[0]),n.event.shiftKey?(this.revertList(u),this.revertClean()):e=this.nestedList(u),e&&(this.cleanNode(),this.parent.editableElement.focus()),n.event.action&&"indent"===n.event.action||(this.saveSelection=this.domNode.saveMarker(this.saveSelection),this.saveSelection.restore(),n.callBack&&n.callBack({requestType:this.currentAction,editorMode:"HTML",range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.domNode.blockNodes(),event:n.event}))):n.event.action&&"indent"===n.event.action||(n.event&&n.event.shiftKey&&"Tab"===n.event.key&&(n.event.action="tab"),this.saveSelection=this.domNode.saveMarker(this.saveSelection,n.event.action),this.saveSelection.restore())}else switch(n.event.action){case"ordered-list":this.applyListsHandler({subCommand:"OL",callBack:n.callBack});n.event.preventDefault();break;case"unordered-list":this.applyListsHandler({subCommand:"UL",callBack:n.callBack});n.event.preventDefault()}},n.prototype.getAction=function(n){return"OL"===n.parentNode.nodeName?"OL":"UL"},n.prototype.revertClean=function(){for(var n,t,r,u=this.parent.editableElement.querySelectorAll("ul, ol"),i=0;i<u.length;i++)if(n=u[i].querySelectorAll("ul, ol"),n.length>0)for(t=0;t<n.length;t++)r=n[t].previousSibling,r&&"LI"===r.tagName&&r.appendChild(n[t])},n.prototype.noPreviousElement=function(n){var e,i,c=n.querySelectorAll("ol, ul"),s=n.querySelectorAll("li"),h=this.domNode.contents(s[0])[0],t,o,u,f;if(s.length>0&&("OL"===h.nodeName||"UL"===h.nodeName)?e=s[0]:i=c[0],e)for(t=this.domNode.contents(n)[0];t&&!this.domNode.isList(t);null)o=t.nextSibling,Object(r.prepend)([t],e),Object(r.setStyleAttribute)(n,{"list-style-type":"none"}),Object(r.setStyleAttribute)(e,{"list-style-type":""}),t=o;else if(i){for(u=Object(r.createElement)("li"),Object(r.prepend)([u],i),t=this.domNode.contents(n)[0];t&&!this.domNode.isList(t);null)o=t.nextSibling,u.appendChild(t),t=o;Object(r.prepend)([i],n.parentNode);Object(r.detach)(n);f=Object(r.createElement)("li",{styles:"list-style-type: none;"});Object(r.prepend)([f],i.parentNode);Object(r.append)([i],f)}else f=Object(r.createElement)("li",{styles:"list-style-type: none;"}),Object(r.prepend)([f],n.parentNode),u=Object(r.createElement)(n.parentNode.tagName),Object(r.prepend)([u],f),Object(r.append)([n],u)},n.prototype.nestedList=function(n){for(var u,f,i,h,a,o=!1,t=0;t<n.length;t++)if(u=this.domNode.getPreviousNode(n[t]),u){o=!0;var s=void 0,e=void 0,v=n[t].querySelectorAll("ol, ul"),c=n[t].querySelectorAll("li"),l=this.domNode.contents(c[0])[0];if(c.length>0&&("OL"===l.nodeName||"UL"===l.nodeName)?e=c[0]:s=v[0],s){for(f=Object(r.createElement)("li"),Object(r.prepend)([f],s),i=this.domNode.contents(n[t])[0];i&&!this.domNode.isList(i);null)h=i.nextSibling,f.appendChild(i),i=h;Object(r.append)([s],u);Object(r.detach)(n[t])}else if(e){if("LI"===u.tagName){for(i=this.domNode.contents(n[t])[0];i&&!this.domNode.isList(i);null)h=i.nextSibling,Object(r.prepend)([i],e),Object(r.setStyleAttribute)(n[t],{"list-style-type":"none"}),Object(r.setStyleAttribute)(e,{"list-style-type":""}),i=h;Object(r.append)([e.parentNode],u);Object(r.detach)(n[t])}}else"LI"===u.tagName&&(f=Object(r.createElement)(n[t].parentNode.tagName),Object(r.append)([f],u),Object(r.append)([n[t]],f))}else a=n[t],o=!0,this.noPreviousElement(a);return o},n.prototype.applyListsHandler=function(n){var r=this.parent.nodeSelection.getRange(this.parent.currentDocument),t,i;for(this.saveSelection=this.parent.nodeSelection.save(r,this.parent.currentDocument),this.currentAction=n.subCommand,this.domNode.setMarker(this.saveSelection),t=this.domNode.blockNodes(),i=0;i<t.length;i++)"LI"!==t[i].tagName&&"LI"===t[i].parentNode.tagName&&(t[i]=t[i].parentNode);this.applyLists(t,this.currentAction,n.selector);n.callBack&&n.callBack({requestType:this.currentAction,event:n.event,editorMode:"HTML",range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.domNode.blockNodes()})},n.prototype.applyLists=function(n,t,i){var r;if(this.isRevert(n,t))this.revertList(n),this.removeEmptyListElements();else for(this.checkLists(n,t),r=0;r<n.length;r++)if("LI"!==n[r].tagName){!1;var u="<"+t+">",f="<\/"+t+">",e="li"+("IMG"===n[r].tagName?"":this.domNode.attributes(n[r])),o=n[r].tagName.toLowerCase()===it?n[r].innerHTML:n[r].outerHTML,s=u+this.domNode.createTagString(e,null,o)+f;this.domNode.replaceWith(n[r],s)}this.cleanNode();this.parent.editableElement.focus();d()&&ai(this.parent.editableElement,i);this.saveSelection=this.domNode.saveMarker(this.saveSelection);this.saveSelection.restore()},n.prototype.removeEmptyListElements=function(){for(var t=this.parent.editableElement.querySelectorAll("ol, ul"),n=0;n<t.length;n++)""===t[n].textContent.trim()&&Object(r.detach)(t[n])},n.prototype.isRevert=function(n,t){for(var r=!0,i=0;i<n.length;i++){if("LI"!==n[i].tagName)return!1;n[i].parentNode.tagName!==t&&(r=!1)}return r},n.prototype.checkLists=function(n,t){for(var f,u,e,o,i=[],r=0;r<n.length;r++)f=n[r].parentNode,"LI"===n[r].tagName&&f.tagName!==t&&i.indexOf(f)<0&&i.push(f);for(u=i.length-1;u>=0;u--)e=i[u],o="<"+t.toLowerCase()+" "+this.domNode.attributes(e)+">"+e.innerHTML+"<\/"+t.toLowerCase()+">",this.domNode.replaceWith(i[u],o)},n.prototype.cleanNode=function(){for(var n,u,i,r=this.parent.editableElement.querySelectorAll("ol + ol, ul + ul"),t=0;t<r.length;t++)if(n=r[t],this.domNode.isList(n.previousElementSibling)&&this.domNode.openTagString(n)===this.domNode.openTagString(n.previousElementSibling)){for(u=this.domNode.contents(n),i=0;i<u.length;i++)n.previousElementSibling.appendChild(u[i]);n.parentNode.removeChild(n)}},n.prototype.findUnSelected=function(n,t){var r,s,h,e,a,c,u;if((n=n.slice().reverse()).length>0){var l=[],i=[],f=[],o=[];for(f=t[t.length-1].childNodes,r=0;r<f.length;r++)if(("OL"===f[r].tagName||"UL"===f[r].tagName)&&(s=f[r].querySelectorAll("li"),s.length>0))for(h=0;h<s.length;h++)o.push(s[h]);for(e=0;e<o.length;e++){for(a=0,c=0;c<n.length;c++)o[e].contains(n[c])||(a+=1);a===n.length&&i.push(o[e])}if(i.length>0)for(u=0;u<i.length;u++)"OL"!==this.domNode.contents(i[u])[0].nodeName&&"UL"!==this.domNode.contents(i[u])[0].nodeName&&l.push(i[u]);l.length>0&&this.nestedList(l)}},n.prototype.revertList=function(n){for(var c,l,i,u,f,e,p,w,d,g,y,o,h,a,b,k,v=[],t=n.length-1;t>=0;t--)for(c=t-1;c>=0;c--)if(n[c].contains(n[t])||n[c]===n[t]){v.push(n[t]);n.splice(t,1);break}for(this.findUnSelected(v,n),l=[],t=0;t<n.length;t++)i=n[t],3===this.domNode.contents(i)[0].nodeType&&0===this.domNode.contents(i)[0].textContent.trim().length&&Object(r.detach)(this.domNode.contents(i)[0]),u=n[t].parentNode,f=i.getAttribute("class"),0===v.length&&(e=n[t].querySelectorAll("ul, ol")[0],e&&e.querySelectorAll("li")&&(p=Object(r.createElement)(e.tagName),Object(r.append)([p],e.parentNode),w=Object(r.createElement)("li",{styles:"list-style-type: none;"}),Object(r.append)([w],p),Object(r.append)([e],w))),(i.parentNode.insertBefore(this.closeTag(u.tagName),i),"LI"===u.parentNode.tagName)?i.parentNode.insertBefore(this.closeTag("LI"),i):((f&&' class="'+f+'"',it&&0===i.querySelectorAll(di.join(", ")).length)?(d=Object(r.isNullOrUndefined)(f)?' class="e-rte-wrap-inner"':' class="'+f+' e-rte-wrap-inner"',g="<"+it+d+this.domNode.attributes(u)+"><\/"+it+">",this.domNode.wrapInner(i,this.domNode.parseHTMLFragment(g))):3===this.domNode.contents(i)[0].nodeType?(y=this.domNode.createTagString(it,u,this.parent.domNode.encode(this.domNode.contents(i)[0].textContent)),this.domNode.replaceWith(this.domNode.contents(i)[0],y)):this.domNode.contents(i)[0].classList.contains(s.startSelection)||this.domNode.contents(i)[0].classList.contains(s.endSelection)?(y=this.domNode.createTagString(it,u,this.domNode.contents(i)[0].outerHTML),this.domNode.replaceWith(this.domNode.contents(i)[0],y)):(o=i.firstChild,f=o.getAttribute("class"),Object(r.attributes)(o,this.domNode.rawAttributes(u)),f&&o.getAttribute("class")&&Object(r.attributes)(o,{"class":f+" "+o.getAttribute("class")})),Object(r.append)([this.openTag("LI")],i),Object(r.prepend)([this.closeTag("LI")],i)),this.domNode.insertAfter(this.openTag(u.tagName),i),"LI"===u.parentNode.tagName&&(u=u.parentNode.parentNode),l.indexOf(u)<0&&l.push(u);for(t=0;t<l.length;t++)h=l[t],a=h.innerHTML,a=(a=a.replace(/<span class="e-rte-list-close-([a-z]*)"><\/span>/g,"<\/$1>")).replace(/<span class="e-rte-list-open-([a-z]*)"><\/span>/g,"<$1 "+this.domNode.attributes(h)+">"),this.domNode.replaceWith(h,this.domNode.openTagString(h)+a.trim()+this.domNode.closeTagString(h));for(b=this.parent.editableElement.querySelectorAll("ul:empty, ol:empty"),t=0;t<b.length;t++)Object(r.detach)(b[t]);for(k=this.parent.editableElement.querySelectorAll("li:empty"),t=0;t<k.length;t++)Object(r.detach)(k[t])},n.prototype.openTag=function(n){return this.domNode.parseHTMLFragment('<span class="e-rte-list-open-'+n.toLowerCase()+'"><\/span>')},n.prototype.closeTag=function(n){return this.domNode.parseHTMLFragment('<span class="e-rte-list-close-'+n.toLowerCase()+'"><\/span>')},n}(),l=function(){function n(){}return n.WrapBefore=function(n,t,i){return t.innerText=n.textContent,i?this.AppendBefore(t,n,!0):this.AppendBefore(t,n),n.parentNode&&n.parentNode.removeChild(n),t.childNodes[0]},n.Wrap=function(n,t){return this.AppendBefore(t,n),t.appendChild(n),n},n.unwrap=function(n){for(var t=n.parentNode,i=[];n.firstChild;null)i.push(t.insertBefore(n.firstChild,n));return t.removeChild(n),i},n.AppendBefore=function(n,t,i){return t.parentNode?i?t.parentNode.insertBefore(n,t.nextSibling):t.parentNode.insertBefore(n,t):t},n}(),su=function(){function n(){this.position=-1;this.nodeSelection=new k}return n.prototype.GetSpliceNode=function(n,t){return t=this.SplitNode(n,t,!0),t=this.SplitNode(n,t,!1)},n.prototype.SplitNode=function(n,t,i){var o,u;if(t){var e=n.cloneRange(),f=t.parentNode,s=this.nodeSelection.getIndex(t);return e.collapse(i),i?e.setStartBefore(t):e.setEndAfter(t),u=e.extractContents(),i?(t=f.childNodes[s],(u=this.spliceEmptyNode(u,!1))&&u.childNodes.length>0)&&(!(1!==u.childNodes.length||"IMG"===u.childNodes[0].nodeName||!Object(r.isNullOrUndefined)(u.querySelector("img"))||""!==u.textContent)||(t?l.AppendBefore(u,t):(f.appendChild(u),(o=document.createElement("div")).innerHTML="&#65279;&#65279;",t=o.firstChild,f.appendChild(t)))):(t=f.childNodes.length>1?f.childNodes[s]:f.childNodes[0],(u=this.spliceEmptyNode(u,!0))&&u.childNodes.length>0)&&(!(1!==u.childNodes.length||"IMG"===u.childNodes[0].nodeName||!Object(r.isNullOrUndefined)(u.querySelector("img"))||""!==u.textContent)||(t?l.AppendBefore(u,t,!0):(f.appendChild(u),(o=document.createElement("div")).innerHTML="&#65279;&#65279;",f.insertBefore(o.firstChild,f.firstChild),t=f.firstChild))),t}return null},n.prototype.spliceEmptyNode=function(n,t){var i;return(i=1===n.childNodes.length&&"#text"===n.childNodes[0].nodeName&&""===n.childNodes[0].textContent||""===n.textContent?-1:n.childNodes.length-1)>-1&&!t?this.spliceEmptyNode(n.childNodes[i],t):i>-1?this.spliceEmptyNode(n.childNodes[0],t):3!==n.nodeType&&11!==n.nodeType&&n.parentNode.removeChild(n),n},n.prototype.GetCursorStart=function(n,t,i){for(var u=(n=i?n:n.reverse())[0],r=0;r<n.length&&(i?n[r]<t:n[r]>=t);r++)u=n[r];return u},n.prototype.GetCursorRange=function(n,t,i){var e=n.createRange(),r=[],f,u,o;for(r.push(0),f=this.TrimLineBreak(i.data),u=f.indexOf(" ",0);-1!==u;)r.indexOf(u)<0&&r.push(u),new RegExp("\\s").test(f[u-1])&&r.indexOf(u-1)<0&&r.push(u-1),new RegExp("\\s").test(f[u+1])&&r.push(u+1),u=f.indexOf(" ",u+1);return(r.push(f.length),r.indexOf(t.startOffset)>=0||r.indexOf(t.startOffset-1)>=0&&(1!==t.startOffset||1===t.startOffset&&new RegExp("\\s").test(f[0]))||r[r.length-1]-1===t.startOffset)?(e=t,this.position=1):(o=this.GetCursorStart(r,t.startOffset,!0),this.position=t.startOffset-o,e.setStart(t.startContainer,o),e.setEnd(t.startContainer,this.GetCursorStart(r,t.startOffset,!1))),e},n.prototype.GetCursorNode=function(n,t,i){return this.GetSpliceNode(this.GetCursorRange(n,t,i),i)},n.prototype.TrimLineBreak=function(n){return n.replace(/(\r\n\t|\n|\r\t)/gm," ")},n}(),np=function(){function n(n){this.parent=n;this.addEventListener()}return n.prototype.addEventListener=function(){this.parent.observer.on(of,this.applyFormats,this);this.parent.observer.on(v,this.onKeyDown,this)},n.prototype.getParentNode=function(n){for(;n.parentNode&&n.parentNode!==this.parent.editableElement;null)n=n.parentNode;return n},n.prototype.onKeyDown=function(n){if(13===n.event.which){var t=this.parent.nodeSelection.getRange(this.parent.currentDocument),h=0===t.startContainer.textContent.length||"PRE"===t.startContainer.nodeName?t.startContainer:t.startContainer.parentElement,o=0===t.endContainer.textContent.length||"PRE"===t.endContainer.nodeName?t.endContainer:t.endContainer.parentElement,u=Object(r.closest)(h,"pre"),f=Object(r.closest)(o,"pre");if(!Object(r.isNullOrUndefined)(u)&&!Object(r.isNullOrUndefined)(u.parentElement)&&"LI"===u.parentElement.tagName)return;if((Object(r.isNullOrUndefined)(u)&&!Object(r.isNullOrUndefined)(f)||!Object(r.isNullOrUndefined)(u)&&Object(r.isNullOrUndefined)(f))&&(n.event.preventDefault(),this.deleteContent(t),this.removeCodeContent(t),t=this.parent.nodeSelection.getRange(this.parent.currentDocument),this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,o,0)),13===n.event.which&&!Object(r.isNullOrUndefined)(u)&&!Object(r.isNullOrUndefined)(f)){n.event.preventDefault();this.deleteContent(t);this.removeCodeContent(t);var e=(t=this.parent.nodeSelection.getRange(this.parent.currentDocument)).startContainer.childNodes[t.endOffset],s=t.startContainer.childNodes[t.endOffset-1],i=t.startContainer;if(Object(r.isNullOrUndefined)(e)||Object(r.isNullOrUndefined)(s)||!Object(r.isNullOrUndefined)(e.nextSibling)||"BR"!==e.nodeName||"BR"!==s.nodeName)if(8203===i.textContent.charCodeAt(0)&&1===i.textContent.length||0===i.textContent.length){for(;"PRE"!==i.parentElement.nodeName&&(1===i.textContent.length||0===i.textContent.length);)i=i.parentElement;!Object(r.isNullOrUndefined)(i.previousSibling)&&"BR"===i.previousSibling.nodeName&&Object(r.isNullOrUndefined)(i.nextSibling)?this.paraFocus(i.parentElement):this.isNotEndCursor(u,t)}else this.isNotEndCursor(u,t);else this.paraFocus(t.startContainer)}}},n.prototype.removeCodeContent=function(n){var t=new RegExp(String.fromCharCode(65279),"g"),i;Object(r.isNullOrUndefined)(n.endContainer.textContent.match(t))||(i=65279===n.endContainer.textContent.charCodeAt(n.endOffset-1)?n.endOffset-2:n.endOffset,n.endContainer.textContent=n.endContainer.textContent.replace(t,""),""===n.endContainer.textContent?this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,n.endContainer.parentElement,0):this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,n.endContainer,i))},n.prototype.deleteContent=function(n){n.startContainer===n.endContainer&&n.startOffset===n.endOffset||n.deleteContents()},n.prototype.paraFocus=function(n){var t=Object(r.createElement)("p");t.innerHTML="<br>";this.parent.domNode.insertAfter(t,n);this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,t,0)},n.prototype.isNotEndCursor=function(n,t){var e=new su,o=t.startOffset===n.lastChild.textContent.length&&n.lastChild.textContent===t.startContainer.textContent,u,f,i;0===n.textContent.indexOf(t.startContainer.textContent)&&(0===t.startOffset&&0===t.endOffset||"PRE"===t.startContainer.nodeName)?(this.insertMarker(n,t),u=Object(r.createElement)("br"),n.childNodes[t.endOffset].parentElement.insertBefore(u,n.childNodes[t.endOffset])):(f=e.SplitNode(t,n,!0),this.insertMarker(n,t),i=n.previousElementSibling,"PRE"===i.tagName&&(i.insertAdjacentHTML("beforeend","<br>"+f.innerHTML),Object(r.detach)(n)));this.setCursorPosition(o,n)},n.prototype.setCursorPosition=function(n,t){var u=!1,i=this.parent.editableElement.querySelector(".tempSpan"),f=i.parentElement,e;(""===i.parentNode.textContent?u=!0:this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,i,0),n)?u?f===t?(this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,i,0),Object(r.detach)(i)):this.focusSelectionParent(i,f):(e=Object(r.createElement)("br"),this.parent.domNode.insertAfter(e,i),this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,i,0),Object(r.detach)(i)):u?this.focusSelectionParent(i,f):Object(r.detach)(i)},n.prototype.focusSelectionParent=function(n,t){Object(r.detach)(n);t.innerHTML="​";this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,t,0)},n.prototype.insertMarker=function(n,t){var i=Object(r.createElement)("span",{className:"tempSpan"});"PRE"===t.startContainer.nodeName?n.childNodes[t.endOffset].parentElement.insertBefore(i,n.childNodes[t.endOffset]):t.startContainer.parentElement.insertBefore(i,t.startContainer)},n.prototype.applyFormats=function(n){var o=this.parent.nodeSelection.getRange(this.parent.currentDocument),a=!1,u,h,f,t,c,v,l,e,i;for(this.parent.editableElement!==o.endContainer||Object(r.isNullOrUndefined)(this.parent.editableElement.children[o.endOffset-1])||"TABLE"!==this.parent.editableElement.children[o.endOffset-1].tagName||(a=!0),u=this.parent.nodeSelection.save(o,this.parent.currentDocument),this.parent.domNode.setMarker(u),h=this.parent.domNode.blockNodes(),f=0;f<h.length;f++)t=void 0,c=void 0,("blockquote"===n.subCommand.toLowerCase()?(t=this.getParentNode(h[f]),c=this.parent.domNode.isList(t)||"TABLE"===t.tagName?t.outerHTML:t.innerHTML):c=(t=h[f]).innerHTML,n.subCommand.toLowerCase()===t.tagName.toLowerCase()&&("pre"!==n.subCommand.toLowerCase()||!Object(r.isNullOrUndefined)(n.exeValue)&&"dropDownSelect"===n.exeValue.name)||Object(r.isNullOrUndefined)(t.parentNode)||"LI"===t.tagName&&"pre"!==n.subCommand.toLowerCase()||"TABLE"===t.tagName&&"pre"===n.subCommand.toLowerCase())||(this.cleanFormats(t,n.subCommand),v="pre"===n.subCommand.toLowerCase()&&"pre"===t.tagName.toLowerCase()?"p":n.subCommand,l=this.parent.domNode.createTagString(v,t,c.replace(/>\s+</g,"><")),"LI"===t.tagName?(t.innerHTML="",t.insertAdjacentHTML("beforeend",l)):this.parent.domNode.replaceWith(t,l));this.preFormatMerge();e=this.parent.editableElement.querySelector("."+s.startSelection);i=this.parent.editableElement.querySelector("."+s.endSelection);Object(r.isNullOrUndefined)(e)||Object(r.isNullOrUndefined)(i)||(e=e.lastChild,i=i.lastChild);u=this.parent.domNode.saveMarker(u,null);d()&&ai(this.parent.editableElement,n.selector);a?this.parent.nodeSelection.setSelectionText(this.parent.currentDocument,e,i,0,i.textContent.length):u.restore();n.callBack&&n.callBack({requestType:n.subCommand,editorMode:"HTML",event:n.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.domNode.blockNodes()})},n.prototype.preFormatMerge=function(){var t=this.parent.editableElement.querySelectorAll("PRE"),n,i;if(!Object(r.isNullOrUndefined)(t))for(n=0;n<t.length;n++)i=t[n].previousElementSibling,Object(r.isNullOrUndefined)(i)||"PRE"!==i.tagName||(i.insertAdjacentHTML("beforeend","<br>"+t[n].innerHTML),Object(r.detach)(t[n]))},n.prototype.cleanFormats=function(n,t){var r=["display","font-size","margin-top","margin-bottom","margin-left","margin-right","font-weight"],i;for(t=t.toLowerCase(),i=0;i<r.length&&"p"!==t&&"blockquote"!==t&&"pre"!==t;i++)n.style.removeProperty(r[i])},n}(),vt=function(){function n(){}return n.Insert=function(n,t,i,u){var f,y,c,a,w,d;"string"==typeof t?((y=document.createElement("div")).innerHTML=t,f=u?y:y.firstChild):u&&(Object(r.isNullOrUndefined)(t)||Object(r.isNullOrUndefined)(t.classList)||!t.classList.contains("pasteContent"))?((y=document.createElement("div")).appendChild(t),f=y):f=t;var s=new k,b=new su,e=s.getRange(n),tt=e.startOffset===e.endOffset&&0===e.startOffset&&e.startContainer===e.endContainer,g=e.collapsed,h=s.getInsertNodeCollection(e),v="table"===f.nodeName.toLowerCase()?this.closestEle(h[0].parentNode,i):h[0];if(u||!Object(r.isNullOrUndefined)(f)&&!Object(r.isNullOrUndefined)(f.classList)&&f.classList.contains("pasteContent"))this.pasteInsertHTML(h,f,e,s,b,n,g,v,i);else if(i!==e.startContainer&&(!g&&(v.nodeType!==Node.ELEMENT_NODE||-1===ou.indexOf(v.tagName.toLocaleLowerCase()))||"table"===f.nodeName.toLowerCase()&&v&&-1===ou.indexOf(v.tagName.toLocaleLowerCase()))){var p=b.GetSpliceNode(e,v),nt=p.previousSibling,o=p.parentNode;for(1===h.length?(s.setSelectionContents(n,p),e=s.getRange(n)):(c=b.GetSpliceNode(e,h[h.length-1].parentElement),c=Object(r.isNullOrUndefined)(c)?p:c,s.setSelectionText(n,p,c,0,3===c.nodeType?c.textContent.length:c.childNodes.length),e=s.getRange(n)),e.extractContents(),"TABLE"===t.tagName&&this.removeEmptyElements(i),a=0;a<h.length;a++)if(3!==h[a].nodeType&&null!=h[a].parentNode){if("IMG"===h[a].nodeName)continue;h[a].parentNode.removeChild(h[a])}if(nt)l.AppendBefore(f,nt,!0);else{for(w=null;o!==i&&o.firstChild&&""===o.textContent.trim();)w=o,o=o.parentNode;null!==w&&(o=w);o.firstChild&&(o!==i||"TABLE"===f.nodeName&&tt&&o===e.startContainer&&o===e.endContainer)?""===o.textContent.trim()&&o!==i?(l.AppendBefore(f,o,!1),Object(r.detach)(o)):l.AppendBefore(f,o.firstChild,!1):o.appendChild(f)}3!==f.nodeType?s.setSelectionText(n,f,f,0,f.childNodes.length):s.setSelectionText(n,f,f,0,f.textContent.length)}else(e.deleteContents(),r.Browser.isIE)?(d=n.createDocumentFragment(),d.appendChild(f),e.insertNode(d)):e.insertNode(f),3!==f.nodeType&&f.childNodes.length>0?s.setSelectionText(n,f,f,1,1):3!==f.nodeType?s.setSelectionContents(n,f):s.setSelectionText(n,f,f,f.textContent.length,f.textContent.length)},n.pasteInsertHTML=function(n,t,i,u,f,e,o,s,h){var a,rt,w,v,et=i.startOffset===i.endOffset&&i.startContainer===i.endContainer,b,c,k,y,l,ut,d,ft,p;for(h!==i.startContainer&&(!o&&(s.nodeType!==Node.ELEMENT_NODE||-1===ou.indexOf(s.tagName.toLocaleLowerCase()))||"table"===t.nodeName.toLowerCase()&&s&&-1===ou.indexOf(s.tagName.toLocaleLowerCase()))&&(v=f.GetSpliceNode(i,s),rt=Object(r.isNullOrUndefined)(v.previousSibling)?v.parentNode.previousSibling:v.previousSibling,1===n.length?(u.setSelectionContents(e,v),i=u.getRange(e),w=!0):(a=f.GetSpliceNode(i,n[n.length-1].parentElement),a=Object(r.isNullOrUndefined)(a)?v:a,u.setSelectionText(e,v,a,0,3===a.nodeType?a.textContent.length:a.childNodes.length),i=u.getRange(e),w=!1)),b=!1,this.removingComments(t),k=t.childNodes,y=0;y<k.length;y++)if(di.indexOf(k[y].nodeName.toLocaleLowerCase())>=0){b=!0;break}if(l=document.createDocumentFragment(),b){ut=this.getImmediateBlockNode(n[n.length-1],h);d=f.GetSpliceNode(i,ut);d.parentNode.replaceChild(t,d);var g=!0,nt=void 0,tt=void 0,it=void 0;for(i.deleteContents();t.firstChild;)"#text"!==t.firstChild.nodeName||""!==t.firstChild.textContent.trim()?"#text"===t.firstChild.nodeName&&g||this.inlineNode.indexOf(t.firstChild.nodeName.toLocaleLowerCase())>=0&&g?((c=t.firstChild,Object(r.isNullOrUndefined)(t.previousElementSibling))&&(ft=Object(r.createElement)("p"),t.parentElement.insertBefore(ft,t)),t.previousElementSibling.appendChild(t.firstChild)):(c=t.firstChild,"#text"===t.firstChild.nodeName||this.inlineNode.indexOf(t.firstChild.nodeName.toLocaleLowerCase())>=0?(nt?(it.appendChild(t.firstChild),l.appendChild(it)):((tt=Object(r.createElement)("p")).appendChild(t.firstChild),l.appendChild(tt)),it=tt,nt=!0):(l.appendChild(t.firstChild),nt=!1),g=!1):Object(r.detach)(t.firstChild);t.parentNode.replaceChild(l,t)}else if(et){for(p=Object(r.createElement)("span",{className:"tempSpan"}),i.insertNode(p);t.firstChild;)c=t.firstChild,l.appendChild(t.firstChild);p.parentNode.replaceChild(l,p)}else{for(;t.firstChild;)c=t.firstChild,l.appendChild(t.firstChild);w?v.parentNode.replaceChild(l,v):(i.deleteContents(),Object(r.detach)(a),rt.parentNode.appendChild(l))}for(c="BR"===c.nodeName?c.previousSibling:c;!Object(r.isNullOrUndefined)(c)&&"#text"!==c.nodeName&&"IMG"!==c.nodeName&&"BR"!==c.nodeName;)c=c.lastChild;c=Object(r.isNullOrUndefined)(c)?t:c;u.setSelectionText(e,c,c,c.textContent.length,c.textContent.length);this.removeEmptyElements(h)},n.getImmediateBlockNode=function(n){do n=n.parentNode;while(di.indexOf(n.nodeName.toLocaleLowerCase())<0);return n},n.removingComments=function(n){var t=n.innerHTML;t=t.replace(/<!--[\s\S]*?-->/g,"");n.innerHTML=t},n.findDetachEmptyElem=function(n){return Object(r.isNullOrUndefined)(n.parentElement)?null:""===n.parentElement.textContent.trim()&&"true"!==n.parentElement.contentEditable?this.findDetachEmptyElem(n.parentElement):n},n.removeEmptyElements=function(n){for(var u,i=n.querySelectorAll(":empty"),t=0;t<i.length;t++)"IMG"!==i[t].tagName&&"BR"!==i[t].tagName&&(u=this.findDetachEmptyElem(i[t]),Object(r.isNullOrUndefined)(u)||Object(r.detach)(u))},n.closestEle=function(n,t){for(var i=n;i&&1===i.nodeType;){if(i.parentNode===t||!Object(r.isNullOrUndefined)(i.parentNode.tagName)&&-1!==at.indexOf(i.parentNode.tagName.toLocaleLowerCase()))return i;i=i.parentNode}return null},n.inlineNode=["a","abbr","acronym","audio","b","bdi","bdo","big","br","button","canvas","cite","code","data","datalist","del","dfn","em","embed","font","i","iframe","img","input","ins","kbd","label","map","mark","meter","noscript","object","output","picture","progress","q","ruby","s","samp","script","select","slot","small","span","strong","sub","sup","svg","template","textarea","time","u","tt","var","video","wbr"],n}(),tp=function(){function n(n){this.parent=n;this.addEventListener()}return n.prototype.addEventListener=function(){this.parent.observer.on(tl,this.linkCommand,this)},n.prototype.linkCommand=function(n){switch(n.value.toString().toLocaleLowerCase()){case"createlink":case"editlink":this.createLink(n);break;case"openlink":this.openLink(n);break;case"removelink":this.removeLink(n)}},n.prototype.createLink=function(n){var u=!Object(r.isNullOrUndefined)(n.item.selectParent)&&n.item.selectParent.length>0&&Object(r.closest)(n.item.selectParent[0],"a"),e,s,i,o,t,h,f;(u=Object(r.isNullOrUndefined)(u)?!Object(r.isNullOrUndefined)(n.item.selectParent)&&n.item.selectParent.length>0?n.item.selectParent[0]:null:u,Object(r.isNullOrUndefined)(u)||"A"!==u.tagName)?(e=(new k).getRange(this.parent.currentDocument),s=!!Object(r.isNullOrUndefined)(n.item.text)||n.item.text.replace(/ /g,"").localeCompare(e.toString().replace(/\n/g," ").replace(/ /g,""))<0,n.event&&"keydown"===n.event.type&&(32===n.event.keyCode||13===n.event.keyCode)||"Paste"===n.item.action||e.collapsed||s?(i=this.createAchorNode(n),(i.innerText=""===n.item.text?n.item.url:n.item.text,n.item.selection.restore(),vt.Insert(this.parent.currentDocument,i,this.parent.editableElement),n.event&&"keydown"===n.event.type&&(32===n.event.keyCode||13===n.event.keyCode))?(o=n.item.selection.range.startContainer,o.textContent=this.removeText(o.textContent,n.item.text)):(f="Paste"===n.item.action?i.childNodes[0].textContent.length:0,n.item.selection.setSelectionText(this.parent.currentDocument,i.childNodes[0],i.childNodes[0],f,i.childNodes[0].textContent.length))):this.createLinkNode(n)):(t=u,t.setAttribute("href",n.item.url),t.setAttribute("title",n.item.title),h=t.innerText,(t.innerText=n.item.text,Object(r.isNullOrUndefined)(n.item.target)?t.removeAttribute("target"):t.setAttribute("target",n.item.target),h===n.item.text)?(n.item.selection.setSelectionText(this.parent.currentDocument,t,t,1,1),n.item.selection.restore()):(f="Paste"===n.item.action?t.childNodes[0].textContent.length:0,n.item.selection.setSelectionText(this.parent.currentDocument,t.childNodes[0],t.childNodes[0],f,t.childNodes[0].textContent.length)));n.callBack&&n.callBack({requestType:"Links",editorMode:"HTML",event:n.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)})},n.prototype.createLinkNode=function(n){for(var t,d,y,p,c,g,l,o,u,a,w=new k,nt=new su,b=w.getRange(this.parent.currentDocument),v=this.getSelectionNodes(w.getNodeCollection(b)),tt=w.save(b,this.parent.currentDocument),h=[],r=[],e=[],f=[],i=[],s=0;s<v.length;s++)v[s]=nt.GetSpliceNode(b,v[s]),h[s]=v[s];for(t=0;t<h.length;t++)for(d=!0,u=h[t];!0===d;)"A"===u.parentElement.nodeName&&(y=u.parentElement,u.parentElement.parentElement.insertBefore(y.firstChild,y),u.parentElement.removeChild(y)),this.isBlockNode(u.parentElement)||0===h.length||0===t||t===h.length-1?(r[t]=u,d=!1):u=u.parentElement;for(t=0,p=0;t<r.length;t++)if(0===t&&(i[p]=r[t]),r.length>1&&t<r.length-1){if(r[t].parentElement===r[t+1].parentElement&&r[t]===r[t+1])continue;i[p+1]=r[t+1];p++}for(c=0,f[c]=this.createAchorNode(n),t=0;t<i.length;t++)(0===t&&(a=i[t].cloneNode(!0),f[t].appendChild(a)),t<i.length-1)&&(i[t].parentNode===i[t+1].parentNode?(g=i[t+1].cloneNode(!0),f[c].appendChild(g)):(f[c+=1]=this.createAchorNode(n),a=i[t+1].cloneNode(!0),f[c].appendChild(a)));for(this.parent.nodeSelection.setRange(document,tt.range),t=0,l=0,o=0;t<=i.length;t++)0===t&&(i[t].parentNode.insertBefore(f[l],i[t].nextSibling),1===this.parent.domNode.blockNodes().length&&this.parent.nodeSelection.setSelectionNode(this.parent.currentDocument,f[l]),e[o]=i[t],o++),t<i.length-1&&(i[t].parentNode===i[t+1].parentNode?(e[o]=i[t+1],o++):(l+=1,i[t+1].parentNode.insertBefore(f[l],i[t+1]),e[o]=i[t+1],o++));for(t=0;t<e.length;t++)e[t].parentNode&&e[t].parentNode.removeChild(e[t])},n.prototype.createAchorNode=function(n){var t=Object(r.createElement)("a",{className:"e-rte-anchor",attrs:{href:n.item.url,title:Object(r.isNullOrUndefined)(n.item.title)||""===n.item.title?n.item.url:n.item.title}});return Object(r.isNullOrUndefined)(n.item.target)||t.setAttribute("target",n.item.target),t},n.prototype.getSelectionNodes=function(n){n=n.reverse();for(var t=0;t<n.length;t++)3===n[t].nodeType&&""!==n[t].textContent.trim()||"IMG"!==n[t].nodeName&&(n.splice(t,1),t--);return n.reverse()},n.prototype.isBlockNode=function(n){return!!n&&n.nodeType===Node.ELEMENT_NODE&&di.indexOf(n.tagName.toLowerCase())>=0},n.prototype.removeText=function(n,t){for(var r=n.split(" "),i=0;i<r.length;i++)r[i]===t&&(r.splice(i,1),i--);return r.join(" ")+" "},n.prototype.openLink=function(n){document.defaultView.open(n.item.url,n.item.target);this.callBack(n)},n.prototype.removeLink=function(n){var o=this.parent.domNode.blockNodes(),e,f,t;if(o.length<2){this.parent.domNode.setMarker(n.item.selection);for(var h=Object(r.closest)(n.item.selectParent[0],"a"),i=h||n.item.selectParent[0],s=i.parentNode,u=[];i.firstChild;null)u.push(s.insertBefore(i.firstChild,i));s.removeChild(i);u&&1===u.length&&(n.item.selection.startContainer=n.item.selection.getNodeArray(u[u.length-1],!0),n.item.selection.endContainer=n.item.selection.startContainer);n.item.selection=this.parent.domNode.saveMarker(n.item.selection)}else for(e=0;e<o.length;e++)for(f=o[e].querySelectorAll("a"),t=0;t<f.length;t++)document.getSelection().containsNode(f[t],!0)&&(f[t].outerHTML=f[t].innerHTML);n.item.selection.restore();this.callBack(n)},n.prototype.callBack=function(n){n.callBack&&n.callBack({requestType:n.item.subCommand,editorMode:"HTML",event:n.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)})},n}(),ip=function(){function n(n){this.alignments={JustifyLeft:"left",JustifyCenter:"center",JustifyRight:"right",JustifyFull:"justify"};this.parent=n;this.addEventListener()}return n.prototype.addEventListener=function(){this.parent.observer.on(hl,this.applyAlignment,this);this.parent.observer.on(v,this.onKeyDown,this)},n.prototype.onKeyDown=function(n){switch(n.event.action){case"justify-center":this.applyAlignment({subCommand:"JustifyCenter",callBack:n.callBack});n.event.preventDefault();break;case"justify-full":this.applyAlignment({subCommand:"JustifyFull",callBack:n.callBack});n.event.preventDefault();break;case"justify-left":this.applyAlignment({subCommand:"JustifyLeft",callBack:n.callBack});n.event.preventDefault();break;case"justify-right":this.applyAlignment({subCommand:"JustifyRight",callBack:n.callBack});n.event.preventDefault()}},n.prototype.getTableNode=function(n){var t=n.startContainer.nodeType===Node.ELEMENT_NODE?n.startContainer:n.startContainer.parentNode;return[Object(r.closest)(t,"td,th")]},n.prototype.applyAlignment=function(n){var s="Table"===n.value,u=this.parent.nodeSelection.getRange(this.parent.currentDocument),i=this.parent.nodeSelection.save(u,this.parent.currentDocument),f,t,h,e,o;if(s)Object(r.setStyleAttribute)(this.getTableNode(u)[0],{"text-align":this.alignments[n.subCommand]});else{for(this.parent.domNode.setMarker(i),f=this.parent.domNode.blockNodes(),t=0;t<f.length;t++)h=f[t],Object(r.setStyleAttribute)(h,{"text-align":this.alignments[n.subCommand]});for(e=this.parent.domNode.getImageTagInSelection(),t=0;t<e.length;t++)o=[],o.push(e[t]),this.parent.imgObj.imageCommand({item:{selectNode:o},subCommand:n.subCommand,value:n.subCommand,callBack:n.callBack,selector:n.selector});this.parent.editableElement.focus();i=this.parent.domNode.saveMarker(i);d()&&ai(this.parent.editableElement,n.selector);i.restore()}n.callBack&&n.callBack({requestType:n.subCommand,editorMode:"HTML",event:n.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:s?this.getTableNode(u):this.parent.domNode.blockNodes()})},n}(),rp=function(){function n(n){this.indentValue=20;this.parent=n;this.addEventListener()}return n.prototype.addEventListener=function(){this.parent.observer.on(cl,this.applyIndents,this);this.parent.observer.on(v,this.onKeyDown,this)},n.prototype.onKeyDown=function(n){switch(n.event.action){case"indents":this.applyIndents({subCommand:"Indent",callBack:n.callBack});n.event.preventDefault();break;case"outdents":this.applyIndents({subCommand:"Outdent",callBack:n.callBack});n.event.preventDefault()}},n.prototype.applyIndents=function(n){var h=this.parent.nodeSelection.getRange(this.parent.currentDocument),e=this.parent.nodeSelection.save(h,this.parent.currentDocument);this.parent.domNode.setMarker(e);for(var r=this.parent.domNode.blockNodes(),i=r.slice(),o=[],t=0;t<i.length;t++)"LI"!==i[t].tagName&&"LI"===i[t].parentNode.tagName?(r.splice(r.indexOf(i[t]),1),o.push(i[t].parentNode)):"LI"===i[t].tagName&&(r.splice(r.indexOf(i[t]),1),o.push(i[t]));for(o.length>0&&this.parent.observer.notify(v,{event:{preventDefault:function(){},stopPropagation:function(){},shiftKey:"Indent"!==n.subCommand,which:9,action:"indent"},ignoreDefault:!0}),t=0;t<r.length;t++){var s=r[t],u=s.style.marginLeft,f=void 0;"Indent"===n.subCommand?(f=""===u?this.indentValue+"px":parseInt(u,null)+this.indentValue+"px",s.style.marginLeft=f):(f=""===u||"0px"===u?"":parseInt(u,null)-this.indentValue+"px",s.style.marginLeft=f)}this.parent.editableElement.focus();d()&&ai(this.parent.editableElement,n.selector);(e=this.parent.domNode.saveMarker(e)).restore();n.callBack&&n.callBack({requestType:n.subCommand,editorMode:"HTML",event:n.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.domNode.blockNodes()})},n}(),gt="e-imgright",ni="e-imgleft",gi="e-imgcenter",os="e-imgbreak",c="e-img-caption",ok="e-rte-img-caption",pl="e-caption-inline",up="e-imginline",fp=function(){function n(n){this.parent=n;this.addEventListener()}return n.prototype.addEventListener=function(){this.parent.observer.on(gc,this.imageCommand,this)},n.prototype.imageCommand=function(n){switch(n.value.toString().toLocaleLowerCase()){case"image":case"replace":this.createImage(n);break;case"insertlink":this.insertImageLink(n);break;case"openimagelink":this.openImageLink(n);break;case"editimagelink":this.editImageLink(n);break;case"removeimagelink":this.removeImageLink(n);break;case"remove":this.removeImage(n);break;case"alttext":this.insertAltTextImage(n);break;case"dimension":this.imageDimension(n);break;case"caption":this.imageCaption(n);break;case"justifyleft":this.imageJustifyLeft(n);break;case"justifycenter":this.imageJustifyCenter(n);break;case"justifyright":this.imageJustifyRight(n);break;case"inline":this.imageInline(n);break;case"break":this.imageBreak(n)}},n.prototype.createImage=function(n){var t,i;(n.item.url=Object(r.isNullOrUndefined)(n.item.url)||"undefined"===n.item.url?n.item.src:n.item.url,Object(r.isNullOrUndefined)(n.item.selectParent)||"IMG"!==n.item.selectParent[0].tagName)?(t=Object(r.createElement)("img",{className:"e-rte-image "+n.item.cssClass,attrs:{width:Object(r.isNullOrUndefined)(n.item.width)||Object(r.isNullOrUndefined)(n.item.width.width)?"auto":n.item.width.width,height:Object(r.isNullOrUndefined)(n.item.height)||Object(r.isNullOrUndefined)(n.item.height.height)?"auto":n.item.height.height,alt:""!==n.item.altText?n.item.altText:""}}),t.setAttribute("src",Object(r.isNullOrUndefined)(n.item.url)?"":n.item.url),t.style.minWidth=Object(r.isNullOrUndefined)(n.item.width)||Object(r.isNullOrUndefined)(n.item.width.minWidth)?"0px":n.item.width.minWidth+"px",t.style.maxWidth=Object(r.isNullOrUndefined)(n.item.width)||Object(r.isNullOrUndefined)(n.item.width.maxWidth)?null:n.item.width.maxWidth+"px",t.style.minHeight=Object(r.isNullOrUndefined)(n.item.height)||Object(r.isNullOrUndefined)(n.item.height.minHeight)?"0px":n.item.height.minHeight+"px",t.style.maxHeight=Object(r.isNullOrUndefined)(n.item.height)||Object(r.isNullOrUndefined)(n.item.height.maxHeight)?null:n.item.height.maxHeight+"px",Object(r.isNullOrUndefined)(n.item.selection)||n.item.selection.restore(),Object(r.isNullOrUndefined)(n.selector)||"pasteCleanupModule"!==n.selector?vt.Insert(this.parent.currentDocument,t,this.parent.editableElement):n.callBack({requestType:"Image",editorMode:"HTML",event:n.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:[t]})):(i=n.item.selectParent[0],i.setAttribute("src",n.item.url),i.setAttribute("alt",n.item.altText));n.callBack&&(Object(r.isNullOrUndefined)(n.selector)||!Object(r.isNullOrUndefined)(n.selector)&&"pasteCleanupModule"!==n.selector)&&n.callBack({requestType:"Image",editorMode:"HTML",event:n.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)})},n.prototype.insertImageLink=function(n){var t=Object(r.createElement)("a",{attrs:{href:n.item.url}});n.item.selectNode[0].parentElement.classList.contains("e-img-wrap")&&(n.item.selection.restore(),t.setAttribute("contenteditable","true"));t.appendChild(n.item.selectNode[0]);Object(r.isNullOrUndefined)(n.item.target)||t.setAttribute("target",n.item.target);vt.Insert(this.parent.currentDocument,t,this.parent.editableElement);this.callBack(n)},n.prototype.openImageLink=function(n){document.defaultView.open(n.item.url,n.item.target);this.callBack(n)},n.prototype.removeImageLink=function(n){var t=n.item.selectParent[0];if(t.classList.contains("e-img-caption")){var i=Object(r.select)(".e-img-wrap",t),u=Object(r.select)(".e-img-inner",t),f=u.cloneNode(!0);Object(r.detach)(Object(r.select)("a",t));Object(r.detach)(u);i.appendChild(n.item.insertElement);i.appendChild(f)}else Object(r.detach)(t),r.Browser.isIE&&n.item.selection.restore(),vt.Insert(this.parent.currentDocument,n.item.insertElement,this.parent.editableElement);this.callBack(n)},n.prototype.editImageLink=function(n){n.item.selectNode[0].parentElement.href=n.item.url;Object(r.isNullOrUndefined)(n.item.target)?n.item.selectNode[0].parentElement.removeAttribute("target"):n.item.selectNode[0].parentElement.target=n.item.target;this.callBack(n)},n.prototype.removeImage=function(n){Object(r.closest)(n.item.selectNode[0],"a")?"A"!==n.item.selectNode[0].parentElement.nodeName||Object(r.isNullOrUndefined)(n.item.selectNode[0].parentElement.innerText)?Object(r.detach)(Object(r.closest)(n.item.selectNode[0],"a")):Object(r.detach)(n.item.selectNode[0]):Object(r.isNullOrUndefined)(Object(r.closest)(n.item.selectNode[0],"."+c))?Object(r.detach)(n.item.selectNode[0]):Object(r.detach)(Object(r.closest)(n.item.selectNode[0],"."+c));this.callBack(n)},n.prototype.insertAltTextImage=function(n){n.item.selectNode[0].setAttribute("alt",n.item.altText);this.callBack(n)},n.prototype.imageDimension=function(n){var t=n.item.selectNode[0];t.style.height="";t.style.width="";t.width=n.item.width;t.height=n.item.height;this.callBack(n)},n.prototype.imageCaption=function(n){vt.Insert(this.parent.currentDocument,n.item.insertElement,this.parent.editableElement);this.callBack(n)},n.prototype.imageJustifyLeft=function(n){var t=n.item.selectNode[0];t.removeAttribute("class");Object(r.addClass)([t],"e-rte-image");Object(r.isNullOrUndefined)(Object(r.closest)(t,"."+c))||(Object(r.removeClass)([Object(r.closest)(t,"."+c)],gt),Object(r.addClass)([Object(r.closest)(t,"."+c)],ni));"A"===t.parentElement.nodeName?(Object(r.removeClass)([t.parentElement],gt),Object(r.addClass)([t.parentElement],ni)):Object(r.addClass)([t],ni);this.callBack(n)},n.prototype.imageJustifyCenter=function(n){var t=n.item.selectNode[0];t.removeAttribute("class");Object(r.addClass)([t],"e-rte-image");Object(r.isNullOrUndefined)(Object(r.closest)(t,"."+c))||(Object(r.removeClass)([Object(r.closest)(t,"."+c)],ni),Object(r.removeClass)([Object(r.closest)(t,"."+c)],gt),Object(r.addClass)([Object(r.closest)(t,"."+c)],gi));"A"===t.parentElement.nodeName?(Object(r.removeClass)([t.parentElement],ni),Object(r.removeClass)([t.parentElement],gt),Object(r.addClass)([t.parentElement],gi),Object(r.addClass)([t],gi)):Object(r.addClass)([t],gi);this.callBack(n)},n.prototype.imageJustifyRight=function(n){var t=n.item.selectNode[0];t.removeAttribute("class");Object(r.addClass)([t],"e-rte-image");Object(r.isNullOrUndefined)(Object(r.closest)(t,"."+c))||(Object(r.removeClass)([Object(r.closest)(t,"."+c)],ni),Object(r.addClass)([Object(r.closest)(t,"."+c)],gt));"A"===t.parentElement.nodeName?(Object(r.removeClass)([t.parentElement],ni),Object(r.addClass)([t.parentElement],gt)):Object(r.addClass)([t],gt);this.callBack(n)},n.prototype.imageInline=function(n){var t=n.item.selectNode[0];t.removeAttribute("class");Object(r.addClass)([t],"e-rte-image");Object(r.addClass)([t],up);Object(r.isNullOrUndefined)(Object(r.closest)(t,"."+c))||(Object(r.removeClass)([Object(r.closest)(t,"."+c)],os),Object(r.removeClass)([Object(r.closest)(t,"."+c)],gi),Object(r.removeClass)([Object(r.closest)(t,"."+c)],ni),Object(r.removeClass)([Object(r.closest)(t,"."+c)],gt),Object(r.addClass)([Object(r.closest)(t,"."+c)],pl));this.callBack(n)},n.prototype.imageBreak=function(n){var t=n.item.selectNode[0];t.removeAttribute("class");Object(r.addClass)([t],os);Object(r.addClass)([t],"e-rte-image");Object(r.isNullOrUndefined)(Object(r.closest)(t,"."+c))||(Object(r.removeClass)([Object(r.closest)(t,"."+c)],pl),Object(r.removeClass)([Object(r.closest)(t,"."+c)],gi),Object(r.removeClass)([Object(r.closest)(t,"."+c)],ni),Object(r.removeClass)([Object(r.closest)(t,"."+c)],gt),Object(r.addClass)([Object(r.closest)(t,"."+c)],os));this.callBack(n)},n.prototype.callBack=function(n){n.callBack&&n.callBack({requestType:n.item.subCommand,editorMode:"HTML",event:n.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)})},n}(),ep=function(){function n(n){this.parent=n;this.addEventListener()}return n.prototype.addEventListener=function(){this.parent.observer.on(nl,this.createTable,this);this.parent.observer.on(il,this.insertRow,this);this.parent.observer.on(rl,this.insertColumn,this);this.parent.observer.on(ul,this.deleteRow,this);this.parent.observer.on(fl,this.deleteColumn,this);this.parent.observer.on(el,this.removeTable,this);this.parent.observer.on(ol,this.tableHeader,this);this.parent.observer.on(sl,this.tableVerticalAlign,this)},n.prototype.createTable=function(n){var t=Object(r.createElement)("table",{className:"e-rte-table"}),o=Object(r.createElement)("tbody"),s,u,f,e,i;for(t.style.width=n.item.width.width,s=parseInt(n.item.width.width,10)/n.item.columns,u=0;u<n.item.row;u++){for(f=Object(r.createElement)("tr"),e=0;e<n.item.columns;e++)i=Object(r.createElement)("td"),i.appendChild(Object(r.createElement)("br")),i.style.width=s+"%",f.appendChild(i);o.appendChild(f)}return t.appendChild(o),n.item.selection.restore(),vt.Insert(this.parent.currentDocument,t,this.parent.editableElement),this.removeEmptyNode(),n.item.selection.setSelectionText(this.parent.currentDocument,t.querySelector("td"),t.querySelector("td"),0,0),t.querySelector("td").classList.add("e-cell-select"),n.callBack&&n.callBack({requestType:"Table",editorMode:"HTML",event:n.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:[t]}),t},n.prototype.removeEmptyNode=function(){for(var t,u,i=this.parent.editableElement.querySelectorAll("ul:empty, ol:empty"),n=0;n<i.length;n++)Object(r.detach)(i[n]);for(t=this.parent.editableElement.querySelectorAll("li *:empty"),n=0;n<t.length;n++)Object(r.detach)(t[n]),t.length===n+1&&(t=this.parent.editableElement.querySelectorAll("li *:empty"),n=-1);for(u=this.parent.editableElement.querySelectorAll("li:empty"),n=0;n<u.length;n++)Object(r.detach)(u[n])},n.prototype.insertAfter=function(n,t){t.parentNode.insertBefore(n,t.nextSibling)},n.prototype.insertRow=function(n){var t=n.item.selection.range.startContainer,i,u,o,s,f,e;if("th"!==(t=3===t.nodeType?t.parentNode:t).nodeName.toLowerCase()||"InsertRowBefore"!==n.item.subCommand){if(u=Object(r.closest)(t,"tr"),"th"!==t.nodeName.toLowerCase())i=Object(r.closest)(t,"tr").cloneNode(!0),o=Array.prototype.slice.call(i.querySelectorAll("td")),Array.prototype.forEach.call(o,function(n){n.innerHTML="";n.appendChild(Object(r.createElement)("br"));n.removeAttribute("class")});else for(s=u.childNodes,i=Object(r.createElement)("tr"),f=0;f<s.length;f++)e=Object(r.createElement)("td"),e.appendChild(Object(r.createElement)("br")),i.appendChild(e);"InsertRowBefore"===n.item.subCommand?u.parentElement.insertBefore(i,u):this.insertAfter(i,u);n.item.selection.setSelectionText(this.parent.currentDocument,n.item.selection.range.startContainer,n.item.selection.range.startContainer,0,0);n.callBack&&n.callBack({requestType:n.item.subCommand,editorMode:"HTML",event:n.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)})}},n.prototype.insertColumn=function(n){var t=n.item.selection.range.startContainer,e,i;t="TD"!==(t=3===t.nodeType?t.parentNode:t).nodeName?Object(r.closest)(t,"td,th"):t;for(var f,u=Object(r.closest)(t,"tr"),s=Object(r.closest)(u,"table").rows,h=Array.prototype.slice.call(u.querySelectorAll("th,td")).indexOf(t),c=parseInt(n.item.width,10)/(u.querySelectorAll("td,th").length+1),o=0;o<Object(r.closest)(u,"table").querySelectorAll("th,td").length;o++)Object(r.closest)(u,"table").querySelectorAll("th,td")[o].style.width=c+"%";for(e=0;e<s.length;e++)i=(f=s[e].querySelectorAll("th,td")[h]).cloneNode(!0),i.innerHTML="",i.appendChild(Object(r.createElement)("br")),i.removeAttribute("class"),"InsertColumnLeft"===n.item.subCommand?f.parentElement.insertBefore(i,f):this.insertAfter(i,f);n.item.selection.setSelectionText(this.parent.currentDocument,t,t,0,0);n.callBack&&n.callBack({requestType:n.item.subCommand,editorMode:"HTML",event:n.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)})},n.prototype.deleteColumn=function(n){var t=n.item.selection.range.startContainer,c=(t=3===t.nodeType?t.parentNode:t).cellIndex,u=Object(r.closest)(t,"table"),e=Object(r.closest)(t,"tr"),o=Object(r.closest)(e,"table").rows,i,f,s,h;if(1===e.querySelectorAll("th,td").length)n.item.selection.restore(),Object(r.detach)(Object(r.closest)(t.parentElement,"table"));else for(i=0;i<o.length;i++)o[i].deleteCell(c),r.Browser.isIE&&(n.item.selection.setSelectionText(this.parent.currentDocument,u.querySelector("td"),u.querySelector("td"),0,0),u.querySelector("td, th").classList.add("e-cell-select"));n.callBack&&(f=this.parent.nodeSelection.getRange(this.parent.currentDocument).startContainer,"TD"!==f.nodeName&&(s=this.parent.nodeSelection.getRange(this.parent.currentDocument).startOffset,h=f.children[s],this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,h,0)),n.callBack({requestType:n.item.subCommand,editorMode:"HTML",event:n.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)}))},n.prototype.deleteRow=function(n){var t=n.item.selection.range.startContainer,u=(t=3===t.nodeType?t.parentNode:t).parentNode.rowIndex,i=Object(r.closest)(t,"table");1===i.rows.length?(n.item.selection.restore(),Object(r.detach)(Object(r.closest)(t.parentElement,"table"))):("TH"===t.tagName?Object(r.detach)(i.querySelector("thead")):i.deleteRow(u),n.item.selection.setSelectionText(this.parent.currentDocument,i.querySelector("td"),i.querySelector("td"),0,0),i.querySelector("td, th").classList.add("e-cell-select"));n.callBack&&n.callBack({requestType:n.item.subCommand,editorMode:"HTML",event:n.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)})},n.prototype.removeTable=function(n){var t=n.item.selection.range.startContainer,i;t=3===t.nodeType?t.parentNode:t;i=Object(r.closest)(t.parentElement,"table");i&&(n.item.selection.restore(),Object(r.detach)(i));n.callBack&&n.callBack({requestType:n.item.subCommand,editorMode:"HTML",event:n.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)})},n.prototype.tableHeader=function(n){var f=!1,i=n.item.selection.range.startContainer,t,u;if(i=3===i.nodeType?i.parentNode:i,t=Object(r.closest)(i.parentElement,"table"),[].slice.call(t.childNodes).forEach(function(n){"THEAD"===n.nodeName&&(f=!0)}),t&&!f)for(var o=t.querySelector("tr").childElementCount,s=t.createTHead().insertRow(0),e=0;e<o;e++)u=Object(r.createElement)("th"),u.appendChild(Object(r.createElement)("br")),s.appendChild(u);else t.deleteTHead();n.callBack&&n.callBack({requestType:n.item.subCommand,editorMode:"HTML",event:n.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)})},n.prototype.tableVerticalAlign=function(n){n.item.tableCell.style.verticalAlign="AlignTop"===n.item.subCommand?"top":"AlignMiddle"===n.item.subCommand?"middle":"bottom";n.callBack&&n.callBack({requestType:n.item.subCommand,editorMode:"HTML",event:n.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)})},n}(),yt=function(){function n(){}return n.prototype.getFormattedNode=function(n,t,i){var r=this.getFormatParent(n,t,i);return null!==r&&r!==i?r:null},n.prototype.getFormatParent=function(n,t,i){do n=n.parentNode;while(n&&n!==i&&!this.isFormattedNode(n,t));return n},n.prototype.isFormattedNode=function(t,i){switch(i){case"bold":return n.isBold(t);case"italic":return n.isItalic(t);case"underline":return n.isUnderline(t);case"strikethrough":return n.isStrikethrough(t);case"superscript":return n.isSuperscript(t);case"subscript":return n.isSubscript(t);case"fontcolor":return this.isFontColor(t);case"fontname":return this.isFontName(t);case"fontsize":return this.isFontSize(t);case"backgroundcolor":return this.isBackgroundColor(t);default:return!1}},n.isBold=function(n){return-1!==["strong","b"].indexOf(n.nodeName.toLowerCase())||!(-1===this.inlineTags.indexOf(n.nodeName.toLowerCase())||!n.style||"bold"!==n.style.fontWeight)},n.isItalic=function(n){return-1!==["em","i"].indexOf(n.nodeName.toLowerCase())||!(-1===this.inlineTags.indexOf(n.nodeName.toLowerCase())||!n.style||"italic"!==n.style.fontStyle)},n.isUnderline=function(n){return-1!==["u"].indexOf(n.nodeName.toLowerCase())||!(-1===this.inlineTags.indexOf(n.nodeName.toLowerCase())||!n.style||"underline"!==n.style.textDecoration)},n.isStrikethrough=function(n){return-1!==["del","strike"].indexOf(n.nodeName.toLowerCase())||!(-1===this.inlineTags.indexOf(n.nodeName.toLowerCase())||!n.style||"line-through"!==n.style.textDecoration)},n.isSuperscript=function(n){return-1!==["sup"].indexOf(n.nodeName.toLowerCase())},n.isSubscript=function(n){return-1!==["sub"].indexOf(n.nodeName.toLowerCase())},n.prototype.isFontColor=function(t){var i=t.style&&t.style.color;return-1!==n.inlineTags.indexOf(t.nodeName.toLowerCase())&&null!==i&&""!==i&&void 0!==i},n.prototype.isBackgroundColor=function(t){var i=t.style&&t.style.backgroundColor;return-1!==n.inlineTags.indexOf(t.nodeName.toLowerCase())&&null!==i&&""!==i&&void 0!==i},n.prototype.isFontSize=function(t){var i=t.style&&t.style.fontSize;return-1!==n.inlineTags.indexOf(t.nodeName.toLowerCase())&&null!==i&&""!==i&&void 0!==i},n.prototype.isFontName=function(t){var i=t.style&&t.style.fontFamily;return-1!==n.inlineTags.indexOf(t.nodeName.toLowerCase())&&null!==i&&""!==i&&void 0!==i},n.inlineTags=["a","abbr","acronym","b","bdo","big","cite","code","dfn","em","i","kbd","label","q","samp","small","span","strong","sub","sup","tt","u","var"],n}(),wl=function(){function n(){}return n.applyFormat=function(n,t,i,r,u){var w,o,c;if(["bold","italic","underline","strikethrough","superscript","subscript","uppercase","lowercase","fontcolor","fontname","fontsize","backgroundcolor"].indexOf(t)>-1){var a,f=new k,h=new su,y=new yt,e=f.getRange(n),b=f.save(e,n),s=f.getSelectionNodeCollection(e),p=!1,l=!1,v=["fontcolor","fontname","fontsize","backgroundcolor"].indexOf(t)>-1;for(e.collapsed&&(s.length>0?(p=!0,e=h.GetCursorRange(n,e,s[0])):"td"!==e.startContainer.nodeName.toLowerCase()&&(w=this.insertCursorNode(n,f,e,y,h,t,r,i),f.endContainer=f.startContainer=f.getNodeArray(w,!0),f.endOffset=f.startOffset=1)),a=e.collapsed,o=0;o<s.length;o++)c=y.getFormattedNode(s[o],t,i),0===o&&null===c&&(l=!0),s[o]=null===c||l&&!v?this.insertFormat(n,s,o,c,a,l,v,e,h,t,r):this.removeFormat(s,o,c,a,l,v,e,h,t,r,f),f=this.applySelection(s,f,h,o,p);d()&&ai(i,u);b.restore()}},n.insertCursorNode=function(n,t,i,r,u,f,e,o){var s=t.getNodeCollection(i),c=s.length>0?r.getFormattedNode(s[0],f,o):null,h=null;return c?(h=s[0],l.unwrap(c),s[0]=l.Wrap(s[0],this.GetFormatNode(f,e))):h=this.getInsertNode(n,i,f,e).firstChild,h},n.removeFormat=function(n,t,i,u,f,e,o,s,h,c,a){var nt=null,y,v,p,g,b,k,w,d;if(o.startContainer!==o.endContainer||0!==o.startOffset||o.endOffset!==o.startContainer.length){y=[];v=n[t];do y.push(a.getIndex(v)),v=v.parentNode;while(v&&v!==i);if(v=nt=u&&i.textContent.length-1===o.startOffset?s.SplitNode(o,i,!0):s.GetSpliceNode(o,i),u){for(p=nt;null!==p.firstChild&&3!==p.firstChild.nodeType;null)p=p.firstChild;p.innerHTML="&#8203;";n[t]=p.firstChild}else{for(;v&&v.childNodes.length>0&&y.length-1>=0&&v.childNodes.length>y[y.length-1];)v=v.childNodes[y[y.length-1]],y.pop();3!==v.nodeType||u&&""===v.nodeValue?(g=document.createElement("div"),g.innerHTML="&#8203;",3!==v.nodeType?(v.insertBefore(g.firstChild,v.firstChild),n[t]=v.firstChild):(v.parentNode.insertBefore(g.firstChild,v),n[t]=v.previousSibling,v.parentNode.removeChild(v))):n[t]=v}}if(b=l.unwrap(i),b.length>0&&e){for(k=0;k<b.length;k++)b[k]=l.Wrap(b[k],this.GetFormatNode(h,c));if("fontsize"===h){for(w=n[t].parentElement,d=n[t].parentElement;!Object(r.isNullOrUndefined)(d)&&"li"!==d.tagName.toLowerCase();)w=d=d.parentElement;Object(r.isNullOrUndefined)(w)||"li"!==w.tagName.toLowerCase()||w.textContent.trim()!==n[t].textContent.trim()||(w.style.fontSize=c)}}return n[t]},n.insertFormat=function(n,t,i,u,f,e,o,s,h,c,l){var v,a,y;if(f)"uppercase"!==c&&"lowercase"!==c?(v=this.getInsertNode(n,s,c,l),t[i]=v.firstChild,h.position=1):h.position=s.startOffset;else if(null===u&&e||o){if(t[i]=h.GetSpliceNode(s,t[i]),t[i].textContent=h.TrimLineBreak(t[i].textContent),"uppercase"===c||"lowercase"===c)t[i].textContent="uppercase"===c?t[i].textContent.toLocaleUpperCase():t[i].textContent.toLocaleLowerCase();else if(!0!==o||""!==l)if(v=this.GetFormatNode(c,l),"fontsize"===c){for(a=t[i].parentElement,y=t[i].parentElement;!Object(r.isNullOrUndefined)(y)&&"li"!==y.tagName.toLowerCase();)a=y=y.parentElement;Object(r.isNullOrUndefined)(a)||"li"!==a.tagName.toLowerCase()||a.textContent.trim()!==t[i].textContent.trim()||(a.style.fontSize=l);t[i]=this.applyStyles(t,i,v)}else t[i]=this.applyStyles(t,i,v)}else t[i]=h.GetSpliceNode(s,t[i]);return t[i]},n.applyStyles=function(n,t,i){return n[t]=t===n.length-1?l.Wrap(n[t],i):l.WrapBefore(n[t],i,!0),n[t]=this.getChildNode(n[t],i),n[t]},n.getInsertNode=function(n,t,i,u){var f=this.GetFormatNode(i,u),e;return(f.innerHTML="&#8203;",r.Browser.isIE)?(e=n.createDocumentFragment(),e.appendChild(f),t.insertNode(e)):t.insertNode(f),f},n.getChildNode=function(n,t){return null==n&&(t.innerHTML="&#8203;",n=t.firstChild),n},n.applySelection=function(n,t,i,r,u){return 1!==n.length||u?1===n.length&&u?(t.startContainer=t.getNodeArray(n[r],!0),t.endContainer=t.startContainer,t.startOffset=i.position,t.endOffset=i.position):0===r?(t.startContainer=t.getNodeArray(n[r],!0),t.startOffset=0):r===n.length-1&&(t.endContainer=t.getNodeArray(n[r],!1),t.endOffset=n[r].textContent.length):(t.startContainer=t.getNodeArray(n[r],!0),t.endContainer=t.startContainer,t.startOffset=0,t.endOffset=n[r].textContent.length),t},n.GetFormatNode=function(n,t){var i;switch(n){case"bold":return document.createElement("strong");case"italic":return document.createElement("em");case"underline":return(i=document.createElement("span")).style.textDecoration="underline",i;case"strikethrough":return(i=document.createElement("span")).style.textDecoration="line-through",i;case"superscript":return document.createElement("sup");case"subscript":return document.createElement("sub");case"fontcolor":return(i=document.createElement("span")).style.color=t,i.style.textDecoration="inherit",i;case"fontname":return(i=document.createElement("span")).style.fontFamily=t,i;case"fontsize":return(i=document.createElement("span")).style.fontSize=t,i;default:return(i=document.createElement("span")).style.backgroundColor=t,i}},n}(),op=function(){function n(n){this.parent=n;this.addEventListener()}return n.prototype.addEventListener=function(){this.parent.observer.on(ll,this.applySelection,this);this.parent.observer.on(v,this.keyDownHandler,this)},n.prototype.keyDownHandler=function(n){n.event.ctrlKey&&["bold","italic","underline","strikethrough","superscript","subscript","uppercase","lowercase"].indexOf(n.event.action)>-1&&(n.event.preventDefault(),wl.applyFormat(this.parent.currentDocument,n.event.action,this.parent.editableElement),this.callBack(n,n.event.action))},n.prototype.applySelection=function(n){wl.applyFormat(this.parent.currentDocument,n.subCommand.toLocaleLowerCase(),this.parent.editableElement,n.value,n.selector);this.callBack(n,n.subCommand)},n.prototype.callBack=function(n,t){n.callBack&&n.callBack({requestType:t,event:n.event,editorMode:"HTML",range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)})},n}(),sp=function(){function n(n){this.parent=n;this.addEventListener()}return n.prototype.addEventListener=function(){this.parent.observer.on(al,this.applyHtml,this)},n.prototype.applyHtml=function(n){vt.Insert(this.parent.currentDocument,n.value,this.parent.editableElement,!0);"pasteCleanup"===n.subCommand?n.callBack({requestType:n.subCommand,editorMode:"HTML",elements:n.value}):n.callBack&&n.callBack({requestType:n.subCommand,editorMode:"HTML",event:n.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)})},n}(),sk=function(){function n(){}return n.clear=function(n,t,i){var r=new k,o=new su,u=r.getRange(n),v=u.collapsed,s=r.getInsertNodeCollection(u),l=r.save(u,n),h,f,e,c,a;v||(h=o.GetSpliceNode(u,s[0]),1===s.length?(r.setSelectionContents(n,h),u=r.getRange(n)):(f=o.GetSpliceNode(u,s[s.length-1]),r.setSelectionText(n,h,f,0,3===f.nodeType?f.textContent.length:f.childNodes.length),u=r.getRange(n)),e=r.getNodeCollection(u),c=e.slice(),this.clearInlines(r.getSelectionNodes(c),c,r.getRange(n),o,t),this.reSelection(n,l,e),u=r.getRange(n),a=(e=r.getNodeCollection(u)).slice(),this.clearBlocks(n,a,t,o,r),d()&&ai(t,i),this.reSelection(n,l,e))},n.reSelection=function(n,t,i){var r=t.getInsertNodes(i),u;t.startContainer=t.getNodeArray(r[0],!0,n);t.startOffset=0;t.endContainer=t.getNodeArray(r[r.length-1],!1,n);u=r[r.length-1];t.endOffset=3===u.nodeType?u.textContent.length:u.childNodes.length;t.restore()},n.clearBlocks=function(n,t,i,r,u){for(var f=[],e=0;e<t.length;e++)this.BLOCK_TAGS.indexOf(t[e].nodeName.toLocaleLowerCase())>-1&&-1===f.indexOf(t[e])?f.push(t[e]):this.BLOCK_TAGS.indexOf(t[e].parentNode.nodeName.toLocaleLowerCase())>-1&&-1===f.indexOf(t[e].parentNode)&&i!==t[e].parentNode&&f.push(t[e].parentNode);f=this.spliceParent(f,t)[0];f=this.removeParent(f);this.unWrap(n,f,r,u)},n.spliceParent=function(n,t){for(var f,r,u,e,o,s,i=0;i<n.length;i++)for(f=n[i].childNodes.length,r=0;r<f;r++)if(t.indexOf(n[i].childNodes[r])>0&&n[i].childNodes[r].childNodes.length>0&&(t=this.spliceParent([n[i].childNodes[r]],t)[1]),t.indexOf(n[i].childNodes[r])<=-1&&""!==n[i].childNodes[r].textContent.trim()){for(u=0;u<f;u++)t.indexOf(n[i].childNodes[u])>-1&&t.splice(t.indexOf(n[i].childNodes[u]),1);r=n[i].childNodes.length;e=n.indexOf(n[i].parentNode);o=t.indexOf(n[i].parentNode);e>-1&&n.splice(e,1);o>-1&&t.splice(o,1);s=t.indexOf(n[i]);s>-1&&t.splice(s,1);n.splice(i,1);i--}return[n,t]},n.removeChild=function(n,t){var r=t.childNodes.length,i;if(r>0)for(i=0;i<r;i++)n.indexOf(t.childNodes[i])>-1&&(n=this.removeChild(n,t.childNodes[i])).splice(n.indexOf(t.childNodes[i]),1);return n},n.removeParent=function(n){for(var t=0;t<n.length;t++)n.indexOf(n[t].parentNode)>-1&&((n=this.removeChild(n,n[t])).splice(t,1),t--);return n},n.unWrap=function(n,t,i,r){for(var f,e,o,u=0;u<t.length;u++)if(this.NONVALID_TAGS.indexOf(t[u].nodeName.toLowerCase())>-1&&t[u].parentNode&&this.NONVALID_PARENT_TAGS.indexOf(t[u].parentNode.nodeName.toLowerCase())>-1&&(r.setSelectionText(n,t[u],t[u],0,t[u].childNodes.length),l.unwrap(i.GetSpliceNode(r.getRange(n),t[u].parentNode))),"p"!==t[u].nodeName.toLocaleLowerCase())for(!(this.NONVALID_PARENT_TAGS.indexOf(t[u].nodeName.toLowerCase())<0&&"p"!==t[u].parentNode.nodeName.toLocaleLowerCase())||("blockquote"===t[u].nodeName.toLocaleLowerCase()||"li"===t[u].nodeName.toLocaleLowerCase())&&this.IGNORE_PARENT_TAGS.indexOf(t[u].childNodes[0].nodeName.toLocaleLowerCase())>-1||1===t[u].childNodes.length&&"p"===t[u].childNodes[0].nodeName.toLocaleLowerCase()||l.Wrap(t[u],n.createElement("p")),f=l.unwrap(t[u]),1===f.length&&"p"===f[0].parentNode.nodeName.toLocaleLowerCase()&&(l.Wrap(t[u],n.createElement("p")),l.unwrap(t[u])),e=0;e<f.length;e++)this.NONVALID_TAGS.indexOf(f[e].nodeName.toLowerCase())>-1?this.unWrap(n,[f[e]],i,r):this.BLOCK_TAGS.indexOf(f[e].nodeName.toLocaleLowerCase())>-1&&"p"!==f[e].nodeName.toLocaleLowerCase()?(o=this.removeParent([f[e]]),this.unWrap(n,o,i,r)):this.BLOCK_TAGS.indexOf(f[e].nodeName.toLocaleLowerCase())>-1&&f[e].parentNode.nodeName.toLocaleLowerCase()===f[e].nodeName.toLocaleLowerCase()?l.unwrap(f[e]):this.BLOCK_TAGS.indexOf(f[e].nodeName.toLocaleLowerCase())>-1&&"p"===f[e].nodeName.toLocaleLowerCase()&&(l.Wrap(f[e],n.createElement("p")),l.unwrap(f[e]));else l.Wrap(t[u],n.createElement("p")),l.unwrap(t[u])},n.clearInlines=function(n,t,i,r){for(var u=0;u<n.length;u++)n[u].parentNode&&yt.inlineTags.indexOf(n[u].parentNode.nodeName.toLocaleLowerCase())>-1&&(r.GetSpliceNode(i,n[u].parentNode),this.removeInlineParent(n[u].parentNode))},n.removeInlineParent=function(n){for(var i=l.unwrap(n),t=0;t<i.length;t++)1===i[t].parentNode.childNodes.length&&yt.inlineTags.indexOf(i[t].parentNode.nodeName.toLocaleLowerCase())>-1?this.removeInlineParent(i[t].parentNode):yt.inlineTags.indexOf(i[t].nodeName.toLocaleLowerCase())>-1&&this.removeInlineParent(i[t])},n.BLOCK_TAGS=["address","article","aside","blockquote","details","dd","div","dl","dt","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","li","main","nav","noscript","ol","p","pre","section","table","tbody","td","tfoot","th","thead","tr","ul"],n.NONVALID_PARENT_TAGS=["thead","tbody","ul","ol","table","tfoot","tr"],n.IGNORE_PARENT_TAGS=["ul","ol","table"],n.NONVALID_TAGS=["thead","tbody","figcaption","td","tr","th","tfoot","figcaption","li"],n}(),hp=function(){function n(n){this.parent=n;this.addEventListener()}return n.prototype.addEventListener=function(){this.parent.observer.on(yl,this.applyClear,this);this.parent.observer.on(v,this.onKeyDown,this)},n.prototype.onKeyDown=function(n){switch(n.event.action){case"clear-format":this.applyClear({subCommand:"ClearFormat",callBack:n.callBack});n.event.preventDefault()}},n.prototype.applyClear=function(n){"ClearFormat"===n.subCommand&&(sk.clear(this.parent.currentDocument,this.parent.editableElement,n.selector),n.callBack&&n.callBack({requestType:n.subCommand,event:n.event,editorMode:"HTML",range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)}))},n}(),cp=function(){function n(n,t){this.undoRedoStack=[];this.parent=n;this.undoRedoSteps=Object(r.isNullOrUndefined)(t)?30:t.undoRedoSteps;this.undoRedoTimer=Object(r.isNullOrUndefined)(t)?300:t.undoRedoTimer;this.addEventListener()}return n.prototype.addEventListener=function(){var n=Object(r.debounce)(this.keyUp,this.undoRedoTimer);this.parent.observer.on(li,n,this);this.parent.observer.on(v,this.keyDown,this);this.parent.observer.on(ki,this.onAction,this);this.parent.observer.on(eu,this.onPropertyChanged,this)},n.prototype.onPropertyChanged=function(n){for(var t=0,i=Object.keys(n.newProp);t<i.length;t++)switch(i[t]){case"undoRedoSteps":this.undoRedoSteps=n.newProp.undoRedoSteps;break;case"undoRedoTimer":this.undoRedoTimer=n.newProp.undoRedoTimer}},n.prototype.removeEventListener=function(){this.parent.observer.off(li,this.keyUp);this.parent.observer.off(v,this.keyDown);this.parent.observer.off(ki,this.onAction)},n.prototype.onAction=function(n){"Undo"===n.subCommand?this.undo(n):this.redo(n)},n.prototype.destroy=function(){this.removeEventListener()},n.prototype.keyDown=function(n){var t=n.event;switch(t.action){case"undo":t.preventDefault();this.undo(n);break;case"redo":t.preventDefault();this.redo(n)}},n.prototype.keyUp=function(n){17===n.event.keyCode||n.event.ctrlKey||this.saveData(n)},n.prototype.saveData=function(n){var i=(new k).getRange(this.parent.currentDocument),t=(new k).save(i,this.parent.currentDocument),r={text:this.parent.editableElement.innerHTML,range:t};this.undoRedoStack.length>=this.steps&&(this.undoRedoStack=this.undoRedoStack.slice(0,this.steps+1));this.undoRedoStack.length>1&&this.undoRedoStack[this.undoRedoStack.length-1].range.range.collapsed===i.collapsed&&this.undoRedoStack[this.undoRedoStack.length-1].range.startOffset===t.range.startOffset&&this.undoRedoStack[this.undoRedoStack.length-1].range.endOffset===t.range.endOffset&&this.undoRedoStack[this.undoRedoStack.length-1].range.range.startContainer===t.range.startContainer&&this.undoRedoStack[this.undoRedoStack.length-1].text.trim()===r.text.trim()||(this.undoRedoStack.push(r),this.steps=this.undoRedoStack.length-1,this.steps>this.undoRedoSteps&&(this.undoRedoStack.shift(),this.steps--),n&&n.callBack&&n.callBack())},n.prototype.undo=function(n){if(this.steps>0){var t=this.undoRedoStack[this.steps-1].range,i=this.undoRedoStack[this.steps-1].text;this.parent.editableElement.innerHTML=i;this.parent.editableElement.focus();d()&&ai(this.parent.editableElement,n.selector);t.restore();this.steps--;n.callBack&&n.callBack({requestType:"Undo",editorMode:"HTML",range:t,elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument),event:n.event})}},n.prototype.redo=function(n){if(null!=this.undoRedoStack[this.steps+1]){var t=this.undoRedoStack[this.steps+1].range;this.parent.editableElement.innerHTML=this.undoRedoStack[this.steps+1].text;this.parent.editableElement.focus();d()&&ai(this.parent.editableElement,n.selector);t.restore();this.steps++;n.callBack&&n.callBack({requestType:"Redo",editorMode:"HTML",range:t,elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument),event:n.event})}},n.prototype.getUndoStatus=function(){var n={undo:!1,redo:!1};return this.steps>0&&(n.undo=!0),null!=this.undoRedoStack[this.steps+1]&&(n.redo=!0),n},n}(),lp=function(){function n(n){this.olData=["decimal","lower-alpha","lower-roman","upper-alpha","upper-roman","lower-greek"];this.ulData=["disc","square","circle","disc","square","circle"];this.ignorableNodes=["A","APPLET","B","BLOCKQUOTE","BR","BUTTON","CENTER","CODE","COL","COLGROUP","DD","DEL","DFN","DIR","DIV","DL","DT","EM","FIELDSET","FONT","FORM","FRAME","FRAMESET","H1","H2","H3","H4","H5","H6","HR","I","IMG","IFRAME","INPUT","INS","LABEL","LI","OL","OPTION","P","PARAM","PRE","Q","S","SELECT","SPAN","STRIKE","STRONG","SUB","SUP","TABLE","TBODY","TD","TEXTAREA","TFOOT","TH","THEAD","TITLE","TR","TT","U","UL"];this.blockNode=["div","p","h1","h2","h3","h4","h5","h6","address","blockquote","button","center","dd","dir","dl","dt","fieldset","frameset","hr","iframe","isindex","li","map","menu","noframes","noscript","object","ol","pre","table","tbody","td","tfoot","th","thead","tr","ul","header","article","nav","footer","section","aside","main","figure","figcaption"];this.removableElements=["o:p","style"];this.listContents=[];this.parent=n;this.addEventListener()}return n.prototype.addEventListener=function(){this.parent.observer.on(hc,this.wordCleanup,this)},n.prototype.wordCleanup=function(n){var f=n.allowedStylePropertiesArray,i=[],u=n.args.clipboardData.getData("text/HTML"),e=n.args.clipboardData.getData("text/rtf"),t=Object(r.createElement)("p");t.setAttribute("id","MSWord-Content");t.innerHTML=u;/class='?Mso|style='[^ ]*\bmso-/i.test(u)||/class="?Mso|style="[^ ]*\bmso-/i.test(u)||/(class="?Mso|class='?Mso|class="?Xl|class='?Xl|class=Xl|style="[^"]*\bmso-|style='[^']*\bmso-|w:WordDocument)/gi.test(u)?(this.imageConversion(t,e),u=u.replace(/<img[^>]+>/i,""),i=this.cleanUp(t,i),Object(r.isNullOrUndefined)(i[0])||"UL"===i[0].parentElement.tagName||"OL"===i[0].parentElement.tagName||this.listConverter(i),this.styleCorrection(t,f),this.removingComments(t),this.removeUnwantedElements(t),this.removeEmptyElements(t),this.breakLineAddition(t),this.removeClassName(t),n.callBack(t.innerHTML)):n.callBack(t.innerHTML)},n.prototype.imageConversion=function(n,t){var i,u;this.checkVShape(n);var r=n.querySelectorAll("img"),o=[],f=[],e=[];if(r.length>0){for(i=0;i<r.length;i++)o.push(r[i].getAttribute("src")),e.push(r[i].getAttribute("src").split("/")[r[i].getAttribute("src").split("/").length-1].split(".")[0]);for(u=this.hexConversion(t),i=0;i<u.length;i++)f.push(this.convertToBase64(u[i]));for(i=0;i<r.length;i++)r[i].setAttribute("src",f[i]),r[i].setAttribute("id","msWordImg-"+e[i])}},n.prototype.checkVShape=function(n){for(var f,u,i=n.querySelectorAll("*"),t=0;t<i.length;t++)switch(i[t].nodeName){case"V:SHAPETYPE":Object(r.detach)(i[t]);break;case"V:SHAPE":"V:IMAGEDATA"===i[t].firstElementChild.nodeName&&(f=i[t].firstElementChild.getAttribute("src"),u=Object(r.createElement)("img"),u.setAttribute("src",f),i[t].parentElement.insertBefore(u,i[t]),Object(r.detach)(i[t]))}},n.prototype.convertToBase64=function(n){var t=this.conHexStringToBytes(n.hex),i=this.conBytesToBase64(t);return n.type?"data:"+n.type+";base64,"+i:null},n.prototype.conBytesToBase64=function(n){for(var t,e="",o=n.length,u=0;u<o;u+=3){var i=n.slice(u,u+3),f=i.length,r=[];if(f<3)for(t=f;t<3;t++)i[t]=0;for(r[0]=(252&i[0])>>2,r[1]=(3&i[0])<<4|i[1]>>4,r[2]=(15&i[1])<<2|(192&i[2])>>6,r[3]=63&i[2],t=0;t<4;t++)e+=t<=f?"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(r[t]):"="}return e},n.prototype.conHexStringToBytes=function(n){for(var i=[],r=n.length/2,t=0;t<r;t++)i.push(parseInt(n.substr(2*t,2),16));return i},n.prototype.hexConversion=function(n){for(var r,u=/\{\\pict[\s\S]+?\\bliptag\-?\d+(\\blipupi\-?\d+)?(\{\\\*\\blipuid\s?[\da-fA-F]+)?[\s\}]*?/,e=new RegExp("(?:("+u.source+"))([\\da-fA-F\\s]+)\\}","g"),i=n.match(e),f=[],t=0;t<i.length;t++)if(u.test(i[t])){if(-1!==i[t].indexOf("\\pngblip"))r="image/png";else{if(-1===i[t].indexOf("\\jpegblip"))continue;r="image/jpeg"}f.push({hex:r?i[t].replace(u,"").replace(/[^\da-fA-F]/g,""):null,type:r})}return f},n.prototype.removeClassName=function(n){for(var i=n.querySelectorAll("*[class]"),t=0;t<i.length;t++)i[t].removeAttribute("class")},n.prototype.breakLineAddition=function(n){for(var u,f,i=n.querySelectorAll("*"),t=0;t<i.length;t++)0!==i[t].children.length||"&nbsp;"!==i[t].innerHTML||"&nbsp;"!==i[t].innerHTML||i[t].closest("li")||(u=this.findDetachElem(i[t]),f=Object(r.createElement)("br"),Object(r.isNullOrUndefined)(u.parentElement)||(u.parentElement.insertBefore(f,u),Object(r.detach)(u)))},n.prototype.findDetachElem=function(n){return Object(r.isNullOrUndefined)(n.parentElement)||""!==n.parentElement.textContent.trim()||"TD"===n.parentElement.tagName?n:this.findDetachElem(n.parentElement)},n.prototype.removeUnwantedElements=function(n){for(var r,u,t=n.innerHTML,i=0;i<this.removableElements.length;i++)r=new RegExp("<"+this.removableElements[i]+">","g"),u=new RegExp("<\/"+this.removableElements[i]+">","g"),t=(t=t.replace(r,"")).replace(u,"");n.innerHTML=t;n.querySelectorAll(":empty")},n.prototype.findDetachEmptyElem=function(n){return Object(r.isNullOrUndefined)(n.parentElement)?null:""===n.parentElement.textContent.trim()&&"MSWord-Content"!==n.parentElement.getAttribute("id")&&Object(r.isNullOrUndefined)(n.parentElement.querySelector("img"))?this.findDetachEmptyElem(n.parentElement):n},n.prototype.removeEmptyElements=function(n){for(var u,i=n.querySelectorAll(":empty"),t=0;t<i.length;t++)"IMG"!==i[t].tagName&&"BR"!==i[t].tagName&&(u=this.findDetachEmptyElem(i[t]),Object(r.isNullOrUndefined)(u)||Object(r.detach)(u))},n.prototype.styleCorrection=function(n,t){var l=n.querySelectorAll("style"),f,i,o,h,c,s,y;if(l.length>0){var a=l[0].innerHTML.match(/[\S ]+\s+{[\s\S]+?}/gi),v=Object(r.isNullOrUndefined)(a)?null:this.findStyleObject(a),u=Object.keys(v),e=u.map(function(n){return v[n]});for(e=this.removeUnwantedStyle(e,t),this.filterStyles(n,t),f=void 0,i=0;i<u.length;i++){if(""===u[i].split(".")[0])f=n.getElementsByClassName(u[i].split(".")[1]);else{if(1===u[i].split(".").length&&u[i].split(".")[0].indexOf("@")>=0)continue;f=1===u[i].split(".").length&&u[i].split(".")[0].indexOf("@")<0?n.getElementsByTagName(u[i]):n.querySelectorAll(u[i])}for(o=0;o<f.length;o++)if(h=f[o].getAttribute("style"),Object(r.isNullOrUndefined)(h)||""===h.trim())f[o].setAttribute("style",e[i]);else{for(c=e[i].split(";"),s=0;s<c.length;s++)h.indexOf(c[s].split(":")[0])>=0&&(c.splice(s,1),s--);e[i]=c.join(";")+";";y=e[i]+h;f[o].setAttribute("style",y)}}}},n.prototype.filterStyles=function(n,t){for(var r=n.querySelectorAll("*[style]"),i=0;i<r.length;i++){for(var f=r[i].getAttribute("style").split(";"),e="",u=0;u<f.length;u++)t.indexOf(f[u].split(":")[0].trim())>=0&&(e+=f[u]+";");r[i].setAttribute("style",e)}},n.prototype.removeUnwantedStyle=function(n,t){for(var u,r,i=0;i<n.length;i++)for(u=n[i].split(";"),n[i]="",r=0;r<u.length;r++)t.indexOf(u[r].split(":")[0])>=0&&(n[i]+=u[r]+";");return n},n.prototype.findStyleObject=function(n){for(var e,u,f={},r=0;r<n.length;r++){var o=n[r],t=o.replace(/([\S ]+\s+){[\s\S]+?}/gi,"$1"),i=o.replace(/[\S ]+\s+{([\s\S]+?)}/gi,"$1");for(t=t.replace(/^[\s]|[\s]$/gm,""),i=i.replace(/^[\s]|[\s]$/gm,""),t=t.replace(/\n|\r|\n\r/g,""),i=i.replace(/\n|\r|\n\r/g,""),e=t.split(", "),u=0;u<e.length;u++)f[e[u]]=i}return f},n.prototype.removingComments=function(n){var t=n.innerHTML;t=t.replace(/<!--[\s\S]*?-->/g,"");n.innerHTML=t},n.prototype.cleanUp=function(n,t){for(var u,f=[],r=n.querySelectorAll("*"),i=0;i<r.length;i++)-1===this.ignorableNodes.indexOf(r[i].nodeName)||3===r[i].nodeType&&""===r[i].textContent.trim()?f.push(r[i]):(r[i].className&&-1!==r[i].className.toLowerCase().indexOf("msolistparagraph")&&t.push(r[i]),!u||-1===this.blockNode.indexOf(r[i].nodeName.toLowerCase())||r[i].className&&-1!==r[i].className.toLowerCase().indexOf("msolistparagraph")||t.push(null),-1!==this.blockNode.indexOf(r[i].nodeName.toLowerCase())&&(u=!(!r[i].className||-1===r[i].className.toLowerCase().indexOf("msolistparagraph"))));return t.length&&null!==t[t.length-1]&&t.push(null),t},n.prototype.listConverter=function(n){for(var l,a,s,h,f,i,v,t,e=[],c=[],o="",u=0;u<n.length;u++)if(null!==n[u]){if(v=(o=n[u].getAttribute("style"))&&-1!==o.indexOf("level")?parseInt(o.charAt(o.indexOf("level")+5),null):1,this.listContents=[],this.getListContent(n[u]),l=void 0,!Object(r.isNullOrUndefined)(this.listContents[0])){for(l=this.listContents[0].trim().length>1?"ol":"ul",a=[],s=1;s<this.listContents.length;s++)a.push(this.listContents[s]);c.push({listType:l,content:a,nestedLevel:v})}}else e.push({content:this.makeConversion(c),node:n[u-1]}),c=[];for(t=n.shift();t;){for(h=[],f=0;f<e.length;f++)if(e[f].node===t){for(i=0;i<e[f].content.childNodes.length;i++)h.push(e[f].content.childNodes[i]);for(i=0;i<h.length;i++)t.parentElement.insertBefore(h[i],t);break}t.remove();(t=n.shift())||(t=n.shift())}},n.prototype.makeConversion=function(n){for(var f,h,i,u,e,o=Object(r.createElement)("div"),s=1,c=0,t=0;t<n.length;t++){if(f=Object(r.createElement)("p"),f.innerHTML=n[t].content.join(" "),1===n[t].nestedLevel&&0===c&&n[t].content)o.appendChild(i=Object(r.createElement)(n[t].listType)),(u=Object(r.createElement)("li")).appendChild(f),i.appendChild(u),i.setAttribute("level",n[t].nestedLevel.toString()),i.style.listStyle=this.getListStyle(n[t].listType,n[t].nestedLevel);else if(n[t].nestedLevel===s)u.parentElement.tagName.toLowerCase()===n[t].listType?(u.parentElement.appendChild(u=Object(r.createElement)("li")),u.appendChild(f)):(i=Object(r.createElement)(n[t].listType),u.parentElement.parentElement.appendChild(i),(u=Object(r.createElement)("li")).appendChild(f),i.appendChild(u),i.setAttribute("level",n[t].nestedLevel.toString()));else if(n[t].nestedLevel>s)if(Object(r.isNullOrUndefined)(u))o.appendChild(i=Object(r.createElement)(n[t].listType)),(u=Object(r.createElement)("li")).appendChild(f),i.appendChild(u),i.setAttribute("level",n[t].nestedLevel.toString()),i.style.listStyle=this.getListStyle(n[t].listType,n[t].nestedLevel);else{for(h=0;h<n[t].nestedLevel-s;h++)u.appendChild(i=Object(r.createElement)(n[t].listType)),u=Object(r.createElement)("li",{styles:"list-style-type: none;"}),i.appendChild(u);u.appendChild(f);i.setAttribute("level",n[t].nestedLevel.toString());i.style.listStyle=this.getListStyle(n[t].listType,n[t].nestedLevel);i.childNodes[0].style.listStyle=this.getListStyle(n[t].listType,n[t].nestedLevel)}else if(1===n[t].nestedLevel)o.lastChild.tagName.toLowerCase()===n[t].listType?i=o.lastChild:o.appendChild(i=Object(r.createElement)(n[t].listType)),(u=Object(r.createElement)("li")).appendChild(f),i.appendChild(u),i.setAttribute("level",n[t].nestedLevel.toString()),i.style.listStyle=this.getListStyle(n[t].listType,n[t].nestedLevel);else for(e=u;e.parentElement;)if((e=e.parentElement).attributes.getNamedItem("level")){if(parseInt(e.attributes.getNamedItem("level").textContent,null)===n[t].nestedLevel){(u=Object(r.createElement)("li")).appendChild(f);e.appendChild(u);break}if(n[t].nestedLevel>parseInt(e.attributes.getNamedItem("level").textContent,null)){e.appendChild(i=Object(r.createElement)(n[t].listType));(u=Object(r.createElement)("li")).appendChild(f);i.appendChild(u);i.setAttribute("level",n[t].nestedLevel.toString());i.style.listStyle=this.getListStyle(n[t].listType,n[t].nestedLevel);break}}s=n[t].nestedLevel;c++}return o},n.prototype.getListStyle=function(n,t){return t=t>0?t-1:t,"ol"===n?t<this.olData.length?this.olData[t]:this.olData[0]:t<this.ulData.length?this.ulData[t]:this.ulData[0]},n.prototype.getListContent=function(n){var t="";""!==n.firstElementChild.textContent.trim()||Object(r.isNullOrUndefined)(n.firstElementChild.firstElementChild)||"IMG"!==n.firstElementChild.firstElementChild.nodeName?(t=n.firstElementChild.textContent.trim(),this.listContents.push(t)):(t=n.innerHTML.trim(),this.listContents.push(""),this.listContents.push(t));Object(r.detach)(n.firstElementChild);this.listContents.push(n.innerHTML)},n}(),ap=function(){function n(n){this.parent=n;this.addEventListener()}return n.prototype.addEventListener=function(){this.parent.observer.on(vl,this.insertText,this)},n.prototype.insertText=function(n){var t=document.createTextNode(n.value);vt.Insert(this.parent.currentDocument,t);n.callBack&&n.callBack({requestType:n.subCommand,editorMode:"HTML",event:n.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)})},n}(),vp=function(){function n(n){this.currentDocument=n.document;this.editableElement=n.editableElement;this.nodeSelection=new k;this.domNode=new dy(this.editableElement,this.currentDocument);this.observer=new r.Observer(this);this.listObj=new gy(this);this.formatObj=new np(this);this.alignmentObj=new ip(this);this.indentsObj=new rp(this);this.linkObj=new tp(this);this.imgObj=new fp(this);this.selectionObj=new op(this);this.inserthtmlObj=new sp(this);this.insertTextObj=new ap(this);this.clearObj=new hp(this);this.tableObj=new ep(this);this.undoRedoManager=new cp(this,n.options);this.msWordPaste=new lp(this);this.wireEvents()}return n.prototype.wireEvents=function(){this.observer.on(rs,this.editorKeyDown,this);this.observer.on(fu,this.editorKeyUp,this);this.observer.on(fu,this.editorKeyUp,this);this.observer.on(us,this.onPropertyChanged,this);this.observer.on(cc,this.onWordPaste,this)},n.prototype.onWordPaste=function(n){this.observer.notify(hc,n)},n.prototype.onPropertyChanged=function(n){this.observer.notify(eu,n)},n.prototype.editorKeyDown=function(n){this.observer.notify(v,n)},n.prototype.editorKeyUp=function(n){this.observer.notify(li,n)},n.prototype.execCommand=function(n,t,i,r,u,f,e){switch(n.toLocaleLowerCase()){case"lists":this.observer.notify(sc,{subCommand:t,event:i,callBack:r,selector:e});break;case"formats":this.observer.notify(of,{subCommand:t,event:i,callBack:r,selector:e,exeValue:f});break;case"alignments":this.observer.notify(hl,{subCommand:t,event:i,callBack:r,selector:e,value:f});break;case"indents":this.observer.notify(cl,{subCommand:t,event:i,callBack:r,selector:e});break;case"links":this.observer.notify(tl,{command:n,value:t,item:f,event:i,callBack:r});break;case"images":this.observer.notify(gc,{command:n,value:t,item:f,event:i,callBack:r,selector:e});break;case"table":switch(t.toString().toLocaleLowerCase()){case"createtable":this.observer.notify(nl,{item:f,event:i,callBack:r});break;case"insertrowbefore":case"insertrowafter":this.observer.notify(il,{item:f,event:i,callBack:r});break;case"insertcolumnleft":case"insertcolumnright":this.observer.notify(rl,{item:f,event:i,callBack:r});break;case"deleterow":this.observer.notify(ul,{item:f,event:i,callBack:r});break;case"deletecolumn":this.observer.notify(fl,{item:f,event:i,callBack:r});break;case"tableremove":this.observer.notify(el,{item:f,event:i,callBack:r});break;case"tableheader":this.observer.notify(ol,{item:f,event:i,callBack:r});break;case"aligntop":case"alignmiddle":case"alignbottom":this.observer.notify(sl,{item:f,event:i,callBack:r})}break;case"font":case"style":case"effects":case"casing":this.observer.notify(ll,{subCommand:t,event:i,callBack:r,value:u,selector:e});break;case"inserthtml":this.observer.notify(al,{subCommand:t,callBack:r,value:u});break;case"inserttext":this.observer.notify(vl,{subCommand:t,callBack:r,value:u});break;case"clear":this.observer.notify(yl,{subCommand:t,event:i,callBack:r,selector:e});break;case"actions":this.observer.notify(ki,{subCommand:t,event:i,callBack:r,selector:e})}},n}(),hk=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),yp=function(n){function t(t){var i=n.call(this)||this;return i.initialize(),Object(r.extend)(i,i,t,!0),i.currentDocument&&i.element&&i.updateFormatter(i.element,i.currentDocument,t.options),i}return hk(t,n),t.prototype.initialize=function(){this.keyConfig=cy},t.prototype.updateFormatter=function(n,t,i){n&&t&&(this.editorManager=new vp({document:t,editableElement:n,options:i}))},t}(lc),ss={bold:!1,italic:!1,subscript:!1,superscript:!1,strikethrough:!1,orderedlist:!1,unorderedlist:!1,underline:!1,alignments:null,backgroundcolor:null,fontcolor:null,fontname:null,fontsize:null,formats:null,createlink:!1,insertcode:!1},pp=function(){function n(){}return n.get=function(n,t,i,r,u,f){for(var e=JSON.parse(JSON.stringify(ss)),s=JSON.parse(JSON.stringify(ss)),c=new k,h=f?[f]:c.getNodeCollection(c.getRange(n)),l=h.length,o=0;o<h.length;o++)("BR"!==h[o].nodeName&&3!==h[o].nodeType||l>1&&3===h[o].nodeType&&""===h[o].textContent.trim())&&(h.splice(o,1),o--);for(o=0;o<h.length;o++)e=this.getFormatParent(n,e,h[o],t,i,r,u),(0===o&&e.bold||!e.bold)&&(s.bold=e.bold),(0===o&&e.insertcode||!e.insertcode)&&(s.insertcode=e.insertcode),(0===o&&e.italic||!e.italic)&&(s.italic=e.italic),(0===o&&e.underline||!e.underline)&&(s.underline=e.underline),(0===o&&e.strikethrough||!e.strikethrough)&&(s.strikethrough=e.strikethrough),(0===o&&e.superscript||!e.superscript)&&(s.superscript=e.superscript),(0===o&&e.subscript||!e.subscript)&&(s.subscript=e.subscript),(0===o&&e.fontcolor||!e.fontcolor)&&(s.fontcolor=e.fontcolor),(0===o&&e.fontname||!e.fontname)&&(s.fontname=e.fontname),(0===o&&e.fontsize||!e.fontsize)&&(s.fontsize=e.fontsize),(0===o&&e.backgroundcolor||!e.backgroundcolor)&&(s.backgroundcolor=e.backgroundcolor),(0===o&&e.orderedlist||!e.orderedlist)&&(s.orderedlist=e.orderedlist),(0===o&&e.unorderedlist||!e.unorderedlist)&&(s.unorderedlist=e.unorderedlist),(0===o&&e.alignments||!e.alignments)&&(s.alignments=e.alignments),(0===o&&e.formats||!e.formats)&&(s.formats=e.formats),(0===o&&e.createlink||!e.createlink)&&(s.createlink=e.createlink),e=JSON.parse(JSON.stringify(ss));return s},n.getFormatParent=function(n,t,i,r,u,f,e){if(r.contains(i)||3===i.nodeType&&3!==r.nodeType&&r.contains(i.parentNode))do t=this.isFormattedNode(n,t,i,u,f,e),i=i.parentNode;while(i&&i!==r);return t},n.isFormattedNode=function(n,t,i,r,u,f){return t.bold||(t.bold=yt.isBold(i)),t.italic||(t.italic=yt.isItalic(i)),t.underline||(t.underline=yt.isUnderline(i)),t.strikethrough||(t.strikethrough=yt.isStrikethrough(i)),t.superscript||(t.superscript=yt.isSuperscript(i)),t.subscript||(t.subscript=yt.isSubscript(i)),t.fontcolor||(t.fontcolor=this.isFontColor(n,i)),t.fontname||(t.fontname=this.isFontName(n,i,f)),t.fontsize||(t.fontsize=this.isFontSize(i,u)),t.backgroundcolor||(t.backgroundcolor=this.isBackgroundColor(i)),t.orderedlist||(t.orderedlist=this.isOrderedList(i)),t.unorderedlist||(t.unorderedlist=this.isUnorderedList(i)),t.alignments||(t.alignments=this.isAlignment(i)),t.formats||(t.formats=this.isFormats(i,r),"pre"===t.formats&&(t.insertcode=!0)),t.createlink||(t.createlink=this.isLink(i)),t},n.isFontColor=function(n,t){var i=t.style&&t.style.color;return null!=i&&""!==i||3===t.nodeType||(i=this.getComputedStyle(n,t,"color")),null!==i&&""!==i&&void 0!==i?i:null},n.isLink=function(n){return"a"===n.nodeName.toLocaleLowerCase()},n.isBackgroundColor=function(n){var t=n.style&&n.style.backgroundColor;return null!==t&&""!==t&&void 0!==t?t:null},n.isFontSize=function(n,t){var i=n.style&&n.style.fontSize;return null!==i&&""!==i&&void 0!==i&&(null==t||t.indexOf(i)>-1)?i:null},n.isFontName=function(n,t,i){var r=t.style&&t.style.fontFamily,u;return null!=r&&""!==r||3===t.nodeType||(r=this.getComputedStyle(n,t,"font-family")),u=null,null!==r&&""!==r&&void 0!==r&&(null==i||i.filter(function(n,t){var i=new RegExp(r,"i");(n.replace(/"/g,"").replace(/ /g,"")===r.replace(/"/g,"").replace(/ /g,"")||n.search(i)>-1)&&(u=t)})&&null!==u)?null!==u?i[u]:r.replace(/"/g,""):null},n.isOrderedList=function(n){return"ol"===n.nodeName.toLocaleLowerCase()},n.isUnorderedList=function(n){return"ul"===n.nodeName.toLocaleLowerCase()},n.isAlignment=function(n){var t=n.style&&n.style.textAlign;return"left"===t?"justifyleft":"center"===t?"justifycenter":"right"===t?"justifyright":"justify"===t?"justifyfull":null},n.isFormats=function(n,t){return null==t&&di.indexOf(n.nodeName.toLocaleLowerCase())>-1||null!=t&&t.indexOf(n.nodeName.toLocaleLowerCase())>-1?n.nodeName.toLocaleLowerCase():null},n.getComputedStyle=function(n,t,i){return n.defaultView.getComputedStyle(t,null).getPropertyValue(i)},n}(),wp=function(){function n(n){this.parent=n;this.addEventListener()}return n.prototype.addEventListener=function(){this.parent.on(bt,this.onRefreshHandler,this);this.parent.on(h,this.removeEventListener,this)},n.prototype.removeEventListener=function(){this.parent.off(bt,this.onRefreshHandler)},n.prototype.onRefreshHandler=function(n){if(!this.parent.readonly){var t=[],i=[],r=[];this.parent.fontSize.items.forEach(function(n){t.push(n.value)});this.parent.fontFamily.items.forEach(function(n){i.push(n.value)});this.parent.format.types.forEach(function(n){r.push(n.value.toLocaleLowerCase())});this.toolbarStatus=pp.get(this.parent.contentModule.getDocument(),this.parent.contentModule.getEditPanel(),r,t,i,n.documentNode);this.parent.notify(ot,this.toolbarStatus)}},n}(),bl=function(){function n(n,t){this.parent=n;this.serviceLocator=t}return n.prototype.renderPanel=function(){var n=this.parent,t=this.parent.createElement("div",{className:"e-rte-content",id:this.parent.getID()+"rte-view"}),i=go(n.value,n);this.editableElement=this.parent.createElement("div",{className:"e-content",id:this.parent.getID()+"_rte-edit-view",attrs:{contenteditable:"true"},innerHTML:i});t.appendChild(this.editableElement);this.setPanel(t);n.element.appendChild(t)},n.prototype.getPanel=function(){return this.contentPanel},n.prototype.getEditPanel=function(){return this.editableElement},n.prototype.getText=function(){return this.getEditPanel().textContent},n.prototype.setPanel=function(n){this.contentPanel=n},n.prototype.getDocument=function(){return this.getEditPanel().ownerDocument},n}(),ck=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),bp=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return ck(t,n),t.prototype.renderPanel=function(){var i=this.parent,t="\n<!DOCTYPE html> \n    <html>\n         <head>\n            <meta charset='utf-8' /> \n            <style>\n                @charset \"UTF-8\";\n                body {\n                    font-family: \"Roboto\", sans-serif;\n                    font-size: 14px;\n                }\n                html, body{height: 100%;margin: 0;}\n                body.e-cursor{cursor:default}\n                span.e-selected-node\t{background-color: #939393;color: white;}\n                span.e-selected-node.e-highlight {background-color: #1d9dd8;}\n                body{color:#333;word-wrap:break-word;padding: 8px;box-sizing: border-box;}\n                .e-rte-image {border: 0;cursor: pointer;display: block;float: none;height: auto;margin: 5px auto;max-width: 100%;position: relative;}\n                .e-img-caption { display: inline-block; float: none; margin: 5px auto; max-width: 100%;position: relative;}\n                .e-img-caption.e-caption-inline {display: inline-block;float: none;margin: 5px auto;margin-left: 5px;margin-right: 5px;max-width: calc(100% - (2 * 5px));position: relativetext-align: center;vertical-align: bottom;}\n                .e-img-inner {box-sizing: border-box;display: block;font-size: 16px;font-weight: initial;margin: auto;opacity: .9;text-align: center;width: 100%;}\n                .e-img-wrap {display: inline-block;margin: auto;padding: 0;text-align: center;width: 100%;}\n                .e-imgleft {float: left;margin: 0 5px 0 0;text-align: left;}\n                .e-imgright {float: right;margin: 0 0 0 5px;text-align: right;}\n                .e-imgcenter {cursor: pointer;display: block;float: none;height: auto;margin: 5px auto;max-width: 100%;position: relative;}\n                .e-control img:not(.e-resize) {border: 2px solid transparent; z-index: 1000}\n                .e-imginline {display: inline-block;float: none;margin-left: 5px;margin-right: 5px;max-width: calc(100% - (2 * 5px));vertical-align: bottom;}\n                .e-imgbreak {border: 0;cursor: pointer;display: block;float: none;height: auto;margin: 5px auto;max-width: 100%;position: relative;}\n                .e-rte-image.e-img-focus:not(.e-resize) {border: solid 2px #4a90e2;}\n                img::selection { background: transparent;color: transparent;}\n                span.e-rte-imageboxmark {  width: 10px; height: 10px; position: absolute; display: block; background: #4a90e2; border: 1px solid #fff; z-index: 1000;}\n                .e-mob-rte.e-mob-span span.e-rte-imageboxmark { background: #4a90e2; border: 1px solid #fff; }\n                .e-mob-rte span.e-rte-imageboxmark { background: #fff; border: 1px solid #4a90e2; border-radius: 15px; height: 20px; width: 20px; }\n                .e-mob-rte.e-mob-span span.e-rte-imageboxmark { background: #4a90e2; border: 1px solid #fff; }\n                .e-rte-content .e-content img.e-resize { z-index: 1000; }\n                .e-img-caption .e-img-inner { outline: 0; }\n                .e-img-caption .e-rte-image.e-imgright, .e-img-caption .e-rte-image.e-imgleft { float: none; margin: 0;}\n                body{box-sizing: border-box;min-height: 100px;outline: 0 solid transparent;overflow-x: auto;padding: 16px;position: relative;text-align: inherit;z-index: 2;}\n                p{margin: 0 0 10px;margin-bottom: 10px;}\n                li{margin-bottom: 10px;}\n                h1{font-size: 2.17em;font-weight: 400;line-height: 1;margin: 10px 0;}\n                h2{font-size: 1.74em;font-weight: 400;margin: 10px 0;}\n                h3{font-size: 1.31em;font-weight: 400;margin: 10px 0;}\n                h4{font-size: 1em;font-weight: 400;margin: 0;}\n                h5{font-size: 00.8em;font-weight: 400;margin: 0;}\n                h6{font-size: 00.65em;font-weight: 400;margin: 0;}\n                blockquote{margin: 10px 0;margin-left: 0;padding-left: 5px;border-left: solid 2px #5c5c5c;}\n                pre{background-color: inherit;border: 0;border-radius: 0;color: #333;font-size: inherit;line-height: inherit;margin: 0 0 10px;overflow: visible;padding: 0;white-space: pre-wrap;word-break: inherit;word-wrap: break-word;}\n                strong, b{font-weight: 700;}\n                a{text-decoration: none;user-select: auto;}\n                a:hover{text-decoration: underline;};\n                p:last-child, pre:last-child, blockquote:last-child{margin-bottom: 0;}\n                h3+h4, h4+h5, h5+h6{margin-top: 00.6em;}\n                ul:last-child{margin-bottom: 0;}\n                table { border-collapse: collapse; empty-cells: show;}\n                table td,table th {border: 1px solid #BDBDBD; height: 20px; vertical-align: middle;}\n                table.e-alternate-border tbody tr:nth-child(2n) {background-color: #F5F5F5;}\n                table th {background-color: #E0E0E0;}\n                table.e-dashed-border td,table.e-dashed-border th { border: 1px dashed #BDBDBD} \n                table .e-cell-select {border: 1px double #4a90e2;}\n                span.e-table-box { cursor: nwse-resize; display: block; height: 10px; position: absolute; width: 10px; }\n                span.e-table-box.e-rmob {height: 14px;width: 14px;}\n                .e-row-resize, .e-column-resize { background-color: transparent; background-repeat: repeat; bottom: 0;cursor: col-resize;height: 1px;overflow: visible;position: absolute;width: 1px; }\n                .e-row-resize { cursor: row-resize; height: 1px;}\n                .e-table-rhelper { cursor: col-resize; opacity: .87;position: absolute;}\n                .e-table-rhelper.e-column-helper { width: 1px; }\n                .e-table-rhelper.e-row-helper {height: 1px;}\n                .e-reicon::before { border-bottom: 6px solid transparent; border-right: 6px solid; border-top: 6px solid transparent; content: ''; display: block; height: 0; position: absolute; right: 4px; top: 4px; width: 20px; }\n                .e-reicon::after { border-bottom: 6px solid transparent; border-left: 6px solid; border-top: 6px solid transparent; content: ''; display: block; height: 0; left: 4px; position: absolute; top: 4px; width: 20px; z-index: 3; }\n                .e-row-helper.e-reicon::after { top: 10px; transform: rotate(90deg); }\n                .e-row-helper.e-reicon::before { left: 4px; top: -20px; transform: rotate(90deg); }\n                span.e-table-box { background-color: #ffffff; border: 1px solid #BDBDBD; }\n                span.e-table-box.e-rbox-select { background-color: #BDBDBD; border: 1px solid #BDBDBD; }\n                .e-table-rhelper { background-color: #4a90e2;}\n            <\/style>\n        <\/head>"+('<body spellcheck="false" autocorrect="off" contenteditable="true">'+go(i.value,i)+"<\/body><\/html>"),n=this.parent.createElement("iframe",{innerHTML:t,id:this.parent.getID()+"_rte-view",className:"e-rte-content",styles:"display:block;"});this.setPanel(n);i.element.appendChild(n);n.contentDocument.body.id=this.parent.getID()+"_rte-edit-view";n.contentDocument.body.setAttribute("aria-owns",this.parent.getID());n.contentDocument.open();t=this.setThemeColor(t,{color:"#333"});n.contentDocument.write(t);n.contentDocument.close()},t.prototype.setThemeColor=function(n,t){var i=getComputedStyle(this.parent.element,".e-richtexteditor").getPropertyValue("color");return n.replace(t.color,i)},t.prototype.getEditPanel=function(){return Object(r.isNullOrUndefined)(this.contentPanel.contentDocument)?this.parent.inputElement:this.contentPanel.contentDocument.body},t.prototype.getDocument=function(){return this.getEditPanel().ownerDocument},t}(bl),kp=function(){function n(n){this.parent=n;this.addEventListener()}return n.prototype.addEventListener=function(){this.parent.on(pu,this.enableXhtmlValidation,this)},n.prototype.enableXhtmlValidation=function(){this.parent.enableXhtml&&(this.clean(this.parent.inputElement),this.AddRootElement(),this.ImageTags(),this.removeTags(),this.RemoveUnsupported(),this.parent.setProperties({value:this.parent.inputElement.innerHTML},!0))},n.prototype.AddRootElement=function(){if(1===this.parent.inputElement.childNodes.length&&"DIV"!==this.parent.inputElement.firstChild.nodeName||this.parent.inputElement.childNodes.length>1){for(var n=this.parent.createElement("div");this.parent.inputElement.childNodes.length>0;)n.appendChild(this.parent.inputElement.childNodes[0]);this.parent.inputElement.appendChild(n)}},n.prototype.clean=function(n){for(var t,i=0;i<n.childNodes.length;i++)t=n.childNodes[i],8===t.nodeType||"V:IMAGE"===t.nodeName?(n.removeChild(t),i--):1===t.nodeType&&this.clean(t);return this.parent.inputElement.innerHTML},n.prototype.ImageTags=function(){for(var t=this.parent.inputElement.querySelectorAll("IMG"),n=t.length-1;n>=0;n--)t[n].hasAttribute("alt")||t[n].setAttribute("alt","")},n.prototype.removeTags=function(){for(var t=[["br","ul"],["br","ol"],["table","span"],["div","span"],["p","span"]],n=0;n<t.length;n++)this.RemoveElementNode(t[n][0],t[n][1])},n.prototype.RemoveElementNode=function(n,t){for(var e,u,f=this.parent.inputElement.querySelectorAll(t),i=0;i<f.length;i++)for(e=f[i].querySelectorAll(n),u=e.length;u>0;u--)Object(r.detach)(e[u-1])},n.prototype.RemoveUnsupported=function(){for(var u,i,f,e,t=this.parent.inputElement.querySelectorAll("u"),n=t.length-1;n>=0;n--)u=this.parent.createElement("span"),u.style.textDecoration="underline",u.innerHTML=t[n].innerHTML,t[n].parentNode.insertBefore(u,t[n]),Object(r.detach)(t[n]);for(i=this.parent.inputElement.querySelectorAll("strong"),n=i.length-1;n>=0;n--)f=this.parent.createElement("b"),f.innerHTML=i[n].innerHTML,i[n].parentNode.insertBefore(f,i[n]),Object(r.detach)(i[n]);for(e=["language","role","target","contenteditable","cellspacing","cellpadding","border","valign","colspan"],n=0;n<=e.length;n++)this.RemoveAttributeByName(e[n])},n.prototype.RemoveAttributeByName=function(n){var u,i,f,t,r;if(null!==this.parent.inputElement.firstChild&&3!==this.parent.inputElement.firstChild.nodeType)for(u=0;u<this.parent.inputElement.childNodes.length;u++)if(i=this.parent.inputElement.childNodes[u],3!==i.nodeType&&"TABLE"!==i.nodeName&&"TBODY"!==i.nodeName&&"THEAD"!==i.nodeName&&"TH"!==i.nodeName&&"TR"!==i.nodeName&&"TD"!==i.nodeName&&(i.hasAttribute(n)&&i.removeAttribute(n),i.hasChildNodes()))for(f=0;f<i.childNodes.length;f++)if(t=i.childNodes[f],3!==t.nodeType&&"TABLE"!==t.nodeName&&"TBODY"!==t.nodeName&&"THEAD"!==t.nodeName&&"TH"!==t.nodeName&&"TR"!==t.nodeName&&"TD"!==t.nodeName&&t.hasAttribute(n)&&t.removeAttribute(n),t.hasChildNodes())for(r=0;r<t.childNodes.length;r++)3!==t.childNodes[r].nodeType&&"TABLE"!==t.childNodes[r].nodeName&&"TBODY"!==t.childNodes[r].nodeName&&"THEAD"!==t.childNodes[r].nodeName&&"TH"!==t.childNodes[r].nodeName&&"TR"!==t.childNodes[r].nodeName&&"TD"!==t.childNodes[r].nodeName&&t.childNodes[r].hasAttribute(n)&&t.childNodes[r].removeAttribute(n)},n}(),lk=function(){function n(n,t){this.rangeCollection=[];this.parent=n;this.locator=t;this.renderFactory=this.locator.getService("rendererFactory");this.xhtmlValidation=new kp(n);this.addEventListener()}return n.prototype.destroy=function(){this.removeEventListener()},n.prototype.sanitizeHelper=function(n){return tc(n,this.parent)},n.prototype.addEventListener=function(){this.parent.isDestroyed||(this.nodeSelectionObj=new k,this.colorPickerModule=new oc(this.parent,this.locator),this.parent.on(tr,this.instantiateRenderer,this),this.parent.on(lf,this.onToolbarClick,this),this.parent.on(w,this.onKeyDown,this),this.parent.on(cu,this.renderColorPicker,this),this.parent.on(p,this.render,this),this.parent.on(y,this.onPropertyChanged,this),this.parent.on(h,this.destroy,this),this.parent.on(lr,this.selectAll,this),this.parent.on(yu,this.selectRange,this),this.parent.on(ar,this.getSelectedHtml,this),this.parent.on(ht,this.onSelectionSave,this),this.parent.on(rt,this.onSelectionRestore,this),this.parent.on(vr,this.updateReadOnly,this),this.parent.on(pi,this.onPaste,this))},n.prototype.updateReadOnly=function(){this.parent.readonly?(Object(r.attributes)(this.parent.contentModule.getEditPanel(),{contenteditable:"false"}),Object(r.addClass)([this.parent.element],nu)):(Object(r.attributes)(this.parent.contentModule.getEditPanel(),{contenteditable:"true"}),Object(r.removeClass)([this.parent.element],nu))},n.prototype.onSelectionSave=function(){var n=this.contentRenderer.getDocument(),t=this.nodeSelectionObj.getRange(n);this.saveSelection=this.nodeSelectionObj.save(t,n)},n.prototype.onSelectionRestore=function(n){this.parent.isBlur=!1;this.contentRenderer.getEditPanel().focus();(Object(r.isNullOrUndefined)(n.items)||n.items)&&this.saveSelection.restore()},n.prototype.onKeyDown=function(n){var u,t,i;9===n.args.keyCode&&this.parent.enableTabKey&&(u=this.nodeSelectionObj.getRange(this.contentRenderer.getDocument()),t=this.nodeSelectionObj.getParentNodeCollection(u),("LI"===t[0].nodeName||Object(r.closest)(t[0],"li")||Object(r.closest)(t[0],"table"))&&0===u.startOffset||((n.args.preventDefault(),n.args.shiftKey)?this.rangeCollection.length>0&&4===this.rangeCollection[this.rangeCollection.length-1].startContainer.textContent.length&&(i=this.rangeCollection[this.rangeCollection.length-1].startContainer,this.nodeSelectionObj.setSelectionText(this.contentRenderer.getDocument(),i,i,0,i.textContent.length),vt.Insert(this.contentRenderer.getDocument(),document.createTextNode("")),this.rangeCollection.pop()):(vt.Insert(this.contentRenderer.getDocument(),"&nbsp;&nbsp;&nbsp;&nbsp;"),this.rangeCollection.push(this.nodeSelectionObj.getRange(this.contentRenderer.getDocument())))));"space"!==n.args.action&&"enter"!==n.args.action||this.spaceLink(n.args)},n.prototype.onPaste=function(n){var v=new RegExp(/([^\S]|^)(((https?\:\/\/)|(www\.))(\S+))/gi),f,e,u,l;if(n.text.match(v)){n.args.preventDefault();for(var y=this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument()),p=(this.parent.formatter.editorManager.nodeSelection.save(y,this.parent.contentModule.getDocument()),new RegExp(/([^\S]|^)(((https?\:\/\/)))/gi)),w=new RegExp(/([^\S]|^)(((www\.))(\S+))/gi),o=n.text.split("\n"),s="",i=0;i<o.length;i++)if(""===o[i].trim())s+="<p><br><\/p>";else{for(var h="",a=!0,c=o[i].split(" "),t=0;t<c.length;t++)""===c[t].trim()?h+=a?"&nbsp;":" ":(a=!1,h+=c[t]+" ");s+="<p>"+h.trim()+"<\/p>"}for(f=this.parent.createElement("div"),f.innerHTML=s,e=f.querySelectorAll("p"),i=0;i<e.length;i++){for(u=e[i].innerHTML.split(" "),l="",t=0;t<u.length;t++)l+=u[t].match(p)||u[t].match(w)?'<a className="e-rte-anchor" href="'+u[t]+'" title="'+u[t]+'">'+u[t]+" <\/a>":u[t]+" ";e[i].innerHTML=l.trim()}Object(r.isNullOrUndefined)(this.parent.pasteCleanupModule)?this.parent.executeCommand("insertHTML",f):n.callBack(f.innerHTML)}},n.prototype.spaceLink=function(n){var i=this.nodeSelectionObj.getRange(this.contentRenderer.getDocument()),s=this.nodeSelectionObj.getParentNodeCollection(i),u=i.startContainer.textContent.substr(0,i.endOffset),r=u.split(" "),t=r[r.length-1],h=i.startOffset-(u.length-r[r.length-1].length),f,e,o;t=t.slice(0,h);f=new RegExp(/([^\S]|^)(((https?\:\/\/)|(www\.))(\S+))/gi);"A"!==s[0].nodeName&&t.match(f)&&(e=this.nodeSelectionObj.save(i,this.parent.contentModule.getDocument()),o={url:t.indexOf("http")>-1?t:"http://"+t,selection:e,selectParent:this.parent.formatter.editorManager.nodeSelection.getParentNodeCollection(i),text:t,title:"",target:"_blank"},this.parent.formatter.process(this.parent,{item:{command:"Links",subCommand:"CreateLink"}},n,o))},n.prototype.onToolbarClick=function(n){var i,f,e,t=n.item,o=Object(r.closest)(n.originalEvent.target,".e-rte-quick-popup"),u,s,h;if(o&&!o.classList.contains("e-rte-inline-popup"))"SourceCode"!==t.subCommand&&"Preview"!==t.subCommand&&"FontColor"!==t.subCommand&&"BackgroundColor"!==t.subCommand&&(d()&&"Images"===t.command&&this.nodeSelectionObj.restore(),u=this.nodeSelectionObj.getRange(this.parent.contentModule.getDocument()),i=this.nodeSelectionObj.save(u,this.parent.contentModule.getDocument()),f=this.nodeSelectionObj.getNodeCollection(u),e=this.nodeSelectionObj.getParentNodeCollection(u)),"Images"===t.command&&this.parent.notify(bf,{member:"image",args:n,selectNode:f,selection:i,selectParent:e}),"Links"===t.command&&this.parent.notify(kf,{member:"link",args:n,selectNode:f,selection:i,selectParent:e}),"Table"===t.command&&this.parent.notify(ye,{member:"table",args:n,selectNode:f,selection:i,selectParent:e});else{s=this.parent.element.querySelector("#"+this.parent.getID()+"_rtelink");h=this.parent.element.querySelector("#"+this.parent.getID()+"_image");"SourceCode"!==t.subCommand&&"Preview"!==t.subCommand&&"FontColor"!==t.subCommand&&"BackgroundColor"!==t.subCommand&&(u=this.nodeSelectionObj.getRange(this.parent.contentModule.getDocument()),Object(r.isNullOrUndefined)(s)&&Object(r.isNullOrUndefined)(h)&&(i=this.nodeSelectionObj.save(u,this.parent.contentModule.getDocument())),f=this.nodeSelectionObj.getNodeCollection(u),e=this.nodeSelectionObj.getParentNodeCollection(u));switch(t.subCommand){case"Maximize":this.parent.notify(lu,{args:n});break;case"Minimize":this.parent.notify(au,{args:n});break;case"CreateLink":this.parent.notify(vu,{member:"link",args:n,selectNode:f,selection:i,selectParent:e});break;case"Print":this.parent.print();break;case"Image":this.parent.notify(rr,{member:"image",args:n,selectNode:f,selection:i,selectParent:e});break;case"CreateTable":this.parent.notify(ae,{member:"table",args:n,selection:i});break;case"SourceCode":this.parent.notify(yi,{member:"viewSource",args:n});break;case"Preview":this.parent.notify(fr,{member:"updateSource",args:n});break;case"FontColor":case"BackgroundColor":break;default:this.parent.formatter.process(this.parent,n,n.originalEvent,null)}}},n.prototype.renderColorPicker=function(n){this.colorPickerModule.renderColorPickerInput(n)},n.prototype.instantiateRenderer=function(){this.parent.iframeSettings.enable?this.renderFactory.addRenderer(o.Content,new bp(this.parent,this.locator)):this.renderFactory.addRenderer(o.Content,new bl(this.parent,this.locator))},n.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(p,this.render),this.parent.off(y,this.onPropertyChanged),this.parent.off(lf,this.onToolbarClick),this.parent.off(cu,this.renderColorPicker),this.parent.off(h,this.destroy),this.parent.off(w,this.onKeyDown),this.parent.off(tr,this.instantiateRenderer),this.parent.off(lr,this.selectAll),this.parent.off(yu,this.selectRange),this.parent.off(ar,this.getSelectedHtml),this.parent.off(ht,this.onSelectionSave),this.parent.off(rt,this.onSelectionRestore),this.parent.off(vr,this.updateReadOnly),this.parent.off(pi,this.onPaste))},n.prototype.render=function(){var n,t,i;this.contentRenderer=this.renderFactory.getRenderer(o.Content);n=this.contentRenderer.getEditPanel();t={undoRedoSteps:this.parent.undoRedoSteps,undoRedoTimer:this.parent.undoRedoTimer};Object(r.isNullOrUndefined)(this.parent.formatter)?(i=new yp({currentDocument:this.contentRenderer.getDocument(),element:n,options:t}),this.parent.setProperties({formatter:i},!0)):this.parent.formatter.updateFormatter(n,this.contentRenderer.getDocument(),t);this.parent.enableXhtml&&this.parent.notify(pu,{});this.parent.toolbarSettings.enable&&(this.toolbarUpdate=new wp(this.parent));this.parent.notify(hu,{})},n.prototype.onPropertyChanged=function(n){if(!Object(r.isNullOrUndefined)(n.newProp.formatter)){var t=this.contentRenderer.getEditPanel(),i={undoRedoSteps:this.parent.undoRedoSteps,undoRedoTimer:this.parent.undoRedoTimer};this.parent.formatter.updateFormatter(t,this.contentRenderer.getDocument(),i)}},n.prototype.getModuleName=function(){return"htmlEditor"},n.prototype.selectAll=function(){var n=gh(this.parent.contentModule.getDocument(),this.parent.contentModule.getEditPanel());n.length>0&&this.parent.formatter.editorManager.nodeSelection.setSelectionText(this.parent.contentModule.getDocument(),n[0],n[n.length-1],0,n[n.length-1].textContent.length)},n.prototype.selectRange=function(n){this.parent.formatter.editorManager.nodeSelection.setRange(this.parent.contentModule.getDocument(),n.range)},n.prototype.getSelectedHtml=function(n){n.callBack(this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument()).toString())},n}(),nr=i(3),ak=function(){function n(n,t){this.inlineNode=["a","abbr","acronym","audio","b","bdi","bdo","big","br","button","canvas","cite","code","data","datalist","del","dfn","em","embed","font","i","iframe","img","input","ins","kbd","label","map","mark","meter","noscript","object","output","picture","progress","q","ruby","s","samp","script","select","slot","small","span","strong","sub","sup","svg","template","textarea","time","u","tt","var","video","wbr"];this.blockNode=["div","h1","h2","h3","h4","h5","h6","address","blockquote","button","center","dd","dir","dl","dt","fieldset","frameset","hr","iframe","isindex","li","map","menu","noframes","noscript","object","ol","pre","td","tr","th","tbody","tfoot","thead","table","ul","header","article","nav","footer","section","aside","main","figure","figcaption"];this.isNotFromHtml=!1;this.containsHtml=!1;this.parent=n;this.locator=t;this.renderFactory=this.locator.getService("rendererFactory");this.i10n=t.getService("rteLocale");this.dialogRenderObj=t.getService("dialogRenderObject");this.addEventListener()}return n.prototype.addEventListener=function(){this.nodeSelectionObj=new k;this.parent.isDestroyed||(this.parent.on(we,this.pasteClean,this),this.parent.on(h,this.destroy,this))},n.prototype.destroy=function(){this.removeEventListener()},n.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(we,this.pasteClean),this.parent.off(h,this.destroy))},n.prototype.pasteClean=function(n){var f,e=this,i={requestType:"Paste",editorMode:this.parent.editorMode,event:n},t=null,s,l,h,c,a,u;(n.args&&!Object(r.isNullOrUndefined)(n.args.clipboardData)&&(t=n.args.clipboardData.getData("text/html")),n.args&&null!==t&&"HTML"===this.parent.editorMode)&&(0===t.length?(s=new RegExp(/<\/[a-z][\s\S]*>/i),t=n.args.clipboardData.getData("text/plain"),this.isNotFromHtml=""!==t,t=(t=t.replace(/</g,"&lt;")).replace(/>/g,"&gt;"),this.containsHtml=s.test(t),l=n&&n.args.clipboardData&&n.args.clipboardData.items.length>0?n.args.clipboardData.items[0].getAsFile():null,(this.parent.notify(pi,{file:l,args:n.args,text:t,callBack:function(r){"object"==typeof(f=r)?e.parent.formatter.editorManager.execCommand("Images","Image",n.args,e.imageFormatting.bind(e,i),"pasteCleanup",f,"pasteCleanupModule"):t=f}}),s.test(t))||(h=this.parent.createElement("div"),h.innerHTML=this.splitBreakLine(t),t=h.innerHTML)):t.length>0&&this.parent.formatter.editorManager.observer.notify(cc,{args:n.args,text:n.text,allowedStylePropertiesArray:this.parent.pasteCleanupSettings.allowedStyleProps,callBack:function(n){t=n}}),this.contentRenderer=this.renderFactory.getRenderer(o.Content),c=this.contentRenderer.getDocument(),a=this.nodeSelectionObj.getRange(c),(this.saveSelection=this.nodeSelectionObj.save(a,c),this.parent.pasteCleanupSettings.prompt)?(n.args.preventDefault(),u=this.parent.createElement("div"),u.innerHTML=t,""===u.textContent&&Object(r.isNullOrUndefined)(u.querySelector("img"))&&Object(r.isNullOrUndefined)(u.querySelector("table"))||this.pasteDialog(t,i)):this.parent.pasteCleanupSettings.plainText?(n.args.preventDefault(),this.plainFormatting(t,i)):this.parent.pasteCleanupSettings.keepFormat?(n.args.preventDefault(),this.formatting(t,!1,i)):(n.args.preventDefault(),this.formatting(t,!0,i)))},n.prototype.splitBreakLine=function(n){for(var i=n.split("\n"),r="",t=0;t<i.length;t++)r+=""===i[t].trim()?"<p><br><\/p>":"<p>"+this.makeSpace(i[t]).trim()+"<\/p>";return r},n.prototype.makeSpace=function(n){for(var i="",u=!0,r=n.split(" "),t=0;t<r.length;t++)""===r[t].trim()?i+=u?"&nbsp;":" ":(u=!1,i+=r[t]+" ");return i},n.prototype.imgUploading=function(n){var i=n.querySelectorAll(".pasteContent_Img"),u,f;if(this.parent.insertImageSettings.saveUrl&&i.length>0){for(var e=[],o=[],s=[],t=0;t<i.length;t++)i[t].getAttribute("src").split(",")[0].indexOf("base64")>=0&&(e.push(i[t].getAttribute("src")),o.push(Object(r.getUniqueID)("rte_image")),s.push(i[t]));for(u=[],t=0;t<e.length;t++)u.push(this.base64ToFile(e[t],o[t]));for(t=0;t<u.length;t++)this.uploadMethod(u[t],s[t]);Object(r.isNullOrUndefined)(this.parent.insertImageSettings.path)&&"Blob"===this.parent.insertImageSettings.saveFormat&&this.getBlob(i)}else"Blob"===this.parent.insertImageSettings.saveFormat&&this.getBlob(i);for(f=n.querySelectorAll(".pasteContent_Img"),t=0;t<f.length;t++)f[t].classList.remove("pasteContent_Img"),""===f[t].getAttribute("class").trim()&&i[t].removeAttribute("class")},n.prototype.getBlob=function(n){for(var i,t=0;t<n.length;t++)!Object(r.isNullOrUndefined)(n[t].getAttribute("src"))&&n[t].getAttribute("src").split(",")[0].indexOf("base64")>=0&&(i=URL.createObjectURL(ef(n[t].getAttribute("src"))),n[t].setAttribute("src",i))},n.prototype.uploadMethod=function(n,t){var f=this,s=document.createElement("div"),o,h,u,e;document.body.appendChild(s);s.setAttribute("display","none");t.style.opacity="0.5";o=this.parent.createElement("div");this.parent.element.appendChild(o);var c=this.parent.createElement("input",{id:this.parent.element.id+"_upload",attrs:{type:"File",name:"UploadFiles"}}),l=this.parent.iframeSettings.enable?-50:-90,i=new ft.Popup(o,{relateTo:t,height:"85px",width:"300px",offsetY:l,content:c,viewPortElement:this.parent.element,position:{X:"center",Y:"top"},enableRtl:this.parent.enableRtl,zIndex:10001,close:function(){f.parent.isBlur=!1;i.destroy();Object(r.detach)(i.element)}});i.element.style.display="none";Object(r.addClass)([i.element],[ho,yh]);h=n.size>1e6?300:100;setTimeout(function(){f.refreshPopup(t,i)},h);u=new et.Uploader({asyncSettings:{saveUrl:this.parent.insertImageSettings.saveUrl},cssClass:ph,dropArea:this.parent.inputElement,allowedExtensions:this.parent.insertImageSettings.allowedTypes.toString(),success:function(n){setTimeout(function(){f.popupClose(i,u,t,n)},900)},failure:function(n){i&&i.close();f.parent.trigger(ke,n)}});u.appendTo(i.element.childNodes[0]);e=[{name:n.name,rawFile:n,size:n.size,type:n.type,validationMessages:{minSize:"",maxSize:""},statusCode:"1"}];u.createFileList(e);u.filesData.push(e[0]);u.upload(e);i.element.getElementsByClassName("e-file-select-wrap")[0].style.display="none";Object(r.detach)(i.element.querySelector(".e-rte-dialog-upload .e-file-select-wrap"))},n.prototype.popupClose=function(n,t,i,u){var f=this;this.parent.trigger(be,u,function(n){if(!Object(r.isNullOrUndefined)(f.parent.insertImageSettings.path)){var t=f.parent.insertImageSettings.path+n.file.name+"."+n.file.type.split("image/")[1];i.src=t;i.setAttribute("alt",n.file.name)}});n.close();i.style.opacity="1";t.destroy()},n.prototype.refreshPopup=function(n,t){(this.parent.iframeSettings.enable?this.parent.element.offsetTop+n.offsetTop:n.offsetTop)>this.parent.element.offsetTop+this.parent.element.offsetHeight?(t.relateTo=this.parent.inputElement,t.offsetY=this.parent.iframeSettings.enable?-30:-65,t.element.style.display="block"):t&&(t.refreshPosition(n),t.element.style.display="block")},n.prototype.base64ToFile=function(n,t){for(var r=n.split(","),e=r[0].match(/:(.*?);/)[1],u=atob(r[1]),i=u.length,f=new Uint8Array(i);i--;)f[i]=u.charCodeAt(i);return new File([f],t,{type:e})},n.prototype.imageFormatting=function(n,t){var u=this.parent.createElement("span"),i,r,f;u.appendChild(t.elements[0]);i=u.innerHTML;this.contentRenderer=this.renderFactory.getRenderer(o.Content);r=this.contentRenderer.getDocument();f=this.nodeSelectionObj.getRange(r);this.saveSelection=this.nodeSelectionObj.save(f,r);this.parent.pasteCleanupSettings.prompt?this.pasteDialog(i,n):this.parent.pasteCleanupSettings.plainText?this.plainFormatting(i,n):this.parent.pasteCleanupSettings.keepFormat?this.formatting(i,!1,n):this.formatting(i,!0,n)},n.prototype.radioRender=function(){var i=new nr.RadioButton({label:this.i10n.getConstant("keepFormat"),name:"pasteOption",checked:!0}),r,n,u,t,f;i.isStringTemplate=!0;r=this.parent.element.querySelector("#keepFormating");i.appendTo(r);n=new nr.RadioButton({label:this.i10n.getConstant("cleanFormat"),name:"pasteOption"});n.isStringTemplate=!0;u=this.parent.element.querySelector("#cleanFormat");n.appendTo(u);t=new nr.RadioButton({label:this.i10n.getConstant("plainText"),name:"pasteOption"});t.isStringTemplate=!0;f=this.parent.element.querySelector("#plainTextFormat");t.appendTo(f)},n.prototype.selectFormatting=function(n,t,i,r){i?this.formatting(n,!1,t):r?this.formatting(n,!0,t):this.plainFormatting(n,t)},n.prototype.pasteDialog=function(n,t){var f=this,e={buttons:[{click:function(){var u,e,o;i.isDestroyed||(u=f.parent.element.querySelector("#keepFormating").checked,e=f.parent.element.querySelector("#cleanFormat").checked,i.hide(),o=Object(r.isBlazor)()?null:i,f.dialogRenderObj.close(o),i.destroy(),f.selectFormatting(n,t,u,e))},buttonModel:{isPrimary:!0,cssClass:"e-flat "+ev,content:this.i10n.getConstant("pasteDialogOk")}},{click:function(){if(!i.isDestroyed){i.hide();var n=Object(r.isBlazor)()?null:i;f.dialogRenderObj.close(n);i.destroy()}},buttonModel:{cssClass:"e-flat "+ov,content:this.i10n.getConstant("pasteDialogCancel")}}],header:this.i10n.getConstant("pasteFormat"),content:this.i10n.getConstant("pasteFormatContent")+'<br/><div><div style="padding-top:24px;"><input type="radio" class="'+rv+'" id="keepFormating"/><\/div><div style="padding-top:20px;"><input type="radio" class="'+uv+'" id="cleanFormat"/><\/div><div style="padding-top:20px;"><input type="radio" class="'+fv+'" id="plainTextFormat"/><\/div><\/div>',target:this.parent.element,width:"300px",height:"265px",cssClass:sv,isModal:!0},i=this.dialogRenderObj.render(e),u=this.parent.element.querySelector("#"+this.parent.getID()+"_pasteCleanupDialog");null!==u&&""!==u.innerHTML&&this.destroyDialog(u);null===u&&(u=this.parent.createElement("div",{id:this.parent.getID()+"_pasteCleanupDialog"}),this.parent.element.appendChild(u));i.appendTo(u);this.radioRender();i.show()},n.prototype.destroyDialog=function(n){var u=this.parent.element.querySelector(".e-dlg-container"),i,t;for(Object(r.detach)(u),i=n.children.length,t=0;t<i;t++)Object(r.detach)(n.children[0])},n.prototype.formatting=function(n,t,i){var o=this,u=this.parent.createElement("div",{className:"pasteContent",styles:"display:inline;"}),e,f;for(this.isNotFromHtml&&this.containsHtml&&(n=this.splitBreakLine(n)),u.innerHTML=n,null!==this.parent.pasteCleanupSettings.deniedTags&&(u=this.deniedTags(u)),(t||null!==this.parent.pasteCleanupSettings.deniedAttrs)&&(u=this.deniedAttributes(u,t)),null!==this.parent.pasteCleanupSettings.allowedStyleProps&&(u=this.allowedStyle(u)),this.saveSelection.restore(),u.innerHTML=this.sanitizeHelper(u.innerHTML),e=u.querySelectorAll("img"),f=0;f<e.length;f++)e[f].classList.add("pasteContent_Img");""===u.textContent&&Object(r.isNullOrUndefined)(u.querySelector("img"))&&Object(r.isNullOrUndefined)(u.querySelector("table"))||(this.parent.formatter.editorManager.execCommand("inserthtml","pasteCleanup",i,function(n){Object(r.extend)(i,{elements:[n.elements]},!0);o.parent.formatter.onSuccess(o.parent,i)},u),this.parent.notify(bt,{}),this.imgUploading(this.parent.inputElement))},n.prototype.sanitizeHelper=function(n){return tc(n,this.parent)},n.prototype.plainFormatting=function(n,t){var s=this,i=this.parent.createElement("div",{className:"pasteContent",styles:"display:inline;"}),u,e;if(i.innerHTML=n,this.detachInlineElements(i),this.getTextContent(i),""!==i.textContent.trim()){if(!Object(r.isNullOrUndefined)(i.firstElementChild)&&"BR"!==i.firstElementChild.tagName&&(u=i.firstElementChild,!Object(r.isNullOrUndefined)(i.firstElementChild))){for(var o=this.parent.createElement("span"),f=0,h=0;f<u.childNodes.length;f++,h++)if("#text"===u.childNodes[f].nodeName)o.appendChild(u.childNodes[f]),i.insertBefore(o,i.firstElementChild),f--;else{if("#text"===u.childNodes[f].nodeName||0!==h)break;for(e=0;e<u.childNodes[f].childNodes.length;e++)o.appendChild(u.childNodes[f].childNodes[e]),i.insertBefore(o,i.firstElementChild),e--;f--}u.hasChildNodes()||Object(r.detach)(u)}this.removeEmptyElements(i);this.saveSelection.restore();i.innerHTML=this.sanitizeHelper(i.innerHTML);this.parent.formatter.editorManager.execCommand("inserthtml","pasteCleanup",t,function(){Object(r.extend)(t,{elements:[]},!0);s.parent.formatter.onSuccess(s.parent,t)},i)}else this.saveSelection.restore(),Object(r.extend)(t,{elements:[]},!0),this.parent.formatter.onSuccess(this.parent,t)},n.prototype.getTextContent=function(n){for(var u,t,s,o,h,f=0;f<this.blockNode.length;f++)for(u=n.querySelectorAll(this.blockNode[f]),t=0;t<u.length;t++){for(var e=void 0,i=0,l=0,c=void 0;i<u[t].childNodes.length;i++,l++)"DIV"===u[t].childNodes[i].nodeName||"P"===u[t].childNodes[i].nodeName||"#text"===u[t].childNodes[i].nodeName&&"&nbsp;"!==u[t].childNodes[i].nodeValue.replace(/\u00a0/g,"&nbsp;")&&""===u[t].childNodes[i].textContent.trim()?(e=u[t].childNodes[i].parentElement,u[t].childNodes[i].parentElement.parentElement.insertBefore(u[t].childNodes[i],u[t].childNodes[i].parentElement),i--):((e=u[t].childNodes[i].parentElement,"text"===c)?e.previousElementSibling.appendChild(u[t].childNodes[i]):(s=this.parent.createElement("div",{id:"newDiv"}),s.appendChild(u[t].childNodes[i]),e.parentElement.insertBefore(s,e)),i--,c="text");Object(r.isNullOrUndefined)(e)||Object(r.detach)(e)}for(o=n.querySelectorAll("*"),f=0;f<o.length;f++)for(h=o[f].attributes,t=0;t<h.length;t++)o[f].removeAttribute(h[t].name),t--},n.prototype.detachInlineElements=function(n){for(var u,t,e,i,f=0;f<this.inlineNode.length;f++)for(u=n.querySelectorAll(this.inlineNode[f]),t=0;t<u.length;t++){for(e=void 0,i=0;i<u[t].childNodes.length;i++)e=u[t].childNodes[i].parentElement,u[t].childNodes[i].parentElement.parentElement.insertBefore(u[t].childNodes[i],u[t].childNodes[i].parentElement),i--;Object(r.isNullOrUndefined)(e)||Object(r.detach)(e)}},n.prototype.findDetachEmptyElem=function(n){return Object(r.isNullOrUndefined)(n.parentElement)?null:""===n.parentElement.textContent.trim()&&"pasteContent"!==n.parentElement.getAttribute("class")?this.findDetachEmptyElem(n.parentElement):n},n.prototype.removeEmptyElements=function(n){for(var u,i=n.querySelectorAll(":empty"),t=0;t<i.length;t++)"BR"!==i[t].tagName&&(u=this.findDetachEmptyElem(i[t]),Object(r.isNullOrUndefined)(u)||Object(r.detach)(u))},n.prototype.tagGrouping=function(n){for(var u,t=n.slice(),r=Object.keys(kc),f=r.map(function(n){return kc[n]}),e=[],i=0;i<t.length;i++)if(t[i].split("[").length>1&&(t[i]=t[i].split("[")[0].trim()),r.indexOf(t[i])>-1)for(u=0;u<f[r.indexOf(t[i])].length;u++)t.indexOf(f[r.indexOf(t[i])][u])<0&&e.indexOf(f[r.indexOf(t[i])][u])<0&&e.push(f[r.indexOf(t[i])][u]);return n.concat(e)},n.prototype.attributesfilter=function(n){for(var e,o,s,t=0;t<n.length;t++)if(n[t].split("[").length>1){for(var r=n[t].split("[")[1].split("]")[0].split(","),u=[],f=[],i=0;i<r.length;i++)r[i].indexOf("!")<0?u.push(r[i].trim()):f.push(r[i].split("!")[1].trim());e=u.length>1?u.join("]["):u.join();o=f.length>1?f.join("]["):f.join();o.length>0?(s=""!==e?n[t].split("[")[0]+"["+e+"]":n[t].split("[")[0],n[t]=s+":not(["+o+"])"):n[t]=n[t].split("[")[0]+"["+e+"]"}return n},n.prototype.deniedTags=function(n){var u=Object(r.isNullOrUndefined)(this.parent.pasteCleanupSettings.deniedTags)?[]:this.parent.pasteCleanupSettings.deniedTags.slice(),f,i,t,e;for(u=this.attributesfilter(u),u=this.tagGrouping(u),f=0;f<u.length;f++)for(i=n.querySelectorAll(u[f]),t=i.length-1;t>=0;t--){for(e=i[t].parentNode;i[t].firstChild;)e.insertBefore(i[t].firstChild,i[t]);e.removeChild(i[t])}return n},n.prototype.deniedAttributes=function(n,t){var u=Object(r.isNullOrUndefined)(this.parent.pasteCleanupSettings.deniedAttrs)?[]:this.parent.pasteCleanupSettings.deniedAttrs.slice(),i,e,f;for(t&&u.push("style"),i=0;i<u.length;i++)for(e=n.querySelectorAll("["+u[i]+"]"),f=0;f<e.length;f++)e[f].removeAttribute(u[i]);return n},n.prototype.allowedStyle=function(n){var o=Object(r.isNullOrUndefined)(this.parent.pasteCleanupSettings.allowedStyleProps)?[]:this.parent.pasteCleanupSettings.allowedStyleProps.slice(),i,t;for(o.push("list-style-type","list-style"),i=n.querySelectorAll("[style]"),t=0;t<i.length;t++){for(var s,u=[],e=i[t].getAttribute("style").split(";"),f=0;f<e.length;f++)o.indexOf(e[f].split(":")[0].trim())>=0&&u.push(e[f]);i[t].removeAttribute("style");(s=""===u.join(";").trim()?u.join(";"):u.join(";")+";")&&i[t].setAttribute("style",s)}return n},n.prototype.getModuleName=function(){return"pasteCleanup"},n}(),vk=function(){function n(n){this.parent=n;this.addEventListener()}return n.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(p,this.renderResizable,this),this.parent.on(h,this.destroy,this))},n.prototype.renderResizable=function(){this.resizer=this.parent.createElement("div",{id:this.parent.getID()+"-resizable",className:"e-icons "+vh+" "+hv});this.parent.element.classList.add(wh);this.parent.element.appendChild(this.resizer);this.touchStartEvent="msie"===r.Browser.info.name?"pointerdown":"touchstart";r.EventHandler.add(this.resizer,"mousedown",this.resizeStart,this);r.EventHandler.add(this.resizer,this.touchStartEvent,this.resizeStart,this)},n.prototype.resizeStart=function(n){var i=this,t;n.cancelable&&n.preventDefault();this.wireResizeEvents();t=Object(r.isBlazor)()?{requestType:"editor"}:{event:n,requestType:"editor"};this.parent.trigger(df,t,function(n){n.cancel&&i.unwireResizeEvents()})},n.prototype.performResize=function(n){var u=this,f=Object(r.isBlazor)()?{requestType:"editor"}:{event:n,requestType:"editor"},t,i;this.parent.trigger(gf,f,function(n){n.cancel&&u.unwireResizeEvents()});t=this.parent.element.getBoundingClientRect();this.isMouseEvent(n)?(this.parent.element.style.height=n.clientY-t.top+"px",this.parent.element.style.width=n.clientX-t.left+"px"):(i="msie"!==r.Browser.info.name?n.touches[0]:n,this.parent.element.style.height=i.clientY-t.top+"px",this.parent.element.style.width=i.clientX-t.left+"px");this.parent.refreshUI()},n.prototype.stopResize=function(n){this.parent.refreshUI();this.unwireResizeEvents();var t=Object(r.isBlazor)()?{requestType:"editor"}:{event:n,requestType:"editor"};this.parent.trigger(ne,t)},n.prototype.getEventType=function(n){return n.indexOf("mouse")>-1?"mouse":"touch"},n.prototype.isMouseEvent=function(n){var t=!1;return("mouse"===this.getEventType(n.type)||!Object(r.isNullOrUndefined)(n.pointerType)&&"mouse"===this.getEventType(n.pointerType))&&(t=!0),t},n.prototype.wireResizeEvents=function(){r.EventHandler.add(document,"mousemove",this.performResize,this);r.EventHandler.add(document,"mouseup",this.stopResize,this);this.touchMoveEvent="msie"===r.Browser.info.name?"pointermove":"touchmove";this.touchEndEvent="msie"===r.Browser.info.name?"pointerup":"touchend";r.EventHandler.add(document,this.touchMoveEvent,this.performResize,this);r.EventHandler.add(document,this.touchEndEvent,this.stopResize,this)},n.prototype.unwireResizeEvents=function(){r.EventHandler.remove(document,"mousemove",this.performResize);r.EventHandler.remove(document,"mouseup",this.stopResize);r.EventHandler.remove(document,this.touchMoveEvent,this.performResize);r.EventHandler.remove(document,this.touchEndEvent,this.stopResize)},n.prototype.destroy=function(){this.removeEventListener()},n.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(p,this.renderResizable),this.parent.element.classList.remove(wh),r.EventHandler.remove(this.resizer,"mousedown",this.resizeStart),r.EventHandler.remove(this.resizer,this.touchStartEvent,this.resizeStart),this.resizer&&Object(r.detach)(this.resizer),this.parent.off(h,this.destroy))},n.prototype.getModuleName=function(){return"resize"},n}(),dp=function(){function n(n){this.parent=n;this.addEventListener()}return n.prototype.showFullScreen=function(n){!0===this.parent.toolbarSettings.enable&&"Markdown"!==this.parent.editorMode&&this.parent.quickToolbarModule.hideQuickToolbars();this.scrollableParent=Object(ft.getScrollableParent)(this.parent.element);this.parent.element.classList.contains(yr)||(this.parent.trigger(st,{requestType:"Maximize",targetItem:"Maximize",args:n}),this.parent.toolbarSettings.enableFloating&&!this.parent.inlineMode.enable&&this.parent.toolbarSettings.enable&&(this.parent.getToolbarElement().style.width="100%",this.parent.getToolbarElement().style.top="0px"),this.parent.element.classList.add(yr),this.toggleParentOverflow(!0),this.parent.setContentHeight(),this.parent.toolbarModule&&(this.parent.getBaseToolbarObject().toolbarObj.items[0].properties||this.parent.getBaseToolbarObject().toolbarObj.removeItems(0),r.Browser.isDevice&&this.parent.toolbarModule.removeFixedTBarClass(),this.parent.toolbarModule.updateItem({targetItem:"Maximize",updateItem:"Minimize",baseToolbar:this.parent.getBaseToolbarObject()})),this.parent.trigger(vi,{requestType:"Maximize",targetItem:"Maximize",args:n}))},n.prototype.hideFullScreen=function(n){if(!0===this.parent.toolbarSettings.enable&&"Markdown"!==this.parent.editorMode&&this.parent.quickToolbarModule.hideQuickToolbars(),this.parent.element.classList.contains(yr)){this.parent.element.classList.remove(yr);for(var i=document.querySelectorAll(".e-rte-overflow"),t=0;t<i.length;t++)Object(r.removeClass)([i[t]],["e-rte-overflow"]);this.parent.trigger(st,{requestType:"Minimize",targetItem:"Minimize",args:n});this.parent.setContentHeight();this.parent.toolbarModule&&(this.parent.getBaseToolbarObject().toolbarObj.items[0].properties||this.parent.getBaseToolbarObject().toolbarObj.removeItems(0),this.parent.toolbarModule.updateItem({targetItem:"Minimize",updateItem:"Maximize",baseToolbar:this.parent.getBaseToolbarObject()}),r.Browser.isDevice&&this.parent.inlineMode.enable&&this.parent.toolbarModule.addFixedTBarClass());this.parent.trigger(vi,{requestType:"Minimize",targetItem:"Minimize",args:n})}},n.prototype.toggleParentOverflow=function(){var n,t;if(!Object(r.isNullOrUndefined)(this.scrollableParent))for(n=0;n<this.scrollableParent.length;n++)"#document"===this.scrollableParent[n].nodeName?(t=document.querySelector("body"),Object(r.addClass)([t],["e-rte-overflow"])):(t=this.scrollableParent[n],Object(r.addClass)([t],["e-rte-overflow"]))},n.prototype.onKeyDown=function(n){var t=n.args;switch(t.action){case"full-screen":this.showFullScreen(n.args);t.preventDefault();break;case"escape":this.hideFullScreen(n.args);t.preventDefault()}},n.prototype.addEventListener=function(){this.parent.on(w,this.onKeyDown,this);this.parent.on(h,this.destroy,this)},n.prototype.removeEventListener=function(){this.parent.off(w,this.onKeyDown);this.parent.off(h,this.destroy)},n.prototype.destroy=function(){this.parent.element.classList.contains(yr)&&this.toggleParentOverflow(!1);for(var t=document.querySelectorAll(".e-rte-overflow"),n=0;n<t.length;n++)Object(r.removeClass)([t[n]],["e-rte-overflow"]);this.removeEventListener()},n}();var gp=function(){function n(n,t){this.parent=n;this.locator=t;this.renderer=this.locator.getService("rendererFactory");this.addEventListener()}return n.prototype.render=function(){this.parent;this.contentRenderer=this.renderer.getRenderer(o.Content);this.contentRenderer.renderPanel()},n.prototype.refresh=function(n){void 0===n&&(n={requestType:"refresh"});this.parent.notify(n.requestType+"-begin",n)},n.prototype.destroy=function(){this.removeEventListener()},n.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(y,this.refresh,this),this.parent.on(ri,this.keyUp,this))},n.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(y,this.refresh),this.parent.off(ri,this.keyUp))},n.prototype.keyUp=function(n){var t,i;if("HTML"===this.parent.editorMode)switch(n.args.which){case 46:case 8:t=this.parent.contentModule.getEditPanel().childNodes;(0===t.length||1===t.length&&("BR"===t[0].tagName||"P"===t[0].tagName&&(0===t[0].childNodes.length||""===t[0].textContent)))&&(i=this.parent.contentModule.getEditPanel(),i.innerHTML="<p><br/><\/p>",this.parent.formatter.editorManager.nodeSelection.setCursorPoint(this.parent.contentModule.getDocument(),i.childNodes[0],0))}},n}(),yk=function(){function n(n,t){this.parent=n;this.rteID=n.element.id;this.i10n=t.getService("rteLocale");this.addEventListener();this.serviceLocator=t;this.rendererFactory=t.getService("rendererFactory");this.dialogRenderObj=t.getService("dialogRenderObject")}return n.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(vu,this.linkDialog,this),this.parent.on(w,this.onKeyDown,this),this.parent.on(ur,this.showLinkQuickToolbar,this),this.parent.on(kf,this.onToolbarAction,this),this.parent.on(wt,this.onIframeMouseDown,this),this.parent.on(te,this.removeLink,this),this.parent.on(ie,this.editLink,this),this.parent.on(re,this.openLink,this),this.parent.on(ii,this.editAreaClickHandler,this))},n.prototype.onToolbarAction=function(n){switch(n.args.item.subCommand){case"OpenLink":this.parent.notify(re,n);break;case"EditLink":this.parent.notify(ie,n);break;case"RemoveLink":this.parent.notify(te,n)}},n.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(vu,this.linkDialog),this.parent.off(w,this.onKeyDown),this.parent.off(ur,this.showLinkQuickToolbar),this.parent.off(kf,this.onToolbarAction),this.parent.off(te,this.removeLink),this.parent.off(wt,this.onIframeMouseDown),this.parent.off(ie,this.editLink),this.parent.off(re,this.openLink),this.parent.off(ii,this.editAreaClickHandler))},n.prototype.onIframeMouseDown=function(){this.dialogObj&&this.dialogObj.hide({returnValue:!0})},n.prototype.showLinkQuickToolbar=function(n){var i,u,t;if("enter"!==n.args.action&&"space"!==n.args.action){if(i=void 0,u=void 0,"Links"!==n.type||Object(r.isNullOrUndefined)(this.parent.quickToolbarModule)||Object(r.isNullOrUndefined)(this.parent.quickToolbarModule.linkQTBar))return;this.quickToolObj=this.parent.quickToolbarModule;var f,e=this.parent.element.getBoundingClientRect().top,o=this.parent.element.getBoundingClientRect().left,c=this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument());if([].forEach.call(n.elements,function(n,t){0===t&&(f="#text"===n.nodeName?n.parentNode:n)}),n.isNotify){var s=this.parent.toolbarModule.getToolbarElement(),h=f.getBoundingClientRect().top,l=f.getBoundingClientRect().left,a=h-e,v=s?s.offsetHeight+this.parent.toolbarModule.getExpandTBarPopHeight():0;i=this.parent.iframeSettings.enable?o+l:f.getBoundingClientRect().left;u=window.pageYOffset+(this.parent.iframeSettings.enable?e+v+h:e+a)}else t=void 0,t=n.args.touches?n.args.changedTouches[0]:t=n.args,i=this.parent.iframeSettings.enable?window.pageXOffset+o+t.clientX:t.pageX,u=this.parent.iframeSettings.enable?window.pageYOffset+e+t.clientY:t.pageY;this.quickToolObj.linkQTBar&&this.quickToolObj.linkQTBar.showPopup(i,u,c.endContainer)}},n.prototype.hideLinkQuickToolbar=function(){this.quickToolObj&&this.quickToolObj.linkQTBar&&document.body.contains(this.quickToolObj.linkQTBar.element)&&this.quickToolObj.linkQTBar.hidePopup()},n.prototype.editAreaClickHandler=function(n){var t,r,i,u;if(this.parent.readonly)this.hideLinkQuickToolbar();else if(t=n.args,r=this.parent.quickToolbarSettings.showOnRightClick,!(2===t.which||r&&1===t.which||!r&&3===t.which)&&"HTML"===this.parent.editorMode&&this.parent.quickToolbarModule&&this.parent.quickToolbarModule.linkQTBar)if(this.quickToolObj=this.parent.quickToolbarModule,i=t.target,i=this.getAnchorNode(i),this.contentModule=this.rendererFactory.getRenderer(o.Content),u=this.quickToolObj.linkQTBar.element.classList.contains("e-rte-pop"),"A"===i.nodeName&&i.childNodes.length>0&&"IMG"!==i.childNodes[0].nodeName&&"IMG"!==n.args.target.nodeName){if(u)return;this.showLinkQuickToolbar({args:t,isNotify:!1,type:"Links",elements:[t.target]})}else this.hideLinkQuickToolbar()},n.prototype.onKeyDown=function(n){var t=n.args,u;switch(t.action){case"escape":Object(r.isNullOrUndefined)(this.dialogObj)||this.dialogObj.close();break;case"insert-link":if("HTML"===this.parent.editorMode){var i=this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument()),f=this.parent.formatter.editorManager.nodeSelection.save(i,this.parent.contentModule.getDocument()),e=this.parent.formatter.editorManager.nodeSelection.getNodeCollection(i),o=this.parent.formatter.editorManager.nodeSelection.getParentNodeCollection(i),s={args:n.args,selectNode:e,selection:f,selectParent:o};this.linkDialog(s)}else u=this.parent.contentModule.getEditPanel(),this.parent.formatter.editorManager.markdownSelection.save(u.selectionStart,u.selectionEnd),this.linkDialog({args:{item:{command:"Links",subCommand:"Link"},originalEvent:t},member:"link",text:this.parent.formatter.editorManager.markdownSelection.getSelectedText(this.parent.contentModule.getEditPanel()),module:"Markdown",name:"insertLink"});t.preventDefault()}},n.prototype.linkDialog=function(n,t){var i=this,u,o;if(this.dialogObj)this.dialogObj.hide({returnValue:!0});else if("HTML"===this.parent.editorMode&&n.selectParent.length>0&&!Object(r.isNullOrUndefined)(n.selectParent[0].classList)&&n.selectParent[0].classList.contains("e-rte-anchor")&&Object(r.isNullOrUndefined)(t))this.editLink(n);else{var f,c=this.i10n.getConstant("linkWebUrl"),l=this.i10n.getConstant("linkText"),a=this.i10n.getConstant("linkTooltipLabel"),v=this.i10n.getConstant("linkurl"),y=this.i10n.getConstant("textPlaceholder"),p=this.i10n.getConstant("linkTitle"),e=this.parent.createElement("div",{className:"e-rte-link-dialog",id:this.rteID+"_rtelink"});this.parent.element.appendChild(e);u=this.parent.createElement("div",{className:"e-rte-linkcontent",id:this.rteID+"_linkContent"});o=ci('<div class="e-rte-label"><label>'+c+'<\/label><\/div><div class="e-rte-field"><input type="text" data-role ="none" spellcheck="false" placeholder="'+v+'" class="e-input e-rte-linkurl"/><\/div><div class="e-rte-label"><label>'+l+'<\/label><\/div><div class="e-rte-field"> <input type="text" data-role ="none" spellcheck="false" class="e-input e-rte-linkText" placeholder="'+y+'"><\/div><div class="e-rte-label">'+("HTML"===this.parent.editorMode?"<label>"+a+'<\/label><\/div><div class="e-rte-field"><input type="text" data-role ="none" spellcheck="false" placeholder = "'+p+'" class="e-input e-rte-linkTitle"><\/div><div class="e-rte-label"><\/div><div class="e-rte-field"><input type="checkbox" class="e-rte-linkTarget"  data-role ="none"><\/div>':""));u.appendChild(o);var w=u.querySelector(".e-rte-linkTarget"),k=u.querySelector(".e-rte-linkurl"),s=u.querySelector(".e-rte-linkText"),d=u.querySelector(".e-rte-linkTitle"),g=this.i10n.getConstant("linkOpenInNewWindow");this.checkBoxObj=new nr.CheckBox({label:g,checked:!0,enableRtl:this.parent.enableRtl});this.checkBoxObj.isStringTemplate=!0;this.checkBoxObj.createElement=this.parent.createElement;this.checkBoxObj.appendTo(w);f="HTML"===this.parent.editorMode?n.selection.getRange(this.parent.contentModule.getDocument()).toString():n.text;var nt=this.i10n.getConstant("dialogInsert"),tt=this.i10n.getConstant("dialogCancel"),it=n.selection,h={selfLink:this,selection:n.selection,selectParent:n.selectParent,args:n.args},rt={header:this.i10n.getConstant("linkHeader"),content:u,cssClass:b,enableRtl:this.parent.enableRtl,locale:this.parent.locale,showCloseIcon:!0,closeOnEscape:!0,width:r.Browser.isDevice?"290px":"310px",height:"inherit",isModal:r.Browser.isDevice,buttons:[{click:this.insertlink.bind(h),buttonModel:{content:nt,cssClass:"e-flat e-insertLink",isPrimary:!0}},{click:this.cancelDialog.bind(h),buttonModel:{cssClass:"e-flat",content:tt}}],target:r.Browser.isDevice?document.body:this.parent.element,animationSettings:{effect:"None"},close:function(n){i.parent.isBlur=!1;n&&n.event.returnValue&&("HTML"===i.parent.editorMode?it.restore():i.parent.formatter.editorManager.markdownSelection.restore(i.parent.contentModule.getEditPanel()));i.dialogObj.destroy();Object(r.detach)(i.dialogObj.element);var t=Object(r.isBlazor)()?null:i.dialogObj;i.dialogRenderObj.close(t);i.dialogObj=null}};this.dialogObj=this.dialogRenderObj.render(rt);this.dialogObj.createElement=this.parent.createElement;this.dialogObj.appendTo(e);e.style.maxHeight="inherit";Object(r.isNullOrUndefined)(t)||(k.value=t.url,s.value=t.text,d.value=t.title,this.checkBoxObj.checked=t.target?!0:!1,this.dialogObj.header=t.header,this.dialogObj.element.querySelector(".e-insertLink").textContent=t.btnText);this.checkUrl(!1);("HTML"===this.parent.editorMode&&Object(r.isNullOrUndefined)(t)&&(!Object(r.isNullOrUndefined)(f)&&""!==f&&0===n.selection.range.startOffset||n.selection.range.startOffset!==n.selection.range.endOffset)||"Markdown"===n.module)&&(s.value=f);r.EventHandler.add(this.parent.element.ownerDocument,"mousedown",this.onDocumentClick,this);this.quickToolObj&&(this.hideLinkQuickToolbar(),this.quickToolObj.inlineQTBar&&document.body.contains(this.quickToolObj.inlineQTBar.element)&&this.quickToolObj.inlineQTBar.hidePopup())}},n.prototype.insertlink=function(){var e,u=this.selfLink.dialogObj.element,t=u.querySelector(".e-rte-linkurl").value,i=u.querySelector(".e-rte-linkText").value,o,n,f,s;"HTML"===this.selfLink.parent.editorMode&&(e=u.querySelector(".e-rte-linkTitle").value);o=this.selfLink.checkBoxObj.checked?"_blank":null;""!==t?(this.selfLink.isUrl(t)?this.selfLink.checkUrl(!1):(i=""===i?t:i,t=this.selfLink.parent.enableAutoUrl||t.indexOf("http")>-1?t:"http://"+t),n=this.selfLink,"HTML"===n.parent.editorMode&&Object(r.isNullOrUndefined)(Object(r.closest)(this.selection.range.startContainer.parentNode,"#"+n.parent.contentModule.getPanel().id))&&(n.parent.contentModule.getEditPanel().focus(),r.Browser.isIE&&n.parent.iframeSettings.enable&&this.selection.restore(),f=n.parent.formatter.editorManager.nodeSelection.getRange(n.parent.contentModule.getDocument()),this.selection=n.parent.formatter.editorManager.nodeSelection.save(f,n.parent.contentModule.getDocument()),this.selectParent=n.parent.formatter.editorManager.nodeSelection.getParentNodeCollection(f)),s={url:t,text:i,title:e,target:o,selection:this.selection,selectParent:this.selectParent},document.body.contains(n.dialogObj.element)&&this.selfLink.dialogObj.hide({returnValue:!1}),d()&&n.parent.iframeSettings.enable&&Object(r.select)("iframe",n.parent.element).contentWindow.focus(),"HTML"===n.parent.editorMode&&this.selection.restore(),0===n.parent.formatter.getUndoRedoStack().length&&n.parent.formatter.saveData(),this.selfLink.parent.formatter.process(this.selfLink.parent,this.args,this.args.originalEvent,s),this.selfLink.parent.contentModule.getEditPanel().focus()):this.selfLink.checkUrl(!0)},n.prototype.isUrl=function(n){return/(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/gi.test(n)},n.prototype.checkUrl=function(n){var t=this.dialogObj.element.querySelector(".e-rte-linkurl");n?(Object(r.addClass)([t],"e-error"),t.setSelectionRange(0,t.value.length),t.focus()):Object(r.removeClass)([t],"e-error")},n.prototype.removeLink=function(n){0===this.parent.formatter.getUndoRedoStack().length&&this.parent.formatter.saveData();this.parent.formatter.process(this.parent,n.args,n.args,{selectNode:n.selectNode,selectParent:n.selectParent,selection:n.selection,subCommand:n.args.item.subCommand});d()&&this.parent.iframeSettings.enable?Object(r.select)("iframe",this.parent.element).contentWindow.focus():this.parent.contentModule.getEditPanel().focus();this.hideLinkQuickToolbar()},n.prototype.openLink=function(n){var t=this.getAnchorNode(n.selectParent[0]);(t.classList.contains("e-rte-anchor")||"A"===t.tagName)&&this.parent.formatter.process(this.parent,n.args,n.args,{url:t.href,target:""===t.target?"_self":"_blank",selectNode:n.selectNode,subCommand:n.args.item.subCommand})},n.prototype.getAnchorNode=function(n){var t=Object(r.closest)(n,"a");return t||n},n.prototype.editLink=function(n){var i=this.getAnchorNode(n.selectNode[0]),t=this.getAnchorNode(n.selectParent[0]),r,u;((t="A"===i.nodeName?i:t).classList.contains("e-rte-anchor")||"A"===t.tagName)&&(r=this.i10n.getConstant("dialogUpdate"),u={url:t.getAttribute("href"),text:t.innerText,title:t.title,target:t.target,header:this.i10n.getConstant("editLink"),btnText:r},this.linkDialog(n,u))},n.prototype.cancelDialog=function(){this.selfLink.parent.isBlur=!1;this.selfLink.dialogObj.hide({returnValue:!0});d()?this.selection.restore():this.selfLink.parent.contentModule.getEditPanel().focus()},n.prototype.onDocumentClick=function(n){var t=n.target;Object(r.isNullOrUndefined)(this.dialogObj)||(Object(r.closest)(t,"#"+this.dialogObj.element.id)||!this.parent.toolbarSettings.enable||!this.parent.getToolbarElement()||this.parent.getToolbarElement().contains(n.target))&&(!(this.parent.getToolbarElement()&&this.parent.getToolbarElement().contains(n.target)||this.parent.inlineMode.enable&&!Object(r.closest)(t,"#"+this.parent.getID()+"_rtelink"))||Object(r.closest)(t,"#"+this.parent.getID()+"_toolbar_CreateLink")||t.querySelector("#"+this.parent.getID()+"_toolbar_CreateLink"))||(this.dialogObj.hide({returnValue:!0}),this.parent.isBlur=!0,uu(this.parent.element,"focusout"))},n.prototype.destroy=function(){this.removeEventListener()},n.prototype.getModuleName=function(){return"link"},n}(),pk=function(){function n(n,t){this.pageX=null;this.pageY=null;this.parent=n;this.rteID=n.element.id;this.i10n=t.getService("rteLocale");this.rendererFactory=t.getService("rendererFactory");this.dialogRenderObj=t.getService("dialogRenderObject");this.addEventListener()}return n.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(w,this.onKeyDown,this),this.parent.on(rr,this.insertImage,this),this.parent.on(ur,this.showImageQuickToolbar,this),this.parent.on(bf,this.onToolbarAction,this),this.parent.on(oe,this.caption,this),this.parent.on(ee,this.deleteImg,this),this.parent.on(ue,this.insertImgLink,this),this.parent.on(fe,this.insertAltText,this),this.parent.on(ii,this.editAreaClickHandler,this),this.parent.on(wt,this.onIframeMouseDown,this),this.parent.on(se,this.imageSize,this),this.parent.on(ui,this.alignmentSelect,this),this.parent.on(p,this.afterRender,this),this.parent.on(pi,this.imagePaste,this),this.parent.on(h,this.removeEventListener,this))},n.prototype.removeEventListener=function(){if(!this.parent.isDestroyed){this.parent.off(w,this.onKeyDown);this.parent.off(rr,this.insertImage);this.parent.off(ur,this.showImageQuickToolbar);this.parent.off(oe,this.caption);this.parent.off(bf,this.onToolbarAction);this.parent.off(ee,this.deleteImg);this.parent.off(ue,this.insertImgLink);this.parent.off(fe,this.insertAltText);this.parent.off(ii,this.editAreaClickHandler);this.parent.off(wt,this.onIframeMouseDown);this.parent.off(se,this.imageSize);this.parent.off(ui,this.alignmentSelect);this.parent.off(p,this.afterRender);this.parent.off(pi,this.imagePaste);this.parent.off(h,this.removeEventListener);var n=this.parent.iframeSettings.enable?this.parent.inputElement.ownerDocument:this.parent.inputElement;n.removeEventListener("drop",this.dragDrop.bind(this),!0);n.removeEventListener("dragstart",this.dragStart.bind(this),!0);n.removeEventListener("dragenter",this.dragEnter.bind(this),!0);n.removeEventListener("dragover",this.dragOver.bind(this),!0);Object(r.isNullOrUndefined)(this.contentModule)||(r.EventHandler.remove(this.contentModule.getEditPanel(),r.Browser.touchEndEvent,this.imageClick),this.parent.formatter.editorManager.observer.off(pe,this.undoStack),this.parent.insertImageSettings.resize&&(r.EventHandler.remove(this.parent.contentModule.getEditPanel(),r.Browser.touchStartEvent,this.resizeStart),r.EventHandler.remove(this.parent.element.ownerDocument,"mousedown",this.onDocumentClick)))}},n.prototype.onIframeMouseDown=function(){this.dialogObj&&this.dialogObj.hide({returnValue:!0})},n.prototype.afterRender=function(){this.contentModule=this.rendererFactory.getRenderer(o.Content);r.EventHandler.add(this.contentModule.getEditPanel(),r.Browser.touchEndEvent,this.imageClick,this);this.parent.insertImageSettings.resize&&(r.EventHandler.add(this.parent.contentModule.getEditPanel(),r.Browser.touchStartEvent,this.resizeStart,this),r.EventHandler.add(this.parent.element.ownerDocument,"mousedown",this.onDocumentClick,this));var n=this.parent.iframeSettings.enable?this.parent.inputElement.ownerDocument:this.parent.inputElement;n.addEventListener("drop",this.dragDrop.bind(this),!0);n.addEventListener("dragstart",this.dragStart.bind(this),!0);n.addEventListener("dragenter",this.dragOver.bind(this),!0);n.addEventListener("dragover",this.dragOver.bind(this),!0)},n.prototype.undoStack=function(n){var i,t,e,u,f;if("undo"===n.subCommand.toLowerCase()||"redo"===n.subCommand.toLowerCase())for(i=0;i<this.parent.formatter.getUndoRedoStack().length;i++)if(t=this.parent.createElement("div"),e=ci(this.parent.formatter.getUndoRedoStack()[i].text),t.appendChild(e),u=t.querySelectorAll("img"),t.querySelector(".e-img-resize")&&u.length>0){for(f=0;f<u.length;f++)u[f].style.outline="";Object(r.detach)(t.querySelector(".e-img-resize"));this.parent.formatter.getUndoRedoStack()[i].text=t.innerHTML}},n.prototype.resizeEnd=function(n){this.resizeBtnInit();this.imgEle.parentElement.style.cursor="auto";r.Browser.isDevice&&Object(r.removeClass)([n.target.parentElement],"e-mob-span");var t=Object(r.isBlazor)()?{requestType:"images"}:{event:n,requestType:"images"};this.parent.trigger(ne,t);this.getPointX(n);this.parent.iframeSettings.enable?(window.pageYOffset,this.parent.element.getBoundingClientRect().top,n.clientY):n.pageY;this.parent.formatter.editorManager.observer.on(pe,this.undoStack,this);this.parent.formatter.saveData()},n.prototype.resizeStart=function(n,t){var e=this,i,u,f;this.parent.readonly||(i=t||n.target,"IMG"===i.tagName&&(this.parent.preventDefaultResize(n),u=i,this.imgResizeDiv&&this.contentModule.getEditPanel().contains(this.imgResizeDiv)&&Object(r.detach)(this.imgResizeDiv),this.imageResize(u)),i.classList.contains("e-rte-imageboxmark")&&((0===this.parent.formatter.getUndoRedoStack().length&&this.parent.formatter.saveData(),this.pageX=this.getPointX(n),this.pageY=this.getPointY(n),n.preventDefault(),n.stopImmediatePropagation(),this.resizeBtnInit(),this.quickToolObj&&this.quickToolObj.imageQTBar.hidePopup(),i.classList.contains("e-rte-topLeft")&&(this.resizeBtnStat.topLeft=!0),i.classList.contains("e-rte-topRight")&&(this.resizeBtnStat.topRight=!0),i.classList.contains("e-rte-botLeft")&&(this.resizeBtnStat.botLeft=!0),i.classList.contains("e-rte-botRight")&&(this.resizeBtnStat.botRight=!0),r.Browser.isDevice&&this.contentModule.getEditPanel().contains(this.imgResizeDiv)&&!this.imgResizeDiv.classList.contains("e-mob-span"))?Object(r.addClass)([this.imgResizeDiv],"e-mob-span"):(f=Object(r.isBlazor)()?{requestType:"images"}:{event:n,requestType:"images"},this.parent.trigger(df,f,function(n){n.cancel&&e.cancelResizeAction()})),r.EventHandler.add(this.contentModule.getDocument(),r.Browser.touchEndEvent,this.resizeEnd,this)))},n.prototype.imageClick=function(n){r.Browser.isDevice&&("IMG"===n.target.tagName&&"A"===n.target.parentElement.tagName||"IMG"===n.target.tagName?(this.contentModule.getEditPanel().setAttribute("contenteditable","false"),n.target.focus()):this.parent.readonly||this.contentModule.getEditPanel().setAttribute("contenteditable","true"));"IMG"===n.target.tagName&&"A"===n.target.parentElement.tagName&&n.preventDefault()},n.prototype.imageResize=function(n){this.resizeBtnInit();this.imgEle=n;Object(r.addClass)([this.imgEle],"e-resize");this.imgResizeDiv=this.parent.createElement("span",{className:"e-img-resize",id:this.rteID+"_imgResize"});this.imgResizeDiv.appendChild(this.parent.createElement("span",{className:"e-rte-imageboxmark e-rte-topLeft",styles:"cursor: nwse-resize"}));this.imgResizeDiv.appendChild(this.parent.createElement("span",{className:"e-rte-imageboxmark e-rte-topRight",styles:"cursor: nesw-resize"}));this.imgResizeDiv.appendChild(this.parent.createElement("span",{className:"e-rte-imageboxmark e-rte-botLeft",styles:"cursor: nesw-resize"}));this.imgResizeDiv.appendChild(this.parent.createElement("span",{className:"e-rte-imageboxmark e-rte-botRight",styles:"cursor: nwse-resize"}));r.Browser.isDevice&&Object(r.addClass)([this.imgResizeDiv],"e-mob-rte");n.style.outline="2px solid #4a90e2";this.imgResizePos(n,this.imgResizeDiv);this.resizeImgDupPos(n);this.contentModule.getEditPanel().appendChild(this.imgResizeDiv);r.EventHandler.add(this.contentModule.getDocument(),r.Browser.touchMoveEvent,this.resizing,this)},n.prototype.getPointX=function(n){return n.touches&&n.touches.length?n.touches[0].pageX:n.pageX},n.prototype.getPointY=function(n){return n.touches&&n.touches.length?n.touches[0].pageY:n.pageY},n.prototype.imgResizePos=function(n,t){var e=this.calcPos(n),u=e.top,f=e.left,o=n.width,s=n.height,i=r.Browser.isDevice?4*parseInt(n.style.outline.slice(-3),10)+2:2*parseInt(n.style.outline.slice(-3),10)+2,h=r.Browser.isDevice?0:2;t.querySelector(".e-rte-botLeft").style.left=f-i+"px";t.querySelector(".e-rte-botLeft").style.top=s-i+u+"px";t.querySelector(".e-rte-botRight").style.left=o-(i-h)+f+"px";t.querySelector(".e-rte-botRight").style.top=s-i+u+"px";t.querySelector(".e-rte-topRight").style.left=o-(i-h)+f+"px";t.querySelector(".e-rte-topRight").style.top=u-i+"px";t.querySelector(".e-rte-topLeft").style.left=f-i+"px";t.querySelector(".e-rte-topLeft").style.top=u-i+"px"},n.prototype.calcPos=function(n){for(var i={top:0,left:0},f=n.getBoundingClientRect(),u=n.ownerDocument,t=(n.offsetParent&&(n.offsetParent.classList.contains("e-img-caption")||["TD","TH","TABLE","A"].indexOf(n.offsetParent.tagName)>-1)?Object(r.closest)(n,"#"+this.parent.getID()+"_rte-edit-view"):n.offsetParent)||u.documentElement;t&&(t===u.body||t===u.documentElement)&&"static"===t.style.position;)t=t.parentNode;return t&&t!==n&&1===t.nodeType&&(i=t.getBoundingClientRect()),{top:f.top-i.top,left:f.left-i.left}},n.prototype.setAspectRatio=function(n,t,i){if(!Object(r.isNullOrUndefined)(n.width)){var u=""!==n.style.width?parseInt(n.style.width,10):n.width,f=""!==n.style.height?parseInt(n.style.height,10):n.height;u>f?this.parent.insertImageSettings.resizeByPercent?(n.style.width=this.pixToPerc(u/f*i,n.previousElementSibling||n.parentElement)+"%",n.style.height=null,n.removeAttribute("height")):""!==n.style.width?(n.style.width=u/f*i+"px",n.style.height=i+"px"):(n.setAttribute("width",(u/f*i).toString()),n.setAttribute("height",i.toString())):f>u?this.parent.insertImageSettings.resizeByPercent?(n.style.width=this.pixToPerc(t,n.previousElementSibling||n.parentElement)+"%",n.style.height=null,n.removeAttribute("height")):""!==n.style.width?(n.style.width=t+"px",n.style.height=f/u*t+"px"):(n.setAttribute("width",t.toString()),n.setAttribute("height",(f/u*t).toString())):this.parent.insertImageSettings.resizeByPercent?(n.style.width=this.pixToPerc(t,n.previousElementSibling||n.parentElement)+"%",n.style.height=null,n.removeAttribute("height")):""!==n.style.width?(n.style.width=t+"px",n.style.height=t+"px"):(n.setAttribute("width",t.toString()),n.setAttribute("height",t.toString()))}},n.prototype.pixToPerc=function(n,t){return n/parseFloat(getComputedStyle(t).width)*100},n.prototype.imgDupMouseMove=function(n,t,i){var u=this,f=Object(r.isBlazor)()?{requestType:"images"}:{event:i,requestType:"images"};this.parent.trigger(gf,f,function(i){if(i.cancel)u.cancelResizeAction();else{if(parseInt(u.parent.insertImageSettings.minWidth,10)>=parseInt(n,10)||parseInt(u.parent.insertImageSettings.maxWidth,10)<=parseInt(n,10))return;if(!u.parent.insertImageSettings.resizeByPercent&&(parseInt(u.parent.insertImageSettings.minHeight,10)>=parseInt(t,10)||parseInt(u.parent.insertImageSettings.maxHeight,10)<=parseInt(t,10)))return;u.imgEle.parentElement.style.cursor="pointer";u.setAspectRatio(u.imgEle,parseInt(n,10),parseInt(t,10));u.resizeImgDupPos(u.imgEle);u.imgResizePos(u.imgEle,u.imgResizeDiv);u.parent.setContentHeight("",!1)}})},n.prototype.resizing=function(n){var t=this.getPointX(n),i=this.getPointY(n),r=this.resizeBtnStat.botLeft||this.resizeBtnStat.topLeft?-(t-this.pageX):t-this.pageX,u=this.resizeBtnStat.topLeft||this.resizeBtnStat.topRight?-(i-this.pageY):i-this.pageY,f=parseInt(this.imgDupPos.width,10)+r,e=parseInt(this.imgDupPos.height,10)+u;this.pageX=t;this.pageY=i;(this.resizeBtnStat.botRight||this.resizeBtnStat.botLeft||this.resizeBtnStat.topRight||this.resizeBtnStat.topLeft)&&this.imgDupMouseMove(f+"px",e+"px",n)},n.prototype.cancelResizeAction=function(){r.EventHandler.remove(this.contentModule.getDocument(),r.Browser.touchMoveEvent,this.resizing);r.EventHandler.remove(this.contentModule.getDocument(),r.Browser.touchEndEvent,this.resizeEnd);this.imgEle&&this.imgResizeDiv&&this.contentModule.getEditPanel().contains(this.imgResizeDiv)&&(Object(r.detach)(this.imgResizeDiv),this.imgEle.style.outline="",this.imgResizeDiv=null,this.pageX=null,this.pageY=null)},n.prototype.resizeImgDupPos=function(n){this.imgDupPos={width:""!==n.style.height?this.imgEle.style.width:n.width+"px",height:""!==n.style.height?this.imgEle.style.height:n.height+"px"}},n.prototype.resizeBtnInit=function(){return this.resizeBtnStat={botLeft:!1,botRight:!1,topRight:!1,topLeft:!1}},n.prototype.onToolbarAction=function(n){switch(d()&&this.parent.notify(rt,{}),n.args.item.subCommand){case"Replace":this.parent.notify(rr,n);break;case"Caption":this.parent.notify(oe,n);break;case"InsertLink":this.parent.notify(ue,n);break;case"AltText":this.parent.notify(fe,n);break;case"Remove":this.parent.notify(ee,n);break;case"Dimension":this.parent.notify(se,n);break;case"OpenImageLink":this.openImgLink(n);break;case"EditImageLink":this.editImgLink(n);break;case"RemoveImageLink":this.removeImgLink(n)}},n.prototype.openImgLink=function(n){var t=""===n.selectParent[0].parentNode.target?"_self":"_blank";this.parent.formatter.process(this.parent,n.args,n.args,{url:n.selectParent[0].parentNode.href,target:t,selectNode:n.selectNode,subCommand:n.args.item.subCommand})},n.prototype.editImgLink=function(n){var t=n.selectParent[0].parentNode,i=this.i10n.getConstant("dialogUpdate"),r={url:t.href,target:t.target,header:"Edit Link",btnText:i};this.insertImgLink(n,r)},n.prototype.removeImgLink=function(n){r.Browser.isIE&&this.contentModule.getEditPanel().focus();n.selection.restore();var t=!(!this.contentModule.getEditPanel().contains(this.captionEle)||!Object(r.select)("a",this.captionEle)),i=t?[this.captionEle]:[n.selectNode[0].parentElement];this.parent.formatter.process(this.parent,n.args,n.args,{insertElement:n.selectNode[0],selectParent:i,selection:n.selection,subCommand:n.args.item.subCommand});this.quickToolObj&&document.body.contains(this.quickToolObj.imageQTBar.element)&&(this.quickToolObj.imageQTBar.hidePopup(),Object(r.isNullOrUndefined)(n.selectParent)||Object(r.removeClass)([n.selectParent[0]],"e-img-focus"));t&&Object(r.select)(".e-img-inner",this.captionEle).focus()},n.prototype.onKeyDown=function(n){var e,o,u,i,t=n.args,f,s;!Object(r.isNullOrUndefined)(this.parent.formatter.editorManager.nodeSelection)&&(e=this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument()),o=this.parent.formatter.editorManager.nodeSelection.save(e,this.parent.contentModule.getDocument()),u=this.parent.formatter.editorManager.nodeSelection.getNodeCollection(e),i=this.parent.formatter.editorManager.nodeSelection.getParentNodeCollection(e),!t.ctrlKey&&t.key&&(1===t.key.length||"enter"===t.action)&&"IMG"===i[0].tagName&&i[0].parentElement)&&(f=i[0].parentElement.childNodes[0],this.contentModule.getEditPanel().querySelector(".e-img-resize")&&this.remvoeResizEle(),this.parent.formatter.editorManager.nodeSelection.setSelectionText(this.contentModule.getDocument(),f,f,f.textContent.length,f.textContent.length),Object(r.removeClass)([i[0]],"e-img-focus"),this.quickToolObj.imageQTBar.hidePopup());(!t.ctrlKey||89!==t.keyCode&&90!==t.keyCode||this.undoStack({subCommand:90===t.keyCode?"undo":"redo"}),8===t.keyCode||46===t.keyCode)&&(u&&"IMG"===u[0].nodeName&&(t.preventDefault(),s={selectNode:u,selection:o,selectParent:i,args:{item:{command:"Images",subCommand:"Remove"},originalEvent:t}},this.deleteImg(s)),this.contentModule.getEditPanel().querySelector(".e-img-resize")&&this.remvoeResizEle());switch(t.action){case"escape":Object(r.isNullOrUndefined)(this.dialogObj)||this.dialogObj.close();break;case"insert-image":"HTML"===this.parent.editorMode?this.insertImage({args:{item:{command:"Images",subCommand:"Image"},originalEvent:t},selectNode:u,selection:o,selectParent:i}):this.insertImage({args:{item:{command:"Images",subCommand:"Image"},originalEvent:t},member:"image",text:this.parent.formatter.editorManager.markdownSelection.getSelectedText(this.parent.contentModule.getEditPanel()),module:"Markdown",name:"insertImage"});t.preventDefault()}},n.prototype.alignmentSelect=function(n){var u=n.item;if(document.body.contains(document.body.querySelector(".e-rte-quick-toolbar"))&&"Images"===u.command){var f=this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument()),i=this.parent.formatter.editorManager.nodeSelection.getNodeCollection(f),t={args:n,selectNode:i="IMG"===i[0].nodeName?i:[this.imgEle]};switch(0===this.parent.formatter.getUndoRedoStack().length&&this.parent.formatter.saveData(),u.subCommand){case"JustifyLeft":this.justifyImageLeft(t);break;case"JustifyCenter":this.justifyImageCenter(t);break;case"JustifyRight":this.justifyImageRight(t);break;case"Inline":this.inline(t);break;case"Break":this.break(t)}this.quickToolObj&&document.body.contains(this.quickToolObj.imageQTBar.element)&&(this.quickToolObj.imageQTBar.hidePopup(),Object(r.removeClass)([i[0]],"e-img-focus"));this.cancelResizeAction()}},n.prototype.imageWithLinkQTBarItemUpdate=function(){for(var i,t=this.quickToolObj.imageQTBar.toolbarElement.querySelectorAll(".e-toolbar-item"),n=0;n<t.length;n++)t[n].getAttribute("title")===this.i10n.getConstant("openLink")||t[n].getAttribute("title")===this.i10n.getConstant("editLink")||t[n].getAttribute("title")===this.i10n.getConstant("removeLink")?(Object(r.addClass)([t[n]],"e-link-groups"),t[n].style.display="none"):"Insert Link"===t[n].getAttribute("title")?t[n].style.display="":t[n].classList.contains("e-rte-horizontal-separator")&&(t[n],Object(r.detach)(t[n]));i=this.quickToolObj.imageQTBar.toolbarElement.querySelectorAll(".e-toolbar-item:not(.e-link-groups)");this.quickToolObj.imageQTBar.addQTBarItem(["-"],Math.round(i.length/2))},n.prototype.showImageQuickToolbar=function(n){var f=this,i,t,u;"Images"!==n.type||Object(r.isNullOrUndefined)(this.parent.quickToolbarModule)||Object(r.isNullOrUndefined)(this.parent.quickToolbarModule.imageQTBar)||(this.quickToolObj=this.parent.quickToolbarModule,i=n.args,t=n.elements,[].forEach.call(n.elements,function(n,i){0===i&&(t=n)}),t&&!Object(r.closest)(t,"a")&&this.imageWithLinkQTBarItemUpdate(),"IMG"===t.nodeName&&Object(r.addClass)([t],["e-img-focus"]),u=this.parent.iframeSettings.enable?window.pageYOffset+this.parent.element.getBoundingClientRect().top+i.clientY:i.pageY,this.parent.quickToolbarModule.imageQTBar&&(n.isNotify?setTimeout(function(){f.quickToolObj.imageQTBar.showPopup(i.pageX,u,t)},400):this.quickToolObj.imageQTBar.showPopup(i.pageX,u,t)))},n.prototype.hideImageQuickToolbar=function(){Object(r.isNullOrUndefined)(this.contentModule.getEditPanel().querySelector(".e-img-focus"))||(Object(r.removeClass)([this.contentModule.getEditPanel().querySelector(".e-img-focus")],"e-img-focus"),this.quickToolObj&&this.quickToolObj.imageQTBar&&document.body.contains(this.quickToolObj.imageQTBar.element)&&this.quickToolObj.imageQTBar.hidePopup())},n.prototype.editAreaClickHandler=function(n){var u,e,f,s,i,t,h;if(this.parent.readonly)this.hideImageQuickToolbar();else if(u=n.args,e=this.parent.quickToolbarSettings.showOnRightClick,2===u.which||e&&1===u.which||!e&&3===u.which)e&&1===u.which&&!Object(r.isNullOrUndefined)(u.target)&&"IMG"===u.target.tagName&&(this.parent.formatter.editorManager.nodeSelection.Clear(this.contentModule.getDocument()),this.parent.formatter.editorManager.nodeSelection.setSelectionContents(this.contentModule.getDocument(),u.target));else if("HTML"===this.parent.editorMode&&this.parent.quickToolbarModule&&this.parent.quickToolbarModule.imageQTBar)if(this.quickToolObj=this.parent.quickToolbarModule,f=u.target,this.contentModule=this.rendererFactory.getRenderer(o.Content),s=this.quickToolObj.imageQTBar.element.classList.contains("e-rte-pop"),"IMG"===f.nodeName&&this.parent.quickToolbarModule){if(s)return;if(this.parent.formatter.editorManager.nodeSelection.Clear(this.contentModule.getDocument()),this.parent.formatter.editorManager.nodeSelection.setSelectionContents(this.contentModule.getDocument(),f),d()&&this.parent.notify(ht,n),Object(r.addClass)([f],"e-img-focus"),i=this.quickToolObj.imageQTBar.toolbarElement.querySelectorAll(".e-toolbar-item"),Object(r.closest)(f,"a")){for(t=0;t<i.length;t++)i[t].getAttribute("title")===this.i10n.getConstant("openLink")||i[t].getAttribute("title")===this.i10n.getConstant("editLink")||i[t].getAttribute("title")===this.i10n.getConstant("removeLink")?(i[t].style.display="",Object(r.removeClass)([i[t]],"e-link-groups")):"Insert Link"===i[t].getAttribute("title")?i[t].style.display="none":i[t].classList.contains("e-rte-horizontal-separator")&&(i[t],Object(r.detach)(i[t]));h=this.quickToolObj.imageQTBar.toolbarElement.querySelectorAll(".e-toolbar-item:not(.e-link-groups)");this.quickToolObj.imageQTBar.addQTBarItem(["-"],Math.round(h.length/2))}else Object(r.closest)(f,"a")||this.imageWithLinkQTBarItemUpdate();this.showImageQuickToolbar({args:u,type:"Images",elements:[u.target]})}else this.hideImageQuickToolbar()},n.prototype.insertImgLink=function(n,t){var o=this,i,u;if("IMG"===n.selectNode[0].nodeName&&(this.imagDialog(n),!Object(r.isNullOrUndefined)(this.dialogObj))){i=this.parent.createElement("div",{className:"e-img-linkwrap"});u=ci('<div class="e-rte-field"><input type="text" data-role ="none" class="e-input e-img-link" spellcheck="false" placeholder="'+this.i10n.getConstant("linkurl")+'"/><\/div><div class="e-rte-label"><\/div><div class="e-rte-field"><input type="checkbox" class="e-rte-linkTarget"  data-role ="none"><\/div>');i.appendChild(u);var s=i.querySelector(".e-rte-linkTarget"),f=i.querySelector(".e-img-link"),h=this.i10n.getConstant("linkOpenInNewWindow");this.checkBoxObj=new nr.CheckBox({label:h,checked:!0,enableRtl:this.parent.enableRtl,change:function(n){e=n.checked?"_blank":null}});this.checkBoxObj.isStringTemplate=!0;this.checkBoxObj.createElement=this.parent.createElement;this.checkBoxObj.appendTo(s);var e=this.checkBoxObj.checked?"_blank":null,c=this.i10n.getConstant("dialogUpdate"),l={args:n.args,selfImage:this,selection:n.selection,selectNode:n.selectNode,selectParent:n.selectParent,link:f,target:e};this.dialogObj.setProperties({height:"inherit",width:"290px",header:this.parent.localeObj.getConstant("imageInsertLinkHeader"),content:i,position:{X:"center",Y:"center"},buttons:[{click:function(){o.insertlink(l)},buttonModel:{content:c,cssClass:"e-flat e-update-link",isPrimary:!0}}]});Object(r.isNullOrUndefined)(t)||(f.value=t.url,this.checkBoxObj.checked=t.target?!0:!1,this.dialogObj.header=t.header);this.dialogObj.element.style.maxHeight="inherit";this.dialogObj.content.querySelector("input").focus()}},n.prototype.insertAltText=function(n){var e=this,i,u,f;if("IMG"===n.selectNode[0].nodeName&&(this.imagDialog(n),i=this.i10n.getConstant("altText"),!Object(r.isNullOrUndefined)(this.dialogObj))){var t=this.parent.createElement("div",{className:"e-img-altwrap"}),o=this.i10n.getConstant("alternateHeader"),s=this.i10n.getConstant("dialogUpdate"),h=ci('<div class="e-rte-field"><input type="text" spellcheck="false" value="'+(null===n.selectNode[0].getAttribute("alt")?"":n.selectNode[0].getAttribute("alt"))+'" class="e-input e-img-alt" placeholder="'+i+'"/><\/div>');t.appendChild(h);u=t.querySelector(".e-img-alt");f={args:n.args,selfImage:this,selection:n.selection,selectNode:n.selectNode,alt:u};this.dialogObj.setProperties({height:"inherit",width:"290px",header:o,content:t,position:{X:"center",Y:"center"},buttons:[{click:function(){e.insertAlt(f)},buttonModel:{content:s,cssClass:"e-flat e-update-alt",isPrimary:!0}}]});this.dialogObj.element.style.maxHeight="inherit";this.dialogObj.content.querySelector("input").focus()}},n.prototype.insertAlt=function(n){if(!Object(r.isNullOrUndefined)(n.alt)){n.selection.restore();0===this.parent.formatter.getUndoRedoStack().length&&this.parent.formatter.saveData();var t=n.alt.value;this.parent.formatter.process(this.parent,n.args,n.args,{altText:t,selectNode:n.selectNode,subCommand:n.args.item.subCommand});this.dialogObj.hide({returnValue:!1})}},n.prototype.insertlink=function(n){var i,t,u;if("IMG"===n.selectNode[0].nodeName){if(i=n.link.value,""===i)return Object(r.addClass)([n.link],"e-error"),n.link.setSelectionRange(0,i.length),void n.link.focus();if(this.isUrl(i)?Object(r.removeClass)([n.link],"e-error"):i="http://"+i,t=n.selfImage,"HTML"===t.parent.editorMode&&n.selection.restore(),0===t.parent.formatter.getUndoRedoStack().length&&t.parent.formatter.saveData(),"A"===n.selectNode[0].parentElement.nodeName)return t.parent.formatter.process(t.parent,n.args,n.args,{url:i,target:t.checkBoxObj.checked?"_blank":null,selectNode:n.selectNode,subCommand:n.args.item.subCommand}),void t.dialogObj.hide({returnValue:!0});t.parent.formatter.process(t.parent,n.args,n.args,{url:i,target:t.checkBoxObj.checked?"_blank":null,selectNode:n.selectNode,subCommand:n.args.item.subCommand,selection:n.selection});u=Object(r.closest)(n.selectNode[0],".e-img-caption");u&&Object(r.select)(".e-img-inner",u).focus();t.dialogObj.hide({returnValue:!1})}},n.prototype.isUrl=function(n){return/(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/gi.test(n)},n.prototype.deleteImg=function(n){"IMG"===n.selectNode[0].nodeName&&(0===this.parent.formatter.getUndoRedoStack().length&&this.parent.formatter.saveData(),n.selection.restore(),this.contentModule.getEditPanel().querySelector(".e-img-resize")&&this.remvoeResizEle(),this.parent.formatter.process(this.parent,n.args,n.args,{selectNode:n.selectNode,captionClass:ku,subCommand:n.args.item.subCommand}),this.quickToolObj&&document.body.contains(this.quickToolObj.imageQTBar.element)&&this.quickToolObj.imageQTBar.hidePopup(),this.cancelResizeAction())},n.prototype.caption=function(n){var t=n.selectNode[0],u,o;if("IMG"===t.nodeName){if(n.selection.restore(),0===this.parent.formatter.getUndoRedoStack().length&&this.parent.formatter.saveData(),this.cancelResizeAction(),Object(r.addClass)([t],"e-rte-image"),u=n.args.item?n.args.item.subCommand:"Caption",Object(r.isNullOrUndefined)(Object(r.closest)(t,"."+ku))){this.captionEle=this.parent.createElement("span",{className:ku+" "+ca,attrs:{contenteditable:"false",draggable:"false"}});var e=this.parent.createElement("span",{className:"e-img-wrap"}),i=this.parent.createElement("span",{className:"e-img-inner",attrs:{contenteditable:"true"}}),f=n.selectNode[0].parentElement;"A"===f.tagName&&f.setAttribute("contenteditable","true");e.appendChild("A"===f.tagName?f:n.selectNode[0]);e.appendChild(i);o=this.i10n.getConstant("imageCaption");i.innerHTML=o;this.captionEle.appendChild(e);t.classList.contains(kr)&&Object(r.addClass)([this.captionEle],la);t.classList.contains(br)&&Object(r.addClass)([this.captionEle],br);t.classList.contains(oh)&&Object(r.addClass)([this.captionEle],oh);t.classList.contains(eh)&&Object(r.addClass)([this.captionEle],eh);t.classList.contains(sh)&&Object(r.addClass)([this.captionEle],sh);this.parent.formatter.process(this.parent,n.args,n.args,{insertElement:this.captionEle,selectNode:n.selectNode,subCommand:u});this.parent.formatter.editorManager.nodeSelection.setSelectionText(this.contentModule.getDocument(),i.childNodes[0],i.childNodes[0],0,i.childNodes[0].textContent.length)}else Object(r.detach)(Object(r.closest)(t,"."+ku)),r.Browser.isIE&&(this.contentModule.getEditPanel().focus(),n.selection.restore()),"A"===t.parentElement.tagName?this.parent.formatter.process(this.parent,n.args,n.args,{insertElement:t.parentElement,selectNode:n.selectNode,subCommand:u}):this.parent.formatter.process(this.parent,n.args,n.args,{insertElement:t,selectNode:n.selectNode,subCommand:u});this.quickToolObj&&document.body.contains(this.quickToolObj.imageQTBar.element)&&(this.quickToolObj.imageQTBar.hidePopup(),Object(r.removeClass)([t],"e-img-focus"))}},n.prototype.imageSize=function(n){var t=this;if("IMG"===n.selectNode[0].nodeName&&(this.imagDialog(n),!Object(r.isNullOrUndefined)(this.dialogObj))){var i=this.i10n.getConstant("imageSizeHeader"),u=this.i10n.getConstant("dialogUpdate"),f=this.imgsizeInput(n),e={args:n.args,selfImage:this,selection:n.selection,selectNode:n.selectNode};this.dialogObj.setProperties({height:"inherit",width:"290px",header:i,content:f,position:{X:"center",Y:"center"},buttons:[{click:function(){t.insertSize(e)},buttonModel:{content:u,cssClass:"e-flat e-update-size",isPrimary:!0}}]});this.dialogObj.element.style.maxHeight="inherit";this.dialogObj.content.querySelector("input").focus()}},n.prototype.break=function(n){if("IMG"===n.selectNode[0].nodeName){var t=n.args.item?n.args.item.subCommand:"Break";this.parent.formatter.process(this.parent,n.args,n.args,{selectNode:n.selectNode,subCommand:t})}},n.prototype.inline=function(n){if("IMG"===n.selectNode[0].nodeName){var t=n.args.item?n.args.item.subCommand:"Inline";this.parent.formatter.process(this.parent,n.args,n.args,{selectNode:n.selectNode,subCommand:t})}},n.prototype.justifyImageLeft=function(n){var t=n.args.item?n.args.item.subCommand:"JustifyLeft";this.parent.formatter.process(this.parent,n.args,n.args,{selectNode:n.selectNode,subCommand:t})},n.prototype.justifyImageRight=function(n){var t=n.args.item?n.args.item.subCommand:"JustifyRight";this.parent.formatter.process(this.parent,n.args,n.args,{selectNode:n.selectNode,subCommand:t})},n.prototype.justifyImageCenter=function(n){var t=n.args.item?n.args.item.subCommand:"JustifyCenter";this.parent.formatter.process(this.parent,n.args,n.args,{selectNode:n.selectNode,subCommand:t})},n.prototype.imagDialog=function(n){var t=this,u,e,o;if(this.dialogObj)this.dialogObj.hide({returnValue:!0});else{u=this.parent.createElement("div",{className:"e-rte-img-dialog",id:this.rteID+"_image"});this.parent.element.appendChild(u);var s=this.i10n.getConstant("dialogInsert"),h=this.i10n.getConstant("dialogCancel"),c=this.i10n.getConstant("imageHeader"),l=n.selection,a={selfImage:this,selection:n.selection,args:n.args,selectParent:n.selectParent},f={header:c,cssClass:b,enableRtl:this.parent.enableRtl,locale:this.parent.locale,showCloseIcon:!0,closeOnEscape:!0,width:r.Browser.isDevice?"290px":"340px",height:"inherit",position:{X:"center",Y:r.Browser.isDevice?"center":"top"},isModal:r.Browser.isDevice,buttons:[{click:this.insertImageUrl.bind(a),buttonModel:{content:s,cssClass:"e-flat e-insertImage",isPrimary:!0}},{click:function(n){t.cancelDialog(n)},buttonModel:{cssClass:"e-flat e-cancel",content:h}}],target:r.Browser.isDevice?document.body:this.parent.element,animationSettings:{effect:"None"},close:function(n){t.parent.isBlur=!1;n&&n.event.returnValue&&("HTML"===t.parent.editorMode?l.restore():t.parent.formatter.editorManager.markdownSelection.restore(t.parent.contentModule.getEditPanel()));t.dialogObj.destroy();Object(r.detach)(t.dialogObj.element);t.dialogRenderObj.close(n);t.dialogObj=null}},i=this.parent.createElement("div",{className:"e-img-content"});(Object(r.isNullOrUndefined)(this.parent.insertImageSettings.path)||"Markdown"!==this.parent.editorMode)&&"HTML"!==this.parent.editorMode||i.appendChild(this.imgUpload(n));e=this.parent.createElement("div",{className:"e-linkheader"});o=this.i10n.getConstant("imageLinkHeader");e.innerHTML="HTML"===this.parent.editorMode?o:this.i10n.getConstant("mdimageLink");i.appendChild(e);i.appendChild(this.imageUrlPopup(n));n.selectNode&&"IMG"===n.selectNode[0].nodeName?(f.header=this.parent.localeObj.getConstant("editImageHeader"),f.content=i):f.content=i;this.dialogObj=this.dialogRenderObj.render(f);this.dialogObj.createElement=this.parent.createElement;this.dialogObj.appendTo(u);n.selectNode&&"IMG"===n.selectNode[0].nodeName&&"insertImage"===n.name&&(this.dialogObj.element.querySelector(".e-insertImage").textContent=this.parent.localeObj.getConstant("dialogUpdate"));u.style.maxHeight="inherit";this.quickToolObj&&(this.quickToolObj.imageQTBar&&document.body.contains(this.quickToolObj.imageQTBar.element)&&(this.quickToolObj.imageQTBar.hidePopup(),Object(r.isNullOrUndefined)(n.selectParent)||Object(r.removeClass)([n.selectParent[0]],"e-img-focus")),this.quickToolObj.inlineQTBar&&document.body.contains(this.quickToolObj.inlineQTBar.element)&&this.quickToolObj.inlineQTBar.hidePopup())}},n.prototype.cancelDialog=function(){this.parent.isBlur=!1;this.dialogObj.hide({returnValue:!0})},n.prototype.onDocumentClick=function(n){var t=n.target;"IMG"===t.nodeName&&(this.imgEle=t);!Object(r.isNullOrUndefined)(this.dialogObj)&&(!Object(r.closest)(t,"#"+this.dialogObj.element.id)&&this.parent.toolbarSettings.enable&&this.parent.getToolbarElement()&&!this.parent.getToolbarElement().contains(n.target)||this.parent.getToolbarElement()&&this.parent.getToolbarElement().contains(n.target)&&!Object(r.closest)(t,"#"+this.parent.getID()+"_toolbar_Image")&&!t.querySelector("#"+this.parent.getID()+"_toolbar_Image"))&&(this.dialogObj.hide({returnValue:!0}),this.parent.isBlur=!0,uu(this.parent.element,"focusout"));"IMG"===n.target.tagName||!this.imgResizeDiv||this.quickToolObj&&this.quickToolObj.imageQTBar&&this.quickToolObj.imageQTBar.element.contains(n.target)||!this.contentModule.getEditPanel().contains(this.imgResizeDiv)||this.cancelResizeAction();"IMG"!==t.tagName&&this.contentModule.getEditPanel().querySelector(".e-img-resize")&&(this.remvoeResizEle(),this.contentModule.getEditPanel().querySelector("img").style.outline="")},n.prototype.remvoeResizEle=function(){r.EventHandler.remove(this.contentModule.getDocument(),r.Browser.touchMoveEvent,this.resizing);r.EventHandler.remove(this.contentModule.getDocument(),r.Browser.touchEndEvent,this.resizeEnd);Object(r.detach)(this.contentModule.getEditPanel().querySelector(".e-img-resize"))},n.prototype.imageUrlPopup=function(){var n=this.parent.createElement("div",{className:"imgUrl"}),t=this.i10n.getConstant("imageUrl");return this.inputUrl=this.parent.createElement("input",{className:"e-input e-img-url",attrs:{placeholder:t,spellcheck:"false"}}),n.appendChild(this.inputUrl),n},n.prototype.insertImageUrl=function(){var n=this.selfImage,t=n.inputUrl.value,i;if(0===n.parent.formatter.getUndoRedoStack().length&&n.parent.formatter.saveData(),Object(r.isNullOrUndefined)(n.uploadUrl)||""===n.uploadUrl.url){if(""!==t){"HTML"===n.parent.editorMode&&Object(r.isNullOrUndefined)(Object(r.closest)(this.selection.range.startContainer.parentNode,"#"+n.contentModule.getPanel().id))&&(n.contentModule.getEditPanel().focus(),i=n.parent.formatter.editorManager.nodeSelection.getRange(n.contentModule.getDocument()),this.selection=n.parent.formatter.editorManager.nodeSelection.save(i,n.contentModule.getDocument()),this.selectParent=n.parent.formatter.editorManager.nodeSelection.getParentNodeCollection(i));var u=/[\w-]+.(jpg|png|jpeg|gif)/g,f=Object(r.isNullOrUndefined)(t.match(u))||"HTML"!==n.parent.editorMode?"":t.match(u)[0],e={cssClass:"inline"===n.parent.insertImageSettings.display?kr:br,url:t,selection:this.selection,altText:f,selectParent:this.selectParent,width:{width:n.parent.insertImageSettings.width,minWidth:n.parent.insertImageSettings.minWidth,maxWidth:n.parent.insertImageSettings.maxWidth},height:{height:n.parent.insertImageSettings.height,minHeight:n.parent.insertImageSettings.minHeight,maxHeight:n.parent.insertImageSettings.maxHeight}};n.parent.formatter.process(n.parent,this.args,this.args.originalEvent,e);n.dialogObj.hide({returnValue:!1})}}else n.uploadUrl.cssClass="inline"===n.parent.insertImageSettings.display?kr:br,n.dialogObj.hide({returnValue:!1}),n.parent.formatter.process(n.parent,this.args,this.args.originalEvent,n.uploadUrl),n.uploadUrl.url="",n.contentModule.getEditPanel().querySelector(".e-img-resize")&&(n.imgEle.style.outline="",n.remvoeResizEle())},n.prototype.imgsizeInput=function(n){var t=n.selectNode[0],e=this.i10n.getConstant("imageHeight"),o=this.i10n.getConstant("imageWidth"),i=this.parent.createElement("div",{className:"e-img-sizewrap"}),s=ci('<div class="e-rte-label"><label>'+o+'<\/label><\/div><div class="e-rte-field"><input type="text" data-role ="none" id="imgwidth" class="e-img-width" value='+("auto"===t.getAttribute("width")||Object(r.isNullOrUndefined)(t.getAttribute("width"))?t.width:t.getClientRects()[0].width)+' /><\/div><div class="e-rte-label"><label>'+e+'<\/label><\/div><div class="e-rte-field"> <input type="text" data-role ="none" id="imgheight" class="e-img-height" value='+("auto"===t.getAttribute("height")||Object(r.isNullOrUndefined)(t.getAttribute("height"))?t.height:t.getClientRects()[0].height)+" /><\/div>"),u,f;return i.appendChild(s),u=new et.NumericTextBox({format:"###.### px",min:this.parent.insertImageSettings.minWidth,max:this.parent.insertImageSettings.maxWidth,enableRtl:this.parent.enableRtl,locale:this.parent.locale}),u.isStringTemplate=!0,u.createElement=this.parent.createElement,u.appendTo(i.querySelector("#imgwidth")),f=new et.NumericTextBox({format:"###.### px",min:this.parent.insertImageSettings.minHeight,max:this.parent.insertImageSettings.maxHeight,enableRtl:this.parent.enableRtl,locale:this.parent.locale}),f.isStringTemplate=!0,f.createElement=this.parent.createElement,f.appendTo(i.querySelector("#imgheight")),i},n.prototype.insertSize=function(n){var t;n.selection.restore();t=n.selfImage;0===t.parent.formatter.getUndoRedoStack().length&&t.parent.formatter.saveData();var i=t.dialogObj.element,r=parseFloat(i.querySelector(".e-img-width").value),u=parseFloat(i.parentElement.querySelector(".e-img-height").value);t.parent.formatter.process(this.parent,n.args,n.args,{width:r,height:u,selectNode:n.selectNode,subCommand:n.args.item.subCommand});this.imgResizeDiv&&t.imgResizePos(n.selectNode[0],this.imgResizeDiv);t.dialogObj.hide({returnValue:!0})},n.prototype.insertImage=function(n){if(this.imagDialog(n),!Object(r.isNullOrUndefined)(this.dialogObj)){this.dialogObj.element.style.maxHeight="inherit";var t=this.dialogObj.element.querySelector(".e-img-content");!Object(r.isNullOrUndefined)(this.parent.insertImageSettings.path)&&"Markdown"===this.parent.editorMode||"HTML"===this.parent.editorMode?t.querySelector("#"+this.rteID+"_insertImage").focus():t.querySelector(".e-img-url").focus()}},n.prototype.imgUpload=function(n){var f,e,i=this,t=this,v=t.parent.iframeSettings.enable,h,o,y,s,p,l,a;"HTML"===t.parent.editorMode&&(!v&&Object(r.isNullOrUndefined)(Object(r.closest)(n.selection.range.startContainer.parentNode,"#"+this.contentModule.getPanel().id))||v&&!tt(n.selection.range.startContainer.parentNode.ownerDocument.querySelector("body"),"e-lib"))?(this.contentModule.getEditPanel().focus(),h=this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument()),f=this.parent.formatter.editorManager.nodeSelection.save(h,this.parent.contentModule.getDocument()),e=this.parent.formatter.editorManager.nodeSelection.getParentNodeCollection(h)):(f=n.selection,e=n.selectParent);var c=this.parent.createElement("div",{className:"e-img-uploadwrap e-droparea"}),w=this.i10n.getConstant("imageDeviceUploadMessage"),b=this.i10n.getConstant("imageUploadMessage"),u=this.parent.createElement("span",{className:"e-droptext"}),k=this.parent.createElement("span",{className:"e-rte-upload-text",innerHTML:r.Browser.isDevice?w:b});return u.appendChild(k),o=this.parent.createElement("button",{className:"e-browsebtn",id:this.rteID+"_insertImage",attrs:{autofocus:"true",type:"button"}}),u.appendChild(o),c.appendChild(u),y=this.i10n.getConstant("browse"),s=new nr.Button({content:y,enableRtl:this.parent.enableRtl}),s.isStringTemplate=!0,s.createElement=this.parent.createElement,s.appendTo(o),p=r.Browser.isDevice?u:o,r.EventHandler.add(p,"click",this.fileSelect,this),a=this.parent.createElement("input",{id:this.rteID+"_upload",attrs:{type:"File",name:"UploadFiles"}}),c.appendChild(a),this.uploadObj=new et.Uploader({asyncSettings:{saveUrl:this.parent.insertImageSettings.saveUrl},dropArea:u,multiple:!1,enableRtl:this.parent.enableRtl,allowedExtensions:this.parent.insertImageSettings.allowedTypes.toString(),selected:function(n){i.parent.trigger(ea,n,function(n){if(i.checkExtension(n.filesData[0]),l=n.filesData[0].name,"HTML"===i.parent.editorMode&&Object(r.isNullOrUndefined)(i.parent.insertImageSettings.path)){var u=new FileReader;u.addEventListener("load",function(){var n="Base64"===i.parent.insertImageSettings.saveFormat?u.result:URL.createObjectURL(ef(u.result));t.uploadUrl={url:n,selection:f,altText:l,selectParent:e,width:{width:t.parent.insertImageSettings.width,minWidth:t.parent.insertImageSettings.minWidth,maxWidth:t.parent.insertImageSettings.maxWidth},height:{height:t.parent.insertImageSettings.height,minHeight:t.parent.insertImageSettings.minHeight,maxHeight:t.parent.insertImageSettings.maxHeight}};t.inputUrl.setAttribute("disabled","true")});u.readAsDataURL(n.filesData[0].rawFile)}})},uploading:function(n){i.parent.trigger(ys,n)},success:function(n){i.parent.trigger(be,n,function(n){if(!Object(r.isNullOrUndefined)(i.parent.insertImageSettings.path)){var u=i.parent.insertImageSettings.path+n.file.name;t.uploadUrl={url:u,selection:f,altText:l,selectParent:e,width:{width:t.parent.insertImageSettings.width,minWidth:t.parent.insertImageSettings.minWidth,maxWidth:t.parent.insertImageSettings.maxWidth},height:{height:t.parent.insertImageSettings.height,minHeight:t.parent.insertImageSettings.minHeight,maxHeight:t.parent.insertImageSettings.maxHeight}};t.inputUrl.setAttribute("disabled","true")}})},failure:function(n){i.parent.trigger(ke,n)},removing:function(){i.parent.trigger(oa,n,function(){t.inputUrl.removeAttribute("disabled");t.uploadUrl&&(t.uploadUrl.url="");i.dialogObj.getButtons(0).element.removeAttribute("disabled")})}}),this.uploadObj.isStringTemplate=!0,this.uploadObj.createElement=this.parent.createElement,this.uploadObj.appendTo(a),c},n.prototype.checkExtension=function(n){this.uploadObj.allowedExtensions&&-1===this.uploadObj.allowedExtensions.toLocaleLowerCase().indexOf(("."+n.type).toLocaleLowerCase())&&this.dialogObj.getButtons(0).element.setAttribute("disabled","disabled")},n.prototype.fileSelect=function(){return this.dialogObj.element.getElementsByClassName("e-file-select-wrap")[0].querySelector("button").click(),!1},n.prototype.dragStart=function(n){if("IMG"!==n.target.nodeName)return!0;this.parent.trigger(st,n,function(t){t.cancel?n.preventDefault():(n.dataTransfer.effectAllowed="copyMove",n.target.classList.add(tf))})},n.prototype.dragEnter=function(n){n.dataTransfer.dropEffect="copy";n.preventDefault()},n.prototype.dragOver=function(n){if(!("edge"===r.Browser.info.name&&n.dataTransfer.items[0].type.split("/")[0].indexOf("image")>-1||r.Browser.isIE&&"Files"===n.dataTransfer.types[0]))return!0;n.preventDefault()},n.prototype.dragDrop=function(n){var t=this,i=this.parent.inputElement.ownerDocument.querySelector("."+tf);if(!(i&&"IMG"===i.tagName||n.dataTransfer.files.length>0))return!0;this.parent.trigger(st,n,function(i){if(i.cancel)n.preventDefault();else{if(Object(r.closest)(n.target,"#"+t.parent.getID()+"_toolbar"))return void n.preventDefault();t.parent.element.querySelector("."+vv)&&Object(r.detach)(t.imgResizeDiv);n.preventDefault();var u=void 0;if(t.contentModule.getDocument().caretRangeFromPoint?u=t.contentModule.getDocument().caretRangeFromPoint(n.clientX,n.clientY):n.rangeParent?(u=t.contentModule.getDocument().createRange()).setStart(n.rangeParent,n.rangeOffset):u=t.getDropRange(n.clientX,n.clientY),t.parent.notify(yu,{range:u}),t.parent.element.querySelector("."+yv))return;t.insertDragImage(n)}})},n.prototype.getDropRange=function(n,t){var i=this.contentModule.getDocument().createRange(),e;this.parent.formatter.editorManager.nodeSelection.setRange(this.contentModule.getDocument(),i);var f=this.contentModule.getDocument().elementFromPoint(n,t),u=f.childNodes.length>0?f.childNodes[0]:f,r=0;if("<br>"===this.parent.inputElement.firstChild.innerHTML)i.setStart(u,r),i.setEnd(u,r);else{e=void 0;do r++,i.setStart(u,r),i.setEnd(u,r+1),e=i.getBoundingClientRect();while(e.left<n&&r<u.length-1)}return i},n.prototype.insertDragImage=function(n){var r,i,f,t;if(n.preventDefault(),r=this.parent.element.querySelector(""+ho),this.parent.notify(ps,{args:n}),r&&r.classList.add(wr),n.dataTransfer.files.length>0){if(n.dataTransfer.files.length>1)return;for(var e=n.dataTransfer.files,o=e[0].name,h=o.substring(o.lastIndexOf(".")),s=this.parent.insertImageSettings.allowedTypes,u=0;u<s.length;u++)if(h.toLocaleLowerCase()===s[u].toLowerCase())if(this.parent.insertImageSettings.saveUrl)this.onSelect(n);else i={args:n,text:"",file:e[0]},n.preventDefault(),this.imagePaste(i)}else f=this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument()),t=this.parent.inputElement.ownerDocument.querySelector("."+tf),t&&"IMG"===t.tagName&&(t.nextElementSibling&&t.nextElementSibling.classList.contains(pv)?f.insertNode(t.parentElement.parentElement):f.insertNode(t),t.classList.remove(tf),this.parent.formatter.editorManager.nodeSelection.Clear(this.contentModule.getDocument()),i=n,this.resizeStart(i,t),this.hideImageQuickToolbar())},n.prototype.onSelect=function(n){var f=this,e=this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument()),o=this.parent.createElement("ul",{className:wv}),u,t,r,i;this.parent.element.appendChild(o);u={name:"",size:0,status:"",statusCode:"",type:"",rawFile:n.dataTransfer.files[0],validationMessages:{}};t=this.parent.createElement("IMG");t.style.opacity="0.5";t.classList.add(cv);t.classList.add(kr);t.classList.add(lv);r=u.rawFile;i=new FileReader;i.addEventListener("load",function(){var n=URL.createObjectURL(ef(i.result));t.src="Blob"===f.parent.insertImageSettings.saveFormat?n:i.result});r&&i.readAsDataURL(r);e.insertNode(t);this.uploadMethod(n,t)},n.prototype.uploadMethod=function(n,t){var i=this,h=this,f=this.parent.createElement("div"),e,o,s,u;this.parent.element.appendChild(f);e=this.parent.createElement("input",{id:this.rteID+"_upload",attrs:{type:"File",name:"UploadFiles"}});o=this.parent.iframeSettings.enable?-50:-90;this.popupObj=new ft.Popup(f,{relateTo:t,height:"85px",width:"300px",offsetY:o,content:e,viewPortElement:this.parent.element,position:{X:"center",Y:"top"},enableRtl:this.parent.enableRtl,zIndex:10001,close:function(){i.parent.isBlur=!1;i.popupObj.destroy();Object(r.detach)(i.popupObj.element);i.popupObj=null}});this.popupObj.element.style.display="none";Object(r.addClass)([this.popupObj.element],ho);Object(r.addClass)([this.popupObj.element],yh);s=n.dataTransfer.files[0].size>1e6?300:100;setTimeout(function(){h.refreshPopup(t)},s);u=this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument());this.uploadObj=new et.Uploader({asyncSettings:{saveUrl:this.parent.insertImageSettings.saveUrl},cssClass:ph,dropArea:this.parent.inputElement,allowedExtensions:this.parent.insertImageSettings.allowedTypes.toString(),removing:function(){Object(r.detach)(t);i.popupObj.close()},canceling:function(){Object(r.detach)(t);i.popupObj.close()},uploading:function(n){i.parent.trigger(ys,n)},failure:function(r){var u={args:n,type:"Images",isNotify:void 0,elements:t};setTimeout(function(){i.uploadFailure(t,u,r)},900)},success:function(r){var u={args:n,type:"Images",isNotify:void 0,elements:t};setTimeout(function(){i.uploadSuccess(t,n,u,r)},900)}});this.uploadObj.appendTo(this.popupObj.element.childNodes[0]);Object(r.detach)(this.popupObj.element.querySelector(".e-rte-dialog-upload .e-file-select-wrap"));u.selectNodeContents(t);this.parent.formatter.editorManager.nodeSelection.setRange(this.contentModule.getDocument(),u)},n.prototype.refreshPopup=function(n){(this.parent.iframeSettings.enable?this.parent.element.offsetTop+n.offsetTop:n.offsetTop)>this.parent.element.offsetTop+this.parent.element.offsetHeight?(this.popupObj.relateTo=this.parent.inputElement,this.popupObj.offsetY=this.parent.iframeSettings.enable?-30:-65,this.popupObj.element.style.display="block"):this.popupObj&&(this.popupObj.refreshPosition(n),this.popupObj.element.style.display="block")},n.prototype.uploadFailure=function(n,t,i){Object(r.detach)(n);this.popupObj&&this.popupObj.close();this.parent.trigger(ke,i)},n.prototype.uploadSuccess=function(n,t,i,u){var f=this;n.style.opacity="1";n.classList.add(av);this.parent.trigger(be,u,function(t){if(!Object(r.isNullOrUndefined)(f.parent.insertImageSettings.path)){var i=f.parent.insertImageSettings.path+t.file.name;n.src=i;n.setAttribute("alt",t.file.name)}});this.popupObj.close();this.showImageQuickToolbar(i);this.resizeStart(t,n);this.uploadObj.destroy()},n.prototype.imagePaste=function(n){var u=this,t,i;0!==n.text.length||Object(r.isNullOrUndefined)(n.file)||(t=this,i=new FileReader,n.args.preventDefault(),i.addEventListener("load",function(){var f={cssClass:"inline"===t.parent.insertImageSettings.display?kr:br,url:"Base64"!==u.parent.insertImageSettings.saveFormat&&Object(r.isNullOrUndefined)(n.callBack)?URL.createObjectURL(ef(i.result)):i.result,width:{width:t.parent.insertImageSettings.width,minWidth:t.parent.insertImageSettings.minWidth,maxWidth:t.parent.insertImageSettings.maxWidth},height:{height:t.parent.insertImageSettings.height,minHeight:t.parent.insertImageSettings.minHeight,maxHeight:t.parent.insertImageSettings.maxHeight}};Object(r.isNullOrUndefined)(n.callBack)?(t.parent.formatter.process(t.parent,{item:{command:"Images",subCommand:"Image"}},n.args,f),u.showPopupToolBar(n,f)):n.callBack(f)}),i.readAsDataURL(n.file))},n.prototype.showPopupToolBar=function(n,t){var r=this,f='img[src="'+t.url+'"]',i=this.parent.inputElement.querySelector(f),u;this.parent.quickToolbarModule.createQTBar("Image","MultiRow",this.parent.quickToolbarSettings.image,o.ImageToolbar);u={args:n.args,type:"Images",isNotify:void 0,elements:i};i&&setTimeout(function(){r.showImageQuickToolbar(u);r.resizeStart(n.args,i)},0)},n.prototype.destroy=function(){this.removeEventListener()},n.prototype.getModuleName=function(){return"image"},n}(),nw=function(){function n(n,t){this.parent=n;var i=t;this.rendererFactory=i.getService("rendererFactory");this.addEventListener()}return n.prototype.addEventListener=function(){this.parent.on(yi,this.sourceCode,this);this.parent.on(p,this.onInitialEnd,this);this.parent.on(fr,this.updateSourceCode,this)},n.prototype.onInitialEnd=function(){this.parent.formatter.editorManager.observer.on(v,this.onKeyDown,this)},n.prototype.removeEventListener=function(){this.unWireEvent();this.parent.off(yi,this.sourceCode);this.parent.off(fr,this.updateSourceCode);this.parent.off(p,this.onInitialEnd);this.parent.formatter.editorManager.observer.off(v,this.onKeyDown)},n.prototype.getSourceCode=function(){return this.parent.createElement("textarea",{className:"e-rte-srctextarea"})},n.prototype.wireEvent=function(n){this.keyboardModule=new ts(n,{keyAction:this.previewKeyDown.bind(this),keyConfigs:this.parent.formatter.keyConfig,eventName:"keydown"});r.EventHandler.add(this.previewElement,"mousedown",this.mouseDownHandler,this)},n.prototype.unWireEvent=function(){this.keyboardModule&&this.keyboardModule.destroy();this.previewElement&&r.EventHandler.remove(this.previewElement,"mousedown",this.mouseDownHandler)},n.prototype.wireBaseKeyDown=function(){this.parent.keyboardModule=new ts(this.contentModule.getEditPanel(),{keyAction:this.parent.keyDown.bind(this.parent),keyConfigs:this.parent.formatter.keyConfig,eventName:"keydown"})},n.prototype.unWireBaseKeyDown=function(){this.parent.keyboardModule.destroy()},n.prototype.mouseDownHandler=function(n){this.parent.notify(er,{args:n})},n.prototype.previewKeyDown=function(n){switch(n.action){case"html-source":this.updateSourceCode(n);n.preventDefault();break;case"toolbar-focus":this.parent.toolbarSettings.enable&&this.parent.toolbarModule.baseToolbar.toolbarObj.element.querySelector('.e-toolbar-item[aria-disabled="false"][title] [tabindex]').focus()}},n.prototype.onKeyDown=function(n){switch(n.event.action){case"html-source":n.event.preventDefault();this.sourceCode(n);n.callBack({requestType:"SourceCode",editorMode:"HTML",event:n.event})}},n.prototype.sourceCode=function(n){var i,t;this.parent.isBlur=!1;this.parent.trigger(st,{requestType:"SourceCode",targetItem:"SourceCode",args:n});i=Object(r.selectAll)("."+oi,this.parent.element);(this.contentModule=this.rendererFactory.getRenderer(o.Content),this.parent.notify(ir,{targetItem:"SourceCode",updateItem:"Preview",baseToolbar:this.parent.getBaseToolbarObject()}),Object(r.isNullOrUndefined)(this.previewElement)&&(this.previewElement=this.getSourceCode()),this.parent.updateValueData(),this.parent.iframeSettings.enable)?(t=void 0,(t=Object(r.isNullOrUndefined)(this.parent.element.querySelector("#"+this.parent.element.id+"_source-view"))?this.parent.createElement("div",{className:"e-source-content",id:this.parent.element.id+"_source-view"}):this.parent.element.querySelector("#"+this.parent.element.id+"_source-view")).appendChild(this.previewElement),this.parent.element.appendChild(t),t.style.height=this.contentModule.getPanel().style.height,t.style.marginTop=this.contentModule.getPanel().style.marginTop,this.getPanel().value=this.getTextAreaValue(),this.contentModule.getPanel().style.display="none",t.style.display="block"):(this.contentModule.getPanel().appendChild(this.previewElement),this.getPanel().value=this.getTextAreaValue(),this.contentModule.getEditPanel().style.display="none",this.previewElement.style.display="block");(this.parent.isBlur=!1,this.parent.disableToolbarItem(this.parent.toolbarSettings.items),this.parent.enableToolbarItem("SourceCode"),this.parent.getToolbar()&&Object(r.removeClass)([this.parent.getToolbar()],[si]),Object(r.removeClass)(i,[dr]),this.parent.setContentHeight("sourceCode",!0),this.wireEvent(this.previewElement),this.unWireBaseKeyDown(),this.previewElement.focus(),this.parent.updateValue(),Object(r.isNullOrUndefined)(this.parent.placeholder)||this.parent.iframeSettings.enable)||(this.parent.element.querySelector(".rte-placeholder").style.display="none");this.parent.trigger(vi,{requestType:"SourceCode",targetItem:"SourceCode",args:n});this.parent.invokeChangeEvent()},n.prototype.updateSourceCode=function(n){var t,i,u;this.parent.isBlur=!1;this.parent.trigger(st,{requestType:"Preview",targetItem:"Preview",args:n});t=this.getPanel();this.parent.notify(ir,{targetItem:"Preview",updateItem:"SourceCode",baseToolbar:this.parent.getBaseToolbarObject()});i=this.parent.serializeValue(t.value);u=null===i||""===i?"<p><br/><\/p>":i;(this.parent.iframeSettings.enable?(t.parentElement.style.display="none",this.contentModule.getPanel().style.display="block",this.contentModule.getEditPanel().innerHTML=u):(t.style.display="none",this.contentModule.getEditPanel().style.display="block",this.contentModule.getEditPanel().innerHTML=u),this.parent.isBlur=!1,this.parent.enableToolbarItem(this.parent.toolbarSettings.items),this.parent.getToolbar()&&Object(r.removeClass)([this.parent.getToolbar()],[si]),this.parent.setContentHeight("preview",!0),this.unWireEvent(),this.wireBaseKeyDown(),this.contentModule.getEditPanel().focus(),this.parent.updateValue(),Object(r.isNullOrUndefined)(this.parent.placeholder)||0!==this.contentModule.getEditPanel().innerText.length)||(this.parent.element.querySelector(".rte-placeholder").style.display="block");this.parent.trigger(vi,{requestType:"Preview",targetItem:"Preview",args:n});this.parent.formatter.enableUndo(this.parent);this.parent.invokeChangeEvent()},n.prototype.getTextAreaValue=function(){return"<p><br><\/p>"===this.contentModule.getEditPanel().innerHTML||12===this.contentModule.getEditPanel().innerHTML.length||1===this.contentModule.getEditPanel().childNodes.length&&"P"===this.contentModule.getEditPanel().childNodes[0].tagName&&7===this.contentModule.getEditPanel().innerHTML.length?"":this.parent.value},n.prototype.getPanel=function(){return this.parent.element.querySelector(".e-rte-srctextarea")},n.prototype.getViewPanel=function(){return this.parent.iframeSettings.enable&&this.getPanel()?this.getPanel().parentElement:this.getPanel()},n.prototype.destroy=function(){this.removeEventListener()},n}(),wk=function(){function n(n,t){this.ensureInsideTableList=!0;this.pageX=null;this.pageY=null;this.moveEle=null;this.parent=n;this.rteID=n.element.id;this.l10n=t.getService("rteLocale");this.rendererFactory=t.getService("rendererFactory");this.dialogRenderObj=t.getService("dialogRenderObject");this.addEventListener()}return n.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(ae,this.renderDlgContent,this),this.parent.on(p,this.afterRender,this),this.parent.on(ve,this.docClick,this),this.parent.on(ii,this.editAreaClickHandler,this),this.parent.on(ye,this.onToolbarAction,this),this.parent.on(ui,this.dropdownSelect,this),this.parent.on(w,this.keyDown,this))},n.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(ae,this.renderDlgContent),this.parent.off(p,this.afterRender),this.parent.off(ve,this.docClick),this.parent.off(ii,this.editAreaClickHandler),this.parent.off(ye,this.onToolbarAction),this.parent.off(ui,this.dropdownSelect),this.parent.off(g,this.cellSelect),this.parent.off(hr,this.setBGColor),this.parent.off(w,this.keyDown))},n.prototype.afterRender=function(){this.contentModule=this.rendererFactory.getRenderer(o.Content);this.parent.on(hr,this.setBGColor,this);this.parent.on(g,this.cellSelect,this);this.parent.tableSettings.resize&&r.EventHandler.add(this.parent.contentModule.getEditPanel(),r.Browser.touchStartEvent,this.resizeStart,this);!r.Browser.isDevice&&this.parent.tableSettings.resize&&r.EventHandler.add(this.contentModule.getEditPanel(),"mouseover",this.resizeHelper,this)},n.prototype.dropdownSelect=function(n){var i=n.item,r,t;if(document.body.contains(document.body.querySelector(".e-rte-quick-toolbar"))&&"Table"===i.command){r=this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument());t={args:n,selection:this.parent.formatter.editorManager.nodeSelection.save(r,this.contentModule.getDocument()),selectParent:this.parent.formatter.editorManager.nodeSelection.getParentNodeCollection(r)};switch(i.subCommand){case"InsertRowBefore":case"InsertRowAfter":this.addRow(t.selection,n);break;case"InsertColumnLeft":case"InsertColumnRight":this.addColumn(t.selection,n);break;case"DeleteColumn":case"DeleteRow":this.removeRowColumn(t.selection,n);break;case"AlignTop":case"AlignMiddle":case"AlignBottom":this.verticalAlign(t,n);break;case"Dashed":case"Alternate":this.tableStyles(t,i.subCommand)}}},n.prototype.keyDown=function(n){var i=n.args,t,e;switch(i.action){case"insert-table":if("HTML"===this.parent.editorMode){var o=this.parent.contentModule.getDocument(),f=this.parent.formatter.editorManager.nodeSelection.getRange(o),u=this.parent.formatter.editorManager.nodeSelection.save(f,o),s={originalEvent:n.args,item:{command:"Table",subCommand:"CreateTable"}};this.insertTableDialog({self:this,args:s,selection:u})}i.preventDefault()}if(!Object(r.isNullOrUndefined)(this.parent.formatter.editorManager.nodeSelection)&&this.contentModule&&(f=this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument()),u=this.parent.formatter.editorManager.nodeSelection.save(f,this.contentModule.getDocument()),t=this.parent.formatter.editorManager.nodeSelection.getParentNodeCollection(f)[0],(t=t&&"TD"!==t.tagName&&"TH"!==t.tagName?t.parentElement:t,8!==i.keyCode&&46!==i.keyCode||(t&&"TBODY"===t.tagName?(i.preventDefault(),this.removeTable(u,i,!0)):t&&t.querySelectorAll("table").length>0&&this.removeResizeEle()),t&&"TD"!==t.tagName&&"TH"!==t.tagName)&&(e=Object(r.closest)(t,"td"),t=!Object(r.isNullOrUndefined)(e)&&this.parent.inputElement.contains(e)?e:t),t&&("TD"===t.tagName||"TH"===t.tagName)))switch(i.keyCode){case 9:case 37:case 39:this.tabSelection(i,u,t);break;case 40:case 38:this.tableArrowNavigation(i,u,t)}},n.prototype.onToolbarAction=function(n){switch(n.args.item.subCommand){case"TableHeader":this.tableHeader(n.selection,n.args);break;case"TableRemove":this.removeTable(n.selection,n.args);break;case"TableEditProperties":this.editTable(n)}},n.prototype.verticalAlign=function(n,t){var i=Object(r.closest)(n.selectParent[0],"td")||Object(r.closest)(n.selectParent[0],"th");i&&this.parent.formatter.process(this.parent,t,t,{tableCell:i,subCommand:t.item.subCommand})},n.prototype.tableStyles=function(n,t){var i=Object(r.closest)(n.selectParent[0],"table");"Dashed"===t&&(this.parent.element.classList.contains(wi)?this.parent.element.classList.remove(wi):this.parent.element.classList.add(wi),i.classList.contains(wi)?i.classList.remove(wi):i.classList.add(wi));"Alternate"===t&&(this.parent.element.classList.contains(bi)?this.parent.element.classList.remove(bi):this.parent.element.classList.add(bi),i.classList.contains(bi)?i.classList.remove(bi):i.classList.add(bi));this.parent.formatter.saveData();this.parent.formatter.editorManager.nodeSelection.restore()},n.prototype.insideList=function(n){for(var i=this.parent.formatter.editorManager.domNode.blockNodes(),r=[],t=0;t<i.length;t++)"LI"===i[t].parentNode.tagName?r.push(i[t].parentNode):"LI"===i[t].tagName&&"P"!==i[t].childNodes[0].tagName&&"OL"!==i[t].childNodes[0].tagName&&"UL"!==i[t].childNodes[0].tagName&&r.push(i[t]);return r.length>1||r.length&&0===n.startOffset&&0===n.endOffset?(this.ensureInsideTableList=!0,!0):(this.ensureInsideTableList=!1,!1)},n.prototype.tabSelection=function(n,t,i){var o=this.insideList(t.range),f,e,u;(37===n.keyCode||39===n.keyCode)&&3===t.range.startContainer.nodeType||o||((n.preventDefault(),i.classList.remove(hi),n.shiftKey||37===n.keyCode)?(f=Object(r.isNullOrUndefined)(i.previousSibling)?Object(r.isNullOrUndefined)(Object(r.closest)(i,"tr").previousSibling)?Object(r.isNullOrUndefined)(Object(r.closest)(i,"table").previousSibling)?i:"td"===Object(r.closest)(i,"table").previousSibling.nodeName.toLowerCase()?Object(r.closest)(i,"table").previousSibling:i:Object(r.closest)(i,"tr").previousSibling.childNodes[Object(r.closest)(i,"tr").previousSibling.childNodes.length-1]:i.previousSibling,i===f&&0===i.cellIndex&&Object(r.closest)(i,"table").tHead&&(e=Object(r.closest)(i,"table"),f=e.rows[0].cells[e.rows[0].cells.length-1]),37===n.keyCode&&i===f&&(f=Object(r.closest)(i,"table").previousSibling),f&&(""!==f.textContent.trim()&&Object(r.closest)(f,"td")?t.setSelectionNode(this.contentModule.getDocument(),f):t.setSelectionText(this.contentModule.getDocument(),f,f,0,0))):(u=Object(r.isNullOrUndefined)(i.nextSibling)?Object(r.isNullOrUndefined)(Object(r.closest)(i,"tr").nextSibling)?Object(r.isNullOrUndefined)(Object(r.closest)(i,"table").nextSibling)?i:"td"===Object(r.closest)(i,"table").nextSibling.nodeName.toLowerCase()?Object(r.closest)(i,"table").nextSibling:i:Object(r.closest)(i,"tr").nextSibling.childNodes[0]:i.nextSibling,i===u&&"TH"===i.nodeName&&(u=Object(r.closest)(i,"table").rows[1].cells[0]),39===n.keyCode&&i===u&&(u=Object(r.closest)(i,"table").nextSibling),u&&(""!==u.textContent.trim()&&Object(r.closest)(u,"td")?t.setSelectionNode(this.contentModule.getDocument(),u):t.setSelectionText(this.contentModule.getDocument(),u,u,0,0)),i===u&&39!==n.keyCode&&u&&(this.addRow(t,n,!0),""!==(u=u.parentElement.nextSibling.firstChild).textContent.trim()&&Object(r.closest)(u,"td")?t.setSelectionNode(this.contentModule.getDocument(),u):t.setSelectionText(this.contentModule.getDocument(),u,u,0,0))))},n.prototype.tableArrowNavigation=function(n,t,i){var u=t.range.startContainer;40===n.keyCode&&3===u.nodeType&&(u.nextSibling&&"BR"===u.nextSibling.nodeName||u.parentNode&&"TD"!==u.parentNode.nodeName)||38===n.keyCode&&3===u.nodeType&&(u.previousSibling&&"BR"===u.previousSibling.nodeName||u.parentNode&&"TD"!==u.parentNode.nodeName)||(n.preventDefault(),i.classList.remove(hi),(i=40===n.keyCode?Object(r.isNullOrUndefined)(Object(r.closest)(i,"tr").nextSibling)?Object(r.closest)(i,"table").tHead&&"TH"===i.nodeName?Object(r.closest)(i,"table").rows[1].cells[i.cellIndex]:Object(r.isNullOrUndefined)(Object(r.closest)(i,"table").nextSibling)?i:Object(r.closest)(i,"table").nextSibling:Object(r.closest)(i,"tr").nextSibling.children[i.cellIndex]:Object(r.isNullOrUndefined)(Object(r.closest)(i,"tr").previousSibling)?Object(r.closest)(i,"table").tHead&&"TH"!==i.nodeName?Object(r.closest)(i,"table").tHead.rows[0].cells[i.cellIndex]:Object(r.isNullOrUndefined)(Object(r.closest)(i,"table").previousSibling)?i:Object(r.closest)(i,"table").previousSibling:Object(r.closest)(i,"tr").previousSibling.children[i.cellIndex])&&t.setSelectionText(this.contentModule.getDocument(),i,i,0,0))},n.prototype.setBGColor=function(n){var f=this.parent.formatter.editorManager.nodeSelection.getRange(this.contentModule.getDocument()),t=this.parent.formatter.editorManager.nodeSelection.save(f,this.contentModule.getDocument()).range.startContainer,u,i;if((t=3===t.nodeType?Object(r.closest)(t.parentNode,"td,th"):Object(r.closest)(t,"td, th"))&&("TD"===t.nodeName||"TH"===t.nodeName)){for(u=Object(r.closest)(t,"table").querySelectorAll("."+hi),i=0;i<u.length;i++)u[i].style.backgroundColor=n.item.value;this.parent.formatter.saveData()}},n.prototype.hideTableQuickToolbar=function(){this.quickToolObj&&this.quickToolObj.tableQTBar&&document.body.contains(this.quickToolObj.tableQTBar.element)&&this.quickToolObj.tableQTBar.hidePopup()},n.prototype.tableHeader=function(n,t){this.parent.formatter.process(this.parent,t,t.originalEvent,{selection:n,subCommand:t.item.subCommand})},n.prototype.editAreaClickHandler=function(n){var i,u,t,f,e,s,h;if(!this.parent.readonly&&(i=n.args,u=this.parent.quickToolbarSettings.showOnRightClick,!(2===i.which||u&&1===i.which||!u&&3===i.which)&&"HTML"===this.parent.editorMode&&this.parent.quickToolbarModule&&this.parent.quickToolbarModule.tableQTBar)){if(this.quickToolObj=this.parent.quickToolbarModule,t=i.target,this.contentModule=this.rendererFactory.getRenderer(o.Content),this.quickToolObj.tableQTBar.element.classList.contains("e-rte-pop"))return;f=this.parent.formatter.editorManager.nodeSelection.getRange(this.contentModule.getDocument());e=Object(r.closest)(t,"table");t&&"A"!==t.nodeName&&"IMG"!==t.nodeName&&("TD"===t.nodeName||"TH"===t.nodeName||"TABLE"===t.nodeName||e&&this.parent.contentModule.getEditPanel().contains(e))&&(3!==f.startContainer.nodeType||f.collapsed)?(s=this.parent.formatter.editorManager.nodeSelection.getRange(this.contentModule.getDocument()),this.parent.formatter.editorManager.nodeSelection.save(s,this.contentModule.getDocument()),this.parent.formatter.editorManager.nodeSelection.Clear(this.contentModule.getDocument()),h=this.parent.iframeSettings.enable?window.pageYOffset+this.parent.element.getBoundingClientRect().top+i.clientY:i.pageY,this.quickToolObj.tableQTBar.showPopup(i.pageX,h,t),this.parent.formatter.editorManager.nodeSelection.restore()):this.hideTableQuickToolbar()}},n.prototype.tableCellSelect=function(n){var t=n.target,i=Array.prototype.slice.call(t.parentElement.parentElement.children).indexOf(t.parentElement),u=Array.prototype.slice.call(t.parentElement.children).indexOf(t),f=this.dlgDiv.querySelectorAll(".e-rte-tablecell");Array.prototype.forEach.call(f,function(n){var t=Array.prototype.slice.call(n.parentElement.parentElement.children).indexOf(n.parentElement),f=Array.prototype.slice.call(n.parentElement.children).indexOf(n);Object(r.removeClass)([n],"e-active");t<=i&&f<=u&&Object(r.addClass)([n],"e-active")});this.tblHeader.innerHTML=u+1+"x"+(i+1)},n.prototype.tableCellLeave=function(){Object(r.removeClass)(this.dlgDiv.querySelectorAll(".e-rte-tablecell"),"e-active");Object(r.addClass)([this.dlgDiv.querySelector(".e-rte-tablecell")],"e-active");this.tblHeader.innerHTML="1x1"},n.prototype.tableCellClick=function(n){var t=n.target,i=Array.prototype.slice.call(t.parentElement.parentElement.children).indexOf(t.parentElement)+1,r=Array.prototype.slice.call(t.parentElement.children).indexOf(t)+1;this.self.tableInsert(i,r,n,this)},n.prototype.tableInsert=function(n,t,i,u){var f=u.self?u.self:this,e=u.selection.range.startContainer,o,s,h;"P"!==e.nodeName||""!==e.textContent.trim()||e.childNodes.length>0||(e.innerHTML="<br />");o=e.parentNode;"HTML"===f.parent.editorMode&&(f.parent.iframeSettings.enable&&!tt(o.ownerDocument.querySelector("body"),"e-lib")||!f.parent.iframeSettings.enable&&Object(r.isNullOrUndefined)(Object(r.closest)(o,"#"+f.contentModule.getPanel().id)))&&(f.contentModule.getEditPanel().focus(),s=f.parent.formatter.editorManager.nodeSelection.getRange(f.contentModule.getDocument()),u.selection=f.parent.formatter.editorManager.nodeSelection.save(s,f.contentModule.getDocument()));h={row:n,columns:t,width:{minWidth:f.parent.tableSettings.minWidth,maxWidth:f.parent.tableSettings.maxWidth,width:f.parent.tableSettings.width},selection:u.selection};f.popupObj&&f.popupObj.hide();f.editdlgObj&&f.editdlgObj.hide();f.parent.formatter.process(f.parent,u.args,u.args.originalEvent,h);f.contentModule.getEditPanel().focus();f.parent.on(g,f.cellSelect,f)},n.prototype.cellSelect=function(n){var t=n.args.target,i=Object(r.closest)(t,"td,th");t="TD"!==t.nodeName&&i&&this.parent.contentModule.getEditPanel().contains(i)?i:t;Object(r.removeClass)(this.contentModule.getEditPanel().querySelectorAll("table td, table th"),hi);!t||"TD"!==t.tagName&&"TH"!==t.tagName||(t.removeAttribute("class"),Object(r.addClass)([t],hi),this.curTable=this.curTable?this.curTable:Object(r.closest)(t,"table"),this.removeResizeEle(),this.helper&&this.contentModule.getEditPanel().contains(this.helper)&&Object(r.detach)(this.helper))},n.prototype.resizeHelper=function(n){if(!this.parent.readonly){var t=n.target||n.targetTouches[0].target,i=Object(r.closest)(t,"table");"TABLE"!==t.nodeName&&"TD"!==t.nodeName&&"TH"!==t.nodeName||(this.curTable=i&&this.parent.contentModule.getEditPanel().contains(i)&&("TD"===t.nodeName||"TH"===t.nodeName)?i:t,this.removeResizeEle(),this.tableResizeEleCreation(this.curTable,n))}},n.prototype.tableResizeEleCreation=function(n,t){var s,h,a,e;this.parent.preventDefaultResize(t);for(var o=Array.prototype.slice.call(n.rows[0].cells,1),f=[],i=0;i<n.rows.length;i++)f.push(Array.prototype.slice.call(n.rows[i].cells,0,1)[0]);var c=parseInt(getComputedStyle(n).height,10),l=parseInt(getComputedStyle(n).width,10),u=this.calcPos(n);for(i=0;o.length>i;i++)s=this.parent.createElement("span",{className:du,attrs:{"data-col":(i+1).toString(),unselectable:"on",contenteditable:"false"}}),s.style.cssText="height: "+c+"px; width: 4px; top: "+u.top+"px; left:"+(u.left+this.calcPos(o[i]).left)+"px;",this.contentModule.getEditPanel().appendChild(s);for(i=0;f.length>i;i++)h=this.parent.createElement("span",{className:gu,attrs:{"data-row":i.toString(),unselectable:"on",contenteditable:"false"}}),a=Object(r.isNullOrUndefined)(n.getAttribute("cellspacing"))&&""===n.getAttribute("cellspacing")?this.calcPos(f[i]).left:0,h.style.cssText="width: "+l+"px; height: 4px; top: "+(this.calcPos(f[i]).top+u.top+f[i].offsetHeight-2)+"px; left:"+(a+u.left)+"px;",this.contentModule.getEditPanel().appendChild(h);e=this.parent.createElement("span",{className:nf,attrs:{"data-col":o.length.toString(),unselectable:"on",contenteditable:"false"}});e.style.cssText="top: "+(u.top+c-4)+"px; left:"+(u.left+l-4)+"px;";r.Browser.isDevice&&e.classList.add("e-rmob");this.contentModule.getEditPanel().appendChild(e)},n.prototype.removeResizeEle=function(){var t=this.contentModule.getEditPanel().querySelectorAll(".e-column-resize, .e-row-resize, .e-table-box"),n;if(t.length>0)for(n=0;n<t.length;n++)Object(r.detach)(t[n])},n.prototype.calcPos=function(n){for(var i={top:0,left:0},f=n.getBoundingClientRect(),u=n.ownerDocument,t=n.offsetParent||u.documentElement;t&&(t===u.body||t===u.documentElement)&&"static"===t.style.position;)t=t.parentNode;return"TD"===t.nodeName&&"TABLE"===n.nodeName&&(t=Object(r.closest)(t,".e-control")),t&&t!==n&&1===t.nodeType&&(i=t.getBoundingClientRect()),{top:f.top-i.top,left:f.left-i.left}},n.prototype.getPointX=function(n){return n.touches&&n.touches.length?n.touches[0].pageX:n.pageX},n.prototype.getPointY=function(n){return n.touches&&n.touches.length?n.touches[0].pageY:n.pageY},n.prototype.resizeStart=function(n){var u=this,t,i;this.parent.readonly||(r.Browser.isDevice&&this.resizeHelper(n),t=n.target,(t.classList.contains(du)||t.classList.contains(gu)||t.classList.contains(nf))&&((n.preventDefault(),this.parent.preventDefaultResize(n),Object(r.removeClass)(this.curTable.querySelectorAll("td,th"),hi),this.parent.formatter.editorManager.nodeSelection.Clear(this.contentModule.getDocument()),this.pageX=this.getPointX(n),this.pageY=this.getPointY(n),this.resizeBtnInit(),this.hideTableQuickToolbar(),t.classList.contains(du)&&(this.resizeBtnStat.column=!0,this.columnEle=this.curTable.rows[0].cells[parseInt(t.getAttribute("data-col"),10)],this.colIndex=this.columnEle.cellIndex,this.moveEle=n.target,this.appendHelper()),t.classList.contains(gu)&&(this.rowEle=this.curTable.rows[parseInt(t.getAttribute("data-row"),10)],this.resizeBtnStat.row=!0,this.appendHelper()),t.classList.contains(nf)&&(this.resizeBtnStat.tableBox=!0),r.Browser.isDevice&&this.helper&&!this.helper.classList.contains("e-reicon"))?(this.helper.classList.add("e-reicon"),r.EventHandler.add(document,r.Browser.touchStartEvent,this.removeHelper,this),r.EventHandler.add(this.helper,r.Browser.touchStartEvent,this.resizeStart,this)):(i=Object(r.isBlazor)()?{requestType:"Table"}:{event:n,requestType:"Table"},this.parent.trigger(df,i,function(n){n.cancel&&u.cancelResizeAction()})),r.EventHandler.add(this.contentModule.getDocument(),r.Browser.touchMoveEvent,this.resizing,this),r.EventHandler.add(this.contentModule.getDocument(),r.Browser.touchEndEvent,this.resizeEnd,this)))},n.prototype.removeHelper=function(n){!n.target.classList.contains("e-reicon")&&this.helper&&(r.EventHandler.remove(document,r.Browser.touchStartEvent,this.removeHelper),r.EventHandler.remove(this.helper,r.Browser.touchStartEvent,this.resizeStart),this.helper&&this.contentModule.getEditPanel().contains(this.helper)&&Object(r.detach)(this.helper),this.pageX=null,this.helper=null)},n.prototype.appendHelper=function(){this.helper=this.parent.createElement("div",{className:"e-table-rhelper"});r.Browser.isDevice&&this.helper.classList.add("e-reicon");this.contentModule.getEditPanel().appendChild(this.helper);this.setHelperHeight()},n.prototype.setHelperHeight=function(){var n=this.calcPos(this.curTable);this.resizeBtnStat.column?(this.helper.classList.add("e-column-helper"),this.helper.style.cssText="height: "+getComputedStyle(this.curTable).height+"; top: "+n.top+"px; left:"+(n.left+this.calcPos(this.columnEle).left-1)+"px;"):(this.helper.classList.add("e-row-helper"),this.helper.style.cssText="width: "+getComputedStyle(this.curTable).width+"; top: "+(this.calcPos(this.rowEle).top+n.top+this.rowEle.offsetHeight)+"px; left:"+(this.calcPos(this.rowEle).left+n.left)+"px;")},n.prototype.updateHelper=function(){var n=this.calcPos(this.curTable),t,i;this.resizeBtnStat.column?(t=n.left+this.calcPos(this.columnEle).left-1,this.helper.style.left=t+"px"):(i=this.calcPos(this.rowEle).top+n.top+this.rowEle.offsetHeight,this.helper.style.top=i+"px")},n.prototype.resizing=function(n){var t=this,i=this.getPointX(n),u=this.getPointY(n),f=this.parent.enableRtl?-(i-this.pageX):i-this.pageX,e=this.parent.enableRtl?-(u-this.pageY):u-this.pageY,o;this.pageX=i;this.pageY=u;o=Object(r.isBlazor)()?{requestType:"table"}:{event:n,requestType:"table"};this.parent.trigger(gf,o,function(i){var v,y,l,p;if(i.cancel)t.cancelResizeAction();else{var h=t.contentModule.getEditPanel().querySelector(".e-table-box"),u=parseInt(getComputedStyle(t.curTable).width,10),c=parseInt(getComputedStyle(t.curTable).height,10),w=+getComputedStyle(t.contentModule.getEditPanel()).paddingRight.match(/\d/g).join(""),b=t.contentModule.getEditPanel().offsetWidth-2*w;if(t.resizeBtnStat.column){for(var k=t.curTable.rows[0].cells,o=parseFloat(t.columnEle.offsetWidth.toLocaleString())-f,a=parseFloat(t.columnEle.offsetWidth.toLocaleString())+parseFloat(k[t.colIndex-1].offsetWidth.toLocaleString()),s=0;s<t.curTable.rows.length;s++)a-o>20&&o>20&&(v=a-o,y=o,t.curTable.rows[s].cells[t.colIndex-1].style.width=t.convertPixelToPercentage(v,u)+"%",t.curTable.rows[s].cells[t.colIndex].style.width=t.convertPixelToPercentage(y,u)+"%");t.updateHelper()}else t.resizeBtnStat.row?(t.parent.preventDefaultResize(n),l=parseFloat(t.rowEle.clientHeight.toString())+e,l>20&&(t.rowEle.style.height=l+"px"),t.curTable.style.height="",h.style.cssText="top: "+(t.calcPos(t.curTable).top+c-4)+"px; left:"+(t.calcPos(t.curTable).left+u-4)+"px;",t.updateHelper()):t.resizeBtnStat.tableBox&&(r.Browser.isDevice||r.EventHandler.remove(t.contentModule.getEditPanel(),"mouseover",t.resizeHelper),p=t.curTable.style.width.indexOf("%")>-1,t.curTable.style.width=p?t.convertPixelToPercentage(u+f,b)+"%":u+f+"px",t.curTable.style.height=c+e+"px",h.classList.add("e-rbox-select"),h.style.cssText="top: "+(t.calcPos(t.curTable).top+c-4)+"px; left:"+(t.calcPos(t.curTable).left+u-4)+"px;")}})},n.prototype.convertPixelToPercentage=function(n,t){return n/t*100},n.prototype.cancelResizeAction=function(){r.EventHandler.remove(this.contentModule.getDocument(),r.Browser.touchMoveEvent,this.resizing);r.EventHandler.remove(this.contentModule.getDocument(),r.Browser.touchEndEvent,this.resizeEnd);this.removeResizeEle()},n.prototype.resizeEnd=function(n){this.resizeBtnInit();r.EventHandler.remove(this.contentModule.getDocument(),r.Browser.touchMoveEvent,this.resizing);r.EventHandler.remove(this.contentModule.getDocument(),r.Browser.touchEndEvent,this.resizeEnd);this.contentModule.getEditPanel().querySelector(".e-table-box")&&this.contentModule.getEditPanel().contains(this.contentModule.getEditPanel().querySelector(".e-table-box"))&&(r.Browser.isDevice||r.EventHandler.add(this.contentModule.getEditPanel(),"mouseover",this.resizeHelper,this),this.removeResizeEle(),this.helper&&this.contentModule.getEditPanel().contains(this.helper)&&(Object(r.detach)(this.helper),this.helper=null),this.pageX=null,this.pageY=null,this.moveEle=null);var t=Object(r.isBlazor)()?{requestType:"table"}:{event:n,requestType:"table"};this.parent.trigger(ne,t);this.parent.formatter.saveData()},n.prototype.resizeBtnInit=function(){return this.resizeBtnStat={column:!1,row:!1,tableBox:!1}},n.prototype.addRow=function(n,t,i){var r,u;i&&(r={item:{command:"Table",subCommand:"InsertRowAfter"}});u={selection:n,subCommand:i?r.item.subCommand:t.item.subCommand};this.parent.formatter.process(this.parent,i?r:t,t,u)},n.prototype.addColumn=function(n,t){this.parent.formatter.process(this.parent,t,t,{selection:n,width:this.parent.tableSettings.width,subCommand:t.item.subCommand})},n.prototype.removeRowColumn=function(n,t){this.parent.formatter.process(this.parent,t,t,{selection:n,subCommand:t.item.subCommand});this.hideTableQuickToolbar()},n.prototype.removeTable=function(n,t,i){var r,u;i&&(r={item:{command:"Table",subCommand:"TableRemove"}});u={selection:n,subCommand:i?r.item.subCommand:t.item.subCommand};this.parent.formatter.process(this.parent,i?r:t,t.originalEvent,u);this.contentModule.getEditPanel().focus();this.removeResizeEle();this.hideTableQuickToolbar()},n.prototype.renderDlgContent=function(n){var i=this,o,f,u,e,t;r.Browser.isDevice||this.parent.inlineMode.enable?this.insertTableDialog(n):this.popupObj?this.popupObj.hide():(this.hideTableQuickToolbar(),o=this.l10n.getConstant("inserttablebtn"),this.dlgDiv=this.parent.createElement("div",{className:"e-rte-table-popup",id:this.rteID+"_table"}),this.tblHeader=this.parent.createElement("div",{className:"e-rte-popup-header"}),this.tblHeader.innerHTML="1X1",this.dlgDiv.appendChild(this.tblHeader),f=this.parent.createElement("div",{className:"e-rte-table-span"}),this.drawTable(f,n),this.dlgDiv.appendChild(f),this.dlgDiv.appendChild(this.parent.createElement("span",{className:"e-span-border"})),u=this.parent.createElement("button",{className:"e-insert-table-btn",id:this.rteID+"_insertTable",attrs:{type:"button",tabindex:"0"}}),Object(r.isNullOrUndefined)(this.parent.getToolbarElement().querySelector(".e-expended-nav"))||this.parent.getToolbarElement().querySelector(".e-expended-nav").setAttribute("tabindex","1"),this.dlgDiv.appendChild(u),e=new nr.Button({iconCss:"e-icons e-create-table",content:o,cssClass:"e-flat",enableRtl:this.parent.enableRtl,locale:this.parent.locale}),e.isStringTemplate=!0,e.appendTo(u),r.EventHandler.add(u,"click",this.insertTableDialog,{self:this,args:n.args,selection:n.selection}),this.parent.getToolbar().appendChild(this.dlgDiv),t=n.args.originalEvent.target,t=t.classList.contains("e-toolbar-item")?t.firstChild:t.parentElement,this.popupObj=new ft.Popup(this.dlgDiv,{targetType:"relative",relateTo:t,collision:{X:"fit",Y:"none"},offsetY:8,viewPortElement:this.parent.element,position:{X:"left",Y:"bottom"},enableRtl:this.parent.enableRtl,zIndex:10001,close:function(){i.parent.isBlur=!1;i.popupObj.destroy();Object(r.detach)(i.popupObj.element);i.popupObj=null}}),Object(r.addClass)([this.popupObj.element],"e-popup-open"),this.popupObj.refreshPosition(t))},n.prototype.docClick=function(n){var t=n.args.target,i,u;t&&t.classList&&(this.popupObj&&!Object(r.closest)(t,"#"+this.popupObj.element.id)||this.editdlgObj&&!Object(r.closest)(t,"#"+this.editdlgObj.element.id))&&!t.classList.contains("e-create-table")&&t.offsetParent&&!t.offsetParent.classList.contains("e-rte-backgroundcolor-dropdown")&&(this.popupObj&&this.popupObj.hide(),this.editdlgObj&&this.editdlgObj.hide(),this.parent.isBlur=!0,uu(this.parent.element,"focusout"));i=Object(r.closest)(t,"td");u=!(!i||!this.parent.contentModule.getEditPanel().contains(i));!t||"TD"===t.tagName||"TH"===t.tagName||u||null!==Object(r.closest)(t,".e-rte-quick-popup")||!t.offsetParent||t.offsetParent.classList.contains("e-quick-dropdown")||t.offsetParent.classList.contains("e-rte-backgroundcolor-dropdown")||Object(r.closest)(t,".e-rte-dropdown-popup")||Object(r.closest)(t,".e-rte-elements")||(Object(r.removeClass)(this.parent.element.querySelectorAll("table td"),hi),r.Browser.isIE||this.hideTableQuickToolbar());!t||!t.classList||t.classList.contains(du)||t.classList.contains(gu)||t.classList.contains(nf)||this.removeResizeEle()},n.prototype.drawTable=function(n,t){for(var e,i,f,o,u=0;u<3;u++){for(e=this.parent.createElement("div",{className:"e-rte-table-row",attrs:{"data-column":""+u}}),f=0;f<10;f++)o=u>2?"none":"inline-block",i=this.parent.createElement("div",{className:"e-rte-tablecell e-default",attrs:{"data-cell":""+f}}),e.appendChild(i),i.style.display=o,0===f&&0===u&&Object(r.addClass)([i],"e-active"),r.EventHandler.add(i,"mousemove",this.tableCellSelect,this),r.EventHandler.add(e,"mouseleave",this.tableCellLeave,this),r.EventHandler.add(i,"mouseup",this.tableCellClick,{self:this,args:t.args,selection:t.selection});n.appendChild(e)}},n.prototype.editTable=function(n){var t=this;this.createDialog(n);var i=this.tableDlgContent(n),r=this.l10n.getConstant("dialogUpdate"),u=this.l10n.getConstant("dialogCancel"),f=this.l10n.getConstant("tableEditHeader");this.editdlgObj.setProperties({height:"initial",width:"290px",content:i,header:f,buttons:[{click:this.applyProperties.bind(this,n),buttonModel:{content:r,cssClass:"e-flat e-size-update",isPrimary:!0}},{click:function(n){t.cancelDialog(n)},buttonModel:{cssClass:"e-flat e-cancel",content:u}}]});this.editdlgObj.element.style.maxHeight="none";this.editdlgObj.content.querySelector("input").focus();this.hideTableQuickToolbar()},n.prototype.insertTableDialog=function(n){var t=this.self?this.self:this;t.popupObj&&t.popupObj.hide();t.createDialog(n);var i=t.tableCellDlgContent(),r=t.l10n.getConstant("dialogInsert"),u=t.l10n.getConstant("dialogCancel");t.editdlgObj.setProperties({height:"initial",width:"290px",content:i,buttons:[{click:t.customTable.bind(this,n),buttonModel:{content:r,cssClass:"e-flat e-insert-table",isPrimary:!0}},{click:function(n){t.cancelDialog(n)},buttonModel:{cssClass:"e-flat e-cancel",content:u}}]});t.editdlgObj.element.style.maxHeight="none";t.editdlgObj.content.querySelector("input").focus()},n.prototype.tableCellDlgContent=function(){var t=this.l10n.getConstant("columns"),i=this.l10n.getConstant("rows"),n=this.parent.createElement("div",{className:"e-cell-wrap"}),r=ci('<div class="e-rte-field"><input type="text"  data-role ="none" id="tableColumn" class="e-table-column"/><\/div><div class="e-rte-field"><input type="text" data-role ="none" id="tableRow" class="e-table-row" /><\/div>');return n.appendChild(r),this.columnTextBox=new et.NumericTextBox({format:"n0",min:1,value:3,placeholder:t,floatLabelType:"Auto",max:50,enableRtl:this.parent.enableRtl,locale:this.parent.locale}),this.columnTextBox.isStringTemplate=!0,this.columnTextBox.appendTo(n.querySelector("#tableColumn")),this.rowTextBox=new et.NumericTextBox({format:"n0",min:1,value:3,placeholder:i,floatLabelType:"Auto",max:50,enableRtl:this.parent.enableRtl,locale:this.parent.locale}),this.rowTextBox.isStringTemplate=!0,this.rowTextBox.appendTo(n.querySelector("#tableRow")),n},n.prototype.createDialog=function(){var n=this,t;if(this.editdlgObj)this.editdlgObj.hide({returnValue:!0});else{t=this.parent.createElement("div",{className:"e-rte-edit-table",id:this.rteID+"_tabledialog"});this.parent.element.appendChild(t);var i=this.l10n.getConstant("dialogInsert"),u=this.l10n.getConstant("dialogCancel"),f={header:this.l10n.getConstant("tabledialogHeader"),cssClass:b,enableRtl:this.parent.enableRtl,locale:this.parent.locale,showCloseIcon:!0,closeOnEscape:!0,width:r.Browser.isDevice?"290px":"340px",height:"initial",position:{X:"center",Y:r.Browser.isDevice?"center":"top"},isModal:r.Browser.isDevice,buttons:[{buttonModel:{content:i,cssClass:"e-flat e-insert-table",isPrimary:!0}},{click:function(t){n.cancelDialog(t)},buttonModel:{cssClass:"e-flat e-cancel",content:u}}],target:r.Browser.isDevice?document.body:this.parent.element,animationSettings:{effect:"None"},close:function(t){n.parent.isBlur=!1;n.editdlgObj.destroy();Object(r.detach)(n.editdlgObj.element);n.dialogRenderObj.close(t);n.editdlgObj=null}};this.editdlgObj=this.dialogRenderObj.render(f);this.editdlgObj.appendTo(t);this.quickToolObj&&this.quickToolObj.inlineQTBar&&document.body.contains(this.quickToolObj.inlineQTBar.element)&&this.quickToolObj.inlineQTBar.hidePopup()}},n.prototype.customTable=function(n,t){var i=this.self?this.self:this,u;i.rowTextBox.value&&i.columnTextBox.value&&(u=r.Browser.isDevice||!Object(r.isNullOrUndefined)(n.args)&&!Object(r.isNullOrUndefined)(n.args.originalEvent)&&"insert-table"===n.args.originalEvent.action||i.parent.inlineMode.enable?n:this,i.tableInsert(i.rowTextBox.value,i.columnTextBox.value,t,u))},n.prototype.cancelDialog=function(){this.parent.isBlur=!1;this.editdlgObj.hide({returnValue:!0})},n.prototype.applyProperties=function(n){var f=this.editdlgObj.element,i=Object(r.closest)(n.selectNode[0],"table"),u,t,e;if(i.style.width=f.querySelector(".e-table-width").value+"px",""!==f.querySelector(".e-cell-padding").value)for(u=i.querySelectorAll("td"),t=0;t<u.length;t++)e="",""===u[t].style.padding?e=u[t].getAttribute("style")+" padding:"+f.querySelector(".e-cell-padding").value+"px;":(u[t].style.padding=f.querySelector(".e-cell-padding").value+"px",e=u[t].getAttribute("style")),u[t].setAttribute("style",e);i.cellSpacing=f.querySelector(".e-cell-spacing").value;Object(r.isNullOrUndefined)(i.cellSpacing)&&"0"===i.cellSpacing?Object(r.removeClass)([i],bh):Object(r.addClass)([i],bh);this.parent.formatter.saveData();this.editdlgObj.hide({returnValue:!0})},n.prototype.tableDlgContent=function(n){var i=n.selectParent[0],h=this.l10n.getConstant("tableWidth"),c=this.l10n.getConstant("cellpadding"),l=this.l10n.getConstant("cellspacing"),t=this.parent.createElement("div",{className:"e-table-sizewrap"}),a=Object(r.closest)(i,"table").getClientRects()[0].width,s=Object(r.closest)(i,"td").style.padding,u=Object(r.closest)(i,"table").getAttribute("cellspacing"),v=ci('<div class="e-rte-field"><input type="text" data-role ="none" id="tableWidth" class="e-table-width"  /><\/div><div class="e-rte-field"><input type="text" data-role ="none" id="cellPadding" class="e-cell-padding" /> <\/div><div class="e-rte-field"><input type="text" data-role ="none" id="cellSpacing" class="e-cell-spacing" /><\/div>'),f,e,o;return t.appendChild(v),f=new et.NumericTextBox({format:"n0",min:0,value:a,placeholder:h,floatLabelType:"Auto",enableRtl:this.parent.enableRtl,locale:this.parent.locale}),f.isStringTemplate=!0,f.appendTo(t.querySelector("#tableWidth")),e=new et.NumericTextBox({format:"n0",min:0,value:""!==s?parseInt(s,null):0,placeholder:c,floatLabelType:"Auto",enableRtl:this.parent.enableRtl,locale:this.parent.locale}),e.isStringTemplate=!0,e.appendTo(t.querySelector("#cellPadding")),o=new et.NumericTextBox({format:"n0",min:0,value:""===u||Object(r.isNullOrUndefined)(u)?0:parseInt(u,null),placeholder:l,floatLabelType:"Auto",enableRtl:this.parent.enableRtl,locale:this.parent.locale}),o.isStringTemplate=!0,o.appendTo(t.querySelector("#cellSpacing")),t},n.prototype.destroy=function(){this.removeEventListener()},n.prototype.getModuleName=function(){return"table"},n}(),tw=function(){function n(n){this.parent=n}return n.prototype.render=function(n){var t;return Object(r.isNullOrUndefined)(n.beforeOpen)&&(n.beforeOpen=this.beforeOpen.bind(this)),Object(r.isNullOrUndefined)(n.open)&&(n.open=this.open.bind(this)),Object(r.isNullOrUndefined)(n.close)&&(n.close=this.close.bind(this)),(t=new ft.Dialog(n)).isStringTemplate=!0,t},n.prototype.beforeOpen=function(n){this.parent.trigger(na,n)},n.prototype.open=function(n){this.parent.trigger(ta,n)},n.prototype.close=function(n){this.parent.trigger(ia,n)},n}(),iw={bold:{command:"Style",subCommand:"Bold",value:"strong"},italic:{command:"Style",subCommand:"Italic",value:"em"},underline:{command:"Style",subCommand:"Underline",value:"span"},strikeThrough:{command:"Style",subCommand:"StrikeThrough",value:"span"},insertCode:{command:"Formats",subCommand:"Pre",value:"pre"},superscript:{command:"Effects",subCommand:"SuperScript",value:"sup"},subscript:{command:"Effects",subCommand:"SubScript",value:"sub"},uppercase:{command:"Casing",subCommand:"UpperCase"},lowercase:{command:"Casing",subCommand:"LowerCase"},fontColor:{command:"font",subCommand:"fontcolor",value:"#ff0000"},fontName:{command:"font",subCommand:"fontname",value:"Segoe UI"},fontSize:{command:"font",subCommand:"fontsize",value:"10pt"},backColor:{command:"font",subCommand:"backgroundcolor",value:"#ffff00"},justifyCenter:{command:"Alignments",subCommand:"JustifyCenter"},justifyFull:{command:"Alignments",subCommand:"JustifyFull"},justifyLeft:{command:"Alignments",subCommand:"JustifyLeft"},justifyRight:{command:"Alignments",subCommand:"JustifyRight"},undo:{command:"Actions",subCommand:"Undo"},redo:{command:"Actions",subCommand:"Redo"},createLink:{command:"Links",subCommand:"createLink"},createImage:{command:"Images",subCommand:"Images"},formatBlock:{command:"Formats",value:"P"},heading:{command:"Formats",value:"H1"},indent:{command:"Indents",subCommand:"Indent"},outdent:{command:"Indents",subCommand:"Outdent"},insertHTML:{command:"InsertHTML",subCommand:"InsertHTML",value:""},insertText:{command:"InsertText",subCommand:"InsertText",value:""},insertHorizontalRule:{command:"InsertHTML",subCommand:"InsertHTML",value:"<hr/>"},insertImage:{command:"Images",subCommand:"Image"},insertTable:{command:"Table",subCommand:"CreateTable"},insertBrOnReturn:{command:"InsertHTML",subCommand:"InsertHTML",value:"<br/>"},insertOrderedList:{command:"Lists",value:"OL"},insertUnorderedList:{command:"Lists",value:"UL"},insertParagraph:{command:"Formats",value:"P"},removeFormat:{command:"Clear",subCommand:"ClearFormat"}},ti=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),e=function(n,t,i,r){var f,e=arguments.length,u=e<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r,o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(n,t,i,r);else for(o=n.length-1;o>=0;o--)(f=n[o])&&(u=(e<3?f(u):e>3?f(t,i,u):f(t,i))||u);return e>3&&u&&Object.defineProperty(t,i,u),u},bk=["Bold","Italic","Underline","|","Formats","Alignments","OrderedList","UnorderedList","|","CreateLink","Image","|","SourceCode","Undo","Redo"],kk=[{text:"Segoe UI",value:"Segoe UI",cssClass:"e-segoe-ui"},{text:"Arial",value:"Arial,Helvetica,sans-serif",cssClass:"e-arial"},{text:"Georgia",value:"Georgia,serif",cssClass:"e-georgia"},{text:"Impact",value:"Impact,Charcoal,sans-serif",cssClass:"e-impact"},{text:"Tahoma",value:"Tahoma,Geneva,sans-serif",cssClass:"e-tahoma"},{text:"Times New Roman",value:"Times New Roman,Times,serif",cssClass:"e-times-new-roman"},{text:"Verdana",value:"Verdana,Geneva,sans-serif",cssClass:"e-verdana"}],dk=[{text:"8 pt",value:"8pt"},{text:"10 pt",value:"10pt"},{text:"12 pt",value:"12pt"},{text:"14 pt",value:"14pt"},{text:"18 pt",value:"18pt"},{text:"24 pt",value:"24pt"},{text:"36 pt",value:"36pt"}],gk=[{text:"Paragraph",value:"P",cssClass:"e-paragraph"},{text:"Code",value:"Pre",cssClass:"e-code"},{text:"Quotation",value:"BlockQuote",cssClass:"e-quote"},{text:"Heading 1",value:"H1",cssClass:"e-h1"},{text:"Heading 2",value:"H2",cssClass:"e-h2"},{text:"Heading 3",value:"H3",cssClass:"e-h3"},{text:"Heading 4",value:"H4",cssClass:"e-h4"}],nd={Custom:["","#000000","#e7e6e6","#44546a","#4472c4","#ed7d31","#a5a5a5","#ffc000","#70ad47","#ff0000","#f2f2f2","#808080","#cfcdcd","#d5dce4","#d9e2f3","#fbe4d5","#ededed","#fff2cc","#e2efd9","#ffcccc","#d9d9d9","#595959","#aeaaaa","#acb9ca","#b4c6e7","#f7caac","#dbdbdb","#ffe599","#c5e0b3","#ff8080","#bfbfbf","#404040","#747070","#8496b0","#8eaadb","#f4b083","#c9c9c9","#ffd966","#a8d08d","#ff3333","#a6a6a6","#262626","#3b3838","#323e4f","#2f5496","#c45911","#7b7b7b","#bf8f00","#538135","#b30000","#7f7f7f","#0d0d0d","#161616","#212934","#1f3763","#823b0b","#525252","#7f5f00","#375623","#660000"]},td={Custom:["","#000000","#ffff00","#00ff00","#00ffff","#0000ff","#ff0000","#000080","#800080","#996633","#f2f2f2","#808080","#ffffcc","#b3ffb3","#ccffff","#ccccff","#ffcccc","#ccccff","#ff80ff","#f2e6d9","#d9d9d9","#595959","#ffff80","#80ff80","#b3ffff","#8080ff","#ff8080","#8080ff","#ff00ff","#dfbf9f","#bfbfbf","#404040","#ffff33","#33ff33","#33ffff","#3333ff","#ff3333","#0000b3","#b300b3","#c68c53","#a6a6a6","#262626","#e6e600","#00b300","#009999","#000099","#b30000","#000066","#660066","#86592d","#7f7f7f","#0d0d0d","#999900","#006600","#006666","#000066","#660000","#00004d","#4d004d","#734d26"]},id=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return ti(t,n),e([Object(r.Property)(!0)],t.prototype,"enable",void 0),e([Object(r.Property)(!0)],t.prototype,"enableFloating",void 0),e([Object(r.Property)(pt.Expand)],t.prototype,"type",void 0),e([Object(r.Property)(bk)],t.prototype,"items",void 0),e([Object(r.Property)({})],t.prototype,"itemConfigs",void 0),t}(r.ChildProperty),rd=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return ti(t,n),e([Object(r.Property)([".jpeg",".jpg",".png"])],t.prototype,"allowedTypes",void 0),e([Object(r.Property)("inline")],t.prototype,"display",void 0),e([Object(r.Property)("Blob")],t.prototype,"saveFormat",void 0),e([Object(r.Property)("auto")],t.prototype,"width",void 0),e([Object(r.Property)("auto")],t.prototype,"height",void 0),e([Object(r.Property)(null)],t.prototype,"saveUrl",void 0),e([Object(r.Property)(null)],t.prototype,"path",void 0),e([Object(r.Property)(!0)],t.prototype,"resize",void 0),e([Object(r.Property)(0)],t.prototype,"minWidth",void 0),e([Object(r.Property)(null)],t.prototype,"maxWidth",void 0),e([Object(r.Property)(0)],t.prototype,"minHeight",void 0),e([Object(r.Property)(null)],t.prototype,"maxHeight",void 0),e([Object(r.Property)(!1)],t.prototype,"resizeByPercent",void 0),t}(r.ChildProperty),ud=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return ti(t,n),e([Object(r.Property)("100%")],t.prototype,"width",void 0),e([Object(r.Property)(yo)],t.prototype,"styles",void 0),e([Object(r.Property)(!0)],t.prototype,"resize",void 0),e([Object(r.Property)(0)],t.prototype,"minWidth",void 0),e([Object(r.Property)(null)],t.prototype,"maxWidth",void 0),t}(r.ChildProperty),fd=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return ti(t,n),e([Object(r.Property)(!0)],t.prototype,"enable",void 0),e([Object(r.Property)(!1)],t.prototype,"showOnRightClick",void 0),e([Object(r.Property)("hide")],t.prototype,"actionOnScroll",void 0),e([Object(r.Property)(["Open","Edit","UnLink"])],t.prototype,"link",void 0),e([Object(r.Property)(["Replace","Align","Caption","Remove","-","InsertLink","OpenImageLink","EditImageLink","RemoveImageLink","Display","AltText","Dimension"])],t.prototype,"image",void 0),e([Object(r.Property)(["Cut","Copy","Paste"])],t.prototype,"text",void 0),e([Object(r.Property)(["TableHeader","TableRows","TableColumns","BackgroundColor","-","TableRemove","Alignments","TableCellVerticalAlign","Styles"])],t.prototype,"table",void 0),t}(r.ChildProperty),ed=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return ti(t,n),e([Object(r.Property)(!1)],t.prototype,"prompt",void 0),e([Object(r.Property)(null)],t.prototype,"deniedAttrs",void 0),e([Object(r.Property)(["background","background-color","border","border-bottom","border-left","border-radius","border-right","border-style","border-top","border-width","clear","color","cursor","direction","display","float","font","font-family","font-size","font-weight","font-style","height","left","line-height","margin","margin-top","margin-left","margin-right","margin-bottom","max-height","max-width","min-height","min-width","overflow","overflow-x","overflow-y","padding","padding-bottom","padding-left","padding-right","padding-top","position","right","table-layout","text-align","text-decoration","text-indent","top","vertical-align","visibility","white-space","width"])],t.prototype,"allowedStyleProps",void 0),e([Object(r.Property)(null)],t.prototype,"deniedTags",void 0),e([Object(r.Property)(!0)],t.prototype,"keepFormat",void 0),e([Object(r.Property)(!1)],t.prototype,"plainText",void 0),t}(r.ChildProperty),od=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return ti(t,n),e([Object(r.Property)(null)],t.prototype,"default",void 0),e([Object(r.Property)("65px")],t.prototype,"width",void 0),e([Object(r.Property)(kk)],t.prototype,"items",void 0),t}(r.ChildProperty),sd=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return ti(t,n),e([Object(r.Property)(null)],t.prototype,"default",void 0),e([Object(r.Property)("35px")],t.prototype,"width",void 0),e([Object(r.Property)(dk)],t.prototype,"items",void 0),t}(r.ChildProperty),hd=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return ti(t,n),e([Object(r.Property)(null)],t.prototype,"default",void 0),e([Object(r.Property)("65px")],t.prototype,"width",void 0),e([Object(r.Property)(gk)],t.prototype,"types",void 0),t}(r.ChildProperty),cd=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return ti(t,n),e([Object(r.Property)("#ff0000")],t.prototype,"default",void 0),e([Object(r.Property)("Palette")],t.prototype,"mode",void 0),e([Object(r.Property)(10)],t.prototype,"columns",void 0),e([Object(r.Property)(nd)],t.prototype,"colorCode",void 0),e([Object(r.Property)(!1)],t.prototype,"modeSwitcher",void 0),t}(r.ChildProperty),ld=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return ti(t,n),e([Object(r.Property)("#ffff00")],t.prototype,"default",void 0),e([Object(r.Property)("Palette")],t.prototype,"mode",void 0),e([Object(r.Property)(10)],t.prototype,"columns",void 0),e([Object(r.Property)(td)],t.prototype,"colorCode",void 0),e([Object(r.Property)(!1)],t.prototype,"modeSwitcher",void 0),t}(r.ChildProperty),rw=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),sf=function(n,t,i,r){var f,e=arguments.length,u=e<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r,o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(n,t,i,r);else for(o=n.length-1;o>=0;o--)(f=n[o])&&(u=(e<3?f(u):e>3?f(t,i,u):f(t,i))||u);return e>3&&u&&Object.defineProperty(t,i,u),u},ad=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return rw(t,n),sf([Object(r.Property)([])],t.prototype,"styles",void 0),sf([Object(r.Property)([])],t.prototype,"scripts",void 0),t}(r.ChildProperty),vd=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return rw(t,n),sf([Object(r.Property)(!1)],t.prototype,"enable",void 0),sf([Object(r.Property)(null)],t.prototype,"attributes",void 0),sf([Object(r.Complex)({},ad)],t.prototype,"resources",void 0),t}(r.ChildProperty),yd=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),uw=function(n,t,i,r){var f,e=arguments.length,u=e<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r,o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(n,t,i,r);else for(o=n.length-1;o>=0;o--)(f=n[o])&&(u=(e<3?f(u):e>3?f(t,i,u):f(t,i))||u);return e>3&&u&&Object.defineProperty(t,i,u),u},pd=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return yd(t,n),uw([Object(r.Property)(!1)],t.prototype,"enable",void 0),uw([Object(r.Property)(!0)],t.prototype,"onSelection",void 0),t}(r.ChildProperty),wd=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),fw=function(){return(fw=Object.assign||function(n){for(var r,i,t=1,u=arguments.length;t<u;t++)for(i in r=arguments[t])Object.prototype.hasOwnProperty.call(r,i)&&(n[i]=r[i]);return n}).apply(this,arguments)},f=function(n,t,i,r){var f,e=arguments.length,u=e<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r,o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(n,t,i,r);else for(o=n.length-1;o>=0;o--)(f=n[o])&&(u=(e<3?f(u):e>3?f(t,i,u):f(t,i))||u);return e>3&&u&&Object.defineProperty(t,i,u),u},bd=function(n){function t(t,i){var r=n.call(this,t,i)||this;return r.defaultResetValue=null,r.isFocusOut=!1,r.isRTE=!1,r.isBlur=!0,r.needsID=!0,r}return wd(t,n),t.prototype.requiredModules=function(){var n=[];return this.toolbarSettings.enable&&(n.push({member:"toolbar",args:[this,this.serviceLocator]}),n.push({member:"link",args:[this,this.serviceLocator]}),n.push({member:"table",args:[this,this.serviceLocator]}),n.push({member:"image",args:[this,this.serviceLocator]}),this.quickToolbarSettings.enable&&n.push({member:"quickToolbar",args:[this,this.serviceLocator]})),this.showCharCount&&n.push({member:"count",args:[this,this.serviceLocator]}),"Markdown"===this.editorMode&&n.push({member:"markdownEditor",args:[this,this.serviceLocator]}),"HTML"===this.editorMode&&(n.push({member:"htmlEditor",args:[this,this.serviceLocator]}),n.push({member:"pasteCleanup",args:[this,this.serviceLocator]})),this.enableResize&&n.push({member:"resize",args:[this]}),n},t.prototype.updateEnable=function(){this.enabled?(Object(r.removeClass)([this.element],ge),this.element.setAttribute("aria-disabled","false"),Object(r.isNullOrUndefined)(this.htmlAttributes.tabindex)?this.inputElement.setAttribute("tabindex","0"):this.inputElement.setAttribute("tabindex",this.htmlAttributes.tabindex)):(this.getToolbar()&&(Object(r.removeClass)(this.getToolbar().querySelectorAll("."+dr),dr),Object(r.removeClass)([this.getToolbar()],[no,to])),Object(r.addClass)([this.element],ge),this.element.tabIndex=-1,this.element.setAttribute("aria-disabled","true"),this.inputElement.setAttribute("tabindex","-1"))},t.prototype.setEnable=function(){this.updateEnable();this.enabled?this.eventInitializer():this.unWireEvents()},t.prototype.preRender=function(){this.onBlurHandler=this.blurHandler.bind(this);this.onFocusHandler=this.focusHandler.bind(this);this.onResizeHandler=this.resizeHandler.bind(this);this.clickPoints={clientX:0,clientY:0};this.initialValue=this.value;this.serviceLocator=new fc;this.initializeServices();this.setContainer();this.persistData();Object(r.setStyleAttribute)(this.element,{width:Object(r.formatUnit)(this.width)});Object(r.attributes)(this.element,{role:"application"})},t.prototype.persistData=function(){if(this.enablePersistence&&"TEXTAREA"===this.originalElement.tagName){this.element.id=this.originalElement.id+"_wrapper";var n=window.localStorage.getItem(this.getModuleName()+this.element.id);Object(r.isNullOrUndefined)(n)||""===n||this.setProperties(JSON.parse(n),!0)}},t.prototype.setContainer=function(){var i;this.originalElement=this.element.cloneNode(!0);null!==this.value&&null===this.valueTemplate||this.setValue();this.element.hasAttribute("tabindex")&&(this.htmlAttributes={tabindex:this.element.getAttribute("tabindex")},this.element.removeAttribute("tabindex"));this.isBlazor()||(this.element.innerHTML="");for(var u=["class","style","id","ejs-for"],t={},n=0;n<this.element.attributes.length;n++)-1!==u.indexOf(this.element.attributes[n].name)||/^data-val/.test(this.element.attributes[n].name)||(t[this.element.attributes[n].name]=this.element.getAttribute(this.element.attributes[n].name));(Object(r.extend)(t,this.htmlAttributes,t),this.setProperties({htmlAttributes:t},!0),Object(r.isNullOrUndefined)(this.htmlAttributes.id)||(this.element.id=this.htmlAttributes.id),"TEXTAREA"===this.element.tagName)?(i=this.createElement("div",{className:this.element.getAttribute("class")}),this.isBlazor()||(this.element.innerHTML=""),this.element.parentElement.insertBefore(i,this.element),Object(r.isBlazor)()?(i.appendChild(this.element),this.valueContainer=this.createElement("textarea",{id:this.element.id+"-value"})):this.valueContainer=this.element,Object(r.removeClass)([this.valueContainer],this.element.getAttribute("class").split(" ")),this.isBlazor()&&Object(r.addClass)([this.element],so),this.element=i):this.valueContainer=this.createElement("textarea",{id:this.getID()+"-value"});this.valueContainer.name=this.getID();Object(r.addClass)([this.valueContainer],so);this.element.appendChild(this.valueContainer)},t.prototype.getPersistData=function(){return this.addOnPersist(["value"])},t.prototype.focusIn=function(){this.enabled&&(this.inputElement.focus(),this.focusHandler({}))},t.prototype.focusOut=function(){this.enabled&&(this.inputElement.blur(),this.blurHandler({}))},t.prototype.selectAll=function(){this.notify(lr,{})},t.prototype.selectRange=function(n){this.notify(yu,{range:n})},t.prototype.getSelection=function(){var n="";return this.notify(ar,{callBack:function(t){n=t}}),n},t.prototype.executeCommand=function(n,t){var r,i;(t=this.htmlPurifier(n,t),"HTML"===this.editorMode)&&(r=this.getRange(),this.iframeSettings.enable&&this.formatter.editorManager.nodeSelection.Clear(this.element.ownerDocument),(!this.iframeSettings.enable||r.startContainer!==this.inputElement)&&this.inputElement.contains(r.startContainer)||this.focusIn());i=iw[n];this.formatter.editorManager.execCommand(i.command,i.subCommand?i.subCommand:t||i.value,null,null,t||i.value,t||i.value);this.setPlaceHolder()},t.prototype.htmlPurifier=function(n,t){if("HTML"===this.editorMode)switch(n){case"insertHTML":t="string"==typeof t?this.htmlEditorModule.sanitizeHelper(t):this.htmlEditorModule.sanitizeHelper(t.outerHTML);break;case"insertTable":t.width={minWidth:this.tableSettings.minWidth,maxWidth:this.tableSettings.maxWidth,width:this.tableSettings.width};break;case"insertImage":var o=this.createElement("img",{attrs:{src:t.url}}),f=this.htmlEditorModule.sanitizeHelper(o.outerHTML),i=""!==f&&this.createElement("div",{innerHTML:f}).firstElementChild.getAttribute("src")||null;i=Object(r.isNullOrUndefined)(i)?"":i;t.url=i;break;case"createLink":var s=this.createElement("a",{attrs:{href:t.url}}),e=this.htmlEditorModule.sanitizeHelper(s.outerHTML),u=""!==e&&this.createElement("div",{innerHTML:e}).firstElementChild.getAttribute("href")||null;u=Object(r.isNullOrUndefined)(u)?"":u;t.url=u}return t},t.prototype.encode=function(n){var t=this.createElement("div");return t.innerText=n.trim(),t.innerHTML.replace(/<br\s*[\/]?>/gi,"\n")},t.prototype.render=function(){this.value&&!this.valueTemplate&&this.setProperties({value:this.serializeValue(this.value)},!0);this.renderModule=new gp(this,this.serviceLocator);this.sourceCodeModule=new nw(this,this.serviceLocator);this.notify(tr,{});this.trigger(dl);this.RTERender();new ey(this);this.notify(p,{});this.toolbarSettings.enable&&"Expand"===this.toolbarSettings.type&&!Object(r.isNullOrUndefined)(this.getToolbar())&&this.toolbarSettings.items.indexOf("Undo")>-1&&this.toolbarSettings.items.indexOf("Redo")>-1&&this.disableToolbarItem(["Undo","Redo"]);this.setContentHeight();null!==this.value&&(this.isBlazor()?this.defaultResetValue=this.value:this.valueContainer.defaultValue=this.value);this.enabled?this.eventInitializer():this.unWireEvents();this.renderComplete()},t.prototype.eventInitializer=function(){this.wireEvents()},t.prototype.keyDown=function(n){var t,i,u,f;if((this.notify(w,{member:"keydown",args:n}),this.restrict(n),"HTML"===this.editorMode&&(8===n.which&&"Backspace"===n.code||46===n.which&&"Delete"===n.code))&&(t=this.getRange(),i="#text"===t.startContainer.nodeName?t.startContainer.parentElement:t.startContainer,(Object(r.closest)(i,"pre")&&8===n.which&&8203===t.startContainer.textContent.charCodeAt(t.startOffset-1)||46===n.which&&8203===t.startContainer.textContent.charCodeAt(t.startOffset))&&(u=new RegExp(String.fromCharCode(8203),"g"),f=8===n.which?t.startOffset-1:t.startOffset,t.startContainer.textContent=t.startContainer.textContent.replace(u,""),this.formatter.editorManager.nodeSelection.setCursorPoint(this.contentModule.getDocument(),t.startContainer,f))),0===this.formatter.getUndoRedoStack().length&&this.formatter.saveData(),n.action&&"paste"!==n.action||9===n.which)switch(this.formatter.process(this,null,n),n.action){case"toolbar-focus":this.toolbarSettings.enable&&this.toolbarModule.baseToolbar.toolbarObj.element.querySelector('.e-toolbar-item[aria-disabled="false"][title] [tabindex]').focus();break;case"escape":this.contentModule.getEditPanel().focus()}Object(r.isNullOrUndefined)(this.placeholder)||this.setPlaceHolder();this.autoResize()},t.prototype.keyUp=function(n){this.notify(ri,{member:"keyup",args:n});var t=32===n.which||13===n.which||8===n.which||46===n.which;("shift"!==n.key&&!n.ctrlKey&&n.key&&1===n.key.length||t||"Markdown"===this.editorMode&&("shift"!==n.key&&!n.ctrlKey&&n.key&&1===n.key.length||t)&&!this.inlineMode.enable)&&this.formatter.onKeyHandler(this,n);this.inputElement&&0!==this.inputElement.textContent.length&&this.notify(bt,{args:n});Object(r.isNullOrUndefined)(this.placeholder)||this.setPlaceHolder()},t.prototype.serializeValue=function(n){return"HTML"!==this.editorMode||Object(r.isNullOrUndefined)(n)||(this.enableHtmlEncode?(n=this.htmlEditorModule.sanitizeHelper(lt(n)),n=this.encode(n)):n=this.htmlEditorModule.sanitizeHelper(n)),n},t.prototype.sanitizeHtml=function(n){return this.serializeValue(n)},t.prototype.updateValue=function(n){if(Object(r.isNullOrUndefined)(n)){var t=this.inputElement.innerHTML;this.setProperties({value:gv(t)?null:t})}else this.setProperties({value:n})},t.prototype.triggerEditArea=function(n){if(a()){var t=n.touches?n.changedTouches[0]:n;this.clickPoints.clientX===t.clientX&&this.clickPoints.clientY===t.clientY&&this.notify(ii,{member:"editAreaClick",args:n})}else this.notify(ii,{member:"editAreaClick",args:n})},t.prototype.notifyMouseUp=function(n){var t=n.touches?n.changedTouches[0]:n;this.notify(yf,{member:"mouseUp",args:n,touchData:{prevClientX:this.clickPoints.clientX,prevClientY:this.clickPoints.clientY,clientX:t.clientX,clientY:t.clientY}});this.inputElement&&("HTML"===this.editorMode&&0!==this.inputElement.textContent.length||"Markdown"===this.editorMode&&0!==this.inputElement.value.length)&&this.notify(bt,{args:n});this.triggerEditArea(n)},t.prototype.mouseUp=function(n){if(this.quickToolbarSettings.showOnRightClick&&r.Browser.isDevice){var t=n.target,i=Object(r.closest)(t,"table");if(t&&"A"===t.nodeName||"IMG"===t.nodeName||"TD"===t.nodeName||"TH"===t.nodeName||"TABLE"===t.nodeName||i&&this.contentModule.getEditPanel().contains(i))return}this.notifyMouseUp(n)},t.prototype.ensureModuleInjected=function(n){return this.getInjectedModules().indexOf(n)>=0},t.prototype.onCopy=function(){this.contentModule.getDocument().execCommand("copy",!1,null)},t.prototype.onCut=function(){this.contentModule.getDocument().execCommand("cut",!1,null)},t.prototype.onPaste=function(n){var t=this,i={originalEvent:n,cancel:!1,requestType:"Paste"};this.trigger(st,i,function(i){var o=t.getText().length-t.getSelection().length+(Object(r.isNullOrUndefined)(n)||Object(r.isNullOrUndefined)(n.clipboardData)?0:n.clipboardData.getData("text/plain").length),f,u,e;!i.cancel&&(-1===t.maxLength||o<t.maxLength)?Object(r.isNullOrUndefined)(t.pasteCleanupModule)?(f={requestType:"Paste",editorMode:t.editorMode,event:n},u=null,n&&!Object(r.isNullOrUndefined)(n.clipboardData)&&(u=n.clipboardData.getData("text/plain")),e=n&&n.clipboardData&&n.clipboardData.items.length>0?n.clipboardData.items[0].getAsFile():null,null!==u&&t.notify(pi,{file:e,args:n,text:u}),setTimeout(function(){t.formatter.onSuccess(t,f)},0)):t.notify(we,{args:n}):n.preventDefault()})},t.prototype.clipboardAction=function(n,t){switch(n.toLowerCase()){case"cut":this.onCut();this.formatter.onSuccess(this,{requestType:"Cut",editorMode:this.editorMode,event:t});break;case"copy":this.onCopy();this.formatter.onSuccess(this,{requestType:"Copy",editorMode:this.editorMode,event:t});break;case"paste":this.onPaste(t)}},t.prototype.destroy=function(){if(this.isRendered){if(this.notify(h,{}),this.destroyDependentModules(),Object(r.isNullOrUndefined)(this.timeInterval)||(clearInterval(this.timeInterval),this.timeInterval=null),this.unWireEvents(),"TEXTAREA"===this.originalElement.tagName){Object(r.isBlazor)()&&(Object(r.detach)(this.valueContainer),this.valueContainer=this.element.querySelector(".e-blazor-hidden.e-control.e-richtexteditor"));this.element.parentElement.insertBefore(this.valueContainer,this.element);this.valueContainer.id=this.getID();this.valueContainer.removeAttribute("name");Object(r.detach)(this.element);""!==this.originalElement.innerHTML.trim()?(this.valueContainer.value=this.originalElement.innerHTML.trim(),Object(r.isBlazor)()||this.setProperties({value:Object(r.isNullOrUndefined)(this.initialValue)?null:this.initialValue},!0)):this.valueContainer.value=this.isBlazor()?this.defaultResetValue:this.valueContainer.defaultValue;this.element=this.valueContainer;for(var t=0;t<this.originalElement.classList.length;t++)Object(r.addClass)([this.element],this.originalElement.classList[t]);Object(r.removeClass)([this.element],so)}else""!==this.originalElement.innerHTML.trim()?(this.element.innerHTML=this.originalElement.innerHTML.trim(),this.setProperties({value:Object(r.isNullOrUndefined)(this.initialValue)?null:this.initialValue},!0)):this.element.innerHTML="";this.placeholder&&this.placeHolderWrapper&&(this.placeHolderWrapper=null);Object(r.isNullOrUndefined)(this.cssClass)||Object(r.removeClass)([this.element],this.cssClass);this.removeHtmlAttributes();this.removeAttributes();n.prototype.destroy.call(this);this.enablePersistence&&window.localStorage.removeItem(this.getModuleName()+this.element.id)}},t.prototype.removeHtmlAttributes=function(){if(this.htmlAttributes)for(var t=Object.keys(this.htmlAttributes),n=0;n<t.length&&this.element.hasAttribute(t[n]);n++)this.element.removeAttribute(t[n])},t.prototype.removeAttributes=function(){this.enabled||Object(r.removeClass)([this.element],ge);this.enableRtl&&Object(r.removeClass)([this.element],de);this.readonly&&Object(r.removeClass)([this.element],nu);""!==this.element.style.width&&""===this.originalElement.style.width&&this.element.style.removeProperty("width");""!==this.element.style.height&&""===this.originalElement.style.height&&this.element.style.removeProperty("height");this.element.removeAttribute("aria-disabled");this.element.removeAttribute("role");this.element.removeAttribute("tabindex")},t.prototype.destroyDependentModules=function(){this.renderModule.destroy();this.formatter.editorManager.undoRedoManager.destroy();this.sourceCodeModule.destroy()},t.prototype.getContent=function(){return this.iframeSettings.enable&&Object(r.isBlazor)()?this.inputElement:this.contentModule.getPanel()},t.prototype.getText=function(){return this.contentModule.getText()},t.prototype.getSelectedHtml=function(){var n=this.createElement("div"),t=this.contentModule.getDocument().getSelection(),i;return t.rangeCount>0&&(i=t.getRangeAt(0).cloneContents(),n.appendChild(i)),n.innerHTML},t.prototype.getModuleName=function(){return"richtexteditor"},t.prototype.onPropertyChanged=function(t,i){for(var u,c,f,s,l,e,o=0,h=Object.keys(t);o<h.length;o++){u=h[o];switch(u){case"value":f=t[u];c="HTML"===this.editorMode?go(f,this):f;Object(r.isNullOrUndefined)(f)||""===f||(this.value=this.serializeValue(this.enableHtmlEncode?this.encode(lt(c)):c));this.updatePanelValue();this.setPlaceHolder();this.notify(pu,{module:"XhtmlValidation",newProp:t,oldProp:i});this.showCharCount&&this.countModule.refresh();break;case"valueTemplate":this.setValue();this.showCharCount&&this.countModule.refresh();break;case"width":this.setWidth(t[u]);this.toolbarSettings.enable&&(this.toolbarModule.refreshToolbarOverflow(),this.resizeHandler());break;case"height":this.setHeight(t[u]);this.setContentHeight();this.autoResize();break;case"readonly":this.setReadOnly(!1);break;case"cssClass":this.element.classList.remove(i[u]);this.setCssClass(t[u]);break;case"enabled":this.setEnable();break;case"enableRtl":this.updateRTL();break;case"placeholder":this.placeholder=t[u];this.setPlaceHolder();break;case"htmlAttributes":hs(this.htmlAttributes,this,!1,!1);break;case"iframeSettings":s=i[u];s.resources&&(l=this.contentModule.getDocument().querySelector("head"),e=void 0,s.resources.scripts&&(e=l.querySelectorAll("."+bs),this.removeSheets(e)),s.resources.styles&&(e=l.querySelectorAll("."+ks),this.removeSheets(e)));this.setIframeSettings();break;case"locale":n.prototype.refresh.call(this);break;case"inlineMode":this.notify(y,{module:"quickToolbar",newProp:t,oldProp:i});this.setContentHeight();break;case"toolbarSettings":this.notify(y,{module:"toolbar",newProp:t,oldProp:i});this.setContentHeight();break;case"maxLength":this.showCharCount&&this.countModule.refresh();break;case"showCharCount":t[u]&&this.countModule?this.countModule.renderCount():!1===t[u]&&this.countModule&&this.countModule.destroy();break;case"enableHtmlEncode":this.updateValueData();this.updatePanelValue();this.setPlaceHolder();this.showCharCount&&this.countModule.refresh();break;case"undoRedoSteps":case"undoRedoTimer":this.formatter.editorManager.observer.notify(us,{newProp:t,oldProp:i});break;case"enableXhtml":this.notify(pu,{module:"XhtmlValidation",newProp:t,oldProp:i});break;case"quickToolbarSettings":t.quickToolbarSettings.showOnRightClick?this.wireContextEvent():this.unWireContextEvent();this.notify(y,{newProp:t,oldProp:i});break;default:this.notify(y,{newProp:t,oldProp:i})}}},t.prototype.updateValueData=function(){this.enableHtmlEncode?this.setProperties({value:this.encode(lt(this.inputElement.innerHTML))},!0):this.setProperties({value:/<[a-z][\s\S]*>/i.test(this.inputElement.innerHTML)?this.inputElement.innerHTML:lt(this.inputElement.innerHTML)})},t.prototype.removeSheets=function(n){for(var t=0;t<n.length;t++)Object(r.detach)(n[t])},t.prototype.updatePanelValue=function(){var n=this.value;(n=this.enableHtmlEncode&&this.value?lt(n):n)?(this.valueContainer&&(this.valueContainer.value=this.enableHtmlEncode?this.value:n),"HTML"===this.editorMode&&this.inputElement&&this.inputElement.innerHTML.trim()!==n.trim()?this.inputElement.innerHTML=n:"Markdown"===this.editorMode&&this.inputElement&&this.inputElement.value.trim()!==n.trim()&&(this.inputElement.value=n)):("HTML"===this.editorMode?this.inputElement.innerHTML="<p><br/><\/p>":this.inputElement.value="",this.valueContainer&&(this.valueContainer.value=""));this.showCharCount&&this.countModule.refresh()},t.prototype.setHeight=function(n){this.element.style.height="auto"!==n?Object(r.formatUnit)(n):"auto"},t.prototype.setPlaceHolder=function(){this.inputElement&&this.placeholder&&!0!==this.iframeSettings.enable&&("Markdown"!==this.editorMode?(this.placeHolderWrapper||(this.placeHolderWrapper=this.createElement("span",{className:"rte-placeholder"}),this.inputElement&&this.inputElement.parentElement.insertBefore(this.placeHolderWrapper,this.inputElement),Object(r.attributes)(this.placeHolderWrapper,{style:"font-size: 16px; padding: 16px; margin-left: 0px; margin-right: 0px;"})),this.placeHolderWrapper.innerHTML=this.placeholder,this.placeHolderWrapper.style.display=0!==this.inputElement.textContent.length||Object(r.isNullOrUndefined)(this.inputElement.firstChild)||"P"!==this.inputElement.firstChild.nodeName||Object(r.isNullOrUndefined)(this.inputElement.firstChild.firstChild)||"BR"!==this.inputElement.firstChild.firstChild.nodeName?"none":"block"):this.inputElement.setAttribute("placeholder",this.placeholder))},t.prototype.setWidth=function(n){"auto"!==n?Object(r.setStyleAttribute)(this.element,{width:Object(r.formatUnit)(this.width)}):this.element.style.width="auto"},t.prototype.setCssClass=function(n){Object(r.isNullOrUndefined)(n)||this.element.classList.add(n)},t.prototype.updateRTL=function(){this.notify(kt,{enableRtl:this.enableRtl});this.enableRtl?this.element.classList.add(de):this.element.classList.remove(de)},t.prototype.updateReadOnly=function(){this.notify(vr,{editPanel:this.inputElement,mode:this.readonly})},t.prototype.setReadOnly=function(n){this.updateReadOnly();n||(this.readonly&&this.enabled?this.unbindEvents():this.enabled&&this.bindEvents())},t.prototype.print=function(){var n,t=this,i={element:this.inputElement,requestType:"print",cancel:!1};this.trigger(st,i,function(i){(n=window.open("","print","height="+window.outerHeight+",width="+window.outerWidth),"msie"===r.Browser.info.name&&n.resizeTo(screen.availWidth,screen.availHeight),n=Object(r.print)(t.inputElement,n),i.cancel)||t.trigger(vi,{requestType:"print"})})},t.prototype.refreshUI=function(){this.renderModule.refresh()},t.prototype.showFullScreen=function(){this.readonly||this.fullScreenModule.showFullScreen()},t.prototype.enableToolbarItem=function(n,t){this.toolbarModule.enableTBarItems(this.getBaseToolbarObject(),n,!0,t)},t.prototype.disableToolbarItem=function(n,t){this.toolbarModule.enableTBarItems(this.getBaseToolbarObject(),n,!1,t)},t.prototype.removeToolbarItem=function(n){this.toolbarModule.removeTBarItems(n)},t.prototype.getRange=function(){return this.formatter.editorManager.nodeSelection.getRange(this.contentModule.getDocument())},t.prototype.initializeServices=function(){this.serviceLocator.register("rendererFactory",new ec);this.serviceLocator.register("rteLocale",this.localeObj=new r.L10n(this.getModuleName(),wb,this.locale));this.serviceLocator.register("dialogRenderObject",new tw(this))},t.prototype.RTERender=function(){var n=this.serviceLocator.getService("rendererFactory");this.contentModule=n.getRenderer(o.Content);this.fullScreenModule=new dp(this);this.renderModule.render();this.inputElement=this.contentModule.getEditPanel();this.setHeight(this.height);hs(this.htmlAttributes,this,!1,!0);this.iframeSettings&&this.setIframeSettings();this.setCssClass(this.cssClass);this.updateEnable();this.setPlaceHolder();this.updateRTL();this.updateReadOnly();this.updatePanelValue();this.enableHtmlEncode&&!Object(r.isNullOrUndefined)(this.value)&&this.setProperties({value:this.encode(lt(this.value))})},t.prototype.setIframeSettings=function(){if(this.iframeSettings.resources){var n=this.iframeSettings.resources.styles,t=this.iframeSettings.resources.scripts;this.iframeSettings.resources.scripts.length>0&&this.InjectSheet(!0,t);this.iframeSettings.resources.styles.length>0&&this.InjectSheet(!1,n)}this.iframeSettings.attributes&&hs(this.iframeSettings.attributes,this,!0,!1)},t.prototype.InjectSheet=function(n,t){var r,i,u,f;try{if(t&&t.length>0)for(r=this.contentModule.getDocument().querySelector("head"),i=0;i<t.length;i++)n?(u=this.createScriptElement(),u.src=t[i],r.appendChild(u)):(f=this.createStyleElement(),f.href=t[i],r.appendChild(f))}catch(n){return}},t.prototype.createScriptElement=function(){var n=this.createElement("script",{className:bs});return n.type="text/javascript",n},t.prototype.createStyleElement=function(){var n=this.createElement("link",{className:ks});return n.rel="stylesheet",n},t.prototype.isBlazor=function(){return-1!==Object.keys(window).indexOf("ejsInterop")},t.prototype.setValue=function(){var i,n,u,t;if(this.valueTemplate)if("string"==typeof this.valueTemplate)this.setProperties({value:this.valueTemplate});else{for(i=Object(r.compile)(this.valueTemplate)({}),n=0;n<i.length;n++)u=i[n],Object(r.append)([u],this.element);this.setProperties({value:this.element.innerHTML.trim()})}else t=!Object(r.isNullOrUndefined)(this.element.innerHTML)&&this.element.innerHTML.replace(/<(\/?|\!?)(!--!--)>/g,"").trim(),""!==t&&("TEXTAREA"===this.element.tagName?this.setProperties({value:lt(t)}):this.setProperties({value:t}))},t.prototype.setContentHeight=function(n,t){var i,e=0,c=this.sourceCodeModule.getPanel()&&"block"===this.sourceCodeModule.getPanel().parentElement.style.display?this.sourceCodeModule.getPanel().parentElement:this.contentModule.getPanel(),s=this.element.offsetHeight,u=this.getToolbar()?this.toolbarModule.getToolbarHeight():0,f=this.enableResize?this.element.querySelector("."+vh).offsetHeight+8:0,o=this.getToolbar()?this.toolbarModule.getExpandTBarPopHeight():0,h;(this.toolbarSettings.type===pt.Expand&&t&&"preview"!==n?(i="auto"===this.height&&0===f?"auto":s-(u+o+f)+"px",e=this.toolbarSettings.enableFloating?0:o):i="auto"!==this.height||this.element.classList.contains("e-rte-full-screen")?s-(u+f)+"px":"auto",Object(r.setStyleAttribute)(c,{height:i,marginTop:e+"px"}),this.iframeSettings.enable&&"sourceCode"===n)&&(h=Object(r.select)("."+ih,this.element),Object(r.setStyleAttribute)(h,{height:i,marginTop:e+"px"}));this.toolbarSettings.enableFloating&&this.getToolbar()&&!this.inlineMode.enable&&(t?Object(r.setStyleAttribute)(this.getToolbar().parentElement,{height:u+o+"px"}):Object(r.setStyleAttribute)(this.getToolbar().parentElement,{height:u+"px"}));0===f&&this.autoResize()},t.prototype.getHtml=function(){return this.value},t.prototype.showSourceCode=function(){this.readonly||this.notify(yi,{})},t.prototype.getCharCount=function(){return("Markdown"===this.editorMode?this.inputElement.value.trim():this.inputElement.textContent.trim()).length},t.prototype.getBaseToolbarObject=function(){return!this.inlineMode.enable||r.Browser.isDevice&&!a()?this.toolbarModule&&this.toolbarModule.getBaseToolbar():this.quickToolbarModule&&this.quickToolbarModule.getInlineBaseToolbar()},t.prototype.getToolbar=function(){return this.toolbarModule?this.toolbarModule.getToolbarElement():null},t.prototype.getToolbarElement=function(){return this.toolbarModule&&this.toolbarModule.getToolbarElement()},t.prototype.getID=function(){return"TEXTAREA"===this.originalElement.tagName?this.valueContainer.id:this.element.id},t.prototype.mouseDownHandler=function(n){var t=n.touches?n.changedTouches[0]:n;Object(r.addClass)([this.element],[fo]);this.preventDefaultResize(n);this.notify(g,{args:n});this.clickPoints={clientX:t.clientX,clientY:t.clientY}},t.prototype.preventImgResize=function(n){"img"===n.target.nodeName.toLocaleLowerCase()&&n.preventDefault()},t.prototype.preventDefaultResize=function(){"msie"===r.Browser.info.name?this.contentModule.getEditPanel().addEventListener("mscontrolselect",this.preventImgResize):"mozilla"===r.Browser.info.name&&(this.contentModule.getDocument().execCommand("enableObjectResizing",!1,"false"),this.contentModule.getDocument().execCommand("enableInlineTableEditing",!1,"false"))},t.prototype.defaultResize=function(){"msie"===r.Browser.info.name?this.contentModule.getEditPanel().removeEventListener("mscontrolselect",this.preventImgResize):"mozilla"===r.Browser.info.name&&(this.contentModule.getDocument().execCommand("enableObjectResizing",!0,"true"),this.contentModule.getDocument().execCommand("enableInlineTableEditing",!0,"true"))},t.prototype.resizeHandler=function(){var n=!1;this.toolbarSettings.enable&&!this.inlineMode.enable&&(this.toolbarModule.refreshToolbarOverflow(),n=this.toolbarModule.baseToolbar.toolbarObj.element.classList.contains(si));this.setContentHeight("",n)},t.prototype.scrollHandler=function(n){this.notify(fi,{args:n})},t.prototype.contentScrollHandler=function(n){this.notify(or,{args:n})},t.prototype.focusHandler=function(n){var u,f,t,i;if((!this.isRTE||this.isFocusOut)&&!this.readonly){if(this.isRTE=!this.isFocusOut,this.isFocusOut=!1,Object(r.addClass)([this.element],[fo]),this.cloneValue="HTML"===this.editorMode?"<p><br><\/p>"===this.inputElement.innerHTML?null:this.enableHtmlEncode?this.encode(lt(this.inputElement.innerHTML)):this.inputElement.innerHTML:""===this.inputElement.value?null:this.inputElement.value,u=document.activeElement,(u===this.element||u===this.getToolbarElement()||u===this.contentModule.getEditPanel()||this.iframeSettings.enable&&u===this.contentModule.getPanel()&&n.target&&!n.target.classList.contains("e-img-inner")&&n.target&&n.target.parentElement&&!n.target.parentElement.classList.contains("e-img-wrap")||Object(r.closest)(u,".e-rte-toolbar")===this.getToolbarElement())&&(this.contentModule.getEditPanel().focus(),!Object(r.isNullOrUndefined)(this.getToolbarElement())))for(this.getToolbarElement().setAttribute("tabindex","-1"),f=this.getToolbarElement().querySelectorAll('[tabindex="0"]'),t=0;t<f.length;t++)f[t].setAttribute("tabindex","-1");this.preventDefaultResize(n);this.trigger("focus",{event:n,isInteracted:0!==Object.keys(n).length});!Object(r.isNullOrUndefined)(this.saveInterval)&&this.saveInterval>0&&(this.timeInterval=setInterval(this.updateIntervalValue.bind(this),this.saveInterval));r.EventHandler.add(document,"mousedown",this.onDocumentClick,this)}if(!Object(r.isNullOrUndefined)(this.getToolbarElement()))for(i=this.getToolbarElement().querySelectorAll("input,select,button,a,[tabindex]"),t=0;t<i.length;t++)i[t].classList.contains("e-rte-dropdown-btn")||i[t].classList.contains("e-insert-table-btn")||i[t].hasAttribute("tabindex")&&"-1"===i[t].getAttribute("tabindex")||i[t].setAttribute("tabindex","-1")},t.prototype.getUpdatedValue=function(){return"HTML"===this.editorMode?"<p><br><\/p>"===this.inputElement.innerHTML?null:this.enableHtmlEncode?this.encode(lt(this.inputElement.innerHTML)):this.inputElement.innerHTML:""===this.inputElement.value?null:this.inputElement.value},t.prototype.updateIntervalValue=function(){this.setProperties({value:this.getUpdatedValue()},!0);this.valueContainer.value=this.value;this.invokeChangeEvent()},t.prototype.onDocumentClick=function(n){var t=n.target,i=Object(r.closest)(t,"."+ws);this.element.contains(n.target)||document===n.target||i===this.element||Object(r.closest)(t,'[aria-owns="'+this.getID()+'"]')||(this.isBlur=!0,this.isRTE=!1);this.notify(ve,{args:n})},t.prototype.blurHandler=function(n){var t=n.relatedTarget,i,u;t&&(i=Object(r.closest)(t,"."+ws),i&&i===this.element?(this.isBlur=!1,t===this.getToolbarElement()&&t.setAttribute("tabindex","-1")):Object(r.closest)(t,'[aria-owns="'+this.getID()+'"]')?this.isBlur=!1:(this.isBlur=!0,t=null));this.isBlur&&Object(r.isNullOrUndefined)(t)&&!this.readonly?(Object(r.removeClass)([this.element],[fo]),this.notify(cr,{}),u=this.getUpdatedValue(),this.setProperties({value:u}),this.notify(bt,{args:n,documentNode:document}),this.invokeChangeEvent(),this.isFocusOut=!0,this.isBlur=!1,uu(this.valueContainer,"focusout"),this.defaultResize(n),this.trigger("blur",{event:n,isInteracted:0!==Object.keys(n).length}),Object(r.isNullOrUndefined)(this.timeInterval)||(clearInterval(this.timeInterval),this.timeInterval=null),r.EventHandler.remove(document,"mousedown",this.onDocumentClick)):this.isRTE=!0},t.prototype.invokeChangeEvent=function(){var n={value:this.value};this.value!==this.cloneValue&&(this.trigger("change",n),this.cloneValue=this.value)},t.prototype.wireScrollElementsEvents=function(){var n,t,i;for(this.scrollParentElements=Object(ft.getScrollableParent)(this.element),n=0,t=this.scrollParentElements;n<t.length;n++)i=t[n],r.EventHandler.add(i,"scroll",this.scrollHandler,this);this.iframeSettings.enable||r.EventHandler.add(this.contentModule.getPanel(),"scroll",this.contentScrollHandler,this)},t.prototype.wireContextEvent=function(){this.quickToolbarSettings.showOnRightClick&&(r.EventHandler.add(this.inputElement,"contextmenu",this.contextHandler,this),r.Browser.isDevice&&(this.touchModule=new r.Touch(this.inputElement,{tapHold:this.touchHandler.bind(this),tapHoldThreshold:500})))},t.prototype.unWireContextEvent=function(){r.EventHandler.remove(this.inputElement,"contextmenu",this.contextHandler);r.Browser.isDevice&&this.touchModule&&this.touchModule.destroy()},t.prototype.unWireScrollElementsEvents=function(){var n,t,i;for(this.scrollParentElements=Object(ft.getScrollableParent)(this.element),n=0,t=this.scrollParentElements;n<t.length;n++)i=t[n],r.EventHandler.remove(i,"scroll",this.scrollHandler);this.iframeSettings.enable||r.EventHandler.remove(this.contentModule.getPanel(),"scroll",this.contentScrollHandler)},t.prototype.touchHandler=function(n){this.notifyMouseUp(n.originalEvent);this.triggerEditArea(n.originalEvent)},t.prototype.contextHandler=function(n){var t=Object(r.closest)(n.target,"a, table, img");!1!==this.inlineMode.onSelection&&(Object(r.isNullOrUndefined)(t)||!this.inputElement.contains(t)||"IMG"!==t.tagName&&"TABLE"!==t.tagName&&"A"!==t.tagName)||n.preventDefault()},t.prototype.resetHandler=function(){var n=this.valueContainer.defaultValue.trim();this.setProperties({value:""===n?null:this.isBlazor()?this.defaultResetValue:n})},t.prototype.autoResize=function(){var n=this,t;"auto"===this.height?"Markdown"===this.editorMode?setTimeout(function(){n.setAutoHeight(n.inputElement)},0):this.iframeSettings.enable&&(t=this.element.querySelector("#"+this.getID()+"_rte-view"),setTimeout(function(){n.setAutoHeight(t)},100),this.inputElement.style.overflow="hidden"):this.inputElement.style.overflow=null},t.prototype.setAutoHeight=function(n){n.style.height="";n.style.height=this.inputElement.scrollHeight+"px";n.style.overflow="hidden"},t.prototype.wireEvents=function(){this.element.addEventListener("focusin",this.onFocusHandler,!0);this.element.addEventListener("focusout",this.onBlurHandler,!0);this.readonly&&this.enabled||this.bindEvents()},t.prototype.restrict=function(n){if(this.maxLength>=0){for(var u="Markdown"===this.editorMode?this.contentModule.getText():n.currentTarget.textContent.trim(),i=[8,16,17,37,38,39,40,46,65],r=void 0,t=0;t<=i.length-1;t++)if(n.which===i[t]){if(n.ctrlKey&&65===n.which)return;if(65!==n.which)return void(r=i[t])}u.length>=this.maxLength&&-1!==this.maxLength&&n.which!==r&&n.preventDefault()}},t.prototype.bindEvents=function(){this.keyboardModule=new ts(this.inputElement,{keyAction:this.keyDown.bind(this),keyConfigs:fw({},this.formatter.keyConfig,this.keyConfig),eventName:"keydown"});var n=Object(r.closest)(this.valueContainer,"form");n&&r.EventHandler.add(n,"reset",this.resetHandler,this);r.EventHandler.add(this.inputElement,"keyup",this.keyUp,this);r.EventHandler.add(this.inputElement,"paste",this.onPaste,this);r.EventHandler.add(this.inputElement,r.Browser.touchEndEvent,Object(r.debounce)(this.mouseUp,30),this);r.EventHandler.add(this.inputElement,r.Browser.touchStartEvent,this.mouseDownHandler,this);this.wireContextEvent();this.formatter.editorManager.observer.on(v,this.editorKeyDown,this);this.element.ownerDocument.defaultView.addEventListener("resize",this.onResizeHandler,!0);this.iframeSettings.enable&&(r.EventHandler.add(this.inputElement,"focusin",this.focusHandler,this),r.EventHandler.add(this.inputElement,"focusout",this.blurHandler,this),r.EventHandler.add(this.inputElement.ownerDocument,"scroll",this.contentScrollHandler,this),r.EventHandler.add(this.inputElement.ownerDocument,r.Browser.touchStartEvent,this.onIframeMouseDown,this));this.wireScrollElementsEvents()},t.prototype.onIframeMouseDown=function(n){this.isBlur=!1;this.notify(wt,n)},t.prototype.editorKeyDown=function(n){switch(n.event.action){case"copy":this.onCopy();break;case"cut":this.onCut()}n.callBack&&("copy"===n.event.action||"cut"===n.event.action||"delete"===n.event.action)&&n.callBack({requestType:n.event.action,editorMode:"HTML",event:n.event})},t.prototype.unWireEvents=function(){this.element.removeEventListener("focusin",this.onFocusHandler,!0);this.element.removeEventListener("focusout",this.onBlurHandler,!0);this.readonly&&this.enabled||this.unbindEvents()},t.prototype.unbindEvents=function(){this.keyboardModule&&this.keyboardModule.destroy();var n=Object(r.closest)(this.valueContainer,"form");n&&r.EventHandler.remove(n,"reset",this.resetHandler);r.EventHandler.remove(this.inputElement,"keyup",this.keyUp);r.EventHandler.remove(this.inputElement,"paste",this.onPaste);r.EventHandler.remove(this.inputElement,r.Browser.touchEndEvent,Object(r.debounce)(this.mouseUp,30));r.EventHandler.remove(this.inputElement,r.Browser.touchStartEvent,this.mouseDownHandler);this.unWireContextEvent();this.formatter&&this.formatter.editorManager.observer.off(v,this.editorKeyDown);this.element.ownerDocument.defaultView.removeEventListener("resize",this.onResizeHandler,!0);this.iframeSettings.enable&&(r.EventHandler.remove(this.inputElement,"focusin",this.focusHandler),r.EventHandler.remove(this.inputElement,"focusout",this.blurHandler),r.EventHandler.remove(this.inputElement.ownerDocument,"scroll",this.contentScrollHandler),r.EventHandler.remove(this.inputElement.ownerDocument,r.Browser.touchStartEvent,this.onIframeMouseDown));this.unWireScrollElementsEvents()},f([Object(r.Complex)({},id)],t.prototype,"toolbarSettings",void 0),f([Object(r.Complex)({},fd)],t.prototype,"quickToolbarSettings",void 0),f([Object(r.Complex)({},ed)],t.prototype,"pasteCleanupSettings",void 0),f([Object(r.Complex)({},vd)],t.prototype,"iframeSettings",void 0),f([Object(r.Complex)({},rd)],t.prototype,"insertImageSettings",void 0),f([Object(r.Complex)({},ud)],t.prototype,"tableSettings",void 0),f([Object(r.Property)(0)],t.prototype,"floatingToolbarOffset",void 0),f([Object(r.Complex)({},pd)],t.prototype,"inlineMode",void 0),f([Object(r.Property)("100%")],t.prototype,"width",void 0),f([Object(r.Property)(!1)],t.prototype,"enablePersistence",void 0),f([Object(r.Property)(!1)],t.prototype,"enableResize",void 0),f([Object(r.Property)({})],t.prototype,"htmlAttributes",void 0),f([Object(r.Property)(null)],t.prototype,"placeholder",void 0),f([Object(r.Property)(!1)],t.prototype,"readonly",void 0),f([Object(r.Property)(!0)],t.prototype,"enabled",void 0),f([Object(r.Property)(!0)],t.prototype,"enableHtmlSanitizer",void 0),f([Object(r.Property)(!1)],t.prototype,"enableHtmlEncode",void 0),f([Object(r.Property)(!1)],t.prototype,"enableXhtml",void 0),f([Object(r.Property)("auto")],t.prototype,"height",void 0),f([Object(r.Property)(null)],t.prototype,"cssClass",void 0),f([Object(r.Property)(null)],t.prototype,"value",void 0),f([Object(r.Property)(30)],t.prototype,"undoRedoSteps",void 0),f([Object(r.Property)(300)],t.prototype,"undoRedoTimer",void 0),f([Object(r.Property)("HTML")],t.prototype,"editorMode",void 0),f([Object(r.Property)(null)],t.prototype,"keyConfig",void 0),f([Object(r.Property)(!1)],t.prototype,"showCharCount",void 0),f([Object(r.Property)(!1)],t.prototype,"enableTabKey",void 0),f([Object(r.Property)(!1)],t.prototype,"enableAutoUrl",void 0),f([Object(r.Property)(-1)],t.prototype,"maxLength",void 0),f([Object(r.Complex)({},hd)],t.prototype,"format",void 0),f([Object(r.Complex)({},od)],t.prototype,"fontFamily",void 0),f([Object(r.Complex)({},sd)],t.prototype,"fontSize",void 0),f([Object(r.Complex)({},cd)],t.prototype,"fontColor",void 0),f([Object(r.Complex)({},ld)],t.prototype,"backgroundColor",void 0),f([Object(r.Property)(null)],t.prototype,"valueTemplate",void 0),f([Object(r.Property)(1e4)],t.prototype,"saveInterval",void 0),f([Object(r.Event)()],t.prototype,"actionBegin",void 0),f([Object(r.Event)()],t.prototype,"actionComplete",void 0),f([Object(r.Event)()],t.prototype,"beforeDialogOpen",void 0),f([Object(r.Event)()],t.prototype,"dialogOpen",void 0),f([Object(r.Event)()],t.prototype,"dialogClose",void 0),f([Object(r.Event)()],t.prototype,"beforeQuickToolbarOpen",void 0),f([Object(r.Event)()],t.prototype,"quickToolbarOpen",void 0),f([Object(r.Event)()],t.prototype,"quickToolbarClose",void 0),f([Object(r.Event)()],t.prototype,"toolbarStatusUpdate",void 0),f([Object(r.Event)()],t.prototype,"imageSelected",void 0),f([Object(r.Event)()],t.prototype,"imageUploading",void 0),f([Object(r.Event)()],t.prototype,"imageUploadSuccess",void 0),f([Object(r.Event)()],t.prototype,"imageUploadFailed",void 0),f([Object(r.Event)()],t.prototype,"imageRemoving",void 0),f([Object(r.Event)()],t.prototype,"created",void 0),f([Object(r.Event)()],t.prototype,"destroyed",void 0),f([Object(r.Event)()],t.prototype,"beforeSanitizeHtml",void 0),f([Object(r.Event)()],t.prototype,"blur",void 0),f([Object(r.Event)()],t.prototype,"toolbarClick",void 0),f([Object(r.Event)()],t.prototype,"focus",void 0),f([Object(r.Event)()],t.prototype,"change",void 0),f([Object(r.Event)()],t.prototype,"resizing",void 0),f([Object(r.Event)()],t.prototype,"resizeStart",void 0),f([Object(r.Event)()],t.prototype,"resizeStop",void 0),f([Object(r.Property)(null)],t.prototype,"formatter",void 0),t=f([r.NotifyPropertyChanges],t)}(r.Component),kl={};Object(cs.copy)(kl,u);ew={richtexteditor:kl=Object(cs.copy)(window.ejs?window.ejs.richtexteditor:{},kl)};window.ejs=Object(cs.copy)(window.ejs||{},ew);window.ejdashboard=window.ejs}]);ejdashboard.richtexteditor.RichTextEditor.Inject(ejdashboard.richtexteditor.HtmlEditor,ejdashboard.richtexteditor.Toolbar,ejdashboard.richtexteditor.QuickToolbar,ejdashboard.richtexteditor.Link,ejdashboard.richtexteditor.Image,ejdashboard.richtexteditor.Count,ejdashboard.richtexteditor.MarkdownEditor,ejdashboard.richtexteditor.PasteCleanup,ejdashboard.richtexteditor.Resize,ejdashboard.richtexteditor.Table);
